(function(e,z){typeof exports=="object"&&typeof module<"u"?module.exports=z(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],z):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=z(e.Vue,e.Pinia))})(this,(function(e,z){"use strict";let K=Date.now();const P=(y,g,u)=>{if(g===1||g===3)return!0;if(g===10)switch(y){case"culture":if([2,3,5].includes(u))return!0;break;case"multiple":if([2,3,4,5].includes(u))return!0;break;case"accessibility":if([2,3,4,5].includes(u))return!0;break}return!1},X=()=>`id--${K++}`,j=y=>parseInt(y)||0,Q=z.defineStore("message",{state:()=>({error:null})}),{ajax:v}=rxjs.ajax,{map:ee}=rxjs;let W="";const te=(y,g={})=>L("Service/OFS/Accessibility.ashx",{method:y,param:g}),le=(y,g={})=>L("Service/OFS/Culture.ashx",{method:y,param:g}),oe=y=>`${W}/Service/OFS/Download.ashx?path=${y}`,ne=(y,g={})=>L("Service/OFS/Education.ashx",{method:y,param:g}),re=(y,g={})=>L("Service/OFS/Literacy.ashx",{method:y,param:g}),ae=(y,g={})=>L("Service/OFS/Multiple.ashx",{method:y,param:g}),de=({response:y,status:g})=>{if(g===200){if(y.success)return y.data;Q().error=y.message}},L=(y,g={})=>{const u={};g.constructor!==FormData&&(u["Content-Type"]="application/json");const E={body:g,headers:u,method:"POST",url:`${W}/${y}`};return v(E).pipe(ee(de))},D=Object.assign(L,{accessibility:te,culture:le,download:oe,education:ne,literacy:re,multiple:ae,upload:y=>{const g=new FormData;return g.append("file",y),L("Service/OFS/Upload.ashx",g)}});function se(y){return y&&y.__esModule&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y}var J={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var ce=J.exports,Y;function ie(){return Y||(Y=1,(function(y,g){(function(u,E,V){var d=function(l,r,a){a=n.extend({},n.options,a);var s=n.runValidations(l,r,a);if(s.some(function(p){return n.isPromise(p.error)}))throw new Error("Use validate.async if you want support for promises");return d.processValidationResults(s,a)},n=d;n.extend=function(l){return[].slice.call(arguments,1).forEach(function(r){for(var a in r)l[a]=r[a]}),l},n.extend(d,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var l=n.format("%{major}.%{minor}.%{patch}",n.version);return n.isEmpty(n.version.metadata)||(l+="+"+n.version.metadata),l}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(l,r,a){var s=[],p,c,b,h,o,N,m;(n.isDomElement(l)||n.isJqueryElement(l))&&(l=n.collectFormValues(l));for(p in r){b=n.getDeepObjectValue(l,p),h=n.result(r[p],b,l,p,a,r);for(c in h){if(o=n.validators[c],!o)throw m=n.format("Unknown validator %{name}",{name:c}),new Error(m);N=h[c],N=n.result(N,b,l,p,a,r),N&&s.push({attribute:p,value:b,validator:c,globalOptions:a,attributes:l,options:N,error:o.call(o,b,N,p,l,a)})}}return s},processValidationResults:function(l,r){l=n.pruneEmptyErrors(l,r),l=n.expandMultipleErrors(l,r),l=n.convertErrorMessages(l,r);var a=r.format||"grouped";if(typeof n.formatters[a]=="function")l=n.formatters[a](l);else throw new Error(n.format("Unknown format %{format}",r));return n.isEmpty(l)?void 0:l},async:function(l,r,a){a=n.extend({},n.async.options,a);var s=a.wrapErrors||function(c){return c};a.cleanAttributes!==!1&&(l=n.cleanAttributes(l,r));var p=n.runValidations(l,r,a);return new n.Promise(function(c,b){n.waitForResults(p).then(function(){var h=n.processValidationResults(p,a);h?b(new s(h,a,l,r)):c(l)},function(h){b(h)})})},single:function(l,r,a){return a=n.extend({},n.single.options,a,{format:"flat",fullMessages:!1}),n({single:l},{single:r},a)},waitForResults:function(l){return l.reduce(function(r,a){return n.isPromise(a.error)?r.then(function(){return a.error.then(function(s){a.error=s||null})}):r},new n.Promise(function(r){r()}))},result:function(l){var r=[].slice.call(arguments,1);return typeof l=="function"&&(l=l.apply(null,r)),l},isNumber:function(l){return typeof l=="number"&&!isNaN(l)},isFunction:function(l){return typeof l=="function"},isInteger:function(l){return n.isNumber(l)&&l%1===0},isBoolean:function(l){return typeof l=="boolean"},isObject:function(l){return l===Object(l)},isDate:function(l){return l instanceof Date},isDefined:function(l){return l!=null},isPromise:function(l){return!!l&&n.isFunction(l.then)},isJqueryElement:function(l){return l&&n.isString(l.jquery)},isDomElement:function(l){return!l||!l.querySelectorAll||!l.querySelector?!1:n.isObject(document)&&l===document?!0:typeof HTMLElement=="object"?l instanceof HTMLElement:l&&typeof l=="object"&&l!==null&&l.nodeType===1&&typeof l.nodeName=="string"},isEmpty:function(l){var r;if(!n.isDefined(l))return!0;if(n.isFunction(l))return!1;if(n.isString(l))return n.EMPTY_STRING_REGEXP.test(l);if(n.isArray(l))return l.length===0;if(n.isDate(l))return!1;if(n.isObject(l)){for(r in l)return!1;return!0}return!1},format:n.extend(function(l,r){return n.isString(l)?l.replace(n.format.FORMAT_REGEXP,function(a,s,p){return s==="%"?"%{"+p+"}":String(r[p])}):l},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(l){return n.isNumber(l)?l*100%1===0?""+l:parseFloat(Math.round(l*100)/100).toFixed(2):n.isArray(l)?l.map(function(r){return n.prettify(r)}).join(", "):n.isObject(l)?n.isDefined(l.toString)?l.toString():JSON.stringify(l):(l=""+l,l.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(r,a,s){return""+a+" "+s.toLowerCase()}).toLowerCase())},stringifyValue:function(l,r){var a=r&&r.prettify||n.prettify;return a(l)},isString:function(l){return typeof l=="string"},isArray:function(l){return{}.toString.call(l)==="[object Array]"},isHash:function(l){return n.isObject(l)&&!n.isArray(l)&&!n.isFunction(l)},contains:function(l,r){return n.isDefined(l)?n.isArray(l)?l.indexOf(r)!==-1:r in l:!1},unique:function(l){return n.isArray(l)?l.filter(function(r,a,s){return s.indexOf(r)==a}):l},forEachKeyInKeypath:function(l,r,a){if(n.isString(r)){var s="",p,c=!1;for(p=0;p<r.length;++p)switch(r[p]){case".":c?(c=!1,s+="."):(l=a(l,s,!1),s="");break;case"\\":c?(c=!1,s+="\\"):c=!0;break;default:c=!1,s+=r[p];break}return a(l,s,!0)}},getDeepObjectValue:function(l,r){if(n.isObject(l))return n.forEachKeyInKeypath(l,r,function(a,s){if(n.isObject(a))return a[s]})},collectFormValues:function(l,r){var a={},s,p,c,b,h,o;if(n.isJqueryElement(l)&&(l=l[0]),!l)return a;for(r=r||{},b=l.querySelectorAll("input[name], textarea[name]"),s=0;s<b.length;++s)if(c=b.item(s),!n.isDefined(c.getAttribute("data-ignored"))){var N=c.name.replace(/\./g,"\\\\.");o=n.sanitizeFormValue(c.value,r),c.type==="number"?o=o?+o:null:c.type==="checkbox"?c.attributes.value?c.checked||(o=a[N]||null):o=c.checked:c.type==="radio"&&(c.checked||(o=a[N]||null)),a[N]=o}for(b=l.querySelectorAll("select[name]"),s=0;s<b.length;++s)if(c=b.item(s),!n.isDefined(c.getAttribute("data-ignored"))){if(c.multiple){o=[];for(p in c.options)h=c.options[p],h&&h.selected&&o.push(n.sanitizeFormValue(h.value,r))}else{var m=typeof c.options[c.selectedIndex]<"u"?c.options[c.selectedIndex].value:"";o=n.sanitizeFormValue(m,r)}a[c.name]=o}return a},sanitizeFormValue:function(l,r){return r.trim&&n.isString(l)&&(l=l.trim()),r.nullify!==!1&&l===""?null:l},capitalize:function(l){return n.isString(l)?l[0].toUpperCase()+l.slice(1):l},pruneEmptyErrors:function(l){return l.filter(function(r){return!n.isEmpty(r.error)})},expandMultipleErrors:function(l){var r=[];return l.forEach(function(a){n.isArray(a.error)?a.error.forEach(function(s){r.push(n.extend({},a,{error:s}))}):r.push(a)}),r},convertErrorMessages:function(l,r){r=r||{};var a=[],s=r.prettify||n.prettify;return l.forEach(function(p){var c=n.result(p.error,p.value,p.attribute,p.options,p.attributes,p.globalOptions);if(!n.isString(c)){a.push(p);return}c[0]==="^"?c=c.slice(1):r.fullMessages!==!1&&(c=n.capitalize(s(p.attribute))+" "+c),c=c.replace(/\\\^/g,"^"),c=n.format(c,{value:n.stringifyValue(p.value,r)}),a.push(n.extend({},p,{error:c}))}),a},groupErrorsByAttribute:function(l){var r={};return l.forEach(function(a){var s=r[a.attribute];s?s.push(a):r[a.attribute]=[a]}),r},flattenErrorsToArray:function(l){return l.map(function(r){return r.error}).filter(function(r,a,s){return s.indexOf(r)===a})},cleanAttributes:function(l,r){function a(c,b,h){return n.isObject(c[b])?c[b]:c[b]=h?!0:{}}function s(c){var b={},h;for(h in c)c[h]&&n.forEachKeyInKeypath(b,h,a);return b}function p(c,b){if(!n.isObject(c))return c;var h=n.extend({},c),o,N;for(N in c)o=b[N],n.isObject(o)?h[N]=p(h[N],o):o||delete h[N];return h}return!n.isObject(r)||!n.isObject(l)?{}:(r=s(r),p(l,r))},exposeModule:function(l,r,a,s,p){a?(s&&s.exports&&(a=s.exports=l),a.validate=l):(r.validate=l,l.isFunction(p)&&p.amd&&p([],function(){return l}))},warn:function(l){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+l)},error:function(l){typeof console<"u"&&console.error&&console.error("[validate.js] "+l)}}),d.validators={presence:function(l,r){if(r=n.extend({},this.options,r),r.allowEmpty!==!1?!n.isDefined(l):n.isEmpty(l))return r.message||this.message||"can't be blank"},length:function(l,r,a){if(n.isDefined(l)){r=n.extend({},this.options,r);var s=r.is,p=r.maximum,c=r.minimum,b=r.tokenizer||function(m){return m},h,o=[];l=b(l);var N=l.length;if(!n.isNumber(N))return r.message||this.notValid||"has an incorrect length";if(n.isNumber(s)&&N!==s&&(h=r.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",o.push(n.format(h,{count:s}))),n.isNumber(c)&&N<c&&(h=r.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",o.push(n.format(h,{count:c}))),n.isNumber(p)&&N>p&&(h=r.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",o.push(n.format(h,{count:p}))),o.length>0)return r.message||o}},numericality:function(l,r,a,s,p){if(n.isDefined(l)){r=n.extend({},this.options,r);var c=[],b,h,o={greaterThan:function(f,S){return f>S},greaterThanOrEqualTo:function(f,S){return f>=S},equalTo:function(f,S){return f===S},lessThan:function(f,S){return f<S},lessThanOrEqualTo:function(f,S){return f<=S},divisibleBy:function(f,S){return f%S===0}},N=r.prettify||p&&p.prettify||n.prettify;if(n.isString(l)&&r.strict){var m="^-?(0|[1-9]\\d*)";if(r.onlyInteger||(m+="(\\.\\d+)?"),m+="$",!new RegExp(m).test(l))return r.message||r.notValid||this.notValid||this.message||"must be a valid number"}if(r.noStrings!==!0&&n.isString(l)&&!n.isEmpty(l)&&(l=+l),!n.isNumber(l))return r.message||r.notValid||this.notValid||this.message||"is not a number";if(r.onlyInteger&&!n.isInteger(l))return r.message||r.notInteger||this.notInteger||this.message||"must be an integer";for(b in o)if(h=r[b],n.isNumber(h)&&!o[b](l,h)){var t="not"+n.capitalize(b),i=r[t]||this[t]||this.message||"must be %{type} %{count}";c.push(n.format(i,{count:h,type:N(b)}))}if(r.odd&&l%2!==1&&c.push(r.notOdd||this.notOdd||this.message||"must be odd"),r.even&&l%2!==0&&c.push(r.notEven||this.notEven||this.message||"must be even"),c.length)return r.message||c}},datetime:n.extend(function(l,r){if(!n.isFunction(this.parse)||!n.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(n.isDefined(l)){r=n.extend({},this.options,r);var a,s=[],p=r.earliest?this.parse(r.earliest,r):NaN,c=r.latest?this.parse(r.latest,r):NaN;if(l=this.parse(l,r),isNaN(l)||r.dateOnly&&l%864e5!==0)return a=r.notValid||r.message||this.notValid||"must be a valid date",n.format(a,{value:arguments[0]});if(!isNaN(p)&&l<p&&(a=r.tooEarly||r.message||this.tooEarly||"must be no earlier than %{date}",a=n.format(a,{value:this.format(l,r),date:this.format(p,r)}),s.push(a)),!isNaN(c)&&l>c&&(a=r.tooLate||r.message||this.tooLate||"must be no later than %{date}",a=n.format(a,{date:this.format(c,r),value:this.format(l,r)}),s.push(a)),s.length)return n.unique(s)}},{parse:null,format:null}),date:function(l,r){return r=n.extend({},r,{dateOnly:!0}),n.validators.datetime.call(n.validators.datetime,l,r)},format:function(l,r){(n.isString(r)||r instanceof RegExp)&&(r={pattern:r}),r=n.extend({},this.options,r);var a=r.message||this.message||"is invalid",s=r.pattern,p;if(n.isDefined(l)&&(!n.isString(l)||(n.isString(s)&&(s=new RegExp(r.pattern,r.flags)),p=s.exec(l),!p||p[0].length!=l.length)))return a},inclusion:function(l,r){if(n.isDefined(l)&&(n.isArray(r)&&(r={within:r}),r=n.extend({},this.options,r),!n.contains(r.within,l))){var a=r.message||this.message||"^%{value} is not included in the list";return n.format(a,{value:l})}},exclusion:function(l,r){if(n.isDefined(l)&&(n.isArray(r)&&(r={within:r}),r=n.extend({},this.options,r),!!n.contains(r.within,l))){var a=r.message||this.message||"^%{value} is restricted";return n.isString(r.within[l])&&(l=r.within[l]),n.format(a,{value:l})}},email:n.extend(function(l,r){r=n.extend({},this.options,r);var a=r.message||this.message||"is not a valid email";if(n.isDefined(l)&&(!n.isString(l)||!this.PATTERN.exec(l)))return a},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(l,r,a,s,p){if(n.isDefined(l)){n.isString(r)&&(r={attribute:r}),r=n.extend({},this.options,r);var c=r.message||this.message||"is not equal to %{attribute}";if(n.isEmpty(r.attribute)||!n.isString(r.attribute))throw new Error("The attribute must be a non empty string");var b=n.getDeepObjectValue(s,r.attribute),h=r.comparator||function(N,m){return N===m},o=r.prettify||p&&p.prettify||n.prettify;if(!h(l,b,r,a,s))return n.format(c,{attribute:o(r.attribute)})}},url:function(l,r){if(n.isDefined(l)){r=n.extend({},this.options,r);var a=r.message||this.message||"is not a valid url",s=r.schemes||this.schemes||["http","https"],p=r.allowLocal||this.allowLocal||!1,c=r.allowDataUrl||this.allowDataUrl||!1;if(!n.isString(l))return a;var b="^(?:(?:"+s.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",h="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(p?h+="?":b+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",b+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+h+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",c){var o="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",N="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",m="data:(?:"+o+")?(?:;base64)?,"+N;b="(?:"+b+")|(?:^"+m+"$)"}var t=new RegExp(b,"i");if(!t.exec(l))return a}},type:n.extend(function(l,r,a,s,p){if(n.isString(r)&&(r={type:r}),!!n.isDefined(l)){var c=n.extend({},this.options,r),b=c.type;if(!n.isDefined(b))throw new Error("No type was specified");var h;if(n.isFunction(b)?h=b:h=this.types[b],!n.isFunction(h))throw new Error("validate.validators.type.types."+b+" must be a function.");if(!h(l,c,a,s,p)){var o=r.message||this.messages[b]||this.message||c.message||(n.isFunction(b)?"must be of the correct type":"must be of type %{type}");return n.isFunction(o)&&(o=o(l,r,a,s,p)),n.format(o,{attribute:n.prettify(a),type:b})}}},{types:{object:function(l){return n.isObject(l)&&!n.isArray(l)},array:n.isArray,integer:n.isInteger,number:n.isNumber,string:n.isString,date:n.isDate,boolean:n.isBoolean},messages:{}})},d.formatters={detailed:function(l){return l},flat:n.flattenErrorsToArray,grouped:function(l){var r;l=n.groupErrorsByAttribute(l);for(r in l)l[r]=n.flattenErrorsToArray(l[r]);return l},constraint:function(l){var r;l=n.groupErrorsByAttribute(l);for(r in l)l[r]=l[r].map(function(a){return a.validator}).sort();return l}},d.exposeModule(d,this,u,E,V)}).call(ce,g,y,null)})(J,J.exports)),J.exports}var me=ie();const H=se(me),U=(y,g,u="")=>{const E={};Object.keys(g).forEach(n=>{const l=g[n];H.isString(l)?E[n]={presence:{allowEmpty:!1,message:`^請輸入${l}`}}:E[n]=l});const V={},d=H(y,E);return d&&Object.keys(d).forEach(n=>V[`${u}${n}`]=d[n].join(",")),V},I=z.defineStore("progress",{actions:{init(y,g){var u;this[y]={id:g.ProjectID,type:(u=g.SubsidyPlanType)==null?void 0:u.split(" ")[0],name:g.ProjectName,step:g.FormStep,status:g.Status,progress:g.ProgressStatus,organizer:g.Organizer,organizerName:g.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})}),Ve={class:"block"},pe={class:"mt-4"},fe={class:"table align-middle gray-table side-table"},Ne={key:0},ue={key:1,class:"text-light-gray"},Ee={class:"d-flex flex-column gap-2"},be={key:0},ke={class:"mt-4"},ge={class:"table align-middle gray-table side-table"},ye={class:"row g-3"},he={class:"col-12 col-xl-2"},$e={class:"text-gray mb-2"},xe={class:"col-12 col-xl-3"},Be={class:"text-gray mb-2"},Ce={class:"col-12 col-xl-4"},_e={class:"row g-1"},Te={class:"col-7"},we={class:"col-5"},De={class:"col-12 col-xl-3"},Se={class:"text-gray mb-2"},Ue={class:"col-12"},Ae={class:"text-gray mb-2"},Oe={class:"mt-4"},Me={class:"table align-middle gray-table side-table"},Ie={class:"mt-4"},je={class:"table align-middle gray-table side-table"},Fe={key:0,class:"table-responsive mt-3 mb-0"},Pe={class:"table align-middle gray-table"},qe={key:0},Re={key:0},Le={class:"d-flex gap-2"},ze=["onClick"],Je={key:0,class:"block-bottom bg-light-teal"},Ge={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.ref(),V=e.computed(()=>P("accessibility",l.value.Status,1)),d=e.ref({}),n=e.computed(()=>r.value.filter(h=>!h.Deleted)),l=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!n.value.length,set:h=>{h?s():r.value.forEach(o=>o.Deleted=!0)}}),s=()=>r.value.push({}),p=h=>h.Deleted=!0,c=h=>{if(d.value={},h&&!b()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:l.value,Contacts:E.value,ReceivedSubsidies:r.value.filter(N=>N.ID||!N.Deleted),Submit:h?"true":"false"};D.accessibility("saveApplication",o).subscribe(N=>{h?window.location.href=`WorkSchedule.aspx?ID=${N.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${N.ID}`})},b=()=>{let h={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return l.value.OrgCategory==="2"&&(h.RegisteredNum="立案登記證字號"),d.value=U(l.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((o,N)=>Object.assign(d.value,U(o,h,`contact-${N}-`))),h={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},r.value.forEach((o,N)=>Object.assign(d.value,U(o,h,`received-${N}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(h=>{u.value=h[0],g.id?D.accessibility("getApplication",{ID:g.id}).subscribe(o=>{l.value=o.Project,E.value=o.Contacts,r.value=o.ReceivedSubsidies,l.value.OrgCategory=l.value.OrgCategory||null,I().init("accessibility",l.value)}):D.accessibility("getEmptyApplication").subscribe(o=>{l.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},o),E.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("accessibility",l.value)})})}),e.provide("editable",V),(h,o)=>{const N=e.resolveComponent("required-label"),m=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),i=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ve,[o[37]||(o[37]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",pe,[e.createElementVNode("table",fe,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[o[13]||(o[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[o[14]||(o[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",Ne,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",ue,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[o[15]||(o[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[16]||(o[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).ProjectName,modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":o[0]||(o[0]=_=>e.unref(l).ProjectName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[17]||(o[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":o[1]||(o[1]=_=>e.unref(l).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[18]||(o[18]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ee,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(u),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).OrgCategory,"onUpdate:modelValue":o[2]||(o[2]=_=>e.unref(l).OrgCategory=_)},null,8,["error","options","modelValue"])]),e.unref(l).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",be,[e.createVNode(m,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(l).RegisteredNum,"onUpdate:modelValue":o[3]||(o[3]=_=>e.unref(l).RegisteredNum=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[19]||(o[19]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(l).TaxID,"onUpdate:modelValue":o[4]||(o[4]=_=>e.unref(l).TaxID=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[20]||(o[20]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":o[5]||(o[5]=_=>e.unref(l).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),o[38]||(o[38]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ke,[e.createElementVNode("table",ge,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",ye,[e.createElementVNode("div",he,[e.createElementVNode("div",$e,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[21]||(o[21]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",xe,[e.createElementVNode("div",Be,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[22]||(o[22]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":x=>_.JobTitle=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ce,[o[23]||(o[23]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",_e,[e.createElementVNode("div",Te,[e.createVNode(m,{modelValue:_.Phone,"onUpdate:modelValue":x=>_.Phone=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",we,[e.createVNode(m,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":x=>_.PhoneExt=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",De,[e.createElementVNode("div",Se,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[24]||(o[24]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":x=>_.MobilePhone=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ue,[e.createElementVNode("div",Ae,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[25]||(o[25]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":x=>_.EMail=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),o[39]||(o[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Oe,[e.createElementVNode("table",Me,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[26]||(o[26]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[o[27]||(o[27]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(i,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(l).Target,"onUpdate:modelValue":o[6]||(o[6]=_=>e.unref(l).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[28]||(o[28]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":o[7]||(o[7]=_=>e.unref(l).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[29]||(o[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":o[8]||(o[8]=_=>e.unref(l).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[30]||(o[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Qualitative,"onUpdate:modelValue":o[9]||(o[9]=_=>e.unref(l).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Ie,[e.createElementVNode("table",je,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[o[36]||(o[36]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(a),"onUpdate:modelValue":o[10]||(o[10]=_=>e.isRef(a)?a.value=_:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Fe,[e.createElementVNode("table",Pe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[31]||(o[31]=e.createElementVNode("th",null,"計畫名稱",-1)),o[32]||(o[32]=e.createElementVNode("th",null,"補助單位",-1)),o[33]||(o[33]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",qe,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d)[`received-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d)[`received-${T}-Unit`],modelValue:_.Unit,"onUpdate:modelValue":x=>_.Unit=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d)[`received-${T}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":x=>_.Amount=x},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Re,[e.createElementVNode("div",Le,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:x=>p(_),type:"button"},[...o[34]||(o[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ze)):e.createCommentVNode("",!0),T+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...o[35]||(o[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Je,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[11]||(o[11]=_=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[12]||(o[12]=_=>c(!0)),type:"button"},[...o[40]||(o[40]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Qe={class:"block"},We={key:0,class:"text-pink lh-base mt-4"},Ye={class:"mt-4"},He={class:"table align-middle gray-table"},Ze={class:"text-center"},Ke={key:0,width:"180"},Xe={class:"text-center"},ve={key:0},et=["innerHTML"],tt={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},lt={key:0,class:"text-center"},ot={key:0},nt={key:1,class:"text-pink"},rt={key:1,class:"tag-group mt-2 gap-1"},at={key:0,class:"tag tag-green-light"},dt=["download","href"],st=["onClick"],ct={key:0,class:"block-bottom bg-light-teal"},it=["disabled"],mt={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),E=e.computed(()=>u.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("accessibility",d.value.Status,2)),d=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,r=a=>{const s={ID:g.id,Attachments:u.value.reduce((p,c)=>p.concat(c.Files),[]),Submit:a?"true":"false"};D.accessibility("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,u.value=u.value.filter(p=>{var c;return!((c=p.Excludes)!=null&&c.includes(d.value.OrgCategory))}),u.value.forEach(p=>{p.Files=s.Attachments.filter(c=>c.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(c=>!c.Deleted).length)}),I().init("accessibility",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),c=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Qe,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",We,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Ye,[e.createElementVNode("table",He,[e.createElementVNode("thead",Ze,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ke,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Xe,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",ve,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,et)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",tt,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",lt,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",ot,"已上傳")):(e.openBlock(),e.createElementBlock("span",nt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(c,{key:0,accept:".pdf",onFile:o=>n(b,o)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",rt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",at,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,dt),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>o.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,st)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ct,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(E),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,it)])):e.createCommentVNode("",!0)],64)}}},Vt={class:"block"},pt={class:"mt-4"},ft={class:"table-responsive mt-3 mb-0"},Nt={class:"table align-middle gray-table"},ut={key:0,width:"1"},Et={key:0},bt={class:"d-flex gap-2"},kt=["onClick"],gt={class:"table-responsive mt-3 mb-0"},yt={class:"table align-middle gray-table"},ht={key:0,class:"block-bottom bg-light-teal"},$t={__name:"Benefit",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.computed(()=>P("accessibility",n.value.Status,4)),V=e.ref({}),d=e.computed(()=>u.value.filter(p=>!p.Deleted)),n=e.ref({}),l=()=>u.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const c={Project:n.value,Benefits:u.value,Submit:p?"true":"false"};D.accessibility("saveBenefit",c).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(n.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((c,b)=>Object.assign(V.value,U(c,p,`item-${b}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getBenefit",{ID:g.id})]).subscribe(p=>{const c=p[0];n.value=c.Project,u.value=c.Benefits,u.value.length||l(),I().init("accessibility",n.value)})}),e.provide("editable",E),(p,c)=>{const b=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Vt,[c[9]||(c[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",pt,[e.createElementVNode("div",ft,[e.createElementVNode("table",Nt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[c[3]||(c[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),c[4]||(c[4]=e.createElementVNode("th",null,"目標值",-1)),c[5]||(c[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",ut,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(o,N)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Title`],modelValue:o.Title,"onUpdate:modelValue":m=>o.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Target`],modelValue:o.Target,"onUpdate:modelValue":m=>o.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:o.Description,"onUpdate:modelValue":m=>o.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Et,[e.createElementVNode("div",bt,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>r(o),type:"button"},[...c[6]||(c[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,kt)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...c[7]||(c[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",gt,[e.createElementVNode("table",yt,[c[8]||(c[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":c[0]||(c[0]=o=>e.unref(n).Benefit=o),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",ht,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[1]||(c[1]=o=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[2]||(c[2]=o=>a(!0)),type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},xt={class:"block"},Bt={class:"mt-4"},Ct={class:"table-responsive mt-3 mb-0"},_t={class:"table align-middle gray-table"},Tt={class:"text-end"},wt={class:"text-end"},Dt={class:"table-responsive"},St={class:"table align-middle gray-table"},Ut=["colspan"],At={key:0,width:"1"},Ot={class:"text-end"},Mt={key:0},It={class:"d-flex gap-2"},jt=["onClick"],Ft={class:"mt-4"},Pt={class:"table-responsive mt-3 mb-0"},qt={class:"table align-middle gray-table"},Rt={key:0,width:"1"},Lt={class:"text-end"},zt={key:0},Jt={class:"d-flex gap-2"},Gt=["onClick"],Qt={key:0,class:"block-bottom bg-light-teal"},Wt={class:"text-center"},Yt={class:"mb-5"},Ht={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,u=e.computed(()=>P("accessibility",n.value.Status,3)),E=e.ref({}),V=e.computed(()=>r.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),n=e.ref({}),l=e.ref(),r=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),c=()=>r.value.push({}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,o=(m,t)=>{if(E.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&n.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>o(m,!0));return}const i={Project:n.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:m?"true":"false"};D.accessibility("saveFunding",i).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return E.value=U(n.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},r.value.forEach((t,i)=>Object.assign(E.value,U(t,m,`other-${i}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,i)=>Object.assign(E.value,U(t,m,`plan-${i}-`))),!Object.keys(E.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getFunding",{ID:g.id})]).subscribe(m=>{const t=m[0];n.value=t.Project,r.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,r.value.length||c(),a.value.length||b(),I().init("accessibility",n.value)})}),e.provide("editable",u),e.watchEffect(()=>{n.value.OtherAmount=V.value.reduce((m,t)=>m+j(t.Amount),0),p.value=j(n.value.ApplyAmount)+j(n.value.SelfAmount)+j(n.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(j(m.Amount)/n.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=j(m.Amount)+j(m.OtherAmount))}),(m,t)=>{var T;const i=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xt,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Bt,[e.createElementVNode("div",Ct,[e.createElementVNode("table",_t,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(n).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(n).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",Tt,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",wt,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Dt,[e.createElementVNode("table",St,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(u)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Ut)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",At,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(E)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":k=>x.Unit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Ot,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":k=>x.Content=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Mt,[e.createElementVNode("div",It,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jt)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ft,[e.createElementVNode("div",Pt,[e.createElementVNode("table",qt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Rt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(E)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":k=>x.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":k=>x.OtherAmount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Lt,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":k=>x.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",zt,[e.createElementVNode("div",Jt,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Gt)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Qt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>o(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",Wt,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Yt,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Zt={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,E)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"accessibility"})}}},Kt={class:"block"},Xt={class:"mt-4"},vt={class:"table align-middle gray-table side-table"},el={key:0,class:"d-flex align-items-center gap-2"},tl={class:"input-group w-auto"},ll={class:"text-teal-dark"},ol={key:1,class:"invalid mt-0"},nl={class:"table-responsive mt-4"},rl={class:"table align-middle gray-table"},al={key:0},dl={class:"input-group"},sl={key:0,class:"invalid mt-0"},cl={key:0},il={class:"d-flex gap-2"},ml=["onClick"],Vl={class:"mt-4"},pl={class:"table align-middle gray-table"},fl={key:0},Nl={key:0},ul={class:"d-flex gap-2"},El=["onClick"],bl={key:0,class:"block-bottom bg-light-teal"},kl={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,u=[{value:1,text:"50%"},{value:2,text:"100%"}],E=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("accessibility",r.value.Status,2)),d=e.ref({}),n=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),r=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),c=()=>D.accessibility("createItem",{ID:g.id}).subscribe(m=>s.value.push(m)),b=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,o=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};D.accessibility("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(r.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},n.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`item-${i}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`schedule-${i}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getWorkSchedule",{ID:g.id})]).subscribe(m=>{const t=m[0];r.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||c(),p.value.length||b(),I().init("accessibility",r.value)})}),e.provide("editable",V),(m,t)=>{const i=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kt,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Xt,[e.createElementVNode("table",vt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(E)?(e.openBlock(),e.createElementBlock("div",el,[e.createElementVNode("div",tl,[e.createVNode(f,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":t[0]||(t[0]=k=>e.unref(r).StartTime=k)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":t[1]||(t[1]=k=>e.unref(r).EndTime=k)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",ll,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(E)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",ol,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",nl,[e.createElementVNode("table",rl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",al,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:k.Title,"onUpdate:modelValue":C=>k.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",dl,[e.createVNode(T,{"empty-value":0,modelValue:k.Begin,"onUpdate:modelValue":C=>k.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:k.End,"onUpdate:modelValue":C=>k.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",sl,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",cl,[e.createElementVNode("div",il,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ml)):e.createCommentVNode("",!0),B+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Vl,[e.createElementVNode("table",pl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",fl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:u,modelValue:k.Type,"onUpdate:modelValue":C=>k.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(n),"text-name":"Title","value-name":"ID",modelValue:k.ItemID,"onUpdate:modelValue":C=>k.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(k.ItemID?String.fromCharCode(65+e.unref(n).findIndex(C=>C.ID===k.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Nl,[e.createElementVNode("div",ul,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,El)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",bl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=k=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=k=>o(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},gl={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},yl={class:"modal-content"},hl={class:"modal-body"},$l={class:"d-flex justify-content-center mt-4 gap-4"},xl={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Bl={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(y,{expose:g}){let u;const E=e.ref(),V=y,d=()=>{u&&u()};return g({show:l=>{u=l,bootstrap.Modal.getOrCreateInstance(E.value).show()}}),(l,r)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",gl,[e.createElementVNode("div",yl,[r[0]||(r[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",hl,[e.renderSlot(l.$slots,"default"),e.createElementVNode("div",$l,[e.createElementVNode("button",xl,e.toDisplayString(V.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:d,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(V.confirm),1)])])])])],512)]))}},Cl={class:"application-step"},_l=["onClick"],Tl={class:"step-content"},wl={class:"step-label"},Dl={key:0,class:"step-status edit"},Sl={key:1,class:"step-status"},Ul={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(y,{emit:g}){const u=e.computed(()=>P(V.type,E[V.type].status,V.step)),E=I(),V=y,d=l=>{V.review?n("click",l.step):l.step<=E[V.type].step&&(location.href=`${l.url}.aspx?ID=${V.id}`)},n=g;return(l,r)=>(e.openBlock(),e.createElementBlock("div",Cl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.steps,a=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(u)&&(a.step<e.unref(E)[y.type].step||a.step===y.step)}]),onClick:s=>d(a),key:a,role:"button"},[e.createElementVNode("div",Tl,[e.createElementVNode("div",wl,e.toDisplayString(a.title),1),e.unref(u)&&a.step===y.step?(e.openBlock(),e.createElementBlock("div",Dl,"編輯中")):a.step<e.unref(E)[y.type].step?(e.openBlock(),e.createElementBlock("div",Sl,"已完成")):e.createCommentVNode("",!0)])],10,_l))),128))]))}},Al={class:"block"},Ol={class:"mt-4"},Ml={class:"table align-middle gray-table side-table"},Il={key:0},jl={key:1,class:"text-light-gray"},Fl={class:"d-flex gap-2"},Pl={key:0,class:"invalid mt-0"},ql={class:"d-flex flex-column gap-2"},Rl={key:0},Ll={class:"mt-4"},zl={class:"table align-middle gray-table side-table"},Jl={class:"row g-3"},Gl={class:"col-12 col-xl-2"},Ql={class:"text-gray mb-2"},Wl={class:"col-12 col-xl-3"},Yl={class:"text-gray mb-2"},Hl={class:"col-12 col-xl-4"},Zl={class:"row g-1"},Kl={class:"col-7"},Xl={class:"col-5"},vl={class:"col-12 col-xl-3"},eo={class:"text-gray mb-2"},to={class:"col-12"},lo={class:"text-gray mb-2"},oo={class:"mt-4"},no={class:"table align-middle gray-table side-table"},ro={class:"mt-4"},ao={class:"table align-middle gray-table side-table"},so={key:0,class:"table-responsive mt-3 mb-0"},co={class:"table align-middle gray-table"},io={key:0},mo={key:0},Vo={class:"d-flex gap-2"},po=["onClick"],fo={key:0,class:"block-bottom bg-light-teal"},No={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.ref(),V=e.computed(()=>P("culture",a.value.Status,1)),d=e.ref({}),n=e.ref(null),l=e.ref([]),r=e.computed(()=>p.value.filter(t=>!t.Deleted)),a=e.ref({}),s=e.computed(()=>l.value.filter(t=>!t.ParentCode)),p=e.ref([]),c=e.computed(()=>l.value.filter(t=>t.ParentCode===n.value)),b=e.computed({get:()=>!!r.value.length,set:t=>{t?h():p.value.forEach(i=>i.Deleted=!0)}}),h=()=>p.value.push({}),o=t=>t.Deleted=!0,N=t=>{if(d.value={},t&&!m()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:a.value,Contacts:E.value,ReceivedSubsidies:p.value.filter(f=>f.ID||!f.Deleted),Submit:t?"true":"false"};D.culture("saveApplication",i).subscribe(f=>{t?window.location.href=`WorkSchedule.aspx?ID=${f.ID}`:a.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${f.ID}`})},m=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),d.value=U(a.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((i,f)=>Object.assign(d.value,U(i,t,`contact-${f}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},p.value.forEach((i,f)=>Object.assign(d.value,U(i,t,`received-${f}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getZgsCodes",{CodeGroup:"CULField"}),D.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{l.value=t[0],u.value=t[1],g.id?D.culture("getApplication",{ID:g.id}).subscribe(i=>{var f;a.value=i.Project,E.value=i.Contacts,p.value=i.ReceivedSubsidies,n.value=((f=l.value.find(S=>S.Code===a.value.Field))==null?void 0:f.ParentCode)||null,a.value.OrgCategory=a.value.OrgCategory||null,I().init("culture",a.value)}):D.culture("getEmptyApplication").subscribe(i=>{n.value=null,a.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},i),E.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("culture",a.value)})})}),e.provide("editable",V),e.watch(n,()=>{n.value?c.value.find(t=>a.value.Field===t.Code)||(a.value.Field=c.value[0].Code):a.value.Field=null}),(t,i)=>{const f=e.resolveComponent("required-label"),S=e.resolveComponent("input-text"),_=e.resolveComponent("input-select"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Al,[i[40]||(i[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Ol,[e.createElementVNode("table",Ml,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[15]||(i[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).Year),1)]),e.createElementVNode("tr",null,[i[16]||(i[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(a).ProjectID?(e.openBlock(),e.createElementBlock("span",Il,e.toDisplayString(e.unref(a).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",jl,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[i[17]||(i[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[18]||(i[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).ProjectName,modelValue:e.unref(a).ProjectName,"onUpdate:modelValue":i[0]||(i[0]=k=>e.unref(a).ProjectName=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[19]||(i[19]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Fl,[e.createVNode(_,{"empty-value":null,options:e.unref(s),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n),"onUpdate:modelValue":i[1]||(i[1]=k=>e.isRef(n)?n.value=k:null)},null,8,["options","modelValue"]),e.createVNode(_,{"empty-value":null,disabled:!e.unref(n),options:e.unref(c),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).Field,"onUpdate:modelValue":i[2]||(i[2]=k=>e.unref(a).Field=k)},null,8,["disabled","options","modelValue"])]),e.unref(d).Field?(e.openBlock(),e.createElementBlock("div",Pl,e.toDisplayString(e.unref(d).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[20]||(i[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(a).OrgName,"onUpdate:modelValue":i[3]||(i[3]=k=>e.unref(a).OrgName=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[21]||(i[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",ql,[e.createElementVNode("div",null,[e.createVNode(_,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(u),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).OrgCategory,"onUpdate:modelValue":i[4]||(i[4]=k=>e.unref(a).OrgCategory=k)},null,8,["error","options","modelValue"])]),e.unref(a).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Rl,[e.createVNode(S,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(a).RegisteredNum,"onUpdate:modelValue":i[5]||(i[5]=k=>e.unref(a).RegisteredNum=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[22]||(i[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(a).TaxID,"onUpdate:modelValue":i[6]||(i[6]=k=>e.unref(a).TaxID=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[23]||(i[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(a).Address,"onUpdate:modelValue":i[7]||(i[7]=k=>e.unref(a).Address=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),i[41]||(i[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ll,[e.createElementVNode("table",zl,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Jl,[e.createElementVNode("div",Gl,[e.createElementVNode("div",Ql,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[24]||(i[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-Name`],modelValue:k.Name,"onUpdate:modelValue":C=>k.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Wl,[e.createElementVNode("div",Yl,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[25]||(i[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-JobTitle`],modelValue:k.JobTitle,"onUpdate:modelValue":C=>k.JobTitle=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Hl,[i[26]||(i[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Zl,[e.createElementVNode("div",Kl,[e.createVNode(S,{modelValue:k.Phone,"onUpdate:modelValue":C=>k.Phone=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Xl,[e.createVNode(S,{placeholder:"請輸入分機",size:"4",modelValue:k.PhoneExt,"onUpdate:modelValue":C=>k.PhoneExt=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",vl,[e.createElementVNode("div",eo,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[27]||(i[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-MobilePhone`],modelValue:k.MobilePhone,"onUpdate:modelValue":C=>k.MobilePhone=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",to,[e.createElementVNode("div",lo,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[28]||(i[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-EMail`],modelValue:k.EMail,"onUpdate:modelValue":C=>k.EMail=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),i[42]||(i[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",oo,[e.createElementVNode("table",no,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[29]||(i[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[i[30]||(i[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(T,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(a).Target,"onUpdate:modelValue":i[8]||(i[8]=k=>e.unref(a).Target=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[31]||(i[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(a).Summary,"onUpdate:modelValue":i[9]||(i[9]=k=>e.unref(a).Summary=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[32]||(i[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Quantified,"onUpdate:modelValue":i[10]||(i[10]=k=>e.unref(a).Quantified=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...i[33]||(i[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Qualitative,"onUpdate:modelValue":i[11]||(i[11]=k=>e.unref(a).Qualitative=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ro,[e.createElementVNode("table",ao,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[39]||(i[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(x,{modelValue:e.unref(b),"onUpdate:modelValue":i[12]||(i[12]=k=>e.isRef(b)?b.value=k:null)},null,8,["modelValue"]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",so,[e.createElementVNode("table",co,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[34]||(i[34]=e.createElementVNode("th",null,"計畫名稱",-1)),i[35]||(i[35]=e.createElementVNode("th",null,"補助單位",-1)),i[36]||(i[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",io,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d)[`received-${B}-Name`],modelValue:k.Name,"onUpdate:modelValue":C=>k.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d)[`received-${B}-Unit`],modelValue:k.Unit,"onUpdate:modelValue":C=>k.Unit=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(d)[`received-${B}-Amount`],modelValue:k.Amount,"onUpdate:modelValue":C=>k.Amount=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",mo,[e.createElementVNode("div",Vo,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>o(k),type:"button"},[...i[37]||(i[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,po)):e.createCommentVNode("",!0),B+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...i[38]||(i[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",fo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[13]||(i[13]=k=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[14]||(i[14]=k=>N(!0)),type:"button"},[...i[43]||(i[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},uo={class:"block"},Eo={key:0,class:"text-pink lh-base mt-4"},bo={class:"mt-4"},ko={class:"table align-middle gray-table"},go={class:"text-center"},yo={key:0,width:"180"},ho={class:"text-center"},$o={key:0},xo=["innerHTML"],Bo={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Co={key:0,class:"text-center"},_o={key:0},To={key:1,class:"text-pink"},wo={key:1,class:"tag-group mt-2 gap-1"},Do={key:0,class:"tag tag-green-light"},So=["download","href"],Uo=["onClick"],Ao={key:0,class:"block-bottom bg-light-teal"},Oo=["disabled"],Mo={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:!0,Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),E=e.computed(()=>u.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("culture",d.value.Status,5)),d=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,r=a=>{const s={ID:g.id,Attachments:u.value.reduce((p,c)=>p.concat(c.Files),[]),Submit:a?"true":"false"};D.culture("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,u.value=u.value.filter(p=>{var c;return!((c=p.Excludes)!=null&&c.includes(d.value.OrgCategory))}),d.value.Status>=10&&u.value.push({Type:6,Title:"著作權授權同意書",Template:!0,Files:[]}),u.value.forEach(p=>{p.Files=s.Attachments.filter(c=>c.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(c=>!c.Deleted).length)}),I().init("culture",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),c=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",uo,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",Eo,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",bo,[e.createElementVNode("table",ko,[e.createElementVNode("thead",go,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",yo,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",ho,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",$o,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,xo)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",Bo,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Co,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",_o,"已上傳")):(e.openBlock(),e.createElementBlock("span",To,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(c,{key:0,accept:".pdf",onFile:o=>n(b,o)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",wo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Do,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,So),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>o.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Uo)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Ao,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(E),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Oo)])):e.createCommentVNode("",!0)],64)}}},Io={class:"block"},jo={class:"mt-4"},Fo={class:"table-responsive mt-3 mb-0"},Po={class:"table align-middle gray-table"},qo={class:"text-end"},Ro={class:"text-end"},Lo={class:"table-responsive"},zo={class:"table align-middle gray-table"},Jo=["colspan"],Go={key:0,width:"1"},Qo={key:0},Wo={class:"d-flex gap-2"},Yo=["onClick"],Ho={class:"mt-4"},Zo={class:"table-responsive mt-3 mb-0"},Ko={class:"table align-middle gray-table"},Xo={key:0,width:"1"},vo={class:"text-end"},en={key:0},tn={class:"d-flex gap-2"},ln=["onClick"],on={key:0,class:"block-bottom bg-light-teal"},nn={class:"text-center"},rn={class:"mb-5"},an={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,u=e.computed(()=>P("culture",n.value.Status,3)),E=e.ref({}),V=e.computed(()=>a.value.filter(i=>!i.Deleted)),d=e.computed(()=>s.value.filter(i=>!i.Deleted)),n=e.ref({}),l=e.ref([]),r=e.ref(),a=e.ref([]),s=e.ref([]),p=e.ref({}),c=e.ref(0),b=()=>a.value.push({}),h=()=>s.value.push({ItemID:0}),o=i=>i.Deleted=!0,N=i=>i.Deleted=!0,m=(i,f)=>{if(E.value={},i&&!t()){e.nextTick(()=>{var _;return(_=document.querySelector(".invalid"))==null?void 0:_.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!f&&n.value.ApplyAmount>p.value.GrantLimit*1e4){r.value.show(()=>m(i,!0));return}const S={Project:n.value,OtherSubsidies:a.value,BudgetPlans:s.value,Submit:i?"true":"false"};D.culture("saveFunding",S).subscribe(()=>{i?window.location.href=`Other.aspx?ID=${g.id}`:window.location.reload()})},t=()=>{let i={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return E.value=U(n.value,i),i={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},a.value.forEach((f,S)=>Object.assign(E.value,U(f,i,`other-${S}-`))),i={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},s.value.forEach((f,S)=>Object.assign(E.value,U(f,i,`plan-${S}-`))),!Object.keys(E.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getFunding",{ID:g.id})]).subscribe(i=>{const f=i[0];n.value=f.Project,a.value=f.OtherSubsidies,s.value=f.BudgetPlans,l.value=f.Items,p.value=f.GrantTargetSetting,a.value.length||b(),s.value.length||h(),I().init("culture",n.value)})}),e.provide("editable",u),e.watchEffect(()=>{n.value.OtherAmount=a.value.reduce((i,f)=>i+(f.Deleted?0:j(f.Amount)),0),c.value=j(n.value.ApplyAmount)+j(n.value.SelfAmount)+j(n.value.OtherAmount),s.value.forEach(i=>i.sum=j(i.Amount)+j(i.OtherAmount))}),(i,f)=>{var k;const S=e.resolveComponent("input-integer"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-select"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Io,[f[20]||(f[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",jo,[e.createElementVNode("div",Fo,[e.createElementVNode("table",Po,[f[4]||(f[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":f[0]||(f[0]=B=>e.unref(n).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":f[1]||(f[1]=B=>e.unref(n).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",qo,e.toDisplayString((k=e.unref(n).OtherAmount)==null?void 0:k.toLocaleString()),1),e.createElementVNode("td",Ro,e.toDisplayString(e.unref(c).toLocaleString()),1)])])])]),f[10]||(f[10]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Lo,[e.createElementVNode("table",zo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(u)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Jo)]),e.createElementVNode("tr",null,[f[5]||(f[5]=e.createElementVNode("th",{width:"1"},null,-1)),f[6]||(f[6]=e.createElementVNode("th",null,"單位名稱",-1)),f[7]||(f[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Go,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(E)[`other-${C}-Unit`],modelValue:B.Unit,"onUpdate:modelValue":A=>B.Unit=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`other-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Qo,[e.createElementVNode("div",Wo,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>o(B),type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Yo)):e.createCommentVNode("",!0),C+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...f[9]||(f[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),f[21]||(f[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ho,[e.createElementVNode("div",Zo,[e.createElementVNode("table",Ko,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[11]||(f[11]=e.createElementVNode("th",null,"重要工作項目",-1)),f[12]||(f[12]=e.createElementVNode("th",null,"預算項目",-1)),f[13]||(f[13]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),f[14]||(f[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),f[15]||(f[15]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),f[16]||(f[16]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Xo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(T,{"empty-value":0,error:e.unref(E)[`plan-${C}-ItemID`],options:e.unref(l),"text-name":"Title","value-name":"ID",modelValue:B.ItemID,"onUpdate:modelValue":A=>B.ItemID=A},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(E)[`plan-${C}-Title`],modelValue:B.Title,"onUpdate:modelValue":A=>B.Title=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`plan-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`plan-${C}-OtherAmount`],modelValue:B.OtherAmount,"onUpdate:modelValue":A=>B.OtherAmount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",vo,e.toDisplayString(B.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(E)[`plan-${C}-Description`],rows:"1",modelValue:B.Description,"onUpdate:modelValue":A=>B.Description=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",en,[e.createElementVNode("div",tn,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>N(B),type:"button"},[...f[17]||(f[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ln)):e.createCommentVNode("",!0),C+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...f[18]||(f[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),f[19]||(f[19]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",on,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=B=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=B=>m(!0)),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(w,{ref_key:"modal",ref:r},{default:e.withCtx(()=>[e.createElementVNode("div",nn,[f[23]||(f[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",rn,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(p).GrantLimit)+"萬",1),f[24]||(f[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),f[25]||(f[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},dn={class:"block"},sn={key:0,class:"text-pink lh-base mt-3"},cn={class:"border"},mn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Vn={class:"d-flex gap-2 align-items-center flex-grow-1"},pn={class:"text-nowrap"},fn={class:"flex-grow-1"},Nn={class:"d-flex gap-2"},un=["onClick"],En=["href"],bn=["id"],kn={class:"table align-middle gray-table side-table mb-0"},gn={key:0,class:"block-bottom bg-light-teal"},yn={__name:"Other",props:{id:{type:Number}},setup(y){const g=y,u=e.computed(()=>P("culture",V.value.Status,4)),E=e.ref({}),V=e.ref({}),d=e.ref([]),n=e.computed(()=>d.value.filter(p=>!p.Deleted)),l=()=>d.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(E.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const c={ID:g.id,Projects:d.value,Submit:p?"true":"false"};D.culture("saveRelatedProject",c).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{E.value={};const p={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return n.value.forEach((c,b)=>Object.assign(E.value,U(c,p,`project-${b}-`))),!Object.keys(E.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getRelatedProject",{ID:g.id})]).subscribe(p=>{const c=p[0];V.value=c.Project,d.value=c.Projects,I().init("culture",V.value)})}),e.provide("editable",u),(p,c)=>{const b=e.resolveComponent("required-label"),h=e.resolveComponent("input-text"),o=e.resolveComponent("input-integer"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",dn,[c[9]||(c[9]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("p",sn," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(m,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:m},[e.createElementVNode("div",cn,[e.createElementVNode("div",mn,[e.createElementVNode("div",Vn,[e.createElementVNode("label",pn,[e.createVNode(b,null,{default:e.withCtx(()=>[...c[2]||(c[2]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",fn,[e.createVNode(h,{error:e.unref(E)[`project-${t}-Title`],modelValue:m.Title,"onUpdate:modelValue":i=>m.Title=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Nn,[e.unref(u)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(i=>r(m),["prevent"]),href:"#"},"刪除",8,un)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,En)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",kn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...c[3]||(c[3]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(o,{class:"text-start w-auto",error:e.unref(E)[`project-${t}-Year`],modelValue:m.Year,"onUpdate:modelValue":i=>m.Year=i},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...c[4]||(c[4]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(E)[`project-${t}-OrgName`],modelValue:m.OrgName,"onUpdate:modelValue":i=>m.OrgName=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...c[5]||(c[5]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(o,{class:"w-auto",error:e.unref(E)[`project-${t}-Amount`],modelValue:m.Amount,"onUpdate:modelValue":i=>m.Amount=i},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...c[6]||(c[6]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(E)[`project-${t}-Description`],rows:"4",modelValue:m.Description,"onUpdate:modelValue":i=>m.Description=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...c[7]||(c[7]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(E)[`project-${t}-Benefit`],rows:"4",modelValue:m.Benefit,"onUpdate:modelValue":i=>m.Benefit=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,bn)])]))),128)),e.unref(u)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:l,type:"button"},[...c[8]||(c[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",gn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[0]||(c[0]=m=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[1]||(c[1]=m=>a(!0)),type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},hn={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,E)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"culture"})}}},$n=(y,g)=>{const u=y.__vccOpts||y;for(const[E,V]of g)u[E]=V;return u},xn={class:"block"},Bn={class:"mt-4"},Cn={class:"table align-middle gray-table side-table"},_n={key:0,class:"d-flex align-items-center gap-2"},Tn={class:"input-group w-auto"},wn={class:"text-teal-dark"},Dn={key:1,class:"invalid mt-0"},Sn={class:"square-title mt-4"},Un={class:"mt-4"},An=["onClick"],On={class:"d-flex flex-column gap-2"},Mn={class:"mt-4 d-flex flex-column gap-2"},In={class:"d-flex flex-column gap-3 mt-4"},jn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Fn={class:"d-flex gap-2 align-items-center flex-grow-1"},Pn={class:"text-nowrap"},qn={class:"flex-grow-1"},Rn={class:"d-flex gap-2"},Ln=["onClick"],zn=["href"],Jn=["id"],Gn={class:"table align-middle gray-table side-table mb-0"},Qn={class:"p-0"},Wn={class:"item-list"},Yn={class:"mt-2 align-self-start text-center"},Hn={class:"input-group"},Zn={key:0,class:"invalid mt-0"},Kn={key:0,class:"d-flex gap-2 mt-1 align-self-start"},Xn=["onClick"],vn=["onClick"],er={class:"row"},tr={class:"col"},lr=["value"],or={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},nr=["onClick"],rr=["onClick"],ar={class:"col"},dr=["value"],sr={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},cr=["onClick"],ir=["onClick"],mr=["onClick"],Vr={key:0,class:"block-bottom bg-light-teal"},pr=$n({__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,u=e.computed(()=>P("culture",n.value.Status,2)),E=e.computed(()=>r.value.EndDate),V=e.ref({}),d=e.computed(()=>l.value.filter(i=>!i.Deleted)),n=e.ref({}),l=e.ref([]),r=e.ref({}),a=()=>{const i={Items:[]};s(i),l.value.push(i)},s=i=>{const f={Steps:[],Schedules:[]};c(f),c(f),c(f),p(f,1),p(f,2),i.Items.push(f)},p=(i,f)=>i.Schedules.push({Type:f,Month:0,StepID:0}),c=i=>D.culture("createGoalStep",{ID:g.id,ItemID:i.ID}).subscribe(f=>i.Steps.push(f)),b=i=>i.Deleted=!0,h=i=>i.Deleted=!0,o=i=>i.Deleted=!0,N=i=>i.Deleted=!0,m=i=>{if(V.value={},i&&!t()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:n.value,Goals:l.value,Submit:i?"true":"false"};D.culture("saveWorkSchedule",f).subscribe(()=>{i?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},t=()=>{const i={StartTime:"計畫期程",EndTime:"計畫期程"};V.value=U(n.value,i);const f={Title:"計畫目標",Content:"預期效益"},S={Title:"重要工作項目",Indicator:"績效指標"},_={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},T={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return l.value.filter(x=>!x.Deleted).forEach((x,w)=>{Object.assign(V.value,U(x,f,`goal-${w}-`)),x.Items.filter(k=>!k.Deleted).forEach((k,B)=>{Object.assign(V.value,U(k,S,`item-${w}-${B}-`)),k.Steps.filter(C=>!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,_,`step-${w}-${B}-${A}-`))),k.Schedules.filter(C=>C.Type===1&&!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,T,`schedule-${w}-${B}-1-${A}-`))),k.Schedules.filter(C=>C.Type===2&&!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,T,`schedule-${w}-${B}-2-${A}-`)))})}),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getWorkSchedule",{ID:g.id})]).subscribe(i=>{const f=i[0];n.value=f.Project,l.value=f.Goals,r.value=f.GrantType,l.value.length||a(),I().init("culture",n.value)})}),e.provide("editable",u),(i,f)=>{const S=e.resolveComponent("required-label"),_=e.resolveComponent("input-tw-date"),T=e.resolveComponent("tw-date"),x=e.resolveComponent("input-text"),w=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-month"),B=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xn,[f[25]||(f[25]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Bn,[e.createElementVNode("table",Cn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[4]||(f[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(E)?(e.openBlock(),e.createElementBlock("div",_n,[e.createElementVNode("div",Tn,[e.createVNode(_,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(n).StartTime,"onUpdate:modelValue":f[0]||(f[0]=C=>e.unref(n).StartTime=C)},null,8,["max-date","modelValue"]),f[5]||(f[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(_,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(n).EndTime,"onUpdate:modelValue":f[1]||(f[1]=C=>e.unref(n).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",wn,[f[6]||(f[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(T,{value:e.unref(E)},null,8,["value"]),f[7]||(f[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(V).StartTime||e.unref(V).EndTime?(e.openBlock(),e.createElementBlock("div",Dn,e.toDisplayString(e.unref(V).StartTime||e.unref(V).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",Sn,[f[9]||(f[9]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:a,type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Un,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(C,A)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:C},[e.unref(u)&&e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:F=>b(C),type:"button"},"刪除",8,An)):e.createCommentVNode("",!0),e.createElementVNode("div",On,[f[10]||(f[10]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`goal-${A}-Title`],modelValue:C.Title,"onUpdate:modelValue":F=>C.Title=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Mn,[f[11]||(f[11]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(w,{error:e.unref(V)[`goal-${A}-Content`],rows:"4",modelValue:C.Content,"onUpdate:modelValue":F=>C.Content=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",In,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Items.filter(F=>!F.Deleted),(F,q)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:F},[e.createElementVNode("div",jn,[e.createElementVNode("div",Fn,[e.createElementVNode("label",Pn,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[12]||(f[12]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",qn,[e.createVNode(x,{error:e.unref(V)[`item-${A}-${q}-Title`],modelValue:F.Title,"onUpdate:modelValue":O=>F.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Rn,[e.unref(u)&&C.Items.filter(O=>!O.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(O=>h(F),["prevent"]),href:"#"},"刪除",8,Ln)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${q}`,role:"button"},"收合",8,zn)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${q}`},[e.createElementVNode("table",Gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[13]||(f[13]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",Qn,[e.createElementVNode("ul",Wn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(F.Steps.filter(O=>!O.Deleted),(O,R)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(u)}]),key:O},[e.createElementVNode("div",Yn,e.toDisplayString(String.fromCharCode(65+R)),1),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`step-${A}-${q}-${R}-Title`],placeholder:"如:進行口訪紀錄",modelValue:O.Title,"onUpdate:modelValue":M=>O.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",Hn,[e.createVNode(k,{"empty-value":0,modelValue:O.Begin,"onUpdate:modelValue":M=>O.Begin=M},null,8,["modelValue","onUpdate:modelValue"]),f[14]||(f[14]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{"empty-value":0,modelValue:O.End,"onUpdate:modelValue":M=>O.End=M},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(V)[`step-${A}-${q}-${R}-Begin`]||e.unref(V)[`step-${A}-${q}-${R}-End`]?(e.openBlock(),e.createElementBlock("div",Zn,e.toDisplayString(e.unref(V)[`step-${A}-${q}-${R}-Begin`]||e.unref(V)[`step-${A}-${q}-${R}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Kn,[F.Steps.filter(M=>!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>N(O),type:"button"},[...f[15]||(f[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Xn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>c(F),type:"button"},[...f[16]||(f[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,vn)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[17]||(f[17]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(V)[`item-${A}-${q}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:F.Indicator,"onUpdate:modelValue":O=>F.Indicator=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[18]||(f[18]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",er,[e.createElementVNode("div",tr,[f[21]||(f[21]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(F.Schedules.filter(O=>O.Type===1&&!O.Deleted),(O,R)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:O},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(u)?3:4}`])},[e.createVNode(k,{error:e.unref(V)[`schedule-${A}-${q}-1-${R}-Month`],"empty-value":0,modelValue:O.Month,"onUpdate:modelValue":M=>O.Month=M},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(u)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(V)[`schedule-${A}-${q}-1-${R}-StepID`],options:F.Steps.filter(M=>!M.Deleted),modelValue:O.StepID,"onUpdate:modelValue":M=>O.StepID=M},{default:e.withCtx(({index:M,option:G})=>[e.createElementVNode("option",{value:G.ID},e.toDisplayString(String.fromCharCode(65+M))+"."+e.toDisplayString(G.Title),9,lr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(u)?(e.openBlock(),e.createElementBlock("div",or,[F.Schedules.filter(M=>M.Type===1&&!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>o(O),type:"button"},[...f[19]||(f[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>p(F,1),type:"button"},[...f[20]||(f[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,rr)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",ar,[f[24]||(f[24]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(F.Schedules.filter(O=>O.Type===2&&!O.Deleted),(O,R)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:O},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(u)?3:4}`])},[e.createVNode(k,{error:e.unref(V)[`schedule-${A}-${q}-2-${R}-Month`],"empty-value":0,modelValue:O.Month,"onUpdate:modelValue":M=>O.Month=M},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(u)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(V)[`schedule-${A}-${q}-2-${R}-StepID`],options:F.Steps.filter(M=>!M.Deleted),modelValue:O.StepID,"onUpdate:modelValue":M=>O.StepID=M},{default:e.withCtx(({index:M,option:G})=>[e.createElementVNode("option",{value:G.ID},e.toDisplayString(String.fromCharCode(65+M))+"."+e.toDisplayString(G.Title),9,dr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(u)?(e.openBlock(),e.createElementBlock("div",sr,[F.Schedules.filter(M=>M.Type===2&&!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>o(O),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,cr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>p(F,2),type:"button"},[...f[23]||(f[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,ir)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Jn)]))),128))]),e.unref(u)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:F=>s(C),type:"button"},"新增工作項目",8,mr)):e.createCommentVNode("",!0)]))),128))])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Vr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=C=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=C=>m(!0)),type:"button"},[...f[26]||(f[26]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-30126158"]]),fr={class:"block"},Nr={class:"mt-4"},ur={class:"table align-middle gray-table side-table"},Er={key:0},br={key:1,class:"text-light-gray"},kr={class:"d-flex flex-column gap-2"},gr={key:0},yr={class:"mt-4"},hr={class:"table align-middle gray-table side-table"},$r={class:"row g-3"},xr={class:"col-12 col-xl-2"},Br={class:"text-gray mb-2"},Cr={class:"col-12 col-xl-3"},_r={class:"text-gray mb-2"},Tr={key:0,class:"col-12 col-xl-4"},wr={class:"row g-1"},Dr={class:"col-7"},Sr={class:"col-5"},Ur={key:1,class:"col-12 col-xl-3"},Ar={class:"text-gray mb-2"},Or={class:"mt-4"},Mr={class:"table align-middle gray-table side-table"},Ir={class:"d-flex align-items-center gap-2"},jr={class:"input-group w-auto"},Fr={key:0,class:"invalid mt-0"},Pr={class:"mt-4"},qr={class:"table-responsive mt-3 mb-0"},Rr={class:"table align-middle gray-table"},Lr={class:"text-end"},zr={class:"text-end"},Jr={class:"text-end"},Gr={class:"text-end"},Qr={class:"text-end"},Wr={class:"table align-middle gray-table side-table"},Yr={key:0,class:"table-responsive mt-3 mb-0"},Hr={class:"table align-middle gray-table"},Zr={key:0},Kr={key:0},Xr={class:"d-flex gap-2"},vr=["onClick"],ea={key:0,class:"block-bottom bg-light-teal"},ta={class:"text-center"},la={class:"mb-5"},oa={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.ref(),V=e.computed(()=>P("education",l.value.Status,1)),d=e.ref({}),n=e.computed(()=>a.value.filter(m=>!m.Deleted)),l=e.ref({}),r=e.ref(),a=e.ref([]),s=e.ref(),p=e.ref(0),c=e.computed({get:()=>!!n.value.length,set:m=>{m?b():a.value.forEach(t=>t.Deleted=!0)}}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,o=(m,t)=>{if(d.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&s.value&&l.value.ApplyAmount>s.value.GrantLimit*1e4){r.value.show(()=>o(m,!0));return}const i={Project:l.value,Contacts:E.value,ReceivedSubsidies:a.value.filter(f=>f.ID||!f.Deleted),Submit:m?"true":"false"};D.education("saveApplication",i).subscribe(f=>{m?window.location.href=`Attachment.aspx?ID=${f.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${f.ID}`})},N=()=>{let m={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return l.value.OrgCategory==="2"&&(m.RegisteredNum="立案登記證字號"),d.value=U(l.value,m),m={Name:"姓名",JobTitle:"職稱"},Object.assign(d.value,U(E.value[0],m,"contact-0-")),m.MobilePhone="手機號碼",Object.assign(d.value,U(E.value[1],m,"contact-1-")),m={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},a.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`received-${i}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(m=>{u.value=m[0],g.id?D.education("getApplication",{ID:g.id}).subscribe(t=>{l.value=t.Project,E.value=t.Contacts,a.value=t.ReceivedSubsidies,l.value.OrgCategory=l.value.OrgCategory||null,I().init("education",l.value)}):D.education("getEmptyApplication").subscribe(t=>{l.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),E.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("education",l.value)})})}),e.provide("editable",V),e.watch(()=>l.value.OrgCategory,()=>{D.education("getGrantTargetSetting",{TargetTypeID:`EDC${l.value.OrgCategory}`}).subscribe(m=>{s.value=m})}),e.watchEffect(()=>{p.value=j(l.value.ApplyAmount)+j(l.value.SelfAmount)+j(l.value.OtherGovAmount)+j(l.value.OtherUnitAmount)}),(m,t)=>{const i=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),_=e.resolveComponent("input-tw-date"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-integer"),w=e.resolveComponent("input-boolean"),k=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fr,[t[47]||(t[47]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Nr,[e.createElementVNode("table",ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[18]||(t[18]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[t[19]||(t[19]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",Er,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",br,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).ProjectName,modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(l).ProjectName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",kr,[e.createElementVNode("div",null,[e.createVNode(S,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(u),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(l).OrgCategory=B)},null,8,["error","options","modelValue"])]),e.unref(l).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",gr,[e.createVNode(f,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(l).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=B=>e.unref(l).RegisteredNum=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":t[3]||(t[3]=B=>e.unref(l).OrgName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(l).TaxID,"onUpdate:modelValue":t[4]||(t[4]=B=>e.unref(l).TaxID=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":t[5]||(t[5]=B=>e.unref(l).Address=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[48]||(t[48]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",yr,[e.createElementVNode("table",hr,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",$r,[e.createElementVNode("div",xr,[e.createElementVNode("div",Br,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-Name`],modelValue:B.Name,"onUpdate:modelValue":A=>B.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Cr,[e.createElementVNode("div",_r,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-JobTitle`],modelValue:B.JobTitle,"onUpdate:modelValue":A=>B.JobTitle=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),C?(e.openBlock(),e.createElementBlock("div",Tr,[t[28]||(t[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",wr,[e.createElementVNode("div",Dr,[e.createVNode(f,{modelValue:B.Phone,"onUpdate:modelValue":A=>B.Phone=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Sr,[e.createVNode(f,{placeholder:"請輸入分機",size:"4",modelValue:B.PhoneExt,"onUpdate:modelValue":A=>B.PhoneExt=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),C?(e.openBlock(),e.createElementBlock("div",Ur,[e.createElementVNode("div",Ar,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-MobilePhone`],modelValue:B.MobilePhone,"onUpdate:modelValue":A=>B.MobilePhone=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[49]||(t[49]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Or,[e.createElementVNode("table",Mr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ir,[e.createElementVNode("div",jr,[e.createVNode(_,{class:"w-auto",modelValue:e.unref(l).StartTime,"onUpdate:modelValue":t[6]||(t[6]=B=>e.unref(l).StartTime=B)},null,8,["modelValue"]),t[31]||(t[31]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(_,{class:"w-auto",modelValue:e.unref(l).EndTime,"onUpdate:modelValue":t[7]||(t[7]=B=>e.unref(l).EndTime=B)},null,8,["modelValue"])]),t[32]||(t[32]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",Fr,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[33]||(t[33]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Target,modelValue:e.unref(l).Target,"onUpdate:modelValue":t[8]||(t[8]=B=>e.unref(l).Target=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[34]||(t[34]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":t[9]||(t[9]=B=>e.unref(l).Summary=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":t[10]||(t[10]=B=>e.unref(l).Quantified=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[50]||(t[50]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Pr,[t[41]||(t[41]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",qr,[e.createElementVNode("table",Rr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Lr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",zr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",Jr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Gr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[40]||(t[40]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=B=>e.unref(l).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=B=>e.unref(l).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).OtherGovAmount,modelValue:e.unref(l).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=B=>e.unref(l).OtherGovAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).OtherUnitAmount,modelValue:e.unref(l).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=B=>e.unref(l).OtherUnitAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",Qr,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])])]),e.createElementVNode("table",Wr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[42]||(t[42]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{modelValue:e.unref(c),"onUpdate:modelValue":t[15]||(t[15]=B=>e.isRef(c)?c.value=B:null)},null,8,["modelValue"]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Yr,[e.createElementVNode("table",Hr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[43]||(t[43]=e.createElementVNode("th",null,"計畫名稱",-1)),t[44]||(t[44]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Zr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`received-${C}-Name`],modelValue:B.Name,"onUpdate:modelValue":A=>B.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`received-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Kr,[e.createElementVNode("div",Xr,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>h(B),type:"button"},[...t[45]||(t[45]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,vr)):e.createCommentVNode("",!0),C+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[46]||(t[46]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ea,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[16]||(t[16]=B=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[17]||(t[17]=B=>o(!0)),type:"button"},[...t[51]||(t[51]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(k,{ref_key:"modal",ref:r},{default:e.withCtx(()=>{var B;return[e.createElementVNode("div",ta,[t[52]||(t[52]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",la,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((B=e.unref(s))==null?void 0:B.GrantLimit)+"萬",1),t[53]||(t[53]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[54]||(t[54]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},na={class:"block"},ra={key:0,class:"text-pink lh-base mt-4"},aa={class:"mt-4"},da={class:"table align-middle gray-table"},sa={class:"text-center"},ca={key:0,width:"180"},ia={class:"text-center"},ma={key:0},Va=["innerHTML"],pa={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},fa={key:0,class:"text-center"},Na={key:0},ua={key:1,class:"text-pink"},Ea={key:1,class:"tag-group mt-2 gap-1"},ba={key:0,class:"tag tag-green-light"},ka=["download","href"],ga=["onClick"],ya={key:0,class:"block-bottom bg-light-teal"},ha=["disabled"],$a={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]}]),E=e.computed(()=>u.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("education",d.value.Status,2)),d=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,r=a=>{const s={ID:g.id,Attachments:u.value.reduce((p,c)=>p.concat(c.Files),[]),Submit:a?"true":"false"};D.education("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.education("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,u.value=u.value.filter(p=>{var c;return!((c=p.Excludes)!=null&&c.includes(d.value.OrgCategory))}),u.value.forEach(p=>{p.Files=s.Attachments.filter(c=>c.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(c=>!c.Deleted).length)}),I().init("education",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),c=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",na,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",ra,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",aa,[e.createElementVNode("table",da,[e.createElementVNode("thead",sa,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ca,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",ia,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",ma,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Va)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",pa,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",fa,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",Na,"已上傳")):(e.openBlock(),e.createElementBlock("span",ua,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(c,{key:0,accept:".pdf",onFile:o=>n(b,o)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",Ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ba,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,ka),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>o.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ga)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ya,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(E),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ha)])):e.createCommentVNode("",!0)],64)}}},xa={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(u,E)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"education"})}}},Ba={class:"modal-dialog modal-dialog-centered modal-md"},Ca={class:"modal-content"},_a={class:"modal-body"},Ta={class:"d-flex flex-column align-items-center mb-5 gap-3"},wa={class:"fs-18"},Da={__name:"ErrorModal",setup(y){const g=Q(),u=e.ref();return e.onMounted(()=>u.value.addEventListener("hidden.bs.modal",()=>g.error=null)),e.watch(()=>g.error,()=>{g.error&&bootstrap.Modal.getOrCreateInstance(u.value).show()}),(E,V)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:u,tabindex:"-1"},[e.createElementVNode("div",Ba,[e.createElementVNode("div",Ca,[V[2]||(V[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",_a,[e.createElementVNode("div",Ta,[V[0]||(V[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",wa,e.toDisplayString(e.unref(g).error),1)]),V[1]||(V[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},Sa={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const g=e.useModel(y,"modelValue"),u=[{value:!0,text:"是"},{value:!1,text:"否"}];return(E,V)=>{const d=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(d,{options:u,modelValue:g.value,"onUpdate:modelValue":V[0]||(V[0]=n=>g.value=n)},null,8,["modelValue"])}}},Ua=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(y,{emit:g}){const u=e.ref(),E=()=>{Array.from(u.value.files).forEach(d=>D.upload(d).subscribe(n=>V("file",n))),u.value.value=""},V=g;return(d,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:n[0]||(n[0]=l=>e.unref(u).click()),type:"button"},[...n[1]||(n[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:E,class:"d-none",ref_key:"input",ref:u,type:"file"},d.$attrs),null,16)],64))}}),Aa=["disabled","placeholder","type"],Oa={key:0,class:"invalid mt-0"},Ma=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),u=e.useModel(y,"modelValue");return e.watch(u,E=>{if(E){const V=(parseInt(E)||0).toString();E.toString()!==V&&(u.value=V)}}),(E,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(g),placeholder:e.unref(g)?y.placeholder:"",style:{"text-align":"right"},type:y.type},E.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=d=>u.value=d)}),null,16,Aa),[[e.vModelDynamic,u.value]]),y.error?(e.openBlock(),e.createElementBlock("div",Oa,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Ia={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const g=e.useModel(y,"modelValue"),u=[];for(let E=1;E<=12;E++)u.push({value:E,text:`${E}月`});return(E,V)=>{const d=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(d,{options:u,modelValue:g.value,"onUpdate:modelValue":V[0]||(V[0]=n=>g.value=n)},null,8,["modelValue"])}}},ja=["onChange","checked","disabled","id","value"],Fa=["for"],Pa={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>X(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),u=e.useModel(y,"modelValue"),E=V=>{u.value=V};return(V,d)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,n=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:n},[e.createElementVNode("input",{onChange:l=>E(n[y.valueName]),checked:n[y.valueName]===u.value,class:"form-check-input",disabled:!e.unref(g),id:`${y.id}-${n[y.valueName]}`,type:"radio",value:n[y.valueName]},null,40,ja),e.createElementVNode("label",{class:"form-check-label",for:`${y.id}-${n[y.valueName]}`},e.toDisplayString(n[y.textName]),9,Fa)]))),128))}},qa=["disabled"],Ra=["value"],La=["value"],za={key:0,class:"invalid mt-0"},Ja=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),u=e.useModel(y,"modelValue");return(E,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:y.disabled||!e.unref(g)},E.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=d=>u.value=d)}),[e.unref(g)&&!u.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:y.emptyValue},e.toDisplayString(y.placeholder),9,Ra)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,(d,n)=>e.renderSlot(E.$slots,"default",{key:d,index:n,option:d},()=>[e.createElementVNode("option",{value:d[y.valueName]},e.toDisplayString(d[y.textName]),9,La)])),128))],16,qa),[[e.vModelSelect,u.value]]),y.error?(e.openBlock(),e.createElementBlock("div",za,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Ga={class:"input-group"},Qa={key:0,class:"input-group-text"},Wa=["disabled","placeholder","type"],Ya={key:0,class:"invalid mt-0"},Ha=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),u=e.useModel(y,"modelValue"),E=y;return E.maxLength&&e.watch(u,()=>{var V;((V=u.value)==null?void 0:V.length)>E.maxLength&&(u.value=u.value.substring(0,E.maxLength))}),(V,d)=>{const n=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ga,[y.prefix?(e.openBlock(),e.createElementBlock("span",Qa,[e.createVNode(n,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(g),placeholder:e.unref(g)?y.placeholder:"",type:y.type},V.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=l=>u.value=l)}),null,16,Wa),[[e.vModelDynamic,u.value]])]),y.error?(e.openBlock(),e.createElementBlock("div",Ya,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),Za=["disabled","placeholder"],Ka={key:0,class:"fs-14 text-gray mt-2"},Xa={class:"text-pink"},va={key:1,class:"invalid mt-0"},ed=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),u=e.useModel(y,"modelValue"),E=y;return E.maxLength&&e.watch(u,()=>{var V;((V=u.value)==null?void 0:V.length)>E.maxLength&&(u.value=u.value.substring(0,E.maxLength))}),(V,d)=>{var n;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(g),placeholder:e.unref(g)?y.placeholder:""},V.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=l=>u.value=l)}),null,16,Za),[[e.vModelText,u.value]]),e.unref(g)&&y.maxLength?(e.openBlock(),e.createElementBlock("div",Ka,[d[1]||(d[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Xa,e.toDisplayString(((n=u.value)==null?void 0:n.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(y.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),y.error?(e.openBlock(),e.createElementBlock("div",va,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),td=["disabled"],ld={key:0,class:"invalid"},od=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(y,{emit:g}){let u;const E=y,V=e.ref(),d=e.inject("editable",!0),n=e.ref(),l=g,r=a=>{!a&&E.modelValue&&(a=moment(new Date(E.modelValue))),a?(V.value=a.format(E.displayFormat),l("update:modelValue",a.format(E.format))):(V.value="",l("update:modelValue","")),u.setStartDate(V.value||void 0)};return e.onMounted(()=>{const a=$(n.value);a.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:E.drops,locale:{format:E.displayFormat},maxDate:E.maxDate?new Date(E.maxDate):E.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(s,p)=>r(p.startDate)),u=a.data("daterangepicker"),r()}),e.onUnmounted(()=>u.remove()),e.watch(()=>E.modelValue,()=>r()),(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(d),ref_key:"element",ref:n,type:"text"},a.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=p=>e.isRef(V)?V.value=p:null)}),null,16,td),[[e.vModelText,e.unref(V)]]),y.error?(e.openBlock(),e.createElementBlock("div",ld,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),nd={class:"block"},rd={class:"mt-4"},ad={class:"table align-middle gray-table side-table"},dd={key:0},sd={key:1,class:"text-light-gray"},cd={class:"mt-4"},id={class:"table align-middle gray-table side-table"},md={class:"row g-3"},Vd={class:"col-12 col-xl-2"},pd={class:"text-gray mb-2"},fd={class:"col-12 col-xl-3"},Nd={class:"text-gray mb-2"},ud={class:"col-12 col-xl-4"},Ed={class:"row g-1"},bd={class:"col-7"},kd={class:"col-5"},gd={class:"col-12 col-xl-3"},yd={class:"text-gray mb-2"},hd={class:"col-12"},$d={class:"text-gray mb-2"},xd={class:"mt-4"},Bd={class:"table align-middle gray-table side-table"},Cd={class:"mt-4"},_d={class:"table align-middle gray-table side-table"},Td={key:0,class:"table-responsive mt-3 mb-0"},wd={class:"table align-middle gray-table"},Dd={key:0},Sd={key:0},Ud={class:"d-flex gap-2"},Ad=["onClick"],Od={key:0,class:"block-bottom bg-light-teal"},Md={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,u=e.ref(),E=e.computed(()=>P("literacy",l.value.Status,1)),V=e.ref({}),d=e.ref([]),n=e.computed(()=>r.value.filter(h=>!h.Deleted)),l=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!n.value.length,set:h=>{h?s():r.value.forEach(o=>o.Deleted=!0)}}),s=()=>r.value.push({}),p=h=>h.Deleted=!0,c=h=>{if(V.value={},h&&!b()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:l.value,Contacts:u.value,PreviousStudies:r.value.filter(N=>N.ID||!N.Deleted),Submit:h?"true":"false"};D.literacy("saveApplication",o).subscribe(N=>{h?window.location.href=`WorkSchedule.aspx?ID=${N.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${N.ID}`})},b=()=>{let h={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return V.value=U(l.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((o,N)=>Object.assign(V.value,U(o,h,`contact-${N}-`))),h={Title:"研習/課程名稱",TheDate:"辦理日期"},r.value.forEach((o,N)=>Object.assign(V.value,U(o,h,`study-${N}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(h=>{d.value=h[0],g.id?D.literacy("getApplication",{ID:g.id}).subscribe(o=>{l.value=o.Project,u.value=o.Contacts,r.value=o.PreviousStudies,I().init("literacy",l.value)}):D.literacy("getEmptyApplication").subscribe(o=>{l.value=Object.assign({Field:null,FormStep:1,Status:1},o),u.value=[{Role:"申請人"}],I().init("literacy",l.value)})})}),e.provide("editable",E),e.watch(()=>[l.value.Field,l.value.OrgName],()=>{var h;if(E.value){const o=[];l.value.Field&&o.push((h=d.value.find(N=>N.Code===l.value.Field))==null?void 0:h.Descname),l.value.OrgName&&o.push(l.value.OrgName),l.value.ProjectName=o.join("-")}}),(h,o)=>{const N=e.resolveComponent("required-label"),m=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),i=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nd,[o[35]||(o[35]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",rd,[e.createElementVNode("table",ad,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[o[12]||(o[12]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[o[13]||(o[13]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",dd,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",sd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[o[14]||(o[14]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[15]||(o[15]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{disabled:"",modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":o[0]||(o[0]=_=>e.unref(l).ProjectName=_),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[16]||(o[16]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(V).Field,options:e.unref(d),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).Field,"onUpdate:modelValue":o[1]||(o[1]=_=>e.unref(l).Field=_)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[17]||(o[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":o[2]||(o[2]=_=>e.unref(l).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[18]||(o[18]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).OrgLeader,modelValue:e.unref(l).OrgLeader,"onUpdate:modelValue":o[3]||(o[3]=_=>e.unref(l).OrgLeader=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[19]||(o[19]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":o[4]||(o[4]=_=>e.unref(l).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),o[36]||(o[36]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",cd,[e.createElementVNode("table",id,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",md,[e.createElementVNode("div",Vd,[e.createElementVNode("div",pd,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[20]||(o[20]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",fd,[e.createElementVNode("div",Nd,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[21]||(o[21]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":x=>_.JobTitle=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ud,[o[22]||(o[22]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ed,[e.createElementVNode("div",bd,[e.createVNode(m,{modelValue:_.Phone,"onUpdate:modelValue":x=>_.Phone=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",kd,[e.createVNode(m,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":x=>_.PhoneExt=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",gd,[e.createElementVNode("div",yd,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[23]||(o[23]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":x=>_.MobilePhone=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hd,[e.createElementVNode("div",$d,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[24]||(o[24]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":x=>_.EMail=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),o[37]||(o[37]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",xd,[e.createElementVNode("table",Bd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[25]||(o[25]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[o[26]||(o[26]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(i,{error:e.unref(V).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(l).Target,"onUpdate:modelValue":o[5]||(o[5]=_=>e.unref(l).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[27]||(o[27]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":o[6]||(o[6]=_=>e.unref(l).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[28]||(o[28]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":o[7]||(o[7]=_=>e.unref(l).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...o[29]||(o[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Qualitative,"onUpdate:modelValue":o[8]||(o[8]=_=>e.unref(l).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Cd,[e.createElementVNode("table",_d,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[o[34]||(o[34]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(a),"onUpdate:modelValue":o[9]||(o[9]=_=>e.isRef(a)?a.value=_:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Td,[e.createElementVNode("table",wd,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[30]||(o[30]=e.createElementVNode("th",null,"研習/課程名稱",-1)),o[31]||(o[31]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Dd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V)[`study-${T}-Title`],modelValue:_.Title,"onUpdate:modelValue":x=>_.Title=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`study-${T}-TheDate`],modelValue:_.TheDate,"onUpdate:modelValue":x=>_.TheDate=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Sd,[e.createElementVNode("div",Ud,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:x=>p(_),type:"button"},[...o[32]||(o[32]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ad)):e.createCommentVNode("",!0),T+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...o[33]||(o[33]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Od,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[10]||(o[10]=_=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[11]||(o[11]=_=>c(!0)),type:"button"},[...o[38]||(o[38]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Id={class:"block"},jd={key:0,class:"text-pink lh-base mt-4"},Fd={class:"mt-4"},Pd={class:"table align-middle gray-table"},qd={class:"text-center"},Rd={key:0,width:"180"},Ld={class:"text-center"},zd={key:0},Jd=["innerHTML"],Gd={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Qd={key:0,class:"text-center"},Wd={key:0},Yd={key:1,class:"text-pink"},Hd={key:1,class:"tag-group mt-2 gap-1"},Zd={key:0,class:"tag tag-green-light"},Kd=["download","href"],Xd=["onClick"],vd={key:0,class:"block-bottom bg-light-teal"},es=["disabled"],ts={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"著作權授權同意書",Template:!0,Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),E=e.computed(()=>u.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("literacy",d.value.Status,2)),d=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,r=a=>{const s={ID:g.id,Attachments:u.value.reduce((p,c)=>p.concat(c.Files),[]),Submit:a?"true":"false"};D.literacy("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,u.value=u.value.filter(p=>{var c;return!((c=p.Excludes)!=null&&c.includes(d.value.OrgCategory))}),u.value.forEach(p=>{p.Files=s.Attachments.filter(c=>c.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(c=>!c.Deleted).length)}),I().init("literacy",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),c=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Id,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",jd,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Fd,[e.createElementVNode("table",Pd,[e.createElementVNode("thead",qd,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Rd,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Ld,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",zd,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Jd)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",Gd,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Qd,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",Wd,"已上傳")):(e.openBlock(),e.createElementBlock("span",Yd,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(c,{key:0,accept:".pdf",onFile:o=>n(b,o)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",Hd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Zd,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,Kd),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>o.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xd)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",vd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(E),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,es)])):e.createCommentVNode("",!0)],64)}}},ls={class:"block"},os={class:"mt-4"},ns={class:"table-responsive mt-3 mb-0"},rs={class:"table align-middle gray-table"},as={key:0,width:"1"},ds={key:0},ss={class:"d-flex gap-2"},cs=["onClick"],is={class:"table-responsive mt-3 mb-0"},ms={class:"table align-middle gray-table"},Vs={key:0,class:"block-bottom bg-light-teal"},ps={__name:"Benefit",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.computed(()=>P("literacy",n.value.Status,4)),V=e.ref({}),d=e.computed(()=>u.value.filter(p=>!p.Deleted)),n=e.ref({}),l=()=>u.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const c={Project:n.value,Benefits:u.value,Submit:p?"true":"false"};D.literacy("saveBenefit",c).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(n.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((c,b)=>Object.assign(V.value,U(c,p,`item-${b}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getBenefit",{ID:g.id})]).subscribe(p=>{const c=p[0];n.value=c.Project,u.value=c.Benefits,u.value.length||l(),I().init("literacy",n.value)})}),e.provide("editable",E),(p,c)=>{const b=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ls,[c[9]||(c[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",os,[e.createElementVNode("div",ns,[e.createElementVNode("table",rs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[c[3]||(c[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),c[4]||(c[4]=e.createElementVNode("th",null,"目標值",-1)),c[5]||(c[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",as,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(o,N)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Title`],modelValue:o.Title,"onUpdate:modelValue":m=>o.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Target`],modelValue:o.Target,"onUpdate:modelValue":m=>o.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:o.Description,"onUpdate:modelValue":m=>o.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",ds,[e.createElementVNode("div",ss,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>r(o),type:"button"},[...c[6]||(c[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,cs)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...c[7]||(c[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",is,[e.createElementVNode("table",ms,[c[8]||(c[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":c[0]||(c[0]=o=>e.unref(n).Benefit=o),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Vs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[1]||(c[1]=o=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[2]||(c[2]=o=>a(!0)),type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},fs={class:"block"},Ns={class:"mt-4"},us={class:"table-responsive mt-3 mb-0"},Es={class:"table align-middle gray-table"},bs={class:"text-end"},ks={class:"text-end"},gs={class:"table-responsive"},ys={class:"table align-middle gray-table"},hs=["colspan"],$s={key:0,width:"1"},xs={class:"text-end"},Bs={key:0},Cs={class:"d-flex gap-2"},_s=["onClick"],Ts={class:"mt-4"},ws={class:"table-responsive mt-3 mb-0"},Ds={class:"table align-middle gray-table"},Ss={key:0,width:"1"},Us={class:"text-end"},As={key:0},Os={class:"d-flex gap-2"},Ms=["onClick"],Is={key:0,class:"block-bottom bg-light-teal"},js={class:"text-center"},Fs={class:"mb-5"},Ps={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,u=e.computed(()=>P("literacy",n.value.Status,3)),E=e.ref({}),V=e.computed(()=>r.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),n=e.ref({}),l=e.ref(),r=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),c=()=>r.value.push({}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,o=(m,t)=>{if(E.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&n.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>o(m,!0));return}const i={Project:n.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:m?"true":"false"};D.literacy("saveFunding",i).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return E.value=U(n.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},r.value.forEach((t,i)=>Object.assign(E.value,U(t,m,`other-${i}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,i)=>Object.assign(E.value,U(t,m,`plan-${i}-`))),!Object.keys(E.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getFunding",{ID:g.id})]).subscribe(m=>{const t=m[0];n.value=t.Project,r.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,r.value.length||c(),a.value.length||b(),I().init("literacy",n.value)})}),e.provide("editable",u),e.watchEffect(()=>{n.value.OtherAmount=V.value.reduce((m,t)=>m+j(t.Amount),0),p.value=j(n.value.ApplyAmount)+j(n.value.SelfAmount)+j(n.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(j(m.Amount)/n.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=j(m.Amount)+j(m.OtherAmount))}),(m,t)=>{var T;const i=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fs,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Ns,[e.createElementVNode("div",us,[e.createElementVNode("table",Es,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(n).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(n).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",bs,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",ks,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",gs,[e.createElementVNode("table",ys,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(u)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,hs)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",$s,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(E)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":k=>x.Unit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",xs,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":k=>x.Content=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Bs,[e.createElementVNode("div",Cs,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,_s)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("div",ws,[e.createElementVNode("table",Ds,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Ss,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(E)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":k=>x.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":k=>x.OtherAmount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Us,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":k=>x.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",As,[e.createElementVNode("div",Os,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ms)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Is,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>o(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",js,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Fs,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},qs={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,E)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"literacy"})}}},Rs={class:"block"},Ls={class:"mt-4"},zs={class:"table align-middle gray-table side-table"},Js={key:0,class:"d-flex align-items-center gap-2"},Gs={class:"input-group w-auto"},Qs={class:"text-teal-dark"},Ws={key:1,class:"invalid mt-0"},Ys={class:"table-responsive mt-4"},Hs={class:"table align-middle gray-table"},Zs={key:0},Ks={class:"input-group"},Xs={key:0,class:"invalid mt-0"},vs={key:0},ec={class:"d-flex gap-2"},tc=["onClick"],lc={class:"mt-4"},oc={class:"table align-middle gray-table"},nc={key:0},rc={key:0},ac={class:"d-flex gap-2"},dc=["onClick"],sc={key:0,class:"block-bottom bg-light-teal"},cc={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,u=[{value:1,text:"50%"},{value:2,text:"100%"}],E=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("literacy",r.value.Status,2)),d=e.ref({}),n=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),r=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),c=()=>D.literacy("createItem",{ID:g.id}).subscribe(m=>s.value.push(m)),b=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,o=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};D.literacy("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(r.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},n.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`item-${i}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`schedule-${i}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getWorkSchedule",{ID:g.id})]).subscribe(m=>{const t=m[0];r.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||c(),p.value.length||b(),I().init("literacy",r.value)})}),e.provide("editable",V),(m,t)=>{const i=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Rs,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Ls,[e.createElementVNode("table",zs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(E)?(e.openBlock(),e.createElementBlock("div",Js,[e.createElementVNode("div",Gs,[e.createVNode(f,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":t[0]||(t[0]=k=>e.unref(r).StartTime=k)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":t[1]||(t[1]=k=>e.unref(r).EndTime=k)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Qs,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(E)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",Ws,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Ys,[e.createElementVNode("table",Hs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Zs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:k.Title,"onUpdate:modelValue":C=>k.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Ks,[e.createVNode(T,{"empty-value":0,modelValue:k.Begin,"onUpdate:modelValue":C=>k.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:k.End,"onUpdate:modelValue":C=>k.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",Xs,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",vs,[e.createElementVNode("div",ec,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,tc)):e.createCommentVNode("",!0),B+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",lc,[e.createElementVNode("table",oc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",nc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:u,modelValue:k.Type,"onUpdate:modelValue":C=>k.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(n),"text-name":"Title","value-name":"ID",modelValue:k.ItemID,"onUpdate:modelValue":C=>k.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(k.ItemID?String.fromCharCode(65+e.unref(n).findIndex(C=>C.ID===k.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",rc,[e.createElementVNode("div",ac,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,dc)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",sc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=k=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=k=>o(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ic={class:"block"},mc={class:"mt-4"},Vc={class:"table align-middle gray-table side-table"},pc={key:0},fc={key:1,class:"text-light-gray"},Nc={class:"mt-4"},uc={class:"table align-middle gray-table side-table"},Ec={class:"row g-3"},bc={class:"col-12 col-xl-2"},kc={class:"text-gray mb-2"},gc={class:"col-12 col-xl-3"},yc={class:"text-gray mb-2"},hc={class:"col-12 col-xl-4"},$c={class:"row g-1"},xc={class:"col-7"},Bc={class:"col-5"},Cc={class:"col-12 col-xl-3"},_c={class:"text-gray mb-2"},Tc={class:"col-12"},wc={class:"text-gray mb-2"},Dc={class:"mt-4"},Sc={class:"table align-middle gray-table side-table"},Uc={class:"mt-4"},Ac={class:"table align-middle gray-table side-table"},Oc={key:0,class:"table-responsive mt-3 mb-0"},Mc={class:"table align-middle gray-table"},Ic={key:0},jc={key:0},Fc={class:"d-flex gap-2"},Pc=["onClick"],qc={key:0,class:"block-bottom bg-light-teal"},Rc={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.ref(),V=e.computed(()=>P("multiple",r.value.Status,1)),d=e.ref({}),n=e.ref([]),l=e.computed(()=>a.value.filter(o=>!o.Deleted)),r=e.ref({}),a=e.ref([]),s=e.computed({get:()=>!!l.value.length,set:o=>{o?p():a.value.forEach(N=>N.Deleted=!0)}}),p=()=>a.value.push({}),c=o=>o.Deleted=!0,b=o=>{if(d.value={},o&&!h()){e.nextTick(()=>{var m;return(m=document.querySelector(".invalid"))==null?void 0:m.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:r.value,Contacts:E.value,ReceivedSubsidies:a.value.filter(m=>m.ID||!m.Deleted),Submit:o?"true":"false"};D.multiple("saveApplication",N).subscribe(m=>{o?window.location.href=`WorkSchedule.aspx?ID=${m.ID}`:r.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${m.ID}`})},h=()=>{let o={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value=U(r.value,o),o={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((N,m)=>Object.assign(d.value,U(N,o,`contact-${m}-`))),o={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},a.value.forEach((N,m)=>Object.assign(d.value,U(N,o,`received-${m}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getZgsCodes",{CodeGroup:"MULField"}),D.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(o=>{n.value=o[0],u.value=o[1],g.id?D.multiple("getApplication",{ID:g.id}).subscribe(N=>{r.value=N.Project,E.value=N.Contacts,a.value=N.ReceivedSubsidies,r.value.OrgCategory=r.value.OrgCategory||null,I().init("multiple",r.value)}):D.multiple("getEmptyApplication").subscribe(N=>{r.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},N),E.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("multiple",r.value)})})}),e.provide("editable",V),(o,N)=>{const m=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),i=e.resolveComponent("input-select"),f=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-boolean"),_=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ic,[N[38]||(N[38]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",mc,[e.createElementVNode("table",Vc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[13]||(N[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).Year),1)]),e.createElementVNode("tr",null,[N[14]||(N[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(r).ProjectID?(e.openBlock(),e.createElementBlock("span",pc,e.toDisplayString(e.unref(r).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",fc,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[16]||(N[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).ProjectName,modelValue:e.unref(r).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=T=>e.unref(r).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[17]||(N[17]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{"empty-value":null,error:e.unref(d).Field,options:e.unref(n),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).Field,"onUpdate:modelValue":N[1]||(N[1]=T=>e.unref(r).Field=T)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(r).OrgName,"onUpdate:modelValue":N[2]||(N[2]=T=>e.unref(r).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(u),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).OrgCategory,"onUpdate:modelValue":N[3]||(N[3]=T=>e.unref(r).OrgCategory=T)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(r).TaxID,"onUpdate:modelValue":N[4]||(N[4]=T=>e.unref(r).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(r).Address,"onUpdate:modelValue":N[5]||(N[5]=T=>e.unref(r).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[39]||(N[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Nc,[e.createElementVNode("table",uc,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(T,x)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ec,[e.createElementVNode("div",bc,[e.createElementVNode("div",kc,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-Name`],modelValue:T.Name,"onUpdate:modelValue":w=>T.Name=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",gc,[e.createElementVNode("div",yc,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":w=>T.JobTitle=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hc,[N[24]||(N[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",$c,[e.createElementVNode("div",xc,[e.createVNode(t,{modelValue:T.Phone,"onUpdate:modelValue":w=>T.Phone=w,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Bc,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":w=>T.PhoneExt=w,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Cc,[e.createElementVNode("div",_c,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[25]||(N[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":w=>T.MobilePhone=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Tc,[e.createElementVNode("div",wc,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-EMail`],modelValue:T.EMail,"onUpdate:modelValue":w=>T.EMail=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[40]||(N[40]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Dc,[e.createElementVNode("table",Sc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[28]||(N[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(f,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(r).Target,"onUpdate:modelValue":N[6]||(N[6]=T=>e.unref(r).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[29]||(N[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(r).Summary,"onUpdate:modelValue":N[7]||(N[7]=T=>e.unref(r).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Quantified,"onUpdate:modelValue":N[8]||(N[8]=T=>e.unref(r).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Qualitative,"onUpdate:modelValue":N[9]||(N[9]=T=>e.unref(r).Qualitative=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Uc,[e.createElementVNode("table",Ac,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[37]||(N[37]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(S,{modelValue:e.unref(s),"onUpdate:modelValue":N[10]||(N[10]=T=>e.isRef(s)?s.value=T:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Oc,[e.createElementVNode("table",Mc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[32]||(N[32]=e.createElementVNode("th",null,"計畫名稱",-1)),N[33]||(N[33]=e.createElementVNode("th",null,"補助單位",-1)),N[34]||(N[34]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ic,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,x)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d)[`received-${x}-Name`],modelValue:T.Name,"onUpdate:modelValue":w=>T.Name=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d)[`received-${x}-Unit`],modelValue:T.Unit,"onUpdate:modelValue":w=>T.Unit=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`received-${x}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":w=>T.Amount=w},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",jc,[e.createElementVNode("div",Fc,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:w=>c(T),type:"button"},[...N[35]||(N[35]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Pc)):e.createCommentVNode("",!0),x+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...N[36]||(N[36]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",qc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[11]||(N[11]=T=>b()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[12]||(N[12]=T=>b(!0)),type:"button"},[...N[41]||(N[41]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Lc={class:"block"},zc={key:0,class:"text-pink lh-base mt-4"},Jc={class:"mt-4"},Gc={class:"table align-middle gray-table"},Qc={class:"text-center"},Wc={key:0,width:"180"},Yc={class:"text-center"},Hc={key:0},Zc=["innerHTML"],Kc={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Xc={key:0,class:"text-center"},vc={key:0},ei={key:1,class:"text-pink"},ti={key:1,class:"tag-group mt-2 gap-1"},li={key:0,class:"tag tag-green-light"},oi=["download","href"],ni=["onClick"],ri={key:0,class:"block-bottom bg-light-teal"},ai=["disabled"],di={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),E=e.computed(()=>u.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("multiple",d.value.Status,2)),d=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,r=a=>{const s={ID:g.id,Attachments:u.value.reduce((p,c)=>p.concat(c.Files),[]),Submit:a?"true":"false"};D.multiple("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,u.value=u.value.filter(p=>{var c;return!((c=p.Excludes)!=null&&c.includes(d.value.OrgCategory))}),d.value.Status>=10&&u.value.push({Type:6,Title:"著作權授權同意書",Template:!0,Files:[]}),u.value.forEach(p=>{p.Files=s.Attachments.filter(c=>c.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(c=>!c.Deleted).length)}),I().init("multiple",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),c=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Lc,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",zc,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Jc,[e.createElementVNode("table",Gc,[e.createElementVNode("thead",Qc,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Wc,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Yc,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",Hc,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Zc)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",Kc,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Xc,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",vc,"已上傳")):(e.openBlock(),e.createElementBlock("span",ei,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(c,{key:0,accept:".pdf",onFile:o=>n(b,o)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",ti,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",li,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,oi),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>o.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ni)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ri,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(E),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ai)])):e.createCommentVNode("",!0)],64)}}},si={class:"block"},ci={class:"mt-4"},ii={class:"table-responsive mt-3 mb-0"},mi={class:"table align-middle gray-table"},Vi={key:0,width:"1"},pi={key:0},fi={class:"d-flex gap-2"},Ni=["onClick"],ui={class:"table-responsive mt-3 mb-0"},Ei={class:"table align-middle gray-table"},bi={key:0,class:"block-bottom bg-light-teal"},ki={__name:"Benefit",props:{id:{type:Number}},setup(y){const g=y,u=e.ref([]),E=e.computed(()=>P("multiple",n.value.Status,4)),V=e.ref({}),d=e.computed(()=>u.value.filter(p=>!p.Deleted)),n=e.ref({}),l=()=>u.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const c={Project:n.value,Benefits:u.value,Submit:p?"true":"false"};D.multiple("saveBenefit",c).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(n.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((c,b)=>Object.assign(V.value,U(c,p,`item-${b}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getBenefit",{ID:g.id})]).subscribe(p=>{const c=p[0];n.value=c.Project,u.value=c.Benefits,u.value.length||l(),I().init("multiple",n.value)})}),e.provide("editable",E),(p,c)=>{const b=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",si,[c[9]||(c[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",ci,[e.createElementVNode("div",ii,[e.createElementVNode("table",mi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[c[3]||(c[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),c[4]||(c[4]=e.createElementVNode("th",null,"目標值",-1)),c[5]||(c[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Vi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(o,N)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Title`],modelValue:o.Title,"onUpdate:modelValue":m=>o.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Target`],modelValue:o.Target,"onUpdate:modelValue":m=>o.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:o.Description,"onUpdate:modelValue":m=>o.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",pi,[e.createElementVNode("div",fi,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>r(o),type:"button"},[...c[6]||(c[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ni)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...c[7]||(c[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",ui,[e.createElementVNode("table",Ei,[c[8]||(c[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":c[0]||(c[0]=o=>e.unref(n).Benefit=o),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",bi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[1]||(c[1]=o=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[2]||(c[2]=o=>a(!0)),type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},gi={class:"block"},yi={class:"mt-4"},hi={class:"table-responsive mt-3 mb-0"},$i={class:"table align-middle gray-table"},xi={class:"text-end"},Bi={class:"text-end"},Ci={class:"table-responsive"},_i={class:"table align-middle gray-table"},Ti=["colspan"],wi={key:0,width:"1"},Di={class:"text-end"},Si={key:0},Ui={class:"d-flex gap-2"},Ai=["onClick"],Oi={class:"mt-4"},Mi={class:"table-responsive mt-3 mb-0"},Ii={class:"table align-middle gray-table"},ji={key:0,width:"1"},Fi={class:"text-end"},Pi={key:0},qi={class:"d-flex gap-2"},Ri=["onClick"],Li={key:0,class:"block-bottom bg-light-teal"},zi={class:"text-center"},Ji={class:"mb-5"},Gi={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,u=e.computed(()=>P("multiple",n.value.Status,3)),E=e.ref({}),V=e.computed(()=>r.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),n=e.ref({}),l=e.ref(),r=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),c=()=>r.value.push({}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,o=(m,t)=>{if(E.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&n.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>o(m,!0));return}const i={Project:n.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:m?"true":"false"};D.multiple("saveFunding",i).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return E.value=U(n.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},r.value.forEach((t,i)=>Object.assign(E.value,U(t,m,`other-${i}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,i)=>Object.assign(E.value,U(t,m,`plan-${i}-`))),!Object.keys(E.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getFunding",{ID:g.id})]).subscribe(m=>{const t=m[0];n.value=t.Project,r.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,r.value.length||c(),a.value.length||b(),I().init("multiple",n.value)})}),e.provide("editable",u),e.watchEffect(()=>{n.value.OtherAmount=V.value.reduce((m,t)=>m+j(t.Amount),0),p.value=j(n.value.ApplyAmount)+j(n.value.SelfAmount)+j(n.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(j(m.Amount)/n.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=j(m.Amount)+j(m.OtherAmount))}),(m,t)=>{var T;const i=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",gi,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",yi,[e.createElementVNode("div",hi,[e.createElementVNode("table",$i,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(n).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(n).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",xi,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",Bi,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Ci,[e.createElementVNode("table",_i,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(u)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Ti)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",wi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(E)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":k=>x.Unit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Di,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":k=>x.Content=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Si,[e.createElementVNode("div",Ui,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ai)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Oi,[e.createElementVNode("div",Mi,[e.createElementVNode("table",Ii,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",ji,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(E)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":k=>x.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(E)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":k=>x.OtherAmount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Fi,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(E)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":k=>x.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Pi,[e.createElementVNode("div",qi,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ri)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Li,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>o(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",zi,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Ji,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Qi={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,E)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"multiple"})}}},Wi={class:"block"},Yi={class:"mt-4"},Hi={class:"table align-middle gray-table side-table"},Zi={key:0,class:"d-flex align-items-center gap-2"},Ki={class:"input-group w-auto"},Xi={class:"text-teal-dark"},vi={key:1,class:"invalid mt-0"},em={class:"table-responsive mt-4"},tm={class:"table align-middle gray-table"},lm={key:0},om={class:"input-group"},nm={key:0,class:"invalid mt-0"},rm={key:0},am={class:"d-flex gap-2"},dm=["onClick"],sm={class:"mt-4"},cm={class:"table align-middle gray-table"},im={key:0},mm={key:0},Vm={class:"d-flex gap-2"},pm=["onClick"],fm={key:0,class:"block-bottom bg-light-teal"},Nm={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,u=[{value:1,text:"50%"},{value:2,text:"100%"}],E=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("multiple",r.value.Status,2)),d=e.ref({}),n=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),r=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),c=()=>D.multiple("createItem",{ID:g.id}).subscribe(m=>s.value.push(m)),b=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,o=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};D.multiple("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(r.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},n.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`item-${i}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,i)=>Object.assign(d.value,U(t,m,`schedule-${i}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getWorkSchedule",{ID:g.id})]).subscribe(m=>{const t=m[0];r.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||c(),p.value.length||b(),I().init("multiple",r.value)})}),e.provide("editable",V),(m,t)=>{const i=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wi,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Yi,[e.createElementVNode("table",Hi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(E)?(e.openBlock(),e.createElementBlock("div",Zi,[e.createElementVNode("div",Ki,[e.createVNode(f,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":t[0]||(t[0]=k=>e.unref(r).StartTime=k)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(E),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":t[1]||(t[1]=k=>e.unref(r).EndTime=k)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Xi,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(E)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",vi,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",em,[e.createElementVNode("table",tm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",lm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:k.Title,"onUpdate:modelValue":C=>k.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",om,[e.createVNode(T,{"empty-value":0,modelValue:k.Begin,"onUpdate:modelValue":C=>k.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:k.End,"onUpdate:modelValue":C=>k.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",nm,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",rm,[e.createElementVNode("div",am,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,dm)):e.createCommentVNode("",!0),B+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",sm,[e.createElementVNode("table",cm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",im,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:u,modelValue:k.Type,"onUpdate:modelValue":C=>k.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(n),"text-name":"Title","value-name":"ID",modelValue:k.ItemID,"onUpdate:modelValue":C=>k.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(k.ItemID?String.fromCharCode(65+e.unref(n).findIndex(C=>C.ID===k.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",mm,[e.createElementVNode("div",Vm,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pm)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",fm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=k=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=k=>o(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},um={key:0,class:"scroll-bottom-panel"},Em={class:"d-flex flex-column gap-3 mb-3"},bm={class:"d-flex gap-2"},km={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},gm={class:"text-nowrap my-2 d-flex align-items-center"},ym={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,u=I(),E=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],V=e.ref({}),d=e.ref({ID:g.id,Result:1}),n=()=>{const r={};if(d.value.Result>1&&(r.Reason="原因"),V.value=U(d.value,r),Object.keys(V.value).length){l();return}D[g.type]("reviewApplication",d.value).subscribe(a=>{})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>d.value.Result,r=>{r>1&&l()}),(r,a)=>{const s=e.resolveComponent("input-radio-group"),p=e.resolveComponent("input-textarea");return e.unref(u)[y.type].organizer?(e.openBlock(),e.createElementBlock("div",um,[a[3]||(a[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Em,[e.createElementVNode("li",bm,[a[2]||(a[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",km,[e.createElementVNode("div",gm,[e.createVNode(s,{options:E,modelValue:e.unref(d).Result,"onUpdate:modelValue":a[0]||(a[0]=c=>e.unref(d).Result=c)},null,8,["modelValue"])]),e.unref(d).Result>1?(e.openBlock(),e.createBlock(p,{key:0,error:e.unref(V).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(d).Reason,"onUpdate:modelValue":a[1]||(a[1]=c=>e.unref(d).Reason=c)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:n,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},hm={class:"d-flex align-items-center gap-3"},$m={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},xm={class:"modal-content"},Bm={class:"modal-header"},Cm={class:"fs-24 fw-bold text-green-light"},_m={class:"modal-body"},Tm={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},wm=["disabled"],Dm={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,u=e.computed(()=>!d.value||d.value===l[g.type].organizer),E=e.ref(),V=e.computed(()=>l[g.type].organizerName),d=e.ref(0),n=e.computed(()=>{var b;return(b=s.value.find(h=>h.UnitID===a.value))==null?void 0:b.reviewers}),l=I(),r=e.computed(()=>V.value?"移轉案件":"認領案件"),a=e.ref(0),s=e.ref([]),p=()=>{D[g.type]("queryReviewUnits").subscribe(b=>{s.value=b,rxjs.forkJoin(s.value.map(h=>D[g.type]("queryReviewersByUnit",{ID:h.UnitID}))).subscribe(h=>{h.forEach((o,N)=>{s.value[N].reviewers=o,o.some(m=>m.UserID===d.value)&&(a.value=s.value[N].UnitID)}),bootstrap.Modal.getOrCreateInstance(E.value).show()})})},c=()=>{D[g.type]("saveOrganizer",{ID:g.id,Organizer:d.value}).subscribe(b=>{b&&window.location.reload()})};return e.watch(V,()=>d.value=l[g.type].organizer),e.watch(a,()=>{n.value.some(b=>b.UserID===d.value)||(d.value=0)}),(b,h)=>{const o=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hm,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(V)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:p,type:"button"},e.toDisplayString(e.unref(r)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",$m,[e.createElementVNode("div",xm,[e.createElementVNode("div",Bm,[e.createElementVNode("h4",Cm,e.toDisplayString(e.unref(r)),1),h[2]||(h[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",_m,[e.createElementVNode("div",null,[h[3]||(h[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(o,{"empty-value":0,options:e.unref(s),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(a),"onUpdate:modelValue":h[0]||(h[0]=N=>e.isRef(a)?a.value=N:null)},null,8,["options","modelValue"]),e.createVNode(o,{class:"mt-2","empty-value":0,options:e.unref(n),"text-name":"Name","value-name":"UserID",modelValue:e.unref(d),"onUpdate:modelValue":h[1]||(h[1]=N=>e.isRef(d)?d.value=N:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",Tm,[h[4]||(h[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:c,disabled:e.unref(u),type:"button"},"確認",8,wm)])])])])],512)]))],64)}}},Sm={class:"step-line-wrapper"},Um={__name:"ProjectProgress",props:{id:{type:Number},step:{required:!0,type:Number}},setup(y){return(g,u)=>(e.openBlock(),e.createElementBlock("div",Sm,[...u[0]||(u[0]=[e.createStaticVNode('<div class="step-line"><div class="step-line-item active"><div class="step-line-item-title">核定計畫</div><div class="tag tag-white">審核中</div></div></div><div class="step-line"><div class="step-line-item"><div class="step-line-item-title">每月進度</div><div class="tag"></div></div></div><div class="step-line"><div class="step-line-item"><div class="step-line-item-title">階段報告</div><div class="tag"></div></div><div class="step-line-item"><div class="step-line-item-title">請款核銷</div><div class="tag"></div></div></div>',3)])]))}},Am={key:0,class:"scroll-bottom-panel"},Om={class:"d-flex flex-column gap-3 mb-3"},Mm={class:"d-flex gap-2"},Im={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},jm={class:"text-nowrap mb-2 d-flex align-items-center"},Fm={key:0,class:"invalid mt-0"},Pm={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,u=I(),E=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],V=e.ref({}),d=e.ref({ID:g.id,Result:1}),n=()=>{},l=()=>{},r=()=>{const s={};if(d.value.Result>1&&(s.Reason="原因"),d.value.Result===3&&(s.CorrectionDeadline="補正期限"),V.value=U(d.value,s),Object.keys(V.value).length){a();return}D[g.type]("reviewApplication",d.value).subscribe(p=>{})},a=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>d.value.Result,s=>{s>1&&a()}),(s,p)=>{const c=e.resolveComponent("input-radio-group"),b=e.resolveComponent("input-tw-date"),h=e.resolveComponent("input-textarea");return e.unref(u)[y.type].organizer?(e.openBlock(),e.createElementBlock("div",Am,[p[9]||(p[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Om,[e.createElementVNode("li",{class:"d-flex gap-2"},[p[3]||(p[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:n,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[p[6]||(p[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),p[7]||(p[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[p[4]||(p[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:l,href:"javascript:void(0)"},"1"),p[5]||(p[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",Mm,[p[8]||(p[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Im,[e.createElementVNode("div",jm,[e.createVNode(c,{options:E,modelValue:e.unref(d).Result,"onUpdate:modelValue":p[0]||(p[0]=o=>e.unref(d).Result=o)},null,8,["modelValue"]),e.createVNode(b,{class:"form-control",drops:"up",modelValue:e.unref(d).CorrectionDeadline,"onUpdate:modelValue":p[1]||(p[1]=o=>e.unref(d).CorrectionDeadline=o)},null,8,["modelValue"])]),e.unref(V).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",Fm,e.toDisplayString(e.unref(V).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(d).Result>1?(e.openBlock(),e.createBlock(h,{key:1,error:e.unref(V).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(d).Reason,"onUpdate:modelValue":p[2]||(p[2]=o=>e.unref(d).Reason=o)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},qm={class:"top-wrapper"},Rm={class:"top-block"},Lm={class:"d-flex align-items-center gap-3"},zm={__name:"ProjectTitle",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,u=I();return(E,V)=>(e.openBlock(),e.createElementBlock("div",qm,[e.createElementVNode("div",Rm,[e.createElementVNode("div",Lm,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(u)[g.type].type)+"］"+e.toDisplayString(e.unref(u)[g.type].id)+"/"+e.toDisplayString(e.unref(u)[g.type].name),1)]),V[0]||(V[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},Jm={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},Gm={class:"d-flex gap-2"},Qm={key:0,class:"btn text-teal-dark",type:"button"},Wm={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Ym={class:"modal-content"},Hm={class:"modal-body"},Zm={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Km={class:"modal-content"},Xm={class:"modal-body"},vm={class:"d-flex flex-column gap-4 mb-5"},eV={class:"d-flex align-items-center"},tV={class:"flex-grow-1"},lV={__name:"ProjectToolbar",props:{id:{type:Number},type:{type:String}},setup(y){const g=I(),u=y,E=e.ref({}),V=e.ref(),d=e.ref({}),n=e.ref(),l=e.ref({}),r=e.ref(),a=()=>{const h={Reason:"計畫變更原因"};d.value=U(E.value,h),!Object.keys(d.value).length&&D[u.type]("applyChange",E.value).subscribe(o=>{})},s=()=>{E.value={ID:u.id},bootstrap.Modal.getOrCreateInstance(V.value).show()},p=()=>{bootstrap.Modal.getOrCreateInstance(n.value).show()},c=()=>{l.value={ID:u.id},bootstrap.Modal.getOrCreateInstance(r.value).show()},b=()=>{const h={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};d.value=U(l.value,h),!Object.keys(d.value).length&&D[u.type]("terminate",l.value).subscribe(o=>{})};return(h,o)=>{const N=e.resolveComponent("input-textarea"),m=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Jm,[e.createElementVNode("div",Gm,[e.unref(g)[u.type].progress===2?(e.openBlock(),e.createElementBlock("button",Qm," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:s,type:"button"}," 計畫變更申請 ")),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:p,type:"button"},[...o[3]||(o[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])]),o[4]||(o[4]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-download"}),e.createTextVNode(" 下載核定計畫書 ")],-1))]),e.createElementVNode("div",{class:"d-flex gap-2"},[e.createElementVNode("button",{class:"btn btn-pink",onClick:c,type:"button"}," 計畫終止 ")])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:V,tabindex:"-1"},[e.createElementVNode("div",Wm,[e.createElementVNode("div",Ym,[o[8]||(o[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Hm,[o[6]||(o[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),o[7]||(o[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(N,{error:e.unref(d).Reason,modelValue:e.unref(E).Reason,"onUpdate:modelValue":o[0]||(o[0]=t=>e.unref(E).Reason=t),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[o[5]||(o[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:a},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:n,tabindex:"-1"},[...o[9]||(o[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:r,tabindex:"-1"},[e.createElementVNode("div",Zm,[e.createElementVNode("div",Km,[o[14]||(o[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Xm,[e.createElementVNode("div",vm,[e.createElementVNode("div",null,[o[10]||(o[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(N,{error:e.unref(d).RejectReason,modelValue:e.unref(l).RejectReason,"onUpdate:modelValue":o[1]||(o[1]=t=>e.unref(l).RejectReason=t),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),o[12]||(o[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",eV,[o[11]||(o[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",tV,[e.createVNode(m,{error:e.unref(d).RecoveryAmount,modelValue:e.unref(l).RecoveryAmount,"onUpdate:modelValue":o[2]||(o[2]=t=>e.unref(l).RecoveryAmount=t),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[o[13]||(o[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:b},"送出")])])])])],512)]))],64)}}},oV={key:0,class:"text-pink"},Z={AccessibilityApplication:Ge,AccessibilityAttachment:mt,AccessibilityBenefit:$t,AccessibilityFunding:Ht,AccessibilityProgressBar:Zt,AccessibilityWorkSchedule:kl,ConfirmModal:Bl,CommonProgressBar:Ul,CultureApplication:No,CultureAttachment:Mo,CultureFunding:an,CultureOther:yn,CultureProgressBar:hn,CultureWorkSchedule:pr,EducationApplication:oa,EducationAttachment:$a,EducationProgressBar:xa,ErrorModal:Da,InputBoolean:Sa,InputFile:Ua,InputInteger:Ma,InputMonth:Ia,InputRadioGroup:Pa,InputSelect:Ja,InputText:Ha,InputTextarea:ed,InputTwDate:od,LiteracyApplication:Md,LiteracyAttachment:ts,LiteracyBenefit:ps,LiteracyFunding:Ps,LiteracyProgressBar:qs,LiteracyWorkSchedule:cc,MultipleApplication:Rc,MultipleAttachment:di,MultipleBenefit:ki,MultipleFunding:Gi,MultipleProgressBar:Qi,MultipleWorkSchedule:Nm,ProjectCorrectionReview:ym,ProjectOrganizer:Dm,ProjectProgress:Um,ProjectReview:Pm,ProjectTitle:zm,ProjectToolbar:lV,RequiredLabel:{__name:"RequiredLabel",setup(y){const g=e.inject("editable",!0);return(u,E)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(g)?(e.openBlock(),e.createElementBlock("span",oV,"* ")):e.createCommentVNode("",!0),e.renderSlot(u.$slots,"default")],64))}},TwDate:{__name:"TwDate",props:{value:{default:null,type:String}},setup(y){const g=y,u=V=>{const d=V==null?void 0:V.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return d?`${parseInt(d[1],10)-1911}/${d[2]}/${d[3]}`:""},E=e.ref(u(g.value));return e.watch(()=>g.value,V=>E.value=u(V)),(V,d)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(E)),1))}}};return{install:y=>{for(const g in Z)y.component(g,Z[g])},useProgressStore:I}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
