(function(e,Q){typeof exports=="object"&&typeof module<"u"?module.exports=Q(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],Q):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=Q(e.Vue,e.Pinia))})(this,(function(e,Q){"use strict";const j=Q.defineStore("progress",{actions:{init(B,x,g){var i,m;this[B]={id:x.ProjectID,type:(i=x.SubsidyPlanType)==null?void 0:i.split(" ")[0],name:x.ProjectName,step:x.FormStep,status:x.Status,progress:x.ProgressStatus,changeStatus:(m=x.changeApply)==null?void 0:m.Status,reportStatus:g==null?void 0:g.Status,organizer:x.Organizer,organizerName:x.OrganizerName,isOrganizer:x.isOrganizer}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})});let re=Date.now();const z=(B,x,g)=>{const i=j();if([1,14].includes(i[B].status)||[1,4].includes(i[B].changeStatus))return!0;if(i[B].status===42)switch(B){case"culture":if([2,3,5].includes(g))return!0;break;case"multiple":if([2,3,4,5].includes(g))return!0;break;case"accessibility":if([2,3,4,5].includes(g))return!0;break}return!1},ae=()=>`id--${re++}`,q=B=>parseInt(B)||0,v=Q.defineStore("message",{state:()=>({error:null})}),{ajax:se}=rxjs.ajax,{catchError:de,map:ce}=rxjs;let W="";const ie=(B,x={})=>H("Service/OFS/Accessibility.ashx",{method:B,param:x}),me=(B,x={})=>H("Service/OFS/Culture.ashx",{method:B,param:x}),pe=B=>`${W}/Service/OFS/Download.ashx?path=${encodeURIComponent(B)}`,Ve=(B,x={})=>H("Service/OFS/Education.ashx",{method:B,param:x}),fe=B=>{if(B.status===403){let x="/OFS/Home.aspx";/\/OFS\/(ACC|CUL|EDC|LIT|MUL)\/(Application|Attachment|Benefit|Funding|Other|WorkSchedule)\.aspx/.test(window.location.href)?x="/OFS/ApplicationChecklist.aspx":/\/OFS\/(ACC|CUL|EDC|LIT|MUL)\/(Review)\.aspx/.test(window.location.href)?x="/OFS/ReviewChecklist.aspx":/\/OFS\/(ACC|CUL|EDC|LIT|MUL)\/(Audit|Payment|Progress|Report)\.aspx/.test(window.location.href)&&(x="/OFS/inprogressList.aspx"),window.location.href=ee(x)}},Ne=(B,x={})=>H("Service/OFS/Literacy.ashx",{method:B,param:x}),Ee=(B,x={})=>H("Service/OFS/Multiple.ashx",{method:B,param:x}),be=({response:B,status:x})=>{if(x===200){if(B.success)return B.data;v().error=B.message}},H=(B,x={})=>{const g={};x.constructor!==FormData&&(g["Content-Type"]="application/json");const i={body:x,headers:g,method:"POST",url:`${W}/${B}`};return se(i).pipe(ce(be),de(fe))},ge=(B,x)=>{let g=`${W}/Service/SCI_Download.ashx?action=${B}`;return Object.keys(x).forEach(i=>g=`${g}&${i}=${encodeURIComponent(x[i])}`),g},ye=B=>W=B,ke=(B,x={})=>H("Service/OFS/System.ashx",{method:B,param:x}),ee=B=>`${W}${B}`,A=Object.assign(H,{accessibility:ie,culture:me,download:pe,education:Ve,literacy:Ne,multiple:Ee,sciDownload:ge,setBaseUrl:ye,system:ke,toUrl:ee,upload:B=>{const x=new FormData;return x.append("file",B),H("Service/OFS/Upload.ashx",x)}});function ue(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}var K={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var he=K.exports,te;function xe(){return te||(te=1,(function(B,x){(function(g,i,m){var N=function(o,l,d){d=n.extend({},n.options,d);var b=n.runValidations(o,l,d);if(b.some(function(k){return n.isPromise(k.error)}))throw new Error("Use validate.async if you want support for promises");return N.processValidationResults(b,d)},n=N;n.extend=function(o){return[].slice.call(arguments,1).forEach(function(l){for(var d in l)o[d]=l[d]}),o},n.extend(N,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var o=n.format("%{major}.%{minor}.%{patch}",n.version);return n.isEmpty(n.version.metadata)||(o+="+"+n.version.metadata),o}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(o,l,d){var b=[],k,_,h,V,c,a,u;(n.isDomElement(o)||n.isJqueryElement(o))&&(o=n.collectFormValues(o));for(k in l){h=n.getDeepObjectValue(o,k),V=n.result(l[k],h,o,k,d,l);for(_ in V){if(c=n.validators[_],!c)throw u=n.format("Unknown validator %{name}",{name:_}),new Error(u);a=V[_],a=n.result(a,h,o,k,d,l),a&&b.push({attribute:k,value:h,validator:_,globalOptions:d,attributes:o,options:a,error:c.call(c,h,a,k,o,d)})}}return b},processValidationResults:function(o,l){o=n.pruneEmptyErrors(o,l),o=n.expandMultipleErrors(o,l),o=n.convertErrorMessages(o,l);var d=l.format||"grouped";if(typeof n.formatters[d]=="function")o=n.formatters[d](o);else throw new Error(n.format("Unknown format %{format}",l));return n.isEmpty(o)?void 0:o},async:function(o,l,d){d=n.extend({},n.async.options,d);var b=d.wrapErrors||function(_){return _};d.cleanAttributes!==!1&&(o=n.cleanAttributes(o,l));var k=n.runValidations(o,l,d);return new n.Promise(function(_,h){n.waitForResults(k).then(function(){var V=n.processValidationResults(k,d);V?h(new b(V,d,o,l)):_(o)},function(V){h(V)})})},single:function(o,l,d){return d=n.extend({},n.single.options,d,{format:"flat",fullMessages:!1}),n({single:o},{single:l},d)},waitForResults:function(o){return o.reduce(function(l,d){return n.isPromise(d.error)?l.then(function(){return d.error.then(function(b){d.error=b||null})}):l},new n.Promise(function(l){l()}))},result:function(o){var l=[].slice.call(arguments,1);return typeof o=="function"&&(o=o.apply(null,l)),o},isNumber:function(o){return typeof o=="number"&&!isNaN(o)},isFunction:function(o){return typeof o=="function"},isInteger:function(o){return n.isNumber(o)&&o%1===0},isBoolean:function(o){return typeof o=="boolean"},isObject:function(o){return o===Object(o)},isDate:function(o){return o instanceof Date},isDefined:function(o){return o!=null},isPromise:function(o){return!!o&&n.isFunction(o.then)},isJqueryElement:function(o){return o&&n.isString(o.jquery)},isDomElement:function(o){return!o||!o.querySelectorAll||!o.querySelector?!1:n.isObject(document)&&o===document?!0:typeof HTMLElement=="object"?o instanceof HTMLElement:o&&typeof o=="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName=="string"},isEmpty:function(o){var l;if(!n.isDefined(o))return!0;if(n.isFunction(o))return!1;if(n.isString(o))return n.EMPTY_STRING_REGEXP.test(o);if(n.isArray(o))return o.length===0;if(n.isDate(o))return!1;if(n.isObject(o)){for(l in o)return!1;return!0}return!1},format:n.extend(function(o,l){return n.isString(o)?o.replace(n.format.FORMAT_REGEXP,function(d,b,k){return b==="%"?"%{"+k+"}":String(l[k])}):o},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(o){return n.isNumber(o)?o*100%1===0?""+o:parseFloat(Math.round(o*100)/100).toFixed(2):n.isArray(o)?o.map(function(l){return n.prettify(l)}).join(", "):n.isObject(o)?n.isDefined(o.toString)?o.toString():JSON.stringify(o):(o=""+o,o.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(l,d,b){return""+d+" "+b.toLowerCase()}).toLowerCase())},stringifyValue:function(o,l){var d=l&&l.prettify||n.prettify;return d(o)},isString:function(o){return typeof o=="string"},isArray:function(o){return{}.toString.call(o)==="[object Array]"},isHash:function(o){return n.isObject(o)&&!n.isArray(o)&&!n.isFunction(o)},contains:function(o,l){return n.isDefined(o)?n.isArray(o)?o.indexOf(l)!==-1:l in o:!1},unique:function(o){return n.isArray(o)?o.filter(function(l,d,b){return b.indexOf(l)==d}):o},forEachKeyInKeypath:function(o,l,d){if(n.isString(l)){var b="",k,_=!1;for(k=0;k<l.length;++k)switch(l[k]){case".":_?(_=!1,b+="."):(o=d(o,b,!1),b="");break;case"\\":_?(_=!1,b+="\\"):_=!0;break;default:_=!1,b+=l[k];break}return d(o,b,!0)}},getDeepObjectValue:function(o,l){if(n.isObject(o))return n.forEachKeyInKeypath(o,l,function(d,b){if(n.isObject(d))return d[b]})},collectFormValues:function(o,l){var d={},b,k,_,h,V,c;if(n.isJqueryElement(o)&&(o=o[0]),!o)return d;for(l=l||{},h=o.querySelectorAll("input[name], textarea[name]"),b=0;b<h.length;++b)if(_=h.item(b),!n.isDefined(_.getAttribute("data-ignored"))){var a=_.name.replace(/\./g,"\\\\.");c=n.sanitizeFormValue(_.value,l),_.type==="number"?c=c?+c:null:_.type==="checkbox"?_.attributes.value?_.checked||(c=d[a]||null):c=_.checked:_.type==="radio"&&(_.checked||(c=d[a]||null)),d[a]=c}for(h=o.querySelectorAll("select[name]"),b=0;b<h.length;++b)if(_=h.item(b),!n.isDefined(_.getAttribute("data-ignored"))){if(_.multiple){c=[];for(k in _.options)V=_.options[k],V&&V.selected&&c.push(n.sanitizeFormValue(V.value,l))}else{var u=typeof _.options[_.selectedIndex]<"u"?_.options[_.selectedIndex].value:"";c=n.sanitizeFormValue(u,l)}d[_.name]=c}return d},sanitizeFormValue:function(o,l){return l.trim&&n.isString(o)&&(o=o.trim()),l.nullify!==!1&&o===""?null:o},capitalize:function(o){return n.isString(o)?o[0].toUpperCase()+o.slice(1):o},pruneEmptyErrors:function(o){return o.filter(function(l){return!n.isEmpty(l.error)})},expandMultipleErrors:function(o){var l=[];return o.forEach(function(d){n.isArray(d.error)?d.error.forEach(function(b){l.push(n.extend({},d,{error:b}))}):l.push(d)}),l},convertErrorMessages:function(o,l){l=l||{};var d=[],b=l.prettify||n.prettify;return o.forEach(function(k){var _=n.result(k.error,k.value,k.attribute,k.options,k.attributes,k.globalOptions);if(!n.isString(_)){d.push(k);return}_[0]==="^"?_=_.slice(1):l.fullMessages!==!1&&(_=n.capitalize(b(k.attribute))+" "+_),_=_.replace(/\\\^/g,"^"),_=n.format(_,{value:n.stringifyValue(k.value,l)}),d.push(n.extend({},k,{error:_}))}),d},groupErrorsByAttribute:function(o){var l={};return o.forEach(function(d){var b=l[d.attribute];b?b.push(d):l[d.attribute]=[d]}),l},flattenErrorsToArray:function(o){return o.map(function(l){return l.error}).filter(function(l,d,b){return b.indexOf(l)===d})},cleanAttributes:function(o,l){function d(_,h,V){return n.isObject(_[h])?_[h]:_[h]=V?!0:{}}function b(_){var h={},V;for(V in _)_[V]&&n.forEachKeyInKeypath(h,V,d);return h}function k(_,h){if(!n.isObject(_))return _;var V=n.extend({},_),c,a;for(a in _)c=h[a],n.isObject(c)?V[a]=k(V[a],c):c||delete V[a];return V}return!n.isObject(l)||!n.isObject(o)?{}:(l=b(l),k(o,l))},exposeModule:function(o,l,d,b,k){d?(b&&b.exports&&(d=b.exports=o),d.validate=o):(l.validate=o,o.isFunction(k)&&k.amd&&k([],function(){return o}))},warn:function(o){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+o)},error:function(o){typeof console<"u"&&console.error&&console.error("[validate.js] "+o)}}),N.validators={presence:function(o,l){if(l=n.extend({},this.options,l),l.allowEmpty!==!1?!n.isDefined(o):n.isEmpty(o))return l.message||this.message||"can't be blank"},length:function(o,l,d){if(n.isDefined(o)){l=n.extend({},this.options,l);var b=l.is,k=l.maximum,_=l.minimum,h=l.tokenizer||function(u){return u},V,c=[];o=h(o);var a=o.length;if(!n.isNumber(a))return l.message||this.notValid||"has an incorrect length";if(n.isNumber(b)&&a!==b&&(V=l.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",c.push(n.format(V,{count:b}))),n.isNumber(_)&&a<_&&(V=l.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",c.push(n.format(V,{count:_}))),n.isNumber(k)&&a>k&&(V=l.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",c.push(n.format(V,{count:k}))),c.length>0)return l.message||c}},numericality:function(o,l,d,b,k){if(n.isDefined(o)){l=n.extend({},this.options,l);var _=[],h,V,c={greaterThan:function(f,r){return f>r},greaterThanOrEqualTo:function(f,r){return f>=r},equalTo:function(f,r){return f===r},lessThan:function(f,r){return f<r},lessThanOrEqualTo:function(f,r){return f<=r},divisibleBy:function(f,r){return f%r===0}},a=l.prettify||k&&k.prettify||n.prettify;if(n.isString(o)&&l.strict){var u="^-?(0|[1-9]\\d*)";if(l.onlyInteger||(u+="(\\.\\d+)?"),u+="$",!new RegExp(u).test(o))return l.message||l.notValid||this.notValid||this.message||"must be a valid number"}if(l.noStrings!==!0&&n.isString(o)&&!n.isEmpty(o)&&(o=+o),!n.isNumber(o))return l.message||l.notValid||this.notValid||this.message||"is not a number";if(l.onlyInteger&&!n.isInteger(o))return l.message||l.notInteger||this.notInteger||this.message||"must be an integer";for(h in c)if(V=l[h],n.isNumber(V)&&!c[h](o,V)){var E="not"+n.capitalize(h),s=l[E]||this[E]||this.message||"must be %{type} %{count}";_.push(n.format(s,{count:V,type:a(h)}))}if(l.odd&&o%2!==1&&_.push(l.notOdd||this.notOdd||this.message||"must be odd"),l.even&&o%2!==0&&_.push(l.notEven||this.notEven||this.message||"must be even"),_.length)return l.message||_}},datetime:n.extend(function(o,l){if(!n.isFunction(this.parse)||!n.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(n.isDefined(o)){l=n.extend({},this.options,l);var d,b=[],k=l.earliest?this.parse(l.earliest,l):NaN,_=l.latest?this.parse(l.latest,l):NaN;if(o=this.parse(o,l),isNaN(o)||l.dateOnly&&o%864e5!==0)return d=l.notValid||l.message||this.notValid||"must be a valid date",n.format(d,{value:arguments[0]});if(!isNaN(k)&&o<k&&(d=l.tooEarly||l.message||this.tooEarly||"must be no earlier than %{date}",d=n.format(d,{value:this.format(o,l),date:this.format(k,l)}),b.push(d)),!isNaN(_)&&o>_&&(d=l.tooLate||l.message||this.tooLate||"must be no later than %{date}",d=n.format(d,{date:this.format(_,l),value:this.format(o,l)}),b.push(d)),b.length)return n.unique(b)}},{parse:null,format:null}),date:function(o,l){return l=n.extend({},l,{dateOnly:!0}),n.validators.datetime.call(n.validators.datetime,o,l)},format:function(o,l){(n.isString(l)||l instanceof RegExp)&&(l={pattern:l}),l=n.extend({},this.options,l);var d=l.message||this.message||"is invalid",b=l.pattern,k;if(n.isDefined(o)&&(!n.isString(o)||(n.isString(b)&&(b=new RegExp(l.pattern,l.flags)),k=b.exec(o),!k||k[0].length!=o.length)))return d},inclusion:function(o,l){if(n.isDefined(o)&&(n.isArray(l)&&(l={within:l}),l=n.extend({},this.options,l),!n.contains(l.within,o))){var d=l.message||this.message||"^%{value} is not included in the list";return n.format(d,{value:o})}},exclusion:function(o,l){if(n.isDefined(o)&&(n.isArray(l)&&(l={within:l}),l=n.extend({},this.options,l),!!n.contains(l.within,o))){var d=l.message||this.message||"^%{value} is restricted";return n.isString(l.within[o])&&(o=l.within[o]),n.format(d,{value:o})}},email:n.extend(function(o,l){l=n.extend({},this.options,l);var d=l.message||this.message||"is not a valid email";if(n.isDefined(o)&&(!n.isString(o)||!this.PATTERN.exec(o)))return d},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(o,l,d,b,k){if(n.isDefined(o)){n.isString(l)&&(l={attribute:l}),l=n.extend({},this.options,l);var _=l.message||this.message||"is not equal to %{attribute}";if(n.isEmpty(l.attribute)||!n.isString(l.attribute))throw new Error("The attribute must be a non empty string");var h=n.getDeepObjectValue(b,l.attribute),V=l.comparator||function(a,u){return a===u},c=l.prettify||k&&k.prettify||n.prettify;if(!V(o,h,l,d,b))return n.format(_,{attribute:c(l.attribute)})}},url:function(o,l){if(n.isDefined(o)){l=n.extend({},this.options,l);var d=l.message||this.message||"is not a valid url",b=l.schemes||this.schemes||["http","https"],k=l.allowLocal||this.allowLocal||!1,_=l.allowDataUrl||this.allowDataUrl||!1;if(!n.isString(o))return d;var h="^(?:(?:"+b.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",V="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(k?V+="?":h+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",h+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+V+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",_){var c="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",a="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",u="data:(?:"+c+")?(?:;base64)?,"+a;h="(?:"+h+")|(?:^"+u+"$)"}var E=new RegExp(h,"i");if(!E.exec(o))return d}},type:n.extend(function(o,l,d,b,k){if(n.isString(l)&&(l={type:l}),!!n.isDefined(o)){var _=n.extend({},this.options,l),h=_.type;if(!n.isDefined(h))throw new Error("No type was specified");var V;if(n.isFunction(h)?V=h:V=this.types[h],!n.isFunction(V))throw new Error("validate.validators.type.types."+h+" must be a function.");if(!V(o,_,d,b,k)){var c=l.message||this.messages[h]||this.message||_.message||(n.isFunction(h)?"must be of the correct type":"must be of type %{type}");return n.isFunction(c)&&(c=c(o,l,d,b,k)),n.format(c,{attribute:n.prettify(d),type:h})}}},{types:{object:function(o){return n.isObject(o)&&!n.isArray(o)},array:n.isArray,integer:n.isInteger,number:n.isNumber,string:n.isString,date:n.isDate,boolean:n.isBoolean},messages:{}})},N.formatters={detailed:function(o){return o},flat:n.flattenErrorsToArray,grouped:function(o){var l;o=n.groupErrorsByAttribute(o);for(l in o)o[l]=n.flattenErrorsToArray(o[l]);return o},constraint:function(o){var l;o=n.groupErrorsByAttribute(o);for(l in o)o[l]=o[l].map(function(d){return d.validator}).sort();return o}},N.exposeModule(N,this,g,i,m)}).call(he,x,B,null)})(K,K.exports)),K.exports}var $e=xe();const le=ue($e),M=(B,x,g="")=>{const i={};Object.keys(x).forEach(n=>{const o=x[n];le.isString(o)?i[n]={presence:{allowEmpty:!1,message:o.startsWith("^")?o:`^請輸入${o}`}}:i[n]=o});const m={},N=le(B,i);return N&&Object.keys(N).forEach(n=>m[`${g}${n}`]=N[n].join(",")),m},Be={class:"block"},_e={class:"mt-4"},Ce={class:"table align-middle gray-table side-table"},Te={key:0},we={key:1,class:"text-light-gray"},Se={class:"d-flex flex-column gap-2"},De={key:0},Ae={class:"mt-4"},Fe={class:"table align-middle gray-table side-table"},Ue={class:"row g-3"},Pe={class:"col-12 col-xl-2"},Me={class:"text-gray mb-2"},Ie={class:"col-12 col-xl-3"},je={class:"text-gray mb-2"},Oe={class:"col-12 col-xl-4"},Le={class:"row g-1"},Re={class:"col-7"},qe={class:"col-5"},ze={class:"col-12 col-xl-3"},Ge={class:"text-gray mb-2"},Je={class:"col-12"},Ye={class:"text-gray mb-2"},Qe={class:"mt-4"},He={class:"table align-middle gray-table side-table"},We={class:"mt-4"},Ke={class:"table align-middle gray-table side-table"},Xe={key:0,class:"table-responsive mt-3 mb-0"},Ze={class:"table align-middle gray-table"},ve={key:0},et={key:0},tt={class:"d-flex gap-2"},lt=["onClick"],ot={class:"mt-4"},nt={class:"table align-middle gray-table side-table"},rt={key:0,class:"block-bottom bg-light-teal"},at={__name:"Application",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.ref(),n=e.computed(()=>z("accessibility",d.value.Status,1)),o=e.ref({}),l=e.computed(()=>b.value.filter(E=>!E.Deleted)),d=e.ref({}),b=e.ref([]),k=e.computed({get:()=>!!l.value.length,set:E=>{E?_():b.value.forEach(s=>s.Deleted=!0)}}),_=()=>b.value.push({}),h=x,V=()=>{A.accessibility("getApplication",{Apply:g.apply?"true":"false",ID:g.id}).subscribe(E=>{d.value=E.Project,N.value=E.Contacts,b.value=E.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,j().init("accessibility",d.value),m.value=d.value.changeApply,d.value.changeApply=void 0})},c=E=>E.Deleted=!0,a=E=>{var f,r;if(o.value={},E&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const s={Project:d.value,Contacts:N.value,ReceivedSubsidies:b.value.filter(t=>t.ID||!t.Deleted),Before:(f=m.value)==null?void 0:f.Form1Before,After:(r=m.value)==null?void 0:r.Form1After,Submit:E?"true":"false"};A.accessibility("saveApplication",s).subscribe(t=>{E?h("next",t.ID):d.value.ID?V():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let E={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value.OrgCategory==="2"&&(E.RegisteredNum="立案登記證字號"),o.value=M(d.value,E),E={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((s,f)=>Object.assign(o.value,M(s,E,`contact-${f}-`))),E={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},b.value.forEach((s,f)=>Object.assign(o.value,M(s,E,`received-${f}-`))),m.value&&(E={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,M(m.value,E))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(E=>{i.value=E[0],g.id?V():A.accessibility("getEmptyApplication").subscribe(s=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},s),N.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("accessibility",d.value)})})}),e.provide("editable",n),(E,s)=>{const f=e.resolveComponent("required-label"),r=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),p=e.resolveComponent("input-textarea"),y=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Be,[s[42]||(s[42]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",_e,[e.createElementVNode("table",Ce,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[15]||(s[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[s[16]||(s[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",Te,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",we,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[s[17]||(s[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[18]||(s[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(o).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":s[0]||(s[0]=C=>e.unref(d).ProjectName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[19]||(s[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":s[1]||(s[1]=C=>e.unref(d).OrgName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[20]||(s[20]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Se,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":s[2]||(s[2]=C=>e.unref(d).OrgCategory=C)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",De,[e.createVNode(r,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":s[3]||(s[3]=C=>e.unref(d).RegisteredNum=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[21]||(s[21]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":s[4]||(s[4]=C=>e.unref(d).TaxID=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[22]||(s[22]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":s[5]||(s[5]=C=>e.unref(d).Address=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),s[43]||(s[43]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ae,[e.createElementVNode("table",Fe,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(C,w)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ue,[e.createElementVNode("div",Pe,[e.createElementVNode("div",Me,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[23]||(s[23]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(o)[`contact-${w}-Name`],modelValue:C.Name,"onUpdate:modelValue":P=>C.Name=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ie,[e.createElementVNode("div",je,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[24]||(s[24]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(o)[`contact-${w}-JobTitle`],modelValue:C.JobTitle,"onUpdate:modelValue":P=>C.JobTitle=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Oe,[s[25]||(s[25]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Le,[e.createElementVNode("div",Re,[e.createVNode(r,{modelValue:C.Phone,"onUpdate:modelValue":P=>C.Phone=P,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",qe,[e.createVNode(r,{placeholder:"請輸入分機",size:"4",modelValue:C.PhoneExt,"onUpdate:modelValue":P=>C.PhoneExt=P,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",ze,[e.createElementVNode("div",Ge,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[26]||(s[26]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(o)[`contact-${w}-MobilePhone`],modelValue:C.MobilePhone,"onUpdate:modelValue":P=>C.MobilePhone=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Je,[e.createElementVNode("div",Ye,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[27]||(s[27]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(o)[`contact-${w}-EMail`],modelValue:C.EMail,"onUpdate:modelValue":P=>C.EMail=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),s[44]||(s[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Qe,[e.createElementVNode("table",He,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[28]||(s[28]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[s[29]||(s[29]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(p,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":s[6]||(s[6]=C=>e.unref(d).Target=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[30]||(s[30]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":s[7]||(s[7]=C=>e.unref(d).Summary=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[31]||(s[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":s[8]||(s[8]=C=>e.unref(d).Quantified=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[32]||(s[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":s[9]||(s[9]=C=>e.unref(d).Qualitative=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",We,[e.createElementVNode("table",Ke,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[38]||(s[38]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(k),"onUpdate:modelValue":s[10]||(s[10]=C=>e.isRef(k)?k.value=C:null)},null,8,["modelValue"]),e.unref(k)?(e.openBlock(),e.createElementBlock("div",Xe,[e.createElementVNode("table",Ze,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[s[33]||(s[33]=e.createElementVNode("th",null,"計畫名稱",-1)),s[34]||(s[34]=e.createElementVNode("th",null,"補助單位",-1)),s[35]||(s[35]=e.createElementVNode("th",{class:"text-end"},"補助金額(元)",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",ve,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,w)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(o)[`received-${w}-Name`],modelValue:C.Name,"onUpdate:modelValue":P=>C.Name=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(o)[`received-${w}-Unit`],modelValue:C.Unit,"onUpdate:modelValue":P=>C.Unit=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${w}-Amount`],modelValue:C.Amount,"onUpdate:modelValue":P=>C.Amount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",et,[e.createElementVNode("div",tt,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>c(C),type:"button"},[...s[36]||(s[36]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,lt)):e.createCommentVNode("",!0),w+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:_,type:"button"},[...s[37]||(s[37]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[s[41]||(s[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ot,[e.createElementVNode("table",nt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[39]||(s[39]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":s[11]||(s[11]=C=>e.unref(m).Form1Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[40]||(s[40]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":s[12]||(s[12]=C=>e.unref(m).Form1After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",rt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[13]||(s[13]=C=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[14]||(s[14]=C=>a(!0)),type:"button"},[...s[45]||(s[45]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},st={class:"block"},dt={key:0,class:"text-pink lh-base mt-4"},ct={class:"mt-4"},it={class:"table align-middle gray-table"},mt={class:"text-center"},pt={key:0,width:"180"},Vt={class:"text-center"},ft={key:0},Nt=["innerHTML"],Et=["href"],bt={key:0,class:"text-center"},gt={key:0},yt={key:1,class:"text-pink"},kt={key:1,class:"tag-group mt-2 gap-1"},ut={key:0,class:"tag tag-green-light"},ht=["download","href"],xt=["onClick"],$t={key:1,class:"text-center mt-4"},Bt={class:"mt-4"},_t={class:"table align-middle gray-table side-table"},Ct={key:0,class:"block-bottom bg-light-teal"},Tt=["disabled"],wt={__name:"Attachment",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([{Type:1,Title:"申請表",Template:`../../Service/OFS/DownloadTemplateACC.ashx?type=1&id=${g.id}`,Files:[]},{Type:2,Title:"計畫書",Template:`../../Service/OFS/DownloadTemplateACC.ashx?type=2&id=${g.id}`,Files:[]},{Type:3,Title:"執行承諾書",Template:`../../Service/OFS/DownloadTemplateACC.ashx?type=3&id=${g.id}`,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:`../../Service/OFS/DownloadTemplateACC.ashx?type=4&id=${g.id}`,Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),m=e.ref(),N=e.computed(()=>i.value.some(c=>!c.Optional&&!c.Files.filter(a=>!a.Deleted).length)),n=e.computed(()=>z("accessibility",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,a)=>{a.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:a.Path,Name:l.value.ProjectID+"_"+(c.Multiple?a.Name:`${c.Title}.pdf`)})},b=A.download,k=x,_=()=>{rxjs.forkJoin([A.accessibility("getAttachment",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=i.value.filter(u=>{var E;return!((E=u.Excludes)!=null&&E.includes(l.value.OrgCategory))}),i.value.forEach(u=>{u.Files=a.Attachments.filter(E=>E.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(E=>!E.Deleted).length)}),j().init("accessibility",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},h=c=>{var u,E;if(o.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={ID:g.id,Attachments:i.value.reduce((s,f)=>s.concat(f.Files),[]),Before:(u=m.value)==null?void 0:u.Form5Before,After:(E=m.value)==null?void 0:E.Form5After,Submit:c?"true":"false"};A.accessibility("saveAttachment",a).subscribe(()=>{c?k("next"):_()})},V=()=>{if(m.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,M(m.value,c))}return!Object.keys(o.value).length};return e.onMounted(_),e.provide("editable",n),(c,a)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file"),s=e.resolveComponent("tw-date-time"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",st,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("p",dt,[...a[4]||(a[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ct,[e.createElementVNode("table",it,[e.createElementVNode("thead",mt,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",pt,"狀態")):e.createCommentVNode("",!0),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(r,t)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",Vt,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[r.Optional?(e.openBlock(),e.createElementBlock("span",ft,e.toDisplayString(r.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.Title),1)]),_:2},1024))]),e.unref(n)&&r.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:r.Comment},null,8,Nt)):e.createCommentVNode("",!0),e.unref(n)&&r.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",download:"",href:r.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Et)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",bt,[r.Uploaded?(e.openBlock(),e.createElementBlock("span",gt,"已上傳")):(e.openBlock(),e.createElementBlock("span",yt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&(r.Multiple||!r.Uploaded)?(e.openBlock(),e.createBlock(E,{key:0,accept:".pdf",onFile:p=>d(r,p)},null,8,["onFile"])):e.createCommentVNode("",!0),r.Uploaded?(e.openBlock(),e.createElementBlock("div",kt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.Files,p=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:p},[p.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ut,[e.createElementVNode("a",{class:"tag-link my-1",download:p.Name,href:e.unref(b)(p.Path)},e.toDisplayString(p.Name),9,ht),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>p.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,xt)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(l).ApplyTime?(e.openBlock(),e.createElementBlock("div",$t,[a[10]||(a[10]=e.createTextVNode("申請送件時間：",-1)),e.createVNode(s,{value:e.unref(l).ApplyTime},null,8,["value"])])):e.createCommentVNode("",!0),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Bt,[e.createElementVNode("table",_t,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(m).Form5Before=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(m).Form5After=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",Ct,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[2]||(a[2]=r=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[3]||(a[3]=r=>h(!0)),disabled:e.unref(N),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Tt)])):e.createCommentVNode("",!0)],64)}}},St={class:"block"},Dt={class:"mt-4"},At={class:"table-responsive mt-3 mb-0"},Ft={class:"table align-middle gray-table"},Ut={key:0,width:"1"},Pt={key:0},Mt={class:"d-flex gap-2"},It=["onClick"],jt={class:"table-responsive mt-3 mb-0"},Ot={class:"table align-middle gray-table"},Lt={class:"mt-4"},Rt={class:"table align-middle gray-table side-table"},qt={key:0,class:"block-bottom bg-light-teal"},zt={__name:"Benefit",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.computed(()=>z("accessibility",l.value.Status,4)),n=e.ref({}),o=e.computed(()=>i.value.filter(c=>!c.Deleted)),l=e.ref({}),d=()=>i.value.push({}),b=x,k=()=>{rxjs.forkJoin([A.accessibility("getBenefit",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=a.Benefits,i.value.length||d(),j().init("accessibility",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},_=c=>c.Deleted=!0,h=c=>{var u,E;if(n.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={Project:l.value,Benefits:i.value,Before:(u=m.value)==null?void 0:u.Form4Before,After:(E=m.value)==null?void 0:E.Form4After,Submit:c?"true":"false"};A.accessibility("saveBenefit",a).subscribe(()=>{c?b("next"):k()})},V=()=>{let c={Benefit:"不可量化成果"};return n.value=M(l.value,c),c={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((a,u)=>Object.assign(n.value,M(a,c,`item-${u}-`))),m.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(n.value,M(m.value,c))),!Object.keys(n.value).length};return e.onMounted(k),e.provide("editable",N),(c,a)=>{const u=e.resolveComponent("input-text"),E=e.resolveComponent("input-textarea"),s=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",St,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Dt,[e.createElementVNode("div",At,[e.createElementVNode("table",Ft,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"目標值",-1)),a[7]||(a[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Ut,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(f,r)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(n)[`item-${r}-Title`],modelValue:f.Title,"onUpdate:modelValue":t=>f.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(n)[`item-${r}-Target`],modelValue:f.Target,"onUpdate:modelValue":t=>f.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n)[`item-${r}-Description`],rows:"1",modelValue:f.Description,"onUpdate:modelValue":t=>f.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Pt,[e.createElementVNode("div",Mt,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>_(f),type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,It)):e.createCommentVNode("",!0),r+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",jt,[e.createElementVNode("table",Ot,[a[10]||(a[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":a[0]||(a[0]=f=>e.unref(l).Benefit=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Lt,[e.createElementVNode("table",Rt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":a[1]||(a[1]=f=>e.unref(m).Form4Before=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":a[2]||(a[2]=f=>e.unref(m).Form4After=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",qt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[3]||(a[3]=f=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[4]||(a[4]=f=>h(!0)),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Gt={class:"block"},Jt={class:"mt-4"},Yt={class:"table-responsive mt-3 mb-0"},Qt={class:"table align-middle gray-table"},Ht={class:"text-end"},Wt={class:"text-end"},Kt={class:"table-responsive"},Xt={class:"table align-middle gray-table"},Zt=["colspan"],vt={key:0,width:"1"},el={class:"text-end"},tl={key:0},ll={class:"d-flex gap-2"},ol=["onClick"],nl={class:"mt-4"},rl={class:"table-responsive mt-3 mb-0"},al={class:"table align-middle gray-table"},sl={key:0,width:"1"},dl={class:"text-end"},cl={key:0},il={class:"d-flex gap-2"},ml=["onClick"],pl={class:"mt-4"},Vl={class:"table align-middle gray-table side-table"},fl={key:0,class:"block-bottom bg-light-teal"},Nl={class:"text-center"},El={class:"mb-5"},bl={__name:"Funding",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.computed(()=>z("accessibility",l.value.Status,3)),N=e.ref({}),n=e.computed(()=>b.value.filter(r=>!r.Deleted)),o=e.computed(()=>k.value.filter(r=>!r.Deleted)),l=e.ref({}),d=e.ref(),b=e.ref([]),k=e.ref([]),_=e.ref({}),h=e.ref(0),V=()=>b.value.push({}),c=()=>k.value.push({}),a=x,u=()=>{rxjs.forkJoin([A.accessibility("getFunding",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(r=>{const t=r[0];l.value=t.Project,b.value=t.OtherSubsidies,k.value=t.BudgetPlans,_.value=t.GrantTargetSetting,k.value.length||c(),j().init("accessibility",l.value),i.value=l.value.changeApply,l.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=(r,t)=>{var y,S;if(N.value={},r&&!f()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>_.value.GrantLimit*1e4){d.value.show(()=>s(r,!0));return}const p={Project:l.value,OtherSubsidies:b.value,BudgetPlans:k.value,Before:(y=i.value)==null?void 0:y.Form3Before,After:(S=i.value)==null?void 0:S.Form3After,Submit:r?"true":"false"};A.accessibility("saveFunding",p).subscribe(()=>{r?a("next"):u()})},f=()=>{let r={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=M(l.value,r),r={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},n.value.forEach((t,p)=>Object.assign(N.value,M(t,r,`other-${p}-`))),r={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},o.value.forEach((t,p)=>Object.assign(N.value,M(t,r,`plan-${p}-`))),i.value&&(r={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,M(i.value,r))),!Object.keys(N.value).length};return e.onMounted(u),e.provide("editable",m),e.watchEffect(()=>{l.value.OtherAmount=n.value.reduce((r,t)=>r+q(t.Amount),0),h.value=q(l.value.ApplyAmount)+q(l.value.SelfAmount)+q(l.value.OtherAmount),n.value.forEach(r=>r.percent=Math.round(q(r.Amount)/l.value.OtherAmount*1e4)/100),k.value.forEach(r=>r.sum=q(r.Amount)+q(r.OtherAmount))}),(r,t)=>{var P;const p=e.resolveComponent("input-integer"),y=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),C=e.resolveComponent("required-label"),w=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Gt,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Jt,[e.createElementVNode("div",Yt,[e.createElementVNode("table",Qt,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額(元) (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款(元) (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額(元) (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費(元) (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(l).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(l).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Ht,e.toDisplayString((P=e.unref(l).OtherAmount)==null?void 0:P.toLocaleString()),1),e.createElementVNode("td",Wt,e.toDisplayString(e.unref(h).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Kt,[e.createElementVNode("table",Xt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Zt)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額(元)（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",vt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(F,T)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(T+1),1),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(N)[`other-${T}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":D=>F.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`other-${T}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":D=>F.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",el,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`other-${T}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":D=>F.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",tl,[e.createElementVNode("div",ll,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:D=>E(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ol)])])):e.createCommentVNode("",!0)]))),128))])]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增",-1)])])):e.createCommentVNode("",!0)])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",nl,[e.createElementVNode("div",rl,[e.createElementVNode("table",al,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("小計")],-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",sl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(F,T)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(N)[`plan-${T}-Title`],modelValue:F.Title,"onUpdate:modelValue":D=>F.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`plan-${T}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":D=>F.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`plan-${T}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":D=>F.OtherAmount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",dl,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`plan-${T}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":D=>F.Description=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",cl,[e.createElementVNode("div",il,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>E(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ml)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",pl,[e.createElementVNode("table",Vl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(i).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(i).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(i).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(i).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",fl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>s(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(w,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",Nl,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",El,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(_).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Y=Q.defineStore("payment",{actions:{init(B,x=0){this.stage=B==null?void 0:B.Stage,this.amount=B==null?void 0:B.CurrentRequestAmount,this.paid=x,this.status=B==null?void 0:B.Status}},state:()=>({stage:null,amount:null,paid:null,status:null})}),gl={class:"block"},yl={class:"square-title"},kl={class:"text-teal fw-bold py-3"},ul={class:"table-responsive mb-0"},hl={class:"table align-middle gray-table"},xl={class:"text-end"},$l={class:"text-end"},Bl={class:"text-end"},_l={class:"text-teal fw-bold pb-3"},Cl={class:"text-teal fw-bold pb-3"},Tl={class:"mt-4"},wl={class:"table align-middle gray-table"},Sl={class:"text-center"},Dl={key:0,width:"180"},Al={class:"text-center"},Fl=["href"],Ul={key:0,class:"text-center"},Pl={key:0},Ml={key:1,class:"text-pink"},Il={key:1,class:"tag-group mt-2 gap-1"},jl={key:0,class:"tag tag-green-light"},Ol=["download","href"],Ll=["onClick"],Rl={class:"block-bottom bg-light-teal"},ql=["disabled"],zl={__name:"Payment1",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>_.value.some(E=>!E.Files.filter(s=>!s.Deleted).length)),N=e.computed(()=>!l.value||l.value.Status==="請款中"),n=e.computed(()=>{var E;return((E=l.value)==null?void 0:E.Status)==="通過"}),o=e.ref(0),l=e.ref(),d=e.ref({}),b=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(i.value*100/d.value.ApprovedAmount*100)/100,100):0),k=e.computed(()=>n.value?Math.round(i.value*100/l.value.CurrentActualPaidAmount*100)/100+"%":"--"),_=e.ref([{Type:11,Title:"領據",Files:[]}]),h=(E,s)=>{s.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:s.Path,Name:`${d.value.ProjectID}_第一期請款_${E.Title}.pdf`})},V=A.download,c=x,a=()=>{A.accessibility("getPayment",{ID:g.id}).subscribe(E=>{d.value=E.Project,j().init("accessibility",d.value),_.value=_.value.filter(s=>{var f;return!((f=s.Excludes)!=null&&f.includes(d.value.OrgCategory))}),_.value.forEach(s=>{s.Files=E.Attachments.filter(f=>f.Type===s.Type),s.Uploaded=e.computed(()=>s.Files.filter(f=>!f.Deleted).length)}),l.value=E.Payments.find(s=>s.Stage===1),l.value&&(i.value=l.value.TotalSpentAmount),o.value=Math.round(d.value.ApprovedAmount*g.setting.DisbursementRatioPct/100),Y().init(l.value)})},u=E=>{const s={Payment:{ProjectID:g.id,Stage:1,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:_.value.reduce((f,r)=>f.concat(r.Files),[]),Submit:E?"true":"false"};A.accessibility("savePayment",s).subscribe(()=>{E?c("next"):a()})};return e.onMounted(a),e.provide("editable",N),(E,s)=>{var p;const f=e.resolveComponent("input-integer"),r=e.resolveComponent("required-label"),t=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",gl,[e.createElementVNode("h5",yl,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",kl,"核定經費: "+e.toDisplayString((p=e.unref(d).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("div",ul,[e.createElementVNode("table",hl,[s[4]||(s[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",xl,e.toDisplayString(e.unref(i)),1),s[3]||(s[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(f,{max:e.unref(o),modelValue:e.unref(i),"onUpdate:modelValue":s[0]||(s[0]=y=>e.isRef(i)?i.value=y:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",$l,e.toDisplayString(e.unref(b))+"%",1),e.createElementVNode("td",Bl,e.toDisplayString(e.unref(k)),1)])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",_l,"本期實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",Cl,"累積實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),s[10]||(s[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),s[11]||(s[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Tl,[e.createElementVNode("table",wl,[e.createElementVNode("thead",Sl,[e.createElementVNode("tr",null,[s[5]||(s[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[6]||(s[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Dl,"狀態")):e.createCommentVNode("",!0),s[7]||(s[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),(y,S)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",Al,e.toDisplayString(S+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Title),1)]),_:2},1024)]),e.unref(N)&&y.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:y.Template,style:{width:"140px"},type:"button"},[...s[8]||(s[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Fl)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Ul,[y.Uploaded?(e.openBlock(),e.createElementBlock("span",Pl,"已上傳")):(e.openBlock(),e.createElementBlock("span",Ml,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!y.Uploaded?(e.openBlock(),e.createBlock(t,{key:0,accept:".pdf",onFile:C=>h(y,C)},null,8,["onFile"])):e.createCommentVNode("",!0),y.Uploaded?(e.openBlock(),e.createElementBlock("div",Il,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.Files,C=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:C},[C.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",jl,[e.createElementVNode("a",{class:"tag-link my-1",download:C.Name,href:e.unref(V)(C.Path)},e.toDisplayString(C.Name),9,Ol),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:w=>C.Deleted=!0,type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ll)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Rl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[1]||(s[1]=y=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[2]||(s[2]=y=>u(!0)),disabled:e.unref(m),type:"button"},[...s[12]||(s[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,ql)])],64)}}},Gl={class:"block"},Jl={class:"square-title"},Yl={class:"text-teal fw-bold py-3"},Ql={class:"text-teal fw-bold pb-3"},Hl={class:"table-responsive mb-0"},Wl={class:"table align-middle gray-table"},Kl={class:"text-end"},Xl={class:"text-end"},Zl={class:"text-end"},vl={class:"text-end"},eo={class:"text-teal fw-bold pb-3"},to={class:"text-teal fw-bold pb-3"},lo={class:"mt-4"},oo={class:"table align-middle gray-table"},no={class:"text-center"},ro={key:0,width:"180"},ao={class:"text-center"},so=["href"],co={key:0,class:"text-center"},io={key:0},mo={key:1,class:"text-pink"},po={key:1,class:"tag-group mt-2 gap-1"},Vo={key:0,class:"tag tag-green-light"},fo=["download","href"],No=["onClick"],Eo={class:"block-bottom bg-light-teal"},bo=["disabled"],go={__name:"Payment2",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>c.value.some(r=>!r.Files.filter(t=>!t.Deleted).length)),N=e.computed(()=>!l.value||l.value.Status==="請款中"),n=e.computed(()=>{var r;return((r=l.value)==null?void 0:r.Status)==="通過"}),o=e.ref(0),l=e.ref(),d=e.ref(0),b=e.ref(0),k=e.ref({}),_=e.computed(()=>k.value.ApprovedAmount?Math.min(Math.round(i.value*100/k.value.ApprovedAmount*100)/100,100):0),h=e.computed(()=>V.value?Math.round(i.value*100/V.value*100)/100:0),V=e.computed(()=>b.value+(n.value?l.value.CurrentActualPaidAmount:0)),c=e.ref([{Type:21,Title:"領據",Files:[]},{Type:22,Title:"經費收支明細表",Template:"../../Template/ACC/1-經費收支明細表.docx",Files:[]},{Type:23,Title:"經費分攤表",Template:"../../Template/ACC/2-經費分攤表.docx",Files:[]},{Type:24,Title:"補助清單",Template:"../../Template/ACC/3-補助清單.docx",Files:[]},{Type:25,Title:"其他",Files:[]}]),a=(r,t)=>{t.Type==="application/pdf"&&r.Files.push({Type:r.Type,Path:t.Path,Name:`${k.value.ProjectID}_第二期請款_${r.Title}.pdf`})},u=A.download,E=x,s=()=>{A.accessibility("getPayment",{ID:g.id}).subscribe(r=>{k.value=r.Project,j().init("accessibility",k.value),c.value=c.value.filter(p=>{var y;return!((y=p.Excludes)!=null&&y.includes(k.value.OrgCategory))}),c.value.forEach(p=>{p.Files=r.Attachments.filter(y=>y.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(y=>!y.Deleted).length)}),l.value=r.Payments.find(p=>p.Stage===2),l.value&&(i.value=l.value.TotalSpentAmount),o.value=k.value.ApprovedAmount;const t=r.Payments.filter(p=>p.Stage<2&&p.Status==="通過");d.value=t.reduce((p,y)=>p+y.CurrentRequestAmount,0),b.value=t.reduce((p,y)=>p+y.CurrentActualPaidAmount,0),Y().init(l.value,b.value)})},f=r=>{const t={Payment:{ProjectID:g.id,Stage:2,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:c.value.reduce((p,y)=>p.concat(y.Files),[]),Submit:r?"true":"false"};A.accessibility("savePayment",t).subscribe(()=>{r?E("next"):s()})};return e.onMounted(s),e.provide("editable",N),(r,t)=>{var C;const p=e.resolveComponent("input-integer"),y=e.resolveComponent("required-label"),S=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Gl,[e.createElementVNode("h5",Jl,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",Yl,"核定經費: "+e.toDisplayString((C=e.unref(k).ApprovedAmount)==null?void 0:C.toLocaleString())+"元",1),e.createElementVNode("p",Ql,"賸餘款: "+e.toDisplayString((e.unref(k).ApprovedAmount-e.unref(i)).toLocaleString())+"元",1),e.createElementVNode("div",Hl,[e.createElementVNode("table",Wl,[t[3]||(t[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Kl,e.toDisplayString(e.unref(i)-e.unref(d)),1),e.createElementVNode("td",Xl,e.toDisplayString(e.unref(b)),1),e.createElementVNode("td",null,[e.createVNode(p,{max:e.unref(o),modelValue:e.unref(i),"onUpdate:modelValue":t[0]||(t[0]=w=>e.isRef(i)?i.value=w:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",Zl,e.toDisplayString(e.unref(_))+"%",1),e.createElementVNode("td",vl,e.toDisplayString(e.unref(h))+"%",1)])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",eo,"本期實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",to,"累積實際撥款: "+e.toDisplayString(e.unref(V).toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),t[9]||(t[9]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),t[10]||(t[10]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",lo,[e.createElementVNode("table",oo,[e.createElementVNode("thead",no,[e.createElementVNode("tr",null,[t[4]||(t[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),t[5]||(t[5]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",ro,"狀態")):e.createCommentVNode("",!0),t[6]||(t[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(w,P)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",ao,e.toDisplayString(P+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(y,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Title),1)]),_:2},1024)]),e.unref(N)&&w.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:w.Template,style:{width:"140px"},type:"button"},[...t[7]||(t[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,so)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",co,[w.Uploaded?(e.openBlock(),e.createElementBlock("span",io,"已上傳")):(e.openBlock(),e.createElementBlock("span",mo,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!w.Uploaded?(e.openBlock(),e.createBlock(S,{key:0,accept:".pdf",onFile:F=>a(w,F)},null,8,["onFile"])):e.createCommentVNode("",!0),w.Uploaded?(e.openBlock(),e.createElementBlock("div",po,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.Files,F=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:F},[F.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Vo,[e.createElementVNode("a",{class:"tag-link my-1",download:F.Name,href:e.unref(u)(F.Path)},e.toDisplayString(F.Name),9,fo),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:T=>F.Deleted=!0,type:"button"},[...t[8]||(t[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,No)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Eo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[1]||(t[1]=w=>f()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[2]||(t[2]=w=>f(!0)),disabled:e.unref(m),type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,bo)])],64)}}},yo={__name:"ProgressBar",setup(B){const x=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(g,i)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:x,type:"accessibility"})}}},ko={class:"block"},uo={class:"mt-4"},ho={class:"table align-middle gray-table side-table"},xo={key:0,class:"d-flex align-items-center gap-2"},$o={class:"input-group w-auto"},Bo={class:"text-teal-dark"},_o={key:1,class:"invalid mt-0"},Co={class:"table-responsive mt-4"},To={class:"table align-middle gray-table"},wo={key:0},So={class:"input-group"},Do={key:0,class:"invalid mt-0"},Ao={key:0},Fo={class:"d-flex gap-2"},Uo=["onClick"],Po={class:"mt-4"},Mo={class:"table align-middle gray-table"},Io={key:0},jo=["value"],Oo={key:0},Lo={class:"d-flex gap-2"},Ro=["onClick"],qo={class:"mt-4"},zo={class:"table align-middle gray-table side-table"},Go={key:0,class:"block-bottom bg-light-teal"},Jo={__name:"WorkSchedule",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=[{value:1,text:"50%"},{value:2,text:"100%"}],m=e.ref(),N=e.computed(()=>k.value.EndDate),n=e.computed(()=>z("accessibility",b.value.Status,2)),o=e.ref({}),l=e.computed(()=>_.value.filter(r=>!r.Deleted)),d=e.computed(()=>h.value.filter(r=>!r.Deleted)),b=e.ref({}),k=e.ref({}),_=e.ref([]),h=e.ref([]),V=()=>A.accessibility("createItem",{ID:g.id}).subscribe(r=>_.value.push(r)),c=()=>h.value.push({Type:0,ItemID:0}),a=x,u=()=>{rxjs.forkJoin([A.accessibility("getWorkSchedule",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(r=>{const t=r[0];b.value=t.Project,k.value=t.GrantType,_.value=t.Items,h.value=t.Schedules,_.value.length||V(),h.value.length||c(),j().init("accessibility",b.value),m.value=b.value.changeApply,b.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=r=>{var p,y;if(o.value={},r&&!f()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:b.value,Items:_.value,Schedules:h.value,Before:(p=m.value)==null?void 0:p.Form2Before,After:(y=m.value)==null?void 0:y.Form2After,Submit:r?"true":"false"};A.accessibility("saveWorkSchedule",t).subscribe(()=>{r?a("next"):u()})},f=()=>{let r={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=M(b.value,r),r={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`item-${p}-`))),r={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`schedule-${p}-`))),m.value&&(r={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,M(m.value,r))),!Object.keys(o.value).length};return e.onMounted(u),e.provide("editable",n),(r,t)=>{const p=e.resolveComponent("required-label"),y=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),C=e.resolveComponent("input-text"),w=e.resolveComponent("input-month"),P=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ko,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",uo,[e.createElementVNode("table",ho,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",xo,[e.createElementVNode("div",$o,[e.createVNode(y,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(b).StartTime,"onUpdate:modelValue":t[0]||(t[0]=T=>e.unref(b).StartTime=T)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(y,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(b).EndTime,"onUpdate:modelValue":t[1]||(t[1]=T=>e.unref(b).EndTime=T)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Bo,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(N)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",_o,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Co,[e.createElementVNode("table",To,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(n)?(e.openBlock(),e.createElementBlock("th",wo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+D)),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(o)[`item-${D}-Title`],modelValue:T.Title,"onUpdate:modelValue":U=>T.Title=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",So,[e.createVNode(w,{"empty-value":0,modelValue:T.Begin,"onUpdate:modelValue":U=>T.Begin=U},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(w,{"empty-value":0,modelValue:T.End,"onUpdate:modelValue":U=>T.End=U},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${D}-Begin`]||e.unref(o)[`item-${D}-End`]?(e.openBlock(),e.createElementBlock("div",Do,e.toDisplayString(e.unref(o)[`item-${D}-Begin`]||e.unref(o)[`item-${D}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`item-${D}-Deadline`],modelValue:T.Deadline,"onUpdate:modelValue":U=>T.Deadline=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`item-${D}-Content`],rows:"1",modelValue:T.Content,"onUpdate:modelValue":U=>T.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",Ao,[e.createElementVNode("div",Fo,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>E(T),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Uo)):e.createCommentVNode("",!0),D+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:V,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Po,[e.createElementVNode("table",Mo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(n)?(e.openBlock(),e.createElementBlock("th",Io,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${D}-Type`],options:i,modelValue:T.Type,"onUpdate:modelValue":U=>T.Type=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${D}-ItemID`],options:e.unref(l),modelValue:T.ItemID,"onUpdate:modelValue":U=>T.ItemID=U,modelModifiers:{trim:!0}},{default:e.withCtx(({index:U,option:I})=>[e.createElementVNode("option",{value:I.ID},e.toDisplayString(String.fromCharCode(65+U))+"."+e.toDisplayString(I.Title),9,jo)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`schedule-${D}-Deadline`],modelValue:T.Deadline,"onUpdate:modelValue":U=>T.Deadline=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`schedule-${D}-Content`],rows:"1",modelValue:T.Content,"onUpdate:modelValue":U=>T.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",Oo,[e.createElementVNode("div",Lo,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>E(T),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ro)):e.createCommentVNode("",!0),D+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",qo,[e.createElementVNode("table",zo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=T=>e.unref(m).Form2Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":t[3]||(t[3]=T=>e.unref(m).Form2After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",Go,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=T=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=T=>s(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Yo={class:"block rounded-bottom-4"},Qo={class:"mt-4"},Ho={class:"table align-middle gray-table side-table"},Wo={class:"text-pink"},Ko={class:"table-responsive",style:{"min-height":"400px"}},Xo={class:"table teal-table"},Zo={"data-th":"計畫編號／計畫名稱:",class:"text-start"},vo=["href"],en={"data-th":"查核日期／人員:",class:"text-start"},tn={"data-th":"風險評估:"},ln={"data-th":"查核意見:",class:"text-start"},on={"data-th":"執行單位回覆:",class:"text-start"},nn={__name:"AuditHistory",props:{name:{type:String}},setup(B){const x=B,g=e.ref([]),i=e.ref(0),m=["無","低風險","中風險","高風險"];return e.onMounted(()=>{A.system("getAuditHistory",{Name:x.name}).subscribe(N=>{g.value=N.List,g.value.forEach(n=>{switch(n.Risk){case"Low":n.lv=1,i.value<1&&(i.value=1);break;case"Medium":n.lv=2,i.value<2&&(i.value=2);break;case"High":n.lv=3,i.value<3&&(i.value=3);break}})})}),(N,n)=>{const o=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock("div",Yo,[n[3]||(n[3]=e.createElementVNode("div",{class:"title border-teal"},[e.createElementVNode("div",{class:"d-flex align-items-center gap-2"},[e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg"}),e.createElementVNode("span",null,"查核紀錄")])])],-1)),e.createElementVNode("div",Qo,[e.createElementVNode("table",Ho,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[0]||(n[0]=e.createElementVNode("th",null,"執行單位",-1)),e.createElementVNode("td",null,e.toDisplayString(B.name),1)]),e.createElementVNode("tr",null,[n[1]||(n[1]=e.createElementVNode("th",null,"風險評估",-1)),e.createElementVNode("td",null,[e.createElementVNode("span",Wo,e.toDisplayString(m[e.unref(i)]),1)])])])])]),e.createElementVNode("div",Ko,[e.createElementVNode("table",Xo,[n[2]||(n[2]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"計畫編號／計畫名稱")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"查核日期／人員")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"風險評估")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"查核意見")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"執行單位回覆")])])])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(g),l=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",Zo,[e.createElementVNode("a",{class:"link-black",href:`AuditRecords.aspx?ProjectID=${l.ProjectID}`,target:"_blank"},e.toDisplayString(l.ProjectID)+"／"+e.toDisplayString(l.ProjectName),9,vo)]),e.createElementVNode("td",en,[e.createVNode(o,{value:l.CheckDate},null,8,["value"]),e.createTextVNode("／"+e.toDisplayString(l.ReviewerName),1)]),e.createElementVNode("td",tn,e.toDisplayString(m[l.lv]),1),e.createElementVNode("td",ln,e.toDisplayString(l.ReviewerComment),1),e.createElementVNode("td",on,e.toDisplayString(l.ExecutorComment),1)]))),128))])])])])}}},rn={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},an={class:"modal-content"},sn={class:"modal-body"},dn={class:"d-flex justify-content-center mt-4 gap-4"},cn={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},mn={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(B,{expose:x}){let g;const i=e.ref(),m=B,N=()=>{g&&g()};return x({show:o=>{g=o,bootstrap.Modal.getOrCreateInstance(i.value).show()}}),(o,l)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:i,tabindex:"-1"},[e.createElementVNode("div",rn,[e.createElementVNode("div",an,[l[0]||(l[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",sn,[e.renderSlot(o.$slots,"default"),e.createElementVNode("div",dn,[e.createElementVNode("button",cn,e.toDisplayString(m.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:N,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(m.confirm),1)])])])])],512)]))}},pn={class:"application-step"},Vn=["onClick"],fn={class:"step-content"},Nn={class:"step-label"},En={key:0,class:"step-status edit"},bn={key:1,class:"step-status"},gn={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(B,{emit:x}){const g=e.computed(()=>z(m.type,i[m.type].status,m.step)),i=j(),m=B,N=o=>{m.review?n("click",o.step):o.step<=i[m.type].step&&(location.href=`${o.url}.aspx?ID=${m.id}`)},n=x;return(o,l)=>(e.openBlock(),e.createElementBlock("div",pn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.steps,d=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(g)&&(d.step<e.unref(i)[B.type].step||d.step===B.step)}]),onClick:b=>N(d),key:d,role:"button"},[e.createElementVNode("div",fn,[e.createElementVNode("div",Nn,e.toDisplayString(d.title),1),e.unref(g)&&d.step===B.step?(e.openBlock(),e.createElementBlock("div",En,"編輯中")):d.step<e.unref(i)[B.type].step?(e.openBlock(),e.createElementBlock("div",bn,"已完成")):e.createCommentVNode("",!0)])],10,Vn))),128))]))}},yn={class:"block"},kn={class:"mt-4"},un={class:"table align-middle gray-table side-table"},hn={key:0},xn={key:1,class:"text-light-gray"},$n={class:"d-flex gap-2"},Bn={key:0,class:"invalid mt-0"},_n={class:"d-flex flex-column gap-2"},Cn={key:0},Tn={class:"mt-4"},wn={class:"table align-middle gray-table side-table"},Sn={class:"row g-3"},Dn={class:"col-12 col-xl-2"},An={class:"text-gray mb-2"},Fn={class:"col-12 col-xl-3"},Un={class:"text-gray mb-2"},Pn={class:"col-12 col-xl-4"},Mn={class:"row g-1"},In={class:"col-7"},jn={class:"col-5"},On={class:"col-12 col-xl-3"},Ln={class:"text-gray mb-2"},Rn={class:"col-12"},qn={class:"text-gray mb-2"},zn={class:"mt-4"},Gn={class:"table align-middle gray-table side-table"},Jn={class:"mt-4"},Yn={class:"table align-middle gray-table side-table"},Qn={key:0,class:"table-responsive mt-3 mb-0"},Hn={class:"table align-middle gray-table"},Wn={key:0},Kn={key:0},Xn={class:"d-flex gap-2"},Zn=["onClick"],vn={class:"mt-4"},er={class:"table align-middle gray-table side-table"},tr={key:0,class:"block-bottom bg-light-teal"},lr={__name:"Application",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.ref(),n=e.computed(()=>z("culture",k.value.Status,1)),o=e.ref({}),l=e.ref(null),d=e.ref([]),b=e.computed(()=>h.value.filter(t=>!t.Deleted)),k=e.ref({}),_=e.computed(()=>d.value.filter(t=>!t.ParentCode)),h=e.ref([]),V=e.computed(()=>d.value.filter(t=>t.ParentCode===l.value)),c=e.computed({get:()=>!!b.value.length,set:t=>{t?a():h.value.forEach(p=>p.Deleted=!0)}}),a=()=>h.value.push({}),u=x,E=()=>{A.culture("getApplication",{Apply:g.apply?"true":"false",ID:g.id}).subscribe(t=>{var p;k.value=t.Project,N.value=t.Contacts,h.value=t.ReceivedSubsidies,l.value=((p=d.value.find(y=>y.Code===k.value.Field))==null?void 0:p.ParentCode)||null,k.value.OrgCategory=k.value.OrgCategory||null,j().init("culture",k.value),m.value=k.value.changeApply,k.value.changeApply=void 0})},s=t=>t.Deleted=!0,f=t=>{var y,S;if(o.value={},t&&!r()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}const p={Project:k.value,Contacts:N.value,ReceivedSubsidies:h.value.filter(C=>C.ID||!C.Deleted),Before:(y=m.value)==null?void 0:y.Form1Before,After:(S=m.value)==null?void 0:S.Form1After,Submit:t?"true":"false"};A.culture("saveApplication",p).subscribe(C=>{t?u("next",C.ID):k.value.ID?E():window.location.href=`Application.aspx?ID=${C.ID}`})},r=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return k.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),o.value=M(k.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((p,y)=>Object.assign(o.value,M(p,t,`contact-${y}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},h.value.forEach((p,y)=>Object.assign(o.value,M(p,t,`received-${y}-`))),m.value&&(t={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,M(m.value,t))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.culture("getZgsCodes",{CodeGroup:"CULField"}),A.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{d.value=t[0],i.value=t[1],g.id?E():A.culture("getEmptyApplication").subscribe(p=>{l.value=null,k.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},p),N.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("culture",k.value)})})}),e.provide("editable",n),e.watch(l,()=>{l.value?V.value.find(t=>k.value.Field===t.Code)||(k.value.Field=V.value[0].Code):k.value.Field=null}),(t,p)=>{const y=e.resolveComponent("required-label"),S=e.resolveComponent("input-text"),C=e.resolveComponent("input-select"),w=e.resolveComponent("input-textarea"),P=e.resolveComponent("input-boolean"),F=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yn,[p[45]||(p[45]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",kn,[e.createElementVNode("table",un,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[17]||(p[17]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(k).Year),1)]),e.createElementVNode("tr",null,[p[18]||(p[18]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(k).ProjectID?(e.openBlock(),e.createElementBlock("span",hn,e.toDisplayString(e.unref(k).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",xn,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[p[19]||(p[19]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(k).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[20]||(p[20]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).ProjectName,modelValue:e.unref(k).ProjectName,"onUpdate:modelValue":p[0]||(p[0]=T=>e.unref(k).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[21]||(p[21]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",$n,[e.createVNode(C,{"empty-value":null,options:e.unref(_),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l),"onUpdate:modelValue":p[1]||(p[1]=T=>e.isRef(l)?l.value=T:null)},null,8,["options","modelValue"]),e.createVNode(C,{"empty-value":null,disabled:!e.unref(l),options:e.unref(V),"text-name":"Descname","value-name":"Code",modelValue:e.unref(k).Field,"onUpdate:modelValue":p[2]||(p[2]=T=>e.unref(k).Field=T)},null,8,["disabled","options","modelValue"])]),e.unref(o).Field?(e.openBlock(),e.createElementBlock("div",Bn,e.toDisplayString(e.unref(o).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[22]||(p[22]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(k).OrgName,"onUpdate:modelValue":p[3]||(p[3]=T=>e.unref(k).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[23]||(p[23]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",_n,[e.createElementVNode("div",null,[e.createVNode(C,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(k).OrgCategory,"onUpdate:modelValue":p[4]||(p[4]=T=>e.unref(k).OrgCategory=T)},null,8,["error","options","modelValue"])]),e.unref(k).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Cn,[e.createVNode(S,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(k).RegisteredNum,"onUpdate:modelValue":p[5]||(p[5]=T=>e.unref(k).RegisteredNum=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[24]||(p[24]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(k).TaxID,"onUpdate:modelValue":p[6]||(p[6]=T=>e.unref(k).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[25]||(p[25]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(k).Address,"onUpdate:modelValue":p[7]||(p[7]=T=>e.unref(k).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),p[46]||(p[46]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Tn,[e.createElementVNode("table",wn,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Sn,[e.createElementVNode("div",Dn,[e.createElementVNode("div",An,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[26]||(p[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":U=>T.Name=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fn,[e.createElementVNode("div",Un,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[27]||(p[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${D}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":U=>T.JobTitle=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Pn,[p[28]||(p[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Mn,[e.createElementVNode("div",In,[e.createVNode(S,{modelValue:T.Phone,"onUpdate:modelValue":U=>T.Phone=U,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",jn,[e.createVNode(S,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":U=>T.PhoneExt=U,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",On,[e.createElementVNode("div",Ln,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[29]||(p[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${D}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":U=>T.MobilePhone=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Rn,[e.createElementVNode("div",qn,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[30]||(p[30]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${D}-EMail`],modelValue:T.EMail,"onUpdate:modelValue":U=>T.EMail=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),p[47]||(p[47]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",zn,[e.createElementVNode("table",Gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[31]||(p[31]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[p[32]||(p[32]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(w,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(k).Target,"onUpdate:modelValue":p[8]||(p[8]=T=>e.unref(k).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[33]||(p[33]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(k).Summary,"onUpdate:modelValue":p[9]||(p[9]=T=>e.unref(k).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[34]||(p[34]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(k).Quantified,"onUpdate:modelValue":p[10]||(p[10]=T=>e.unref(k).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[35]||(p[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(k).Qualitative,"onUpdate:modelValue":p[11]||(p[11]=T=>e.unref(k).Qualitative=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Jn,[e.createElementVNode("table",Yn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[41]||(p[41]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(P,{modelValue:e.unref(c),"onUpdate:modelValue":p[12]||(p[12]=T=>e.isRef(c)?c.value=T:null)},null,8,["modelValue"]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Qn,[e.createElementVNode("table",Hn,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[p[36]||(p[36]=e.createElementVNode("th",null,"計畫名稱",-1)),p[37]||(p[37]=e.createElementVNode("th",null,"補助單位",-1)),p[38]||(p[38]=e.createElementVNode("th",{class:"text-end"},"補助金額(元)",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",Wn,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":U=>T.Name=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${D}-Unit`],modelValue:T.Unit,"onUpdate:modelValue":U=>T.Unit=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(o)[`received-${D}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":U=>T.Amount=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",Kn,[e.createElementVNode("div",Xn,[e.unref(b).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>s(T),type:"button"},[...p[39]||(p[39]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Zn)):e.createCommentVNode("",!0),D+1===e.unref(b).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:a,type:"button"},[...p[40]||(p[40]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[p[44]||(p[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",vn,[e.createElementVNode("table",er,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[42]||(p[42]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":p[13]||(p[13]=T=>e.unref(m).Form1Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...p[43]||(p[43]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":p[14]||(p[14]=T=>e.unref(m).Form1After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",tr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:p[15]||(p[15]=T=>f()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:p[16]||(p[16]=T=>f(!0)),type:"button"},[...p[48]||(p[48]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},or={class:"block"},nr={key:0,class:"text-pink lh-base mt-4"},rr={class:"mt-4"},ar={class:"table align-middle gray-table"},sr={class:"text-center"},dr={key:0,width:"180"},cr={class:"text-center"},ir={key:0},mr=["innerHTML"],pr=["href"],Vr={key:0,class:"text-center"},fr={key:0},Nr={key:1,class:"text-pink"},Er={key:1,class:"tag-group mt-2 gap-1"},br={key:0,class:"tag tag-green-light"},gr=["download","href"],yr=["onClick"],kr={key:1,class:"text-center mt-4"},ur={class:"mt-4"},hr={class:"table align-middle gray-table side-table"},xr={key:0,class:"block-bottom bg-light-teal"},$r=["disabled"],Br={__name:"Attachment",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([{Type:1,Title:"申請表",Template:`../../Service/OFS/DownloadTemplateCUL.ashx?type=1&id=${g.id}`,Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:`../../Service/OFS/DownloadTemplateCUL.ashx?type=2&id=${g.id}`,Files:[]},{Type:3,Title:"執行承諾書",Template:`../../Service/OFS/DownloadTemplateCUL.ashx?type=3&id=${g.id}`,Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:`../../Service/OFS/DownloadTemplateCUL.ashx?type=4&id=${g.id}`,Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),m=e.ref(),N=e.computed(()=>i.value.some(c=>!c.Optional&&!c.Files.filter(a=>!a.Deleted).length)),n=e.computed(()=>z("culture",l.value.Status,5)),o=e.ref({}),l=e.ref({}),d=(c,a)=>{a.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:a.Path,Name:l.value.ProjectID+"_"+(c.Multiple?a.Name:`${c.Title}.pdf`)})},b=A.download,k=x,_=()=>{rxjs.forkJoin([A.culture("getAttachment",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=i.value.filter(u=>{var E;return!((E=u.Excludes)!=null&&E.includes(l.value.OrgCategory))}),l.value.Status>=42&&i.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/CUL/5.海洋委員會補助計畫著作權授權同意書.docx",Files:[]}),i.value.forEach(u=>{u.Files=a.Attachments.filter(E=>E.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(E=>!E.Deleted).length)}),j().init("culture",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},h=c=>{var u,E;if(o.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={ID:g.id,Attachments:i.value.reduce((s,f)=>s.concat(f.Files),[]),Before:(u=m.value)==null?void 0:u.Form5Before,After:(E=m.value)==null?void 0:E.Form5After,Submit:c?"true":"false"};A.culture("saveAttachment",a).subscribe(()=>{c?k("next"):_()})},V=()=>{if(m.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,M(m.value,c))}return!Object.keys(o.value).length};return e.onMounted(_),e.provide("editable",n),(c,a)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file"),s=e.resolveComponent("tw-date-time"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",or,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("p",nr,[...a[4]||(a[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",rr,[e.createElementVNode("table",ar,[e.createElementVNode("thead",sr,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",dr,"狀態")):e.createCommentVNode("",!0),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(r,t)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",cr,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[r.Optional?(e.openBlock(),e.createElementBlock("span",ir,e.toDisplayString(r.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.Title),1)]),_:2},1024))]),e.unref(n)&&r.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:r.Comment},null,8,mr)):e.createCommentVNode("",!0),e.unref(n)&&r.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",download:"",href:r.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,pr)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",Vr,[r.Uploaded?(e.openBlock(),e.createElementBlock("span",fr,"已上傳")):(e.openBlock(),e.createElementBlock("span",Nr,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&(r.Multiple||!r.Uploaded)?(e.openBlock(),e.createBlock(E,{key:0,accept:".pdf",onFile:p=>d(r,p)},null,8,["onFile"])):e.createCommentVNode("",!0),r.Uploaded?(e.openBlock(),e.createElementBlock("div",Er,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.Files,p=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:p},[p.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",br,[e.createElementVNode("a",{class:"tag-link my-1",download:p.Name,href:e.unref(b)(p.Path)},e.toDisplayString(p.Name),9,gr),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>p.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,yr)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(l).ApplyTime?(e.openBlock(),e.createElementBlock("div",kr,[a[10]||(a[10]=e.createTextVNode("申請送件時間：",-1)),e.createVNode(s,{value:e.unref(l).ApplyTime},null,8,["value"])])):e.createCommentVNode("",!0),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ur,[e.createElementVNode("table",hr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(m).Form5Before=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(m).Form5After=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",xr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[2]||(a[2]=r=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[3]||(a[3]=r=>h(!0)),disabled:e.unref(N),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,$r)])):e.createCommentVNode("",!0)],64)}}},_r={class:"block"},Cr={class:"mt-4"},Tr={class:"table-responsive mt-3 mb-0"},wr={class:"table align-middle gray-table"},Sr={class:"text-end"},Dr={class:"text-end"},Ar={class:"table-responsive"},Fr={class:"table align-middle gray-table"},Ur=["colspan"],Pr={key:0,width:"1"},Mr={key:0},Ir={class:"d-flex gap-2"},jr=["onClick"],Or={class:"mt-4"},Lr={class:"table-responsive mt-3 mb-0"},Rr={class:"table align-middle gray-table"},qr={key:0,width:"1"},zr={class:"text-end"},Gr={key:0},Jr={class:"d-flex gap-2"},Yr=["onClick"],Qr={class:"mt-4"},Hr={class:"table align-middle gray-table side-table"},Wr={key:0,class:"block-bottom bg-light-teal"},Kr={class:"text-center"},Xr={class:"mb-5"},Zr={__name:"Funding",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.computed(()=>z("culture",l.value.Status,3)),N=e.ref({}),n=e.computed(()=>k.value.filter(p=>!p.Deleted)),o=e.computed(()=>_.value.filter(p=>!p.Deleted)),l=e.ref({}),d=e.ref([]),b=e.ref(),k=e.ref([]),_=e.ref([]),h=e.ref({}),V=e.ref(0),c=()=>k.value.push({}),a=()=>_.value.push({ItemID:0}),u=x,E=()=>{rxjs.forkJoin([A.culture("getFunding",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(p=>{const y=p[0];l.value=y.Project,k.value=y.OtherSubsidies,_.value=y.BudgetPlans,d.value=y.Items,h.value=y.GrantTargetSetting,_.value.length||a(),j().init("culture",l.value),i.value=l.value.changeApply,l.value.changeApply=void 0})},s=p=>p.Deleted=!0,f=p=>p.Deleted=!0,r=(p,y)=>{var C,w;if(N.value={},p&&!t()){e.nextTick(()=>{var P;return(P=document.querySelector(".invalid"))==null?void 0:P.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!y&&l.value.ApplyAmount>h.value.GrantLimit*1e4){b.value.show(()=>r(p,!0));return}const S={Project:l.value,OtherSubsidies:k.value,BudgetPlans:_.value,Before:(C=i.value)==null?void 0:C.Form3Before,After:(w=i.value)==null?void 0:w.Form3After,Submit:p?"true":"false"};A.culture("saveFunding",S).subscribe(()=>{p?u("next"):E()})},t=()=>{let p={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=M(l.value,p),p={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},n.value.forEach((y,S)=>Object.assign(N.value,M(y,p,`other-${S}-`))),p={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},o.value.forEach((y,S)=>Object.assign(N.value,M(y,p,`plan-${S}-`))),i.value&&(p={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,M(i.value,p))),!Object.keys(N.value).length};return e.onMounted(E),e.provide("editable",m),e.watchEffect(()=>{l.value.OtherAmount=k.value.reduce((p,y)=>p+(y.Deleted?0:q(y.Amount)),0),V.value=q(l.value.ApplyAmount)+q(l.value.SelfAmount)+q(l.value.OtherAmount),_.value.forEach(p=>p.sum=q(p.Amount)+q(p.OtherAmount))}),(p,y)=>{var D;const S=e.resolveComponent("input-integer"),C=e.resolveComponent("input-text"),w=e.resolveComponent("input-select"),P=e.resolveComponent("input-textarea"),F=e.resolveComponent("required-label"),T=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",_r,[y[25]||(y[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Cr,[e.createElementVNode("div",Tr,[e.createElementVNode("table",wr,[y[6]||(y[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額(元) (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款(元) (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額(元) (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費(元) (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":y[0]||(y[0]=U=>e.unref(l).ApplyAmount=U)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":y[1]||(y[1]=U=>e.unref(l).SelfAmount=U)},null,8,["error","modelValue"])]),e.createElementVNode("td",Sr,e.toDisplayString((D=e.unref(l).OtherAmount)==null?void 0:D.toLocaleString()),1),e.createElementVNode("td",Dr,e.toDisplayString(e.unref(V).toLocaleString()),1)])])])]),y[12]||(y[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Ar,[e.createElementVNode("table",Fr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Ur)]),e.createElementVNode("tr",null,[y[7]||(y[7]=e.createElementVNode("th",{width:"1"},null,-1)),y[8]||(y[8]=e.createElementVNode("th",null,"單位名稱",-1)),y[9]||(y[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額(元)（含尚未核定者）",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Pr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(U,I)=>(e.openBlock(),e.createElementBlock("tr",{key:U},[e.createElementVNode("td",null,e.toDisplayString(I+1),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(N)[`other-${I}-Unit`],modelValue:U.Unit,"onUpdate:modelValue":O=>U.Unit=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`other-${I}-Amount`],modelValue:U.Amount,"onUpdate:modelValue":O=>U.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Mr,[e.createElementVNode("div",Ir,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:O=>s(U),type:"button"},[...y[10]||(y[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jr)])])):e.createCommentVNode("",!0)]))),128))])]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...y[11]||(y[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增",-1)])])):e.createCommentVNode("",!0)])]),y[26]||(y[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Or,[e.createElementVNode("div",Lr,[e.createElementVNode("table",Rr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[y[13]||(y[13]=e.createElementVNode("th",null,"重要工作項目",-1)),y[14]||(y[14]=e.createElementVNode("th",null,"預算項目",-1)),y[15]||(y[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),y[16]||(y[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),y[17]||(y[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("小計")],-1)),y[18]||(y[18]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",qr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(U,I)=>(e.openBlock(),e.createElementBlock("tr",{key:U},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(N)[`plan-${I}-ItemID`],options:e.unref(d),"text-name":"Title","value-name":"ID",modelValue:U.ItemID,"onUpdate:modelValue":O=>U.ItemID=O},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(N)[`plan-${I}-Title`],modelValue:U.Title,"onUpdate:modelValue":O=>U.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`plan-${I}-Amount`],modelValue:U.Amount,"onUpdate:modelValue":O=>U.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`plan-${I}-OtherAmount`],modelValue:U.OtherAmount,"onUpdate:modelValue":O=>U.OtherAmount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",zr,e.toDisplayString(U.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(N)[`plan-${I}-Description`],rows:"1",modelValue:U.Description,"onUpdate:modelValue":O=>U.Description=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Gr,[e.createElementVNode("div",Jr,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:O=>f(U),type:"button"},[...y[19]||(y[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Yr)):e.createCommentVNode("",!0),I+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:a,type:"button"},[...y[20]||(y[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),y[21]||(y[21]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))]),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[y[24]||(y[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Qr,[e.createElementVNode("table",Hr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...y[22]||(y[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(i).Form3Before,"onUpdate:modelValue":y[2]||(y[2]=U=>e.unref(i).Form3Before=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...y[23]||(y[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(i).Form3After,"onUpdate:modelValue":y[3]||(y[3]=U=>e.unref(i).Form3After=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Wr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:y[4]||(y[4]=U=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:y[5]||(y[5]=U=>r(!0)),type:"button"},[...y[27]||(y[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(T,{ref_key:"modal",ref:b},{default:e.withCtx(()=>[e.createElementVNode("div",Kr,[y[28]||(y[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Xr,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(h).GrantLimit)+"萬",1),y[29]||(y[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),y[30]||(y[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},vr={class:"block"},ea={key:0,class:"text-pink lh-base mt-3"},ta={class:"border"},la={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},oa={class:"d-flex gap-2 align-items-center flex-grow-1"},na={class:"text-nowrap"},ra={class:"flex-grow-1"},aa={class:"d-flex gap-2"},sa=["onClick"],da=["href"],ca=["id"],ia={class:"table align-middle gray-table side-table mb-0"},ma={class:"mt-4"},pa={class:"table align-middle gray-table side-table"},Va={key:0,class:"block-bottom bg-light-teal"},fa={__name:"Other",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.computed(()=>z("culture",n.value.Status,4)),N=e.ref({}),n=e.ref({}),o=e.ref([]),l=e.computed(()=>o.value.filter(c=>!c.Deleted)),d=()=>o.value.push({}),b=x,k=()=>{rxjs.forkJoin([A.culture("getRelatedProject",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];n.value=a.Project,o.value=a.Projects,j().init("culture",n.value),i.value=n.value.changeApply,n.value.changeApply=void 0})},_=c=>c.Deleted=!0,h=c=>{var u,E;if(N.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={ID:g.id,Projects:o.value,Before:(u=i.value)==null?void 0:u.Form4Before,After:(E=i.value)==null?void 0:E.Form4After,Submit:c?"true":"false"};A.culture("saveRelatedProject",a).subscribe(()=>{c?b("next"):k()})},V=()=>{let c={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return l.value.forEach((a,u)=>Object.assign(N.value,M(a,c,`project-${u}-`))),i.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(N.value,M(i.value,c))),!Object.keys(N.value).length};return e.onMounted(k),e.provide("editable",m),(c,a)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-text"),s=e.resolveComponent("input-integer"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",vr,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",ea," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(r,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:r},[e.createElementVNode("div",ta,[e.createElementVNode("div",la,[e.createElementVNode("div",oa,[e.createElementVNode("label",na,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[4]||(a[4]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",ra,[e.createVNode(E,{error:e.unref(N)[`project-${t}-Title`],modelValue:r.Title,"onUpdate:modelValue":p=>r.Title=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",aa,[e.unref(m)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(p=>_(r),["prevent"]),href:"#"},"刪除",8,sa)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,da)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",ia,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[5]||(a[5]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{class:"text-start w-auto",error:e.unref(N)[`project-${t}-Year`],modelValue:r.Year,"onUpdate:modelValue":p=>r.Year=p},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[6]||(a[6]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(N)[`project-${t}-OrgName`],modelValue:r.OrgName,"onUpdate:modelValue":p=>r.OrgName=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[7]||(a[7]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{class:"w-auto",error:e.unref(N)[`project-${t}-Amount`],modelValue:r.Amount,"onUpdate:modelValue":p=>r.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[8]||(a[8]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`project-${t}-Description`],rows:"4",modelValue:r.Description,"onUpdate:modelValue":p=>r.Description=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[9]||(a[9]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`project-${t}-Benefit`],rows:"4",modelValue:r.Benefit,"onUpdate:modelValue":p=>r.Benefit=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,ca)])]))),128)),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:d,type:"button"},[...a[10]||(a[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ma,[e.createElementVNode("table",pa,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).Form4Before,rows:"4",modelValue:e.unref(i).Form4Before,"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(i).Form4Before=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).Form4After,rows:"4",modelValue:e.unref(i).Form4After,"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(i).Form4After=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Va,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[2]||(a[2]=r=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[3]||(a[3]=r=>h(!0)),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Na={class:"block"},Ea={class:"square-title"},ba={class:"text-teal fw-bold py-3"},ga={class:"table-responsive mb-0"},ya={class:"table align-middle gray-table"},ka={class:"text-end"},ua={class:"text-end"},ha={class:"text-end"},xa={class:"text-teal fw-bold pb-3"},$a={class:"text-teal fw-bold pb-3"},Ba={class:"mt-4"},_a={class:"table align-middle gray-table"},Ca={class:"text-center"},Ta={key:0,width:"180"},wa={class:"text-center"},Sa=["href"],Da={key:0,class:"text-center"},Aa={key:0},Fa={key:1,class:"text-pink"},Ua={key:1,class:"tag-group mt-2 gap-1"},Pa={key:0,class:"tag tag-green-light"},Ma=["download","href"],Ia=["onClick"],ja={class:"block-bottom bg-light-teal"},Oa=["disabled"],La={__name:"Payment1",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>i.value<=0||_.value.some(E=>!E.Files.filter(s=>!s.Deleted).length)),N=e.computed(()=>!l.value||l.value.Status==="請款中"),n=e.computed(()=>{var E;return((E=l.value)==null?void 0:E.Status)==="通過"}),o=e.ref(0),l=e.ref(),d=e.ref({}),b=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(i.value*100/d.value.ApprovedAmount*100)/100,100):0),k=e.computed(()=>n.value?Math.round(i.value*100/l.value.CurrentActualPaidAmount*100)/100+"%":"--"),_=e.ref([{Type:11,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:12,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),h=(E,s)=>{s.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:s.Path,Name:`${d.value.ProjectID}_第一期請款_${E.Title}.pdf`})},V=A.download,c=x,a=()=>{A.culture("getPayment",{ID:g.id}).subscribe(E=>{d.value=E.Project,j().init("culture",d.value),_.value=_.value.filter(s=>{var f;return!((f=s.Excludes)!=null&&f.includes(d.value.OrgCategory))}),_.value.forEach(s=>{s.Files=E.Attachments.filter(f=>f.Type===s.Type),s.Uploaded=e.computed(()=>s.Files.filter(f=>!f.Deleted).length)}),l.value=E.Payments.find(s=>s.Stage===1),l.value&&(i.value=l.value.TotalSpentAmount),o.value=Math.round(d.value.ApprovedAmount*g.setting.DisbursementRatioPct/100),Y().init(l.value)})},u=E=>{const s={Payment:{ProjectID:g.id,Stage:1,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:_.value.reduce((f,r)=>f.concat(r.Files),[]),Submit:E?"true":"false"};A.culture("savePayment",s).subscribe(()=>{E?c("next"):a()})};return e.onMounted(a),e.provide("editable",N),(E,s)=>{var p;const f=e.resolveComponent("input-integer"),r=e.resolveComponent("required-label"),t=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Na,[e.createElementVNode("h5",Ea,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",ba,"核定經費: "+e.toDisplayString((p=e.unref(d).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("div",ga,[e.createElementVNode("table",ya,[s[4]||(s[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",ka,e.toDisplayString(e.unref(i)),1),s[3]||(s[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(f,{max:e.unref(o),modelValue:e.unref(i),"onUpdate:modelValue":s[0]||(s[0]=y=>e.isRef(i)?i.value=y:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",ua,e.toDisplayString(e.unref(b))+"%",1),e.createElementVNode("td",ha,e.toDisplayString(e.unref(k)),1)])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",xa,"本期實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",$a,"累積實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),s[10]||(s[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),s[11]||(s[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Ba,[e.createElementVNode("table",_a,[e.createElementVNode("thead",Ca,[e.createElementVNode("tr",null,[s[5]||(s[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[6]||(s[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Ta,"狀態")):e.createCommentVNode("",!0),s[7]||(s[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),(y,S)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",wa,e.toDisplayString(S+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Title),1)]),_:2},1024)]),e.unref(N)&&y.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:y.Template,style:{width:"140px"},type:"button"},[...s[8]||(s[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Sa)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Da,[y.Uploaded?(e.openBlock(),e.createElementBlock("span",Aa,"已上傳")):(e.openBlock(),e.createElementBlock("span",Fa,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!y.Uploaded?(e.openBlock(),e.createBlock(t,{key:0,accept:".pdf",onFile:C=>h(y,C)},null,8,["onFile"])):e.createCommentVNode("",!0),y.Uploaded?(e.openBlock(),e.createElementBlock("div",Ua,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.Files,C=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:C},[C.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Pa,[e.createElementVNode("a",{class:"tag-link my-1",download:C.Name,href:e.unref(V)(C.Path)},e.toDisplayString(C.Name),9,Ma),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:w=>C.Deleted=!0,type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ia)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",ja,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[1]||(s[1]=y=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[2]||(s[2]=y=>u(!0)),disabled:e.unref(m),type:"button"},[...s[12]||(s[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Oa)])],64)}}},Ra={class:"block"},qa={class:"square-title"},za={class:"text-teal fw-bold py-3"},Ga={class:"text-teal fw-bold pb-3"},Ja={class:"table-responsive mb-0"},Ya={class:"table align-middle gray-table"},Qa={class:"text-end"},Ha={class:"text-end"},Wa={class:"text-end"},Ka={class:"text-end"},Xa={class:"text-teal fw-bold pb-3"},Za={class:"text-teal fw-bold pb-3"},va={class:"mt-4"},es={class:"table align-middle gray-table"},ts={class:"text-center"},ls={key:0,width:"180"},os={class:"text-center"},ns=["href"],rs={key:0,class:"text-center"},as={key:0},ss={key:1,class:"text-pink"},ds={key:1,class:"tag-group mt-2 gap-1"},cs={key:0,class:"tag tag-green-light"},is=["download","href"],ms=["onClick"],ps={class:"block-bottom bg-light-teal"},Vs=["disabled"],fs={__name:"Payment2",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>i.value<=0||c.value.some(r=>!r.Files.filter(t=>!t.Deleted).length)),N=e.computed(()=>!l.value||l.value.Status==="請款中"),n=e.computed(()=>{var r;return((r=l.value)==null?void 0:r.Status)==="通過"}),o=e.ref(0),l=e.ref(),d=e.ref(0),b=e.ref(0),k=e.ref({}),_=e.computed(()=>k.value.ApprovedAmount?Math.min(Math.round(i.value*100/k.value.ApprovedAmount*100)/100,100):0),h=e.computed(()=>V.value?Math.round(i.value*100/V.value*100)/100:0),V=e.computed(()=>b.value+(n.value?l.value.CurrentActualPaidAmount:0)),c=e.ref([{Type:21,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:22,Title:"經費分攤表",Template:"../../Template/CUL/經費分攤表.docx",Files:[]},{Type:23,Title:"補助清單",Template:"../../Template/CUL/補助清單.docx",Files:[],Excludes:["1"]},{Type:24,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=(r,t)=>{t.Type==="application/pdf"&&r.Files.push({Type:r.Type,Path:t.Path,Name:`${k.value.ProjectID}_第二期請款_${r.Title}.pdf`})},u=A.download,E=x,s=()=>{A.culture("getPayment",{ID:g.id}).subscribe(r=>{k.value=r.Project,j().init("culture",k.value),c.value=c.value.filter(p=>{var y;return!((y=p.Excludes)!=null&&y.includes(k.value.OrgCategory))}),c.value.forEach(p=>{p.Files=r.Attachments.filter(y=>y.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(y=>!y.Deleted).length)}),l.value=r.Payments.find(p=>p.Stage===2),l.value&&(i.value=l.value.TotalSpentAmount),o.value=k.value.ApprovedAmount;const t=r.Payments.filter(p=>p.Stage<2&&p.Status==="通過");d.value=t.reduce((p,y)=>p+y.CurrentRequestAmount,0),b.value=t.reduce((p,y)=>p+y.CurrentActualPaidAmount,0),Y().init(l.value,b.value)})},f=r=>{const t={Payment:{ProjectID:g.id,Stage:2,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:c.value.reduce((p,y)=>p.concat(y.Files),[]),Submit:r?"true":"false"};A.culture("savePayment",t).subscribe(()=>{r?E("next"):s()})};return e.onMounted(s),e.provide("editable",N),(r,t)=>{var C;const p=e.resolveComponent("input-integer"),y=e.resolveComponent("required-label"),S=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ra,[e.createElementVNode("h5",qa,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",za,"核定經費: "+e.toDisplayString((C=e.unref(k).ApprovedAmount)==null?void 0:C.toLocaleString())+"元",1),e.createElementVNode("p",Ga,"賸餘款: "+e.toDisplayString((e.unref(k).ApprovedAmount-e.unref(i)).toLocaleString())+"元",1),e.createElementVNode("div",Ja,[e.createElementVNode("table",Ya,[t[3]||(t[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Qa,e.toDisplayString(e.unref(i)-e.unref(d)),1),e.createElementVNode("td",Ha,e.toDisplayString(e.unref(b)),1),e.createElementVNode("td",null,[e.createVNode(p,{max:e.unref(o),modelValue:e.unref(i),"onUpdate:modelValue":t[0]||(t[0]=w=>e.isRef(i)?i.value=w:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",Wa,e.toDisplayString(e.unref(_))+"%",1),e.createElementVNode("td",Ka,e.toDisplayString(e.unref(h))+"%",1)])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",Xa,"本期實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",Za,"累積實際撥款: "+e.toDisplayString(e.unref(V).toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),t[9]||(t[9]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),t[10]||(t[10]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",va,[e.createElementVNode("table",es,[e.createElementVNode("thead",ts,[e.createElementVNode("tr",null,[t[4]||(t[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),t[5]||(t[5]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",ls,"狀態")):e.createCommentVNode("",!0),t[6]||(t[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(w,P)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",os,e.toDisplayString(P+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(y,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Title),1)]),_:2},1024)]),e.unref(N)&&w.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:w.Template,style:{width:"140px"},type:"button"},[...t[7]||(t[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,ns)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",rs,[w.Uploaded?(e.openBlock(),e.createElementBlock("span",as,"已上傳")):(e.openBlock(),e.createElementBlock("span",ss,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!w.Uploaded?(e.openBlock(),e.createBlock(S,{key:0,accept:".pdf",onFile:F=>a(w,F)},null,8,["onFile"])):e.createCommentVNode("",!0),w.Uploaded?(e.openBlock(),e.createElementBlock("div",ds,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.Files,F=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:F},[F.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",cs,[e.createElementVNode("a",{class:"tag-link my-1",download:F.Name,href:e.unref(u)(F.Path)},e.toDisplayString(F.Name),9,is),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:T=>F.Deleted=!0,type:"button"},[...t[8]||(t[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ms)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",ps,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[1]||(t[1]=w=>f()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[2]||(t[2]=w=>f(!0)),disabled:e.unref(m),type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Vs)])],64)}}},Ns={class:"block rounded-top-4"},Es={class:"horizontal-scrollable"},bs={class:"timeline"},gs={class:"year"},ys={class:"month"},ks=["onClick"],us={class:"square-title"},hs={class:"table-responsive mt-4"},xs={class:"table align-middle gray-table"},$s={class:"text-end"},Bs={class:"table-responsive"},_s={class:"table align-middle gray-table"},Cs={class:"text-end"},Ts={key:0,class:"invalid mt-0"},ws={class:"mt-3"},Ss={class:"mt-3"},Ds=["rowspan"],As={key:0,class:"block-bottom bg-light-teal"},Fs={__name:"Progress",props:{id:{type:[Number,String]}},setup(B){const x=[{value:3,text:"完成"},{value:2,text:"部分完成"},{value:1,text:"未完成"}],g=B,i=e.ref(),m=e.ref({}),N=e.ref(0),n=e.ref({}),o=e.ref([]),l=e.ref({}),d=e.computed(()=>Math.round((N.value+o.value.filter(a=>a.Status===3).length)*100/b.value.length*10)/10),b=e.ref([]),k=e.ref([]),_=a=>{i.value=a,h()},h=()=>{A.culture("getMonthlyProgress",{ID:g.id,Year:i.value.year-1911,Month:i.value.month}).subscribe(a=>{const u=a.Logs,E=a.Items,s=a.Steps;let f=!1;N.value=0,l.value=a.Progress,b.value=a.Schedules,o.value=[],k.value.forEach(r=>{r.months.forEach(t=>{f||(t===i.value&&(f=!0),b.value.forEach(p=>{var y,S;if(p.Month===t.month)if(f||p.Status!==3){const C=u.find(w=>w.ScheduleID===p.ID)||{ScheduleID:p.ID,Status:p.Status};o.value.push(Object.assign(C,{Year:r.year,Month:p.Month,ItemTitle:(y=E.find(w=>w.ID===p.ItemID))==null?void 0:y.Title,Type:p.Type,StepTitle:(S=s.find(w=>w.ID===p.StepID))==null?void 0:S.Title}))}else N.value++}))})})})},V=a=>{if(m.value={},a&&!c()){e.nextTick(()=>{var E;return(E=document.querySelector(".invalid"))==null?void 0:E.scrollIntoView({behavior:"smooth",block:"center"})});return}const u={ID:l.value.ID,Description:l.value.Description||"",Status:a?1:0,Logs:o.value.map(E=>({ID:E.ID||0,ScheduleID:E.ScheduleID,Status:E.Status,DelayReason:E.DelayReason||"",ImprovedWay:E.ImprovedWay||""}))};A.culture("saveMonthlyProgress",u).subscribe(E=>{E&&(window.location.href="../inprogressList.aspx")})},c=()=>{let a={Description:"實際工作執行情形"};return m.value=M(l.value,a),o.value.forEach((u,E)=>{a={Status:{numericality:{greaterThan:0,message:"^請輸入本月是否完成"}}},[1,2].includes(u.Status)&&(a.DelayReason="落後原因",a.ImprovedWay="改善措施"),Object.assign(m.value,M(u,a,`item-${E}-`))}),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.culture("getApplication",{ID:g.id}),A.culture("getSubmitedMonthlyProgress",{ID:g.id})]).subscribe(a=>{n.value=a[0].Project,j().init("culture",n.value);const u=new Date(n.value.StartTime),E=new Date(n.value.EndTime),s=Date.now();for(;;){const t=u.getFullYear(),p=u.getMonth(),y={year:t,month:p+1,disabled:new Date(t,p,20).getTime()>s};let S=k.value.find(C=>C.year===t);if(S?S.months.push(y):k.value.push({year:t,months:[y]}),t*100+p>=E.getFullYear()*100+E.getMonth())break;u.setMonth(p+1)}let f=!1;const r=a[1].List;k.value.forEach(t=>{t.months.forEach(p=>{!f&&!r.some(y=>y.Year===p.year-1911&&y.Month===p.month)&&(f=!0,_(p))})}),f||_(k.value[0].months[0])})}),(a,u)=>{const E=e.resolveComponent("input-textarea"),s=e.resolveComponent("input-radio-group");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ns,[e.createElementVNode("div",Es,[u[3]||(u[3]=e.createElementVNode("button",{class:"btn-control btn-prev",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-left"})],-1)),e.createElementVNode("ul",bs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(k),f=>(e.openBlock(),e.createElementBlock("li",{key:f},[e.createElementVNode("span",gs,e.toDisplayString(f.year-1911)+"年",1),e.createElementVNode("ul",ys,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.months,r=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass({active:e.unref(i)===r,disabled:r.disabled}),key:r},[e.createElementVNode("a",{onClick:t=>_(r),href:"javascript:void(0)"},e.toDisplayString(r.month)+"月",9,ks)],2))),128))])]))),128))]),u[4]||(u[4]=e.createElementVNode("button",{class:"btn-control btn-next",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-right"})],-1))]),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h5",us,e.toDisplayString(e.unref(i).year-1911)+"年"+e.toDisplayString(e.unref(i).month)+"月 實際進度",1),e.createElementVNode("div",hs,[e.createElementVNode("table",xs,[u[5]||(u[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",{class:"text-center"},"實際工作執行情形（條列式說明）")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",$s,e.toDisplayString(e.unref(i).year-1911)+"年"+e.toDisplayString(e.unref(i).month)+"月",1),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(m).Description,rows:"4",modelValue:e.unref(l).Description,"onUpdate:modelValue":u[0]||(u[0]=f=>e.unref(l).Description=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Bs,[e.createElementVNode("table",_s,[u[8]||(u[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",null,"重要工作項目"),e.createElementVNode("th",null,"工作進度%"),e.createElementVNode("th",null,"檢核工作"),e.createElementVNode("th",null,"本月是否完成"),e.createElementVNode("th",null,"年度目標達成數")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(f,r)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("th",Cs,e.toDisplayString(f.Year-1911)+"年"+e.toDisplayString(f.Month)+"月",1),e.createElementVNode("td",null,e.toDisplayString(f.ItemTitle),1),e.createElementVNode("td",null,e.toDisplayString(f.Type===1?"50%":"100%"),1),e.createElementVNode("td",null,e.toDisplayString(f.StepTitle),1),e.createElementVNode("td",null,[e.createVNode(s,{options:x,modelValue:f.Status,"onUpdate:modelValue":t=>f.Status=t},null,8,["modelValue","onUpdate:modelValue"]),e.unref(m)[`item-${r}-Status`]?(e.openBlock(),e.createElementBlock("div",Ts,e.toDisplayString(e.unref(m)[`item-${r}-Status`]),1)):e.createCommentVNode("",!0),[1,2].includes(f.Status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",ws,[u[6]||(u[6]=e.createElementVNode("div",{class:"text-teal pb-2"},"落後原因",-1)),e.createVNode(E,{error:e.unref(m)[`item-${r}-DelayReason`],rows:"1",modelValue:f.DelayReason,"onUpdate:modelValue":t=>f.DelayReason=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ss,[u[7]||(u[7]=e.createElementVNode("div",{class:"text-teal pb-2"},"改善措施",-1)),e.createVNode(E,{error:e.unref(m)[`item-${r}-ImprovedWay`],rows:"1",modelValue:f.ImprovedWay,"onUpdate:modelValue":t=>f.ImprovedWay=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])],64)):e.createCommentVNode("",!0)]),r?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("td",{key:0,class:"text-end",rowspan:e.unref(o).length},e.toDisplayString(e.unref(d))+"% ",9,Ds))]))),128))])])])],64)):e.createCommentVNode("",!0)]),e.unref(i)?(e.openBlock(),e.createElementBlock("div",As,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:u[1]||(u[1]=f=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:u[2]||(u[2]=f=>V(!0)),type:"button"},[...u[9]||(u[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])):e.createCommentVNode("",!0)],64)}}},Us={__name:"ProgressBar",setup(B){const x=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(g,i)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:x,type:"culture"})}}},oe=(B,x)=>{const g=B.__vccOpts||B;for(const[i,m]of x)g[i]=m;return g},Ps={class:"block"},Ms={class:"mt-4"},Is={class:"table align-middle gray-table side-table"},js={key:0,class:"d-flex align-items-center gap-2"},Os={class:"input-group w-auto"},Ls={class:"text-teal-dark"},Rs={key:1,class:"invalid mt-0"},qs={class:"square-title mt-4"},zs={class:"mt-4"},Gs=["onClick"],Js={class:"d-flex flex-column gap-2"},Ys={class:"mt-4 d-flex flex-column gap-2"},Qs={class:"d-flex flex-column gap-3 mt-4"},Hs={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Ws={class:"d-flex gap-2 align-items-center flex-grow-1"},Ks={class:"text-nowrap"},Xs={class:"flex-grow-1"},Zs={class:"d-flex gap-2"},vs=["onClick"],ed=["href"],td=["id"],ld={class:"table align-middle gray-table side-table mb-0"},od={class:"p-0"},nd={class:"item-list"},rd={class:"mt-2 align-self-start text-center"},ad={class:"input-group"},sd={key:0,class:"invalid mt-0"},dd={key:0,class:"d-flex gap-2 mt-1 align-self-start"},cd=["onClick"],id=["onClick"],md={class:"row"},pd={class:"col"},Vd=["value"],fd={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Nd=["onClick"],Ed=["onClick"],bd={class:"col"},gd=["value"],yd={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},kd=["onClick"],ud=["onClick"],hd=["onClick"],xd={class:"mt-4"},$d={class:"table align-middle gray-table side-table"},Bd={key:0,class:"block-bottom bg-light-teal"},_d=oe({__name:"WorkSchedule",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.computed(()=>z("culture",l.value.Status,2)),N=e.computed(()=>b.value.EndDate),n=e.ref({}),o=e.computed(()=>d.value.filter(p=>!p.Deleted)),l=e.ref({}),d=e.ref([]),b=e.ref({}),k=()=>{A.culture("createGoal",{ID:g.id}).subscribe(p=>{d.value.push(Object.assign(p,{Items:[]}));const y=d.value[d.value.length-1];_(y)})},_=p=>{A.culture("createGoalItem",{ID:g.id,GoalID:p.ID}).subscribe(y=>{p.Items.push(Object.assign(y,{Steps:[],Schedules:[]}));const S=p.Items[p.Items.length-1];V(S),V(S),V(S),h(S,1),h(S,2)})},h=(p,y)=>A.culture("createGoalSchedule",{ID:g.id,ItemID:p.ID,Type:y}).subscribe(S=>p.Schedules.push(S)),V=p=>A.culture("createGoalStep",{ID:g.id,ItemID:p.ID}).subscribe(y=>p.Steps.push(y)),c=x,a=()=>{rxjs.forkJoin([A.culture("getWorkSchedule",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(p=>{const y=p[0];l.value=y.Project,d.value=y.Goals,b.value=y.GrantType,d.value.length||k(),j().init("culture",l.value),i.value=l.value.changeApply,l.value.changeApply=void 0})},u=p=>p.Deleted=!0,E=p=>p.Deleted=!0,s=p=>p.Deleted=!0,f=p=>p.Deleted=!0,r=p=>{var S,C;if(n.value={},p&&!t()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}const y={Project:l.value,Goals:d.value,Before:(S=i.value)==null?void 0:S.Form2Before,After:(C=i.value)==null?void 0:C.Form2After,Submit:p?"true":"false"};A.culture("saveWorkSchedule",y).subscribe(()=>{p?c("next"):a()})},t=()=>{let p={StartTime:"計畫期程",EndTime:"計畫期程"};n.value=M(l.value,p);const y={Title:"計畫目標",Content:"預期效益"},S={Title:"重要工作項目",Indicator:"績效指標"},C={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},w={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return d.value.filter(P=>!P.Deleted).forEach((P,F)=>{Object.assign(n.value,M(P,y,`goal-${F}-`)),P.Items.filter(T=>!T.Deleted).forEach((T,D)=>{Object.assign(n.value,M(T,S,`item-${F}-${D}-`)),T.Steps.filter(U=>!U.Deleted).forEach((U,I)=>Object.assign(n.value,M(U,C,`step-${F}-${D}-${I}-`))),T.Schedules.filter(U=>U.Type===1&&!U.Deleted).forEach((U,I)=>Object.assign(n.value,M(U,w,`schedule-${F}-${D}-1-${I}-`))),T.Schedules.filter(U=>U.Type===2&&!U.Deleted).forEach((U,I)=>Object.assign(n.value,M(U,w,`schedule-${F}-${D}-2-${I}-`)))})}),i.value&&(p={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(n.value,M(i.value,p))),!Object.keys(n.value).length};return e.onMounted(a),e.provide("editable",m),(p,y)=>{const S=e.resolveComponent("required-label"),C=e.resolveComponent("input-tw-date"),w=e.resolveComponent("tw-date"),P=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),T=e.resolveComponent("input-month"),D=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ps,[y[30]||(y[30]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Ms,[e.createElementVNode("table",Is,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[6]||(y[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",js,[e.createElementVNode("div",Os,[e.createVNode(C,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(l).StartTime,"onUpdate:modelValue":y[0]||(y[0]=U=>e.unref(l).StartTime=U)},null,8,["max-date","modelValue"]),y[7]||(y[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(C,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(l).EndTime,"onUpdate:modelValue":y[1]||(y[1]=U=>e.unref(l).EndTime=U)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Ls,[y[8]||(y[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(w,{value:e.unref(N)},null,8,["value"]),y[9]||(y[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(n).StartTime||e.unref(n).EndTime?(e.openBlock(),e.createElementBlock("div",Rs,e.toDisplayString(e.unref(n).StartTime||e.unref(n).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",qs,[y[11]||(y[11]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:k,type:"button"},[...y[10]||(y[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",zs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(U,I)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:U},[e.unref(m)&&e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:O=>u(U),type:"button"},"刪除",8,Gs)):e.createCommentVNode("",!0),e.createElementVNode("div",Js,[y[12]||(y[12]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(P,{error:e.unref(n)[`goal-${I}-Title`],modelValue:U.Title,"onUpdate:modelValue":O=>U.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Ys,[y[13]||(y[13]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(F,{error:e.unref(n)[`goal-${I}-Content`],rows:"4",modelValue:U.Content,"onUpdate:modelValue":O=>U.Content=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Qs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(U.Items.filter(O=>!O.Deleted),(O,G)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:O},[e.createElementVNode("div",Hs,[e.createElementVNode("div",Ws,[e.createElementVNode("label",Ks,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[14]||(y[14]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",Xs,[e.createVNode(P,{error:e.unref(n)[`item-${I}-${G}-Title`],modelValue:O.Title,"onUpdate:modelValue":L=>O.Title=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Zs,[e.unref(m)&&U.Items.filter(L=>!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(L=>E(O),["prevent"]),href:"#"},"刪除",8,vs)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${G}`,role:"button"},"收合",8,ed)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${G}`},[e.createElementVNode("table",ld,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[15]||(y[15]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",od,[e.createElementVNode("ul",nd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Steps.filter(L=>!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(m)}]),key:L},[e.createElementVNode("div",rd,e.toDisplayString(String.fromCharCode(65+J)),1),e.createElementVNode("div",null,[e.createVNode(P,{error:e.unref(n)[`step-${I}-${G}-${J}-Title`],placeholder:"如:進行口訪紀錄",modelValue:L.Title,"onUpdate:modelValue":R=>L.Title=R,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",ad,[e.createVNode(T,{"empty-value":0,modelValue:L.Begin,"onUpdate:modelValue":R=>L.Begin=R},null,8,["modelValue","onUpdate:modelValue"]),y[16]||(y[16]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(T,{"empty-value":0,modelValue:L.End,"onUpdate:modelValue":R=>L.End=R},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(n)[`step-${I}-${G}-${J}-Begin`]||e.unref(n)[`step-${I}-${G}-${J}-End`]?(e.openBlock(),e.createElementBlock("div",sd,e.toDisplayString(e.unref(n)[`step-${I}-${G}-${J}-Begin`]||e.unref(n)[`step-${I}-${G}-${J}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",dd,[O.Steps.filter(R=>!R.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:R=>f(L),type:"button"},[...y[17]||(y[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,cd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:R=>V(O),type:"button"},[...y[18]||(y[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,id)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[19]||(y[19]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(n)[`item-${I}-${G}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:O.Indicator,"onUpdate:modelValue":L=>O.Indicator=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[20]||(y[20]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",md,[e.createElementVNode("div",pd,[y[23]||(y[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Schedules.filter(L=>L.Type===1&&!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:L},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?3:4}`])},[e.createVNode(T,{error:e.unref(n)[`schedule-${I}-${G}-1-${J}-Month`],"empty-value":0,modelValue:L.Month,"onUpdate:modelValue":R=>L.Month=R},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?7:8}`])},[e.createVNode(D,{"empty-value":0,error:e.unref(n)[`schedule-${I}-${G}-1-${J}-StepID`],options:O.Steps.filter(R=>!R.Deleted),modelValue:L.StepID,"onUpdate:modelValue":R=>L.StepID=R},{default:e.withCtx(({index:R,option:Z})=>[e.createElementVNode("option",{value:Z.ID},e.toDisplayString(String.fromCharCode(65+R))+"."+e.toDisplayString(Z.Title),9,Vd)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(m)?(e.openBlock(),e.createElementBlock("div",fd,[O.Schedules.filter(R=>R.Type===1&&!R.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:R=>s(L),type:"button"},[...y[21]||(y[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Nd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:R=>h(O,1),type:"button"},[...y[22]||(y[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Ed)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",bd,[y[26]||(y[26]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Schedules.filter(L=>L.Type===2&&!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:L},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?3:4}`])},[e.createVNode(T,{error:e.unref(n)[`schedule-${I}-${G}-2-${J}-Month`],"empty-value":0,modelValue:L.Month,"onUpdate:modelValue":R=>L.Month=R},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?7:8}`])},[e.createVNode(D,{"empty-value":0,error:e.unref(n)[`schedule-${I}-${G}-2-${J}-StepID`],options:O.Steps.filter(R=>!R.Deleted),modelValue:L.StepID,"onUpdate:modelValue":R=>L.StepID=R},{default:e.withCtx(({index:R,option:Z})=>[e.createElementVNode("option",{value:Z.ID},e.toDisplayString(String.fromCharCode(65+R))+"."+e.toDisplayString(Z.Title),9,gd)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(m)?(e.openBlock(),e.createElementBlock("div",yd,[O.Schedules.filter(R=>R.Type===2&&!R.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:R=>s(L),type:"button"},[...y[24]||(y[24]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,kd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:R=>h(O,2),type:"button"},[...y[25]||(y[25]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,ud)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,td)]))),128))]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:O=>_(U),type:"button"},"新增工作項目",8,hd)):e.createCommentVNode("",!0)]))),128))]),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[y[29]||(y[29]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",xd,[e.createElementVNode("table",$d,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[27]||(y[27]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(n).Form2Before,rows:"4",modelValue:e.unref(i).Form2Before,"onUpdate:modelValue":y[2]||(y[2]=U=>e.unref(i).Form2Before=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...y[28]||(y[28]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(n).Form2After,rows:"4",modelValue:e.unref(i).Form2After,"onUpdate:modelValue":y[3]||(y[3]=U=>e.unref(i).Form2After=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Bd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:y[4]||(y[4]=U=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:y[5]||(y[5]=U=>r(!0)),type:"button"},[...y[31]||(y[31]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-3149c8a8"]]),Cd={class:"block"},Td={class:"mt-4"},wd={class:"table align-middle gray-table side-table"},Sd={key:0},Dd={key:1,class:"text-light-gray"},Ad={class:"d-flex flex-column gap-2"},Fd={key:0},Ud={class:"mt-4"},Pd={class:"table align-middle gray-table side-table"},Md={class:"row g-3"},Id={class:"col-12 col-xl-2"},jd={class:"text-gray mb-2"},Od={class:"col-12 col-xl-3"},Ld={class:"text-gray mb-2"},Rd={key:0,class:"col-12 col-xl-4"},qd={class:"row g-1"},zd={class:"col-7"},Gd={class:"col-5"},Jd={key:1,class:"col-12 col-xl-3"},Yd={class:"text-gray mb-2"},Qd={class:"mt-4"},Hd={class:"table align-middle gray-table side-table"},Wd={class:"d-flex align-items-center gap-2"},Kd={class:"input-group w-auto"},Xd={key:0,class:"invalid mt-0"},Zd={class:"mt-4"},vd={class:"table-responsive mt-3 mb-0"},ec={class:"table align-middle gray-table"},tc={class:"text-end"},lc={class:"text-end"},oc={class:"text-end"},nc={class:"text-end"},rc={class:"text-end"},ac={class:"table align-middle gray-table side-table"},sc={key:0,class:"table-responsive mt-3 mb-0"},dc={class:"table align-middle gray-table"},cc={key:0},ic={key:0},mc={class:"d-flex gap-2"},pc=["onClick"],Vc={class:"mt-4"},fc={class:"table align-middle gray-table side-table"},Nc={key:0,class:"block-bottom bg-light-teal"},Ec={class:"text-center"},bc={class:"mb-5"},gc={__name:"Application",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.ref(),n=e.computed(()=>z("education",d.value.Status,1)),o=e.ref({}),l=e.computed(()=>k.value.filter(r=>!r.Deleted)),d=e.ref({}),b=e.ref(),k=e.ref([]),_=e.ref(),h=e.ref(0),V=e.computed({get:()=>!!l.value.length,set:r=>{r?c():k.value.forEach(t=>t.Deleted=!0)}}),c=()=>k.value.push({}),a=x,u=()=>{A.education("getApplication",{Apply:g.apply?"true":"false",ID:g.id}).subscribe(r=>{d.value=r.Project,N.value=r.Contacts,k.value=r.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,j().init("education",d.value),m.value=d.value.changeApply,d.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=(r,t)=>{var y,S;if(o.value={},r&&!f()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&_.value&&d.value.ApplyAmount>_.value.GrantLimit*1e4){b.value.show(()=>s(r,!0));return}const p={Project:d.value,Contacts:N.value,ReceivedSubsidies:k.value.filter(C=>C.ID||!C.Deleted),Before:(y=m.value)==null?void 0:y.Form1Before,After:(S=m.value)==null?void 0:S.Form1After,Submit:r?"true":"false"};A.education("saveApplication",p).subscribe(C=>{r?a("next",C.ID):d.value.ID?u():window.location.href=`Application.aspx?ID=${C.ID}`})},f=()=>{let r={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return d.value.OrgCategory==="2"&&(r.RegisteredNum="立案登記證字號"),o.value=M(d.value,r),r={Name:"姓名",JobTitle:"職稱"},Object.assign(o.value,M(N.value[0],r,"contact-0-")),r.MobilePhone="手機號碼",Object.assign(o.value,M(N.value[1],r,"contact-1-")),r={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},k.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`received-${p}-`))),m.value&&(r={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,M(m.value,r))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(r=>{i.value=r[0],g.id?u():A.education("getEmptyApplication").subscribe(t=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),N.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("education",d.value)})})}),e.provide("editable",n),e.watch(()=>d.value.OrgCategory,()=>{A.education("getGrantTargetSetting",{TargetTypeID:`EDC${d.value.OrgCategory}`}).subscribe(r=>{_.value=r})}),e.watchEffect(()=>{h.value=q(d.value.ApplyAmount)+q(d.value.SelfAmount)+q(d.value.OtherGovAmount)+q(d.value.OtherUnitAmount)}),(r,t)=>{const p=e.resolveComponent("required-label"),y=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),C=e.resolveComponent("input-tw-date"),w=e.resolveComponent("input-textarea"),P=e.resolveComponent("input-integer"),F=e.resolveComponent("input-boolean"),T=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Cd,[t[52]||(t[52]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Td,[e.createElementVNode("table",wd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",Sd,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Dd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[22]||(t[22]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=D=>e.unref(d).ProjectName=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ad,[e.createElementVNode("div",null,[e.createVNode(S,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=D=>e.unref(d).OrgCategory=D)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Fd,[e.createVNode(y,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=D=>e.unref(d).RegisteredNum=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).OrgName,placeholder:"請輸入單位全銜",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":t[3]||(t[3]=D=>e.unref(d).OrgName=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":t[4]||(t[4]=D=>e.unref(d).TaxID=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":t[5]||(t[5]=D=>e.unref(d).Address=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[53]||(t[53]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ud,[e.createElementVNode("table",Pd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(D,U)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(D.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Md,[e.createElementVNode("div",Id,[e.createElementVNode("div",jd,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[28]||(t[28]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(y,{error:e.unref(o)[`contact-${U}-Name`],modelValue:D.Name,"onUpdate:modelValue":I=>D.Name=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Od,[e.createElementVNode("div",Ld,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(y,{error:e.unref(o)[`contact-${U}-JobTitle`],modelValue:D.JobTitle,"onUpdate:modelValue":I=>D.JobTitle=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),U?(e.openBlock(),e.createElementBlock("div",Rd,[t[30]||(t[30]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",qd,[e.createElementVNode("div",zd,[e.createVNode(y,{modelValue:D.Phone,"onUpdate:modelValue":I=>D.Phone=I,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Gd,[e.createVNode(y,{placeholder:"請輸入分機",size:"4",modelValue:D.PhoneExt,"onUpdate:modelValue":I=>D.PhoneExt=I,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),U?(e.openBlock(),e.createElementBlock("div",Jd,[e.createElementVNode("div",Yd,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(y,{error:e.unref(o)[`contact-${U}-MobilePhone`],modelValue:D.MobilePhone,"onUpdate:modelValue":I=>D.MobilePhone=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[54]||(t[54]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Qd,[e.createElementVNode("table",Hd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[32]||(t[32]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Wd,[e.createElementVNode("div",Kd,[e.createVNode(C,{class:"w-auto",modelValue:e.unref(d).StartTime,"onUpdate:modelValue":t[6]||(t[6]=D=>e.unref(d).StartTime=D)},null,8,["modelValue"]),t[33]||(t[33]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(C,{class:"w-auto",modelValue:e.unref(d).EndTime,"onUpdate:modelValue":t[7]||(t[7]=D=>e.unref(d).EndTime=D)},null,8,["modelValue"])]),t[34]||(t[34]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",Xd,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Target,modelValue:e.unref(d).Target,"onUpdate:modelValue":t[8]||(t[8]=D=>e.unref(d).Target=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":t[9]||(t[9]=D=>e.unref(d).Summary=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":t[10]||(t[10]=D=>e.unref(d).Quantified=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[55]||(t[55]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Zd,[t[43]||(t[43]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",vd,[e.createElementVNode("table",ec,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",tc,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費(元)",-1)])]),_:1})]),e.createElementVNode("th",lc,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款(元)",-1)])]),_:1})]),e.createElementVNode("th",oc,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[40]||(t[40]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費(元)",-1)])]),_:1})]),e.createElementVNode("th",nc,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[41]||(t[41]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費(元) (含總收費)",-1)])]),_:1})]),t[42]||(t[42]=e.createElementVNode("th",{class:"text-end"},"計畫總經費(元)",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).ApplyAmount,modelValue:e.unref(d).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=D=>e.unref(d).ApplyAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).SelfAmount,modelValue:e.unref(d).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=D=>e.unref(d).SelfAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).OtherGovAmount,modelValue:e.unref(d).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=D=>e.unref(d).OtherGovAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).OtherUnitAmount,modelValue:e.unref(d).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=D=>e.unref(d).OtherUnitAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",rc,e.toDisplayString(e.unref(h).toLocaleString()),1)])])])])]),e.createElementVNode("table",ac,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[44]||(t[44]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{modelValue:e.unref(V),"onUpdate:modelValue":t[15]||(t[15]=D=>e.isRef(V)?V.value=D:null)},null,8,["modelValue"]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",sc,[e.createElementVNode("table",dc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[45]||(t[45]=e.createElementVNode("th",null,"計畫名稱",-1)),t[46]||(t[46]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費(元)",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",cc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(D,U)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`received-${U}-Name`],modelValue:D.Name,"onUpdate:modelValue":I=>D.Name=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`received-${U}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":I=>D.Amount=I},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",ic,[e.createElementVNode("div",mc,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:I=>E(D),type:"button"},[...t[47]||(t[47]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pc)):e.createCommentVNode("",!0),U+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[48]||(t[48]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[51]||(t[51]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Vc,[e.createElementVNode("table",fc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[49]||(t[49]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":t[16]||(t[16]=D=>e.unref(m).Form1Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[50]||(t[50]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":t[17]||(t[17]=D=>e.unref(m).Form1After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",Nc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[18]||(t[18]=D=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[19]||(t[19]=D=>s(!0)),type:"button"},[...t[56]||(t[56]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(T,{ref_key:"modal",ref:b},{default:e.withCtx(()=>{var D;return[e.createElementVNode("div",Ec,[t[57]||(t[57]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",bc,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((D=e.unref(_))==null?void 0:D.GrantLimit)+"萬",1),t[58]||(t[58]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[59]||(t[59]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},yc={class:"block"},kc={key:0,class:"text-pink lh-base mt-4"},uc={class:"mt-4"},hc={class:"table align-middle gray-table"},xc={class:"text-center"},$c={key:0,width:"180"},Bc={class:"text-center"},_c={key:0},Cc=["innerHTML"],Tc=["href"],wc={key:0,class:"text-center"},Sc={key:0},Dc={key:1,class:"text-pink"},Ac={key:1,class:"tag-group mt-2 gap-1"},Fc={key:0,class:"tag tag-green-light"},Uc=["download","href"],Pc=["onClick"],Mc={key:1,class:"text-center mt-4"},Ic={class:"mt-4"},jc={class:"table align-middle gray-table side-table"},Oc={key:0,class:"block-bottom bg-light-teal"},Lc=["disabled"],Rc={__name:"Attachment",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([{Type:1,Title:"申請表",Template:`../../Service/OFS/DownloadTemplateEDC.ashx?type=1&id=${g.id}`,Files:[]},{Type:2,Title:"計畫書",Template:`../../Service/OFS/DownloadTemplateEDC.ashx?type=2&id=${g.id}`,Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:`../../Service/OFS/DownloadTemplateEDC.ashx?type=3&id=${g.id}`,Files:[]}]),m=e.ref(),N=e.computed(()=>i.value.some(c=>!c.Optional&&!c.Files.filter(a=>!a.Deleted).length)),n=e.computed(()=>z("education",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,a)=>{a.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:a.Path,Name:l.value.ProjectID+"_"+(c.Multiple?a.Name:`${c.Title}.pdf`)})},b=A.download,k=x,_=()=>{rxjs.forkJoin([A.education("getAttachment",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=i.value.filter(u=>{var E;return!((E=u.Excludes)!=null&&E.includes(l.value.OrgCategory))}),i.value.forEach(u=>{u.Files=a.Attachments.filter(E=>E.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(E=>!E.Deleted).length)}),j().init("education",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},h=c=>{var u,E;if(o.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={ID:g.id,Attachments:i.value.reduce((s,f)=>s.concat(f.Files),[]),Before:(u=m.value)==null?void 0:u.Form5Before,After:(E=m.value)==null?void 0:E.Form5After,Submit:c?"true":"false"};A.education("saveAttachment",a).subscribe(()=>{c?k("next"):_()})},V=()=>{if(m.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,M(m.value,c))}return!Object.keys(o.value).length};return e.onMounted(_),e.provide("editable",n),(c,a)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file"),s=e.resolveComponent("tw-date-time"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yc,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("p",kc,[...a[4]||(a[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",uc,[e.createElementVNode("table",hc,[e.createElementVNode("thead",xc,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",$c,"狀態")):e.createCommentVNode("",!0),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(r,t)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",Bc,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[r.Optional?(e.openBlock(),e.createElementBlock("span",_c,e.toDisplayString(r.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.Title),1)]),_:2},1024))]),e.unref(n)&&r.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:r.Comment},null,8,Cc)):e.createCommentVNode("",!0),e.unref(n)&&r.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",download:"",href:r.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Tc)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",wc,[r.Uploaded?(e.openBlock(),e.createElementBlock("span",Sc,"已上傳")):(e.openBlock(),e.createElementBlock("span",Dc,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&(r.Multiple||!r.Uploaded)?(e.openBlock(),e.createBlock(E,{key:0,accept:".pdf",onFile:p=>d(r,p)},null,8,["onFile"])):e.createCommentVNode("",!0),r.Uploaded?(e.openBlock(),e.createElementBlock("div",Ac,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.Files,p=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:p},[p.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Fc,[e.createElementVNode("a",{class:"tag-link my-1",download:p.Name,href:e.unref(b)(p.Path)},e.toDisplayString(p.Name),9,Uc),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>p.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Pc)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(l).ApplyTime?(e.openBlock(),e.createElementBlock("div",Mc,[a[10]||(a[10]=e.createTextVNode("申請送件時間：",-1)),e.createVNode(s,{value:e.unref(l).ApplyTime},null,8,["value"])])):e.createCommentVNode("",!0),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ic,[e.createElementVNode("table",jc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(m).Form5Before=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(m).Form5After=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",Oc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[2]||(a[2]=r=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[3]||(a[3]=r=>h(!0)),disabled:e.unref(N),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Lc)])):e.createCommentVNode("",!0)],64)}}},qc={class:"block"},zc={class:"square-title"},Gc={class:"text-teal fw-bold py-3"},Jc={class:"text-teal fw-bold pb-3"},Yc={class:"table-responsive mb-0"},Qc={class:"table align-middle gray-table"},Hc={class:"text-end"},Wc={class:"text-end"},Kc={class:"text-end"},Xc={class:"text-teal fw-bold pb-3"},Zc={class:"text-teal fw-bold pb-3"},vc={class:"mt-4"},ei={class:"table align-middle gray-table"},ti={class:"text-center"},li={key:0,width:"180"},oi={class:"text-center"},ni=["href"],ri={key:0,class:"text-center"},ai={key:0},si={key:1,class:"text-pink"},di={key:1,class:"tag-group mt-2 gap-1"},ci={key:0,class:"tag tag-green-light"},ii=["download","href"],mi=["onClick"],pi={class:"block-bottom bg-light-teal"},Vi=["disabled"],fi={__name:"Payment",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>i.value<=0||_.value.some(E=>!E.Files.filter(s=>!s.Deleted).length)),N=e.computed(()=>!l.value||l.value.Status==="請款中"),n=e.computed(()=>{var E;return((E=l.value)==null?void 0:E.Status)==="通過"}),o=e.ref(0),l=e.ref(),d=e.ref({}),b=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(i.value*100/d.value.ApprovedAmount*100)/100,100):0),k=e.computed(()=>n.value?Math.round(i.value*100/l.value.CurrentActualPaidAmount*100)/100+"%":"--"),_=e.ref([{Type:11,Title:"收支明細表",Template:"../../Template/EDC/1-收支明細表.docx",Files:[]},{Type:12,Title:"受補助清單",Template:"../../Template/EDC/2-受補助清單.docx",Files:[]},{Type:13,Title:"經費分攤表",Template:"../../Template/EDC/3-經費分攤表.docx",Files:[]},{Type:14,Title:"憑證",Template:"../../Template/EDC/4-憑證.docx",Files:[]},{Type:15,Title:"領據",Template:"../../Template/EDC/5-領據.docx",Files:[]}]),h=(E,s)=>{s.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:s.Path,Name:`${d.value.ProjectID}_${E.Title}.pdf`})},V=A.download,c=x,a=()=>{A.education("getPayment",{ID:g.id}).subscribe(E=>{d.value=E.Project,j().init("education",d.value),_.value=_.value.filter(s=>{var f;return!((f=s.Excludes)!=null&&f.includes(d.value.OrgCategory))}),_.value.forEach(s=>{s.Files=E.Attachments.filter(f=>f.Type===s.Type),s.Uploaded=e.computed(()=>s.Files.filter(f=>!f.Deleted).length)}),l.value=E.Payments.find(s=>s.Stage===1),l.value&&(i.value=l.value.TotalSpentAmount),o.value=d.value.ApprovedAmount,Y().init(l.value)})},u=E=>{const s={Payment:{ProjectID:g.id,Stage:1,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:_.value.reduce((f,r)=>f.concat(r.Files),[]),Submit:E?"true":"false"};A.education("savePayment",s).subscribe(()=>{E?c("next"):a()})};return e.onMounted(a),e.provide("editable",N),(E,s)=>{var p;const f=e.resolveComponent("input-integer"),r=e.resolveComponent("required-label"),t=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",qc,[e.createElementVNode("h5",zc,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",Gc,"核定經費: "+e.toDisplayString((p=e.unref(d).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("p",Jc,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(i)).toLocaleString())+"元",1),e.createElementVNode("div",Yc,[e.createElementVNode("table",Qc,[s[4]||(s[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Hc,e.toDisplayString(e.unref(i)),1),s[3]||(s[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(f,{max:e.unref(o),modelValue:e.unref(i),"onUpdate:modelValue":s[0]||(s[0]=y=>e.isRef(i)?i.value=y:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",Wc,e.toDisplayString(e.unref(b))+"%",1),e.createElementVNode("td",Kc,e.toDisplayString(e.unref(k)),1)])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",Xc,"本期實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",Zc,"累積實際撥款: "+e.toDisplayString(e.unref(l).CurrentActualPaidAmount.toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),s[10]||(s[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),s[11]||(s[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",vc,[e.createElementVNode("table",ei,[e.createElementVNode("thead",ti,[e.createElementVNode("tr",null,[s[5]||(s[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[6]||(s[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",li,"狀態")):e.createCommentVNode("",!0),s[7]||(s[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),(y,S)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",oi,e.toDisplayString(S+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Title),1)]),_:2},1024)]),e.unref(N)&&y.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:y.Template,style:{width:"140px"},type:"button"},[...s[8]||(s[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,ni)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",ri,[y.Uploaded?(e.openBlock(),e.createElementBlock("span",ai,"已上傳")):(e.openBlock(),e.createElementBlock("span",si,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!y.Uploaded?(e.openBlock(),e.createBlock(t,{key:0,accept:".pdf",onFile:C=>h(y,C)},null,8,["onFile"])):e.createCommentVNode("",!0),y.Uploaded?(e.openBlock(),e.createElementBlock("div",di,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.Files,C=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:C},[C.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ci,[e.createElementVNode("a",{class:"tag-link my-1",download:C.Name,href:e.unref(V)(C.Path)},e.toDisplayString(C.Name),9,ii),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:w=>C.Deleted=!0,type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,mi)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",pi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[1]||(s[1]=y=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[2]||(s[2]=y=>u(!0)),disabled:e.unref(m),type:"button"},[...s[12]||(s[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Vi)])],64)}}},Ni={__name:"ProgressBar",setup(B){const x=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(g,i)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:x,type:"education"})}}},Ei={class:"modal-dialog modal-dialog-centered modal-md"},bi={class:"modal-content"},gi={class:"modal-body"},yi={class:"d-flex flex-column align-items-center mb-5 gap-3"},ki={class:"fs-18"},ui={__name:"ErrorModal",setup(B){const x=v(),g=e.ref();return e.onMounted(()=>g.value.addEventListener("hidden.bs.modal",()=>x.error=null)),e.watch(()=>x.error,()=>{x.error&&bootstrap.Modal.getOrCreateInstance(g.value).show()}),(i,m)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:g,tabindex:"-1"},[e.createElementVNode("div",Ei,[e.createElementVNode("div",bi,[m[2]||(m[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",gi,[e.createElementVNode("div",yi,[m[0]||(m[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",ki,e.toDisplayString(e.unref(x).error),1)]),m[1]||(m[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},X=Q.defineStore("grant",{actions:{init(B){this.type=B}},state:()=>({type:null,typeList:[{code:"SCI",title:"科專"},{code:"CUL",title:"文化"},{code:"EDC",title:"學校／民間"},{code:"CLB",title:"學校社團"},{code:"MUL",title:"多元"},{code:"LIT",title:"素養"},{code:"ACC",title:"無障礙"}]})}),hi={key:0,class:"search bg-gray rounded-4 mt-4"},xi={class:"search-form"},$i={class:"row g-3"},Bi={class:"col-12 col-lg-6"},_i={key:0,class:"rounded-4 bg-white mt-4 p-4"},Ci={class:"row"},Ti={class:"col-12"},wi={class:"row"},Si={class:"col-12 d-flex justify-content-between align-items-center pe-4"},Di={class:"fw-bold text-primary fs-2"},Ai={key:1,class:"rounded-4 bg-white mt-4 py-4"},Fi={class:"row"},Ui={class:"col-12 col-lg-4"},Pi={class:"col-12 col-lg-8"},Mi={key:2,class:"row"},Ii={class:"col-12 col-lg-6 pt-4"},ji={class:"d-flex justify-content-between align-items-center rounded-4 bg-white p-4"},Oi={class:"fw-bold text-primary fs-2"},Li={class:"col-12 col-lg-6 pt-4"},Ri={class:"d-flex justify-content-between align-items-center rounded-4 bg-white p-4"},qi={class:"fw-bold text-primary fs-2"},zi={class:"col-12 col-lg-6 pt-4"},Gi={class:"d-flex justify-content-between align-items-center rounded-4 bg-white p-4"},Ji={class:"fw-bold text-primary fs-2"},Yi={class:"col-12 col-lg-6 pt-4"},Qi={class:"d-flex justify-content-between align-items-center rounded-4 bg-white p-4"},Hi={class:"fw-bold text-primary fs-2"},Wi={class:"rounded-4 bg-white p-4 mt-4 d-flex flex-column gap-3"},Ki={class:"table-responsive"},Xi={class:"table align-middle gray-table"},Zi={class:"text-center"},vi={class:"text-center"},em=["href"],tm={class:"text-end"},lm={class:"text-end"},om={class:"search bg-white rounded-4 mt-4"},nm={class:"table-responsive mt-4"},rm={class:"row"},am={class:"col"},sm=["value"],dm={class:"table teal-table","aria-label":"申請計畫列表"},cm={"data-th":"年度:"},im={"data-th":"類別:",class:"text-start"},mm={"data-th":"補助計畫:"},pm={"data-th":"申請期限:"},Vm={"data-th":"補助對象:"},fm={"data-th":"相關檔案:"},Nm=["download","href"],Em={"data-th":"我要申請:"},bm=["href"],gm={class:"search bg-white rounded-4 mt-4"},ym={class:"mt-4"},km={key:0,class:"total-list mt-4"},um=["href"],hm={class:"total-item-title"},xm={class:"total-item-content"},$m={class:"count"},Bm={__name:"HomeDashboard",setup(B){const x=X().typeList,g=[{title:"申請中尚未提送",url:"ApplicationChecklist.aspx",count:e.computed(()=>i.value.filter(f=>[1,14].includes(f.Status)).length)},{title:"申請審查中",url:"ApplicationChecklist.aspx",count:e.computed(()=>i.value.filter(f=>[11,12,21,22,31,32,41,42,43,44].includes(f.Status)).length)},{title:"審查意見待回覆",url:"ApplicationChecklist.aspx?waitingReply=1",count:e.computed(()=>{var f;return((f=o.value.find(r=>r.Status===1))==null?void 0:f.Count)||0})},{title:"執行中計畫",url:"inprogressList.aspx",count:e.computed(()=>i.value.filter(f=>[51,52].includes(f.Status)).length)},{title:"執行階段待回覆",url:"inprogressList.aspx?pendingReply=1",count:e.computed(()=>{var f;return((f=o.value.find(r=>r.Status===2))==null?void 0:f.Count)||0})}],i=e.ref([]),m=e.ref([]),N=e.ref(),n=e.ref(),o=e.ref([]),l=e.ref(""),d=e.ref([]),b=e.ref([]),k=e.ref([]),_=e.ref(),h=e.computed(()=>{let f=m.value;return l.value&&(f=f.filter(r=>r.tags.includes(l.value))),f}),V=e.computed(()=>_.value?k.value.filter(f=>f.Category===_.value):k.value),c=e.computed(()=>({ApprovedAmount:V.value.reduce((f,r)=>f+r.ApprovedAmount,0),RemainingAmount:V.value.reduce((f,r)=>f+r.ApprovedAmount-r.SpendAmount,0),SpendAmount:V.value.reduce((f,r)=>f+r.SpendAmount,0),PaymentAmount:V.value.reduce((f,r)=>f+r.PaymentAmount,0),BudgetFees:V.value.reduce((f,r)=>f+r.BudgetFees,0)})),a=A.download,u=f=>b.value.filter(r=>r.GrantTypeID===f.TypeCode).map((r,t)=>`${t+1}.${r.Note}`).join("<br>"),E=f=>{switch(f.TypeCode){case"SCI":return"SCI/SciApplication.aspx?GrantTypeID=SCI";case"CLB":return"CLB/ClbApplication.aspx?GrantTypeID=CLB";default:return`${f.TypeCode}/Application.aspx`}},s=(f,r,t=2)=>{if(r){const p=10**t;return Math.round(f*100/r*p)/p}return 0};return e.onMounted(()=>{A.system("dashboard").subscribe(f=>{m.value=f.GrantTypes,b.value=f.Settings,i.value=f.ApplyList,k.value=f.StatList,o.value=f.PendingList,N.value=f.IsOrganizer,n.value=f.IsUser,m.value.forEach(r=>{var t;r.tags=((t=r.TargetTags)==null?void 0:t.split(`
`).map(p=>p.trim()).filter(p=>p))||[],r.tags.forEach(p=>{d.value.includes(p)||d.value.push(p)})})})}),(f,r)=>{const t=e.resolveComponent("input-select"),p=e.resolveComponent("report-pie-chart"),y=e.resolveComponent("report-mix-chart"),S=e.resolveComponent("tw-date"),C=e.resolveComponent("tooltip");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",hi,[r[20]||(r[20]=e.createElementVNode("h3",{class:"text-teal d-flex align-items-center gap-2"},[e.createElementVNode("img",{src:"../assets/img/title-icon12-teal.svg"}),e.createTextVNode(" 經費執行狀況 ")],-1)),e.createElementVNode("div",xi,[e.createElementVNode("div",$i,[r[3]||(r[3]=e.createElementVNode("div",{class:"col-12 col-lg-6"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",{value:""},"114")])],-1)),e.createElementVNode("div",Bi,[r[2]||(r[2]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"全部類別",-1)),e.createVNode(t,{"allow-empty":"",options:e.unref(x),placeholder:"全部","text-name":"title","value-name":"code",modelValue:e.unref(_),"onUpdate:modelValue":r[0]||(r[0]=w=>e.isRef(_)?_.value=w:null)},null,8,["options","modelValue"])])]),r[4]||(r[4]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",_i,[e.createElementVNode("div",Ci,[e.createElementVNode("div",Ti,[e.createElementVNode("div",wi,[e.createElementVNode("div",Si,[r[6]||(r[6]=e.createElementVNode("div",{class:"fw-bold fs-4"},"總預算經費",-1)),e.createElementVNode("div",Di,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(c).BudgetFees/1e3).toLocaleString())+" ",1),r[5]||(r[5]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])])])])])):e.createCommentVNode("",!0),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Ai,[e.createElementVNode("div",Fi,[e.createElementVNode("div",Ui,[r[7]||(r[7]=e.createElementVNode("div",{class:"text-center fs-4 fw-bold mb-4"},"經費執行率",-1)),e.createVNode(p,{active:"已執行",color:9323693,inactive:"未執行",percent:s(e.unref(c).SpendAmount,e.unref(c).ApprovedAmount,1),style:{width:"100%",height:"300px"}},null,8,["percent"])]),e.createElementVNode("div",Pi,[r[8]||(r[8]=e.createElementVNode("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e.createElementVNode("span",{class:"fs-4 fw-bold"},"各類經費執行情形")],-1)),r[9]||(r[9]=e.createElementVNode("div",{class:"fs-6 text-end text-secondary me-5"},"單位：千元",-1)),e.unref(k).length?(e.openBlock(),e.createBlock(y,{key:0,list:e.unref(k),style:{width:"100%",height:"300px"}},null,8,["list"])):e.createCommentVNode("",!0)])])])):e.createCommentVNode("",!0),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Mi,[e.createElementVNode("div",Ii,[e.createElementVNode("div",ji,[r[11]||(r[11]=e.createElementVNode("div",{class:"fw-bold fs-4"},"核定補助經費",-1)),e.createElementVNode("div",Oi,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(c).ApprovedAmount/1e3).toLocaleString())+" ",1),r[10]||(r[10]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])]),e.createElementVNode("div",Li,[e.createElementVNode("div",Ri,[r[13]||(r[13]=e.createElementVNode("div",{class:"fw-bold fs-4"},"賸餘款",-1)),e.createElementVNode("div",qi,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(c).RemainingAmount/1e3).toLocaleString())+" ",1),r[12]||(r[12]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])]),e.createElementVNode("div",zi,[e.createElementVNode("div",Gi,[r[15]||(r[15]=e.createElementVNode("div",{class:"fw-bold fs-4"},"實支金額",-1)),e.createElementVNode("div",Ji,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(c).SpendAmount/1e3).toLocaleString())+" ",1),r[14]||(r[14]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])]),e.createElementVNode("div",Yi,[e.createElementVNode("div",Qi,[r[17]||(r[17]=e.createElementVNode("div",{class:"fw-bold fs-4"},"已撥付",-1)),e.createElementVNode("div",Hi,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(c).PaymentAmount/1e3).toLocaleString())+" ",1),r[16]||(r[16]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])])])):e.createCommentVNode("",!0),e.createElementVNode("div",Wi,[r[19]||(r[19]=e.createElementVNode("h5",{class:"square-title"},"各類經費列表",-1)),e.createElementVNode("div",Ki,[e.createElementVNode("table",Xi,[r[18]||(r[18]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-center"},"類別"),e.createElementVNode("th",{class:"text-center"},"核定件數"),e.createElementVNode("th",{class:"text-end"},"核定補助經費"),e.createElementVNode("th",{class:"text-end"},"經費執行率")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(k),w=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",Zi,e.toDisplayString(e.unref(x).find(P=>P.code===w.Category).title),1),e.createElementVNode("td",vi,[e.createElementVNode("a",{href:`Report/ApprovedList.aspx?category=${w.Category}`},e.toDisplayString(w.Count),9,em)]),e.createElementVNode("td",tm,e.toDisplayString(w.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",lm,e.toDisplayString(s(w.SpendAmount,w.ApprovedAmount))+"%",1)]))),128))])])])])])):e.createCommentVNode("",!0),e.createElementVNode("div",om,[r[26]||(r[26]=e.createElementVNode("h3",{class:"text-teal d-flex align-items-center gap-2"},[e.createElementVNode("img",{src:"../assets/img/title-icon13-teal.svg"}),e.createTextVNode(" 海洋委員會補助公告 ")],-1)),e.createElementVNode("div",nm,[e.createElementVNode("div",rm,[e.createElementVNode("div",am,[r[22]||(r[22]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"依身分篩選適用規定",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":r[1]||(r[1]=w=>e.isRef(l)?l.value=w:null)},[r[21]||(r[21]=e.createElementVNode("option",{value:""},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),w=>(e.openBlock(),e.createElementBlock("option",{key:w,value:w},e.toDisplayString(w),9,sm))),128))],512),[[e.vModelSelect,e.unref(l)]])])]),e.createElementVNode("table",dm,[r[25]||(r[25]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col"},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"類別"),e.createElementVNode("th",{scope:"col"},"補助計畫"),e.createElementVNode("th",{scope:"col"},"申請期限"),e.createElementVNode("th",{scope:"col"},"補助對象"),e.createElementVNode("th",{scope:"col"},"相關檔案"),e.createElementVNode("th",{scope:"col"})])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(h),w=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",cm,e.toDisplayString(w.Year),1),e.createElementVNode("td",im,e.toDisplayString(w.ShortName),1),e.createElementVNode("td",mm,e.toDisplayString(w.FullName),1),e.createElementVNode("td",pm,[e.createVNode(S,{value:w.ApplyEndDate},null,8,["value"])]),e.createElementVNode("td",Vm,[e.createVNode(C,{"data-bs-html":"true",title:u(w)},null,8,["title"])]),e.createElementVNode("td",fm,[w.Path?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark",download:w.Filename,href:e.unref(a)(w.Path),style:{display:"inline"}},[...r[23]||(r[23]=[e.createElementVNode("i",{class:"fas fa-file-alt"},null,-1)])],8,Nm)):e.createCommentVNode("",!0)]),e.createElementVNode("td",Em,[e.createElementVNode("a",{class:"btn btn-teal-dark",href:E(w),target:"_blank"},[...r[24]||(r[24]=[e.createElementVNode("i",{class:"fa-solid"},null,-1),e.createTextVNode("我要申請",-1)])],8,bm)])]))),128))])])])]),e.createElementVNode("div",gm,[r[28]||(r[28]=e.createElementVNode("h3",{class:"text-teal d-flex align-items-center gap-2"},[e.createElementVNode("img",{src:"../assets/img/title-icon14-teal.svg"}),e.createTextVNode(" 我的計畫進度 ")],-1)),e.createElementVNode("div",ym,[e.unref(n)?(e.openBlock(),e.createElementBlock("ul",km,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(g,w=>e.createElementVNode("li",{class:"total-item",key:w},[e.createElementVNode("a",{href:w.url},[e.createElementVNode("div",hm,e.toDisplayString(w.title),1),e.createElementVNode("div",xm,[e.createElementVNode("span",$m,e.toDisplayString(w.count),1),r[27]||(r[27]=e.createElementVNode("span",{class:"unit"},"件",-1))])],8,um)])),64))])):e.createCommentVNode("",!0)])])],64)}}},_m={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const x=e.useModel(B,"modelValue"),g=[{value:!0,text:"是"},{value:!1,text:"否"}];return(i,m)=>{const N=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(N,{options:g,modelValue:x.value,"onUpdate:modelValue":m[0]||(m[0]=n=>x.value=n)},null,8,["modelValue"])}}},Cm=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(B,{emit:x}){const g=e.ref(),i=()=>{Array.from(g.value.files).forEach(N=>A.upload(N).subscribe(n=>m("file",n))),g.value.value=""},m=x;return(N,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:n[0]||(n[0]=o=>e.unref(g).click()),type:"button"},[...n[1]||(n[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:i,class:"d-none",ref_key:"input",ref:g,type:"file"},N.$attrs),null,16)],64))}}),Tm=["disabled","placeholder","type"],wm={key:0,class:"invalid mt-0"},Sm=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},max:{type:Number},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const x=e.inject("editable",!0),g=e.useModel(B,"modelValue"),i=B;return e.watch(g,m=>{if(m){const N=(parseInt(m)||0).toString();m.toString()!==N?g.value=N:i.max&&Number(N)>i.max&&(g.value=i.max)}}),(m,N)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(x),placeholder:e.unref(x)?B.placeholder:"",style:{"text-align":"right"},type:B.type},m.$attrs,{"onUpdate:modelValue":N[0]||(N[0]=n=>g.value=n)}),null,16,Tm),[[e.vModelDynamic,g.value]]),B.error?(e.openBlock(),e.createElementBlock("div",wm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),Dm={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const x=e.useModel(B,"modelValue"),g=[];for(let i=1;i<=12;i++)g.push({value:i,text:`${i}月`});return(i,m)=>{const N=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(N,{options:g,modelValue:x.value,"onUpdate:modelValue":m[0]||(m[0]=n=>x.value=n)},null,8,["modelValue"])}}},Am=["onChange","checked","disabled","id","value"],Fm=["for"],Um={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>ae(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const x=e.inject("editable",!0),g=e.useModel(B,"modelValue"),i=m=>{g.value=m};return(m,N)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,n=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:n},[e.createElementVNode("input",{onChange:o=>i(n[B.valueName]),checked:n[B.valueName]===g.value,class:"form-check-input",disabled:!e.unref(x),id:`${B.id}-${n[B.valueName]}`,type:"radio",value:n[B.valueName]},null,40,Am),e.createElementVNode("label",{class:"form-check-label",for:`${B.id}-${n[B.valueName]}`},e.toDisplayString(n[B.textName]),9,Fm)]))),128))}},Pm=["disabled"],Mm=["value"],Im=["value"],jm={key:0,class:"invalid mt-0"},Om=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({allowEmpty:{default:!1,type:Boolean},disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const x=e.inject("editable",!0),g=e.useModel(B,"modelValue");return(i,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:B.disabled||!e.unref(x)},i.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=N=>g.value=N)}),[B.allowEmpty||e.unref(x)&&!g.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:B.emptyValue},e.toDisplayString(B.placeholder),9,Mm)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,(N,n)=>e.renderSlot(i.$slots,"default",{key:N,index:n,option:N},()=>[e.createElementVNode("option",{value:N[B.valueName]},e.toDisplayString(N[B.textName]),9,Im)])),128))],16,Pm),[[e.vModelSelect,g.value]]),B.error?(e.openBlock(),e.createElementBlock("div",jm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),Lm={class:"input-group"},Rm={key:0,class:"input-group-text"},qm=["disabled","placeholder","type"],zm={key:0,class:"invalid mt-0"},Gm=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const x=e.inject("editable",!0),g=e.useModel(B,"modelValue"),i=B;return i.maxLength&&e.watch(g,()=>{var m;((m=g.value)==null?void 0:m.length)>i.maxLength&&(g.value=g.value.substring(0,i.maxLength))}),(m,N)=>{const n=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Lm,[B.prefix?(e.openBlock(),e.createElementBlock("span",Rm,[e.createVNode(n,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(x),placeholder:e.unref(x)?B.placeholder:"",type:B.type},m.$attrs,{"onUpdate:modelValue":N[0]||(N[0]=o=>g.value=o)}),null,16,qm),[[e.vModelDynamic,g.value]])]),B.error?(e.openBlock(),e.createElementBlock("div",zm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),Jm=["disabled","placeholder"],Ym={key:0,class:"fs-14 text-gray mt-2"},Qm={class:"text-pink"},Hm={key:1,class:"invalid mt-0"},Wm=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const x=e.inject("editable",!0),g=e.useModel(B,"modelValue"),i=B;return i.maxLength&&e.watch(g,()=>{var m;((m=g.value)==null?void 0:m.length)>i.maxLength&&(g.value=g.value.substring(0,i.maxLength))}),(m,N)=>{var n;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(x),placeholder:e.unref(x)?B.placeholder:""},m.$attrs,{"onUpdate:modelValue":N[0]||(N[0]=o=>g.value=o)}),null,16,Jm),[[e.vModelText,g.value]]),e.unref(x)&&B.maxLength?(e.openBlock(),e.createElementBlock("div",Ym,[N[1]||(N[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Qm,e.toDisplayString(((n=g.value)==null?void 0:n.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(B.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),B.error?(e.openBlock(),e.createElementBlock("div",Hm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),Km=["disabled","placeholder"],Xm={key:0,class:"invalid"},Zm=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean},placeholder:{default:"請輸入",type:String}},emits:["update:modelValue"],setup(B,{emit:x}){let g;const i=B,m=e.ref(),N=e.inject("editable",!0),n=e.ref(),o=x,l=d=>{!d&&i.modelValue&&(d=moment(new Date(i.modelValue))),d?(m.value=d.format(i.displayFormat),o("update:modelValue",d.format(i.format))):(m.value="",o("update:modelValue","")),g.setStartDate(m.value||void 0)};return e.onMounted(()=>{const d=$(n.value);d.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:i.drops,locale:{format:i.displayFormat},maxDate:i.maxDate?new Date(i.maxDate):i.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(b,k)=>l(k.startDate)),g=d.data("daterangepicker"),l()}),e.onUnmounted(()=>g.remove()),e.watch(()=>i.modelValue,()=>l()),(d,b)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(N),placeholder:e.unref(N)?B.placeholder:"",ref_key:"element",ref:n,type:"text"},d.$attrs,{"onUpdate:modelValue":b[0]||(b[0]=k=>e.isRef(m)?m.value=k:null)}),null,16,Km),[[e.vModelText,e.unref(m)]]),B.error?(e.openBlock(),e.createElementBlock("div",Xm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),vm={key:0,class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},ep={class:"pagination","aria-label":"Pagination"},tp=["disabled"],lp={key:1,class:"pagination-item ellipsis",type:"button"},op=["onClick"],np={class:"page-number"},rp={key:2,class:"pagination-item ellipsis",type:"button"},ap={class:"page-number"},sp=["disabled"],dp={class:"page-number-control"},cp={class:"page-number-control-item"},ip=["selected","value"],mp={class:"page-number-control-item"},pp=["value","selected"],Vp={__name:"ListPager",props:{count:{required:!0,type:Number},page:{required:!0,type:Number},pageSize:{required:!0,type:Number},slots:{default:3,type:Number}},emits:["change"],setup(B,{emit:x}){const g={},i=B,m=e.computed(()=>Math.ceil(i.count/i.pageSize)),N=(o,l)=>{l&&(o=Math.min(o,Math.ceil(i.count/l))),1<=o&&o<=m.value&&n("change",o,l||i.pageSize)},n=x;return e.watchEffect(()=>{g.from=i.page-parseInt(i.slots/2),g.to=i.page+parseInt((i.slots-1)/2),g.pages=[];for(let o=g.from;o<=g.to;o++)0<o&&o<=m.value&&g.pages.push(o)}),(o,l)=>i.count?(e.openBlock(),e.createElementBlock("div",vm,[e.createElementVNode("nav",ep,[e.createElementVNode("button",{"aria-label":"Previous page",class:"nav-button",onClick:l[0]||(l[0]=d=>N(B.page-1)),disabled:B.page===1,type:"button"},[...l[6]||(l[6]=[e.createElementVNode("i",{class:"fas fa-chevron-left"},null,-1)])],8,tp),g.from>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"pagination-item",onClick:l[1]||(l[1]=d=>N(1)),type:"button"},[...l[7]||(l[7]=[e.createElementVNode("span",{class:"page-number"},"1",-1)])])):e.createCommentVNode("",!0),g.from>2?(e.openBlock(),e.createElementBlock("button",lp,[...l[8]||(l[8]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.pages,d=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["pagination-item",{active:B.page===d}]),onClick:b=>N(d),key:d,type:"button"},[e.createElementVNode("span",np,e.toDisplayString(d),1)],10,op))),128)),e.unref(m)>g.to+1?(e.openBlock(),e.createElementBlock("button",rp,[...l[9]||(l[9]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),e.unref(m)>g.to?(e.openBlock(),e.createElementBlock("button",{key:3,class:"pagination-item",onClick:l[2]||(l[2]=d=>N(e.unref(m))),type:"button"},[e.createElementVNode("span",ap,e.toDisplayString(e.unref(m)),1)])):e.createCommentVNode("",!0),e.createElementVNode("button",{"aria-label":"Next page",class:"nav-button",onClick:l[3]||(l[3]=d=>N(B.page+1)),type:"button",disabled:B.page===e.unref(m)},[...l[10]||(l[10]=[e.createElementVNode("i",{class:"fas fa-chevron-right"},null,-1)])],8,sp)]),e.createElementVNode("div",dp,[e.createElementVNode("div",cp,[l[11]||(l[11]=e.createElementVNode("span",null,"跳到",-1)),e.createElementVNode("select",{onChange:l[4]||(l[4]=d=>N(d.target.value)),class:"form-select jump-to-page"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),d=>(e.openBlock(),e.createElementBlock("option",{key:d,selected:d===B.page,value:d},e.toDisplayString(d),9,ip))),128))],32),l[12]||(l[12]=e.createElementVNode("span",null,"頁",-1)),l[13]||(l[13]=e.createElementVNode("span",null,",",-1))]),e.createElementVNode("div",mp,[l[14]||(l[14]=e.createElementVNode("span",null,"每頁顯示",-1)),e.createElementVNode("select",{onChange:l[5]||(l[5]=d=>N(B.page,d.target.value)),class:"form-select"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList([10,20,30],d=>e.createElementVNode("option",{value:d,selected:d===B.pageSize},e.toDisplayString(d),9,pp)),64))],32),l[15]||(l[15]=e.createElementVNode("span",null,"筆",-1))])])])):e.createCommentVNode("",!0)}},fp={class:"block"},Np={class:"mt-4"},Ep={class:"table align-middle gray-table side-table"},bp={key:0},gp={key:1,class:"text-light-gray"},yp={class:"mt-4"},kp={class:"table align-middle gray-table side-table"},up={class:"row g-3"},hp={class:"col-12 col-xl-2"},xp={class:"text-gray mb-2"},$p={class:"col-12 col-xl-3"},Bp={class:"text-gray mb-2"},_p={class:"col-12 col-xl-4"},Cp={class:"row g-1"},Tp={class:"col-7"},wp={class:"col-5"},Sp={class:"col-12 col-xl-3"},Dp={class:"text-gray mb-2"},Ap={class:"col-12"},Fp={class:"text-gray mb-2"},Up={class:"mt-4"},Pp={class:"table align-middle gray-table side-table"},Mp={class:"mt-4"},Ip={class:"table align-middle gray-table side-table"},jp={key:0,class:"table-responsive mt-3 mb-0"},Op={class:"table align-middle gray-table"},Lp={key:0},Rp={key:0},qp={class:"d-flex gap-2"},zp=["onClick"],Gp={class:"mt-4"},Jp={class:"table align-middle gray-table side-table"},Yp={key:0,class:"block-bottom bg-light-teal"},Qp={__name:"Application",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.ref(),N=e.computed(()=>z("literacy",d.value.Status,1)),n=e.ref({}),o=e.ref([]),l=e.computed(()=>b.value.filter(E=>!E.Deleted)),d=e.ref({}),b=e.ref([]),k=e.computed({get:()=>!!l.value.length,set:E=>{E?_():b.value.forEach(s=>s.Deleted=!0)}}),_=()=>b.value.push({}),h=x,V=()=>{A.literacy("getApplication",{Apply:g.apply?"true":"false",ID:g.id}).subscribe(E=>{d.value=E.Project,i.value=E.Contacts,b.value=E.PreviousStudies,j().init("literacy",d.value),m.value=d.value.changeApply,d.value.changeApply=void 0})},c=E=>E.Deleted=!0,a=E=>{var f,r;if(n.value={},E&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const s={Project:d.value,Contacts:i.value,PreviousStudies:b.value.filter(t=>t.ID||!t.Deleted),Before:(f=m.value)==null?void 0:f.Form1Before,After:(r=m.value)==null?void 0:r.Form1After,Submit:E?"true":"false"};A.literacy("saveApplication",s).subscribe(t=>{E?h("next",t.ID):d.value.ID?V():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let E={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return n.value=M(d.value,E),E={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},i.value.forEach((s,f)=>Object.assign(n.value,M(s,E,`contact-${f}-`))),E={Title:"研習/課程名稱",TheDate:"辦理日期"},b.value.forEach((s,f)=>Object.assign(n.value,M(s,E,`study-${f}-`))),m.value&&(E={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(n.value,M(m.value,E))),!Object.keys(n.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(E=>{o.value=E[0],g.id?V():A.literacy("getEmptyApplication").subscribe(s=>{d.value=Object.assign({Field:null,FormStep:1,Status:1},s),i.value=[{Role:"申請人"}],j().init("literacy",d.value)})})}),e.provide("editable",N),e.watch(()=>[d.value.Field,d.value.OrgName],()=>{var E;if(N.value){const s=[];d.value.Field&&s.push((E=o.value.find(f=>f.Code===d.value.Field))==null?void 0:E.Descname),d.value.OrgName&&s.push(d.value.OrgName),d.value.ProjectName=s.join("-")}}),(E,s)=>{const f=e.resolveComponent("required-label"),r=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),p=e.resolveComponent("input-textarea"),y=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fp,[s[40]||(s[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Np,[e.createElementVNode("table",Ep,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[14]||(s[14]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[s[15]||(s[15]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",bp,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",gp,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[s[16]||(s[16]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[17]||(s[17]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{disabled:"",modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":s[0]||(s[0]=C=>e.unref(d).ProjectName=C),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[18]||(s[18]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(n).Field,options:e.unref(o),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).Field,"onUpdate:modelValue":s[1]||(s[1]=C=>e.unref(d).Field=C)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[19]||(s[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(n).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":s[2]||(s[2]=C=>e.unref(d).OrgName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[20]||(s[20]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(n).OrgLeader,modelValue:e.unref(d).OrgLeader,"onUpdate:modelValue":s[3]||(s[3]=C=>e.unref(d).OrgLeader=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[21]||(s[21]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(n).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":s[4]||(s[4]=C=>e.unref(d).Address=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),s[41]||(s[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",yp,[e.createElementVNode("table",kp,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(C,w)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",up,[e.createElementVNode("div",hp,[e.createElementVNode("div",xp,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[22]||(s[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(n)[`contact-${w}-Name`],modelValue:C.Name,"onUpdate:modelValue":P=>C.Name=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",$p,[e.createElementVNode("div",Bp,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[23]||(s[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(n)[`contact-${w}-JobTitle`],modelValue:C.JobTitle,"onUpdate:modelValue":P=>C.JobTitle=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",_p,[s[24]||(s[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Cp,[e.createElementVNode("div",Tp,[e.createVNode(r,{modelValue:C.Phone,"onUpdate:modelValue":P=>C.Phone=P,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",wp,[e.createVNode(r,{placeholder:"請輸入分機",size:"4",modelValue:C.PhoneExt,"onUpdate:modelValue":P=>C.PhoneExt=P,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Sp,[e.createElementVNode("div",Dp,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[25]||(s[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(n)[`contact-${w}-MobilePhone`],modelValue:C.MobilePhone,"onUpdate:modelValue":P=>C.MobilePhone=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ap,[e.createElementVNode("div",Fp,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[26]||(s[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(r,{error:e.unref(n)[`contact-${w}-EMail`],modelValue:C.EMail,"onUpdate:modelValue":P=>C.EMail=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),s[42]||(s[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Up,[e.createElementVNode("table",Pp,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[27]||(s[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[s[28]||(s[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(p,{error:e.unref(n).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":s[5]||(s[5]=C=>e.unref(d).Target=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[29]||(s[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(n).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":s[6]||(s[6]=C=>e.unref(d).Summary=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[30]||(s[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(n).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":s[7]||(s[7]=C=>e.unref(d).Quantified=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[31]||(s[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(n).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":s[8]||(s[8]=C=>e.unref(d).Qualitative=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Mp,[e.createElementVNode("table",Ip,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[36]||(s[36]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(k),"onUpdate:modelValue":s[9]||(s[9]=C=>e.isRef(k)?k.value=C:null)},null,8,["modelValue"]),e.unref(k)?(e.openBlock(),e.createElementBlock("div",jp,[e.createElementVNode("table",Op,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[s[32]||(s[32]=e.createElementVNode("th",null,"研習/課程名稱",-1)),s[33]||(s[33]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Lp,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,w)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(r,{error:e.unref(n)[`study-${w}-Title`],modelValue:C.Title,"onUpdate:modelValue":P=>C.Title=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(n)[`study-${w}-TheDate`],modelValue:C.TheDate,"onUpdate:modelValue":P=>C.TheDate=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Rp,[e.createElementVNode("div",qp,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>c(C),type:"button"},[...s[34]||(s[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,zp)):e.createCommentVNode("",!0),w+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:_,type:"button"},[...s[35]||(s[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[s[39]||(s[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Gp,[e.createElementVNode("table",Jp,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[37]||(s[37]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(n).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":s[10]||(s[10]=C=>e.unref(m).Form1Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[38]||(s[38]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(n).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":s[11]||(s[11]=C=>e.unref(m).Form1After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",Yp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[12]||(s[12]=C=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[13]||(s[13]=C=>a(!0)),type:"button"},[...s[43]||(s[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Hp={class:"block"},Wp={key:0,class:"text-pink lh-base mt-4"},Kp={class:"mt-4"},Xp={class:"table align-middle gray-table"},Zp={class:"text-center"},vp={key:0,width:"180"},eV={class:"text-center"},tV={key:0},lV=["innerHTML"],oV=["href"],nV={key:0,class:"text-center"},rV={key:0},aV={key:1,class:"text-pink"},sV={key:1,class:"tag-group mt-2 gap-1"},dV={key:0,class:"tag tag-green-light"},cV=["download","href"],iV=["onClick"],mV={key:1,class:"text-center mt-4"},pV={class:"mt-4"},VV={class:"table align-middle gray-table side-table"},fV={key:0,class:"block-bottom bg-light-teal"},NV=["disabled"],EV={__name:"Attachment",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([{Type:1,Title:"申請表",Template:`../../Service/OFS/DownloadTemplateLIT.ashx?type=1&id=${g.id}`,Files:[]},{Type:2,Title:"計畫書",Template:`../../Service/OFS/DownloadTemplateLIT.ashx?type=2&id=${g.id}`,Files:[]},{Type:3,Title:"執行承諾書",Template:`../../Service/OFS/DownloadTemplateLIT.ashx?type=3&id=${g.id}`,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:`../../Service/OFS/DownloadTemplateLIT.ashx?type=4&id=${g.id}`,Files:[]},{Type:5,Title:"著作權授權同意書",Template:`../../Service/OFS/DownloadTemplateLIT.ashx?type=5&id=${g.id}`,Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),m=e.ref(),N=e.computed(()=>i.value.some(c=>!c.Optional&&!c.Files.filter(a=>!a.Deleted).length)),n=e.computed(()=>z("literacy",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,a)=>{a.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:a.Path,Name:l.value.ProjectID+"_"+(c.Multiple?a.Name:`${c.Title}.pdf`)})},b=A.download,k=x,_=()=>{rxjs.forkJoin([A.literacy("getAttachment",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=i.value.filter(u=>{var E;return!((E=u.Excludes)!=null&&E.includes(l.value.OrgCategory))}),i.value.forEach(u=>{u.Files=a.Attachments.filter(E=>E.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(E=>!E.Deleted).length)}),j().init("literacy",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},h=c=>{var u,E;if(o.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={ID:g.id,Attachments:i.value.reduce((s,f)=>s.concat(f.Files),[]),Before:(u=m.value)==null?void 0:u.Form5Before,After:(E=m.value)==null?void 0:E.Form5After,Submit:c?"true":"false"};A.literacy("saveAttachment",a).subscribe(()=>{c?k("next"):_()})},V=()=>{if(m.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,M(m.value,c))}return!Object.keys(o.value).length};return e.onMounted(_),e.provide("editable",n),(c,a)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file"),s=e.resolveComponent("tw-date-time"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Hp,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("p",Wp,[...a[4]||(a[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Kp,[e.createElementVNode("table",Xp,[e.createElementVNode("thead",Zp,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",vp,"狀態")):e.createCommentVNode("",!0),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(r,t)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",eV,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[r.Optional?(e.openBlock(),e.createElementBlock("span",tV,e.toDisplayString(r.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.Title),1)]),_:2},1024))]),e.unref(n)&&r.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:r.Comment},null,8,lV)):e.createCommentVNode("",!0),e.unref(n)&&r.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",download:"",href:r.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,oV)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",nV,[r.Uploaded?(e.openBlock(),e.createElementBlock("span",rV,"已上傳")):(e.openBlock(),e.createElementBlock("span",aV,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&(r.Multiple||!r.Uploaded)?(e.openBlock(),e.createBlock(E,{key:0,accept:".pdf",onFile:p=>d(r,p)},null,8,["onFile"])):e.createCommentVNode("",!0),r.Uploaded?(e.openBlock(),e.createElementBlock("div",sV,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.Files,p=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:p},[p.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",dV,[e.createElementVNode("a",{class:"tag-link my-1",download:p.Name,href:e.unref(b)(p.Path)},e.toDisplayString(p.Name),9,cV),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>p.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,iV)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(l).ApplyTime?(e.openBlock(),e.createElementBlock("div",mV,[a[10]||(a[10]=e.createTextVNode("申請送件時間：",-1)),e.createVNode(s,{value:e.unref(l).ApplyTime},null,8,["value"])])):e.createCommentVNode("",!0),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",pV,[e.createElementVNode("table",VV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(m).Form5Before=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(m).Form5After=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",fV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[2]||(a[2]=r=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[3]||(a[3]=r=>h(!0)),disabled:e.unref(N),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,NV)])):e.createCommentVNode("",!0)],64)}}},bV={class:"block"},gV={class:"mt-4"},yV={class:"table-responsive mt-3 mb-0"},kV={class:"table align-middle gray-table"},uV={key:0,width:"1"},hV={key:0},xV={class:"d-flex gap-2"},$V=["onClick"],BV={class:"table-responsive mt-3 mb-0"},_V={class:"table align-middle gray-table"},CV={class:"mt-4"},TV={class:"table align-middle gray-table side-table"},wV={key:0,class:"block-bottom bg-light-teal"},SV={__name:"Benefit",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.computed(()=>z("literacy",l.value.Status,4)),n=e.ref({}),o=e.computed(()=>i.value.filter(c=>!c.Deleted)),l=e.ref({}),d=()=>i.value.push({}),b=x,k=()=>{rxjs.forkJoin([A.literacy("getBenefit",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=a.Benefits,i.value.length||d(),j().init("literacy",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},_=c=>c.Deleted=!0,h=c=>{var u,E;if(n.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={Project:l.value,Benefits:i.value,Before:(u=m.value)==null?void 0:u.Form4Before,After:(E=m.value)==null?void 0:E.Form4After,Submit:c?"true":"false"};A.literacy("saveBenefit",a).subscribe(()=>{c?b("next"):k()})},V=()=>{let c={Benefit:"不可量化成果"};return n.value=M(l.value,c),c={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((a,u)=>Object.assign(n.value,M(a,c,`item-${u}-`))),m.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(n.value,M(m.value,c))),!Object.keys(n.value).length};return e.onMounted(k),e.provide("editable",N),(c,a)=>{const u=e.resolveComponent("input-text"),E=e.resolveComponent("input-textarea"),s=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",bV,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",gV,[e.createElementVNode("div",yV,[e.createElementVNode("table",kV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"目標值",-1)),a[7]||(a[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",uV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(f,r)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(n)[`item-${r}-Title`],modelValue:f.Title,"onUpdate:modelValue":t=>f.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(n)[`item-${r}-Target`],modelValue:f.Target,"onUpdate:modelValue":t=>f.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n)[`item-${r}-Description`],rows:"1",modelValue:f.Description,"onUpdate:modelValue":t=>f.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",hV,[e.createElementVNode("div",xV,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>_(f),type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,$V)):e.createCommentVNode("",!0),r+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",BV,[e.createElementVNode("table",_V,[a[10]||(a[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":a[0]||(a[0]=f=>e.unref(l).Benefit=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",CV,[e.createElementVNode("table",TV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":a[1]||(a[1]=f=>e.unref(m).Form4Before=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":a[2]||(a[2]=f=>e.unref(m).Form4After=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",wV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[3]||(a[3]=f=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[4]||(a[4]=f=>h(!0)),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},DV={class:"block"},AV={class:"mt-4"},FV={class:"table-responsive mt-3 mb-0"},UV={class:"table align-middle gray-table"},PV={class:"text-end"},MV={class:"text-end"},IV={class:"table-responsive"},jV={class:"table align-middle gray-table"},OV=["colspan"],LV={key:0,width:"1"},RV={class:"text-end"},qV={key:0},zV={class:"d-flex gap-2"},GV=["onClick"],JV={class:"mt-4"},YV={class:"table-responsive mt-3 mb-0"},QV={class:"table align-middle gray-table"},HV={key:0,width:"1"},WV={class:"text-end"},KV={key:0},XV={class:"d-flex gap-2"},ZV=["onClick"],vV={class:"mt-4"},ef={class:"table align-middle gray-table side-table"},tf={key:0,class:"block-bottom bg-light-teal"},lf={class:"text-center"},of={class:"mb-5"},nf={__name:"Funding",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.computed(()=>z("literacy",l.value.Status,3)),N=e.ref({}),n=e.computed(()=>b.value.filter(r=>!r.Deleted)),o=e.computed(()=>k.value.filter(r=>!r.Deleted)),l=e.ref({}),d=e.ref(),b=e.ref([]),k=e.ref([]),_=e.ref({}),h=e.ref(0),V=()=>b.value.push({}),c=()=>k.value.push({}),a=x,u=()=>{rxjs.forkJoin([A.literacy("getFunding",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(r=>{const t=r[0];l.value=t.Project,b.value=t.OtherSubsidies,k.value=t.BudgetPlans,_.value=t.GrantTargetSetting,k.value.length||c(),j().init("literacy",l.value),i.value=l.value.changeApply,l.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=(r,t)=>{var y,S;if(N.value={},r&&!f()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>_.value.GrantLimit*1e4){d.value.show(()=>s(r,!0));return}const p={Project:l.value,OtherSubsidies:b.value,BudgetPlans:k.value,Before:(y=i.value)==null?void 0:y.Form3Before,After:(S=i.value)==null?void 0:S.Form3After,Submit:r?"true":"false"};A.literacy("saveFunding",p).subscribe(()=>{r?a("next"):u()})},f=()=>{let r={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=M(l.value,r),r={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},n.value.forEach((t,p)=>Object.assign(N.value,M(t,r,`other-${p}-`))),r={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},o.value.forEach((t,p)=>Object.assign(N.value,M(t,r,`plan-${p}-`))),i.value&&(r={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,M(i.value,r))),!Object.keys(N.value).length};return e.onMounted(u),e.provide("editable",m),e.watchEffect(()=>{l.value.OtherAmount=n.value.reduce((r,t)=>r+q(t.Amount),0),h.value=q(l.value.ApplyAmount)+q(l.value.SelfAmount)+q(l.value.OtherAmount),n.value.forEach(r=>r.percent=Math.round(q(r.Amount)/l.value.OtherAmount*1e4)/100),k.value.forEach(r=>r.sum=q(r.Amount)+q(r.OtherAmount))}),(r,t)=>{var P;const p=e.resolveComponent("input-integer"),y=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),C=e.resolveComponent("required-label"),w=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",DV,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",AV,[e.createElementVNode("div",FV,[e.createElementVNode("table",UV,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額(元) (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款(元) (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額(元) (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費(元) (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(l).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(l).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",PV,e.toDisplayString((P=e.unref(l).OtherAmount)==null?void 0:P.toLocaleString()),1),e.createElementVNode("td",MV,e.toDisplayString(e.unref(h).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",IV,[e.createElementVNode("table",jV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,OV)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額(元)（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",LV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(F,T)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(T+1),1),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(N)[`other-${T}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":D=>F.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`other-${T}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":D=>F.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",RV,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`other-${T}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":D=>F.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",qV,[e.createElementVNode("div",zV,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:D=>E(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,GV)])])):e.createCommentVNode("",!0)]))),128))])]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增",-1)])])):e.createCommentVNode("",!0)])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",JV,[e.createElementVNode("div",YV,[e.createElementVNode("table",QV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("小計")],-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",HV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(F,T)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(N)[`plan-${T}-Title`],modelValue:F.Title,"onUpdate:modelValue":D=>F.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`plan-${T}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":D=>F.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`plan-${T}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":D=>F.OtherAmount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",WV,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`plan-${T}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":D=>F.Description=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",KV,[e.createElementVNode("div",XV,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>E(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ZV)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",vV,[e.createElementVNode("table",ef,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(i).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(i).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(i).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(i).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",tf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>s(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(w,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",lf,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",of,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(_).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},rf={class:"block"},af={class:"square-title"},sf={class:"text-teal fw-bold py-3"},df={class:"table-responsive mb-0"},cf={class:"table align-middle gray-table"},mf={class:"text-end"},pf={class:"text-teal fw-bold pb-3"},Vf={class:"text-teal fw-bold pb-3"},ff={class:"mt-4"},Nf={class:"table align-middle gray-table"},Ef={class:"text-center"},bf={key:0,width:"180"},gf={class:"text-center"},yf=["href"],kf={key:0,class:"text-center"},uf={key:0},hf={key:1,class:"text-pink"},xf={key:1,class:"tag-group mt-2 gap-1"},$f={key:0,class:"tag tag-green-light"},Bf=["download","href"],_f=["onClick"],Cf={class:"block-bottom bg-light-teal"},Tf=["disabled"],wf={__name:"Payment1",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.computed(()=>l.value.some(V=>!V.Files.filter(c=>!c.Deleted).length)),m=e.computed(()=>!n.value||n.value.Status==="請款中"),N=e.computed(()=>{var V;return((V=n.value)==null?void 0:V.Status)==="通過"}),n=e.ref(),o=e.ref({}),l=e.ref([{Type:11,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]}]),d=(V,c)=>{c.Type==="application/pdf"&&V.Files.push({Type:V.Type,Path:c.Path,Name:`${o.value.ProjectID}_請款_${V.Title}.pdf`})},b=A.download,k=x,_=()=>{A.literacy("getPayment",{ID:g.id}).subscribe(V=>{o.value=V.Project,j().init("literacy",o.value),l.value=l.value.filter(c=>{var a;return!((a=c.Excludes)!=null&&a.includes(o.value.OrgCategory))}),l.value.forEach(c=>{c.Files=V.Attachments.filter(a=>a.Type===c.Type),c.Uploaded=e.computed(()=>c.Files.filter(a=>!a.Deleted).length)}),n.value=V.Payments.find(c=>c.Stage===1),Y().init(n.value)})},h=V=>{const c={Payment:{ProjectID:g.id,Stage:1,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,CurrentRequestAmount:o.value.ApprovedAmount},Attachments:l.value.reduce((a,u)=>a.concat(u.Files),[]),Submit:V?"true":"false"};A.literacy("savePayment",c).subscribe(()=>{V?k("next"):_()})};return e.onMounted(_),e.provide("editable",m),(V,c)=>{var E;const a=e.resolveComponent("required-label"),u=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",rf,[e.createElementVNode("h5",af,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",sf,"核定經費: "+e.toDisplayString((E=e.unref(o).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("div",df,[e.createElementVNode("table",cf,[c[6]||(c[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",mf,e.toDisplayString(e.unref(o).ApprovedAmount),1),c[2]||(c[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[3]||(c[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[4]||(c[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[5]||(c[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",pf,"本期實際撥款: "+e.toDisplayString(e.unref(n).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",Vf,"累積實際撥款: "+e.toDisplayString(e.unref(n).CurrentActualPaidAmount.toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),c[13]||(c[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",ff,[e.createElementVNode("table",Nf,[e.createElementVNode("thead",Ef,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),c[8]||(c[8]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",bf,"狀態")):e.createCommentVNode("",!0),c[9]||(c[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(s,f)=>(e.openBlock(),e.createElementBlock("tr",{key:s},[e.createElementVNode("td",gf,e.toDisplayString(f+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(s.Title),1)]),_:2},1024)]),e.unref(m)&&s.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:s.Template,style:{width:"140px"},type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,yf)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",kf,[s.Uploaded?(e.openBlock(),e.createElementBlock("span",uf,"已上傳")):(e.openBlock(),e.createElementBlock("span",hf,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(m)&&!s.Uploaded?(e.openBlock(),e.createBlock(u,{key:0,accept:".pdf",onFile:r=>d(s,r)},null,8,["onFile"])):e.createCommentVNode("",!0),s.Uploaded?(e.openBlock(),e.createElementBlock("div",xf,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.Files,r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",$f,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(b)(r.Path)},e.toDisplayString(r.Name),9,Bf),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>r.Deleted=!0,type:"button"},[...c[11]||(c[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,_f)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Cf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[0]||(c[0]=s=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[1]||(c[1]=s=>h(!0)),disabled:e.unref(i),type:"button"},[...c[14]||(c[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Tf)])],64)}}},Sf={class:"block"},Df={class:"square-title"},Af={class:"text-teal fw-bold py-3"},Ff={class:"text-teal fw-bold pb-3"},Uf={class:"table-responsive"},Pf={class:"table align-middle gray-table"},Mf={class:"text-end"},If={class:"text-end"},jf={class:"text-end"},Of={class:"mt-4"},Lf={class:"table align-middle gray-table"},Rf={class:"text-center"},qf={key:0,width:"180"},zf={class:"text-center"},Gf=["href"],Jf={key:0,class:"text-center"},Yf={key:0},Qf={key:1,class:"text-pink"},Hf={key:1,class:"tag-group mt-2 gap-1"},Wf={key:0,class:"tag tag-green-light"},Kf=["download","href"],Xf=["onClick"],Zf={class:"block-bottom bg-light-teal"},vf=["disabled"],eN={__name:"Payment2",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>i.value<=0||_.value.some(E=>!E.Files.filter(s=>!s.Deleted).length)),N=e.computed(()=>!o.value||o.value.Status==="請款中"),n=e.ref(0),o=e.ref(),l=e.ref(0),d=e.ref({}),b=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(i.value*100/d.value.ApprovedAmount*100)/100,100):0),k=e.computed(()=>l.value?Math.round(i.value*100/l.value*100)/100:0),_=e.ref([{Type:21,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]},{Type:22,Title:"經費收支明細表",Template:"../../Template/LIT/2-經費收支明細表.docx",Files:[]},{Type:23,Title:"經費分攤表",Template:"../../Template/LIT/3-經費分攤表.docx",Files:[]},{Type:24,Title:"補助清單",Template:"../../Template/LIT/4-補助清單.docx",Files:[]}]),h=(E,s)=>{s.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:s.Path,Name:`${d.value.ProjectID}_結案核銷_${E.Title}.pdf`})},V=A.download,c=x,a=()=>{A.literacy("getPayment",{ID:g.id}).subscribe(E=>{d.value=E.Project,j().init("literacy",d.value),_.value=_.value.filter(s=>{var f;return!((f=s.Excludes)!=null&&f.includes(d.value.OrgCategory))}),_.value.forEach(s=>{s.Files=E.Attachments.filter(f=>f.Type===s.Type),s.Uploaded=e.computed(()=>s.Files.filter(f=>!f.Deleted).length)}),o.value=E.Payments.find(s=>s.Stage===2),o.value&&(i.value=o.value.TotalSpentAmount),l.value=E.Payments.filter(s=>s.Stage<2&&s.Status==="通過").reduce((s,f)=>s+f.CurrentActualPaidAmount,0),n.value=l.value,Y().init(o.value,l.value)})},u=E=>{const s={Payment:{ProjectID:g.id,Stage:2,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:_.value.reduce((f,r)=>f.concat(r.Files),[]),Submit:E?"true":"false"};A.literacy("savePayment",s).subscribe(()=>{E?c("next"):a()})};return e.onMounted(a),e.provide("editable",N),(E,s)=>{var p;const f=e.resolveComponent("input-integer"),r=e.resolveComponent("required-label"),t=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Sf,[e.createElementVNode("h5",Df,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",Af,"核定經費: "+e.toDisplayString((p=e.unref(d).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("p",Ff,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(i)).toLocaleString())+"元",1),e.createElementVNode("div",Uf,[e.createElementVNode("table",Pf,[s[4]||(s[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",Mf,e.toDisplayString(e.unref(l)),1),e.createElementVNode("td",null,[e.createVNode(f,{max:e.unref(n),modelValue:e.unref(i),"onUpdate:modelValue":s[0]||(s[0]=y=>e.isRef(i)?i.value=y:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",If,e.toDisplayString(e.unref(b))+"%",1),e.createElementVNode("td",jf,e.toDisplayString(e.unref(k))+"%",1)])])])]),s[10]||(s[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),s[11]||(s[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Of,[e.createElementVNode("table",Lf,[e.createElementVNode("thead",Rf,[e.createElementVNode("tr",null,[s[5]||(s[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[6]||(s[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",qf,"狀態")):e.createCommentVNode("",!0),s[7]||(s[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),(y,S)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",zf,e.toDisplayString(S+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Title),1)]),_:2},1024)]),e.unref(N)&&y.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:y.Template,style:{width:"140px"},type:"button"},[...s[8]||(s[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Gf)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Jf,[y.Uploaded?(e.openBlock(),e.createElementBlock("span",Yf,"已上傳")):(e.openBlock(),e.createElementBlock("span",Qf,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!y.Uploaded?(e.openBlock(),e.createBlock(t,{key:0,accept:".pdf",onFile:C=>h(y,C)},null,8,["onFile"])):e.createCommentVNode("",!0),y.Uploaded?(e.openBlock(),e.createElementBlock("div",Hf,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.Files,C=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:C},[C.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Wf,[e.createElementVNode("a",{class:"tag-link my-1",download:C.Name,href:e.unref(V)(C.Path)},e.toDisplayString(C.Name),9,Kf),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:w=>C.Deleted=!0,type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xf)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Zf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[1]||(s[1]=y=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[2]||(s[2]=y=>u(!0)),disabled:e.unref(m),type:"button"},[...s[12]||(s[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,vf)])],64)}}},tN={__name:"ProgressBar",setup(B){const x=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(g,i)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:x,type:"literacy"})}}},lN={class:"block"},oN={class:"mt-4"},nN={class:"table align-middle gray-table side-table"},rN={key:0,class:"d-flex align-items-center gap-2"},aN={class:"input-group w-auto"},sN={class:"text-teal-dark"},dN={key:1,class:"invalid mt-0"},cN={class:"table-responsive mt-4"},iN={class:"table align-middle gray-table"},mN={key:0},pN={class:"input-group"},VN={key:0,class:"invalid mt-0"},fN={key:0},NN={class:"d-flex gap-2"},EN=["onClick"],bN={class:"mt-4"},gN={class:"table align-middle gray-table"},yN={key:0},kN=["value"],uN={key:0},hN={class:"d-flex gap-2"},xN=["onClick"],$N={class:"mt-4"},BN={class:"table align-middle gray-table side-table"},_N={key:0,class:"block-bottom bg-light-teal"},CN={__name:"WorkSchedule",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=[{value:1,text:"50%"},{value:2,text:"100%"}],m=e.ref(),N=e.computed(()=>k.value.EndDate),n=e.computed(()=>z("literacy",b.value.Status,2)),o=e.ref({}),l=e.computed(()=>_.value.filter(r=>!r.Deleted)),d=e.computed(()=>h.value.filter(r=>!r.Deleted)),b=e.ref({}),k=e.ref({}),_=e.ref([]),h=e.ref([]),V=()=>A.literacy("createItem",{ID:g.id}).subscribe(r=>_.value.push(r)),c=()=>h.value.push({Type:0,ItemID:0}),a=x,u=()=>{rxjs.forkJoin([A.literacy("getWorkSchedule",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(r=>{const t=r[0];b.value=t.Project,k.value=t.GrantType,_.value=t.Items,h.value=t.Schedules,_.value.length||V(),h.value.length||c(),j().init("literacy",b.value),m.value=b.value.changeApply,b.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=r=>{var p,y;if(o.value={},r&&!f()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:b.value,Items:_.value,Schedules:h.value,Before:(p=m.value)==null?void 0:p.Form2Before,After:(y=m.value)==null?void 0:y.Form2After,Submit:r?"true":"false"};A.literacy("saveWorkSchedule",t).subscribe(()=>{r?a("next"):u()})},f=()=>{let r={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=M(b.value,r),r={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`item-${p}-`))),r={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`schedule-${p}-`))),m.value&&(r={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,M(m.value,r))),!Object.keys(o.value).length};return e.onMounted(u),e.provide("editable",n),(r,t)=>{const p=e.resolveComponent("required-label"),y=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),C=e.resolveComponent("input-text"),w=e.resolveComponent("input-month"),P=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",lN,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",oN,[e.createElementVNode("table",nN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",rN,[e.createElementVNode("div",aN,[e.createVNode(y,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(b).StartTime,"onUpdate:modelValue":t[0]||(t[0]=T=>e.unref(b).StartTime=T)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(y,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(b).EndTime,"onUpdate:modelValue":t[1]||(t[1]=T=>e.unref(b).EndTime=T)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",sN,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(N)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",dN,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",cN,[e.createElementVNode("table",iN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(n)?(e.openBlock(),e.createElementBlock("th",mN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+D)),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(o)[`item-${D}-Title`],modelValue:T.Title,"onUpdate:modelValue":U=>T.Title=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",pN,[e.createVNode(w,{"empty-value":0,modelValue:T.Begin,"onUpdate:modelValue":U=>T.Begin=U},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(w,{"empty-value":0,modelValue:T.End,"onUpdate:modelValue":U=>T.End=U},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${D}-Begin`]||e.unref(o)[`item-${D}-End`]?(e.openBlock(),e.createElementBlock("div",VN,e.toDisplayString(e.unref(o)[`item-${D}-Begin`]||e.unref(o)[`item-${D}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`item-${D}-Deadline`],modelValue:T.Deadline,"onUpdate:modelValue":U=>T.Deadline=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`item-${D}-Content`],rows:"1",modelValue:T.Content,"onUpdate:modelValue":U=>T.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",fN,[e.createElementVNode("div",NN,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>E(T),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,EN)):e.createCommentVNode("",!0),D+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:V,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",bN,[e.createElementVNode("table",gN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(n)?(e.openBlock(),e.createElementBlock("th",yN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${D}-Type`],options:i,modelValue:T.Type,"onUpdate:modelValue":U=>T.Type=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${D}-ItemID`],options:e.unref(l),modelValue:T.ItemID,"onUpdate:modelValue":U=>T.ItemID=U,modelModifiers:{trim:!0}},{default:e.withCtx(({index:U,option:I})=>[e.createElementVNode("option",{value:I.ID},e.toDisplayString(String.fromCharCode(65+U))+"."+e.toDisplayString(I.Title),9,kN)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`schedule-${D}-Deadline`],modelValue:T.Deadline,"onUpdate:modelValue":U=>T.Deadline=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`schedule-${D}-Content`],rows:"1",modelValue:T.Content,"onUpdate:modelValue":U=>T.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",uN,[e.createElementVNode("div",hN,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>E(T),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,xN)):e.createCommentVNode("",!0),D+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$N,[e.createElementVNode("table",BN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=T=>e.unref(m).Form2Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":t[3]||(t[3]=T=>e.unref(m).Form2After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",_N,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=T=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=T=>s(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},TN={class:"block"},wN={class:"mt-4"},SN={class:"table align-middle gray-table side-table"},DN={key:0},AN={key:1,class:"text-light-gray"},FN={class:"mt-4"},UN={class:"table align-middle gray-table side-table"},PN={class:"row g-3"},MN={class:"col-12 col-xl-2"},IN={class:"text-gray mb-2"},jN={class:"col-12 col-xl-3"},ON={class:"text-gray mb-2"},LN={class:"col-12 col-xl-4"},RN={class:"row g-1"},qN={class:"col-7"},zN={class:"col-5"},GN={class:"col-12 col-xl-3"},JN={class:"text-gray mb-2"},YN={class:"col-12"},QN={class:"text-gray mb-2"},HN={class:"mt-4"},WN={class:"table align-middle gray-table side-table"},KN={class:"mt-4"},XN={class:"table align-middle gray-table side-table"},ZN={key:0,class:"table-responsive mt-3 mb-0"},vN={class:"table align-middle gray-table"},e1={key:0},t1={key:0},l1={class:"d-flex gap-2"},o1=["onClick"],n1={class:"mt-4"},r1={class:"table align-middle gray-table side-table"},a1={key:0,class:"block-bottom bg-light-teal"},s1={__name:"Application",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.ref(),n=e.computed(()=>z("multiple",b.value.Status,1)),o=e.ref({}),l=e.ref([]),d=e.computed(()=>k.value.filter(s=>!s.Deleted)),b=e.ref({}),k=e.ref([]),_=e.computed({get:()=>!!d.value.length,set:s=>{s?h():k.value.forEach(f=>f.Deleted=!0)}}),h=()=>k.value.push({}),V=x,c=()=>{A.multiple("getApplication",{Apply:g.apply?"true":"false",ID:g.id}).subscribe(s=>{b.value=s.Project,N.value=s.Contacts,k.value=s.ReceivedSubsidies,b.value.OrgCategory=b.value.OrgCategory||null,j().init("multiple",b.value),m.value=b.value.changeApply,b.value.changeApply=void 0})},a=s=>s.Deleted=!0,u=s=>{var r,t;if(o.value={},s&&!E()){e.nextTick(()=>{var p;return(p=document.querySelector(".invalid"))==null?void 0:p.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:b.value,Contacts:N.value,ReceivedSubsidies:k.value.filter(p=>p.ID||!p.Deleted),Before:(r=m.value)==null?void 0:r.Form1Before,After:(t=m.value)==null?void 0:t.Form1After,Submit:s?"true":"false"};A.multiple("saveApplication",f).subscribe(p=>{s?V("next",p.ID):b.value.ID?c():window.location.href=`Application.aspx?ID=${p.ID}`})},E=()=>{let s={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return o.value=M(b.value,s),s={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((f,r)=>Object.assign(o.value,M(f,s,`contact-${r}-`))),s={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},k.value.forEach((f,r)=>Object.assign(o.value,M(f,s,`received-${r}-`))),m.value&&(s={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,M(m.value,s))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.multiple("getZgsCodes",{CodeGroup:"MULField"}),A.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(s=>{l.value=s[0],i.value=s[1],g.id?c():A.multiple("getEmptyApplication").subscribe(f=>{b.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},f),N.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("multiple",b.value)})})}),e.provide("editable",n),(s,f)=>{const r=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),p=e.resolveComponent("input-select"),y=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-boolean"),C=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",TN,[f[43]||(f[43]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",wN,[e.createElementVNode("table",SN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[f[15]||(f[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(b).Year),1)]),e.createElementVNode("tr",null,[f[16]||(f[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(b).ProjectID?(e.openBlock(),e.createElementBlock("span",DN,e.toDisplayString(e.unref(b).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",AN,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[f[17]||(f[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(b).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[18]||(f[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).ProjectName,modelValue:e.unref(b).ProjectName,"onUpdate:modelValue":f[0]||(f[0]=w=>e.unref(b).ProjectName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[19]||(f[19]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{"empty-value":null,error:e.unref(o).Field,options:e.unref(l),"text-name":"Descname","value-name":"Code",modelValue:e.unref(b).Field,"onUpdate:modelValue":f[1]||(f[1]=w=>e.unref(b).Field=w)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[20]||(f[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(b).OrgName,"onUpdate:modelValue":f[2]||(f[2]=w=>e.unref(b).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[21]||(f[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(b).OrgCategory,"onUpdate:modelValue":f[3]||(f[3]=w=>e.unref(b).OrgCategory=w)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[22]||(f[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(b).TaxID,"onUpdate:modelValue":f[4]||(f[4]=w=>e.unref(b).TaxID=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[23]||(f[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(b).Address,"onUpdate:modelValue":f[5]||(f[5]=w=>e.unref(b).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),f[44]||(f[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",FN,[e.createElementVNode("table",UN,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(w,P)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",PN,[e.createElementVNode("div",MN,[e.createElementVNode("div",IN,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[24]||(f[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${P}-Name`],modelValue:w.Name,"onUpdate:modelValue":F=>w.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",jN,[e.createElementVNode("div",ON,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[25]||(f[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${P}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":F=>w.JobTitle=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",LN,[f[26]||(f[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",RN,[e.createElementVNode("div",qN,[e.createVNode(t,{modelValue:w.Phone,"onUpdate:modelValue":F=>w.Phone=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",zN,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":F=>w.PhoneExt=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",GN,[e.createElementVNode("div",JN,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[27]||(f[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${P}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":F=>w.MobilePhone=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",YN,[e.createElementVNode("div",QN,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[28]||(f[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${P}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":F=>w.EMail=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),f[45]||(f[45]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",HN,[e.createElementVNode("table",WN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[29]||(f[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[f[30]||(f[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(y,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(b).Target,"onUpdate:modelValue":f[6]||(f[6]=w=>e.unref(b).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[31]||(f[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(b).Summary,"onUpdate:modelValue":f[7]||(f[7]=w=>e.unref(b).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[32]||(f[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(b).Quantified,"onUpdate:modelValue":f[8]||(f[8]=w=>e.unref(b).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[33]||(f[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(b).Qualitative,"onUpdate:modelValue":f[9]||(f[9]=w=>e.unref(b).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",KN,[e.createElementVNode("table",XN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[f[39]||(f[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(S,{modelValue:e.unref(_),"onUpdate:modelValue":f[10]||(f[10]=w=>e.isRef(_)?_.value=w:null)},null,8,["modelValue"]),e.unref(_)?(e.openBlock(),e.createElementBlock("div",ZN,[e.createElementVNode("table",vN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[34]||(f[34]=e.createElementVNode("th",null,"計畫名稱",-1)),f[35]||(f[35]=e.createElementVNode("th",null,"補助單位",-1)),f[36]||(f[36]=e.createElementVNode("th",{class:"text-end"},"補助金額(元)",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",e1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(w,P)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o)[`received-${P}-Name`],modelValue:w.Name,"onUpdate:modelValue":F=>w.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o)[`received-${P}-Unit`],modelValue:w.Unit,"onUpdate:modelValue":F=>w.Unit=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(o)[`received-${P}-Amount`],modelValue:w.Amount,"onUpdate:modelValue":F=>w.Amount=F},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",t1,[e.createElementVNode("div",l1,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:F=>a(w),type:"button"},[...f[37]||(f[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,o1)):e.createCommentVNode("",!0),P+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...f[38]||(f[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[f[42]||(f[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",n1,[e.createElementVNode("table",r1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[40]||(f[40]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":f[11]||(f[11]=w=>e.unref(m).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...f[41]||(f[41]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":f[12]||(f[12]=w=>e.unref(m).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",a1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[13]||(f[13]=w=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[14]||(f[14]=w=>u(!0)),type:"button"},[...f[46]||(f[46]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},d1={class:"block"},c1={key:0,class:"text-pink lh-base mt-4"},i1={class:"mt-4"},m1={class:"table align-middle gray-table"},p1={class:"text-center"},V1={key:0,width:"180"},f1={class:"text-center"},N1={key:0},E1=["innerHTML"],b1=["href"],g1={key:0,class:"text-center"},y1={key:0},k1={key:1,class:"text-pink"},u1={key:1,class:"tag-group mt-2 gap-1"},h1={key:0,class:"tag tag-green-light"},x1=["download","href"],$1=["onClick"],B1={key:1,class:"text-center mt-4"},_1={class:"mt-4"},C1={class:"table align-middle gray-table side-table"},T1={key:0,class:"block-bottom bg-light-teal"},w1=["disabled"],S1={__name:"Attachment",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([{Type:1,Title:"申請表",Template:`../../Service/OFS/DownloadTemplateMUL.ashx?type=1&id=${g.id}`,Files:[]},{Type:2,Title:"計畫書",Template:`../../Service/OFS/DownloadTemplateMUL.ashx?type=2&id=${g.id}`,Files:[]},{Type:3,Title:"執行承諾書",Template:`../../Service/OFS/DownloadTemplateMUL.ashx?type=3&id=${g.id}`,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:`../../Service/OFS/DownloadTemplateMUL.ashx?type=4&id=${g.id}`,Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),m=e.ref(),N=e.computed(()=>i.value.some(c=>!c.Optional&&!c.Files.filter(a=>!a.Deleted).length)),n=e.computed(()=>z("multiple",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,a)=>{a.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:a.Path,Name:l.value.ProjectID+"_"+(c.Multiple?a.Name:`${c.Title}.pdf`)})},b=A.download,k=x,_=()=>{rxjs.forkJoin([A.multiple("getAttachment",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=i.value.filter(u=>{var E;return!((E=u.Excludes)!=null&&E.includes(l.value.OrgCategory))}),l.value.Status>=42&&i.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/MUL/6-著作權授權同意書.docx",Files:[]}),i.value.forEach(u=>{u.Files=a.Attachments.filter(E=>E.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(E=>!E.Deleted).length)}),j().init("multiple",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},h=c=>{var u,E;if(o.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={ID:g.id,Attachments:i.value.reduce((s,f)=>s.concat(f.Files),[]),Before:(u=m.value)==null?void 0:u.Form5Before,After:(E=m.value)==null?void 0:E.Form5After,Submit:c?"true":"false"};A.multiple("saveAttachment",a).subscribe(()=>{c?k("next"):_()})},V=()=>{if(m.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,M(m.value,c))}return!Object.keys(o.value).length};return e.onMounted(_),e.provide("editable",n),(c,a)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file"),s=e.resolveComponent("tw-date-time"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",d1,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("p",c1,[...a[4]||(a[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",i1,[e.createElementVNode("table",m1,[e.createElementVNode("thead",p1,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",V1,"狀態")):e.createCommentVNode("",!0),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(r,t)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",f1,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[r.Optional?(e.openBlock(),e.createElementBlock("span",N1,e.toDisplayString(r.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(r.Title),1)]),_:2},1024))]),e.unref(n)&&r.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:r.Comment},null,8,E1)):e.createCommentVNode("",!0),e.unref(n)&&r.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",download:"",href:r.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,b1)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",g1,[r.Uploaded?(e.openBlock(),e.createElementBlock("span",y1,"已上傳")):(e.openBlock(),e.createElementBlock("span",k1,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&(r.Multiple||!r.Uploaded)?(e.openBlock(),e.createBlock(E,{key:0,accept:".pdf",onFile:p=>d(r,p)},null,8,["onFile"])):e.createCommentVNode("",!0),r.Uploaded?(e.openBlock(),e.createElementBlock("div",u1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.Files,p=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:p},[p.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",h1,[e.createElementVNode("a",{class:"tag-link my-1",download:p.Name,href:e.unref(b)(p.Path)},e.toDisplayString(p.Name),9,x1),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>p.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,$1)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(l).ApplyTime?(e.openBlock(),e.createElementBlock("div",B1,[a[10]||(a[10]=e.createTextVNode("申請送件時間：",-1)),e.createVNode(s,{value:e.unref(l).ApplyTime},null,8,["value"])])):e.createCommentVNode("",!0),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_1,[e.createElementVNode("table",C1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":a[0]||(a[0]=r=>e.unref(m).Form5Before=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":a[1]||(a[1]=r=>e.unref(m).Form5After=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",T1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[2]||(a[2]=r=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[3]||(a[3]=r=>h(!0)),disabled:e.unref(N),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,w1)])):e.createCommentVNode("",!0)],64)}}},D1={class:"block"},A1={class:"mt-4"},F1={class:"table-responsive mt-3 mb-0"},U1={class:"table align-middle gray-table"},P1={key:0,width:"1"},M1={key:0},I1={class:"d-flex gap-2"},j1=["onClick"],O1={class:"table-responsive mt-3 mb-0"},L1={class:"table align-middle gray-table"},R1={class:"mt-4"},q1={class:"table align-middle gray-table side-table"},z1={key:0,class:"block-bottom bg-light-teal"},G1={__name:"Benefit",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=e.ref(),N=e.computed(()=>z("multiple",l.value.Status,4)),n=e.ref({}),o=e.computed(()=>i.value.filter(c=>!c.Deleted)),l=e.ref({}),d=()=>i.value.push({}),b=x,k=()=>{rxjs.forkJoin([A.multiple("getBenefit",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(c=>{const a=c[0];l.value=a.Project,i.value=a.Benefits,i.value.length||d(),j().init("multiple",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},_=c=>c.Deleted=!0,h=c=>{var u,E;if(n.value={},c&&!V()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={Project:l.value,Benefits:i.value,Before:(u=m.value)==null?void 0:u.Form4Before,After:(E=m.value)==null?void 0:E.Form4After,Submit:c?"true":"false"};A.multiple("saveBenefit",a).subscribe(()=>{c?b("next"):k()})},V=()=>{let c={Benefit:"不可量化成果"};return n.value=M(l.value,c),c={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((a,u)=>Object.assign(n.value,M(a,c,`item-${u}-`))),m.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(n.value,M(m.value,c))),!Object.keys(n.value).length};return e.onMounted(k),e.provide("editable",N),(c,a)=>{const u=e.resolveComponent("input-text"),E=e.resolveComponent("input-textarea"),s=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",D1,[a[14]||(a[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",A1,[e.createElementVNode("div",F1,[e.createElementVNode("table",U1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"目標值",-1)),a[7]||(a[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",P1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(f,r)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(n)[`item-${r}-Title`],modelValue:f.Title,"onUpdate:modelValue":t=>f.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(n)[`item-${r}-Target`],modelValue:f.Target,"onUpdate:modelValue":t=>f.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n)[`item-${r}-Description`],rows:"1",modelValue:f.Description,"onUpdate:modelValue":t=>f.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",M1,[e.createElementVNode("div",I1,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>_(f),type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,j1)):e.createCommentVNode("",!0),r+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",O1,[e.createElementVNode("table",L1,[a[10]||(a[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":a[0]||(a[0]=f=>e.unref(l).Benefit=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[a[13]||(a[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",R1,[e.createElementVNode("table",q1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...a[11]||(a[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":a[1]||(a[1]=f=>e.unref(m).Form4Before=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...a[12]||(a[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(n).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":a[2]||(a[2]=f=>e.unref(m).Form4After=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",z1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[3]||(a[3]=f=>h()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[4]||(a[4]=f=>h(!0)),type:"button"},[...a[15]||(a[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},J1={class:"block"},Y1={class:"mt-4"},Q1={class:"table-responsive mt-3 mb-0"},H1={class:"table align-middle gray-table"},W1={class:"text-end"},K1={class:"text-end"},X1={class:"table-responsive"},Z1={class:"table align-middle gray-table"},v1=["colspan"],eE={key:0,width:"1"},tE={class:"text-end"},lE={key:0},oE={class:"d-flex gap-2"},nE=["onClick"],rE={class:"mt-4"},aE={class:"table-responsive mt-3 mb-0"},sE={class:"table align-middle gray-table"},dE={key:0,width:"1"},cE={class:"text-end"},iE={key:0},mE={class:"d-flex gap-2"},pE=["onClick"],VE={class:"mt-4"},fE={class:"table align-middle gray-table side-table"},NE={key:0,class:"block-bottom bg-light-teal"},EE={class:"text-center"},bE={class:"mb-5"},gE={__name:"Funding",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(),m=e.computed(()=>z("multiple",l.value.Status,3)),N=e.ref({}),n=e.computed(()=>b.value.filter(r=>!r.Deleted)),o=e.computed(()=>k.value.filter(r=>!r.Deleted)),l=e.ref({}),d=e.ref(),b=e.ref([]),k=e.ref([]),_=e.ref({}),h=e.ref(0),V=()=>b.value.push({}),c=()=>k.value.push({}),a=x,u=()=>{rxjs.forkJoin([A.multiple("getFunding",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(r=>{const t=r[0];l.value=t.Project,b.value=t.OtherSubsidies,k.value=t.BudgetPlans,_.value=t.GrantTargetSetting,k.value.length||c(),j().init("multiple",l.value),i.value=l.value.changeApply,l.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=(r,t)=>{var y,S;if(N.value={},r&&!f()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>_.value.GrantLimit*1e4){d.value.show(()=>s(r,!0));return}const p={Project:l.value,OtherSubsidies:b.value,BudgetPlans:k.value,Before:(y=i.value)==null?void 0:y.Form3Before,After:(S=i.value)==null?void 0:S.Form3After,Submit:r?"true":"false"};A.multiple("saveFunding",p).subscribe(()=>{r?a("next"):u()})},f=()=>{let r={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=M(l.value,r),r={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},n.value.forEach((t,p)=>Object.assign(N.value,M(t,r,`other-${p}-`))),r={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},o.value.forEach((t,p)=>Object.assign(N.value,M(t,r,`plan-${p}-`))),i.value&&(r={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,M(i.value,r))),!Object.keys(N.value).length};return e.onMounted(u),e.provide("editable",m),e.watchEffect(()=>{l.value.OtherAmount=n.value.reduce((r,t)=>r+q(t.Amount),0),h.value=q(l.value.ApplyAmount)+q(l.value.SelfAmount)+q(l.value.OtherAmount),n.value.forEach(r=>r.percent=Math.round(q(r.Amount)/l.value.OtherAmount*1e4)/100),k.value.forEach(r=>r.sum=q(r.Amount)+q(r.OtherAmount))}),(r,t)=>{var P;const p=e.resolveComponent("input-integer"),y=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),C=e.resolveComponent("required-label"),w=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",J1,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Y1,[e.createElementVNode("div",Q1,[e.createElementVNode("table",H1,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額(元) (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款(元) (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額(元) (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費(元) (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(l).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(l).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",W1,e.toDisplayString((P=e.unref(l).OtherAmount)==null?void 0:P.toLocaleString()),1),e.createElementVNode("td",K1,e.toDisplayString(e.unref(h).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",X1,[e.createElementVNode("table",Z1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,v1)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額(元)（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",eE,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(F,T)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(T+1),1),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(N)[`other-${T}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":D=>F.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`other-${T}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":D=>F.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",tE,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`other-${T}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":D=>F.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",lE,[e.createElementVNode("div",oE,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:D=>E(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nE)])])):e.createCommentVNode("",!0)]))),128))])]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增",-1)])])):e.createCommentVNode("",!0)])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",rE,[e.createElementVNode("div",aE,[e.createElementVNode("table",sE,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額(元)"),e.createElementVNode("br"),e.createTextVNode("小計")],-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",dE,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(F,T)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(N)[`plan-${T}-Title`],modelValue:F.Title,"onUpdate:modelValue":D=>F.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`plan-${T}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":D=>F.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(N)[`plan-${T}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":D=>F.OtherAmount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",cE,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N)[`plan-${T}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":D=>F.Description=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",iE,[e.createElementVNode("div",mE,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>E(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pE)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(i)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",VE,[e.createElementVNode("table",fE,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(i).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(i).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(i).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(i).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",NE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>s(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(w,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",EE,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",bE,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(_).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},yE={class:"block"},kE={class:"square-title"},uE={class:"text-teal fw-bold py-3"},hE={class:"table-responsive mb-0"},xE={class:"table align-middle gray-table"},$E={class:"text-end"},BE={class:"text-teal fw-bold pb-3"},_E={class:"text-teal fw-bold pb-3"},CE={class:"mt-4"},TE={class:"table align-middle gray-table"},wE={class:"text-center"},SE={key:0,width:"180"},DE={class:"text-center"},AE=["href"],FE={key:0,class:"text-center"},UE={key:0},PE={key:1,class:"text-pink"},ME={key:1,class:"tag-group mt-2 gap-1"},IE={key:0,class:"tag tag-green-light"},jE=["download","href"],OE=["onClick"],LE={class:"block-bottom bg-light-teal"},RE=["disabled"],qE={__name:"Payment1",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>d.value.some(c=>!c.Files.filter(a=>!a.Deleted).length)),N=e.computed(()=>!o.value||o.value.Status==="請款中"),n=e.computed(()=>{var c;return((c=o.value)==null?void 0:c.Status)==="通過"}),o=e.ref(),l=e.ref({}),d=e.ref([{Type:11,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]}]),b=(c,a)=>{a.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:a.Path,Name:`${l.value.ProjectID}_第一期_${c.Title}.pdf`})},k=A.download,_=x,h=()=>{A.multiple("getPayment",{ID:g.id}).subscribe(c=>{l.value=c.Project,j().init("multiple",l.value),d.value=d.value.filter(a=>{var u;return!((u=a.Excludes)!=null&&u.includes(l.value.OrgCategory))}),d.value.forEach(a=>{a.Files=c.Attachments.filter(u=>u.Type===a.Type),a.Uploaded=e.computed(()=>a.Files.filter(u=>!u.Deleted).length)}),o.value=c.Payments.find(a=>a.Stage===1),o.value?i.value=o.value.CurrentRequestAmount:i.value=Math.round(l.value.ApprovedAmount*g.setting.DisbursementRatioPct/100),Y().init(o.value)})},V=c=>{const a={Payment:{ProjectID:g.id,Stage:1,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,CurrentRequestAmount:i.value},Attachments:d.value.reduce((u,E)=>u.concat(E.Files),[]),Submit:c?"true":"false"};A.multiple("savePayment",a).subscribe(()=>{c?_("next"):h()})};return e.onMounted(h),e.provide("editable",N),(c,a)=>{var s;const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yE,[e.createElementVNode("h5",kE,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",uE,"核定經費: "+e.toDisplayString((s=e.unref(l).ApprovedAmount)==null?void 0:s.toLocaleString())+"元",1),e.createElementVNode("div",hE,[e.createElementVNode("table",xE,[a[6]||(a[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",$E,e.toDisplayString(e.unref(i)),1),a[2]||(a[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),a[4]||(a[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),a[5]||(a[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",BE,"本期實際撥款: "+e.toDisplayString(e.unref(o).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",_E,"累積實際撥款: "+e.toDisplayString(e.unref(o).CurrentActualPaidAmount.toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),a[12]||(a[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[13]||(a[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",CE,[e.createElementVNode("table",TE,[e.createElementVNode("thead",wE,[e.createElementVNode("tr",null,[a[7]||(a[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[8]||(a[8]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",SE,"狀態")):e.createCommentVNode("",!0),a[9]||(a[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(f,r)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",DE,e.toDisplayString(r+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(f.Title),1)]),_:2},1024)]),e.unref(N)&&f.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:f.Template,style:{width:"140px"},type:"button"},[...a[10]||(a[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,AE)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",FE,[f.Uploaded?(e.openBlock(),e.createElementBlock("span",UE,"已上傳")):(e.openBlock(),e.createElementBlock("span",PE,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!f.Uploaded?(e.openBlock(),e.createBlock(E,{key:0,accept:".pdf",onFile:t=>b(f,t)},null,8,["onFile"])):e.createCommentVNode("",!0),f.Uploaded?(e.openBlock(),e.createElementBlock("div",ME,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",IE,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(k)(t.Path)},e.toDisplayString(t.Name),9,jE),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>t.Deleted=!0,type:"button"},[...a[11]||(a[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,OE)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",LE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[0]||(a[0]=f=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[1]||(a[1]=f=>V(!0)),disabled:e.unref(m),type:"button"},[...a[14]||(a[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,RE)])],64)}}},zE={class:"block"},GE={class:"square-title"},JE={class:"text-teal fw-bold py-3"},YE={class:"table-responsive mb-0"},QE={class:"table align-middle gray-table"},HE={class:"text-end"},WE={class:"text-end"},KE={class:"text-end"},XE={class:"text-end"},ZE={class:"text-teal fw-bold pb-3"},vE={class:"text-teal fw-bold pb-3"},eb={class:"mt-4"},tb={class:"table align-middle gray-table"},lb={class:"text-center"},ob={key:0,width:"180"},nb={class:"text-center"},rb=["href"],ab={key:0,class:"text-center"},sb={key:0},db={key:1,class:"text-pink"},cb={key:1,class:"tag-group mt-2 gap-1"},ib={key:0,class:"tag tag-green-light"},mb=["download","href"],pb=["onClick"],Vb={class:"block-bottom bg-light-teal"},fb=["disabled"],Nb={__name:"Payment2",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.ref(0),N=e.computed(()=>i.value<=0||a.value.some(t=>!t.Files.filter(p=>!p.Deleted).length)),n=e.computed(()=>!d.value||d.value.Status==="請款中"),o=e.computed(()=>{var t;return((t=d.value)==null?void 0:t.Status)==="通過"}),l=e.ref(0),d=e.ref(),b=e.ref(0),k=e.ref(0),_=e.ref({}),h=e.computed(()=>_.value.ApprovedAmount?Math.min(Math.round(i.value*100/_.value.ApprovedAmount*100)/100,100):0),V=e.computed(()=>c.value?Math.round(i.value*100/c.value*100)/100:0),c=e.computed(()=>k.value+(o.value?d.value.CurrentActualPaidAmount:0)),a=e.ref([{Type:21,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:22,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:23,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:24,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),u=(t,p)=>{p.Type==="application/pdf"&&t.Files.push({Type:t.Type,Path:p.Path,Name:`${_.value.ProjectID}_第二期_${t.Title}.pdf`})},E=A.download,s=x,f=()=>{A.multiple("getPayment",{ID:g.id}).subscribe(t=>{_.value=t.Project,j().init("multiple",_.value),a.value=a.value.filter(y=>{var S;return!((S=y.Excludes)!=null&&S.includes(_.value.OrgCategory))}),a.value.forEach(y=>{y.Files=t.Attachments.filter(S=>S.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(S=>!S.Deleted).length)}),d.value=t.Payments.find(y=>y.Stage===2),d.value?m.value=d.value.CurrentRequestAmount:m.value=Math.round(_.value.ApprovedAmount*g.setting.DisbursementRatioPct/100);const p=t.Payments.filter(y=>y.Stage<2&&y.Status==="通過");b.value=p.reduce((y,S)=>y+S.CurrentRequestAmount,0),k.value=p.reduce((y,S)=>y+S.CurrentActualPaidAmount,0),l.value=_.value.ApprovedAmount,Y().init(d.value,k.value)})},r=t=>{const p={Payment:{ProjectID:g.id,Stage:2,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,CurrentRequestAmount:m.value,TotalSpentAmount:i.value},Attachments:a.value.reduce((y,S)=>y.concat(S.Files),[]),Submit:t?"true":"false"};A.multiple("savePayment",p).subscribe(()=>{t?s("next"):f()})};return e.onMounted(f),e.provide("editable",n),(t,p)=>{var w;const y=e.resolveComponent("input-integer"),S=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zE,[e.createElementVNode("h5",GE,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",JE,"核定經費: "+e.toDisplayString((w=e.unref(_).ApprovedAmount)==null?void 0:w.toLocaleString())+"元",1),e.createElementVNode("div",YE,[e.createElementVNode("table",QE,[p[3]||(p[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",HE,e.toDisplayString(e.unref(m)),1),e.createElementVNode("td",WE,e.toDisplayString(e.unref(k)),1),e.createElementVNode("td",null,[e.createVNode(y,{max:e.unref(l),modelValue:e.unref(i),"onUpdate:modelValue":p[0]||(p[0]=P=>e.isRef(i)?i.value=P:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",KE,e.toDisplayString(e.unref(h))+"%",1),e.createElementVNode("td",XE,e.toDisplayString(e.unref(V))+"%",1)])])])]),e.unref(o)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("p",ZE,"本期實際撥款: "+e.toDisplayString(e.unref(d).CurrentActualPaidAmount.toLocaleString())+"元",1),e.createElementVNode("p",vE,"累積實際撥款: "+e.toDisplayString(e.unref(c).toLocaleString())+"元",1)],64)):e.createCommentVNode("",!0),p[9]||(p[9]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),p[10]||(p[10]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",eb,[e.createElementVNode("table",tb,[e.createElementVNode("thead",lb,[e.createElementVNode("tr",null,[p[4]||(p[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),p[5]||(p[5]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",ob,"狀態")):e.createCommentVNode("",!0),p[6]||(p[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(P,F)=>(e.openBlock(),e.createElementBlock("tr",{key:P},[e.createElementVNode("td",nb,e.toDisplayString(F+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(S,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(P.Title),1)]),_:2},1024)]),e.unref(n)&&P.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:P.Template,style:{width:"140px"},type:"button"},[...p[7]||(p[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,rb)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",ab,[P.Uploaded?(e.openBlock(),e.createElementBlock("span",sb,"已上傳")):(e.openBlock(),e.createElementBlock("span",db,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&!P.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:T=>u(P,T)},null,8,["onFile"])):e.createCommentVNode("",!0),P.Uploaded?(e.openBlock(),e.createElementBlock("div",cb,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Files,T=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:T},[T.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ib,[e.createElementVNode("a",{class:"tag-link my-1",download:T.Name,href:e.unref(E)(T.Path)},e.toDisplayString(T.Name),9,mb),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:D=>T.Deleted=!0,type:"button"},[...p[8]||(p[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,pb)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Vb,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:p[1]||(p[1]=P=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:p[2]||(p[2]=P=>r(!0)),disabled:e.unref(N),type:"button"},[...p[11]||(p[11]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,fb)])],64)}}},Eb={class:"block"},bb={class:"square-title"},gb={class:"text-teal fw-bold py-3"},yb={class:"text-teal fw-bold pb-3"},kb={class:"table-responsive"},ub={class:"table align-middle gray-table"},hb={class:"text-end"},xb={class:"text-end"},$b={class:"text-end"},Bb={class:"mt-4"},_b={class:"table align-middle gray-table"},Cb={class:"text-center"},Tb={key:0,width:"180"},wb={class:"text-center"},Sb=["href"],Db={key:0,class:"text-center"},Ab={key:0},Fb={key:1,class:"text-pink"},Ub={key:1,class:"tag-group mt-2 gap-1"},Pb={key:0,class:"tag tag-green-light"},Mb=["download","href"],Ib=["onClick"],jb={class:"text-center"},Ob={colspan:"2"},Lb={class:"block-bottom bg-light-teal"},Rb=["disabled"],qb={__name:"Payment3",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref(0),m=e.computed(()=>i.value<=0||_.value.some(E=>!E.Files.filter(s=>!s.Deleted).length)),N=e.computed(()=>!o.value||o.value.Status==="請款中"),n=e.ref(0),o=e.ref(),l=e.ref(0),d=e.ref({}),b=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(i.value*100/d.value.ApprovedAmount*100)/100,100):0),k=e.computed(()=>l.value?Math.round(i.value*100/l.value*100)/100:0),_=e.ref([{Type:31,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:32,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:33,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:34,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),h=(E,s)=>{s.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:s.Path,Name:`${d.value.ProjectID}_結案核銷_${E.Title}.pdf`})},V=A.download,c=x,a=()=>{A.multiple("getPayment",{ID:g.id}).subscribe(E=>{d.value=E.Project,j().init("multiple",d.value),_.value=_.value.filter(s=>{var f;return!((f=s.Excludes)!=null&&f.includes(d.value.OrgCategory))}),_.value.forEach(s=>{s.Files=E.Attachments.filter(f=>f.Type===s.Type),s.Uploaded=e.computed(()=>s.Files.filter(f=>!f.Deleted).length)}),o.value=E.Payments.find(s=>s.Stage===3),l.value=E.Payments.filter(s=>s.Stage<3&&s.Status==="通過").reduce((s,f)=>s+f.CurrentActualPaidAmount,0),n.value=d.value.ApprovedAmount,Y().init(o.value,l.value)})},u=E=>{const s={Payment:{ProjectID:g.id,Stage:3,ActDisbursementRatioPct:g.setting.DisbursementRatioPct,TotalSpentAmount:i.value},Attachments:_.value.reduce((f,r)=>f.concat(r.Files),[]),Submit:E?"true":"false"};A.multiple("savePayment",s).subscribe(()=>{E?c("next"):a()})};return e.onMounted(a),e.provide("editable",N),(E,s)=>{var y;const f=e.resolveComponent("input-integer"),r=e.resolveComponent("required-label"),t=e.resolveComponent("input-file"),p=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Eb,[e.createElementVNode("h5",bb,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",gb,"核定經費: "+e.toDisplayString((y=e.unref(d).ApprovedAmount)==null?void 0:y.toLocaleString())+"元",1),e.createElementVNode("p",yb,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(i)).toLocaleString())+"元",1),e.createElementVNode("div",kb,[e.createElementVNode("table",ub,[s[4]||(s[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額(元)"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額(元)"),e.createElementVNode("th",null,"累積實支金額(元)"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",hb,e.toDisplayString(e.unref(l)),1),e.createElementVNode("td",null,[e.createVNode(f,{max:e.unref(n),modelValue:e.unref(i),"onUpdate:modelValue":s[0]||(s[0]=S=>e.isRef(i)?i.value=S:null)},null,8,["max","modelValue"])]),e.createElementVNode("td",xb,e.toDisplayString(e.unref(b))+"%",1),e.createElementVNode("td",$b,e.toDisplayString(e.unref(k))+"%",1)])])])]),s[11]||(s[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),s[12]||(s[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Bb,[e.createElementVNode("table",_b,[e.createElementVNode("thead",Cb,[e.createElementVNode("tr",null,[s[5]||(s[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[6]||(s[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Tb,"狀態")):e.createCommentVNode("",!0),s[7]||(s[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),(S,C)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",wb,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(S.Title),1)]),_:2},1024)]),e.unref(N)&&S.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:S.Template,style:{width:"140px"},type:"button"},[...s[8]||(s[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Sb)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Db,[S.Uploaded?(e.openBlock(),e.createElementBlock("span",Ab,"已上傳")):(e.openBlock(),e.createElementBlock("span",Fb,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(N)&&!S.Uploaded?(e.openBlock(),e.createBlock(t,{key:0,accept:".pdf",onFile:w=>h(S,w)},null,8,["onFile"])):e.createCommentVNode("",!0),S.Uploaded?(e.openBlock(),e.createElementBlock("div",Ub,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(S.Files,w=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:w},[w.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Pb,[e.createElementVNode("a",{class:"tag-link my-1",download:w.Name,href:e.unref(V)(w.Path)},e.toDisplayString(w.Name),9,Mb),e.unref(N)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:P=>w.Deleted=!0,type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ib)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128)),e.createElementVNode("tr",null,[e.createElementVNode("td",jb,e.toDisplayString(e.unref(_).length+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[...s[10]||(s[10]=[e.createTextVNode("其他資料（5分鐘精華影片）",-1)])]),_:1})])]),e.createElementVNode("td",Ob,[e.createVNode(p)])])])])])]),e.createElementVNode("div",Lb,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[1]||(s[1]=S=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[2]||(s[2]=S=>u(!0)),disabled:e.unref(m),type:"button"},[...s[13]||(s[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Rb)])],64)}}},zb={__name:"ProgressBar",setup(B){const x=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(g,i)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:x,type:"multiple"})}}},Gb={class:"block"},Jb={class:"mt-4"},Yb={class:"table align-middle gray-table side-table"},Qb={key:0,class:"d-flex align-items-center gap-2"},Hb={class:"input-group w-auto"},Wb={class:"text-teal-dark"},Kb={key:1,class:"invalid mt-0"},Xb={class:"table-responsive mt-4"},Zb={class:"table align-middle gray-table"},vb={key:0},eg={class:"input-group"},tg={key:0,class:"invalid mt-0"},lg={key:0},og={class:"d-flex gap-2"},ng=["onClick"],rg={class:"mt-4"},ag={class:"table align-middle gray-table"},sg={key:0},dg=["value"],cg={key:0},ig={class:"d-flex gap-2"},mg=["onClick"],pg={class:"mt-4"},Vg={class:"table align-middle gray-table side-table"},fg={key:0,class:"block-bottom bg-light-teal"},Ng={__name:"WorkSchedule",props:{apply:{default:!1,type:Boolean},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=[{value:1,text:"50%"},{value:2,text:"100%"}],m=e.ref(),N=e.computed(()=>k.value.EndDate),n=e.computed(()=>z("multiple",b.value.Status,2)),o=e.ref({}),l=e.computed(()=>_.value.filter(r=>!r.Deleted)),d=e.computed(()=>h.value.filter(r=>!r.Deleted)),b=e.ref({}),k=e.ref({}),_=e.ref([]),h=e.ref([]),V=()=>A.multiple("createItem",{ID:g.id}).subscribe(r=>_.value.push(r)),c=()=>h.value.push({Type:0,ItemID:0}),a=x,u=()=>{rxjs.forkJoin([A.multiple("getWorkSchedule",{Apply:g.apply?"true":"false",ID:g.id})]).subscribe(r=>{const t=r[0];b.value=t.Project,k.value=t.GrantType,_.value=t.Items,h.value=t.Schedules,_.value.length||V(),h.value.length||c(),j().init("multiple",b.value),m.value=b.value.changeApply,b.value.changeApply=void 0})},E=r=>r.Deleted=!0,s=r=>{var p,y;if(o.value={},r&&!f()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:b.value,Items:_.value,Schedules:h.value,Before:(p=m.value)==null?void 0:p.Form2Before,After:(y=m.value)==null?void 0:y.Form2After,Submit:r?"true":"false"};A.multiple("saveWorkSchedule",t).subscribe(()=>{r?a("next"):u()})},f=()=>{let r={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=M(b.value,r),r={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`item-${p}-`))),r={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,p)=>Object.assign(o.value,M(t,r,`schedule-${p}-`))),m.value&&(r={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,M(m.value,r))),!Object.keys(o.value).length};return e.onMounted(u),e.provide("editable",n),(r,t)=>{const p=e.resolveComponent("required-label"),y=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),C=e.resolveComponent("input-text"),w=e.resolveComponent("input-month"),P=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Gb,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Jb,[e.createElementVNode("table",Yb,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",Qb,[e.createElementVNode("div",Hb,[e.createVNode(y,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(b).StartTime,"onUpdate:modelValue":t[0]||(t[0]=T=>e.unref(b).StartTime=T)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(y,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(b).EndTime,"onUpdate:modelValue":t[1]||(t[1]=T=>e.unref(b).EndTime=T)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Wb,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(N)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",Kb,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Xb,[e.createElementVNode("table",Zb,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(n)?(e.openBlock(),e.createElementBlock("th",vb,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+D)),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(o)[`item-${D}-Title`],modelValue:T.Title,"onUpdate:modelValue":U=>T.Title=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",eg,[e.createVNode(w,{"empty-value":0,modelValue:T.Begin,"onUpdate:modelValue":U=>T.Begin=U},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(w,{"empty-value":0,modelValue:T.End,"onUpdate:modelValue":U=>T.End=U},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${D}-Begin`]||e.unref(o)[`item-${D}-End`]?(e.openBlock(),e.createElementBlock("div",tg,e.toDisplayString(e.unref(o)[`item-${D}-Begin`]||e.unref(o)[`item-${D}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`item-${D}-Deadline`],modelValue:T.Deadline,"onUpdate:modelValue":U=>T.Deadline=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`item-${D}-Content`],rows:"1",modelValue:T.Content,"onUpdate:modelValue":U=>T.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",lg,[e.createElementVNode("div",og,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>E(T),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ng)):e.createCommentVNode("",!0),D+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:V,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",rg,[e.createElementVNode("table",ag,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(n)?(e.openBlock(),e.createElementBlock("th",sg,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${D}-Type`],options:i,modelValue:T.Type,"onUpdate:modelValue":U=>T.Type=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${D}-ItemID`],options:e.unref(l),modelValue:T.ItemID,"onUpdate:modelValue":U=>T.ItemID=U,modelModifiers:{trim:!0}},{default:e.withCtx(({index:U,option:I})=>[e.createElementVNode("option",{value:I.ID},e.toDisplayString(String.fromCharCode(65+U))+"."+e.toDisplayString(I.Title),9,dg)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(o)[`schedule-${D}-Deadline`],modelValue:T.Deadline,"onUpdate:modelValue":U=>T.Deadline=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o)[`schedule-${D}-Content`],rows:"1",modelValue:T.Content,"onUpdate:modelValue":U=>T.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",cg,[e.createElementVNode("div",ig,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>E(T),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,mg)):e.createCommentVNode("",!0),D+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",pg,[e.createElementVNode("table",Vg,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=T=>e.unref(m).Form2Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(P,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":t[3]||(t[3]=T=>e.unref(m).Form2After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",fg,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=T=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=T=>s(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Eg={class:"block bg-light-teal-100 rounded-4 py-4"},bg={class:"fw-bold"},gg={class:"d-flex align-items-center gap-3 text-teal-dark mt-3"},yg={class:"block rounded-4 mt-4"},kg=["innerHTML"],ug={class:"mt-3 d-flex flex-column gap-2"},hg=["download","href"],xg={class:"mt-3"},$g=["data-caption","href"],Bg=["alt","src"],_g={class:"mt-3 d-flex flex-column gap-2"},Cg=["href"],Tg={__name:"NewsDetail",props:{id:{type:[Number,String]}},setup(B){const x=B,g=e.ref(),i=e.ref([]),m=e.ref({}),N=e.ref([]),n=e.ref([]),o=A.download;return e.onMounted(()=>{A.system("getNews",{ID:x.id}).subscribe(l=>{m.value=l.News,i.value=l.Files,N.value=l.Images,n.value=l.Videos,e.nextTick(()=>{Fancybox.bind(g.value,"[data-fancybox]")})})}),(l,d)=>{const b=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Eg,[e.createElementVNode("h5",bg,e.toDisplayString(e.unref(m).Title),1),e.createElementVNode("ul",gg,[e.createElementVNode("li",null,[d[0]||(d[0]=e.createTextVNode("公告日期：",-1)),e.createVNode(b,{value:e.unref(m).EnableTime},null,8,["value"])]),e.createElementVNode("li",null,"公告單位："+e.toDisplayString(e.unref(m).UserOrg),1)])]),e.createElementVNode("div",yg,[e.createElementVNode("div",{class:"mb-5",style:{"white-space":"pre-line"},innerHTML:e.unref(m).Content},null,8,kg),e.unref(i).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[d[2]||(d[2]=e.createElementVNode("h5",{class:"square-title"},"相關附件",-1)),e.createElementVNode("ul",ug,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),k=>(e.openBlock(),e.createElementBlock("li",{key:k},[e.createElementVNode("a",{class:"link-black",download:k.Name,href:e.unref(o)(k.Path)},[e.createTextVNode(e.toDisplayString(k.Name)+" ",1),d[1]||(d[1]=e.createElementVNode("i",{class:"fa-solid fa-file-arrow-down text-teal-dark ms-1"},null,-1))],8,hg)]))),128))])],64)):e.createCommentVNode("",!0),e.unref(N).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[d[4]||(d[4]=e.createElementVNode("h5",{class:"square-title mt-5"},"相關照片",-1)),e.createElementVNode("div",xg,[e.createElementVNode("div",{class:"image-preview mt-3",ref_key:"container",ref:g},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(k,_)=>(e.openBlock(),e.createElementBlock("div",{class:"image-preview__item",key:k},[e.createElementVNode("a",{"data-fancybox":"gallery","data-caption":`相片 ${_}`,href:e.unref(o)(k.Path)},[e.createElementVNode("img",{alt:`相片 ${_}`,src:e.unref(o)(k.Path)},null,8,Bg),d[3]||(d[3]=e.createElementVNode("div",{class:"image-preview__item-overlay"},[e.createElementVNode("button",{"aria-label":"檢視圖片",class:"btn btn-view-image",tabindex:"-1",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"})])],-1))],8,$g)]))),128))],512)])],64)):e.createCommentVNode("",!0),e.unref(n).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[d[6]||(d[6]=e.createElementVNode("h5",{class:"square-title mt-5"},"相關影片",-1)),e.createElementVNode("ul",_g,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),k=>(e.openBlock(),e.createElementBlock("li",{key:k},[e.createElementVNode("a",{class:"link-black",href:k.URL,target:"_blank"},[e.createTextVNode(e.toDisplayString(k.Title)+" ",1),d[5]||(d[5]=e.createStaticVNode('<svg class="ms-1" xmlns="http://www.w3.org/2000/svg" width="16" height="18" viewBox="0 0 19 24" fill="none"><g clip-path="url(#clip0_1051_6167)"><path d="M17.7333 0.5H12.6667C11.913 0.5 11.4 1.12067 11.4 1.76667C11.4 2.05167 11.4887 2.36833 11.7673 2.65967L13.4077 4.3L9.87367 7.834C9.60767 8.1 9.5 8.423 9.5 8.727C9.5 9.43633 10.0573 9.99367 10.7667 9.99367C11.096 9.99367 11.4127 9.87333 11.6597 9.62L15.1937 6.086L16.834 7.72633C17.1253 8.005 17.442 8.09367 17.727 8.09367C18.373 8.09367 18.9937 7.58067 18.9937 6.827V1.76667C18.9937 1.12067 18.4807 0.5 17.727 0.5H17.7333ZM15.2 7.88467L12.559 10.5257C12.084 11.0007 11.4443 11.2667 10.7667 11.2667C9.348 11.2667 8.23333 10.152 8.23333 8.73333C8.23333 8.05567 8.49933 7.42233 8.97433 6.941L11.6153 4.3L10.8743 3.559C10.716 3.39433 10.5957 3.217 10.488 3.03333H1.26667C0.563667 3.03333 0 3.597 0 4.3V18.2333C0 18.93 0.563667 19.5 1.26667 19.5H15.2C15.8967 19.5 16.4667 18.93 16.4667 18.2333V9.01833C16.2893 8.917 16.1183 8.79667 15.9663 8.651L15.2 7.88467Z" fill="#037F72"></path></g><defs><clipPath id="clip0_1051_6167"><rect width="19" height="19" fill="white" transform="translate(0 0.5)"></rect></clipPath></defs></svg>',1))],8,Cg)]))),128))])],64)):e.createCommentVNode("",!0)])],64)}}},wg={class:"block rounded-4 mt-4"},Sg={class:"table-responsive",style:{"min-height":"400px"}},Dg={class:"table teal-table","aria-label":"公告列表"},Ag={"data-th":"公告時間:"},Fg={"data-th":"公告標題:",class:"text-start"},Ug=["href"],Pg={"data-th":"發布單位:",class:"text-start"},Mg={__name:"NewsList",setup(B){const x=e.ref([]),g=e.ref(1),i=e.ref(10),m=e.computed(()=>x.value.slice((g.value-1)*i.value,g.value*i.value)),N=(n,o)=>{g.value=parseInt(n),i.value=parseInt(o)};return e.onMounted(()=>{A.system("getPublishedNewsList").subscribe(n=>x.value=n.List)}),(n,o)=>{const l=e.resolveComponent("tw-date"),d=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock("div",wg,[o[1]||(o[1]=e.createElementVNode("div",{class:"title border-teal"},[e.createElementVNode("div",{class:"d-flex align-items-center gap-2"},[e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")])])],-1)),e.createElementVNode("div",Sg,[e.createElementVNode("table",Dg,[o[0]||(o[0]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告時間"),e.createElementVNode("th",{scope:"col",class:"text-start"},"標題"),e.createElementVNode("th",{scope:"col",style:{width:"300px"}},"發布單位")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),b=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Ag,[e.createVNode(l,{value:b.EnableTime},null,8,["value"])]),e.createElementVNode("td",Fg,[e.createElementVNode("a",{class:"link-black",href:`NewsDetail.aspx?ID=${b.ID}`},e.toDisplayString(b.Title),9,Ug)]),e.createElementVNode("td",Pg,e.toDisplayString(b.UserOrg)+" "+e.toDisplayString(b.UserName),1)]))),128))])])]),e.createVNode(d,{count:e.unref(x).length,onChange:N,page:e.unref(g),"page-size":e.unref(i)},null,8,["count","page","page-size"])])}}},Ig={key:0,class:"notice mb-3"},jg={class:"notice-content"},Og=["onClick"],Lg={class:"notice-action"},Rg=["href"],qg=oe({__name:"NewsMarquee",setup(B){let x=0;const g=e.ref([]),i=e.ref(),m=e.computed(()=>A.toUrl("/OFS/Information/NewsList.aspx")),N=n=>{window.open(A.toUrl(`/OFS/Information/NewsDetail.aspx?ID=${n.ID}`),"_blank")};return e.onMounted(()=>{A.system("getPublishedNewsList").subscribe(n=>{g.value=n.List,g.value.length>1&&setInterval(()=>{x++,i.value.style.transition="transform 1s ease-in-out",i.value.style.transform=`translateY(-${x*1.5}rem)`,x===g.value.length&&setTimeout(()=>{i.value.style.transition="none",i.value.style.transform="translateY(0)",x=0},1e3)},5e3)})}),(n,o)=>{const l=e.resolveComponent("tw-date");return e.unref(g).length?(e.openBlock(),e.createElementBlock("div",Ig,[e.createElementVNode("div",jg,[e.createElementVNode("div",{class:"notice-list",ref_key:"marquee",ref:i},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(g),d=>(e.openBlock(),e.createElementBlock("h3",{class:"notice-title",onClick:b=>N(d),style:{"margin-bottom":"0.5rem",cursor:"pointer"},key:d},[e.createVNode(l,{value:d.EnableTime},null,8,["value"]),e.createTextVNode(" "+e.toDisplayString(d.Title),1)],8,Og))),128)),e.unref(g).length>1?(e.openBlock(),e.createElementBlock("h3",{key:0,class:"notice-title",onClick:o[0]||(o[0]=d=>N(e.unref(g)[0])),style:{cursor:"pointer"}},[e.createVNode(l,{value:e.unref(g)[0].EnableTime},null,8,["value"]),e.createTextVNode(" "+e.toDisplayString(e.unref(g)[0].Title),1)])):e.createCommentVNode("",!0)],512)]),e.createElementVNode("div",Lg,[e.createElementVNode("a",{class:"btn-link",href:e.unref(m)},"全部公告",8,Rg)])])):e.createCommentVNode("",!0)}}},[["__scopeId","data-v-8802a1c0"]]),zg={key:0,class:"scroll-bottom-panel"},Gg={class:"d-flex flex-column gap-3 mb-3"},Jg={class:"d-flex gap-2"},Yg={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Qg={class:"text-nowrap my-2 d-flex align-items-center"},Hg={__name:"ProjectChangeReview",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const x=B,g=j(),i=[{value:1,text:"通過"},{value:2,text:"退回修改"}],m=e.ref({}),N=e.ref({ID:x.id,Result:1}),n=()=>{const l={};if(N.value.Result>1&&(l.Reason="原因"),m.value=M(N.value,l),Object.keys(m.value).length){o();return}A[x.type]("reviewApplicationChange",N.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=5")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>N.value.Result,l=>{l>1&&o()}),(l,d)=>{const b=e.resolveComponent("input-radio-group"),k=e.resolveComponent("input-textarea");return e.unref(g)[B.type].organizer&&e.unref(g)[B.type].isOrganizer?(e.openBlock(),e.createElementBlock("div",zg,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Gg,[e.createElementVNode("li",Jg,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Yg,[e.createElementVNode("div",Qg,[e.createVNode(b,{options:i,modelValue:e.unref(N).Result,"onUpdate:modelValue":d[0]||(d[0]=_=>e.unref(N).Result=_)},null,8,["modelValue"])]),e.unref(N).Result>1?(e.openBlock(),e.createBlock(k,{key:0,error:e.unref(m).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(N).Reason,"onUpdate:modelValue":d[1]||(d[1]=_=>e.unref(N).Reason=_)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:n,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Wg={key:0,class:"scroll-bottom-panel"},Kg={class:"d-flex flex-column gap-3 mb-3"},Xg={class:"d-flex gap-2"},Zg={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},vg={class:"text-nowrap my-2 d-flex align-items-center"},ey={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(B){const x=B,g=j(),i=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],m=e.ref({}),N=e.ref({ID:x.id,Result:1}),n=()=>{const l={};if(N.value.Result>1&&(l.Reason="原因"),m.value=M(N.value,l),Object.keys(m.value).length){o();return}A[x.type]("reviewApplication",N.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=4")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>N.value.Result,l=>{l>1&&o()}),(l,d)=>{const b=e.resolveComponent("input-radio-group"),k=e.resolveComponent("input-textarea");return e.unref(g)[B.type].organizer&&e.unref(g)[B.type].isOrganizer?(e.openBlock(),e.createElementBlock("div",Wg,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Kg,[e.createElementVNode("li",Xg,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Zg,[e.createElementVNode("div",vg,[e.createVNode(b,{options:i,modelValue:e.unref(N).Result,"onUpdate:modelValue":d[0]||(d[0]=_=>e.unref(N).Result=_)},null,8,["modelValue"])]),e.unref(N).Result>1?(e.openBlock(),e.createBlock(k,{key:0,error:e.unref(m).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(N).Reason,"onUpdate:modelValue":d[1]||(d[1]=_=>e.unref(N).Reason=_)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:n,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},ty={class:"d-flex align-items-center gap-3"},ly={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},oy={class:"modal-content"},ny={class:"modal-header"},ry={class:"fs-24 fw-bold text-green-light"},ay={class:"modal-body"},sy={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},dy=["disabled"],cy={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(B){const x=B,g=e.computed(()=>!n.value||n.value===l[x.type].organizer),i=e.ref(),m=e.ref(),N=e.computed(()=>l[x.type].organizerName),n=e.ref(0),o=e.computed(()=>{var V;return(V=k.value.find(c=>c.UnitID===b.value))==null?void 0:V.reviewers}),l=j(),d=e.computed(()=>N.value?"移轉案件":"認領案件"),b=e.ref(0),k=e.ref([]),_=()=>{A[x.type]("queryReviewUnits").subscribe(V=>{k.value=V,rxjs.forkJoin(k.value.map(c=>A[x.type]("queryReviewersByUnit",{ID:c.UnitID}))).subscribe(c=>{c.forEach((a,u)=>{k.value[u].reviewers=a,a.some(E=>E.UserID===n.value)&&(b.value=k.value[u].UnitID)}),bootstrap.Modal.getOrCreateInstance(m.value).show()})})},h=()=>{A[x.type]("saveOrganizer",{ID:x.id,Organizer:n.value}).subscribe(V=>{V&&window.location.reload()})};return e.onMounted(()=>{A.system("getRoles").subscribe(V=>{i.value=V.IsOrganizer||V.IsSupervisor||V.IsSysAdmin})}),e.watch(N,()=>n.value=l[x.type].organizer),e.watch(b,()=>{o.value.some(V=>V.UserID===n.value)||(n.value=0)}),(V,c)=>{const a=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ty,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(N)||"尚無"),1),e.unref(i)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal",onClick:_,type:"button"},e.toDisplayString(e.unref(d)),1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:m,tabindex:"-1"},[e.createElementVNode("div",ly,[e.createElementVNode("div",oy,[e.createElementVNode("div",ny,[e.createElementVNode("h4",ry,e.toDisplayString(e.unref(d)),1),c[2]||(c[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",ay,[e.createElementVNode("div",null,[c[3]||(c[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(a,{"empty-value":0,options:e.unref(k),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(b),"onUpdate:modelValue":c[0]||(c[0]=u=>e.isRef(b)?b.value=u:null)},null,8,["options","modelValue"]),e.createVNode(a,{class:"mt-2","empty-value":0,options:e.unref(o),"text-name":"Name","value-name":"UserID",modelValue:e.unref(n),"onUpdate:modelValue":c[1]||(c[1]=u=>e.isRef(n)?n.value=u:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",sy,[c[4]||(c[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:h,disabled:e.unref(g),type:"button"},"確認",8,dy)])])])])],512)]))],64)}}},iy={key:0,class:"scroll-bottom-panel"},my={class:"d-flex flex-column gap-3 mb-3"},py={key:0,class:"d-flex gap-2 align-items-center"},Vy={key:1,class:"d-flex gap-2 align-items-center"},fy={class:"d-flex gap-2"},Ny={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Ey={class:"text-nowrap my-2 d-flex align-items-center"},by=["disabled"],gy={__name:"ProjectPaymentReview",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const x=B,g=j(),i=Y(),m=[{value:1,text:"通過"},{value:2,text:"退回修改"}],N=e.computed(()=>!i.stage),n=e.ref({}),o=e.ref({ID:x.id,Result:1,Reason:""}),l=e.computed(()=>o.value.Result===1?x.type==="culture"&&i.stage===2||x.type==="education"||x.type==="accessibility"&&i.stage===2?"確定撥款及結案":x.type==="multiple"&&i.stage===3||x.type==="literacy"&&i.stage===2?"確定核銷及結案":"確定撥款":"確定退回"),d=()=>{const k={};if(o.value.Result>1&&(k.Reason="原因"),n.value=M(o.value,k),Object.keys(n.value).length){b();return}o.value.Stage=i.stage,A[x.type]("reviewPayment",o.value).subscribe(_=>{_&&(window.location.href="../ReviewChecklist.aspx?type=5")})},b=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>o.value.Result,k=>{k>1&&b()}),e.watch(()=>i.amount,k=>o.value.Amount=k),(k,_)=>{const h=e.resolveComponent("input-integer"),V=e.resolveComponent("input-radio-group"),c=e.resolveComponent("input-textarea");return e.unref(i).status==="審核中"&&e.unref(g)[B.type].isOrganizer?(e.openBlock(),e.createElementBlock("div",iy,[_[6]||(_[6]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",my,[e.unref(i).amount?(e.openBlock(),e.createElementBlock("li",py,[_[3]||(_[3]=e.createElementVNode("span",{class:"text-gray"},"本期撥付：",-1)),e.createVNode(h,{class:"w-auto",max:e.unref(i).amount,modelValue:e.unref(o).Amount,"onUpdate:modelValue":_[0]||(_[0]=a=>e.unref(o).Amount=a)},null,8,["max","modelValue"])])):e.createCommentVNode("",!0),e.unref(i).paid?(e.openBlock(),e.createElementBlock("li",Vy,[_[4]||(_[4]=e.createElementVNode("span",{class:"text-gray"},"前期累積撥付：",-1)),e.createTextVNode(" "+e.toDisplayString(e.unref(i).paid.toLocaleString()),1)])):e.createCommentVNode("",!0),e.createElementVNode("li",fy,[_[5]||(_[5]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Ny,[e.createElementVNode("div",Ey,[e.createVNode(V,{options:m,modelValue:e.unref(o).Result,"onUpdate:modelValue":_[1]||(_[1]=a=>e.unref(o).Result=a)},null,8,["modelValue"])]),e.unref(o).Result>1?(e.openBlock(),e.createBlock(c,{key:0,error:e.unref(n).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(o).Reason,"onUpdate:modelValue":_[2]||(_[2]=a=>e.unref(o).Reason=a)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:d,disabled:e.unref(N),type:"button"},e.toDisplayString(e.unref(l)),9,by)])):e.createCommentVNode("",!0)}}},yy={class:"step-line-wrapper"},ky={class:"step-line"},uy={key:0,class:"tag tag-white"},hy={key:1,class:"tag tag-white"},xy={key:0,class:"step-line"},$y={key:0,class:"tag tag-white"},By={class:"step-line"},_y={key:0,class:"tag tag-white"},Cy={key:0,class:"tag tag-white"},Ty={__name:"ProjectProgress",props:{excludes:{default:[],type:Array},id:{type:[Number,String]},step:{required:!0,type:Number},type:{required:!0,type:String}},setup(B){const x=j(),g=B,i=m=>{location.href=`${m}.aspx?ID=${g.id}`};return(m,N)=>(e.openBlock(),e.createElementBlock("div",yy,[e.createElementVNode("div",ky,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===1}]),onClick:N[0]||(N[0]=n=>i("Audit")),role:"button"},[N[4]||(N[4]=e.createElementVNode("div",{class:"step-line-item-title"},"核定計畫",-1)),B.step===1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[[1,4].includes(e.unref(x)[g.type].changeStatus)?(e.openBlock(),e.createElementBlock("div",uy,"編輯中")):e.unref(x)[g.type].changeStatus===2?(e.openBlock(),e.createElementBlock("div",hy,"審核中")):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],2)]),B.excludes.includes(4)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",xy,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===4}]),onClick:N[1]||(N[1]=n=>i("Progress")),role:"button"},[N[5]||(N[5]=e.createElementVNode("div",{class:"step-line-item-title"},"每月進度",-1)),B.step===4?(e.openBlock(),e.createElementBlock("div",$y,"編輯中")):e.createCommentVNode("",!0)],2)])),e.createElementVNode("div",By,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===5}]),onClick:N[2]||(N[2]=n=>i("Report")),role:"button"},[N[6]||(N[6]=e.createElementVNode("div",{class:"step-line-item-title"},"階段報告",-1)),B.step===5?(e.openBlock(),e.createElementBlock("div",_y,"編輯中")):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===6}]),onClick:N[3]||(N[3]=n=>i("Payment")),role:"button"},[N[7]||(N[7]=e.createElementVNode("div",{class:"step-line-item-title"},"請款核銷",-1)),B.step===6?(e.openBlock(),e.createElementBlock("div",Cy,"編輯中")):e.createCommentVNode("",!0)],2)])]))}},wy={class:"block"},Sy={class:"square-title"},Dy=["innerHTML"],Ay={class:"table-responsive mt-3"},Fy={class:"table align-middle gray-table"},Uy={key:0,class:"text-center"},Py={class:"text-center"},My=["href"],Iy={key:0,class:"text-center"},jy={key:0},Oy={key:1,class:"text-pink"},Ly={key:1,class:"tag-group mt-2 gap-1"},Ry={key:0,class:"tag tag-green-light"},qy=["download","href"],zy=["onClick"],Gy={key:0,class:"block-bottom bg-light-teal"},Jy=["disabled"],Yy={__name:"ProjectReport",props:{data:{required:!0,type:Object},id:{type:[Number,String]},type:{type:String}},emits:["next"],setup(B,{emit:x}){let g;const i=B,m=e.computed(()=>N.value.some(h=>!h.Optional&&!h.Files.filter(V=>!V.Deleted).length)),N=e.ref(i.data.docs.map(h=>({...h,Files:[]}))),n=e.ref(),o=e.ref({}),l=(h,V)=>{(V.Type==="application/zip"||V.Type==="application/x-zip-compressed")&&h.Files.push({Type:h.Type,Path:V.Path,Name:`${i.id}_${h.Title}_${g}.zip`})},d=A.download,b=x,k=()=>{A[i.type]("getReport",{ID:i.id,Stage:i.data.id}).subscribe(h=>{var V;o.value=h.Report,N.value.forEach(c=>{c.Files=h.Attachments.filter(a=>a.Type===c.Type),c.Uploaded=e.computed(()=>c.Files.filter(a=>!a.Deleted).length)}),n.value=!o.value.Status||o.value.Status==="暫存"||o.value.Status==="退回修正",g=(V=o.value)!=null&&V.Reviewer?"修訂版":"初版",j().init(i.type,h.Project,o.value)})},_=h=>{const V={ID:i.id,Stage:i.data.id,Attachments:N.value.reduce((c,a)=>c.concat(a.Files),[]),Submit:h?"true":"false"};A[i.type]("saveReport",V).subscribe(()=>{h?b("next"):k()})};return e.onMounted(k),e.provide("editable",n),(h,V)=>{const c=e.resolveComponent("required-label"),a=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",wy,[e.createElementVNode("h5",Sy,e.toDisplayString(B.data.subtitle),1),e.createElementVNode("p",{class:"text-pink mt-3 lh-base",innerHTML:B.data.description},null,8,Dy),e.createElementVNode("div",Ay,[e.createElementVNode("table",Fy,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[V[2]||(V[2]=e.createElementVNode("th",{width:"70",class:"text-center"},"附件編號",-1)),V[3]||(V[3]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(n)?(e.openBlock(),e.createElementBlock("th",Uy,"狀態")):e.createCommentVNode("",!0),V[4]||(V[4]=e.createElementVNode("th",null,"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(u,E)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Py,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024)]),e.unref(n)&&u.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:u.Template,style:{width:"140px"},type:"button"},[...V[5]||(V[5]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,My)):e.createCommentVNode("",!0)]),e.unref(n)?(e.openBlock(),e.createElementBlock("td",Iy,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",jy,"已上傳")):(e.openBlock(),e.createElementBlock("span",Oy,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(n)&&!u.Uploaded?(e.openBlock(),e.createBlock(a,{key:0,accept:".zip",onFile:s=>l(u,s)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Ly,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,s=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:s},[s.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ry,[e.createElementVNode("a",{class:"tag-link my-1",download:s.Name,href:e.unref(d)(s.Path)},e.toDisplayString(s.Name),9,qy),e.unref(n)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:f=>s.Deleted=!0,type:"button"},[...V[6]||(V[6]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,zy)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",Gy,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:V[0]||(V[0]=u=>_()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:V[1]||(V[1]=u=>_(!0)),disabled:e.unref(m),type:"button"},[...V[7]||(V[7]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Jy)])):e.createCommentVNode("",!0)],64)}}},Qy={key:0,class:"scroll-bottom-panel"},Hy={class:"d-flex flex-column gap-3 mb-3"},Wy={class:"d-flex gap-2"},Ky={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Xy={class:"text-nowrap my-2 d-flex align-items-center"},Zy={__name:"ProjectReportReview",props:{id:{type:[Number,String]},stage:{type:Number},type:{type:String}},setup(B){const x=B,g=j(),i=[{value:1,text:"通過"},{value:2,text:"退回修改"}],m=e.ref({}),N=e.ref({ID:x.id,Result:1}),n=()=>{const l={};if(N.value.Result>1&&(l.Reason="原因"),m.value=M(N.value,l),Object.keys(m.value).length){o();return}N.value.Stage=x.stage,A[x.type]("reviewReport",N.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=6")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>N.value.Result,l=>{l>1&&o()}),(l,d)=>{const b=e.resolveComponent("input-radio-group"),k=e.resolveComponent("input-textarea");return e.unref(g)[B.type].organizer&&e.unref(g)[B.type].isOrganizer?(e.openBlock(),e.createElementBlock("div",Qy,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Hy,[e.createElementVNode("li",Wy,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Ky,[e.createElementVNode("div",Xy,[e.createVNode(b,{options:i,modelValue:e.unref(N).Result,"onUpdate:modelValue":d[0]||(d[0]=_=>e.unref(N).Result=_)},null,8,["modelValue"])]),e.unref(N).Result>1?(e.openBlock(),e.createBlock(k,{key:0,error:e.unref(m).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(N).Reason,"onUpdate:modelValue":d[1]||(d[1]=_=>e.unref(N).Reason=_)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:n,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},vy={key:0,class:"scroll-bottom-panel"},ek={class:"d-flex flex-column gap-3 mb-3"},tk={class:"d-flex gap-2"},lk={class:"d-flex gap-2"},ok={class:"text-pink"},nk={class:"d-flex gap-2"},rk={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},ak={class:"text-nowrap mb-2 d-flex align-items-center"},sk={key:0,class:"invalid mt-0"},dk={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(B){const x=B,g=j(),i=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],m=["無","低風險","中風險","高風險"],N=e.ref({}),n=e.ref({ID:x.id,Result:1}),o=e.ref({}),l=e.ref(0),d=()=>{window.open(A.toUrl(`/OFS/ApplicationChecklist.aspx?Year=${o.value.Year}&OrgName=${encodeURIComponent(o.value.OrgName)}`),"_blank")},b=()=>{window.open(A.toUrl(`/OFS/AuditHistory.aspx?Name=${encodeURIComponent(o.value.OrgName)}`),"_blank")},k=()=>{const h={};if(n.value.Result>1&&(h.Reason="原因"),n.value.Result===3&&(h.CorrectionDeadline="補正期限"),N.value=M(n.value,h),Object.keys(N.value).length){_();return}A[x.type]("reviewApplication",n.value).subscribe(V=>{V&&(window.location.href="../ReviewChecklist.aspx?type=1")})},_=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.onMounted(()=>{A[x.type]("getReviewInfo",{ID:x.id}).subscribe(h=>{o.value=h,o.value.AuditRecords.forEach(V=>{switch(V.Risk){case"Low":l.value<1&&(l.value=1);break;case"Medium":l.value<2&&(l.value=2);break;case"High":l.value<3&&(l.value=3);break}})})}),e.watch(()=>n.value.Result,h=>{h>1&&_()}),(h,V)=>{const c=e.resolveComponent("input-radio-group"),a=e.resolveComponent("input-tw-date"),u=e.resolveComponent("input-textarea");return e.unref(g)[B.type].organizer&&e.unref(g)[B.type].isOrganizer?(e.openBlock(),e.createElementBlock("div",vy,[V[8]||(V[8]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",ek,[e.createElementVNode("li",tk,[V[3]||(V[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:d,href:"javascript:void(0)"},e.toDisplayString(e.unref(o).OtherCount),1)]),e.createElementVNode("li",lk,[V[6]||(V[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),e.createElementVNode("span",ok,e.toDisplayString(m[e.unref(l)]),1),e.createElementVNode("span",null,[V[4]||(V[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:b,href:"javascript:void(0)"},e.toDisplayString(e.unref(o).AuditRecords.length),1),V[5]||(V[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",nk,[V[7]||(V[7]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",rk,[e.createElementVNode("div",ak,[e.createVNode(c,{options:i,modelValue:e.unref(n).Result,"onUpdate:modelValue":V[0]||(V[0]=E=>e.unref(n).Result=E)},null,8,["modelValue"]),e.createVNode(a,{class:"form-control",drops:"up",modelValue:e.unref(n).CorrectionDeadline,"onUpdate:modelValue":V[1]||(V[1]=E=>e.unref(n).CorrectionDeadline=E)},null,8,["modelValue"])]),e.unref(N).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",sk,e.toDisplayString(e.unref(N).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(n).Result>1?(e.openBlock(),e.createBlock(u,{key:1,error:e.unref(N).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(n).Reason,"onUpdate:modelValue":V[2]||(V[2]=E=>e.unref(n).Reason=E)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:k,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},ck={class:"top-wrapper"},ik={class:"top-block"},mk={class:"d-flex align-items-center gap-3"},pk=["href"],Vk={__name:"ProjectTitle",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const x=B,g=j();return(i,m)=>(e.openBlock(),e.createElementBlock("div",ck,[e.createElementVNode("div",ik,[e.createElementVNode("div",mk,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(g)[x.type].type)+"］"+e.toDisplayString(e.unref(g)[x.type].id)+"/"+e.toDisplayString(e.unref(g)[x.type].name),1)]),e.createElementVNode("a",{class:"btn btn-teal-dark",href:`../AuditRecords.aspx?ProjectID=${B.id}`,target:"_blank"}," 查核紀錄 ",8,pk)])]))}},fk={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},Nk={class:"d-flex gap-2"},Ek={key:0,class:"btn text-teal-dark",type:"button"},bk=["href"],gk=["href"],yk={class:"d-flex gap-2"},kk={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},uk={class:"modal-content"},hk={class:"modal-body"},xk={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},$k={class:"modal-content"},Bk={class:"modal-body"},_k={class:"d-flex flex-column gap-4 mb-5"},Ck={class:"d-flex align-items-center"},Tk={class:"flex-grow-1"},wk={__name:"ProjectToolbar",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const x=j(),g=B,i=e.ref({}),m=e.ref(),N=e.ref({}),n=e.ref(),o=e.ref({}),l=e.ref(),d=e.computed(()=>{let c="";switch(g.type){case"culture":c="CUL";break;case"education":c="EDC";break;case"multiple":c="MUL";break;case"literacy":c="LIT";break;case"accessibility":c="ACC";break}return`../../Service/OFS/DownloadPdf.ashx?Type=${c}&ProjectID=${g.id}&Version=2`}),b=e.computed(()=>A.toUrl(`/OFS/PlanChangeRecords.aspx?ProjectID=${g.id}`)),k=()=>{const c={Reason:"計畫變更原因"};N.value=M(i.value,c),!Object.keys(N.value).length&&A[g.type]("applyChange",i.value).subscribe(a=>{a&&location.reload()})},_=()=>{i.value={ID:g.id},bootstrap.Modal.getOrCreateInstance(m.value).show()},h=()=>{o.value={ID:g.id},bootstrap.Modal.getOrCreateInstance(l.value).show()},V=()=>{const c={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};N.value=M(o.value,c),!Object.keys(N.value).length&&A[g.type]("terminate",o.value).subscribe(a=>{a&&(location.href="../ApplicationChecklist.aspx")})};return(c,a)=>{const u=e.resolveComponent("project-organizer"),E=e.resolveComponent("input-textarea"),s=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fk,[e.createElementVNode("div",Nk,[e.unref(x)[B.type].changeStatus?(e.openBlock(),e.createElementBlock("button",Ek," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:_,type:"button"}," 計畫變更申請 ")),e.createElementVNode("a",{class:"btn btn-teal-dark",href:e.unref(b),target:"_blank"},[...a[3]||(a[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])],8,bk),e.createElementVNode("a",{class:"btn btn-teal-dark",download:"",href:e.unref(d)},[...a[4]||(a[4]=[e.createElementVNode("i",{class:"fa-solid fa-download"},null,-1),e.createTextVNode(" 下載核定計畫書 ",-1)])],8,gk)]),e.createElementVNode("div",yk,[e.createVNode(u,{id:B.id,type:B.type},null,8,["id","type"]),e.unref(x)[B.type].isOrganizer?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-pink",onClick:h,type:"button"}," 計畫終止 ")):e.createCommentVNode("",!0)])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:m,tabindex:"-1"},[e.createElementVNode("div",kk,[e.createElementVNode("div",uk,[a[8]||(a[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",hk,[a[6]||(a[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),a[7]||(a[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(E,{error:e.unref(N).Reason,modelValue:e.unref(i).Reason,"onUpdate:modelValue":a[0]||(a[0]=f=>e.unref(i).Reason=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[a[5]||(a[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:k},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:n,tabindex:"-1"},[...a[9]||(a[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:l,tabindex:"-1"},[e.createElementVNode("div",xk,[e.createElementVNode("div",$k,[a[14]||(a[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Bk,[e.createElementVNode("div",_k,[e.createElementVNode("div",null,[a[10]||(a[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(E,{error:e.unref(N).RejectReason,modelValue:e.unref(o).RejectReason,"onUpdate:modelValue":a[1]||(a[1]=f=>e.unref(o).RejectReason=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),a[12]||(a[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",Ck,[a[11]||(a[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",Tk,[e.createVNode(s,{error:e.unref(N).RecoveryAmount,modelValue:e.unref(o).RecoveryAmount,"onUpdate:modelValue":a[2]||(a[2]=f=>e.unref(o).RecoveryAmount=f),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[a[13]||(a[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:V},"送出")])])])])],512)]))],64)}}},Sk={class:"search bg-gray mt-4"},Dk={class:"search-form"},Ak={class:"row g-3"},Fk={class:"col-12 col-lg-4"},Uk=["value"],Pk={class:"col-12 col-lg-4"},Mk=["value"],Ik={class:"row g-3"},jk={class:"col-12 col-lg-6"},Ok={class:"col-12 col-lg-6"},Lk={class:"total-list multiple-option"},Rk={class:"all-total"},qk={class:"total-item-content"},zk={class:"count"},Gk=["for"],Jk={class:"total-item-title"},Yk={class:"total-item-content"},Qk={class:"count"},Hk=["id","onUpdate:modelValue"],Wk={class:"block rounded-bottom-4"},Kk={class:"title border-teal"},Xk={class:"d-flex align-items-center gap-2"},Zk={class:"text-teal"},vk={class:"table-responsive",style:{"min-height":"400px"}},eu={class:"table teal-table"},tu={class:"total-row"},lu={class:"text-end"},ou={class:"text-end"},nu={class:"text-end"},ru={"data-th":"年度:"},au={"data-th":"類別:"},su={"data-th":"計畫名稱:",style:{"text-align":"left"}},du=["href"],cu={"data-th":"申請單位:",style:{"text-align":"left"}},iu={"data-th":"申請本會補助:",class:"text-end"},mu={"data-th":"配合款:",class:"text-end"},pu={"data-th":"總經費:",class:"text-end"},Vu={"data-th":"狀態:",style:{"text-align":"center",width:"100px"}},fu={class:"text-teal"},Nu={__name:"ApplyList",setup(B){const x=e.ref([{id:1,title:"申請中",checked:!0},{id:2,title:"審查中",checked:!0},{id:3,title:"已核定",checked:!0},{id:4,title:"未通過",checked:!0}]),g=e.ref([]),i=e.ref({}),m=e.ref([]),N=e.ref(1),n=e.ref(10),o=e.ref([]),l=e.computed(()=>b.value.filter(h=>x.value.find(V=>V.checked&&h.type===V.id))),d=e.computed(()=>l.value.slice((N.value-1)*n.value,N.value*n.value)),b=e.computed(()=>{let h=m.value;return i.value.category&&(h=h.filter(V=>V.Category===i.value.category)),i.value.unit&&(h=h.filter(V=>V.SupervisoryUnit===i.value.unit)),i.value.org&&(h=h.filter(V=>{var c;return(c=V.OrgName)==null?void 0:c.includes(i.value.org)})),i.value.name&&(h=h.filter(V=>{var c;return V.ProjectID.includes(i.value.name)||((c=V.ProjectName)==null?void 0:c.includes(i.value.name))})),h}),k=(h,V)=>{N.value=parseInt(h),n.value=parseInt(V)},_=h=>{if(h.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("CLB"))return`../CLB/ClbApplication.aspx?ProjectID=${h.ProjectID}`;if(h.ProjectID.includes("SCI"))return`../SCI/SciApplication.aspx?ProjectID=${h.ProjectID}`};return e.onMounted(()=>{A.system("getApplyList").subscribe(h=>{m.value=h.List,m.value.forEach(V=>{[1,14].includes(V.Status)?V.type=1:[11,12,21,22,31,32,41,42,43,44].includes(V.Status)?V.type=2:[45,51,52,91].includes(V.Status)?V.type=3:V.type=4,g.value.includes(V.Category)||g.value.push(V.Category),o.value.includes(V.SupervisoryUnit)||o.value.push(V.SupervisoryUnit)})})}),(h,V)=>{const c=e.resolveComponent("input-text"),a=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Sk,[V[12]||(V[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Dk,[e.createElementVNode("div",Ak,[V[8]||(V[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",Fk,[V[5]||(V[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":V[0]||(V[0]=u=>e.unref(i).category=u)},[V[4]||(V[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(g),u=>(e.openBlock(),e.createElementBlock("option",{key:u,value:u},e.toDisplayString(u),9,Uk))),128))],512),[[e.vModelSelect,e.unref(i).category]])]),e.createElementVNode("div",Pk,[V[7]||(V[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":V[1]||(V[1]=u=>e.unref(i).unit=u)},[V[6]||(V[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),u=>(e.openBlock(),e.createElementBlock("option",{key:u,value:u},e.toDisplayString(u),9,Mk))),128))],512),[[e.vModelSelect,e.unref(i).unit]])])]),e.createElementVNode("div",Ik,[e.createElementVNode("div",jk,[V[9]||(V[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(c,{modelValue:e.unref(i).org,"onUpdate:modelValue":V[2]||(V[2]=u=>e.unref(i).org=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Ok,[V[10]||(V[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(c,{modelValue:e.unref(i).name,"onUpdate:modelValue":V[3]||(V[3]=u=>e.unref(i).name=u),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),V[11]||(V[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("ul",Lk,[e.createElementVNode("li",Rk,[V[14]||(V[14]=e.createElementVNode("div",{class:"total-item-title"},"總申請",-1)),e.createElementVNode("div",qk,[e.createElementVNode("span",zk,e.toDisplayString(e.unref(b).length),1),V[13]||(V[13]=e.createElementVNode("span",{class:"unit"},"件",-1))])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(x),u=>(e.openBlock(),e.createElementBlock("li",{class:"total-item",key:u},[e.createElementVNode("label",{class:"checke-total",for:`apply-${u.id}`},[e.createElementVNode("div",null,[e.createElementVNode("div",Jk,e.toDisplayString(u.title),1),e.createElementVNode("div",Yk,[e.createElementVNode("span",Qk,e.toDisplayString(e.unref(b).filter(E=>E.type===u.id).length),1),V[15]||(V[15]=e.createElementVNode("span",{class:"unit"},"件",-1))])]),V[16]||(V[16]=e.createElementVNode("img",{class:"check-icon",src:"../../assets/img/check-white.svg"},null,-1))],8,Gk),e.withDirectives(e.createElementVNode("input",{class:"total-checkbox",id:`apply-${u.id}`,type:"checkbox","onUpdate:modelValue":E=>u.checked=E},null,8,Hk),[[e.vModelCheckbox,u.checked]])]))),128))]),e.createElementVNode("div",Wk,[e.createElementVNode("div",Kk,[e.createElementVNode("div",Xk,[V[19]||(V[19]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[V[17]||(V[17]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",Zk,e.toDisplayString(e.unref(l).length),1),V[18]||(V[18]=e.createTextVNode(" 筆資料",-1))])]),V[20]||(V[20]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",vk,[e.createElementVNode("table",eu,[e.createElementVNode("thead",null,[V[23]||(V[23]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"申請本會補助")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"總經費")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"狀態")])])],-1)),e.createElementVNode("tr",tu,[V[21]||(V[21]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",lu,e.toDisplayString(e.unref(l).reduce((u,E)=>u+E.ApplyAmount,0).toLocaleString()),1),e.createElementVNode("td",ou,e.toDisplayString(e.unref(l).reduce((u,E)=>u+E.OtherAmount,0).toLocaleString()),1),e.createElementVNode("td",nu,e.toDisplayString(e.unref(l).reduce((u,E)=>u+E.ApplyAmount+E.OtherAmount,0).toLocaleString()),1),V[22]||(V[22]=e.createElementVNode("td",null,null,-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),u=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",ru,e.toDisplayString(u.Year),1),e.createElementVNode("td",au,e.toDisplayString(u.Category),1),e.createElementVNode("td",su,[e.createElementVNode("a",{class:"link-black",href:_(u),target:"_blank"},e.toDisplayString(u.ProjectName||"[未設定]"),9,du)]),e.createElementVNode("td",cu,e.toDisplayString(u.OrgName),1),e.createElementVNode("td",iu,e.toDisplayString(u.ApplyAmount.toLocaleString()),1),e.createElementVNode("td",mu,e.toDisplayString(u.OtherAmount.toLocaleString()),1),e.createElementVNode("td",pu,e.toDisplayString((u.ApplyAmount+u.OtherAmount).toLocaleString()),1),e.createElementVNode("td",Vu,[e.createElementVNode("span",fu,e.toDisplayString(e.unref(x).find(E=>E.id===u.type).title),1)])]))),128))])])]),e.createVNode(a,{count:e.unref(l).length,onChange:k,page:e.unref(N),"page-size":e.unref(n)},null,8,["count","page","page-size"])])],64)}}},Eu={class:"search bg-gray mt-4"},bu={class:"search-form"},gu={class:"row g-3"},yu={class:"col-12 col-lg-4"},ku=["value"],uu={class:"col-12 col-lg-4"},hu=["value"],xu={class:"row g-3"},$u={class:"col-12 col-lg-6"},Bu={class:"col-12 col-lg-6"},_u={class:"block rounded-bottom-4"},Cu={class:"title border-teal"},Tu={class:"d-flex align-items-center gap-2"},wu={class:"text-teal"},Su={class:"table-responsive",style:{"min-height":"400px"}},Du={class:"table teal-table"},Au={class:"total-row"},Fu={class:"text-end"},Uu={class:"text-end"},Pu={"data-th":"年度:"},Mu={"data-th":"類別:"},Iu={"data-th":"計畫名稱:",style:{"text-align":"left"}},ju=["href"],Ou={"data-th":"申請單位:",style:{"text-align":"left"}},Lu={"data-th":"本會補助金額:",class:"text-end"},Ru={"data-th":"配合款:",class:"text-end"},qu={__name:"ApprovedList",props:{category:{type:String}},setup(B){const x=B,g={ACC:"無障礙",CLB:"學校社團",CUL:"文化",EDC:"學校／民間",LIT:"素養",MUL:"多元",SCI:"科專"},i=e.ref([]),m=e.ref({}),N=e.ref([]),n=e.ref(1),o=e.ref(10),l=e.ref([]),d=e.computed(()=>b.value.slice((n.value-1)*o.value,n.value*o.value)),b=e.computed(()=>{let h=N.value;return m.value.category&&(h=h.filter(V=>V.Category===m.value.category)),m.value.unit&&(h=h.filter(V=>V.SupervisoryUnit===m.value.unit)),m.value.org&&(h=h.filter(V=>{var c;return(c=V.OrgName)==null?void 0:c.includes(m.value.org)})),m.value.name&&(h=h.filter(V=>{var c;return V.ProjectID.includes(m.value.name)||((c=V.ProjectName)==null?void 0:c.includes(m.value.name))})),h}),k=(h,V)=>{n.value=parseInt(h),o.value=parseInt(V)},_=h=>{if(h.ProjectID.includes("CUL"))return`../CUL/Audit.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("EDC"))return`../EDC/Audit.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("MUL"))return`../MUL/Audit.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("LIT"))return`../LIT/Audit.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("ACC"))return`../ACC/Audit.aspx?ID=${h.ProjectID}`;if(h.ProjectID.includes("CLB"))return`../Clb/ClbApproved.aspx?ProjectID=${h.ProjectID}`;if(h.ProjectID.includes("SCI"))return`../SCI/SciInprogress_Approved.aspx?ProjectID=${h.ProjectID}`};return e.onMounted(()=>{A.system("getApprovedList").subscribe(h=>{if(N.value=h.List,N.value.forEach(V=>{i.value.includes(V.Category)||i.value.push(V.Category),l.value.includes(V.SupervisoryUnit)||l.value.push(V.SupervisoryUnit)}),x.category){const V=g[x.category];i.value.includes(V)&&(m.value.category=V)}})}),(h,V)=>{const c=e.resolveComponent("input-text"),a=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Eu,[V[12]||(V[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",bu,[e.createElementVNode("div",gu,[V[8]||(V[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",yu,[V[5]||(V[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":V[0]||(V[0]=u=>e.unref(m).category=u)},[V[4]||(V[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),u=>(e.openBlock(),e.createElementBlock("option",{key:u,value:u},e.toDisplayString(u),9,ku))),128))],512),[[e.vModelSelect,e.unref(m).category]])]),e.createElementVNode("div",uu,[V[7]||(V[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":V[1]||(V[1]=u=>e.unref(m).unit=u)},[V[6]||(V[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),u=>(e.openBlock(),e.createElementBlock("option",{key:u,value:u},e.toDisplayString(u),9,hu))),128))],512),[[e.vModelSelect,e.unref(m).unit]])])]),e.createElementVNode("div",xu,[e.createElementVNode("div",$u,[V[9]||(V[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(c,{modelValue:e.unref(m).org,"onUpdate:modelValue":V[2]||(V[2]=u=>e.unref(m).org=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Bu,[V[10]||(V[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(c,{modelValue:e.unref(m).name,"onUpdate:modelValue":V[3]||(V[3]=u=>e.unref(m).name=u),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),V[11]||(V[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("div",_u,[e.createElementVNode("div",Cu,[e.createElementVNode("div",Tu,[V[15]||(V[15]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[V[13]||(V[13]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",wu,e.toDisplayString(e.unref(b).length),1),V[14]||(V[14]=e.createTextVNode(" 筆資料",-1))])]),V[16]||(V[16]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",Su,[e.createElementVNode("table",Du,[e.createElementVNode("thead",null,[V[18]||(V[18]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會補助金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])])],-1)),e.createElementVNode("tr",Au,[V[17]||(V[17]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",Fu,e.toDisplayString(e.unref(b).reduce((u,E)=>u+E.ApprovedAmount,0).toLocaleString()),1),e.createElementVNode("td",Uu,e.toDisplayString(e.unref(b).reduce((u,E)=>u+E.OtherAmount,0).toLocaleString()),1)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),u=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Pu,e.toDisplayString(u.Year),1),e.createElementVNode("td",Mu,e.toDisplayString(u.Category),1),e.createElementVNode("td",Iu,[e.createElementVNode("a",{class:"link-black",href:_(u),target:"_blank"},e.toDisplayString(u.ProjectName),9,ju)]),e.createElementVNode("td",Ou,e.toDisplayString(u.OrgName),1),e.createElementVNode("td",Lu,e.toDisplayString(u.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",Ru,e.toDisplayString(u.OtherAmount.toLocaleString()),1)]))),128))])])]),e.createVNode(a,{count:e.unref(b).length,onChange:k,page:e.unref(n),"page-size":e.unref(o)},null,8,["count","page","page-size"])])],64)}}},zu={class:"search bg-gray mt-4"},Gu={class:"search-form"},Ju={class:"row g-3"},Yu={class:"col-12 col-lg-4"},Qu=["value"],Hu={class:"col-12 col-lg-4"},Wu=["value"],Ku={class:"row g-3"},Xu={class:"col-12 col-lg-6"},Zu={class:"col-12 col-lg-6"},vu={class:"block rounded-bottom-4"},eh={class:"title border-teal"},th={class:"d-flex align-items-center gap-2"},lh={class:"text-teal"},oh={class:"table-responsive",style:{"min-height":"400px"}},nh={class:"table teal-table"},rh={class:"total-row"},ah={class:"text-end"},sh={class:"text-end"},dh={class:"text-end"},ch={class:"text-end"},ih={class:"text-end"},mh={"data-th":"年度:"},ph={"data-th":"類別:"},Vh={"data-th":"計畫名稱:",style:{"text-align":"left"}},fh=["href"],Nh={"data-th":"申請單位:",style:{"text-align":"left"}},Eh={"data-th":"本會補助金額:",class:"text-end"},bh={"data-th":"配合款:",class:"text-end"},gh={"data-th":"實支金額:",class:"text-end"},yh={"data-th":"累積經費執行率:",class:"text-end"},kh={"data-th":"本會已撥金額:",class:"text-end"},uh={__name:"InprogressList",setup(B){const x=e.ref([]),g=e.ref({}),i=e.ref([]),m=e.ref(1),N=e.ref(10),n=e.ref([]),o=e.computed(()=>b.value.reduce((V,c)=>V+c.ApprovedAmount,0)),l=e.computed(()=>b.value.slice((m.value-1)*N.value,m.value*N.value)),d=e.computed(()=>b.value.reduce((V,c)=>V+c.SpendAmount,0)),b=e.computed(()=>{let V=i.value;return g.value.category&&(V=V.filter(c=>c.Category===g.value.category)),g.value.unit&&(V=V.filter(c=>c.SupervisoryUnit===g.value.unit)),g.value.org&&(V=V.filter(c=>{var a;return(a=c.OrgName)==null?void 0:a.includes(g.value.org)})),g.value.name&&(V=V.filter(c=>{var a;return c.ProjectID.includes(g.value.name)||((a=c.ProjectName)==null?void 0:a.includes(g.value.name))})),V}),k=(V,c)=>{m.value=parseInt(V),N.value=parseInt(c)},_=V=>{if(V.ProjectID.includes("CUL"))return`../CUL/Audit.aspx?ID=${V.ProjectID}`;if(V.ProjectID.includes("EDC"))return`../EDC/Audit.aspx?ID=${V.ProjectID}`;if(V.ProjectID.includes("MUL"))return`../MUL/Audit.aspx?ID=${V.ProjectID}`;if(V.ProjectID.includes("LIT"))return`../LIT/Audit.aspx?ID=${V.ProjectID}`;if(V.ProjectID.includes("ACC"))return`../ACC/Audit.aspx?ID=${V.ProjectID}`;if(V.ProjectID.includes("CLB"))return`../Clb/ClbApproved.aspx?ProjectID=${V.ProjectID}`;if(V.ProjectID.includes("SCI"))return`../SCI/SciInprogress_Approved.aspx?ProjectID=${V.ProjectID}`},h=(V,c)=>c?Math.round(V*100/c*100)/100:0;return e.onMounted(()=>{A.system("getInprogressList").subscribe(V=>{i.value=V.List,i.value.forEach(c=>{x.value.includes(c.Category)||x.value.push(c.Category),n.value.includes(c.SupervisoryUnit)||n.value.push(c.SupervisoryUnit)})})}),(V,c)=>{const a=e.resolveComponent("input-text"),u=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zu,[c[12]||(c[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Gu,[e.createElementVNode("div",Ju,[c[8]||(c[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",Yu,[c[5]||(c[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":c[0]||(c[0]=E=>e.unref(g).category=E)},[c[4]||(c[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(x),E=>(e.openBlock(),e.createElementBlock("option",{key:E,value:E},e.toDisplayString(E),9,Qu))),128))],512),[[e.vModelSelect,e.unref(g).category]])]),e.createElementVNode("div",Hu,[c[7]||(c[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":c[1]||(c[1]=E=>e.unref(g).unit=E)},[c[6]||(c[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),E=>(e.openBlock(),e.createElementBlock("option",{key:E,value:E},e.toDisplayString(E),9,Wu))),128))],512),[[e.vModelSelect,e.unref(g).unit]])])]),e.createElementVNode("div",Ku,[e.createElementVNode("div",Xu,[c[9]||(c[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(a,{modelValue:e.unref(g).org,"onUpdate:modelValue":c[2]||(c[2]=E=>e.unref(g).org=E),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Zu,[c[10]||(c[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(a,{modelValue:e.unref(g).name,"onUpdate:modelValue":c[3]||(c[3]=E=>e.unref(g).name=E),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),c[11]||(c[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("div",vu,[e.createElementVNode("div",eh,[e.createElementVNode("div",th,[c[15]||(c[15]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[c[13]||(c[13]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",lh,e.toDisplayString(e.unref(b).length),1),c[14]||(c[14]=e.createTextVNode(" 筆資料",-1))])]),c[16]||(c[16]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",oh,[e.createElementVNode("table",nh,[e.createElementVNode("thead",null,[c[18]||(c[18]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會補助金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"實支金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"累積經費執行率")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會已撥金額")])])],-1)),e.createElementVNode("tr",rh,[c[17]||(c[17]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",ah,e.toDisplayString(e.unref(o).toLocaleString()),1),e.createElementVNode("td",sh,e.toDisplayString(e.unref(b).reduce((E,s)=>E+s.OtherAmount,0).toLocaleString()),1),e.createElementVNode("td",dh,e.toDisplayString(e.unref(d).toLocaleString()),1),e.createElementVNode("td",ch,e.toDisplayString(h(e.unref(d),e.unref(o)).toLocaleString())+"%",1),e.createElementVNode("td",ih,e.toDisplayString(e.unref(b).reduce((E,s)=>E+s.PaymentAmount,0).toLocaleString()),1)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),E=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",mh,e.toDisplayString(E.Year),1),e.createElementVNode("td",ph,e.toDisplayString(E.Category),1),e.createElementVNode("td",Vh,[e.createElementVNode("a",{class:"link-black",href:_(E),target:"_blank"},e.toDisplayString(E.ProjectName),9,fh)]),e.createElementVNode("td",Nh,e.toDisplayString(E.OrgName),1),e.createElementVNode("td",Eh,e.toDisplayString(E.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",bh,e.toDisplayString(E.OtherAmount.toLocaleString()),1),e.createElementVNode("td",gh,e.toDisplayString(E.SpendAmount.toLocaleString()),1),e.createElementVNode("td",yh,e.toDisplayString(h(E.SpendAmount,E.ApprovedAmount).toLocaleString())+"%",1),e.createElementVNode("td",kh,e.toDisplayString(E.PaymentAmount.toLocaleString()),1)]))),128))])])]),e.createVNode(u,{count:e.unref(b).length,onChange:k,page:e.unref(m),"page-size":e.unref(N)},null,8,["count","page","page-size"])])],64)}}},hh={__name:"MixChart",props:{list:{required:!0,type:Array}},setup(B){let x;const g=X().typeList,i=B,m=e.ref(),N=o=>{am5.ready(()=>{x=am5.Root.new(m.value),x.setThemes([am5themes_Animated.new(x)]);const l=x.container.children.push(am5xy.XYChart.new(x,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0,layout:x.verticalLayout})),d=am5xy.AxisRendererX.new(x,{minGridDistance:30});d.labels.template.setAll({rotation:-45,centerY:am5.p50,centerX:am5.p100,textAlign:"right"});var b=l.xAxes.push(am5xy.CategoryAxis.new(x,{categoryField:"category",renderer:d,tooltip:am5.Tooltip.new(x,{})}));b.data.setAll(o);var k=l.yAxes.push(am5xy.ValueAxis.new(x,{renderer:am5xy.AxisRendererY.new(x,{})})),_=l.yAxes.push(am5xy.ValueAxis.new(x,{renderer:am5xy.AxisRendererY.new(x,{opposite:!0}),min:0,max:1,numberFormat:"#.0%",extraMax:.1,strictMinMax:!0}));const h=(E,s,f)=>{var r=l.series.push(am5xy.ColumnSeries.new(x,{name:s,xAxis:b,yAxis:k,valueYField:E,categoryXField:"category",clustered:!0,tooltip:am5.Tooltip.new(x,{labelText:"{name}: {valueY}"})}));return r.data.setAll(o),r.columns.template.setAll({fillOpacity:1,strokeOpacity:0,fill:am5.color(f),cornerRadiusTL:0,cornerRadiusTR:0,width:am5.percent(70)}),r};h("核定經費","核定經費",4946924),h("實支金額","實支金額",9323693),h("已撥付","已撥付",3447003);const V=(E,s,f)=>{var r=l.series.push(am5xy.LineSeries.new(x,{name:s,xAxis:b,yAxis:_,valueYField:E,categoryXField:"category",stroke:am5.color(f),fill:am5.color(f),tooltip:am5.Tooltip.new(x,{labelText:"{name}: {valueY.formatNumber('#.0%')}"})}));return r.strokes.template.setAll({strokeWidth:3}),r.bullets.push(()=>am5.Bullet.new(x,{sprite:am5.Circle.new(x,{radius:5,fill:r.get("stroke")})})),r.data.setAll(o),r};V("經費執行率(%)","經費執行率(%)",15105570),V("支用比(%)","支用比(%)",2600544),l.children.push(am5.Legend.new(x,{centerX:am5.p50,x:am5.p50,layout:x.horizontalLayout,useDefaultMarker:!0,maxWidth:300})).labels.template.setAll({fontSize:12,paddingLeft:4,paddingRight:4,marginTop:4,marginBottom:4,marginLeft:4,marginRight:4});var a=l.children.push(am5.Legend.new(x,{centerX:am5.p0,x:am5.p0,layout:x.horizontalLayout,useDefaultMarker:!0,maxWidth:300}));a.data.setAll([l.series.getIndex(0),l.series.getIndex(1),l.series.getIndex(2)]);var u=l.children.push(am5.Legend.new(x,{centerX:am5.p100,x:am5.p100,layout:x.horizontalLayout,useDefaultMarker:!0,maxWidth:300}));u.data.setAll([l.series.getIndex(3),l.series.getIndex(4)]),l.set("cursor",am5xy.XYCursor.new(x,{}))})},n=(o,l,d=2)=>{if(l){const b=10**d;return Math.round(o*100/l*b)/b}return 0};return e.onMounted(()=>{N(g.map(o=>{const l={category:o.title,核定經費:0,實支金額:0,已撥付:0,"經費執行率(%)":0,"支用比(%)":0},d=i.list.find(b=>b.Category===o.code);return d&&(l.核定經費=Math.floor(d.ApprovedAmount/1e3),l.實支金額=Math.floor(d.SpendAmount/1e3),l.已撥付=Math.floor(d.PaymentAmount/1e3),l["經費執行率(%)"]=n(l.實支金額,l.核定經費,1),l["支用比(%)"]=n(l.實支金額,l.已撥付,1)),l}))}),(o,l)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"container",ref:m},null,512))}},xh={__name:"PieChart",props:{active:{required:!0,type:String},color:{required:!0,type:Number},inactive:{required:!0,type:String},percent:{required:!0,type:Number}},setup(B){let x,g,i;const m=B,N=e.ref();return e.onMounted(()=>{am5.ready(()=>{g=am5.Root.new(N.value),g.setThemes([am5themes_Animated.new(g)]);const n=g.container.children.push(am5percent.PieChart.new(g,{innerRadius:95,width:158,x:am5.p50,y:am5.p50,centerX:am5.p50,centerY:am5.p50,layout:g.verticalLayout}));i=n.series.push(am5percent.PieSeries.new(g,{valueField:"size",categoryField:"sector"})),i.set("colors",am5.ColorSet.new(g,{colors:[am5.color(m.color),am5.color(16119285)]})),i.labels.template.set("visible",!1),i.ticks.template.set("visible",!1),i.data.setAll([{sector:m.active,size:m.percent},{sector:m.inactive,size:100-m.percent}]),i.appear(1e3,100),x=g.tooltipContainer.children.push(am5.Label.new(g,{x:am5.p50,y:am5.p50,centerX:am5.p50,centerY:am5.p50,fill:am5.color(m.color),fontSize:28,fontWeight:"bold"})),x.set("text",`${m.percent}%`);const o=()=>{var l=window.innerWidth>=768&&window.innerWidth<=1024,d=l?105:158,b=l?55:95,k=l?20:28;n.set("width",d),n.set("innerRadius",b),x.set("fontSize",k)};o(),window.addEventListener("resize",o)})}),e.watch(()=>m.percent,n=>{x.set("text",`${n}%`),i.data.setAll([{sector:m.active,size:n},{sector:m.inactive,size:100-n}])}),(n,o)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"container",ref:N},null,512))}},$h={class:"search bg-gray mt-4"},Bh={class:"search-form"},_h={class:"row g-3"},Ch={class:"col-12 col-lg-4"},Th={class:"col-12 col-lg-4"},wh={class:"col-12 col-lg-4"},Sh={class:"row g-3"},Dh={class:"col-12"},Ah={class:"block rounded-bottom-4"},Fh={class:"title border-teal"},Uh={class:"d-flex align-items-center gap-2"},Ph={class:"text-teal"},Mh={class:"table-responsive",style:{"min-height":"400px"}},Ih={class:"table teal-table"},jh={"data-th":"年度:"},Oh={"data-th":"計畫名稱:",class:"text-start"},Lh=["href"],Rh={"data-th":"計畫申請單位:",class:"text-start"},qh={"data-th":"委員姓名:"},zh={"data-th":"任職單位:",class:"text-start"},Gh={"data-th":"職稱:"},Jh={"data-th":"應迴避之具體理由及事證:",class:"text-start"},Yh={__name:"RecusedList",setup(B){const x=e.ref({Year:0,Keyword:"",Name:"",Org:""}),g=e.ref([]),i=e.ref(1),m=e.ref(10),N=[],n=e.computed(()=>g.value.slice((i.value-1)*m.value,i.value*m.value)),o=(b,k)=>{i.value=parseInt(b),m.value=parseInt(k)},l=()=>{A.system("downloadRecusedList",x.value).subscribe(b=>{const k=document.createElement("a");k.download="迴避審查委員名單.xlsx",k.href=A.download(b.filename),k.click()})},d=()=>{A.system("getRecusedList",x.value).subscribe(b=>{g.value=b.List,i.value=1})};for(let b=new Date().getFullYear()-1911;b>=114;b--)N.push({text:`${b} 年`,value:b});return e.onMounted(d),(b,k)=>{const _=e.resolveComponent("input-select"),h=e.resolveComponent("input-text"),V=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",$h,[k[9]||(k[9]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Bh,[e.createElementVNode("div",_h,[e.createElementVNode("div",Ch,[k[4]||(k[4]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度",-1)),e.createVNode(_,{"empty-value":0,options:N,modelValue:e.unref(x).Year,"onUpdate:modelValue":k[0]||(k[0]=c=>e.unref(x).Year=c)},null,8,["modelValue"])]),e.createElementVNode("div",Th,[k[5]||(k[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"委員姓名, 任職單位, 職稱",-1)),e.createVNode(h,{placeholder:"請輸入委員姓名, 任職單位, 職稱",modelValue:e.unref(x).Keyword,"onUpdate:modelValue":k[1]||(k[1]=c=>e.unref(x).Keyword=c),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",wh,[k[6]||(k[6]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫名稱",-1)),e.createVNode(h,{placeholder:"請輸入計畫名稱",modelValue:e.unref(x).Name,"onUpdate:modelValue":k[2]||(k[2]=c=>e.unref(x).Name=c),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("div",Sh,[e.createElementVNode("div",Dh,[k[7]||(k[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫申請單位",-1)),e.createVNode(h,{placeholder:"請輸入計畫申請單位",modelValue:e.unref(x).Org,"onUpdate:modelValue":k[3]||(k[3]=c=>e.unref(x).Org=c),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",onClick:d,type:"button"},[...k[8]||(k[8]=[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"},null,-1),e.createTextVNode(" 查詢 ",-1)])])])]),e.createElementVNode("div",Ah,[e.createElementVNode("div",Fh,[e.createElementVNode("div",Uh,[k[12]||(k[12]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[k[10]||(k[10]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",Ph,e.toDisplayString(e.unref(g).length),1),k[11]||(k[11]=e.createTextVNode(" 筆資料",-1))])]),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:l,type:"button"},[...k[13]||(k[13]=[e.createElementVNode("i",{class:"fas fa-download"},null,-1),e.createTextVNode("匯出",-1)])])]),e.createElementVNode("div",Mh,[e.createElementVNode("table",Ih,[k[14]||(k[14]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"委員姓名")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"任職單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"職稱")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"應迴避之具體理由及事證")])])])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),c=>(e.openBlock(),e.createElementBlock("tr",{key:c},[e.createElementVNode("td",jh,e.toDisplayString(c.Year),1),e.createElementVNode("td",Oh,[e.createElementVNode("a",{class:"link-black",href:`../SCI/SciApplication.aspx?ProjectID=${c.ProjectID}`,target:"_blank"},e.toDisplayString(c.ProjectNameTw),9,Lh)]),e.createElementVNode("td",Rh,e.toDisplayString(c.OrgName),1),e.createElementVNode("td",qh,e.toDisplayString(c.RecusedName),1),e.createElementVNode("td",zh,e.toDisplayString(c.EmploymentUnit),1),e.createElementVNode("td",Gh,e.toDisplayString(c.JobTitle),1),e.createElementVNode("td",Jh,e.toDisplayString(c.RecusedReason),1)]))),128))])])]),e.createVNode(V,{count:e.unref(g).length,onChange:o,page:e.unref(i),"page-size":e.unref(m)},null,8,["count","page","page-size"])])],64)}}},Qh={class:"block rounded-bottom-4"},Hh={class:"title border-teal"},Wh={class:"d-flex align-items-center gap-2"},Kh={class:"text-teal"},Xh={class:"table-responsive",style:{"min-height":"400px"}},Zh={class:"table teal-table"},vh={"data-th":"委員姓名:",class:"text-start"},ex={"data-th":"審查階段:",class:"text-start"},tx={"data-th":"類別:",class:"text-start"},lx={"data-th":"計畫編號:"},ox={"data-th":"計畫名稱:",class:"text-start"},nx={__name:"ReviewerDetails",props:{id:{type:String},type:{type:String}},setup(B){const x=B,g=e.ref({ID:x.id,Type:x.type}),i=e.ref([]),m=e.ref(1),N=e.ref(10),n=e.computed(()=>i.value.slice((m.value-1)*N.value,m.value*N.value)),o=(d,b)=>{m.value=parseInt(d),N.value=parseInt(b)},l=()=>{A.system("downloadReviewerDetails",g.value).subscribe(d=>{const b=document.createElement("a");b.download="審查計畫.xlsx",b.href=A.download(d.filename),b.click()})};return e.onMounted(()=>{A.system("getReviewerDetails",g.value).subscribe(d=>{i.value=d.List,m.value=1})}),(d,b)=>{const k=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock("div",Qh,[e.createElementVNode("div",Hh,[e.createElementVNode("div",Wh,[b[2]||(b[2]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg"}),e.createElementVNode("span",null,"審查計畫")],-1)),e.createElementVNode("span",null,[b[0]||(b[0]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",Kh,e.toDisplayString(e.unref(i).length),1),b[1]||(b[1]=e.createTextVNode(" 筆資料",-1))])]),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:l,type:"button"},[...b[3]||(b[3]=[e.createElementVNode("i",{class:"fas fa-download"},null,-1),e.createTextVNode("匯出",-1)])])]),e.createElementVNode("div",Xh,[e.createElementVNode("table",Zh,[b[4]||(b[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"委員姓名")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"審查階段")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"計畫編號")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"計畫名稱")])])])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),_=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",vh,e.toDisplayString(_.CommitteeUser),1),e.createElementVNode("td",ex,e.toDisplayString(B.type==1?"申請計畫":"執行計畫")+"／"+e.toDisplayString(_.ReviewStage),1),e.createElementVNode("td",tx,e.toDisplayString(_.FieldName),1),e.createElementVNode("td",lx,e.toDisplayString(_.ProjectID),1),e.createElementVNode("td",ox,e.toDisplayString(_.ProjectName),1)]))),128))])])]),e.createVNode(k,{count:e.unref(i).length,onChange:o,page:e.unref(m),"page-size":e.unref(N)},null,8,["count","page","page-size"])])}}},rx={class:"search bg-gray mt-4"},ax={class:"search-form"},sx={class:"row g-3"},dx={class:"col-3"},cx={class:"col-3"},ix={class:"col-3"},mx={class:"col-3"},px={class:"block rounded-bottom-4"},Vx={class:"title border-teal"},fx={class:"d-flex align-items-center gap-2"},Nx={class:"text-teal"},Ex={class:"table-responsive",style:{"min-height":"400px"}},bx={class:"table teal-table"},gx={"data-th":"委員姓名:"},yx={"data-th":"Email:",class:"text-start"},kx={"data-th":"審查階段:"},ux={"data-th":"審查計畫件數:"},hx=["href"],xx={"data-th":"銀行帳戶:",class:"text-start"},$x=["onClick"],Bx={key:1},_x={"data-th":"戶籍地址:",class:"text-start"},Cx={"data-th":"更新時間:",class:"text-start"},Tx={class:"modal-dialog modal-dialog-centered modal-xl"},wx={class:"modal-content"},Sx={class:"modal-body"},Dx={class:"mb-5"},Ax=["src"],Fx={__name:"ReviewerList",setup(B){const x=e.ref({Type:0,Keyword:"",Begin:"",End:""}),g=e.ref([]),i=e.ref(),m=e.ref(1),N=e.ref(10),n=e.ref({}),o=[{text:"申請計畫審查",value:1},{text:"執行計畫審查",value:2}],l=e.computed(()=>g.value.slice((m.value-1)*N.value,m.value*N.value)),d=(h,V)=>{m.value=parseInt(h),N.value=parseInt(V)},b=()=>{A.system("downloadReviewerList",x.value).subscribe(h=>{const V=document.createElement("a");V.download="審查委員名單.xlsx",V.href=A.download(h.filename),V.click()})},k=h=>{var V;n.value=h.Type===1?A.download(h.BankPhoto):A.sciDownload("downloadbankbook",{token:(V=h.BankPhoto)==null?void 0:V.trim()}),bootstrap.Modal.getOrCreateInstance(i.value).show()},_=()=>{A.system("getReviewerList",x.value).subscribe(h=>{g.value=h.List,m.value=1})};return e.onMounted(_),(h,V)=>{const c=e.resolveComponent("input-select"),a=e.resolveComponent("input-text"),u=e.resolveComponent("input-tw-date"),E=e.resolveComponent("tw-date-time"),s=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",rx,[V[9]||(V[9]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",ax,[e.createElementVNode("div",sx,[e.createElementVNode("div",dx,[V[4]||(V[4]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"審查階段",-1)),e.createVNode(c,{"empty-value":0,options:o,modelValue:e.unref(x).Type,"onUpdate:modelValue":V[0]||(V[0]=f=>e.unref(x).Type=f)},null,8,["modelValue"])]),e.createElementVNode("div",cx,[V[5]||(V[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"委員姓名, Email",-1)),e.createVNode(a,{placeholder:"請輸入委員姓名, Email",modelValue:e.unref(x).Keyword,"onUpdate:modelValue":V[1]||(V[1]=f=>e.unref(x).Keyword=f),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",ix,[V[6]||(V[6]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"開始時間",-1)),e.createVNode(u,{modelValue:e.unref(x).Begin,"onUpdate:modelValue":V[2]||(V[2]=f=>e.unref(x).Begin=f)},null,8,["modelValue"])]),e.createElementVNode("div",mx,[V[7]||(V[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"結束時間",-1)),e.createVNode(u,{modelValue:e.unref(x).End,"onUpdate:modelValue":V[3]||(V[3]=f=>e.unref(x).End=f)},null,8,["modelValue"])])]),e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",onClick:_,type:"button"},[...V[8]||(V[8]=[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"},null,-1),e.createTextVNode(" 查詢 ",-1)])])])]),e.createElementVNode("div",px,[e.createElementVNode("div",Vx,[e.createElementVNode("div",fx,[V[12]||(V[12]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[V[10]||(V[10]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",Nx,e.toDisplayString(e.unref(g).length),1),V[11]||(V[11]=e.createTextVNode(" 筆資料",-1))])]),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:b,type:"button"},[...V[13]||(V[13]=[e.createElementVNode("i",{class:"fas fa-download"},null,-1),e.createTextVNode("匯出",-1)])])]),e.createElementVNode("div",Ex,[e.createElementVNode("table",bx,[V[14]||(V[14]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"委員姓名")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"Email")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"審查階段")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"審查計畫件數")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"銀行帳戶")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"戶籍地址")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-start"},[e.createElementVNode("span",null,"更新時間")])])])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),f=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",gx,e.toDisplayString(f.CommitteeUser),1),e.createElementVNode("td",yx,e.toDisplayString(f.Email),1),e.createElementVNode("td",kx,e.toDisplayString(f.Type===1?"申請計畫":"執行計畫"),1),e.createElementVNode("td",ux,[e.createElementVNode("a",{class:"link-black",href:`ReviewerList${f.Type}.aspx?ID=${f.ID}`,target:"_blank"},e.toDisplayString(f.Count),9,hx)]),e.createElementVNode("td",xx,[f.BankPhoto?(e.openBlock(),e.createElementBlock("a",{key:0,onClick:e.withModifiers(r=>k(f),["prevent"]),href:"#"},e.toDisplayString(f.BankCode)+" "+e.toDisplayString(f.BankName)+" "+e.toDisplayString(f.BankAccount),9,$x)):(e.openBlock(),e.createElementBlock("span",Bx,e.toDisplayString(f.BankCode)+" "+e.toDisplayString(f.BankName)+" "+e.toDisplayString(f.BankAccount),1))]),e.createElementVNode("td",_x,e.toDisplayString(f.RegistrationAddress),1),e.createElementVNode("td",Cx,[e.createVNode(E,{value:f.UpdateTime},null,8,["value"])])]))),128))])])]),e.createVNode(s,{count:e.unref(g).length,onChange:d,page:e.unref(m),"page-size":e.unref(N)},null,8,["count","page","page-size"])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade",ref_key:"modal",ref:i,tabindex:"-1"},[e.createElementVNode("div",Tx,[e.createElementVNode("div",wx,[V[16]||(V[16]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Sx,[e.createElementVNode("div",Dx,[e.createElementVNode("img",{class:"img-fluid",src:e.unref(n)},null,8,Ax)]),V[15]||(V[15]=e.createElementVNode("div",{class:"d-flex justify-content-center"},[e.createElementVNode("button",{class:"btn btn-primary","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))],64)}}},Ux={key:0,class:"text-pink"},Px={__name:"RequiredLabel",setup(B){const x=e.inject("editable",!0);return(g,i)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(x)?(e.openBlock(),e.createElementBlock("span",Ux,"* ")):e.createCommentVNode("",!0),e.renderSlot(g.$slots,"default")],64))}},Mx={class:"block"},Ix={class:"mt-4"},jx={class:"table align-middle gray-table side-table"},Ox={class:"d-flex gap-2"},Lx=["src"],Rx={key:0,class:"invalid mt-0"},qx={__name:"ReviewCommitteeInfo",props:{token:{type:String}},setup(B){const x=B,g=e.ref([]),i=e.ref({}),m=e.ref({}),N=d=>{m.value.BankPhoto=d.Path},n=A.download,o=()=>{if(i.value={},!l()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Token:x.token,BankCode:m.value.BankCode,BankAccount:m.value.BankAccount,BankPhoto:m.value.BankPhoto,RegistrationAddress:m.value.RegistrationAddress};A.system("saveReviewCommittee",d).subscribe(b=>{b&&alert("儲存成功")})},l=()=>{let d={BankCode:"^請選擇銀行",BankAccount:"帳戶號碼",BankPhoto:"^請上傳存摺影本",RegistrationAddress:"戶籍地址"};return i.value=M(m.value,d),!Object.keys(i.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.system("getZgsCodes",{CodeGroup:"BankCode"}),A.system("getReviewCommittee",{Token:x.token})]).subscribe(d=>{g.value=d[0],m.value=d[1].Data})}),(d,b)=>{const k=e.resolveComponent("required-label"),_=e.resolveComponent("input-select"),h=e.resolveComponent("input-text"),V=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Mx,[b[7]||(b[7]=e.createElementVNode("h5",{class:"square-title"},"委員資料",-1)),e.createElementVNode("div",Ix,[e.createElementVNode("table",jx,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[b[3]||(b[3]=e.createElementVNode("th",null,"審查委員",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(m).CommitteeUser)+" ("+e.toDisplayString(e.unref(m).Email)+") ",1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...b[4]||(b[4]=[e.createTextVNode("銀行帳戶",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ox,[e.createElementVNode("div",null,[e.createVNode(_,{"empty-value":null,error:e.unref(i).BankCode,options:e.unref(g),placeholder:"請選擇銀行","text-name":"Descname","value-name":"Code",modelValue:e.unref(m).BankCode,"onUpdate:modelValue":b[0]||(b[0]=c=>e.unref(m).BankCode=c)},null,8,["error","options","modelValue"])]),e.createElementVNode("div",null,[e.createVNode(h,{error:e.unref(i).BankAccount,placeholder:"帳戶號碼",modelValue:e.unref(m).BankAccount,"onUpdate:modelValue":b[1]||(b[1]=c=>e.unref(m).BankAccount=c),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...b[5]||(b[5]=[e.createTextVNode("存摺影本",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(V,{accept:".jpg,.png",onFile:N}),e.unref(m).BankPhoto?(e.openBlock(),e.createElementBlock("img",{key:0,class:"img-fluid mt-2",src:e.unref(n)(e.unref(m).BankPhoto)},null,8,Lx)):e.createCommentVNode("",!0)]),e.unref(i).BankPhoto?(e.openBlock(),e.createElementBlock("div",Rx,e.toDisplayString(e.unref(i).BankPhoto),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...b[6]||(b[6]=[e.createTextVNode("戶籍地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(i).RegistrationAddress,placeholder:"(郵遞區號)完整地址",modelValue:e.unref(m).RegistrationAddress,"onUpdate:modelValue":b[2]||(b[2]=c=>e.unref(m).RegistrationAddress=c),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.createElementVNode("div",{class:"block-bottom bg-light-teal"},[e.createElementVNode("button",{class:"btn btn-teal",onClick:o,type:"button"},[...b[8]||(b[8]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確定送出",-1)])])])],64)}}},zx={class:"block"},Gx={class:"table align-middle gray-table side-table mt-4"},Jx=["value"],Yx={key:0,class:"tag-group mt-2 gap-1"},Qx={class:"tag tag-green-light"},Hx=["download","href"],Wx={key:1},Kx={key:2,class:"invalid mt-0"},Xx={class:"table align-middle gray-table side-table mt-4"},Zx={class:"d-flex align-items-center flex-wrap"},vx={class:"d-flex align-items-center text-nowrap me-3"},e$={class:"d-flex align-items-center text-nowrap"},t$={key:0,class:"invalid mt-0"},l$={key:0,class:"table align-middle gray-table"},o$={width:"1%"},n$={class:"row"},r$={class:"col"},a$={class:"col"},s$={width:"1%"},d$={class:"d-flex gap-2"},c$=["onClick"],i$={key:0},m$={class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},p$={__name:"GrantForm1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=X().typeList,m=e.ref(!1),N=e.ref({}),n=e.ref({}),o=e.ref(),l=e.computed(()=>_.value.filter(u=>!u.Deleted)),d=e.computed(()=>k.value.filter(u=>!u.Deleted)),b=e.ref({}),k=e.ref([]),_=e.ref([]),h=A.download,V=x,c=u=>{var s,f,r;if(n.value={},N.value.Path=(s=o.value)==null?void 0:s.Path,N.value.Filename=(f=o.value)==null?void 0:f.Name,u){if(!a()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}N.value.Status=m.value?2:1}b.value.ShortName=(r=i.find(t=>t.code===b.value.TypeCode))==null?void 0:r.title;const E={GrantType:b.value,Content:N.value,Procedures:_.value,Links:k.value,Submit:u?"true":"false"};A.system("saveGrantTypeContent",E).subscribe(t=>{t&&V("next")})},a=()=>{let u={ServiceContent:"內容",ContactPerson:"聯絡電話及分機",ContactTel:"聯絡人",Filename:"相關檔案"};return m.value&&(u.StatusReason="下架原因"),n.value=M(N.value,u),g.id||(u={TypeCode:"補助類別",Year:"年度",FullName:"補助類別全稱"},Object.assign(n.value,M(b.value,u))),l.value.length&&(u={Content:"內容"},l.value.forEach((E,s)=>Object.assign(n.value,M(E,u,`procedure-${s}-`)))),d.value.length&&(u={Title:"參考資料名稱",URL:"網址"},d.value.forEach((E,s)=>Object.assign(n.value,M(E,u,`link-${s}-`)))),!Object.keys(n.value).length};return e.onMounted(()=>{g.id?A.system("getGrantTypeContent",{ID:g.id}).subscribe(u=>{b.value=u.GrantType,N.value=u.Content,_.value=u.Procedures,k.value=u.Links,N.value.Filename&&(o.value={Name:N.value.Filename,Path:N.value.Path}),_.value.length?_.value.forEach((E,s)=>{s&&(E.Deleted=!0)}):_.value.push({}),X().init(b.value.TypeCode)}):_.value.push({})}),(u,E)=>{const s=e.resolveComponent("required-label"),f=e.resolveComponent("input-select"),r=e.resolveComponent("input-integer"),t=e.resolveComponent("input-text"),p=e.resolveComponent("input-file"),y=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock("div",zx,[E[37]||(E[37]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("table",Gx,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[17]||(E[17]=[e.createTextVNode("補助類別(代碼)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{class:"w-auto",error:e.unref(n).TypeCode,options:e.unref(i),modelValue:e.unref(b).TypeCode,"onUpdate:modelValue":E[0]||(E[0]=S=>e.unref(b).TypeCode=S)},{default:e.withCtx(({option:S})=>[e.createElementVNode("option",{value:S.code},e.toDisplayString(S.title)+" ("+e.toDisplayString(S.code)+")",9,Jx)]),_:1},8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[18]||(E[18]=[e.createTextVNode("年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{class:"w-auto",error:e.unref(n).Year,modelValue:e.unref(b).Year,"onUpdate:modelValue":E[1]||(E[1]=S=>e.unref(b).Year=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[19]||(E[19]=[e.createTextVNode("補助類別全稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(n).FullName,modelValue:e.unref(b).FullName,"onUpdate:modelValue":E[2]||(E[2]=S=>e.unref(b).FullName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[20]||(E[20]=[e.createTextVNode("相關檔案",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(顯示於首頁)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(o)?(e.openBlock(),e.createElementBlock("div",Yx,[e.createElementVNode("span",Qx,[e.createElementVNode("a",{class:"tag-link my-1",download:e.unref(o).Name,href:e.unref(h)(e.unref(o).Path)},e.toDisplayString(e.unref(o).Name),9,Hx),e.createElementVNode("button",{class:"tag-btn",onClick:E[3]||(E[3]=S=>o.value=null),type:"button"},[...E[21]||(E[21]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])])])])):(e.openBlock(),e.createElementBlock("div",Wx,[e.createVNode(p,{onFile:E[4]||(E[4]=S=>o.value=S)})])),e.unref(n).Filename?(e.openBlock(),e.createElementBlock("div",Kx,e.toDisplayString(e.unref(n).Filename),1)):e.createCommentVNode("",!0)])])])]),E[38]||(E[38]=e.createElementVNode("h5",{class:"square-title mt-4"},"我的E政府",-1)),e.createElementVNode("table",Xx,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[22]||(E[22]=[e.createTextVNode("補助類別全稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{disabled:"",modelValue:e.unref(b).FullName,"onUpdate:modelValue":E[5]||(E[5]=S=>e.unref(b).FullName=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[23]||(E[23]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(n).ServiceContent,modelValue:e.unref(N).ServiceContent,"onUpdate:modelValue":E[6]||(E[6]=S=>e.unref(N).ServiceContent=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[E[24]||(E[24]=e.createElementVNode("th",null,"關鍵字",-1)),e.createElementVNode("td",null,[e.createVNode(t,{modelValue:e.unref(N).Keywords,"onUpdate:modelValue":E[7]||(E[7]=S=>e.unref(N).Keywords=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[E[25]||(E[25]=e.createElementVNode("th",null,"申辦資格",-1)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(N).Criteria,"onUpdate:modelValue":E[8]||(E[8]=S=>e.unref(N).Criteria=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[26]||(E[26]=[e.createTextVNode("申辦流程",-1)])]),_:1})]),e.createElementVNode("td",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(S,C)=>(e.openBlock(),e.createBlock(y,{key:S,error:e.unref(n)[`procedure-${C}-Content`],modelValue:S.Content,"onUpdate:modelValue":w=>S.Content=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"]))),128))])]),e.createElementVNode("tr",null,[E[27]||(E[27]=e.createElementVNode("th",null,"應備物品",-1)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(N).Documentary,"onUpdate:modelValue":E[9]||(E[9]=S=>e.unref(N).Documentary=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...E[28]||(E[28]=[e.createTextVNode("聯絡窗口",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Zx,[e.createElementVNode("div",vx,[E[29]||(E[29]=e.createElementVNode("label",{class:"me-2"},"聯絡電話及分機",-1)),e.createVNode(t,{modelValue:e.unref(N).ContactTel,"onUpdate:modelValue":E[10]||(E[10]=S=>e.unref(N).ContactTel=S),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",e$,[E[30]||(E[30]=e.createElementVNode("label",{class:"me-2"},"聯絡人",-1)),e.createVNode(t,{modelValue:e.unref(N).ContactPerson,"onUpdate:modelValue":E[11]||(E[11]=S=>e.unref(N).ContactPerson=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.unref(n).ContactTel||e.unref(n).ContactPerson?(e.openBlock(),e.createElementBlock("div",t$,e.toDisplayString(e.unref(n).ContactTel||e.unref(n).ContactPerson),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[E[33]||(E[33]=e.createElementVNode("th",null,[e.createTextVNode("線上申辦"),e.createElementVNode("br"),e.createTextVNode("參考資料")],-1)),e.createElementVNode("td",null,[e.unref(d).length?(e.openBlock(),e.createElementBlock("table",l$,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(S,C)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",o$,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",n$,[e.createElementVNode("div",r$,[e.createVNode(t,{error:e.unref(n)[`link-${C}-Title`],placeholder:"參考資料名稱",modelValue:S.Title,"onUpdate:modelValue":w=>S.Title=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",a$,[e.createVNode(t,{error:e.unref(n)[`link-${C}-URL`],placeholder:"網址",modelValue:S.URL,"onUpdate:modelValue":w=>S.URL=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("td",s$,[e.createElementVNode("div",d$,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:w=>S.Deleted=!0,type:"button"},[...E[31]||(E[31]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,c$)])])]))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:E[12]||(E[12]=S=>e.unref(k).push({})),type:"button"},[...E[32]||(E[32]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增",-1)])])])]),e.unref(N).Status===1?(e.openBlock(),e.createElementBlock("tr",i$,[E[35]||(E[35]=e.createElementVNode("th",null,"申請下架",-1)),e.createElementVNode("td",null,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"status-checkbox",type:"checkbox","onUpdate:modelValue":E[13]||(E[13]=S=>e.isRef(m)?m.value=S:null)},null,512),[[e.vModelCheckbox,e.unref(m)]]),E[34]||(E[34]=e.createElementVNode("label",{class:"form-check-label ms-1 mb-2",for:"status-checkbox"},"申請E政府下架（請輸入原因）",-1)),e.createVNode(y,{error:e.unref(n).StatusReason,modelValue:e.unref(N).StatusReason,"onUpdate:modelValue":E[14]||(E[14]=S=>e.unref(N).StatusReason=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",m$,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:E[15]||(E[15]=S=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:E[16]||(E[16]=S=>c(!0)),type:"button"},[...E[36]||(E[36]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確定發布",-1)])])])])}}},V$={class:"block"},f$={class:"table align-middle gray-table side-table"},N$={class:"p-0"},E$={class:"row align-items-center mb-0"},b$={class:"col p-4"},g$={class:"col p-4"},y$={class:"col p-4"},k$={class:"d-flex align-items-center flex-wrap gap-2"},u$={class:"input-group",style:{width:"360px"}},h$={class:"d-flex align-items-center flex-wrap gap-2"},x$={class:"input-group",style:{width:"360px"}},$$={style:{width:"360px"}},B$={class:"d-flex align-items-center mb-2"},_$={class:"d-flex align-items-center mb-2"},C$={class:"d-flex align-items-center mb-2"},T$={class:"d-flex align-items-center mb-2"},w$={class:"d-flex align-items-center gap-2"},S$={class:"d-flex align-items-center flex-wrap gap-2"},D$={class:"input-group",style:{width:"360px"}},A$={class:"d-flex align-items-center flex-wrap gap-2"},F$={class:"input-group",style:{width:"360px"}},U$={__name:"GrantForm2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref({}),m=e.ref(!1),N=x,n=()=>{const o={};m.value||(i.value.OverduePeriod=null),A.system("saveGrantType",{GrantType:Object.assign(i.value,o)}).subscribe(l=>{l&&N("next")})};return e.onMounted(()=>{A.system("getGrantType",{ID:g.id}).subscribe(o=>{i.value=o.GrantType,i.value.OverduePeriod&&(m.value=!0)})}),(o,l)=>{const d=e.resolveComponent("input-integer"),b=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-tw-date"),_=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock("div",V$,[e.createElementVNode("table",f$,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[18]||(l[18]=e.createElementVNode("th",null,"補助類別 全稱",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(i).FullName),1)]),e.createElementVNode("tr",null,[l[21]||(l[21]=e.createElementVNode("th",null,"補助類別 簡稱",-1)),e.createElementVNode("td",N$,[e.createElementVNode("div",E$,[e.createElementVNode("div",b$,e.toDisplayString(e.unref(i).ShortName),1),l[19]||(l[19]=e.createElementVNode("div",{class:"col p-4 text-nowrap",style:{"border-right":"8px solid #DDDDDD","background-color":"#F5F5F5"}},"代碼",-1)),e.createElementVNode("div",g$,e.toDisplayString(e.unref(i).TypeCode),1),l[20]||(l[20]=e.createElementVNode("div",{class:"col p-4 text-nowrap",style:{"border-right":"8px solid #DDDDDD","background-color":"#F5F5F5"}},"年度",-1)),e.createElementVNode("div",y$,e.toDisplayString(e.unref(i).Year),1)])])]),e.createElementVNode("tr",null,[l[22]||(l[22]=e.createElementVNode("th",null,"總預算經費(元)",-1)),e.createElementVNode("td",null,[e.createVNode(d,{class:"w-auto",modelValue:e.unref(i).BudgetFees,"onUpdate:modelValue":l[0]||(l[0]=h=>e.unref(i).BudgetFees=h),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[l[23]||(l[23]=e.createElementVNode("th",null,"身分標籤",-1)),e.createElementVNode("td",null,[e.createVNode(b,{rows:"5",modelValue:e.unref(i).TargetTags,"onUpdate:modelValue":l[1]||(l[1]=h=>e.unref(i).TargetTags=h),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[l[25]||(l[25]=e.createElementVNode("th",null,"申請期間",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",k$,[e.createElementVNode("div",u$,[e.createVNode(k,{modelValue:e.unref(i).ApplyStartDate,"onUpdate:modelValue":l[2]||(l[2]=h=>e.unref(i).ApplyStartDate=h)},null,8,["modelValue"]),l[24]||(l[24]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{modelValue:e.unref(i).ApplyEndDate,"onUpdate:modelValue":l[3]||(l[3]=h=>e.unref(i).ApplyEndDate=h)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[26]||(l[26]=e.createElementVNode("th",null,"計畫期程迄日",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",h$,[e.createElementVNode("div",x$,[e.createVNode(k,{modelValue:e.unref(i).PlanEndDate,"onUpdate:modelValue":l[4]||(l[4]=h=>e.unref(i).PlanEndDate=h)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[31]||(l[31]=e.createElementVNode("th",null,"申請階段審查",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",$$,[e.createElementVNode("div",B$,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-1",type:"checkbox",style:{visibility:"hidden"},"onUpdate:modelValue":l[5]||(l[5]=h=>e.unref(i).Review1Enabled=h)},null,512),[[e.vModelCheckbox,e.unref(i).Review1Enabled]]),l[27]||(l[27]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-1"},"1.",-1)),e.createVNode(_,{class:"w-auto","aria-label":"資格審查",placeholder:"資格審查",modelValue:e.unref(i).Review1Title,"onUpdate:modelValue":l[6]||(l[6]=h=>e.unref(i).Review1Title=h),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",_$,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-2",type:"checkbox","onUpdate:modelValue":l[7]||(l[7]=h=>e.unref(i).Review2Enabled=h)},null,512),[[e.vModelCheckbox,e.unref(i).Review2Enabled]]),l[28]||(l[28]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-2"},"2.",-1)),e.createVNode(_,{class:"w-auto","aria-label":"初審",placeholder:"初審",modelValue:e.unref(i).Review2Title,"onUpdate:modelValue":l[8]||(l[8]=h=>e.unref(i).Review2Title=h),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",C$,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-3",type:"checkbox","onUpdate:modelValue":l[9]||(l[9]=h=>e.unref(i).Review3Enabled=h)},null,512),[[e.vModelCheckbox,e.unref(i).Review3Enabled]]),l[29]||(l[29]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-3"},"3.",-1)),e.createVNode(_,{class:"w-auto","aria-label":"複審",placeholder:"複審",modelValue:e.unref(i).Review3Title,"onUpdate:modelValue":l[10]||(l[10]=h=>e.unref(i).Review3Title=h),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",T$,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-4",type:"checkbox",style:{visibility:"hidden"},"onUpdate:modelValue":l[11]||(l[11]=h=>e.unref(i).Review4Enabled=h)},null,512),[[e.vModelCheckbox,e.unref(i).Review4Enabled]]),l[30]||(l[30]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-4"},"4.",-1)),e.createVNode(_,{class:"w-auto","aria-label":"決審核定",placeholder:"決審核定",modelValue:e.unref(i).Review4Title,"onUpdate:modelValue":l[12]||(l[12]=h=>e.unref(i).Review4Title=h),modelModifiers:{trim:!0}},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[34]||(l[34]=e.createElementVNode("th",null,"補正補件期限",-1)),e.createElementVNode("td",w$,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"overdue-period",type:"checkbox","onUpdate:modelValue":l[13]||(l[13]=h=>e.isRef(m)?m.value=h:null)},null,512),[[e.vModelCheckbox,e.unref(m)]]),l[33]||(l[33]=e.createElementVNode("label",{class:"form-check-label",for:"overdue-period"},"有期限",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(d,{class:"w-auto",modelValue:e.unref(i).OverduePeriod,"onUpdate:modelValue":l[14]||(l[14]=h=>e.unref(i).OverduePeriod=h),modelModifiers:{trim:!0}},null,8,["modelValue"]),l[32]||(l[32]=e.createTextVNode("天 ",-1))],64)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[l[35]||(l[35]=e.createElementVNode("th",null,[e.createTextVNode("期中報告"),e.createElementVNode("br"),e.createTextVNode("繳交期限")],-1)),e.createElementVNode("td",null,[e.createElementVNode("span",S$,[e.createElementVNode("span",D$,[e.createVNode(k,{modelValue:e.unref(i).MidtermDeadline,"onUpdate:modelValue":l[15]||(l[15]=h=>e.unref(i).MidtermDeadline=h)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[38]||(l[38]=e.createElementVNode("th",null,[e.createTextVNode("期末/成果報告"),e.createElementVNode("br"),e.createTextVNode("繳交期限")],-1)),e.createElementVNode("td",null,[e.createElementVNode("div",A$,[e.createElementVNode("div",F$,[e.createVNode(k,{disabled:e.unref(i).FinalOneMonth,modelValue:e.unref(i).FinalDeadline,"onUpdate:modelValue":l[16]||(l[16]=h=>e.unref(i).FinalDeadline=h)},null,8,["disabled","modelValue"])]),l[36]||(l[36]=e.createElementVNode("span",{class:"p-2"},"或",-1)),e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"final-one-month",type:"checkbox","onUpdate:modelValue":l[17]||(l[17]=h=>e.unref(i).FinalOneMonth=h)},null,512),[[e.vModelCheckbox,e.unref(i).FinalOneMonth]]),l[37]||(l[37]=e.createElementVNode("label",{class:"form-check-label",for:"final-one-month"},"計畫結束一個月後",-1))])])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:n,type:"button"},"儲存")])])}}},P$={class:"block"},M$={class:"mt-4"},I$={class:"table-responsive"},j$={class:"table align-middle gray-table"},O$={class:"d-flex align-items-center gap-2"},L$=["id","onUpdate:modelValue"],R$=["for"],q$={__name:"GrantForm3",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref([]),m=x,N=()=>{const n=i.value.map(o=>({...o,MatchingFund:o.checked?o.MatchingFund:null}));A.system("saveGrantTargetSettings",{List:n}).subscribe(o=>{o&&m("next")})};return e.onMounted(()=>{A.system("getGrantTargetSettings",{ID:g.id}).subscribe(n=>{i.value=n.List,i.value.forEach(o=>{typeof o.MatchingFund=="number"&&(o.checked=!0)})})}),(n,o)=>{const l=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock("div",P$,[e.createElementVNode("div",M$,[e.createElementVNode("div",I$,[e.createElementVNode("table",j$,[o[1]||(o[1]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th"),e.createElementVNode("th",null,"適用申請單位類別"),e.createElementVNode("th",null,"補助經費上限(萬)"),e.createElementVNode("th",null,"配合款")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(d,b)=>(e.openBlock(),e.createElementBlock("tr",{key:d},[e.createElementVNode("td",null,e.toDisplayString(b+1),1),e.createElementVNode("td",null,e.toDisplayString(d.TargetName),1),e.createElementVNode("td",null,[e.createVNode(l,{modelValue:d.GrantLimit,"onUpdate:modelValue":k=>d.GrantLimit=k},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",O$,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:`checkbox-${b}`,type:"checkbox","onUpdate:modelValue":k=>d.checked=k},null,8,L$),[[e.vModelCheckbox,d.checked]]),e.createElementVNode("label",{class:"form-check-label ms-1",for:`checkbox-${b}`},"配合款分攤比例",8,R$),d.checked?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(l,{class:"w-auto",modelValue:d.MatchingFund,"onUpdate:modelValue":k=>d.MatchingFund=k},null,8,["modelValue","onUpdate:modelValue"]),o[0]||(o[0]=e.createTextVNode("(%) ",-1))],64)):e.createCommentVNode("",!0)])])]))),128))])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:N,type:"button"},"儲存")])])}}},z$={class:"block"},G$={class:"mt-4"},J$={class:"table-responsive"},Y$={class:"table align-middle gray-table side-table"},Q$={class:"input-group",style:{width:"400px"}},H$={class:"teal-dark-tabs"},W$={key:0,class:"table-responsive sub-table"},K$={class:"table align-middle gray-table"},X$={class:"d-flex gap-2"},Z$=["onClick"],v$={key:1},e2={class:"d-flex gap-2"},t2={__name:"GrantForm4",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref({}),m=e.ref(),N=e.ref([]),n=e.ref({}),o=e.ref(1),l=e.ref(""),d=()=>{const h=/^(.*?)\s*<([^>]+)>$/;l.value.split(`
`).forEach(V=>{const c=V.trim().match(h);c&&n.value[m.value].push({CommitteeUser:c[1],Email:c[2]})}),o.value=1,l.value=""},b=x,k=()=>{if(!_()){e.nextTick(()=>{var h;return(h=document.querySelector(".invalid"))==null?void 0:h.scrollIntoView({behavior:"smooth",block:"center"})});return}A.system("saveReviewCommitteeList",{ID:m.value,List:n.value[m.value]}).subscribe(h=>{h&&b("next")})},_=()=>{const h={CommitteeUser:"姓名",Email:{presence:{message:"^請輸入 Email"},email:{message:"格式錯誤"}}};return i.value={},n.value[m.value].filter(V=>!V.Deleted).forEach((V,c)=>Object.assign(i.value,M(V,h,`item-${c}-`))),!Object.keys(i.value).length};return e.onMounted(()=>{A.system("getReviewGroups",{ID:g.id}).subscribe(h=>{N.value=h.List,m.value=N.value[0].Value})}),e.watch(m,h=>{n.value[h]||A.system("getReviewCommitteeList",{ID:h}).subscribe(V=>{n.value[h]=V.List})}),(h,V)=>{var s;const c=e.resolveComponent("required-label"),a=e.resolveComponent("input-select"),u=e.resolveComponent("input-text"),E=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock("div",z$,[e.createElementVNode("div",G$,[e.createElementVNode("div",J$,[e.createElementVNode("table",Y$,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...V[5]||(V[5]=[e.createTextVNode("審查組別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Q$,[e.createVNode(a,{options:e.unref(N),"text-name":"Text","value-name":"Value",modelValue:e.unref(m),"onUpdate:modelValue":V[0]||(V[0]=f=>e.isRef(m)?m.value=f:null)},null,8,["options","modelValue"])])])]),e.createElementVNode("tr",null,[V[11]||(V[11]=e.createElementVNode("th",null,"審查委員名單",-1)),e.createElementVNode("td",null,[e.createElementVNode("ul",H$,[e.createElementVNode("li",{class:e.normalizeClass({active:e.unref(o)===1})},[e.createElementVNode("a",{class:"tab-link",onClick:V[1]||(V[1]=f=>o.value=1),href:"javascript:void(0)"},"逐筆輸入")],2),e.createElementVNode("li",{class:e.normalizeClass({active:e.unref(o)===2})},[e.createElementVNode("a",{class:"tab-link",onClick:V[2]||(V[2]=f=>o.value=2),href:"javascript:void(0)"},"批次輸入")],2)]),e.unref(o)===1?(e.openBlock(),e.createElementBlock("div",W$,[e.createElementVNode("table",K$,[V[7]||(V[7]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"1%"}),e.createElementVNode("th",null,"姓名"),e.createElementVNode("th",null,"Email"),e.createElementVNode("th",{width:"1%"})])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((s=e.unref(n)[e.unref(m)])==null?void 0:s.filter(f=>!f.Deleted),(f,r)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",null,e.toDisplayString(r+1),1),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(i)[`item-${r}-CommitteeUser`],modelValue:f.CommitteeUser,"onUpdate:modelValue":t=>f.CommitteeUser=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(i)[`item-${r}-Email`],modelValue:f.Email,"onUpdate:modelValue":t=>f.Email=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",X$,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:t=>f.Deleted=!0,type:"button"},[...V[6]||(V[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Z$)])])]))),128))])]),e.createElementVNode("button",{class:"btn btn-sm btn-teal",onClick:V[3]||(V[3]=f=>{var r;return(r=e.unref(n)[e.unref(m)])==null?void 0:r.push({})}),type:"button"},[...V[8]||(V[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增",-1)])])])):e.createCommentVNode("",!0),e.unref(o)===2?(e.openBlock(),e.createElementBlock("div",v$,[e.createElementVNode("div",e2,[e.createVNode(E,{placeholder:`張曉明 <aming@gmail.com>
陳小華 <hwahchen@xxx.edu.tw>`,rows:"5",modelValue:e.unref(l),"onUpdate:modelValue":V[4]||(V[4]=f=>e.isRef(l)?l.value=f:null),modelModifiers:{trim:!0}},null,8,["modelValue"]),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:d,type:"button"},[...V[9]||(V[9]=[e.createElementVNode("i",{class:"fa-solid fa-plus"},null,-1),e.createTextVNode("新增",-1)])])]),V[10]||(V[10]=e.createElementVNode("label",{class:"form-text"},"輸入格式範例「姓名 <xxx@email.com>」，多筆請斷行輸入",-1))])):e.createCommentVNode("",!0)])])])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:k,type:"button"},"儲存")])])}}},l2={class:"search-form"},o2={class:"row g-3"},n2={class:"col-3"},r2=["value"],a2={class:"block rounded-4 mt-4"},s2={class:"table-responsive",style:{"min-height":"400px"}},d2={"aria-label":"公告列表",class:"table teal-table"},c2={"data-th":"年度:"},i2={"data-th":"補助類別全稱:",class:"text-start"},m2={"data-th":"簡稱:",class:"text-start"},p2={"data-th":"代碼:",class:"text-start"},V2={"data-th":"申請期間:",class:"text-start"},f2={"data-th":"管理:",class:"text-center"},N2={class:"d-inline-flex gap-2"},E2=["href"],b2={__name:"GrantList",setup(B){const x=e.ref([]),g=e.ref(),i=e.ref([]),m=e.computed(()=>x.value.filter(N=>N.Year===g.value));return e.onMounted(()=>{A.system("getGrantTypeList").subscribe(N=>{x.value=N.List,i.value=[],x.value.forEach(n=>{i.value.includes(n.Year)||i.value.push(n.Year)}),g.value=i.value.length?i.value[0]:null})}),(N,n)=>{const o=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",l2,[e.createElementVNode("div",o2,[e.createElementVNode("div",n2,[n[1]||(n[1]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":n[0]||(n[0]=l=>e.isRef(g)?g.value=l:null)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),l=>(e.openBlock(),e.createElementBlock("option",{key:l,value:l},e.toDisplayString(l)+"年",9,r2))),128))],512),[[e.vModelSelect,e.unref(g)]])])])]),e.createElementVNode("div",a2,[n[5]||(n[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="GrantEdit.aspx"><i class="fa-solid fa-plus"></i> 新增類別 </a></div>',1)),e.createElementVNode("div",s2,[e.createElementVNode("table",d2,[n[4]||(n[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col"},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"補助類別全稱"),e.createElementVNode("th",{scope:"col",class:"text-start"},"簡稱"),e.createElementVNode("th",{scope:"col"},"代碼"),e.createElementVNode("th",{scope:"col"},"申請期間"),e.createElementVNode("th",{scope:"col"},"管理")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),l=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",c2,e.toDisplayString(l.Year),1),e.createElementVNode("td",i2,e.toDisplayString(l.FullName),1),e.createElementVNode("td",m2,e.toDisplayString(l.ShortName),1),e.createElementVNode("td",p2,e.toDisplayString(l.TypeCode),1),e.createElementVNode("td",V2,[e.createVNode(o,{"default-value":"未設定",value:l.ApplyStartDate},null,8,["value"]),n[2]||(n[2]=e.createTextVNode(" ~ ",-1)),e.createVNode(o,{"default-value":"未設定",value:l.ApplyEndDate},null,8,["value"])]),e.createElementVNode("td",f2,[e.createElementVNode("div",N2,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`GrantEdit.aspx?ID=${l.TypeID}`},[...n[3]||(n[3]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,E2)])])]))),128))])])])])],64)}}},g2={class:"block rounded-4 mt-4"},y2={class:"table-responsive",style:{"min-height":"400px"}},k2={class:"table teal-table","aria-label":"公告列表"},u2={"data-th":"公告期間:"},h2={key:1},x2={"data-th":"公告標題:",class:"text-start"},$2={"data-th":"發布者:",class:"text-start"},B2={"data-th":"功能:",class:"text-center"},_2={class:"d-inline-flex gap-2"},C2=["href"],T2=["onClick"],w2={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"},S2={class:"modal-content"},D2={class:"modal-body"},A2={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},F2={__name:"NewsList",setup(B){let x;const g=e.ref([]),i=e.ref(),m=e.ref(1),N=e.ref(10),n=e.computed(()=>g.value.slice((m.value-1)*N.value,m.value*N.value)),o=(d,b)=>{m.value=parseInt(d),N.value=parseInt(b)},l=(d,b)=>{b||(x=d,bootstrap.Modal.getOrCreateInstance(i.value).show()),A.system("deleteNews",{ID:d.ID}).subscribe(k=>{k&&(g.value=g.value.filter(_=>_!==d),bootstrap.Modal.getOrCreateInstance(i.value).hide())})};return e.onMounted(()=>{A.system("getNewsList").subscribe(d=>g.value=d.List)}),(d,b)=>{const k=e.resolveComponent("tw-date"),_=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",g2,[b[5]||(b[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="NewsEdit.aspx"><i class="fa-solid fa-plus"></i> 新增公告 </a></div>',1)),e.createElementVNode("div",y2,[e.createElementVNode("table",k2,[b[4]||(b[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告期間"),e.createElementVNode("th",{class:"text-start",scope:"col"},"公告標題"),e.createElementVNode("th",{class:"text-start",scope:"col",style:{width:"200px"}},"發布者"),e.createElementVNode("th",{scope:"col",style:{width:"180px"}},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),h=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",u2,[e.createVNode(k,{value:h.EnableTime},null,8,["value"]),b[1]||(b[1]=e.createTextVNode(" ~ ",-1)),h.DisableTime?(e.openBlock(),e.createBlock(k,{key:0,value:h.DisableTime},null,8,["value"])):(e.openBlock(),e.createElementBlock("span",h2,"未設定"))]),e.createElementVNode("td",x2,e.toDisplayString(h.Title),1),e.createElementVNode("td",$2,e.toDisplayString(h.UserOrg)+" "+e.toDisplayString(h.UserName),1),e.createElementVNode("td",B2,[e.createElementVNode("div",_2,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`NewsEdit.aspx?id=${h.ID}`},[...b[2]||(b[2]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,C2),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:V=>l(h),type:"button"},[...b[3]||(b[3]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,T2)])])]))),128))])])]),e.createVNode(_,{count:e.unref(g).length,onChange:o,page:e.unref(m),"page-size":e.unref(N)},null,8,["count","page","page-size"])]),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:i,tabindex:"-1"},[e.createElementVNode("div",w2,[e.createElementVNode("div",S2,[b[7]||(b[7]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 fw-bold text-green-light"},"確定刪除公告資料？"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",D2,[e.createElementVNode("div",A2,[b[6]||(b[6]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:b[0]||(b[0]=h=>l(e.unref(x),!0)),type:"button"},"確認刪除")])])])])],512)],64)}}},U2={class:"block rounded-top-4 mt-4 d-flex flex-column gap-5"},P2={class:"table-responsive mt-3 mb-0"},M2={class:"table align-middle gray-table side-table"},I2={class:"d-flex align-items-center gap-2"},j2={class:"input-group w-auto"},O2={key:0,class:"invalid mt-0"},L2={class:"d-flex mb-2 gap-3"},R2={class:"tag-group mt-3"},q2={key:0,class:"tag tag-green-light"},z2=["download","href"],G2=["onClick"],J2={class:"d-flex mb-2 gap-3"},Y2={class:"image-preview mt-3"},Q2={key:0,class:"image-preview__item"},H2=["src"],W2={class:"image-preview__item-overlay"},K2=["onClick"],X2={class:"d-flex mb-2 gap-3"},Z2={key:0,class:"table-responsive mt-3"},v2={class:"table align-middle gray-table"},eB={class:"text-center"},tB={class:"d-flex gap-1"},lB=["onClick"],ne={AccessibilityApplication:at,AccessibilityAttachment:wt,AccessibilityBenefit:zt,AccessibilityFunding:bl,AccessibilityPayment1:zl,AccessibilityPayment2:go,AccessibilityProgressBar:yo,AccessibilityWorkSchedule:Jo,AuditHistory:nn,ConfirmModal:mn,CommonProgressBar:gn,CultureApplication:lr,CultureAttachment:Br,CultureFunding:Zr,CultureOther:fa,CulturePayment1:La,CulturePayment2:fs,CultureProgress:Fs,CultureProgressBar:Us,CultureWorkSchedule:_d,EducationApplication:gc,EducationAttachment:Rc,EducationPayment:fi,EducationProgressBar:Ni,ErrorModal:ui,HomeDashboard:Bm,InputBoolean:_m,InputFile:Cm,InputInteger:Sm,InputMonth:Dm,InputRadioGroup:Um,InputSelect:Om,InputText:Gm,InputTextarea:Wm,InputTwDate:Zm,ListPager:Vp,LiteracyApplication:Qp,LiteracyAttachment:EV,LiteracyBenefit:SV,LiteracyFunding:nf,LiteracyPayment1:wf,LiteracyPayment2:eN,LiteracyProgressBar:tN,LiteracyWorkSchedule:CN,MultipleApplication:s1,MultipleAttachment:S1,MultipleBenefit:G1,MultipleFunding:gE,MultiplePayment1:qE,MultiplePayment2:Nb,MultiplePayment3:qb,MultipleProgressBar:zb,MultipleWorkSchedule:Ng,NewsDetail:Tg,NewsList:Mg,NewsMarquee:qg,ProjectChangeReview:Hg,ProjectCorrectionReview:ey,ProjectOrganizer:cy,ProjectPaymentReview:gy,ProjectProgress:Ty,ProjectReport:Yy,ProjectReportReview:Zy,ProjectReview:dk,ProjectTitle:Vk,ProjectToolbar:wk,ReportApplyList:Nu,ReportApprovedList:qu,ReportInprogressList:uh,ReportMixChart:hh,ReportPieChart:xh,ReportRecusedList:Yh,ReportReviewerDetails:nx,ReportReviewerList:Fx,RequiredLabel:Px,ReviewCommitteeInfo:qx,SystemGrantForm1:p$,SystemGrantForm2:U$,SystemGrantForm3:q$,SystemGrantForm4:t2,SystemGrantList:b2,SystemNewsList:F2,SystemNewsForm:{__name:"NewsForm",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:x}){const g=B,i=e.ref({}),m=e.ref([]),N=e.computed(()=>l.value.filter(V=>!V.Deleted)),n=e.ref({}),o=e.ref([]),l=e.ref([]),d=(V,c)=>V.push({Path:c.Path,Name:c.Name}),b=A.download,k=x,_=()=>{if(!h()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const V={News:n.value,Files:m.value,Images:o.value,Videos:l.value};A.system("saveNews",V).subscribe(c=>{c&&k("next")})},h=()=>{let V={Title:"公告標題",EnableTime:"公告期間",Content:"內容"};return i.value=M(n.value,V),V={Title:"影片名稱",URL:"影片網址"},N.value.forEach((c,a)=>Object.assign(i.value,M(c,V,`video-${a}-`))),!Object.keys(i.value).length};return e.onMounted(()=>{g.id?A.system("getNews",{ID:g.id}).subscribe(V=>{n.value=V.News,m.value=V.Files,o.value=V.Images,l.value=V.Videos}):A.system("getEmptyNews").subscribe(V=>n.value=V)}),(V,c)=>{const a=e.resolveComponent("required-label"),u=e.resolveComponent("input-text"),E=e.resolveComponent("input-tw-date"),s=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",U2,[e.createElementVNode("div",null,[c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title"},"公告內容",-1)),e.createElementVNode("div",P2,[e.createElementVNode("table",M2,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",null,"發佈者",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(n).UserOrg)+"    "+e.toDisplayString(e.unref(n).UserName),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...c[8]||(c[8]=[e.createTextVNode("公告標題",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(i).Title,modelValue:e.unref(n).Title,"onUpdate:modelValue":c[0]||(c[0]=r=>e.unref(n).Title=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...c[9]||(c[9]=[e.createTextVNode("公告期間",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",I2,[e.createElementVNode("div",j2,[e.createVNode(E,{class:"w-auto",modelValue:e.unref(n).EnableTime,"onUpdate:modelValue":c[1]||(c[1]=r=>e.unref(n).EnableTime=r)},null,8,["modelValue"]),c[10]||(c[10]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(E,{class:"w-auto",modelValue:e.unref(n).DisableTime,"onUpdate:modelValue":c[2]||(c[2]=r=>e.unref(n).DisableTime=r)},null,8,["modelValue"])])]),e.unref(i).EnableTime?(e.openBlock(),e.createElementBlock("div",O2,e.toDisplayString(e.unref(i).EnableTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...c[11]||(c[11]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(i).Content,modelValue:e.unref(n).Content,"onUpdate:modelValue":c[3]||(c[3]=r=>e.unref(n).Content=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.createElementVNode("div",null,[e.createElementVNode("div",L2,[c[13]||(c[13]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關附件")],-1)),e.createVNode(f,{accept:".pdf,.odt,.doc,.docx,.zip",onFile:c[4]||(c[4]=r=>d(e.unref(m),r))})]),c[15]||(c[15]=e.createElementVNode("span",{class:"text-pink"},"支援文件 pdf, odt, doc, docx (10MB以內)、ZIP 壓縮檔 (50MB以內)",-1)),e.createElementVNode("div",R2,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",q2,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(b)(r.Path)},e.toDisplayString(r.Name),9,z2),e.createElementVNode("button",{class:"tag-btn",onClick:t=>r.Deleted=!0,type:"button"},[...c[14]||(c[14]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,G2)]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",J2,[c[16]||(c[16]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關圖片")],-1)),e.createVNode(f,{accept:".jpg,.png",onFile:c[5]||(c[5]=r=>d(e.unref(o),r))})]),c[18]||(c[18]=e.createElementVNode("span",{class:"text-pink"},"支援 JPG, PNG，檔案大小 10MB以內",-1)),e.createElementVNode("div",Y2,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Q2,[e.createElementVNode("img",{alt:"picture",src:e.unref(b)(r.Path)},null,8,H2),e.createElementVNode("div",W2,[e.createElementVNode("button",{"aria-label":"移除圖片",class:"btn btn-remove-image",onClick:t=>r.Deleted=!0,type:"button"},[...c[17]||(c[17]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,K2)])]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",X2,[c[20]||(c[20]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關影片")],-1)),e.createElementVNode("button",{"aria-label":"新增影片",class:"btn btn-teal-dark",onClick:c[6]||(c[6]=r=>e.unref(l).push({})),type:"button"},[...c[19]||(c[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增 ",-1)])])]),e.unref(N).length?(e.openBlock(),e.createElementBlock("div",Z2,[e.createElementVNode("table",v2,[c[22]||(c[22]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80",class:"text-center"},"項次"),e.createElementVNode("th",null,"影片名稱"),e.createElementVNode("th",null,"影片網址"),e.createElementVNode("th",{width:"120"},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(r,t)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",eB,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(i)[`video-${t}-Title`],modelValue:r.Title,"onUpdate:modelValue":p=>r.Title=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(i)[`video-${t}-URL`],modelValue:r.URL,"onUpdate:modelValue":p=>r.URL=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",tB,[e.createElementVNode("button",{"aria-label":"刪除影片",class:"btn btn-sm btn-teal-dark",onClick:p=>r.Deleted=!0,type:"button"},[...c[21]||(c[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,lB)])])]))),128))])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",{class:"block-bottom bg-light-teal"},[e.createElementVNode("button",{class:"btn btn-teal",onClick:_,type:"button"},[...c[23]||(c[23]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確認送出",-1)])])])],64)}}},Tooltip:{__name:"Tooltip",setup(B){const x=e.ref();let g;return e.onMounted(()=>{g=new bootstrap.Tooltip(x.value)}),e.onUnmounted(()=>{g&&g.dispose()}),(i,m)=>(e.openBlock(),e.createElementBlock("button",{class:"btn-tooltip",ref_key:"element",ref:x,style:{color:"#027f72"},type:"button"},[...m[0]||(m[0]=[e.createElementVNode("i",{class:"fa-solid fa-circle-info"},null,-1)])],512))}},TwDate:{__name:"TwDate",props:{defaultValue:{default:"",type:String},value:{default:null,type:String}},setup(B){const x=B,g=m=>{const N=m==null?void 0:m.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return N?`${parseInt(N[1],10)-1911}/${N[2]}/${N[3]}`:""},i=e.ref(g(x.value));return e.watch(()=>x.value,m=>i.value=g(m)),(m,N)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(i)||B.defaultValue),1))}},TwDateTime:{__name:"TwDateTime",props:{defaultValue:{default:"",type:String},value:{default:null,type:String}},setup(B){const x=B,g=m=>{const N=m==null?void 0:m.match(/^(\d+)[\/-](\d+)[\/-](\d+)[ T](\d+:\d+(:\d+)?)/);return N?`${parseInt(N[1],10)-1911}/${N[2]}/${N[3]} ${N[4]}`:""},i=e.ref(g(x.value));return e.watch(()=>x.value,m=>i.value=g(m)),(m,N)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(i)||B.defaultValue),1))}}};return{api:A,install:B=>{for(const x in ne)B.component(x,ne[x])},useGrantStore:X,useProgressStore:j}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
