(function(e,W){typeof exports=="object"&&typeof module<"u"?module.exports=W(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],W):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=W(e.Vue,e.Pinia))})(this,(function(e,W){"use strict";const P=W.defineStore("progress",{actions:{init(x,T){var h,N;this[x]={id:T.ProjectID,type:(h=T.SubsidyPlanType)==null?void 0:h.split(" ")[0],name:T.ProjectName,step:T.FormStep,status:T.Status,progress:T.ProgressStatus,changeStatus:(N=T.changeApply)==null?void 0:N.Status,organizer:T.Organizer,organizerName:T.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})});let te=Date.now();const z=(x,T,h)=>{const N=P();if([1,14].includes(N[x].status)||[1,4].includes(N[x].changeStatus))return!0;if(N[x].status===42)switch(x){case"culture":if([2,3,5].includes(h))return!0;break;case"multiple":if([2,3,4,5].includes(h))return!0;break;case"accessibility":if([2,3,4,5].includes(h))return!0;break}return!1},le=()=>`id--${te++}`,L=x=>parseInt(x)||0,Z=W.defineStore("message",{state:()=>({error:null})}),{ajax:oe}=rxjs.ajax,{map:ne}=rxjs;let K="";const re=(x,T={})=>Q("Service/OFS/Accessibility.ashx",{method:x,param:T}),ae=(x,T={})=>Q("Service/OFS/Culture.ashx",{method:x,param:T}),de=x=>`${K}/Service/OFS/Download.ashx?path=${x}`,se=(x,T={})=>Q("Service/OFS/Education.ashx",{method:x,param:T}),me=(x,T={})=>Q("Service/OFS/Literacy.ashx",{method:x,param:T}),ie=(x,T={})=>Q("Service/OFS/Multiple.ashx",{method:x,param:T}),ce=({response:x,status:T})=>{if(T===200){if(x.success)return x.data;Z().error=x.message}},Q=(x,T={})=>{const h={};T.constructor!==FormData&&(h["Content-Type"]="application/json");const N={body:T,headers:h,method:"POST",url:`${K}/${x}`};return oe(N).pipe(ne(ce))},M=Object.assign(Q,{accessibility:re,culture:ae,download:de,education:se,literacy:me,multiple:ie,upload:x=>{const T=new FormData;return T.append("file",x),Q("Service/OFS/Upload.ashx",T)}});function Ve(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var Y={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var pe=Y.exports,X;function fe(){return X||(X=1,(function(x,T){(function(h,N,m){var V=function(l,o,d){d=r.extend({},r.options,d);var u=r.runValidations(l,o,d);if(u.some(function(E){return r.isPromise(E.error)}))throw new Error("Use validate.async if you want support for promises");return V.processValidationResults(u,d)},r=V;r.extend=function(l){return[].slice.call(arguments,1).forEach(function(o){for(var d in o)l[d]=o[d]}),l},r.extend(V,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var l=r.format("%{major}.%{minor}.%{patch}",r.version);return r.isEmpty(r.version.metadata)||(l+="+"+r.version.metadata),l}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(l,o,d){var u=[],E,k,w,D,p,n,y;(r.isDomElement(l)||r.isJqueryElement(l))&&(l=r.collectFormValues(l));for(E in o){w=r.getDeepObjectValue(l,E),D=r.result(o[E],w,l,E,d,o);for(k in D){if(p=r.validators[k],!p)throw y=r.format("Unknown validator %{name}",{name:k}),new Error(y);n=D[k],n=r.result(n,w,l,E,d,o),n&&u.push({attribute:E,value:w,validator:k,globalOptions:d,attributes:l,options:n,error:p.call(p,w,n,E,l,d)})}}return u},processValidationResults:function(l,o){l=r.pruneEmptyErrors(l,o),l=r.expandMultipleErrors(l,o),l=r.convertErrorMessages(l,o);var d=o.format||"grouped";if(typeof r.formatters[d]=="function")l=r.formatters[d](l);else throw new Error(r.format("Unknown format %{format}",o));return r.isEmpty(l)?void 0:l},async:function(l,o,d){d=r.extend({},r.async.options,d);var u=d.wrapErrors||function(k){return k};d.cleanAttributes!==!1&&(l=r.cleanAttributes(l,o));var E=r.runValidations(l,o,d);return new r.Promise(function(k,w){r.waitForResults(E).then(function(){var D=r.processValidationResults(E,d);D?w(new u(D,d,l,o)):k(l)},function(D){w(D)})})},single:function(l,o,d){return d=r.extend({},r.single.options,d,{format:"flat",fullMessages:!1}),r({single:l},{single:o},d)},waitForResults:function(l){return l.reduce(function(o,d){return r.isPromise(d.error)?o.then(function(){return d.error.then(function(u){d.error=u||null})}):o},new r.Promise(function(o){o()}))},result:function(l){var o=[].slice.call(arguments,1);return typeof l=="function"&&(l=l.apply(null,o)),l},isNumber:function(l){return typeof l=="number"&&!isNaN(l)},isFunction:function(l){return typeof l=="function"},isInteger:function(l){return r.isNumber(l)&&l%1===0},isBoolean:function(l){return typeof l=="boolean"},isObject:function(l){return l===Object(l)},isDate:function(l){return l instanceof Date},isDefined:function(l){return l!=null},isPromise:function(l){return!!l&&r.isFunction(l.then)},isJqueryElement:function(l){return l&&r.isString(l.jquery)},isDomElement:function(l){return!l||!l.querySelectorAll||!l.querySelector?!1:r.isObject(document)&&l===document?!0:typeof HTMLElement=="object"?l instanceof HTMLElement:l&&typeof l=="object"&&l!==null&&l.nodeType===1&&typeof l.nodeName=="string"},isEmpty:function(l){var o;if(!r.isDefined(l))return!0;if(r.isFunction(l))return!1;if(r.isString(l))return r.EMPTY_STRING_REGEXP.test(l);if(r.isArray(l))return l.length===0;if(r.isDate(l))return!1;if(r.isObject(l)){for(o in l)return!1;return!0}return!1},format:r.extend(function(l,o){return r.isString(l)?l.replace(r.format.FORMAT_REGEXP,function(d,u,E){return u==="%"?"%{"+E+"}":String(o[E])}):l},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(l){return r.isNumber(l)?l*100%1===0?""+l:parseFloat(Math.round(l*100)/100).toFixed(2):r.isArray(l)?l.map(function(o){return r.prettify(o)}).join(", "):r.isObject(l)?r.isDefined(l.toString)?l.toString():JSON.stringify(l):(l=""+l,l.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(o,d,u){return""+d+" "+u.toLowerCase()}).toLowerCase())},stringifyValue:function(l,o){var d=o&&o.prettify||r.prettify;return d(l)},isString:function(l){return typeof l=="string"},isArray:function(l){return{}.toString.call(l)==="[object Array]"},isHash:function(l){return r.isObject(l)&&!r.isArray(l)&&!r.isFunction(l)},contains:function(l,o){return r.isDefined(l)?r.isArray(l)?l.indexOf(o)!==-1:o in l:!1},unique:function(l){return r.isArray(l)?l.filter(function(o,d,u){return u.indexOf(o)==d}):l},forEachKeyInKeypath:function(l,o,d){if(r.isString(o)){var u="",E,k=!1;for(E=0;E<o.length;++E)switch(o[E]){case".":k?(k=!1,u+="."):(l=d(l,u,!1),u="");break;case"\\":k?(k=!1,u+="\\"):k=!0;break;default:k=!1,u+=o[E];break}return d(l,u,!0)}},getDeepObjectValue:function(l,o){if(r.isObject(l))return r.forEachKeyInKeypath(l,o,function(d,u){if(r.isObject(d))return d[u]})},collectFormValues:function(l,o){var d={},u,E,k,w,D,p;if(r.isJqueryElement(l)&&(l=l[0]),!l)return d;for(o=o||{},w=l.querySelectorAll("input[name], textarea[name]"),u=0;u<w.length;++u)if(k=w.item(u),!r.isDefined(k.getAttribute("data-ignored"))){var n=k.name.replace(/\./g,"\\\\.");p=r.sanitizeFormValue(k.value,o),k.type==="number"?p=p?+p:null:k.type==="checkbox"?k.attributes.value?k.checked||(p=d[n]||null):p=k.checked:k.type==="radio"&&(k.checked||(p=d[n]||null)),d[n]=p}for(w=l.querySelectorAll("select[name]"),u=0;u<w.length;++u)if(k=w.item(u),!r.isDefined(k.getAttribute("data-ignored"))){if(k.multiple){p=[];for(E in k.options)D=k.options[E],D&&D.selected&&p.push(r.sanitizeFormValue(D.value,o))}else{var y=typeof k.options[k.selectedIndex]<"u"?k.options[k.selectedIndex].value:"";p=r.sanitizeFormValue(y,o)}d[k.name]=p}return d},sanitizeFormValue:function(l,o){return o.trim&&r.isString(l)&&(l=l.trim()),o.nullify!==!1&&l===""?null:l},capitalize:function(l){return r.isString(l)?l[0].toUpperCase()+l.slice(1):l},pruneEmptyErrors:function(l){return l.filter(function(o){return!r.isEmpty(o.error)})},expandMultipleErrors:function(l){var o=[];return l.forEach(function(d){r.isArray(d.error)?d.error.forEach(function(u){o.push(r.extend({},d,{error:u}))}):o.push(d)}),o},convertErrorMessages:function(l,o){o=o||{};var d=[],u=o.prettify||r.prettify;return l.forEach(function(E){var k=r.result(E.error,E.value,E.attribute,E.options,E.attributes,E.globalOptions);if(!r.isString(k)){d.push(E);return}k[0]==="^"?k=k.slice(1):o.fullMessages!==!1&&(k=r.capitalize(u(E.attribute))+" "+k),k=k.replace(/\\\^/g,"^"),k=r.format(k,{value:r.stringifyValue(E.value,o)}),d.push(r.extend({},E,{error:k}))}),d},groupErrorsByAttribute:function(l){var o={};return l.forEach(function(d){var u=o[d.attribute];u?u.push(d):o[d.attribute]=[d]}),o},flattenErrorsToArray:function(l){return l.map(function(o){return o.error}).filter(function(o,d,u){return u.indexOf(o)===d})},cleanAttributes:function(l,o){function d(k,w,D){return r.isObject(k[w])?k[w]:k[w]=D?!0:{}}function u(k){var w={},D;for(D in k)k[D]&&r.forEachKeyInKeypath(w,D,d);return w}function E(k,w){if(!r.isObject(k))return k;var D=r.extend({},k),p,n;for(n in k)p=w[n],r.isObject(p)?D[n]=E(D[n],p):p||delete D[n];return D}return!r.isObject(o)||!r.isObject(l)?{}:(o=u(o),E(l,o))},exposeModule:function(l,o,d,u,E){d?(u&&u.exports&&(d=u.exports=l),d.validate=l):(o.validate=l,l.isFunction(E)&&E.amd&&E([],function(){return l}))},warn:function(l){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+l)},error:function(l){typeof console<"u"&&console.error&&console.error("[validate.js] "+l)}}),V.validators={presence:function(l,o){if(o=r.extend({},this.options,o),o.allowEmpty!==!1?!r.isDefined(l):r.isEmpty(l))return o.message||this.message||"can't be blank"},length:function(l,o,d){if(r.isDefined(l)){o=r.extend({},this.options,o);var u=o.is,E=o.maximum,k=o.minimum,w=o.tokenizer||function(y){return y},D,p=[];l=w(l);var n=l.length;if(!r.isNumber(n))return o.message||this.notValid||"has an incorrect length";if(r.isNumber(u)&&n!==u&&(D=o.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",p.push(r.format(D,{count:u}))),r.isNumber(k)&&n<k&&(D=o.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",p.push(r.format(D,{count:k}))),r.isNumber(E)&&n>E&&(D=o.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",p.push(r.format(D,{count:E}))),p.length>0)return o.message||p}},numericality:function(l,o,d,u,E){if(r.isDefined(l)){o=r.extend({},this.options,o);var k=[],w,D,p={greaterThan:function(a,c){return a>c},greaterThanOrEqualTo:function(a,c){return a>=c},equalTo:function(a,c){return a===c},lessThan:function(a,c){return a<c},lessThanOrEqualTo:function(a,c){return a<=c},divisibleBy:function(a,c){return a%c===0}},n=o.prettify||E&&E.prettify||r.prettify;if(r.isString(l)&&o.strict){var y="^-?(0|[1-9]\\d*)";if(o.onlyInteger||(y+="(\\.\\d+)?"),y+="$",!new RegExp(y).test(l))return o.message||o.notValid||this.notValid||this.message||"must be a valid number"}if(o.noStrings!==!0&&r.isString(l)&&!r.isEmpty(l)&&(l=+l),!r.isNumber(l))return o.message||o.notValid||this.notValid||this.message||"is not a number";if(o.onlyInteger&&!r.isInteger(l))return o.message||o.notInteger||this.notInteger||this.message||"must be an integer";for(w in p)if(D=o[w],r.isNumber(D)&&!p[w](l,D)){var g="not"+r.capitalize(w),i=o[g]||this[g]||this.message||"must be %{type} %{count}";k.push(r.format(i,{count:D,type:n(w)}))}if(o.odd&&l%2!==1&&k.push(o.notOdd||this.notOdd||this.message||"must be odd"),o.even&&l%2!==0&&k.push(o.notEven||this.notEven||this.message||"must be even"),k.length)return o.message||k}},datetime:r.extend(function(l,o){if(!r.isFunction(this.parse)||!r.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(r.isDefined(l)){o=r.extend({},this.options,o);var d,u=[],E=o.earliest?this.parse(o.earliest,o):NaN,k=o.latest?this.parse(o.latest,o):NaN;if(l=this.parse(l,o),isNaN(l)||o.dateOnly&&l%864e5!==0)return d=o.notValid||o.message||this.notValid||"must be a valid date",r.format(d,{value:arguments[0]});if(!isNaN(E)&&l<E&&(d=o.tooEarly||o.message||this.tooEarly||"must be no earlier than %{date}",d=r.format(d,{value:this.format(l,o),date:this.format(E,o)}),u.push(d)),!isNaN(k)&&l>k&&(d=o.tooLate||o.message||this.tooLate||"must be no later than %{date}",d=r.format(d,{date:this.format(k,o),value:this.format(l,o)}),u.push(d)),u.length)return r.unique(u)}},{parse:null,format:null}),date:function(l,o){return o=r.extend({},o,{dateOnly:!0}),r.validators.datetime.call(r.validators.datetime,l,o)},format:function(l,o){(r.isString(o)||o instanceof RegExp)&&(o={pattern:o}),o=r.extend({},this.options,o);var d=o.message||this.message||"is invalid",u=o.pattern,E;if(r.isDefined(l)&&(!r.isString(l)||(r.isString(u)&&(u=new RegExp(o.pattern,o.flags)),E=u.exec(l),!E||E[0].length!=l.length)))return d},inclusion:function(l,o){if(r.isDefined(l)&&(r.isArray(o)&&(o={within:o}),o=r.extend({},this.options,o),!r.contains(o.within,l))){var d=o.message||this.message||"^%{value} is not included in the list";return r.format(d,{value:l})}},exclusion:function(l,o){if(r.isDefined(l)&&(r.isArray(o)&&(o={within:o}),o=r.extend({},this.options,o),!!r.contains(o.within,l))){var d=o.message||this.message||"^%{value} is restricted";return r.isString(o.within[l])&&(l=o.within[l]),r.format(d,{value:l})}},email:r.extend(function(l,o){o=r.extend({},this.options,o);var d=o.message||this.message||"is not a valid email";if(r.isDefined(l)&&(!r.isString(l)||!this.PATTERN.exec(l)))return d},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(l,o,d,u,E){if(r.isDefined(l)){r.isString(o)&&(o={attribute:o}),o=r.extend({},this.options,o);var k=o.message||this.message||"is not equal to %{attribute}";if(r.isEmpty(o.attribute)||!r.isString(o.attribute))throw new Error("The attribute must be a non empty string");var w=r.getDeepObjectValue(u,o.attribute),D=o.comparator||function(n,y){return n===y},p=o.prettify||E&&E.prettify||r.prettify;if(!D(l,w,o,d,u))return r.format(k,{attribute:p(o.attribute)})}},url:function(l,o){if(r.isDefined(l)){o=r.extend({},this.options,o);var d=o.message||this.message||"is not a valid url",u=o.schemes||this.schemes||["http","https"],E=o.allowLocal||this.allowLocal||!1,k=o.allowDataUrl||this.allowDataUrl||!1;if(!r.isString(l))return d;var w="^(?:(?:"+u.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",D="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(E?D+="?":w+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",w+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+D+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",k){var p="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",n="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",y="data:(?:"+p+")?(?:;base64)?,"+n;w="(?:"+w+")|(?:^"+y+"$)"}var g=new RegExp(w,"i");if(!g.exec(l))return d}},type:r.extend(function(l,o,d,u,E){if(r.isString(o)&&(o={type:o}),!!r.isDefined(l)){var k=r.extend({},this.options,o),w=k.type;if(!r.isDefined(w))throw new Error("No type was specified");var D;if(r.isFunction(w)?D=w:D=this.types[w],!r.isFunction(D))throw new Error("validate.validators.type.types."+w+" must be a function.");if(!D(l,k,d,u,E)){var p=o.message||this.messages[w]||this.message||k.message||(r.isFunction(w)?"must be of the correct type":"must be of type %{type}");return r.isFunction(p)&&(p=p(l,o,d,u,E)),r.format(p,{attribute:r.prettify(d),type:w})}}},{types:{object:function(l){return r.isObject(l)&&!r.isArray(l)},array:r.isArray,integer:r.isInteger,number:r.isNumber,string:r.isString,date:r.isDate,boolean:r.isBoolean},messages:{}})},V.formatters={detailed:function(l){return l},flat:r.flattenErrorsToArray,grouped:function(l){var o;l=r.groupErrorsByAttribute(l);for(o in l)l[o]=r.flattenErrorsToArray(l[o]);return l},constraint:function(l){var o;l=r.groupErrorsByAttribute(l);for(o in l)l[o]=l[o].map(function(d){return d.validator}).sort();return l}},V.exposeModule(V,this,h,N,m)}).call(pe,T,x,null)})(Y,Y.exports)),Y.exports}var Ne=fe();const v=Ve(Ne),O=(x,T,h="")=>{const N={};Object.keys(T).forEach(r=>{const l=T[r];v.isString(l)?N[r]={presence:{allowEmpty:!1,message:`^請輸入${l}`}}:N[r]=l});const m={},V=v(x,N);return V&&Object.keys(V).forEach(r=>m[`${h}${r}`]=V[r].join(",")),m},Ee={class:"block"},ue={class:"mt-4"},be={class:"table align-middle gray-table side-table"},ge={key:0},ke={key:1,class:"text-light-gray"},ye={class:"d-flex flex-column gap-2"},xe={key:0},Be={class:"mt-4"},he={class:"table align-middle gray-table side-table"},$e={class:"row g-3"},Ce={class:"col-12 col-xl-2"},Te={class:"text-gray mb-2"},_e={class:"col-12 col-xl-3"},we={class:"text-gray mb-2"},De={class:"col-12 col-xl-4"},Se={class:"row g-1"},Ae={class:"col-7"},Fe={class:"col-5"},Ue={class:"col-12 col-xl-3"},Me={class:"text-gray mb-2"},Oe={class:"col-12"},Ie={class:"text-gray mb-2"},je={class:"mt-4"},Pe={class:"table align-middle gray-table side-table"},qe={class:"mt-4"},Re={class:"table align-middle gray-table side-table"},Le={key:0,class:"table-responsive mt-3 mb-0"},ze={class:"table align-middle gray-table"},Ge={key:0},Je={key:0},Qe={class:"d-flex gap-2"},We=["onClick"],Ye={class:"mt-4"},He={class:"table align-middle gray-table side-table"},Ze={key:0,class:"block-bottom bg-light-teal"},Ke={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.ref(),r=e.computed(()=>z("accessibility",d.value.Status,1)),l=e.ref({}),o=e.computed(()=>u.value.filter(g=>!g.Deleted)),d=e.ref({}),u=e.ref([]),E=e.computed({get:()=>!!o.value.length,set:g=>{g?k():u.value.forEach(i=>i.Deleted=!0)}}),k=()=>u.value.push({}),w=T,D=()=>{M.accessibility("getApplication",{ID:h.id}).subscribe(g=>{d.value=g.Project,V.value=g.Contacts,u.value=g.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,P().init("accessibility",d.value),m.value=d.value.changeApply,d.value.changeApply=void 0})},p=g=>g.Deleted=!0,n=g=>{var a,c;if(l.value={},g&&!y()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:d.value,Contacts:V.value,ReceivedSubsidies:u.value.filter(t=>t.ID||!t.Deleted),Before:(a=m.value)==null?void 0:a.Form1Before,After:(c=m.value)==null?void 0:c.Form1After,Submit:g?"true":"false"};M.accessibility("saveApplication",i).subscribe(t=>{g?w("next",t.ID):d.value.ID?D():window.location.href=`Application.aspx?ID=${t.ID}`})},y=()=>{let g={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value.OrgCategory==="2"&&(g.RegisteredNum="立案登記證字號"),l.value=O(d.value,g),g={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((i,a)=>Object.assign(l.value,O(i,g,`contact-${a}-`))),g={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},u.value.forEach((i,a)=>Object.assign(l.value,O(i,g,`received-${a}-`))),m.value&&(g={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(m.value,g))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([M.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(g=>{N.value=g[0],h.id?D():M.accessibility("getEmptyApplication").subscribe(i=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},i),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("accessibility",d.value)})})}),e.provide("editable",r),(g,i)=>{const a=e.resolveComponent("required-label"),c=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),s=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),F=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ee,[i[42]||(i[42]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ue,[e.createElementVNode("table",be,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[15]||(i[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[i[16]||(i[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",ge,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",ke,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[i[17]||(i[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[18]||(i[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(l).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":i[0]||(i[0]=C=>e.unref(d).ProjectName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[19]||(i[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":i[1]||(i[1]=C=>e.unref(d).OrgName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[20]||(i[20]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",ye,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":i[2]||(i[2]=C=>e.unref(d).OrgCategory=C)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",xe,[e.createVNode(c,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":i[3]||(i[3]=C=>e.unref(d).RegisteredNum=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[21]||(i[21]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":i[4]||(i[4]=C=>e.unref(d).TaxID=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[22]||(i[22]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":i[5]||(i[5]=C=>e.unref(d).Address=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),i[43]||(i[43]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Be,[e.createElementVNode("table",he,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(C,A)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",$e,[e.createElementVNode("div",Ce,[e.createElementVNode("div",Te,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[23]||(i[23]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(l)[`contact-${A}-Name`],modelValue:C.Name,"onUpdate:modelValue":U=>C.Name=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",_e,[e.createElementVNode("div",we,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[24]||(i[24]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(l)[`contact-${A}-JobTitle`],modelValue:C.JobTitle,"onUpdate:modelValue":U=>C.JobTitle=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",De,[i[25]||(i[25]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Se,[e.createElementVNode("div",Ae,[e.createVNode(c,{modelValue:C.Phone,"onUpdate:modelValue":U=>C.Phone=U,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fe,[e.createVNode(c,{placeholder:"請輸入分機",size:"4",modelValue:C.PhoneExt,"onUpdate:modelValue":U=>C.PhoneExt=U,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Ue,[e.createElementVNode("div",Me,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[26]||(i[26]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(l)[`contact-${A}-MobilePhone`],modelValue:C.MobilePhone,"onUpdate:modelValue":U=>C.MobilePhone=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Oe,[e.createElementVNode("div",Ie,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[27]||(i[27]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(l)[`contact-${A}-EMail`],modelValue:C.EMail,"onUpdate:modelValue":U=>C.EMail=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),i[44]||(i[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",je,[e.createElementVNode("table",Pe,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[28]||(i[28]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[i[29]||(i[29]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(s,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":i[6]||(i[6]=C=>e.unref(d).Target=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[30]||(i[30]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":i[7]||(i[7]=C=>e.unref(d).Summary=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[31]||(i[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":i[8]||(i[8]=C=>e.unref(d).Quantified=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[32]||(i[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":i[9]||(i[9]=C=>e.unref(d).Qualitative=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",qe,[e.createElementVNode("table",Re,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[38]||(i[38]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(E),"onUpdate:modelValue":i[10]||(i[10]=C=>e.isRef(E)?E.value=C:null)},null,8,["modelValue"]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Le,[e.createElementVNode("table",ze,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[33]||(i[33]=e.createElementVNode("th",null,"計畫名稱",-1)),i[34]||(i[34]=e.createElementVNode("th",null,"補助單位",-1)),i[35]||(i[35]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Ge,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(C,A)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(l)[`received-${A}-Name`],modelValue:C.Name,"onUpdate:modelValue":U=>C.Name=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(l)[`received-${A}-Unit`],modelValue:C.Unit,"onUpdate:modelValue":U=>C.Unit=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l)[`received-${A}-Amount`],modelValue:C.Amount,"onUpdate:modelValue":U=>C.Amount=U},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Je,[e.createElementVNode("div",Qe,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>p(C),type:"button"},[...i[36]||(i[36]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,We)):e.createCommentVNode("",!0),A+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...i[37]||(i[37]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[i[41]||(i[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ye,[e.createElementVNode("table",He,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[39]||(i[39]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":i[11]||(i[11]=C=>e.unref(m).Form1Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[40]||(i[40]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":i[12]||(i[12]=C=>e.unref(m).Form1After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Ze,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[13]||(i[13]=C=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[14]||(i[14]=C=>n(!0)),type:"button"},[...i[45]||(i[45]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Xe={class:"block"},ve={key:0,class:"text-pink lh-base mt-4"},et={class:"mt-4"},tt={class:"table align-middle gray-table"},lt={class:"text-center"},ot={key:0,width:"180"},nt={class:"text-center"},rt={key:0},at=["innerHTML"],dt=["href"],st={key:0,class:"text-center"},mt={key:0},it={key:1,class:"text-pink"},ct={key:1,class:"tag-group mt-2 gap-1"},Vt={key:0,class:"tag tag-green-light"},pt=["download","href"],ft=["onClick"],Nt={class:"mt-4"},Et={class:"table align-middle gray-table side-table"},ut={key:0,class:"block-bottom bg-light-teal"},bt=["disabled"],gt={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/ACC/附件01-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/ACC/附件02-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/ACC/附件03-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/ACC/附件04-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),m=e.ref(),V=e.computed(()=>N.value.some(p=>!p.Optional&&!p.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("accessibility",o.value.Status,2)),l=e.ref({}),o=e.ref({}),d=(p,n)=>{n.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:n.Path,Name:o.value.ProjectID+"_"+(p.Multiple?n.Name:`${p.Title}.pdf`)})},u=M.download,E=T,k=()=>{rxjs.forkJoin([M.accessibility("getAttachment",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=N.value.filter(y=>{var g;return!((g=y.Excludes)!=null&&g.includes(o.value.OrgCategory))}),N.value.forEach(y=>{y.Files=n.Attachments.filter(g=>g.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(g=>!g.Deleted).length)}),P().init("accessibility",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},w=p=>{var y,g;if(l.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:h.id,Attachments:N.value.reduce((i,a)=>i.concat(a.Files),[]),Before:(y=m.value)==null?void 0:y.Form5Before,After:(g=m.value)==null?void 0:g.Form5After,Submit:p?"true":"false"};M.accessibility("saveAttachment",n).subscribe(()=>{p?E("next"):k()})},D=()=>{if(m.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(m.value,p))}return!Object.keys(l.value).length};return e.onMounted(k),e.provide("editable",r),(p,n)=>{const y=e.resolveComponent("required-label"),g=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Xe,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",ve,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",et,[e.createElementVNode("table",tt,[e.createElementVNode("thead",lt,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",ot,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",nt,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[a.Optional?(e.openBlock(),e.createElementBlock("span",rt,e.toDisplayString(a.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.Title),1)]),_:2},1024))]),e.unref(r)&&a.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:a.Comment},null,8,at)):e.createCommentVNode("",!0),e.unref(r)&&a.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:a.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,dt)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",st,[a.Uploaded?(e.openBlock(),e.createElementBlock("span",mt,"已上傳")):(e.openBlock(),e.createElementBlock("span",it,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(a.Multiple||!a.Uploaded)?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:t=>d(a,t)},null,8,["onFile"])):e.createCommentVNode("",!0),a.Uploaded?(e.openBlock(),e.createElementBlock("div",ct,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Vt,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(u)(t.Path)},e.toDisplayString(t.Name),9,pt),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:s=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ft)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Nt,[e.createElementVNode("table",Et,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(m).Form5Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form5After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",ut,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=a=>w(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,bt)])):e.createCommentVNode("",!0)],64)}}},kt={class:"block"},yt={class:"mt-4"},xt={class:"table-responsive mt-3 mb-0"},Bt={class:"table align-middle gray-table"},ht={key:0,width:"1"},$t={key:0},Ct={class:"d-flex gap-2"},Tt=["onClick"],_t={class:"table-responsive mt-3 mb-0"},wt={class:"table align-middle gray-table"},Dt={class:"mt-4"},St={class:"table align-middle gray-table side-table"},At={key:0,class:"block-bottom bg-light-teal"},Ft={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.computed(()=>z("accessibility",o.value.Status,4)),r=e.ref({}),l=e.computed(()=>N.value.filter(p=>!p.Deleted)),o=e.ref({}),d=()=>N.value.push({}),u=T,E=()=>{rxjs.forkJoin([M.accessibility("getBenefit",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=n.Benefits,N.value.length||d(),P().init("accessibility",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},k=p=>p.Deleted=!0,w=p=>{var y,g;if(r.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:o.value,Benefits:N.value,Before:(y=m.value)==null?void 0:y.Form4Before,After:(g=m.value)==null?void 0:g.Form4After,Submit:p?"true":"false"};M.accessibility("saveBenefit",n).subscribe(()=>{p?u("next"):E()})},D=()=>{let p={Benefit:"不可量化成果"};return r.value=O(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((n,y)=>Object.assign(r.value,O(n,p,`item-${y}-`))),m.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(r.value,O(m.value,p))),!Object.keys(r.value).length};return e.onMounted(E),e.provide("editable",V),(p,n)=>{const y=e.resolveComponent("input-text"),g=e.resolveComponent("input-textarea"),i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",kt,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",yt,[e.createElementVNode("div",xt,[e.createElementVNode("table",Bt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ht,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(r)[`item-${c}-Title`],modelValue:a.Title,"onUpdate:modelValue":t=>a.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(r)[`item-${c}-Target`],modelValue:a.Target,"onUpdate:modelValue":t=>a.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r)[`item-${c}-Description`],rows:"1",modelValue:a.Description,"onUpdate:modelValue":t=>a.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",$t,[e.createElementVNode("div",Ct,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>k(a),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Tt)):e.createCommentVNode("",!0),c+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",_t,[e.createElementVNode("table",wt,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(o).Benefit=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Dt,[e.createElementVNode("table",St,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form4Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":n[2]||(n[2]=a=>e.unref(m).Form4After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",At,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=a=>w(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ut={class:"block"},Mt={class:"mt-4"},Ot={class:"table-responsive mt-3 mb-0"},It={class:"table align-middle gray-table"},jt={class:"text-end"},Pt={class:"text-end"},qt={class:"table-responsive"},Rt={class:"table align-middle gray-table"},Lt=["colspan"],zt={key:0,width:"1"},Gt={class:"text-end"},Jt={key:0},Qt={class:"d-flex gap-2"},Wt=["onClick"],Yt={class:"mt-4"},Ht={class:"table-responsive mt-3 mb-0"},Zt={class:"table align-middle gray-table"},Kt={key:0,width:"1"},Xt={class:"text-end"},vt={key:0},el={class:"d-flex gap-2"},tl=["onClick"],ll={class:"mt-4"},ol={class:"table align-middle gray-table side-table"},nl={key:0,class:"block-bottom bg-light-teal"},rl={class:"text-center"},al={class:"mb-5"},dl={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.computed(()=>z("accessibility",o.value.Status,3)),V=e.ref({}),r=e.computed(()=>u.value.filter(c=>!c.Deleted)),l=e.computed(()=>E.value.filter(c=>!c.Deleted)),o=e.ref({}),d=e.ref(),u=e.ref([]),E=e.ref([]),k=e.ref({}),w=e.ref(0),D=()=>u.value.push({}),p=()=>E.value.push({}),n=T,y=()=>{rxjs.forkJoin([M.accessibility("getFunding",{ID:h.id})]).subscribe(c=>{const t=c[0];o.value=t.Project,u.value=t.OtherSubsidies,E.value=t.BudgetPlans,k.value=t.GrantTargetSetting,u.value.length||D(),E.value.length||p(),P().init("accessibility",o.value),N.value=o.value.changeApply,o.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=(c,t)=>{var f,F;if(V.value={},c&&!a()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>k.value.GrantLimit*1e4){d.value.show(()=>i(c,!0));return}const s={Project:o.value,OtherSubsidies:u.value,BudgetPlans:E.value,Before:(f=N.value)==null?void 0:f.Form3Before,After:(F=N.value)==null?void 0:F.Form3After,Submit:c?"true":"false"};M.accessibility("saveFunding",s).subscribe(()=>{c?n("next"):y()})},a=()=>{let c={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=O(o.value,c),c={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},u.value.forEach((t,s)=>Object.assign(V.value,O(t,c,`other-${s}-`))),c={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},E.value.forEach((t,s)=>Object.assign(V.value,O(t,c,`plan-${s}-`))),N.value&&(c={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,O(N.value,c))),!Object.keys(V.value).length};return e.onMounted(y),e.provide("editable",m),e.watchEffect(()=>{o.value.OtherAmount=r.value.reduce((c,t)=>c+L(t.Amount),0),w.value=L(o.value.ApplyAmount)+L(o.value.SelfAmount)+L(o.value.OtherAmount),r.value.forEach(c=>c.percent=Math.round(L(c.Amount)/o.value.OtherAmount*1e4)/100),E.value.forEach(c=>c.sum=L(c.Amount)+L(c.OtherAmount))}),(c,t)=>{var U;const s=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),C=e.resolveComponent("required-label"),A=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ut,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Mt,[e.createElementVNode("div",Ot,[e.createElementVNode("table",It,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=S=>e.unref(o).ApplyAmount=S)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=S=>e.unref(o).SelfAmount=S)},null,8,["error","modelValue"])]),e.createElementVNode("td",jt,e.toDisplayString((U=e.unref(o).OtherAmount)==null?void 0:U.toLocaleString()),1),e.createElementVNode("td",Pt,e.toDisplayString(e.unref(w).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",qt,[e.createElementVNode("table",Rt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Lt)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",zt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(S,b)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,e.toDisplayString(b+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`other-${b}-Unit`],modelValue:S.Unit,"onUpdate:modelValue":B=>S.Unit=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`other-${b}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":B=>S.Amount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Gt,e.toDisplayString(S.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`other-${b}-Content`],rows:"1",modelValue:S.Content,"onUpdate:modelValue":B=>S.Content=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Jt,[e.createElementVNode("div",Qt,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:B=>g(S),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Wt)):e.createCommentVNode("",!0),b+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:D,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Yt,[e.createElementVNode("div",Ht,[e.createElementVNode("table",Zt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Kt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(S,b)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`plan-${b}-Title`],modelValue:S.Title,"onUpdate:modelValue":B=>S.Title=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`plan-${b}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":B=>S.Amount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`plan-${b}-OtherAmount`],modelValue:S.OtherAmount,"onUpdate:modelValue":B=>S.OtherAmount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Xt,e.toDisplayString(S.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`plan-${b}-Description`],rows:"1",modelValue:S.Description,"onUpdate:modelValue":B=>S.Description=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",vt,[e.createElementVNode("div",el,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:B=>g(S),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,tl)):e.createCommentVNode("",!0),b+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ll,[e.createElementVNode("table",ol,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=S=>e.unref(N).Form3Before=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":t[3]||(t[3]=S=>e.unref(N).Form3After=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",nl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=S=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=S=>i(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(A,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",rl,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",al,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(k).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},sl={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:T,type:"accessibility"})}}},ml={class:"block"},il={class:"mt-4"},cl={class:"table align-middle gray-table side-table"},Vl={key:0,class:"d-flex align-items-center gap-2"},pl={class:"input-group w-auto"},fl={class:"text-teal-dark"},Nl={key:1,class:"invalid mt-0"},El={class:"table-responsive mt-4"},ul={class:"table align-middle gray-table"},bl={key:0},gl={class:"input-group"},kl={key:0,class:"invalid mt-0"},yl={key:0},xl={class:"d-flex gap-2"},Bl=["onClick"],hl={class:"mt-4"},$l={class:"table align-middle gray-table"},Cl={key:0},Tl={key:0},_l={class:"d-flex gap-2"},wl=["onClick"],Dl={class:"mt-4"},Sl={class:"table align-middle gray-table side-table"},Al={key:0,class:"block-bottom bg-light-teal"},Fl={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=[{value:1,text:"50%"},{value:2,text:"100%"}],m=e.ref(),V=e.computed(()=>E.value.EndDate),r=e.computed(()=>z("accessibility",u.value.Status,2)),l=e.ref({}),o=e.computed(()=>k.value.filter(c=>!c.Deleted)),d=e.computed(()=>w.value.filter(c=>!c.Deleted)),u=e.ref({}),E=e.ref({}),k=e.ref([]),w=e.ref([]),D=()=>M.accessibility("createItem",{ID:h.id}).subscribe(c=>k.value.push(c)),p=()=>w.value.push({Type:0,ItemID:0}),n=T,y=()=>{rxjs.forkJoin([M.accessibility("getWorkSchedule",{ID:h.id})]).subscribe(c=>{const t=c[0];u.value=t.Project,E.value=t.GrantType,k.value=t.Items,w.value=t.Schedules,k.value.length||D(),w.value.length||p(),P().init("accessibility",u.value),m.value=u.value.changeApply,u.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=c=>{var s,f;if(l.value={},c&&!a()){e.nextTick(()=>{var F;return(F=document.querySelector(".invalid"))==null?void 0:F.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:u.value,Items:k.value,Schedules:w.value,Before:(s=m.value)==null?void 0:s.Form2Before,After:(f=m.value)==null?void 0:f.Form2After,Submit:c?"true":"false"};M.accessibility("saveWorkSchedule",t).subscribe(()=>{c?n("next"):y()})},a=()=>{let c={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(u.value,c),c={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`item-${s}-`))),c={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`schedule-${s}-`))),m.value&&(c={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(m.value,c))),!Object.keys(l.value).length};return e.onMounted(y),e.provide("editable",r),(c,t)=>{const s=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),F=e.resolveComponent("tw-date"),C=e.resolveComponent("input-text"),A=e.resolveComponent("input-month"),U=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ml,[t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",il,[e.createElementVNode("table",cl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",Vl,[e.createElementVNode("div",pl,[e.createVNode(f,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(u).StartTime,"onUpdate:modelValue":t[0]||(t[0]=b=>e.unref(u).StartTime=b)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(u).EndTime,"onUpdate:modelValue":t[1]||(t[1]=b=>e.unref(u).EndTime=b)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",fl,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(F,{value:e.unref(V)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",Nl,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",El,[e.createElementVNode("table",ul,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",bl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(l)[`item-${B}-Title`],modelValue:b.Title,"onUpdate:modelValue":_=>b.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",gl,[e.createVNode(A,{"empty-value":0,modelValue:b.Begin,"onUpdate:modelValue":_=>b.Begin=_},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(A,{"empty-value":0,modelValue:b.End,"onUpdate:modelValue":_=>b.End=_},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${B}-Begin`]||e.unref(l)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",kl,e.toDisplayString(e.unref(l)[`item-${B}-Begin`]||e.unref(l)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`item-${B}-Deadline`],modelValue:b.Deadline,"onUpdate:modelValue":_=>b.Deadline=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`item-${B}-Content`],rows:"1",modelValue:b.Content,"onUpdate:modelValue":_=>b.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",yl,[e.createElementVNode("div",xl,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>g(b),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bl)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:D,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[29]||(t[29]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",hl,[e.createElementVNode("table",$l,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[21]||(t[21]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Cl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(l)[`schedule-${B}-Type`],options:N,modelValue:b.Type,"onUpdate:modelValue":_=>b.Type=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(l)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:b.ItemID,"onUpdate:modelValue":_=>b.ItemID=_,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(b.ItemID?String.fromCharCode(65+e.unref(o).findIndex(_=>_.ID===b.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`schedule-${B}-Deadline`],modelValue:b.Deadline,"onUpdate:modelValue":_=>b.Deadline=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`schedule-${B}-Content`],rows:"1",modelValue:b.Content,"onUpdate:modelValue":_=>b.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Tl,[e.createElementVNode("div",_l,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>g(b),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,wl)):e.createCommentVNode("",!0),B+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[23]||(t[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Dl,[e.createElementVNode("table",Sl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=b=>e.unref(m).Form2Before=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":t[3]||(t[3]=b=>e.unref(m).Form2After=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Al,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=b=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=b=>i(!0)),type:"button"},[...t[30]||(t[30]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ul={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Ml={class:"modal-content"},Ol={class:"modal-body"},Il={class:"d-flex justify-content-center mt-4 gap-4"},jl={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Pl={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(x,{expose:T}){let h;const N=e.ref(),m=x,V=()=>{h&&h()};return T({show:l=>{h=l,bootstrap.Modal.getOrCreateInstance(N.value).show()}}),(l,o)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:N,tabindex:"-1"},[e.createElementVNode("div",Ul,[e.createElementVNode("div",Ml,[o[0]||(o[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Ol,[e.renderSlot(l.$slots,"default"),e.createElementVNode("div",Il,[e.createElementVNode("button",jl,e.toDisplayString(m.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:V,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(m.confirm),1)])])])])],512)]))}},ql={class:"application-step"},Rl=["onClick"],Ll={class:"step-content"},zl={class:"step-label"},Gl={key:0,class:"step-status edit"},Jl={key:1,class:"step-status"},Ql={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(x,{emit:T}){const h=e.computed(()=>z(m.type,N[m.type].status,m.step)),N=P(),m=x,V=l=>{m.review?r("click",l.step):l.step<=N[m.type].step&&(location.href=`${l.url}.aspx?ID=${m.id}`)},r=T;return(l,o)=>(e.openBlock(),e.createElementBlock("div",ql,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.steps,d=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(h)&&(d.step<e.unref(N)[x.type].step||d.step===x.step)}]),onClick:u=>V(d),key:d,role:"button"},[e.createElementVNode("div",Ll,[e.createElementVNode("div",zl,e.toDisplayString(d.title),1),e.unref(h)&&d.step===x.step?(e.openBlock(),e.createElementBlock("div",Gl,"編輯中")):d.step<e.unref(N)[x.type].step?(e.openBlock(),e.createElementBlock("div",Jl,"已完成")):e.createCommentVNode("",!0)])],10,Rl))),128))]))}},Wl={class:"block"},Yl={class:"mt-4"},Hl={class:"table align-middle gray-table side-table"},Zl={key:0},Kl={key:1,class:"text-light-gray"},Xl={class:"d-flex gap-2"},vl={key:0,class:"invalid mt-0"},eo={class:"d-flex flex-column gap-2"},to={key:0},lo={class:"mt-4"},oo={class:"table align-middle gray-table side-table"},no={class:"row g-3"},ro={class:"col-12 col-xl-2"},ao={class:"text-gray mb-2"},so={class:"col-12 col-xl-3"},mo={class:"text-gray mb-2"},io={class:"col-12 col-xl-4"},co={class:"row g-1"},Vo={class:"col-7"},po={class:"col-5"},fo={class:"col-12 col-xl-3"},No={class:"text-gray mb-2"},Eo={class:"col-12"},uo={class:"text-gray mb-2"},bo={class:"mt-4"},go={class:"table align-middle gray-table side-table"},ko={class:"mt-4"},yo={class:"table align-middle gray-table side-table"},xo={key:0,class:"table-responsive mt-3 mb-0"},Bo={class:"table align-middle gray-table"},ho={key:0},$o={key:0},Co={class:"d-flex gap-2"},To=["onClick"],_o={class:"mt-4"},wo={class:"table align-middle gray-table side-table"},Do={key:0,class:"block-bottom bg-light-teal"},So={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.ref(),r=e.computed(()=>z("culture",E.value.Status,1)),l=e.ref({}),o=e.ref(null),d=e.ref([]),u=e.computed(()=>w.value.filter(t=>!t.Deleted)),E=e.ref({}),k=e.computed(()=>d.value.filter(t=>!t.ParentCode)),w=e.ref([]),D=e.computed(()=>d.value.filter(t=>t.ParentCode===o.value)),p=e.computed({get:()=>!!u.value.length,set:t=>{t?n():w.value.forEach(s=>s.Deleted=!0)}}),n=()=>w.value.push({}),y=T,g=()=>{M.culture("getApplication",{ID:h.id}).subscribe(t=>{var s;E.value=t.Project,V.value=t.Contacts,w.value=t.ReceivedSubsidies,o.value=((s=d.value.find(f=>f.Code===E.value.Field))==null?void 0:s.ParentCode)||null,E.value.OrgCategory=E.value.OrgCategory||null,P().init("culture",E.value),m.value=E.value.changeApply,E.value.changeApply=void 0})},i=t=>t.Deleted=!0,a=t=>{var f,F;if(l.value={},t&&!c()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}const s={Project:E.value,Contacts:V.value,ReceivedSubsidies:w.value.filter(C=>C.ID||!C.Deleted),Before:(f=m.value)==null?void 0:f.Form1Before,After:(F=m.value)==null?void 0:F.Form1After,Submit:t?"true":"false"};M.culture("saveApplication",s).subscribe(C=>{t?y("next",C.ID):E.value.ID?g():window.location.href=`Application.aspx?ID=${C.ID}`})},c=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return E.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),l.value=O(E.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((s,f)=>Object.assign(l.value,O(s,t,`contact-${f}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},w.value.forEach((s,f)=>Object.assign(l.value,O(s,t,`received-${f}-`))),m.value&&(t={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(m.value,t))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([M.culture("getZgsCodes",{CodeGroup:"CULField"}),M.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{d.value=t[0],N.value=t[1],h.id?g():M.culture("getEmptyApplication").subscribe(s=>{o.value=null,E.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},s),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("culture",E.value)})})}),e.provide("editable",r),e.watch(o,()=>{o.value?D.value.find(t=>E.value.Field===t.Code)||(E.value.Field=D.value[0].Code):E.value.Field=null}),(t,s)=>{const f=e.resolveComponent("required-label"),F=e.resolveComponent("input-text"),C=e.resolveComponent("input-select"),A=e.resolveComponent("input-textarea"),U=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wl,[s[45]||(s[45]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Yl,[e.createElementVNode("table",Hl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[17]||(s[17]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(E).Year),1)]),e.createElementVNode("tr",null,[s[18]||(s[18]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(E).ProjectID?(e.openBlock(),e.createElementBlock("span",Zl,e.toDisplayString(e.unref(E).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Kl,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[s[19]||(s[19]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(E).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[20]||(s[20]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l).ProjectName,modelValue:e.unref(E).ProjectName,"onUpdate:modelValue":s[0]||(s[0]=b=>e.unref(E).ProjectName=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[21]||(s[21]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Xl,[e.createVNode(C,{"empty-value":null,options:e.unref(k),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o),"onUpdate:modelValue":s[1]||(s[1]=b=>e.isRef(o)?o.value=b:null)},null,8,["options","modelValue"]),e.createVNode(C,{"empty-value":null,disabled:!e.unref(o),options:e.unref(D),"text-name":"Descname","value-name":"Code",modelValue:e.unref(E).Field,"onUpdate:modelValue":s[2]||(s[2]=b=>e.unref(E).Field=b)},null,8,["disabled","options","modelValue"])]),e.unref(l).Field?(e.openBlock(),e.createElementBlock("div",vl,e.toDisplayString(e.unref(l).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[22]||(s[22]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(E).OrgName,"onUpdate:modelValue":s[3]||(s[3]=b=>e.unref(E).OrgName=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[23]||(s[23]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",eo,[e.createElementVNode("div",null,[e.createVNode(C,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(E).OrgCategory,"onUpdate:modelValue":s[4]||(s[4]=b=>e.unref(E).OrgCategory=b)},null,8,["error","options","modelValue"])]),e.unref(E).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",to,[e.createVNode(F,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(E).RegisteredNum,"onUpdate:modelValue":s[5]||(s[5]=b=>e.unref(E).RegisteredNum=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[24]||(s[24]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(E).TaxID,"onUpdate:modelValue":s[6]||(s[6]=b=>e.unref(E).TaxID=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[25]||(s[25]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(E).Address,"onUpdate:modelValue":s[7]||(s[7]=b=>e.unref(E).Address=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),s[46]||(s[46]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",lo,[e.createElementVNode("table",oo,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",no,[e.createElementVNode("div",ro,[e.createElementVNode("div",ao,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[26]||(s[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(F,{error:e.unref(l)[`contact-${B}-Name`],modelValue:b.Name,"onUpdate:modelValue":_=>b.Name=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",so,[e.createElementVNode("div",mo,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[27]||(s[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(F,{error:e.unref(l)[`contact-${B}-JobTitle`],modelValue:b.JobTitle,"onUpdate:modelValue":_=>b.JobTitle=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",io,[s[28]||(s[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",co,[e.createElementVNode("div",Vo,[e.createVNode(F,{modelValue:b.Phone,"onUpdate:modelValue":_=>b.Phone=_,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",po,[e.createVNode(F,{placeholder:"請輸入分機",size:"4",modelValue:b.PhoneExt,"onUpdate:modelValue":_=>b.PhoneExt=_,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",fo,[e.createElementVNode("div",No,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[29]||(s[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(F,{error:e.unref(l)[`contact-${B}-MobilePhone`],modelValue:b.MobilePhone,"onUpdate:modelValue":_=>b.MobilePhone=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Eo,[e.createElementVNode("div",uo,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[30]||(s[30]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(F,{error:e.unref(l)[`contact-${B}-EMail`],modelValue:b.EMail,"onUpdate:modelValue":_=>b.EMail=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),s[47]||(s[47]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",bo,[e.createElementVNode("table",go,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[31]||(s[31]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[s[32]||(s[32]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(A,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(E).Target,"onUpdate:modelValue":s[8]||(s[8]=b=>e.unref(E).Target=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[33]||(s[33]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(E).Summary,"onUpdate:modelValue":s[9]||(s[9]=b=>e.unref(E).Summary=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[34]||(s[34]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(E).Quantified,"onUpdate:modelValue":s[10]||(s[10]=b=>e.unref(E).Quantified=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[35]||(s[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(E).Qualitative,"onUpdate:modelValue":s[11]||(s[11]=b=>e.unref(E).Qualitative=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ko,[e.createElementVNode("table",yo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[s[41]||(s[41]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(U,{modelValue:e.unref(p),"onUpdate:modelValue":s[12]||(s[12]=b=>e.isRef(p)?p.value=b:null)},null,8,["modelValue"]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",xo,[e.createElementVNode("table",Bo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[s[36]||(s[36]=e.createElementVNode("th",null,"計畫名稱",-1)),s[37]||(s[37]=e.createElementVNode("th",null,"補助單位",-1)),s[38]||(s[38]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",ho,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l)[`received-${B}-Name`],modelValue:b.Name,"onUpdate:modelValue":_=>b.Name=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l)[`received-${B}-Unit`],modelValue:b.Unit,"onUpdate:modelValue":_=>b.Unit=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l)[`received-${B}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",$o,[e.createElementVNode("div",Co,[e.unref(u).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>i(b),type:"button"},[...s[39]||(s[39]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,To)):e.createCommentVNode("",!0),B+1===e.unref(u).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:n,type:"button"},[...s[40]||(s[40]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[s[44]||(s[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_o,[e.createElementVNode("table",wo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[42]||(s[42]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":s[13]||(s[13]=b=>e.unref(m).Form1Before=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...s[43]||(s[43]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":s[14]||(s[14]=b=>e.unref(m).Form1After=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Do,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[15]||(s[15]=b=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[16]||(s[16]=b=>a(!0)),type:"button"},[...s[48]||(s[48]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ao={class:"block"},Fo={key:0,class:"text-pink lh-base mt-4"},Uo={class:"mt-4"},Mo={class:"table align-middle gray-table"},Oo={class:"text-center"},Io={key:0,width:"180"},jo={class:"text-center"},Po={key:0},qo=["innerHTML"],Ro=["href"],Lo={key:0,class:"text-center"},zo={key:0},Go={key:1,class:"text-pink"},Jo={key:1,class:"tag-group mt-2 gap-1"},Qo={key:0,class:"tag tag-green-light"},Wo=["download","href"],Yo=["onClick"],Ho={class:"mt-4"},Zo={class:"table align-middle gray-table side-table"},Ko={key:0,class:"block-bottom bg-light-teal"},Xo=["disabled"],vo={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/CUL/1.申請表.docx",Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:"../../Template/CUL/2.計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/CUL/3.執行承諾書.docx",Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:"../../Template/CUL/4.未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),m=e.ref(),V=e.computed(()=>N.value.some(p=>!p.Optional&&!p.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("culture",o.value.Status,5)),l=e.ref({}),o=e.ref({}),d=(p,n)=>{n.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:n.Path,Name:o.value.ProjectID+"_"+(p.Multiple?n.Name:`${p.Title}.pdf`)})},u=M.download,E=T,k=()=>{rxjs.forkJoin([M.culture("getAttachment",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=N.value.filter(y=>{var g;return!((g=y.Excludes)!=null&&g.includes(o.value.OrgCategory))}),o.value.Status>=42&&N.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]}),N.value.forEach(y=>{y.Files=n.Attachments.filter(g=>g.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(g=>!g.Deleted).length)}),P().init("culture",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},w=p=>{var y,g;if(l.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:h.id,Attachments:N.value.reduce((i,a)=>i.concat(a.Files),[]),Before:(y=m.value)==null?void 0:y.Form5Before,After:(g=m.value)==null?void 0:g.Form5After,Submit:p?"true":"false"};M.culture("saveAttachment",n).subscribe(()=>{p?E("next"):k()})},D=()=>{if(m.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(m.value,p))}return!Object.keys(l.value).length};return e.onMounted(k),e.provide("editable",r),(p,n)=>{const y=e.resolveComponent("required-label"),g=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ao,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",Fo,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Uo,[e.createElementVNode("table",Mo,[e.createElementVNode("thead",Oo,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Io,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",jo,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[a.Optional?(e.openBlock(),e.createElementBlock("span",Po,e.toDisplayString(a.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.Title),1)]),_:2},1024))]),e.unref(r)&&a.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:a.Comment},null,8,qo)):e.createCommentVNode("",!0),e.unref(r)&&a.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:a.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Ro)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Lo,[a.Uploaded?(e.openBlock(),e.createElementBlock("span",zo,"已上傳")):(e.openBlock(),e.createElementBlock("span",Go,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(a.Multiple||!a.Uploaded)?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:t=>d(a,t)},null,8,["onFile"])):e.createCommentVNode("",!0),a.Uploaded?(e.openBlock(),e.createElementBlock("div",Jo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Qo,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(u)(t.Path)},e.toDisplayString(t.Name),9,Wo),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:s=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Yo)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ho,[e.createElementVNode("table",Zo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(m).Form5Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form5After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Ko,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=a=>w(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Xo)])):e.createCommentVNode("",!0)],64)}}},en={class:"block"},tn={class:"mt-4"},ln={class:"table-responsive mt-3 mb-0"},on={class:"table align-middle gray-table"},nn={class:"text-end"},rn={class:"text-end"},an={class:"table-responsive"},dn={class:"table align-middle gray-table"},sn=["colspan"],mn={key:0,width:"1"},cn={key:0},Vn={class:"d-flex gap-2"},pn=["onClick"],fn={class:"mt-4"},Nn={class:"table-responsive mt-3 mb-0"},En={class:"table align-middle gray-table"},un={key:0,width:"1"},bn={class:"text-end"},gn={key:0},kn={class:"d-flex gap-2"},yn=["onClick"],xn={class:"mt-4"},Bn={class:"table align-middle gray-table side-table"},hn={key:0,class:"block-bottom bg-light-teal"},$n={class:"text-center"},Cn={class:"mb-5"},Tn={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.computed(()=>z("culture",o.value.Status,3)),V=e.ref({}),r=e.computed(()=>E.value.filter(s=>!s.Deleted)),l=e.computed(()=>k.value.filter(s=>!s.Deleted)),o=e.ref({}),d=e.ref([]),u=e.ref(),E=e.ref([]),k=e.ref([]),w=e.ref({}),D=e.ref(0),p=()=>E.value.push({}),n=()=>k.value.push({ItemID:0}),y=T,g=()=>{rxjs.forkJoin([M.culture("getFunding",{ID:h.id})]).subscribe(s=>{const f=s[0];o.value=f.Project,E.value=f.OtherSubsidies,k.value=f.BudgetPlans,d.value=f.Items,w.value=f.GrantTargetSetting,E.value.length||p(),k.value.length||n(),P().init("culture",o.value),N.value=o.value.changeApply,o.value.changeApply=void 0})},i=s=>s.Deleted=!0,a=s=>s.Deleted=!0,c=(s,f)=>{var C,A;if(V.value={},s&&!t()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!f&&o.value.ApplyAmount>w.value.GrantLimit*1e4){u.value.show(()=>c(s,!0));return}const F={Project:o.value,OtherSubsidies:E.value,BudgetPlans:k.value,Before:(C=N.value)==null?void 0:C.Form3Before,After:(A=N.value)==null?void 0:A.Form3After,Submit:s?"true":"false"};M.culture("saveFunding",F).subscribe(()=>{s?y("next"):g()})},t=()=>{let s={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=O(o.value,s),s={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},E.value.forEach((f,F)=>Object.assign(V.value,O(f,s,`other-${F}-`))),s={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},k.value.forEach((f,F)=>Object.assign(V.value,O(f,s,`plan-${F}-`))),N.value&&(s={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,O(N.value,s))),!Object.keys(V.value).length};return e.onMounted(g),e.provide("editable",m),e.watchEffect(()=>{o.value.OtherAmount=E.value.reduce((s,f)=>s+(f.Deleted?0:L(f.Amount)),0),D.value=L(o.value.ApplyAmount)+L(o.value.SelfAmount)+L(o.value.OtherAmount),k.value.forEach(s=>s.sum=L(s.Amount)+L(s.OtherAmount))}),(s,f)=>{var B;const F=e.resolveComponent("input-integer"),C=e.resolveComponent("input-text"),A=e.resolveComponent("input-select"),U=e.resolveComponent("input-textarea"),S=e.resolveComponent("required-label"),b=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",en,[f[25]||(f[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",tn,[e.createElementVNode("div",ln,[e.createElementVNode("table",on,[f[6]||(f[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":f[0]||(f[0]=_=>e.unref(o).ApplyAmount=_)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":f[1]||(f[1]=_=>e.unref(o).SelfAmount=_)},null,8,["error","modelValue"])]),e.createElementVNode("td",nn,e.toDisplayString((B=e.unref(o).OtherAmount)==null?void 0:B.toLocaleString()),1),e.createElementVNode("td",rn,e.toDisplayString(e.unref(D).toLocaleString()),1)])])])]),f[12]||(f[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",an,[e.createElementVNode("table",dn,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,sn)]),e.createElementVNode("tr",null,[f[7]||(f[7]=e.createElementVNode("th",{width:"1"},null,-1)),f[8]||(f[8]=e.createElementVNode("th",null,"單位名稱",-1)),f[9]||(f[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",mn,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(_,I)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,e.toDisplayString(I+1),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(V)[`other-${I}-Unit`],modelValue:_.Unit,"onUpdate:modelValue":j=>_.Unit=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`other-${I}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":j=>_.Amount=j},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",cn,[e.createElementVNode("div",Vn,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:j=>i(_),type:"button"},[...f[10]||(f[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pn)):e.createCommentVNode("",!0),I+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...f[11]||(f[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),f[26]||(f[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",fn,[e.createElementVNode("div",Nn,[e.createElementVNode("table",En,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[13]||(f[13]=e.createElementVNode("th",null,"重要工作項目",-1)),f[14]||(f[14]=e.createElementVNode("th",null,"預算項目",-1)),f[15]||(f[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),f[16]||(f[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),f[17]||(f[17]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),f[18]||(f[18]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",un,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(_,I)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(V)[`plan-${I}-ItemID`],options:e.unref(d),"text-name":"Title","value-name":"ID",modelValue:_.ItemID,"onUpdate:modelValue":j=>_.ItemID=j},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(V)[`plan-${I}-Title`],modelValue:_.Title,"onUpdate:modelValue":j=>_.Title=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`plan-${I}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":j=>_.Amount=j},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`plan-${I}-OtherAmount`],modelValue:_.OtherAmount,"onUpdate:modelValue":j=>_.OtherAmount=j},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",bn,e.toDisplayString(_.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(V)[`plan-${I}-Description`],rows:"1",modelValue:_.Description,"onUpdate:modelValue":j=>_.Description=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",gn,[e.createElementVNode("div",kn,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:j=>a(_),type:"button"},[...f[19]||(f[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,yn)):e.createCommentVNode("",!0),I+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:n,type:"button"},[...f[20]||(f[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),f[21]||(f[21]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[f[24]||(f[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",xn,[e.createElementVNode("table",Bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[22]||(f[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":f[2]||(f[2]=_=>e.unref(N).Form3Before=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[23]||(f[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":f[3]||(f[3]=_=>e.unref(N).Form3After=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",hn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[4]||(f[4]=_=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[5]||(f[5]=_=>c(!0)),type:"button"},[...f[27]||(f[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(b,{ref_key:"modal",ref:u},{default:e.withCtx(()=>[e.createElementVNode("div",$n,[f[28]||(f[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Cn,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(w).GrantLimit)+"萬",1),f[29]||(f[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),f[30]||(f[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},_n={class:"block"},wn={key:0,class:"text-pink lh-base mt-3"},Dn={class:"border"},Sn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},An={class:"d-flex gap-2 align-items-center flex-grow-1"},Fn={class:"text-nowrap"},Un={class:"flex-grow-1"},Mn={class:"d-flex gap-2"},On=["onClick"],In=["href"],jn=["id"],Pn={class:"table align-middle gray-table side-table mb-0"},qn={class:"mt-4"},Rn={class:"table align-middle gray-table side-table"},Ln={key:0,class:"block-bottom bg-light-teal"},zn={__name:"Other",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.computed(()=>z("culture",r.value.Status,4)),V=e.ref({}),r=e.ref({}),l=e.ref([]),o=e.computed(()=>l.value.filter(p=>!p.Deleted)),d=()=>l.value.push({}),u=T,E=()=>{rxjs.forkJoin([M.culture("getRelatedProject",{ID:h.id})]).subscribe(p=>{const n=p[0];r.value=n.Project,l.value=n.Projects,P().init("culture",r.value),N.value=r.value.changeApply,r.value.changeApply=void 0})},k=p=>p.Deleted=!0,w=p=>{var y,g;if(V.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:h.id,Projects:l.value,Before:(y=N.value)==null?void 0:y.Form4Before,After:(g=N.value)==null?void 0:g.Form4After,Submit:p?"true":"false"};M.culture("saveRelatedProject",n).subscribe(()=>{p?u("next"):E()})},D=()=>{let p={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return o.value.forEach((n,y)=>Object.assign(V.value,O(n,p,`project-${y}-`))),N.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(V.value,O(N.value,p))),!Object.keys(V.value).length};return e.onMounted(E),e.provide("editable",m),(p,n)=>{const y=e.resolveComponent("required-label"),g=e.resolveComponent("input-text"),i=e.resolveComponent("input-integer"),a=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",_n,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",wn," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(c,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:c},[e.createElementVNode("div",Dn,[e.createElementVNode("div",Sn,[e.createElementVNode("div",An,[e.createElementVNode("label",Fn,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[4]||(n[4]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",Un,[e.createVNode(g,{error:e.unref(V)[`project-${t}-Title`],modelValue:c.Title,"onUpdate:modelValue":s=>c.Title=s,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Mn,[e.unref(m)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(s=>k(c),["prevent"]),href:"#"},"刪除",8,On)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,In)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",Pn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[5]||(n[5]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{class:"text-start w-auto",error:e.unref(V)[`project-${t}-Year`],modelValue:c.Year,"onUpdate:modelValue":s=>c.Year=s},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[6]||(n[6]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`project-${t}-OrgName`],modelValue:c.OrgName,"onUpdate:modelValue":s=>c.OrgName=s,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[7]||(n[7]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{class:"w-auto",error:e.unref(V)[`project-${t}-Amount`],modelValue:c.Amount,"onUpdate:modelValue":s=>c.Amount=s},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[8]||(n[8]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(a,{error:e.unref(V)[`project-${t}-Description`],rows:"4",modelValue:c.Description,"onUpdate:modelValue":s=>c.Description=s,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[9]||(n[9]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(a,{error:e.unref(V)[`project-${t}-Benefit`],rows:"4",modelValue:c.Benefit,"onUpdate:modelValue":s=>c.Benefit=s,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,jn)])]))),128)),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:d,type:"button"},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",qn,[e.createElementVNode("table",Rn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(a,{error:e.unref(V).Form4Before,rows:"4",modelValue:e.unref(N).Form4Before,"onUpdate:modelValue":n[0]||(n[0]=c=>e.unref(N).Form4Before=c),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(a,{error:e.unref(V).Form4After,rows:"4",modelValue:e.unref(N).Form4After,"onUpdate:modelValue":n[1]||(n[1]=c=>e.unref(N).Form4After=c),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Ln,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=c=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=c=>w(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Gn={class:"block rounded-top-4"},Jn={class:"horizontal-scrollable"},Qn={class:"timeline"},Wn={class:"year"},Yn={class:"month"},Hn=["onClick"],Zn={class:"square-title"},Kn={class:"table-responsive mt-4"},Xn={class:"table align-middle gray-table"},vn={class:"text-end"},er={class:"table-responsive"},tr={class:"table align-middle gray-table"},lr={class:"text-end"},or={key:0,class:"invalid mt-0"},nr={class:"mt-3"},rr={class:"mt-3"},ar=["rowspan"],dr={key:0,class:"block-bottom bg-light-teal"},sr={__name:"Progress",props:{id:{type:[Number,String]}},setup(x){const T=[{value:3,text:"完成"},{value:2,text:"部分完成"},{value:1,text:"未完成"}],h=x,N=e.ref(),m=e.ref({}),V=e.ref(0),r=e.ref({}),l=e.ref([]),o=e.ref({}),d=e.computed(()=>Math.round((V.value+l.value.filter(n=>n.Status===3).length)*100/u.value.length*10)/10),u=e.ref([]),E=e.ref([]),k=n=>{N.value=n,w()},w=()=>{M.culture("getMonthlyProgress",{ID:h.id,Year:N.value.year-1911,Month:N.value.month}).subscribe(n=>{const y=n.Logs,g=n.Items,i=n.Steps;let a=!1;V.value=0,o.value=n.Progress,u.value=n.Schedules,l.value=[],E.value.forEach(c=>{c.months.forEach(t=>{a||(t===N.value&&(a=!0),u.value.forEach(s=>{var f,F;if(s.Month===t.month)if(a||s.Status!==3){const C=y.find(A=>A.ScheduleID===s.ID)||{ScheduleID:s.ID,Status:s.Status};l.value.push(Object.assign(C,{Year:c.year,Month:s.Month,ItemTitle:(f=g.find(A=>A.ID===s.ItemID))==null?void 0:f.Title,Type:s.Type,StepTitle:(F=i.find(A=>A.ID===s.StepID))==null?void 0:F.Title}))}else V.value++}))})})})},D=n=>{if(m.value={},n&&!p()){e.nextTick(()=>{var g;return(g=document.querySelector(".invalid"))==null?void 0:g.scrollIntoView({behavior:"smooth",block:"center"})});return}const y={ID:o.value.ID,Description:o.value.Description||"",Status:n?1:0,Logs:l.value.map(g=>({ID:g.ID||0,ScheduleID:g.ScheduleID,Status:g.Status,DelayReason:g.DelayReason||"",ImprovedWay:g.ImprovedWay||""}))};M.culture("saveMonthlyProgress",y).subscribe(g=>{g&&(window.location.href="../inprogressList.aspx")})},p=()=>{let n={Description:"實際工作執行情形"};return m.value=O(o.value,n),l.value.forEach((y,g)=>{n={Status:{numericality:{greaterThan:0,message:"^請輸入本月是否完成"}}},[1,2].includes(y.Status)&&(n.DelayReason="落後原因",n.ImprovedWay="改善措施"),Object.assign(m.value,O(y,n,`item-${g}-`))}),!Object.keys(m.value).length};return e.onMounted(()=>{M.culture("getApplication",{ID:h.id}).subscribe(n=>{r.value=n.Project,P().init("culture",r.value);const y=new Date(r.value.StartTime),g=new Date(r.value.EndTime),i=Date.now();for(;;){const a=y.getFullYear(),c=y.getMonth(),t={year:a,month:c+1,disabled:new Date(a,c,20).getTime()>i};let s=E.value.find(f=>f.year===a);if(s?s.months.push(t):E.value.push({year:a,months:[t]}),a*100+c>=g.getFullYear()*100+g.getMonth())break;y.setMonth(c+1)}})}),(n,y)=>{const g=e.resolveComponent("input-textarea"),i=e.resolveComponent("input-radio-group");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Gn,[e.createElementVNode("div",Jn,[y[3]||(y[3]=e.createElementVNode("button",{class:"btn-control btn-prev",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-left"})],-1)),e.createElementVNode("ul",Qn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),a=>(e.openBlock(),e.createElementBlock("li",{key:a},[e.createElementVNode("span",Wn,e.toDisplayString(a.year-1911)+"年",1),e.createElementVNode("ul",Yn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.months,c=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass({active:e.unref(N)===c,disabled:c.disabled}),key:c},[e.createElementVNode("a",{onClick:t=>k(c),href:"javascript:void(0)"},e.toDisplayString(c.month)+"月",9,Hn)],2))),128))])]))),128))]),y[4]||(y[4]=e.createElementVNode("button",{class:"btn-control btn-next",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-right"})],-1))]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h5",Zn,e.toDisplayString(e.unref(N).year-1911)+"年"+e.toDisplayString(e.unref(N).month)+"月 實際進度",1),e.createElementVNode("div",Kn,[e.createElementVNode("table",Xn,[y[5]||(y[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",{class:"text-center"},"實際工作執行情形（條列式說明）")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",vn,e.toDisplayString(e.unref(N).year-1911)+"年"+e.toDisplayString(e.unref(N).month)+"月",1),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m).Description,rows:"4",modelValue:e.unref(o).Description,"onUpdate:modelValue":y[0]||(y[0]=a=>e.unref(o).Description=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",er,[e.createElementVNode("table",tr,[y[8]||(y[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",null,"重要工作項目"),e.createElementVNode("th",null,"工作進度%"),e.createElementVNode("th",null,"檢核工作"),e.createElementVNode("th",null,"本月是否完成"),e.createElementVNode("th",null,"年度目標達成數")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("th",lr,e.toDisplayString(a.Year-1911)+"年"+e.toDisplayString(a.Month)+"月",1),e.createElementVNode("td",null,e.toDisplayString(a.ItemTitle),1),e.createElementVNode("td",null,e.toDisplayString(a.Type===1?"50%":"100%"),1),e.createElementVNode("td",null,e.toDisplayString(a.StepTitle),1),e.createElementVNode("td",null,[e.createVNode(i,{options:T,modelValue:a.Status,"onUpdate:modelValue":t=>a.Status=t},null,8,["modelValue","onUpdate:modelValue"]),e.unref(m)[`item-${c}-Status`]?(e.openBlock(),e.createElementBlock("div",or,e.toDisplayString(e.unref(m)[`item-${c}-Status`]),1)):e.createCommentVNode("",!0),[1,2].includes(a.Status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",nr,[y[6]||(y[6]=e.createElementVNode("div",{class:"text-teal pb-2"},"落後原因",-1)),e.createVNode(g,{error:e.unref(m)[`item-${c}-DelayReason`],rows:"1",modelValue:a.DelayReason,"onUpdate:modelValue":t=>a.DelayReason=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rr,[y[7]||(y[7]=e.createElementVNode("div",{class:"text-teal pb-2"},"改善措施",-1)),e.createVNode(g,{error:e.unref(m)[`item-${c}-ImprovedWay`],rows:"1",modelValue:a.ImprovedWay,"onUpdate:modelValue":t=>a.ImprovedWay=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])],64)):e.createCommentVNode("",!0)]),c?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("td",{key:0,class:"text-end",rowspan:e.unref(l).length},e.toDisplayString(e.unref(d))+"% ",9,ar))]))),128))])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",dr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:y[1]||(y[1]=a=>D()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:y[2]||(y[2]=a=>D(!0)),type:"button"},[...y[9]||(y[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])):e.createCommentVNode("",!0)],64)}}},mr={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:T,type:"culture"})}}},ir=(x,T)=>{const h=x.__vccOpts||x;for(const[N,m]of T)h[N]=m;return h},cr={class:"block"},Vr={class:"mt-4"},pr={class:"table align-middle gray-table side-table"},fr={key:0,class:"d-flex align-items-center gap-2"},Nr={class:"input-group w-auto"},Er={class:"text-teal-dark"},ur={key:1,class:"invalid mt-0"},br={class:"square-title mt-4"},gr={class:"mt-4"},kr=["onClick"],yr={class:"d-flex flex-column gap-2"},xr={class:"mt-4 d-flex flex-column gap-2"},Br={class:"d-flex flex-column gap-3 mt-4"},hr={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},$r={class:"d-flex gap-2 align-items-center flex-grow-1"},Cr={class:"text-nowrap"},Tr={class:"flex-grow-1"},_r={class:"d-flex gap-2"},wr=["onClick"],Dr=["href"],Sr=["id"],Ar={class:"table align-middle gray-table side-table mb-0"},Fr={class:"p-0"},Ur={class:"item-list"},Mr={class:"mt-2 align-self-start text-center"},Or={class:"input-group"},Ir={key:0,class:"invalid mt-0"},jr={key:0,class:"d-flex gap-2 mt-1 align-self-start"},Pr=["onClick"],qr=["onClick"],Rr={class:"row"},Lr={class:"col"},zr=["value"],Gr={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Jr=["onClick"],Qr=["onClick"],Wr={class:"col"},Yr=["value"],Hr={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Zr=["onClick"],Kr=["onClick"],Xr=["onClick"],vr={class:"mt-4"},ea={class:"table align-middle gray-table side-table"},ta={key:0,class:"block-bottom bg-light-teal"},la=ir({__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.computed(()=>z("culture",o.value.Status,2)),V=e.computed(()=>u.value.EndDate),r=e.ref({}),l=e.computed(()=>d.value.filter(s=>!s.Deleted)),o=e.ref({}),d=e.ref([]),u=e.ref({}),E=()=>{M.culture("createGoal",{ID:h.id}).subscribe(s=>{d.value.push(Object.assign(s,{Items:[]}));const f=d.value[d.value.length-1];k(f)})},k=s=>{M.culture("createGoalItem",{ID:h.id,GoalID:s.ID}).subscribe(f=>{s.Items.push(Object.assign(f,{Steps:[],Schedules:[]}));const F=s.Items[s.Items.length-1];D(F),D(F),D(F),w(F,1),w(F,2)})},w=(s,f)=>M.culture("createGoalSchedule",{ID:h.id,ItemID:s.ID,Type:f}).subscribe(F=>s.Schedules.push(F)),D=s=>M.culture("createGoalStep",{ID:h.id,ItemID:s.ID}).subscribe(f=>s.Steps.push(f)),p=T,n=()=>{rxjs.forkJoin([M.culture("getWorkSchedule",{ID:h.id})]).subscribe(s=>{const f=s[0];o.value=f.Project,d.value=f.Goals,u.value=f.GrantType,d.value.length||E(),P().init("culture",o.value),N.value=o.value.changeApply,o.value.changeApply=void 0})},y=s=>s.Deleted=!0,g=s=>s.Deleted=!0,i=s=>s.Deleted=!0,a=s=>s.Deleted=!0,c=s=>{var F,C;if(r.value={},s&&!t()){e.nextTick(()=>{var A;return(A=document.querySelector(".invalid"))==null?void 0:A.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:o.value,Goals:d.value,Before:(F=N.value)==null?void 0:F.Form2Before,After:(C=N.value)==null?void 0:C.Form2After,Submit:s?"true":"false"};M.culture("saveWorkSchedule",f).subscribe(()=>{s?p("next"):n()})},t=()=>{let s={StartTime:"計畫期程",EndTime:"計畫期程"};r.value=O(o.value,s);const f={Title:"計畫目標",Content:"預期效益"},F={Title:"重要工作項目",Indicator:"績效指標"},C={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},A={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return d.value.filter(U=>!U.Deleted).forEach((U,S)=>{Object.assign(r.value,O(U,f,`goal-${S}-`)),U.Items.filter(b=>!b.Deleted).forEach((b,B)=>{Object.assign(r.value,O(b,F,`item-${S}-${B}-`)),b.Steps.filter(_=>!_.Deleted).forEach((_,I)=>Object.assign(r.value,O(_,C,`step-${S}-${B}-${I}-`))),b.Schedules.filter(_=>_.Type===1&&!_.Deleted).forEach((_,I)=>Object.assign(r.value,O(_,A,`schedule-${S}-${B}-1-${I}-`))),b.Schedules.filter(_=>_.Type===2&&!_.Deleted).forEach((_,I)=>Object.assign(r.value,O(_,A,`schedule-${S}-${B}-2-${I}-`)))})}),N.value&&(s={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(r.value,O(N.value,s))),!Object.keys(r.value).length};return e.onMounted(n),e.provide("editable",m),(s,f)=>{const F=e.resolveComponent("required-label"),C=e.resolveComponent("input-tw-date"),A=e.resolveComponent("tw-date"),U=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),b=e.resolveComponent("input-month"),B=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",cr,[f[30]||(f[30]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Vr,[e.createElementVNode("table",pr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[6]||(f[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",fr,[e.createElementVNode("div",Nr,[e.createVNode(C,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(o).StartTime,"onUpdate:modelValue":f[0]||(f[0]=_=>e.unref(o).StartTime=_)},null,8,["max-date","modelValue"]),f[7]||(f[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(C,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(o).EndTime,"onUpdate:modelValue":f[1]||(f[1]=_=>e.unref(o).EndTime=_)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Er,[f[8]||(f[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(A,{value:e.unref(V)},null,8,["value"]),f[9]||(f[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(r).StartTime||e.unref(r).EndTime?(e.openBlock(),e.createElementBlock("div",ur,e.toDisplayString(e.unref(r).StartTime||e.unref(r).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",br,[f[11]||(f[11]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:E,type:"button"},[...f[10]||(f[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",gr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(_,I)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:_},[e.unref(m)&&e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:j=>y(_),type:"button"},"刪除",8,kr)):e.createCommentVNode("",!0),e.createElementVNode("div",yr,[f[12]||(f[12]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(U,{error:e.unref(r)[`goal-${I}-Title`],modelValue:_.Title,"onUpdate:modelValue":j=>_.Title=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",xr,[f[13]||(f[13]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(S,{error:e.unref(r)[`goal-${I}-Content`],rows:"4",modelValue:_.Content,"onUpdate:modelValue":j=>_.Content=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Br,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(_.Items.filter(j=>!j.Deleted),(j,G)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:j},[e.createElementVNode("div",hr,[e.createElementVNode("div",$r,[e.createElementVNode("label",Cr,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[14]||(f[14]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",Tr,[e.createVNode(U,{error:e.unref(r)[`item-${I}-${G}-Title`],modelValue:j.Title,"onUpdate:modelValue":q=>j.Title=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",_r,[e.unref(m)&&_.Items.filter(q=>!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(q=>g(j),["prevent"]),href:"#"},"刪除",8,wr)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${G}`,role:"button"},"收合",8,Dr)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${G}`},[e.createElementVNode("table",Ar,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[15]||(f[15]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",Fr,[e.createElementVNode("ul",Ur,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Steps.filter(q=>!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(m)}]),key:q},[e.createElementVNode("div",Mr,e.toDisplayString(String.fromCharCode(65+J)),1),e.createElementVNode("div",null,[e.createVNode(U,{error:e.unref(r)[`step-${I}-${G}-${J}-Title`],placeholder:"如:進行口訪紀錄",modelValue:q.Title,"onUpdate:modelValue":R=>q.Title=R,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",Or,[e.createVNode(b,{"empty-value":0,modelValue:q.Begin,"onUpdate:modelValue":R=>q.Begin=R},null,8,["modelValue","onUpdate:modelValue"]),f[16]||(f[16]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(b,{"empty-value":0,modelValue:q.End,"onUpdate:modelValue":R=>q.End=R},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(r)[`step-${I}-${G}-${J}-Begin`]||e.unref(r)[`step-${I}-${G}-${J}-End`]?(e.openBlock(),e.createElementBlock("div",Ir,e.toDisplayString(e.unref(r)[`step-${I}-${G}-${J}-Begin`]||e.unref(r)[`step-${I}-${G}-${J}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",jr,[j.Steps.filter(R=>!R.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:R=>a(q),type:"button"},[...f[17]||(f[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Pr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:R=>D(j),type:"button"},[...f[18]||(f[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,qr)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[19]||(f[19]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(r)[`item-${I}-${G}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:j.Indicator,"onUpdate:modelValue":q=>j.Indicator=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[20]||(f[20]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Rr,[e.createElementVNode("div",Lr,[f[23]||(f[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Schedules.filter(q=>q.Type===1&&!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:q},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?3:4}`])},[e.createVNode(b,{error:e.unref(r)[`schedule-${I}-${G}-1-${J}-Month`],"empty-value":0,modelValue:q.Month,"onUpdate:modelValue":R=>q.Month=R},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(r)[`schedule-${I}-${G}-1-${J}-StepID`],options:j.Steps.filter(R=>!R.Deleted),modelValue:q.StepID,"onUpdate:modelValue":R=>q.StepID=R},{default:e.withCtx(({index:R,option:H})=>[e.createElementVNode("option",{value:H.ID},e.toDisplayString(String.fromCharCode(65+R))+"."+e.toDisplayString(H.Title),9,zr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Gr,[j.Schedules.filter(R=>R.Type===1&&!R.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:R=>i(q),type:"button"},[...f[21]||(f[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Jr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:R=>w(j,1),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Qr)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Wr,[f[26]||(f[26]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Schedules.filter(q=>q.Type===2&&!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:q},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?3:4}`])},[e.createVNode(b,{error:e.unref(r)[`schedule-${I}-${G}-2-${J}-Month`],"empty-value":0,modelValue:q.Month,"onUpdate:modelValue":R=>q.Month=R},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(m)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(r)[`schedule-${I}-${G}-2-${J}-StepID`],options:j.Steps.filter(R=>!R.Deleted),modelValue:q.StepID,"onUpdate:modelValue":R=>q.StepID=R},{default:e.withCtx(({index:R,option:H})=>[e.createElementVNode("option",{value:H.ID},e.toDisplayString(String.fromCharCode(65+R))+"."+e.toDisplayString(H.Title),9,Yr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Hr,[j.Schedules.filter(R=>R.Type===2&&!R.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:R=>i(q),type:"button"},[...f[24]||(f[24]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Zr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:R=>w(j,2),type:"button"},[...f[25]||(f[25]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Kr)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Sr)]))),128))]),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:j=>k(_),type:"button"},"新增工作項目",8,Xr)):e.createCommentVNode("",!0)]))),128))]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[f[29]||(f[29]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",vr,[e.createElementVNode("table",ea,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[27]||(f[27]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(r).Form2Before,rows:"4",modelValue:e.unref(N).Form2Before,"onUpdate:modelValue":f[2]||(f[2]=_=>e.unref(N).Form2Before=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...f[28]||(f[28]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(r).Form2After,rows:"4",modelValue:e.unref(N).Form2After,"onUpdate:modelValue":f[3]||(f[3]=_=>e.unref(N).Form2After=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",ta,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[4]||(f[4]=_=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[5]||(f[5]=_=>c(!0)),type:"button"},[...f[31]||(f[31]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-84d8fceb"]]),oa={class:"block"},na={class:"mt-4"},ra={class:"table align-middle gray-table side-table"},aa={key:0},da={key:1,class:"text-light-gray"},sa={class:"d-flex flex-column gap-2"},ma={key:0},ia={class:"mt-4"},ca={class:"table align-middle gray-table side-table"},Va={class:"row g-3"},pa={class:"col-12 col-xl-2"},fa={class:"text-gray mb-2"},Na={class:"col-12 col-xl-3"},Ea={class:"text-gray mb-2"},ua={key:0,class:"col-12 col-xl-4"},ba={class:"row g-1"},ga={class:"col-7"},ka={class:"col-5"},ya={key:1,class:"col-12 col-xl-3"},xa={class:"text-gray mb-2"},Ba={class:"mt-4"},ha={class:"table align-middle gray-table side-table"},$a={class:"d-flex align-items-center gap-2"},Ca={class:"input-group w-auto"},Ta={key:0,class:"invalid mt-0"},_a={class:"mt-4"},wa={class:"table-responsive mt-3 mb-0"},Da={class:"table align-middle gray-table"},Sa={class:"text-end"},Aa={class:"text-end"},Fa={class:"text-end"},Ua={class:"text-end"},Ma={class:"text-end"},Oa={class:"table align-middle gray-table side-table"},Ia={key:0,class:"table-responsive mt-3 mb-0"},ja={class:"table align-middle gray-table"},Pa={key:0},qa={key:0},Ra={class:"d-flex gap-2"},La=["onClick"],za={class:"mt-4"},Ga={class:"table align-middle gray-table side-table"},Ja={key:0,class:"block-bottom bg-light-teal"},Qa={class:"text-center"},Wa={class:"mb-5"},Ya={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.ref(),r=e.computed(()=>z("education",d.value.Status,1)),l=e.ref({}),o=e.computed(()=>E.value.filter(c=>!c.Deleted)),d=e.ref({}),u=e.ref(),E=e.ref([]),k=e.ref(),w=e.ref(0),D=e.computed({get:()=>!!o.value.length,set:c=>{c?p():E.value.forEach(t=>t.Deleted=!0)}}),p=()=>E.value.push({}),n=T,y=()=>{M.education("getApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,V.value=c.Contacts,E.value=c.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,P().init("education",d.value),m.value=d.value.changeApply,d.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=(c,t)=>{var f,F;if(l.value={},c&&!a()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&k.value&&d.value.ApplyAmount>k.value.GrantLimit*1e4){u.value.show(()=>i(c,!0));return}const s={Project:d.value,Contacts:V.value,ReceivedSubsidies:E.value.filter(C=>C.ID||!C.Deleted),Before:(f=m.value)==null?void 0:f.Form1Before,After:(F=m.value)==null?void 0:F.Form1After,Submit:c?"true":"false"};M.education("saveApplication",s).subscribe(C=>{c?n("next",C.ID):d.value.ID?y():window.location.href=`Application.aspx?ID=${C.ID}`})},a=()=>{let c={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return d.value.OrgCategory==="2"&&(c.RegisteredNum="立案登記證字號"),l.value=O(d.value,c),c={Name:"姓名",JobTitle:"職稱"},Object.assign(l.value,O(V.value[0],c,"contact-0-")),c.MobilePhone="手機號碼",Object.assign(l.value,O(V.value[1],c,"contact-1-")),c={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},E.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`received-${s}-`))),m.value&&(c={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(m.value,c))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([M.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(c=>{N.value=c[0],h.id?y():M.education("getEmptyApplication").subscribe(t=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("education",d.value)})})}),e.provide("editable",r),e.watch(()=>d.value.OrgCategory,()=>{M.education("getGrantTargetSetting",{TargetTypeID:`EDC${d.value.OrgCategory}`}).subscribe(c=>{k.value=c})}),e.watchEffect(()=>{w.value=L(d.value.ApplyAmount)+L(d.value.SelfAmount)+L(d.value.OtherGovAmount)+L(d.value.OtherUnitAmount)}),(c,t)=>{const s=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),F=e.resolveComponent("input-select"),C=e.resolveComponent("input-tw-date"),A=e.resolveComponent("input-textarea"),U=e.resolveComponent("input-integer"),S=e.resolveComponent("input-boolean"),b=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oa,[t[52]||(t[52]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",na,[e.createElementVNode("table",ra,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",aa,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",da,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[22]||(t[22]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(d).ProjectName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",sa,[e.createElementVNode("div",null,[e.createVNode(F,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(d).OrgCategory=B)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",ma,[e.createVNode(f,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=B=>e.unref(d).RegisteredNum=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":t[3]||(t[3]=B=>e.unref(d).OrgName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":t[4]||(t[4]=B=>e.unref(d).TaxID=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":t[5]||(t[5]=B=>e.unref(d).Address=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[53]||(t[53]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ia,[e.createElementVNode("table",ca,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(B,_)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Va,[e.createElementVNode("div",pa,[e.createElementVNode("div",fa,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[28]||(t[28]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(l)[`contact-${_}-Name`],modelValue:B.Name,"onUpdate:modelValue":I=>B.Name=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Na,[e.createElementVNode("div",Ea,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(l)[`contact-${_}-JobTitle`],modelValue:B.JobTitle,"onUpdate:modelValue":I=>B.JobTitle=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),_?(e.openBlock(),e.createElementBlock("div",ua,[t[30]||(t[30]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",ba,[e.createElementVNode("div",ga,[e.createVNode(f,{modelValue:B.Phone,"onUpdate:modelValue":I=>B.Phone=I,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ka,[e.createVNode(f,{placeholder:"請輸入分機",size:"4",modelValue:B.PhoneExt,"onUpdate:modelValue":I=>B.PhoneExt=I,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),_?(e.openBlock(),e.createElementBlock("div",ya,[e.createElementVNode("div",xa,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(l)[`contact-${_}-MobilePhone`],modelValue:B.MobilePhone,"onUpdate:modelValue":I=>B.MobilePhone=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[54]||(t[54]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Ba,[e.createElementVNode("table",ha,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[32]||(t[32]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",$a,[e.createElementVNode("div",Ca,[e.createVNode(C,{class:"w-auto",modelValue:e.unref(d).StartTime,"onUpdate:modelValue":t[6]||(t[6]=B=>e.unref(d).StartTime=B)},null,8,["modelValue"]),t[33]||(t[33]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(C,{class:"w-auto",modelValue:e.unref(d).EndTime,"onUpdate:modelValue":t[7]||(t[7]=B=>e.unref(d).EndTime=B)},null,8,["modelValue"])]),t[34]||(t[34]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",Ta,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Target,modelValue:e.unref(d).Target,"onUpdate:modelValue":t[8]||(t[8]=B=>e.unref(d).Target=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":t[9]||(t[9]=B=>e.unref(d).Summary=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":t[10]||(t[10]=B=>e.unref(d).Quantified=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[55]||(t[55]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",_a,[t[43]||(t[43]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",wa,[e.createElementVNode("table",Da,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Sa,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Aa,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",Fa,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[40]||(t[40]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Ua,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[41]||(t[41]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[42]||(t[42]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).ApplyAmount,modelValue:e.unref(d).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=B=>e.unref(d).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).SelfAmount,modelValue:e.unref(d).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=B=>e.unref(d).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).OtherGovAmount,modelValue:e.unref(d).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=B=>e.unref(d).OtherGovAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).OtherUnitAmount,modelValue:e.unref(d).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=B=>e.unref(d).OtherUnitAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",Ma,e.toDisplayString(e.unref(w).toLocaleString()),1)])])])])]),e.createElementVNode("table",Oa,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[44]||(t[44]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{modelValue:e.unref(D),"onUpdate:modelValue":t[15]||(t[15]=B=>e.isRef(D)?D.value=B:null)},null,8,["modelValue"]),e.unref(D)?(e.openBlock(),e.createElementBlock("div",Ia,[e.createElementVNode("table",ja,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[45]||(t[45]=e.createElementVNode("th",null,"計畫名稱",-1)),t[46]||(t[46]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Pa,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(B,_)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`received-${_}-Name`],modelValue:B.Name,"onUpdate:modelValue":I=>B.Name=I,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${_}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":I=>B.Amount=I},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",qa,[e.createElementVNode("div",Ra,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:I=>g(B),type:"button"},[...t[47]||(t[47]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,La)):e.createCommentVNode("",!0),_+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[48]||(t[48]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[51]||(t[51]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",za,[e.createElementVNode("table",Ga,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[49]||(t[49]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":t[16]||(t[16]=B=>e.unref(m).Form1Before=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[50]||(t[50]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":t[17]||(t[17]=B=>e.unref(m).Form1After=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Ja,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[18]||(t[18]=B=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[19]||(t[19]=B=>i(!0)),type:"button"},[...t[56]||(t[56]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(b,{ref_key:"modal",ref:u},{default:e.withCtx(()=>{var B;return[e.createElementVNode("div",Qa,[t[57]||(t[57]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Wa,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((B=e.unref(k))==null?void 0:B.GrantLimit)+"萬",1),t[58]||(t[58]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[59]||(t[59]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},Ha={class:"block"},Za={key:0,class:"text-pink lh-base mt-4"},Ka={class:"mt-4"},Xa={class:"table align-middle gray-table"},va={class:"text-center"},ed={key:0,width:"180"},td={class:"text-center"},ld={key:0},od=["innerHTML"],nd=["href"],rd={key:0,class:"text-center"},ad={key:0},dd={key:1,class:"text-pink"},sd={key:1,class:"tag-group mt-2 gap-1"},md={key:0,class:"tag tag-green-light"},id=["download","href"],cd=["onClick"],Vd={class:"mt-4"},pd={class:"table align-middle gray-table side-table"},fd={key:0,class:"block-bottom bg-light-teal"},Nd=["disabled"],Ed={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/EDC/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/EDC/2-申請計畫書.docx",Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/EDC/3-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]}]),m=e.ref(),V=e.computed(()=>N.value.some(p=>!p.Optional&&!p.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("education",o.value.Status,2)),l=e.ref({}),o=e.ref({}),d=(p,n)=>{n.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:n.Path,Name:o.value.ProjectID+"_"+(p.Multiple?n.Name:`${p.Title}.pdf`)})},u=M.download,E=T,k=()=>{rxjs.forkJoin([M.education("getAttachment",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=N.value.filter(y=>{var g;return!((g=y.Excludes)!=null&&g.includes(o.value.OrgCategory))}),N.value.forEach(y=>{y.Files=n.Attachments.filter(g=>g.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(g=>!g.Deleted).length)}),P().init("education",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},w=p=>{var y,g;if(l.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:h.id,Attachments:N.value.reduce((i,a)=>i.concat(a.Files),[]),Before:(y=m.value)==null?void 0:y.Form5Before,After:(g=m.value)==null?void 0:g.Form5After,Submit:p?"true":"false"};M.education("saveAttachment",n).subscribe(()=>{p?E("next"):k()})},D=()=>{if(m.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(m.value,p))}return!Object.keys(l.value).length};return e.onMounted(k),e.provide("editable",r),(p,n)=>{const y=e.resolveComponent("required-label"),g=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ha,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",Za,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Ka,[e.createElementVNode("table",Xa,[e.createElementVNode("thead",va,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",ed,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",td,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[a.Optional?(e.openBlock(),e.createElementBlock("span",ld,e.toDisplayString(a.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.Title),1)]),_:2},1024))]),e.unref(r)&&a.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:a.Comment},null,8,od)):e.createCommentVNode("",!0),e.unref(r)&&a.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:a.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,nd)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",rd,[a.Uploaded?(e.openBlock(),e.createElementBlock("span",ad,"已上傳")):(e.openBlock(),e.createElementBlock("span",dd,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(a.Multiple||!a.Uploaded)?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:t=>d(a,t)},null,8,["onFile"])):e.createCommentVNode("",!0),a.Uploaded?(e.openBlock(),e.createElementBlock("div",sd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",md,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(u)(t.Path)},e.toDisplayString(t.Name),9,id),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:s=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,cd)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Vd,[e.createElementVNode("table",pd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(m).Form5Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form5After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",fd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=a=>w(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Nd)])):e.createCommentVNode("",!0)],64)}}},ud={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:T,type:"education"})}}},bd={class:"modal-dialog modal-dialog-centered modal-md"},gd={class:"modal-content"},kd={class:"modal-body"},yd={class:"d-flex flex-column align-items-center mb-5 gap-3"},xd={class:"fs-18"},Bd={__name:"ErrorModal",setup(x){const T=Z(),h=e.ref();return e.onMounted(()=>h.value.addEventListener("hidden.bs.modal",()=>T.error=null)),e.watch(()=>T.error,()=>{T.error&&bootstrap.Modal.getOrCreateInstance(h.value).show()}),(N,m)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:h,tabindex:"-1"},[e.createElementVNode("div",bd,[e.createElementVNode("div",gd,[m[2]||(m[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",kd,[e.createElementVNode("div",yd,[m[0]||(m[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",xd,e.toDisplayString(e.unref(T).error),1)]),m[1]||(m[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},hd={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(x){const T=e.useModel(x,"modelValue"),h=[{value:!0,text:"是"},{value:!1,text:"否"}];return(N,m)=>{const V=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(V,{options:h,modelValue:T.value,"onUpdate:modelValue":m[0]||(m[0]=r=>T.value=r)},null,8,["modelValue"])}}},$d=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(x,{emit:T}){const h=e.ref(),N=()=>{Array.from(h.value.files).forEach(V=>M.upload(V).subscribe(r=>m("file",r))),h.value.value=""},m=T;return(V,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:r[0]||(r[0]=l=>e.unref(h).click()),type:"button"},[...r[1]||(r[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:N,class:"d-none",ref_key:"input",ref:h,type:"file"},V.$attrs),null,16)],64))}}),Cd=["disabled","placeholder","type"],Td={key:0,class:"invalid mt-0"},_d=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue");return e.watch(h,N=>{if(N){const m=(parseInt(N)||0).toString();N.toString()!==m&&(h.value=m)}}),(N,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(T),placeholder:e.unref(T)?x.placeholder:"",style:{"text-align":"right"},type:x.type},N.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=V=>h.value=V)}),null,16,Cd),[[e.vModelDynamic,h.value]]),x.error?(e.openBlock(),e.createElementBlock("div",Td,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64))}}),wd={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(x){const T=e.useModel(x,"modelValue"),h=[];for(let N=1;N<=12;N++)h.push({value:N,text:`${N}月`});return(N,m)=>{const V=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(V,{options:h,modelValue:T.value,"onUpdate:modelValue":m[0]||(m[0]=r=>T.value=r)},null,8,["modelValue"])}}},Dd=["onChange","checked","disabled","id","value"],Sd=["for"],Ad={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>le(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue"),N=m=>{h.value=m};return(m,V)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.options,r=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:r},[e.createElementVNode("input",{onChange:l=>N(r[x.valueName]),checked:r[x.valueName]===h.value,class:"form-check-input",disabled:!e.unref(T),id:`${x.id}-${r[x.valueName]}`,type:"radio",value:r[x.valueName]},null,40,Dd),e.createElementVNode("label",{class:"form-check-label",for:`${x.id}-${r[x.valueName]}`},e.toDisplayString(r[x.textName]),9,Sd)]))),128))}},Fd=["disabled"],Ud=["value"],Md=["value"],Od={key:0,class:"invalid mt-0"},Id=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue");return(N,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:x.disabled||!e.unref(T)},N.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=V=>h.value=V)}),[e.unref(T)&&!h.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:x.emptyValue},e.toDisplayString(x.placeholder),9,Ud)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.options,(V,r)=>e.renderSlot(N.$slots,"default",{key:V,index:r,option:V},()=>[e.createElementVNode("option",{value:V[x.valueName]},e.toDisplayString(V[x.textName]),9,Md)])),128))],16,Fd),[[e.vModelSelect,h.value]]),x.error?(e.openBlock(),e.createElementBlock("div",Od,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64))}}),jd={class:"input-group"},Pd={key:0,class:"input-group-text"},qd=["disabled","placeholder","type"],Rd={key:0,class:"invalid mt-0"},Ld=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue"),N=x;return N.maxLength&&e.watch(h,()=>{var m;((m=h.value)==null?void 0:m.length)>N.maxLength&&(h.value=h.value.substring(0,N.maxLength))}),(m,V)=>{const r=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",jd,[x.prefix?(e.openBlock(),e.createElementBlock("span",Pd,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(x.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(T),placeholder:e.unref(T)?x.placeholder:"",type:x.type},m.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=l=>h.value=l)}),null,16,qd),[[e.vModelDynamic,h.value]])]),x.error?(e.openBlock(),e.createElementBlock("div",Rd,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64)}}}),zd=["disabled","placeholder"],Gd={key:0,class:"fs-14 text-gray mt-2"},Jd={class:"text-pink"},Qd={key:1,class:"invalid mt-0"},Wd=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue"),N=x;return N.maxLength&&e.watch(h,()=>{var m;((m=h.value)==null?void 0:m.length)>N.maxLength&&(h.value=h.value.substring(0,N.maxLength))}),(m,V)=>{var r;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(T),placeholder:e.unref(T)?x.placeholder:""},m.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=l=>h.value=l)}),null,16,zd),[[e.vModelText,h.value]]),e.unref(T)&&x.maxLength?(e.openBlock(),e.createElementBlock("div",Gd,[V[1]||(V[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Jd,e.toDisplayString(((r=h.value)==null?void 0:r.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(x.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),x.error?(e.openBlock(),e.createElementBlock("div",Qd,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64)}}}),Yd=["disabled"],Hd={key:0,class:"invalid"},Zd=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(x,{emit:T}){let h;const N=x,m=e.ref(),V=e.inject("editable",!0),r=e.ref(),l=T,o=d=>{!d&&N.modelValue&&(d=moment(new Date(N.modelValue))),d?(m.value=d.format(N.displayFormat),l("update:modelValue",d.format(N.format))):(m.value="",l("update:modelValue","")),h.setStartDate(m.value||void 0)};return e.onMounted(()=>{const d=$(r.value);d.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:N.drops,locale:{format:N.displayFormat},maxDate:N.maxDate?new Date(N.maxDate):N.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(u,E)=>o(E.startDate)),h=d.data("daterangepicker"),o()}),e.onUnmounted(()=>h.remove()),e.watch(()=>N.modelValue,()=>o()),(d,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(V),ref_key:"element",ref:r,type:"text"},d.$attrs,{"onUpdate:modelValue":u[0]||(u[0]=E=>e.isRef(m)?m.value=E:null)}),null,16,Yd),[[e.vModelText,e.unref(m)]]),x.error?(e.openBlock(),e.createElementBlock("div",Hd,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64))}}),Kd={class:"block"},Xd={class:"mt-4"},vd={class:"table align-middle gray-table side-table"},es={key:0},ts={key:1,class:"text-light-gray"},ls={class:"mt-4"},os={class:"table align-middle gray-table side-table"},ns={class:"row g-3"},rs={class:"col-12 col-xl-2"},as={class:"text-gray mb-2"},ds={class:"col-12 col-xl-3"},ss={class:"text-gray mb-2"},ms={class:"col-12 col-xl-4"},is={class:"row g-1"},cs={class:"col-7"},Vs={class:"col-5"},ps={class:"col-12 col-xl-3"},fs={class:"text-gray mb-2"},Ns={class:"col-12"},Es={class:"text-gray mb-2"},us={class:"mt-4"},bs={class:"table align-middle gray-table side-table"},gs={class:"mt-4"},ks={class:"table align-middle gray-table side-table"},ys={key:0,class:"table-responsive mt-3 mb-0"},xs={class:"table align-middle gray-table"},Bs={key:0},hs={key:0},$s={class:"d-flex gap-2"},Cs=["onClick"],Ts={class:"mt-4"},_s={class:"table align-middle gray-table side-table"},ws={key:0,class:"block-bottom bg-light-teal"},Ds={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.ref(),V=e.computed(()=>z("literacy",d.value.Status,1)),r=e.ref({}),l=e.ref([]),o=e.computed(()=>u.value.filter(g=>!g.Deleted)),d=e.ref({}),u=e.ref([]),E=e.computed({get:()=>!!o.value.length,set:g=>{g?k():u.value.forEach(i=>i.Deleted=!0)}}),k=()=>u.value.push({}),w=T,D=()=>{M.literacy("getApplication",{ID:h.id}).subscribe(g=>{d.value=g.Project,N.value=g.Contacts,u.value=g.PreviousStudies,P().init("literacy",d.value),m.value=d.value.changeApply,d.value.changeApply=void 0})},p=g=>g.Deleted=!0,n=g=>{var a,c;if(r.value={},g&&!y()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:d.value,Contacts:N.value,PreviousStudies:u.value.filter(t=>t.ID||!t.Deleted),Before:(a=m.value)==null?void 0:a.Form1Before,After:(c=m.value)==null?void 0:c.Form1After,Submit:g?"true":"false"};M.literacy("saveApplication",i).subscribe(t=>{g?w("next",t.ID):d.value.ID?D():window.location.href=`Application.aspx?ID=${t.ID}`})},y=()=>{let g={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return r.value=O(d.value,g),g={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((i,a)=>Object.assign(r.value,O(i,g,`contact-${a}-`))),g={Title:"研習/課程名稱",TheDate:"辦理日期"},u.value.forEach((i,a)=>Object.assign(r.value,O(i,g,`study-${a}-`))),m.value&&(g={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(r.value,O(m.value,g))),!Object.keys(r.value).length};return e.onMounted(()=>{rxjs.forkJoin([M.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(g=>{l.value=g[0],h.id?D():M.literacy("getEmptyApplication").subscribe(i=>{d.value=Object.assign({Field:null,FormStep:1,Status:1},i),N.value=[{Role:"申請人"}],P().init("literacy",d.value)})})}),e.provide("editable",V),e.watch(()=>[d.value.Field,d.value.OrgName],()=>{var g;if(V.value){const i=[];d.value.Field&&i.push((g=l.value.find(a=>a.Code===d.value.Field))==null?void 0:g.Descname),d.value.OrgName&&i.push(d.value.OrgName),d.value.ProjectName=i.join("-")}}),(g,i)=>{const a=e.resolveComponent("required-label"),c=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),s=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),F=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kd,[i[40]||(i[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Xd,[e.createElementVNode("table",vd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[14]||(i[14]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[i[15]||(i[15]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",es,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",ts,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[i[16]||(i[16]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[17]||(i[17]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{disabled:"",modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":i[0]||(i[0]=C=>e.unref(d).ProjectName=C),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[18]||(i[18]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(r).Field,options:e.unref(l),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).Field,"onUpdate:modelValue":i[1]||(i[1]=C=>e.unref(d).Field=C)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[19]||(i[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(r).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":i[2]||(i[2]=C=>e.unref(d).OrgName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[20]||(i[20]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(r).OrgLeader,modelValue:e.unref(d).OrgLeader,"onUpdate:modelValue":i[3]||(i[3]=C=>e.unref(d).OrgLeader=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[21]||(i[21]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(r).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":i[4]||(i[4]=C=>e.unref(d).Address=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),i[41]||(i[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ls,[e.createElementVNode("table",os,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(C,A)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",ns,[e.createElementVNode("div",rs,[e.createElementVNode("div",as,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[22]||(i[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(r)[`contact-${A}-Name`],modelValue:C.Name,"onUpdate:modelValue":U=>C.Name=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ds,[e.createElementVNode("div",ss,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[23]||(i[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(r)[`contact-${A}-JobTitle`],modelValue:C.JobTitle,"onUpdate:modelValue":U=>C.JobTitle=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ms,[i[24]||(i[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",is,[e.createElementVNode("div",cs,[e.createVNode(c,{modelValue:C.Phone,"onUpdate:modelValue":U=>C.Phone=U,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Vs,[e.createVNode(c,{placeholder:"請輸入分機",size:"4",modelValue:C.PhoneExt,"onUpdate:modelValue":U=>C.PhoneExt=U,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",ps,[e.createElementVNode("div",fs,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[25]||(i[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(r)[`contact-${A}-MobilePhone`],modelValue:C.MobilePhone,"onUpdate:modelValue":U=>C.MobilePhone=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ns,[e.createElementVNode("div",Es,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[26]||(i[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(r)[`contact-${A}-EMail`],modelValue:C.EMail,"onUpdate:modelValue":U=>C.EMail=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),i[42]||(i[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",us,[e.createElementVNode("table",bs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[27]||(i[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[i[28]||(i[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(s,{error:e.unref(r).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":i[5]||(i[5]=C=>e.unref(d).Target=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[29]||(i[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(r).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":i[6]||(i[6]=C=>e.unref(d).Summary=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[30]||(i[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(r).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":i[7]||(i[7]=C=>e.unref(d).Quantified=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[31]||(i[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(r).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":i[8]||(i[8]=C=>e.unref(d).Qualitative=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",gs,[e.createElementVNode("table",ks,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[36]||(i[36]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(E),"onUpdate:modelValue":i[9]||(i[9]=C=>e.isRef(E)?E.value=C:null)},null,8,["modelValue"]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",ys,[e.createElementVNode("table",xs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[32]||(i[32]=e.createElementVNode("th",null,"研習/課程名稱",-1)),i[33]||(i[33]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Bs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(C,A)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(r)[`study-${A}-Title`],modelValue:C.Title,"onUpdate:modelValue":U=>C.Title=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(r)[`study-${A}-TheDate`],modelValue:C.TheDate,"onUpdate:modelValue":U=>C.TheDate=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",hs,[e.createElementVNode("div",$s,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>p(C),type:"button"},[...i[34]||(i[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Cs)):e.createCommentVNode("",!0),A+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...i[35]||(i[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[i[39]||(i[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("table",_s,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[37]||(i[37]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(r).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":i[10]||(i[10]=C=>e.unref(m).Form1Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(a,null,{default:e.withCtx(()=>[...i[38]||(i[38]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(r).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":i[11]||(i[11]=C=>e.unref(m).Form1After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ws,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[12]||(i[12]=C=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[13]||(i[13]=C=>n(!0)),type:"button"},[...i[43]||(i[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ss={class:"block"},As={key:0,class:"text-pink lh-base mt-4"},Fs={class:"mt-4"},Us={class:"table align-middle gray-table"},Ms={class:"text-center"},Os={key:0,width:"180"},Is={class:"text-center"},js={key:0},Ps=["innerHTML"],qs=["href"],Rs={key:0,class:"text-center"},Ls={key:0},zs={key:1,class:"text-pink"},Gs={key:1,class:"tag-group mt-2 gap-1"},Js={key:0,class:"tag tag-green-light"},Qs=["download","href"],Ws=["onClick"],Ys={class:"mt-4"},Hs={class:"table align-middle gray-table side-table"},Zs={key:0,class:"block-bottom bg-light-teal"},Ks=["disabled"],Xs={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/LIT/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/LIT/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/LIT/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/LIT/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),m=e.ref(),V=e.computed(()=>N.value.some(p=>!p.Optional&&!p.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("literacy",o.value.Status,2)),l=e.ref({}),o=e.ref({}),d=(p,n)=>{n.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:n.Path,Name:o.value.ProjectID+"_"+(p.Multiple?n.Name:`${p.Title}.pdf`)})},u=M.download,E=T,k=()=>{rxjs.forkJoin([M.literacy("getAttachment",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=N.value.filter(y=>{var g;return!((g=y.Excludes)!=null&&g.includes(o.value.OrgCategory))}),N.value.forEach(y=>{y.Files=n.Attachments.filter(g=>g.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(g=>!g.Deleted).length)}),P().init("literacy",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},w=p=>{var y,g;if(l.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:h.id,Attachments:N.value.reduce((i,a)=>i.concat(a.Files),[]),Before:(y=m.value)==null?void 0:y.Form5Before,After:(g=m.value)==null?void 0:g.Form5After,Submit:p?"true":"false"};M.literacy("saveAttachment",n).subscribe(()=>{p?E("next"):k()})},D=()=>{if(m.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(m.value,p))}return!Object.keys(l.value).length};return e.onMounted(k),e.provide("editable",r),(p,n)=>{const y=e.resolveComponent("required-label"),g=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ss,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",As,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Fs,[e.createElementVNode("table",Us,[e.createElementVNode("thead",Ms,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Os,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",Is,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[a.Optional?(e.openBlock(),e.createElementBlock("span",js,e.toDisplayString(a.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.Title),1)]),_:2},1024))]),e.unref(r)&&a.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:a.Comment},null,8,Ps)):e.createCommentVNode("",!0),e.unref(r)&&a.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:a.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,qs)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Rs,[a.Uploaded?(e.openBlock(),e.createElementBlock("span",Ls,"已上傳")):(e.openBlock(),e.createElementBlock("span",zs,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(a.Multiple||!a.Uploaded)?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:t=>d(a,t)},null,8,["onFile"])):e.createCommentVNode("",!0),a.Uploaded?(e.openBlock(),e.createElementBlock("div",Gs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Js,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(u)(t.Path)},e.toDisplayString(t.Name),9,Qs),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:s=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ws)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ys,[e.createElementVNode("table",Hs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(m).Form5Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form5After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Zs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=a=>w(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Ks)])):e.createCommentVNode("",!0)],64)}}},vs={class:"block"},em={class:"mt-4"},tm={class:"table-responsive mt-3 mb-0"},lm={class:"table align-middle gray-table"},om={key:0,width:"1"},nm={key:0},rm={class:"d-flex gap-2"},am=["onClick"],dm={class:"table-responsive mt-3 mb-0"},sm={class:"table align-middle gray-table"},mm={class:"mt-4"},im={class:"table align-middle gray-table side-table"},cm={key:0,class:"block-bottom bg-light-teal"},Vm={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.computed(()=>z("literacy",o.value.Status,4)),r=e.ref({}),l=e.computed(()=>N.value.filter(p=>!p.Deleted)),o=e.ref({}),d=()=>N.value.push({}),u=T,E=()=>{rxjs.forkJoin([M.literacy("getBenefit",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=n.Benefits,N.value.length||d(),P().init("literacy",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},k=p=>p.Deleted=!0,w=p=>{var y,g;if(r.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:o.value,Benefits:N.value,Before:(y=m.value)==null?void 0:y.Form4Before,After:(g=m.value)==null?void 0:g.Form4After,Submit:p?"true":"false"};M.literacy("saveBenefit",n).subscribe(()=>{p?u("next"):E()})},D=()=>{let p={Benefit:"不可量化成果"};return r.value=O(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((n,y)=>Object.assign(r.value,O(n,p,`item-${y}-`))),m.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(r.value,O(m.value,p))),!Object.keys(r.value).length};return e.onMounted(E),e.provide("editable",V),(p,n)=>{const y=e.resolveComponent("input-text"),g=e.resolveComponent("input-textarea"),i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",vs,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",em,[e.createElementVNode("div",tm,[e.createElementVNode("table",lm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",om,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(r)[`item-${c}-Title`],modelValue:a.Title,"onUpdate:modelValue":t=>a.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(r)[`item-${c}-Target`],modelValue:a.Target,"onUpdate:modelValue":t=>a.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r)[`item-${c}-Description`],rows:"1",modelValue:a.Description,"onUpdate:modelValue":t=>a.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",nm,[e.createElementVNode("div",rm,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>k(a),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,am)):e.createCommentVNode("",!0),c+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",dm,[e.createElementVNode("table",sm,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(o).Benefit=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",mm,[e.createElementVNode("table",im,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form4Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":n[2]||(n[2]=a=>e.unref(m).Form4After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",cm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=a=>w(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},pm={class:"block"},fm={class:"mt-4"},Nm={class:"table-responsive mt-3 mb-0"},Em={class:"table align-middle gray-table"},um={class:"text-end"},bm={class:"text-end"},gm={class:"table-responsive"},km={class:"table align-middle gray-table"},ym=["colspan"],xm={key:0,width:"1"},Bm={class:"text-end"},hm={key:0},$m={class:"d-flex gap-2"},Cm=["onClick"],Tm={class:"mt-4"},_m={class:"table-responsive mt-3 mb-0"},wm={class:"table align-middle gray-table"},Dm={key:0,width:"1"},Sm={class:"text-end"},Am={key:0},Fm={class:"d-flex gap-2"},Um=["onClick"],Mm={class:"mt-4"},Om={class:"table align-middle gray-table side-table"},Im={key:0,class:"block-bottom bg-light-teal"},jm={class:"text-center"},Pm={class:"mb-5"},qm={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.computed(()=>z("literacy",o.value.Status,3)),V=e.ref({}),r=e.computed(()=>u.value.filter(c=>!c.Deleted)),l=e.computed(()=>E.value.filter(c=>!c.Deleted)),o=e.ref({}),d=e.ref(),u=e.ref([]),E=e.ref([]),k=e.ref({}),w=e.ref(0),D=()=>u.value.push({}),p=()=>E.value.push({}),n=T,y=()=>{rxjs.forkJoin([M.literacy("getFunding",{ID:h.id})]).subscribe(c=>{const t=c[0];o.value=t.Project,u.value=t.OtherSubsidies,E.value=t.BudgetPlans,k.value=t.GrantTargetSetting,u.value.length||D(),E.value.length||p(),P().init("literacy",o.value),N.value=o.value.changeApply,o.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=(c,t)=>{var f,F;if(V.value={},c&&!a()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>k.value.GrantLimit*1e4){d.value.show(()=>i(c,!0));return}const s={Project:o.value,OtherSubsidies:u.value,BudgetPlans:E.value,Before:(f=N.value)==null?void 0:f.Form3Before,After:(F=N.value)==null?void 0:F.Form3After,Submit:c?"true":"false"};M.literacy("saveFunding",s).subscribe(()=>{c?n("next"):y()})},a=()=>{let c={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=O(o.value,c),c={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},u.value.forEach((t,s)=>Object.assign(V.value,O(t,c,`other-${s}-`))),c={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},E.value.forEach((t,s)=>Object.assign(V.value,O(t,c,`plan-${s}-`))),N.value&&(c={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,O(N.value,c))),!Object.keys(V.value).length};return e.onMounted(y),e.provide("editable",m),e.watchEffect(()=>{o.value.OtherAmount=r.value.reduce((c,t)=>c+L(t.Amount),0),w.value=L(o.value.ApplyAmount)+L(o.value.SelfAmount)+L(o.value.OtherAmount),r.value.forEach(c=>c.percent=Math.round(L(c.Amount)/o.value.OtherAmount*1e4)/100),E.value.forEach(c=>c.sum=L(c.Amount)+L(c.OtherAmount))}),(c,t)=>{var U;const s=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),C=e.resolveComponent("required-label"),A=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",pm,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",fm,[e.createElementVNode("div",Nm,[e.createElementVNode("table",Em,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=S=>e.unref(o).ApplyAmount=S)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=S=>e.unref(o).SelfAmount=S)},null,8,["error","modelValue"])]),e.createElementVNode("td",um,e.toDisplayString((U=e.unref(o).OtherAmount)==null?void 0:U.toLocaleString()),1),e.createElementVNode("td",bm,e.toDisplayString(e.unref(w).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",gm,[e.createElementVNode("table",km,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,ym)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",xm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(S,b)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,e.toDisplayString(b+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`other-${b}-Unit`],modelValue:S.Unit,"onUpdate:modelValue":B=>S.Unit=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`other-${b}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":B=>S.Amount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Bm,e.toDisplayString(S.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`other-${b}-Content`],rows:"1",modelValue:S.Content,"onUpdate:modelValue":B=>S.Content=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",hm,[e.createElementVNode("div",$m,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:B=>g(S),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Cm)):e.createCommentVNode("",!0),b+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:D,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Tm,[e.createElementVNode("div",_m,[e.createElementVNode("table",wm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Dm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(S,b)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`plan-${b}-Title`],modelValue:S.Title,"onUpdate:modelValue":B=>S.Title=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`plan-${b}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":B=>S.Amount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`plan-${b}-OtherAmount`],modelValue:S.OtherAmount,"onUpdate:modelValue":B=>S.OtherAmount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Sm,e.toDisplayString(S.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`plan-${b}-Description`],rows:"1",modelValue:S.Description,"onUpdate:modelValue":B=>S.Description=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Am,[e.createElementVNode("div",Fm,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:B=>g(S),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Um)):e.createCommentVNode("",!0),b+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Mm,[e.createElementVNode("table",Om,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=S=>e.unref(N).Form3Before=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":t[3]||(t[3]=S=>e.unref(N).Form3After=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Im,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=S=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=S=>i(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(A,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",jm,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Pm,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(k).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Rm={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:T,type:"literacy"})}}},Lm={class:"block"},zm={class:"mt-4"},Gm={class:"table align-middle gray-table side-table"},Jm={key:0,class:"d-flex align-items-center gap-2"},Qm={class:"input-group w-auto"},Wm={class:"text-teal-dark"},Ym={key:1,class:"invalid mt-0"},Hm={class:"table-responsive mt-4"},Zm={class:"table align-middle gray-table"},Km={key:0},Xm={class:"input-group"},vm={key:0,class:"invalid mt-0"},ei={key:0},ti={class:"d-flex gap-2"},li=["onClick"],oi={class:"mt-4"},ni={class:"table align-middle gray-table"},ri={key:0},ai={key:0},di={class:"d-flex gap-2"},si=["onClick"],mi={class:"mt-4"},ii={class:"table align-middle gray-table side-table"},ci={key:0,class:"block-bottom bg-light-teal"},Vi={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=[{value:1,text:"50%"},{value:2,text:"100%"}],m=e.ref(),V=e.computed(()=>E.value.EndDate),r=e.computed(()=>z("literacy",u.value.Status,2)),l=e.ref({}),o=e.computed(()=>k.value.filter(c=>!c.Deleted)),d=e.computed(()=>w.value.filter(c=>!c.Deleted)),u=e.ref({}),E=e.ref({}),k=e.ref([]),w=e.ref([]),D=()=>M.literacy("createItem",{ID:h.id}).subscribe(c=>k.value.push(c)),p=()=>w.value.push({Type:0,ItemID:0}),n=T,y=()=>{rxjs.forkJoin([M.literacy("getWorkSchedule",{ID:h.id})]).subscribe(c=>{const t=c[0];u.value=t.Project,E.value=t.GrantType,k.value=t.Items,w.value=t.Schedules,k.value.length||D(),w.value.length||p(),P().init("literacy",u.value),m.value=u.value.changeApply,u.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=c=>{var s,f;if(l.value={},c&&!a()){e.nextTick(()=>{var F;return(F=document.querySelector(".invalid"))==null?void 0:F.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:u.value,Items:k.value,Schedules:w.value,Before:(s=m.value)==null?void 0:s.Form2Before,After:(f=m.value)==null?void 0:f.Form2After,Submit:c?"true":"false"};M.literacy("saveWorkSchedule",t).subscribe(()=>{c?n("next"):y()})},a=()=>{let c={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(u.value,c),c={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`item-${s}-`))),c={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`schedule-${s}-`))),m.value&&(c={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(m.value,c))),!Object.keys(l.value).length};return e.onMounted(y),e.provide("editable",r),(c,t)=>{const s=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),F=e.resolveComponent("tw-date"),C=e.resolveComponent("input-text"),A=e.resolveComponent("input-month"),U=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Lm,[t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",zm,[e.createElementVNode("table",Gm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",Jm,[e.createElementVNode("div",Qm,[e.createVNode(f,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(u).StartTime,"onUpdate:modelValue":t[0]||(t[0]=b=>e.unref(u).StartTime=b)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(u).EndTime,"onUpdate:modelValue":t[1]||(t[1]=b=>e.unref(u).EndTime=b)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Wm,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(F,{value:e.unref(V)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",Ym,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Hm,[e.createElementVNode("table",Zm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Km,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(l)[`item-${B}-Title`],modelValue:b.Title,"onUpdate:modelValue":_=>b.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Xm,[e.createVNode(A,{"empty-value":0,modelValue:b.Begin,"onUpdate:modelValue":_=>b.Begin=_},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(A,{"empty-value":0,modelValue:b.End,"onUpdate:modelValue":_=>b.End=_},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${B}-Begin`]||e.unref(l)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",vm,e.toDisplayString(e.unref(l)[`item-${B}-Begin`]||e.unref(l)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`item-${B}-Deadline`],modelValue:b.Deadline,"onUpdate:modelValue":_=>b.Deadline=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`item-${B}-Content`],rows:"1",modelValue:b.Content,"onUpdate:modelValue":_=>b.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",ei,[e.createElementVNode("div",ti,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>g(b),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,li)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:D,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[29]||(t[29]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",oi,[e.createElementVNode("table",ni,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[21]||(t[21]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",ri,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(l)[`schedule-${B}-Type`],options:N,modelValue:b.Type,"onUpdate:modelValue":_=>b.Type=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(l)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:b.ItemID,"onUpdate:modelValue":_=>b.ItemID=_,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(b.ItemID?String.fromCharCode(65+e.unref(o).findIndex(_=>_.ID===b.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`schedule-${B}-Deadline`],modelValue:b.Deadline,"onUpdate:modelValue":_=>b.Deadline=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`schedule-${B}-Content`],rows:"1",modelValue:b.Content,"onUpdate:modelValue":_=>b.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",ai,[e.createElementVNode("div",di,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>g(b),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,si)):e.createCommentVNode("",!0),B+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[23]||(t[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",mi,[e.createElementVNode("table",ii,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=b=>e.unref(m).Form2Before=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":t[3]||(t[3]=b=>e.unref(m).Form2After=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",ci,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=b=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=b=>i(!0)),type:"button"},[...t[30]||(t[30]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},pi={class:"block"},fi={class:"mt-4"},Ni={class:"table align-middle gray-table side-table"},Ei={key:0},ui={key:1,class:"text-light-gray"},bi={class:"mt-4"},gi={class:"table align-middle gray-table side-table"},ki={class:"row g-3"},yi={class:"col-12 col-xl-2"},xi={class:"text-gray mb-2"},Bi={class:"col-12 col-xl-3"},hi={class:"text-gray mb-2"},$i={class:"col-12 col-xl-4"},Ci={class:"row g-1"},Ti={class:"col-7"},_i={class:"col-5"},wi={class:"col-12 col-xl-3"},Di={class:"text-gray mb-2"},Si={class:"col-12"},Ai={class:"text-gray mb-2"},Fi={class:"mt-4"},Ui={class:"table align-middle gray-table side-table"},Mi={class:"mt-4"},Oi={class:"table align-middle gray-table side-table"},Ii={key:0,class:"table-responsive mt-3 mb-0"},ji={class:"table align-middle gray-table"},Pi={key:0},qi={key:0},Ri={class:"d-flex gap-2"},Li=["onClick"],zi={class:"mt-4"},Gi={class:"table align-middle gray-table side-table"},Ji={key:0,class:"block-bottom bg-light-teal"},Qi={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.ref(),r=e.computed(()=>z("multiple",u.value.Status,1)),l=e.ref({}),o=e.ref([]),d=e.computed(()=>E.value.filter(i=>!i.Deleted)),u=e.ref({}),E=e.ref([]),k=e.computed({get:()=>!!d.value.length,set:i=>{i?w():E.value.forEach(a=>a.Deleted=!0)}}),w=()=>E.value.push({}),D=T,p=()=>{M.multiple("getApplication",{ID:h.id}).subscribe(i=>{u.value=i.Project,V.value=i.Contacts,E.value=i.ReceivedSubsidies,u.value.OrgCategory=u.value.OrgCategory||null,P().init("multiple",u.value),m.value=u.value.changeApply,u.value.changeApply=void 0})},n=i=>i.Deleted=!0,y=i=>{var c,t;if(l.value={},i&&!g()){e.nextTick(()=>{var s;return(s=document.querySelector(".invalid"))==null?void 0:s.scrollIntoView({behavior:"smooth",block:"center"})});return}const a={Project:u.value,Contacts:V.value,ReceivedSubsidies:E.value.filter(s=>s.ID||!s.Deleted),Before:(c=m.value)==null?void 0:c.Form1Before,After:(t=m.value)==null?void 0:t.Form1After,Submit:i?"true":"false"};M.multiple("saveApplication",a).subscribe(s=>{i?D("next",s.ID):u.value.ID?p():window.location.href=`Application.aspx?ID=${s.ID}`})},g=()=>{let i={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return l.value=O(u.value,i),i={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((a,c)=>Object.assign(l.value,O(a,i,`contact-${c}-`))),i={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},E.value.forEach((a,c)=>Object.assign(l.value,O(a,i,`received-${c}-`))),m.value&&(i={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(m.value,i))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([M.multiple("getZgsCodes",{CodeGroup:"MULField"}),M.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(i=>{o.value=i[0],N.value=i[1],h.id?p():M.multiple("getEmptyApplication").subscribe(a=>{u.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},a),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("multiple",u.value)})})}),e.provide("editable",r),(i,a)=>{const c=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),s=e.resolveComponent("input-select"),f=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-boolean"),C=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",pi,[a[43]||(a[43]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",fi,[e.createElementVNode("table",Ni,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[a[15]||(a[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(u).Year),1)]),e.createElementVNode("tr",null,[a[16]||(a[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(u).ProjectID?(e.openBlock(),e.createElementBlock("span",Ei,e.toDisplayString(e.unref(u).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",ui,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[a[17]||(a[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(u).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[18]||(a[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).ProjectName,modelValue:e.unref(u).ProjectName,"onUpdate:modelValue":a[0]||(a[0]=A=>e.unref(u).ProjectName=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[19]||(a[19]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{"empty-value":null,error:e.unref(l).Field,options:e.unref(o),"text-name":"Descname","value-name":"Code",modelValue:e.unref(u).Field,"onUpdate:modelValue":a[1]||(a[1]=A=>e.unref(u).Field=A)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[20]||(a[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(u).OrgName,"onUpdate:modelValue":a[2]||(a[2]=A=>e.unref(u).OrgName=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[21]||(a[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(s,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(u).OrgCategory,"onUpdate:modelValue":a[3]||(a[3]=A=>e.unref(u).OrgCategory=A)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[22]||(a[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(u).TaxID,"onUpdate:modelValue":a[4]||(a[4]=A=>e.unref(u).TaxID=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[23]||(a[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(u).Address,"onUpdate:modelValue":a[5]||(a[5]=A=>e.unref(u).Address=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),a[44]||(a[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",bi,[e.createElementVNode("table",gi,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(A,U)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(A.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",ki,[e.createElementVNode("div",yi,[e.createElementVNode("div",xi,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[24]||(a[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${U}-Name`],modelValue:A.Name,"onUpdate:modelValue":S=>A.Name=S,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Bi,[e.createElementVNode("div",hi,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[25]||(a[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${U}-JobTitle`],modelValue:A.JobTitle,"onUpdate:modelValue":S=>A.JobTitle=S,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",$i,[a[26]||(a[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ci,[e.createElementVNode("div",Ti,[e.createVNode(t,{modelValue:A.Phone,"onUpdate:modelValue":S=>A.Phone=S,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",_i,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:A.PhoneExt,"onUpdate:modelValue":S=>A.PhoneExt=S,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",wi,[e.createElementVNode("div",Di,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[27]||(a[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${U}-MobilePhone`],modelValue:A.MobilePhone,"onUpdate:modelValue":S=>A.MobilePhone=S,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Si,[e.createElementVNode("div",Ai,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[28]||(a[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${U}-EMail`],modelValue:A.EMail,"onUpdate:modelValue":S=>A.EMail=S,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),a[45]||(a[45]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Fi,[e.createElementVNode("table",Ui,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[29]||(a[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[a[30]||(a[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(f,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(u).Target,"onUpdate:modelValue":a[6]||(a[6]=A=>e.unref(u).Target=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[31]||(a[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(u).Summary,"onUpdate:modelValue":a[7]||(a[7]=A=>e.unref(u).Summary=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[32]||(a[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(u).Quantified,"onUpdate:modelValue":a[8]||(a[8]=A=>e.unref(u).Quantified=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[33]||(a[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(u).Qualitative,"onUpdate:modelValue":a[9]||(a[9]=A=>e.unref(u).Qualitative=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Mi,[e.createElementVNode("table",Oi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[a[39]||(a[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(F,{modelValue:e.unref(k),"onUpdate:modelValue":a[10]||(a[10]=A=>e.isRef(k)?k.value=A:null)},null,8,["modelValue"]),e.unref(k)?(e.openBlock(),e.createElementBlock("div",Ii,[e.createElementVNode("table",ji,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[a[34]||(a[34]=e.createElementVNode("th",null,"計畫名稱",-1)),a[35]||(a[35]=e.createElementVNode("th",null,"補助單位",-1)),a[36]||(a[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Pi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(A,U)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l)[`received-${U}-Name`],modelValue:A.Name,"onUpdate:modelValue":S=>A.Name=S,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l)[`received-${U}-Unit`],modelValue:A.Unit,"onUpdate:modelValue":S=>A.Unit=S,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(l)[`received-${U}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":S=>A.Amount=S},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",qi,[e.createElementVNode("div",Ri,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:S=>n(A),type:"button"},[...a[37]||(a[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Li)):e.createCommentVNode("",!0),U+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:w,type:"button"},[...a[38]||(a[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[a[42]||(a[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",zi,[e.createElementVNode("table",Gi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[40]||(a[40]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(m).Form1Before,"onUpdate:modelValue":a[11]||(a[11]=A=>e.unref(m).Form1Before=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...a[41]||(a[41]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(m).Form1After,"onUpdate:modelValue":a[12]||(a[12]=A=>e.unref(m).Form1After=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Ji,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[13]||(a[13]=A=>y()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[14]||(a[14]=A=>y(!0)),type:"button"},[...a[46]||(a[46]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Wi={class:"block"},Yi={key:0,class:"text-pink lh-base mt-4"},Hi={class:"mt-4"},Zi={class:"table align-middle gray-table"},Ki={class:"text-center"},Xi={key:0,width:"180"},vi={class:"text-center"},ec={key:0},tc=["innerHTML"],lc=["href"],oc={key:0,class:"text-center"},nc={key:0},rc={key:1,class:"text-pink"},ac={key:1,class:"tag-group mt-2 gap-1"},dc={key:0,class:"tag tag-green-light"},sc=["download","href"],mc=["onClick"],ic={class:"mt-4"},cc={class:"table align-middle gray-table side-table"},Vc={key:0,class:"block-bottom bg-light-teal"},pc=["disabled"],fc={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/MUL/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/MUL/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/MUL/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/MUL/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),m=e.ref(),V=e.computed(()=>N.value.some(p=>!p.Optional&&!p.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("multiple",o.value.Status,2)),l=e.ref({}),o=e.ref({}),d=(p,n)=>{n.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:n.Path,Name:o.value.ProjectID+"_"+(p.Multiple?n.Name:`${p.Title}.pdf`)})},u=M.download,E=T,k=()=>{rxjs.forkJoin([M.multiple("getAttachment",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=N.value.filter(y=>{var g;return!((g=y.Excludes)!=null&&g.includes(o.value.OrgCategory))}),o.value.Status>=42&&N.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/MUL/6-著作權授權同意書.docx",Files:[]}),N.value.forEach(y=>{y.Files=n.Attachments.filter(g=>g.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(g=>!g.Deleted).length)}),P().init("multiple",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},w=p=>{var y,g;if(l.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:h.id,Attachments:N.value.reduce((i,a)=>i.concat(a.Files),[]),Before:(y=m.value)==null?void 0:y.Form5Before,After:(g=m.value)==null?void 0:g.Form5After,Submit:p?"true":"false"};M.multiple("saveAttachment",n).subscribe(()=>{p?E("next"):k()})},D=()=>{if(m.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(m.value,p))}return!Object.keys(l.value).length};return e.onMounted(k),e.provide("editable",r),(p,n)=>{const y=e.resolveComponent("required-label"),g=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wi,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",Yi,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Hi,[e.createElementVNode("table",Zi,[e.createElementVNode("thead",Ki,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Xi,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",vi,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[a.Optional?(e.openBlock(),e.createElementBlock("span",ec,e.toDisplayString(a.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(a.Title),1)]),_:2},1024))]),e.unref(r)&&a.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:a.Comment},null,8,tc)):e.createCommentVNode("",!0),e.unref(r)&&a.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:a.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,lc)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",oc,[a.Uploaded?(e.openBlock(),e.createElementBlock("span",nc,"已上傳")):(e.openBlock(),e.createElementBlock("span",rc,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(a.Multiple||!a.Uploaded)?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:t=>d(a,t)},null,8,["onFile"])):e.createCommentVNode("",!0),a.Uploaded?(e.openBlock(),e.createElementBlock("div",ac,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",dc,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(u)(t.Path)},e.toDisplayString(t.Name),9,sc),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:s=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,mc)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ic,[e.createElementVNode("table",cc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(m).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(m).Form5Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(m).Form5After,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form5After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Vc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=a=>w(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,pc)])):e.createCommentVNode("",!0)],64)}}},Nc={class:"block"},Ec={class:"mt-4"},uc={class:"table-responsive mt-3 mb-0"},bc={class:"table align-middle gray-table"},gc={key:0,width:"1"},kc={key:0},yc={class:"d-flex gap-2"},xc=["onClick"],Bc={class:"table-responsive mt-3 mb-0"},hc={class:"table align-middle gray-table"},$c={class:"mt-4"},Cc={class:"table align-middle gray-table side-table"},Tc={key:0,class:"block-bottom bg-light-teal"},_c={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),m=e.ref(),V=e.computed(()=>z("multiple",o.value.Status,4)),r=e.ref({}),l=e.computed(()=>N.value.filter(p=>!p.Deleted)),o=e.ref({}),d=()=>N.value.push({}),u=T,E=()=>{rxjs.forkJoin([M.multiple("getBenefit",{ID:h.id})]).subscribe(p=>{const n=p[0];o.value=n.Project,N.value=n.Benefits,N.value.length||d(),P().init("multiple",o.value),m.value=o.value.changeApply,o.value.changeApply=void 0})},k=p=>p.Deleted=!0,w=p=>{var y,g;if(r.value={},p&&!D()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:o.value,Benefits:N.value,Before:(y=m.value)==null?void 0:y.Form4Before,After:(g=m.value)==null?void 0:g.Form4After,Submit:p?"true":"false"};M.multiple("saveBenefit",n).subscribe(()=>{p?u("next"):E()})},D=()=>{let p={Benefit:"不可量化成果"};return r.value=O(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((n,y)=>Object.assign(r.value,O(n,p,`item-${y}-`))),m.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(r.value,O(m.value,p))),!Object.keys(r.value).length};return e.onMounted(E),e.provide("editable",V),(p,n)=>{const y=e.resolveComponent("input-text"),g=e.resolveComponent("input-textarea"),i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Nc,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Ec,[e.createElementVNode("div",uc,[e.createElementVNode("table",bc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",gc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(a,c)=>(e.openBlock(),e.createElementBlock("tr",{key:a},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(r)[`item-${c}-Title`],modelValue:a.Title,"onUpdate:modelValue":t=>a.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(r)[`item-${c}-Target`],modelValue:a.Target,"onUpdate:modelValue":t=>a.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r)[`item-${c}-Description`],rows:"1",modelValue:a.Description,"onUpdate:modelValue":t=>a.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",kc,[e.createElementVNode("div",yc,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>k(a),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,xc)):e.createCommentVNode("",!0),c+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Bc,[e.createElementVNode("table",hc,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":n[0]||(n[0]=a=>e.unref(o).Benefit=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$c,[e.createElementVNode("table",Cc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=a=>e.unref(m).Form4Before=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(r).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":n[2]||(n[2]=a=>e.unref(m).Form4After=a),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Tc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=a=>w()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=a=>w(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},wc={class:"block"},Dc={class:"mt-4"},Sc={class:"table-responsive mt-3 mb-0"},Ac={class:"table align-middle gray-table"},Fc={class:"text-end"},Uc={class:"text-end"},Mc={class:"table-responsive"},Oc={class:"table align-middle gray-table"},Ic=["colspan"],jc={key:0,width:"1"},Pc={class:"text-end"},qc={key:0},Rc={class:"d-flex gap-2"},Lc=["onClick"],zc={class:"mt-4"},Gc={class:"table-responsive mt-3 mb-0"},Jc={class:"table align-middle gray-table"},Qc={key:0,width:"1"},Wc={class:"text-end"},Yc={key:0},Hc={class:"d-flex gap-2"},Zc=["onClick"],Kc={class:"mt-4"},Xc={class:"table align-middle gray-table side-table"},vc={key:0,class:"block-bottom bg-light-teal"},eV={class:"text-center"},tV={class:"mb-5"},lV={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),m=e.computed(()=>z("multiple",o.value.Status,3)),V=e.ref({}),r=e.computed(()=>u.value.filter(c=>!c.Deleted)),l=e.computed(()=>E.value.filter(c=>!c.Deleted)),o=e.ref({}),d=e.ref(),u=e.ref([]),E=e.ref([]),k=e.ref({}),w=e.ref(0),D=()=>u.value.push({}),p=()=>E.value.push({}),n=T,y=()=>{rxjs.forkJoin([M.multiple("getFunding",{ID:h.id})]).subscribe(c=>{const t=c[0];o.value=t.Project,u.value=t.OtherSubsidies,E.value=t.BudgetPlans,k.value=t.GrantTargetSetting,u.value.length||D(),E.value.length||p(),P().init("multiple",o.value),N.value=o.value.changeApply,o.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=(c,t)=>{var f,F;if(V.value={},c&&!a()){e.nextTick(()=>{var C;return(C=document.querySelector(".invalid"))==null?void 0:C.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>k.value.GrantLimit*1e4){d.value.show(()=>i(c,!0));return}const s={Project:o.value,OtherSubsidies:u.value,BudgetPlans:E.value,Before:(f=N.value)==null?void 0:f.Form3Before,After:(F=N.value)==null?void 0:F.Form3After,Submit:c?"true":"false"};M.multiple("saveFunding",s).subscribe(()=>{c?n("next"):y()})},a=()=>{let c={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=O(o.value,c),c={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},u.value.forEach((t,s)=>Object.assign(V.value,O(t,c,`other-${s}-`))),c={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},E.value.forEach((t,s)=>Object.assign(V.value,O(t,c,`plan-${s}-`))),N.value&&(c={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,O(N.value,c))),!Object.keys(V.value).length};return e.onMounted(y),e.provide("editable",m),e.watchEffect(()=>{o.value.OtherAmount=r.value.reduce((c,t)=>c+L(t.Amount),0),w.value=L(o.value.ApplyAmount)+L(o.value.SelfAmount)+L(o.value.OtherAmount),r.value.forEach(c=>c.percent=Math.round(L(c.Amount)/o.value.OtherAmount*1e4)/100),E.value.forEach(c=>c.sum=L(c.Amount)+L(c.OtherAmount))}),(c,t)=>{var U;const s=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),C=e.resolveComponent("required-label"),A=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",wc,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Dc,[e.createElementVNode("div",Sc,[e.createElementVNode("table",Ac,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=S=>e.unref(o).ApplyAmount=S)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=S=>e.unref(o).SelfAmount=S)},null,8,["error","modelValue"])]),e.createElementVNode("td",Fc,e.toDisplayString((U=e.unref(o).OtherAmount)==null?void 0:U.toLocaleString()),1),e.createElementVNode("td",Uc,e.toDisplayString(e.unref(w).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Mc,[e.createElementVNode("table",Oc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(m)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Ic)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",jc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(S,b)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,e.toDisplayString(b+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`other-${b}-Unit`],modelValue:S.Unit,"onUpdate:modelValue":B=>S.Unit=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`other-${b}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":B=>S.Amount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Pc,e.toDisplayString(S.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`other-${b}-Content`],rows:"1",modelValue:S.Content,"onUpdate:modelValue":B=>S.Content=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",qc,[e.createElementVNode("div",Rc,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:B=>g(S),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Lc)):e.createCommentVNode("",!0),b+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:D,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",zc,[e.createElementVNode("div",Gc,[e.createElementVNode("table",Jc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Qc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(S,b)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`plan-${b}-Title`],modelValue:S.Title,"onUpdate:modelValue":B=>S.Title=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`plan-${b}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":B=>S.Amount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(s,{error:e.unref(V)[`plan-${b}-OtherAmount`],modelValue:S.OtherAmount,"onUpdate:modelValue":B=>S.OtherAmount=B},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Wc,e.toDisplayString(S.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V)[`plan-${b}-Description`],rows:"1",modelValue:S.Description,"onUpdate:modelValue":B=>S.Description=B,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Yc,[e.createElementVNode("div",Hc,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:B=>g(S),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Zc)):e.createCommentVNode("",!0),b+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Kc,[e.createElementVNode("table",Xc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=S=>e.unref(N).Form3Before=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(C,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":t[3]||(t[3]=S=>e.unref(N).Form3After=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",vc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=S=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=S=>i(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(A,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",eV,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",tV,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(k).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},oV={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:T,type:"multiple"})}}},nV={class:"block"},rV={class:"mt-4"},aV={class:"table align-middle gray-table side-table"},dV={key:0,class:"d-flex align-items-center gap-2"},sV={class:"input-group w-auto"},mV={class:"text-teal-dark"},iV={key:1,class:"invalid mt-0"},cV={class:"table-responsive mt-4"},VV={class:"table align-middle gray-table"},pV={key:0},fV={class:"input-group"},NV={key:0,class:"invalid mt-0"},EV={key:0},uV={class:"d-flex gap-2"},bV=["onClick"],gV={class:"mt-4"},kV={class:"table align-middle gray-table"},yV={key:0},xV={key:0},BV={class:"d-flex gap-2"},hV=["onClick"],$V={class:"mt-4"},CV={class:"table align-middle gray-table side-table"},TV={key:0,class:"block-bottom bg-light-teal"},_V={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=[{value:1,text:"50%"},{value:2,text:"100%"}],m=e.ref(),V=e.computed(()=>E.value.EndDate),r=e.computed(()=>z("multiple",u.value.Status,2)),l=e.ref({}),o=e.computed(()=>k.value.filter(c=>!c.Deleted)),d=e.computed(()=>w.value.filter(c=>!c.Deleted)),u=e.ref({}),E=e.ref({}),k=e.ref([]),w=e.ref([]),D=()=>M.multiple("createItem",{ID:h.id}).subscribe(c=>k.value.push(c)),p=()=>w.value.push({Type:0,ItemID:0}),n=T,y=()=>{rxjs.forkJoin([M.multiple("getWorkSchedule",{ID:h.id})]).subscribe(c=>{const t=c[0];u.value=t.Project,E.value=t.GrantType,k.value=t.Items,w.value=t.Schedules,k.value.length||D(),w.value.length||p(),P().init("multiple",u.value),m.value=u.value.changeApply,u.value.changeApply=void 0})},g=c=>c.Deleted=!0,i=c=>{var s,f;if(l.value={},c&&!a()){e.nextTick(()=>{var F;return(F=document.querySelector(".invalid"))==null?void 0:F.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:u.value,Items:k.value,Schedules:w.value,Before:(s=m.value)==null?void 0:s.Form2Before,After:(f=m.value)==null?void 0:f.Form2After,Submit:c?"true":"false"};M.multiple("saveWorkSchedule",t).subscribe(()=>{c?n("next"):y()})},a=()=>{let c={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(u.value,c),c={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`item-${s}-`))),c={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,s)=>Object.assign(l.value,O(t,c,`schedule-${s}-`))),m.value&&(c={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(m.value,c))),!Object.keys(l.value).length};return e.onMounted(y),e.provide("editable",r),(c,t)=>{const s=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),F=e.resolveComponent("tw-date"),C=e.resolveComponent("input-text"),A=e.resolveComponent("input-month"),U=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nV,[t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",rV,[e.createElementVNode("table",aV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",dV,[e.createElementVNode("div",sV,[e.createVNode(f,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(u).StartTime,"onUpdate:modelValue":t[0]||(t[0]=b=>e.unref(u).StartTime=b)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(u).EndTime,"onUpdate:modelValue":t[1]||(t[1]=b=>e.unref(u).EndTime=b)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",mV,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(F,{value:e.unref(V)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",iV,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",cV,[e.createElementVNode("table",VV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",pV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(l)[`item-${B}-Title`],modelValue:b.Title,"onUpdate:modelValue":_=>b.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",fV,[e.createVNode(A,{"empty-value":0,modelValue:b.Begin,"onUpdate:modelValue":_=>b.Begin=_},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(A,{"empty-value":0,modelValue:b.End,"onUpdate:modelValue":_=>b.End=_},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${B}-Begin`]||e.unref(l)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",NV,e.toDisplayString(e.unref(l)[`item-${B}-Begin`]||e.unref(l)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`item-${B}-Deadline`],modelValue:b.Deadline,"onUpdate:modelValue":_=>b.Deadline=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`item-${B}-Content`],rows:"1",modelValue:b.Content,"onUpdate:modelValue":_=>b.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",EV,[e.createElementVNode("div",uV,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>g(b),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bV)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:D,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[29]||(t[29]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",gV,[e.createElementVNode("table",kV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[21]||(t[21]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",yV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(b,B)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(l)[`schedule-${B}-Type`],options:N,modelValue:b.Type,"onUpdate:modelValue":_=>b.Type=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(l)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:b.ItemID,"onUpdate:modelValue":_=>b.ItemID=_,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(b.ItemID?String.fromCharCode(65+e.unref(o).findIndex(_=>_.ID===b.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l)[`schedule-${B}-Deadline`],modelValue:b.Deadline,"onUpdate:modelValue":_=>b.Deadline=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`schedule-${B}-Content`],rows:"1",modelValue:b.Content,"onUpdate:modelValue":_=>b.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",xV,[e.createElementVNode("div",BV,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>g(b),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,hV)):e.createCommentVNode("",!0),B+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[23]||(t[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$V,[e.createElementVNode("table",CV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=b=>e.unref(m).Form2Before=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(s,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":t[3]||(t[3]=b=>e.unref(m).Form2After=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",TV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=b=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=b=>i(!0)),type:"button"},[...t[30]||(t[30]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},wV={key:0,class:"scroll-bottom-panel"},DV={class:"d-flex flex-column gap-3 mb-3"},SV={class:"d-flex gap-2"},AV={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},FV={class:"text-nowrap my-2 d-flex align-items-center"},UV={__name:"ProjectChangeReview",props:{id:{type:[Number,String]},type:{type:String}},setup(x){const T=x,h=P(),N=[{value:1,text:"通過"},{value:2,text:"退回修改"}],m=e.ref({}),V=e.ref({ID:T.id,Result:1}),r=()=>{const o={};if(V.value.Result>1&&(o.Reason="原因"),m.value=O(V.value,o),Object.keys(m.value).length){l();return}M[T.type]("reviewApplicationChange",V.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=5")})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>V.value.Result,o=>{o>1&&l()}),(o,d)=>{const u=e.resolveComponent("input-radio-group"),E=e.resolveComponent("input-textarea");return e.unref(h)[x.type].organizer?(e.openBlock(),e.createElementBlock("div",wV,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",DV,[e.createElementVNode("li",SV,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",AV,[e.createElementVNode("div",FV,[e.createVNode(u,{options:N,modelValue:e.unref(V).Result,"onUpdate:modelValue":d[0]||(d[0]=k=>e.unref(V).Result=k)},null,8,["modelValue"])]),e.unref(V).Result>1?(e.openBlock(),e.createBlock(E,{key:0,error:e.unref(m).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(V).Reason,"onUpdate:modelValue":d[1]||(d[1]=k=>e.unref(V).Reason=k)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},MV={key:0,class:"scroll-bottom-panel"},OV={class:"d-flex flex-column gap-3 mb-3"},IV={class:"d-flex gap-2"},jV={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},PV={class:"text-nowrap my-2 d-flex align-items-center"},qV={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(x){const T=x,h=P(),N=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],m=e.ref({}),V=e.ref({ID:T.id,Result:1}),r=()=>{const o={};if(V.value.Result>1&&(o.Reason="原因"),m.value=O(V.value,o),Object.keys(m.value).length){l();return}M[T.type]("reviewApplication",V.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=4")})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>V.value.Result,o=>{o>1&&l()}),(o,d)=>{const u=e.resolveComponent("input-radio-group"),E=e.resolveComponent("input-textarea");return e.unref(h)[x.type].organizer?(e.openBlock(),e.createElementBlock("div",MV,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",OV,[e.createElementVNode("li",IV,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",jV,[e.createElementVNode("div",PV,[e.createVNode(u,{options:N,modelValue:e.unref(V).Result,"onUpdate:modelValue":d[0]||(d[0]=k=>e.unref(V).Result=k)},null,8,["modelValue"])]),e.unref(V).Result>1?(e.openBlock(),e.createBlock(E,{key:0,error:e.unref(m).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(V).Reason,"onUpdate:modelValue":d[1]||(d[1]=k=>e.unref(V).Reason=k)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},RV={class:"d-flex align-items-center gap-3"},LV={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},zV={class:"modal-content"},GV={class:"modal-header"},JV={class:"fs-24 fw-bold text-green-light"},QV={class:"modal-body"},WV={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},YV=["disabled"],HV={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(x){const T=x,h=e.computed(()=>!V.value||V.value===l[T.type].organizer),N=e.ref(),m=e.computed(()=>l[T.type].organizerName),V=e.ref(0),r=e.computed(()=>{var w;return(w=u.value.find(D=>D.UnitID===d.value))==null?void 0:w.reviewers}),l=P(),o=e.computed(()=>m.value?"移轉案件":"認領案件"),d=e.ref(0),u=e.ref([]),E=()=>{M[T.type]("queryReviewUnits").subscribe(w=>{u.value=w,rxjs.forkJoin(u.value.map(D=>M[T.type]("queryReviewersByUnit",{ID:D.UnitID}))).subscribe(D=>{D.forEach((p,n)=>{u.value[n].reviewers=p,p.some(y=>y.UserID===V.value)&&(d.value=u.value[n].UnitID)}),bootstrap.Modal.getOrCreateInstance(N.value).show()})})},k=()=>{M[T.type]("saveOrganizer",{ID:T.id,Organizer:V.value}).subscribe(w=>{w&&window.location.reload()})};return e.watch(m,()=>V.value=l[T.type].organizer),e.watch(d,()=>{r.value.some(w=>w.UserID===V.value)||(V.value=0)}),(w,D)=>{const p=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",RV,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(m)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:E,type:"button"},e.toDisplayString(e.unref(o)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:N,tabindex:"-1"},[e.createElementVNode("div",LV,[e.createElementVNode("div",zV,[e.createElementVNode("div",GV,[e.createElementVNode("h4",JV,e.toDisplayString(e.unref(o)),1),D[2]||(D[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",QV,[e.createElementVNode("div",null,[D[3]||(D[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(p,{"empty-value":0,options:e.unref(u),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(d),"onUpdate:modelValue":D[0]||(D[0]=n=>e.isRef(d)?d.value=n:null)},null,8,["options","modelValue"]),e.createVNode(p,{class:"mt-2","empty-value":0,options:e.unref(r),"text-name":"Name","value-name":"UserID",modelValue:e.unref(V),"onUpdate:modelValue":D[1]||(D[1]=n=>e.isRef(V)?V.value=n:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",WV,[D[4]||(D[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:k,disabled:e.unref(h),type:"button"},"確認",8,YV)])])])])],512)]))],64)}}},ZV={class:"step-line-wrapper"},KV={class:"step-line"},XV={key:0,class:"tag tag-white"},vV={key:1,class:"tag tag-white"},ep={key:0,class:"step-line"},tp={key:0,class:"tag tag-white"},lp={class:"step-line"},op={key:0,class:"tag tag-white"},np={key:0,class:"tag tag-white"},rp={__name:"ProjectProgress",props:{excludes:{default:[],type:Array},id:{type:[Number,String]},step:{required:!0,type:Number},type:{required:!0,type:String}},setup(x){const T=P(),h=x,N=m=>{location.href=`${m}.aspx?ID=${h.id}`};return(m,V)=>(e.openBlock(),e.createElementBlock("div",ZV,[e.createElementVNode("div",KV,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===1}]),onClick:V[0]||(V[0]=r=>N("Audit")),role:"button"},[V[4]||(V[4]=e.createElementVNode("div",{class:"step-line-item-title"},"核定計畫",-1)),x.step===1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[[1,4].includes(e.unref(T)[h.type].changeStatus)?(e.openBlock(),e.createElementBlock("div",XV,"編輯中")):e.unref(T)[h.type].changeStatus===2?(e.openBlock(),e.createElementBlock("div",vV,"審核中")):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],2)]),x.excludes.includes(4)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",ep,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===4}]),onClick:V[1]||(V[1]=r=>N("Progress")),role:"button"},[V[5]||(V[5]=e.createElementVNode("div",{class:"step-line-item-title"},"每月進度",-1)),x.step===4?(e.openBlock(),e.createElementBlock("div",tp,"編輯中")):e.createCommentVNode("",!0)],2)])),e.createElementVNode("div",lp,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===5}]),onClick:V[2]||(V[2]=r=>N("Report")),role:"button"},[V[6]||(V[6]=e.createElementVNode("div",{class:"step-line-item-title"},"階段報告",-1)),x.step===5?(e.openBlock(),e.createElementBlock("div",op,"編輯中")):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===6}]),onClick:V[3]||(V[3]=r=>N("Payment")),role:"button"},[V[7]||(V[7]=e.createElementVNode("div",{class:"step-line-item-title"},"請款核銷",-1)),x.step===6?(e.openBlock(),e.createElementBlock("div",np,"編輯中")):e.createCommentVNode("",!0)],2)])]))}},ap={class:"block"},dp={class:"square-title"},sp=["innerHTML"],mp={class:"table-responsive mt-3"},ip={class:"table align-middle gray-table"},cp={class:"text-center"},Vp=["href"],pp={key:0,class:"text-center"},fp={key:0},Np={key:1,class:"text-pink"},Ep={key:1,class:"tag-group mt-2 gap-1"},up={key:0,class:"tag tag-green-light"},bp=["download","href"],gp=["onClick"],kp={key:0,class:"block-bottom bg-light-teal"},yp=!0,xp={__name:"ProjectReport",props:{data:{required:!0,type:Object},id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x;e.computed(()=>N.value.some(o=>!o.Optional&&!o.Files.filter(d=>!d.Deleted).length));const N=e.ref(h.data.docs.map(o=>({...o,Files:[]})));e.ref({});const m=(o,d)=>{d.Type==="application/zip"&&o.Files.push({Type:o.Type,Path:d.Path,Name:h.id+"_"+(o.Multiple?d.Name:`${o.Title}.zip`)})},V=M.download,r=()=>{N.value.forEach(o=>{o.Uploaded=e.computed(()=>o.Files.filter(d=>!d.Deleted).length)})},l=o=>{};return e.onMounted(r),e.provide("editable",yp),(o,d)=>{const u=e.resolveComponent("required-label"),E=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ap,[e.createElementVNode("h5",dp,e.toDisplayString(x.data.subtitle),1),e.createElementVNode("p",{class:"text-pink mt-3 lh-base",innerHTML:x.data.description},null,8,sp),e.createElementVNode("div",mp,[e.createElementVNode("table",ip,[d[4]||(d[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"70",class:"text-center"},"附件編號"),e.createElementVNode("th",null,"附件名稱"),e.createElementVNode("th",{class:"text-center"},"狀態"),e.createElementVNode("th",null,"上傳附件")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(k,w)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",cp,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Title),1)]),_:2},1024)]),k.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:k.Template,style:{width:"140px"},type:"button"},[...d[2]||(d[2]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Vp)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",pp,[k.Uploaded?(e.openBlock(),e.createElementBlock("span",fp,"已上傳")):(e.openBlock(),e.createElementBlock("span",Np,"尚未上傳"))])),e.createElementVNode("td",null,[k.Multiple||!k.Uploaded?(e.openBlock(),e.createBlock(E,{key:0,accept:".zip",onFile:D=>m(k,D)},null,8,["onFile"])):e.createCommentVNode("",!0),k.Uploaded?(e.openBlock(),e.createElementBlock("div",Ep,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.Files,D=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:D},[D.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",up,[e.createElementVNode("a",{class:"tag-link my-1",download:D.Name,href:e.unref(V)(D.Path)},e.toDisplayString(D.Name),9,bp),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>D.Deleted=!0,type:"button"},[...d[3]||(d[3]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,gp))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),(e.openBlock(),e.createElementBlock("div",kp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[0]||(d[0]=k=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[1]||(d[1]=k=>l()),type:"button"},[...d[5]||(d[5]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])]))],64)}}},Bp={key:0,class:"scroll-bottom-panel"},hp={class:"d-flex flex-column gap-3 mb-3"},$p={class:"d-flex gap-2"},Cp={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Tp={class:"text-nowrap mb-2 d-flex align-items-center"},_p={key:0,class:"invalid mt-0"},wp={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(x){const T=x,h=P(),N=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],m=e.ref({}),V=e.ref({ID:T.id,Result:1}),r=()=>{},l=()=>{},o=()=>{const u={};if(V.value.Result>1&&(u.Reason="原因"),V.value.Result===3&&(u.CorrectionDeadline="補正期限"),m.value=O(V.value,u),Object.keys(m.value).length){d();return}M[T.type]("reviewApplication",V.value).subscribe(E=>{E&&(window.location.href="../ReviewChecklist.aspx?type=1")})},d=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>V.value.Result,u=>{u>1&&d()}),(u,E)=>{const k=e.resolveComponent("input-radio-group"),w=e.resolveComponent("input-tw-date"),D=e.resolveComponent("input-textarea");return e.unref(h)[x.type].organizer?(e.openBlock(),e.createElementBlock("div",Bp,[E[9]||(E[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",hp,[e.createElementVNode("li",{class:"d-flex gap-2"},[E[3]||(E[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:r,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[E[6]||(E[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),E[7]||(E[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[E[4]||(E[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:l,href:"javascript:void(0)"},"1"),E[5]||(E[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",$p,[E[8]||(E[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Cp,[e.createElementVNode("div",Tp,[e.createVNode(k,{options:N,modelValue:e.unref(V).Result,"onUpdate:modelValue":E[0]||(E[0]=p=>e.unref(V).Result=p)},null,8,["modelValue"]),e.createVNode(w,{class:"form-control",drops:"up",modelValue:e.unref(V).CorrectionDeadline,"onUpdate:modelValue":E[1]||(E[1]=p=>e.unref(V).CorrectionDeadline=p)},null,8,["modelValue"])]),e.unref(m).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",_p,e.toDisplayString(e.unref(m).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(V).Result>1?(e.openBlock(),e.createBlock(D,{key:1,error:e.unref(m).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(V).Reason,"onUpdate:modelValue":E[2]||(E[2]=p=>e.unref(V).Reason=p)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:o,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Dp={class:"top-wrapper"},Sp={class:"top-block"},Ap={class:"d-flex align-items-center gap-3"},Fp={__name:"ProjectTitle",props:{id:{type:[Number,String]},type:{type:String}},setup(x){const T=x,h=P();return(N,m)=>(e.openBlock(),e.createElementBlock("div",Dp,[e.createElementVNode("div",Sp,[e.createElementVNode("div",Ap,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(h)[T.type].type)+"］"+e.toDisplayString(e.unref(h)[T.type].id)+"/"+e.toDisplayString(e.unref(h)[T.type].name),1)]),m[0]||(m[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},Up={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},Mp={class:"d-flex gap-2"},Op={key:0,class:"btn text-teal-dark",type:"button"},Ip={class:"d-flex gap-2"},jp={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Pp={class:"modal-content"},qp={class:"modal-body"},Rp={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Lp={class:"modal-content"},zp={class:"modal-body"},Gp={class:"d-flex flex-column gap-4 mb-5"},Jp={class:"d-flex align-items-center"},Qp={class:"flex-grow-1"},Wp={__name:"ProjectToolbar",props:{id:{type:[Number,String]},type:{type:String}},setup(x){const T=P(),h=x,N=e.ref({}),m=e.ref(),V=e.ref({}),r=e.ref(),l=e.ref({}),o=e.ref(),d=()=>{const D={Reason:"計畫變更原因"};V.value=O(N.value,D),!Object.keys(V.value).length&&M[h.type]("applyChange",N.value).subscribe(p=>{p&&location.reload()})},u=()=>{N.value={ID:h.id},bootstrap.Modal.getOrCreateInstance(m.value).show()},E=()=>{bootstrap.Modal.getOrCreateInstance(r.value).show()},k=()=>{l.value={ID:h.id},bootstrap.Modal.getOrCreateInstance(o.value).show()},w=()=>{const D={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};V.value=O(l.value,D),!Object.keys(V.value).length&&M[h.type]("terminate",l.value).subscribe(p=>{p&&(location.href="../ApplicationChecklist.aspx")})};return(D,p)=>{const n=e.resolveComponent("project-organizer"),y=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Up,[e.createElementVNode("div",Mp,[e.unref(T)[h.type].changeStatus?(e.openBlock(),e.createElementBlock("button",Op," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:u,type:"button"}," 計畫變更申請 ")),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:E,type:"button"},[...p[3]||(p[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])]),p[4]||(p[4]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-download"}),e.createTextVNode(" 下載核定計畫書 ")],-1))]),e.createElementVNode("div",Ip,[e.createVNode(n,{id:x.id,type:x.type},null,8,["id","type"]),e.createElementVNode("button",{class:"btn btn-pink",onClick:k,type:"button"}," 計畫終止 ")])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:m,tabindex:"-1"},[e.createElementVNode("div",jp,[e.createElementVNode("div",Pp,[p[8]||(p[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",qp,[p[6]||(p[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),p[7]||(p[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(y,{error:e.unref(V).Reason,modelValue:e.unref(N).Reason,"onUpdate:modelValue":p[0]||(p[0]=i=>e.unref(N).Reason=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[p[5]||(p[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:d},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:r,tabindex:"-1"},[...p[9]||(p[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:o,tabindex:"-1"},[e.createElementVNode("div",Rp,[e.createElementVNode("div",Lp,[p[14]||(p[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",zp,[e.createElementVNode("div",Gp,[e.createElementVNode("div",null,[p[10]||(p[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(y,{error:e.unref(V).RejectReason,modelValue:e.unref(l).RejectReason,"onUpdate:modelValue":p[1]||(p[1]=i=>e.unref(l).RejectReason=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),p[12]||(p[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",Jp,[p[11]||(p[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",Qp,[e.createVNode(g,{error:e.unref(V).RecoveryAmount,modelValue:e.unref(l).RecoveryAmount,"onUpdate:modelValue":p[2]||(p[2]=i=>e.unref(l).RecoveryAmount=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[p[13]||(p[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:w},"送出")])])])])],512)]))],64)}}},Yp={key:0,class:"text-pink"},ee={AccessibilityApplication:Ke,AccessibilityAttachment:gt,AccessibilityBenefit:Ft,AccessibilityFunding:dl,AccessibilityProgressBar:sl,AccessibilityWorkSchedule:Fl,ConfirmModal:Pl,CommonProgressBar:Ql,CultureApplication:So,CultureAttachment:vo,CultureFunding:Tn,CultureOther:zn,CultureProgress:sr,CultureProgressBar:mr,CultureWorkSchedule:la,EducationApplication:Ya,EducationAttachment:Ed,EducationProgressBar:ud,ErrorModal:Bd,InputBoolean:hd,InputFile:$d,InputInteger:_d,InputMonth:wd,InputRadioGroup:Ad,InputSelect:Id,InputText:Ld,InputTextarea:Wd,InputTwDate:Zd,LiteracyApplication:Ds,LiteracyAttachment:Xs,LiteracyBenefit:Vm,LiteracyFunding:qm,LiteracyProgressBar:Rm,LiteracyWorkSchedule:Vi,MultipleApplication:Qi,MultipleAttachment:fc,MultipleBenefit:_c,MultipleFunding:lV,MultipleProgressBar:oV,MultipleWorkSchedule:_V,ProjectChangeReview:UV,ProjectCorrectionReview:qV,ProjectOrganizer:HV,ProjectProgress:rp,ProjectReport:xp,ProjectReview:wp,ProjectTitle:Fp,ProjectToolbar:Wp,RequiredLabel:{__name:"RequiredLabel",setup(x){const T=e.inject("editable",!0);return(h,N)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(T)?(e.openBlock(),e.createElementBlock("span",Yp,"* ")):e.createCommentVNode("",!0),e.renderSlot(h.$slots,"default")],64))}},TwDate:{__name:"TwDate",props:{value:{default:null,type:String}},setup(x){const T=x,h=m=>{const V=m==null?void 0:m.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return V?`${parseInt(V[1],10)-1911}/${V[2]}/${V[3]}`:""},N=e.ref(h(T.value));return e.watch(()=>T.value,m=>N.value=h(m)),(m,V)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(N)),1))}}};return{api:M,install:x=>{for(const T in ee)x.component(T,ee[T])},useProgressStore:P}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
