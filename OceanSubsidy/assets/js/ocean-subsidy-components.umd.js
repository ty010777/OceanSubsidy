(function(e,W){typeof exports=="object"&&typeof module<"u"?module.exports=W(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],W):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=W(e.Vue,e.Pinia))})(this,(function(e,W){"use strict";const I=W.defineStore("progress",{actions:{init(u,_){var B,E;this[u]={id:_.ProjectID,type:(B=_.SubsidyPlanType)==null?void 0:B.split(" ")[0],name:_.ProjectName,step:_.FormStep,status:_.Status,progress:_.ProgressStatus,changeStatus:(E=_.changeApply)==null?void 0:E.Status,organizer:_.Organizer,organizerName:_.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})});let ne=Date.now();const z=(u,_,B)=>{const E=I();if([1,14].includes(E[u].status)||[1,4].includes(E[u].changeStatus))return!0;if(E[u].status===42)switch(u){case"culture":if([2,3,5].includes(B))return!0;break;case"multiple":if([2,3,4,5].includes(B))return!0;break;case"accessibility":if([2,3,4,5].includes(B))return!0;break}return!1},re=()=>`id--${ne++}`,R=u=>parseInt(u)||0,K=W.defineStore("message",{state:()=>({error:null})}),{ajax:ae}=rxjs.ajax,{map:de}=rxjs;let Z="";const se=(u,_={})=>Q("Service/OFS/Accessibility.ashx",{method:u,param:_}),ce=(u,_={})=>Q("Service/OFS/Culture.ashx",{method:u,param:_}),me=u=>`${Z}/Service/OFS/Download.ashx?path=${u}`,ie=(u,_={})=>Q("Service/OFS/Education.ashx",{method:u,param:_}),pe=(u,_={})=>Q("Service/OFS/Literacy.ashx",{method:u,param:_}),Ve=(u,_={})=>Q("Service/OFS/Multiple.ashx",{method:u,param:_}),fe=({response:u,status:_})=>{if(_===200){if(u.success)return u.data;K().error=u.message}},Q=(u,_={})=>{const B={};_.constructor!==FormData&&(B["Content-Type"]="application/json");const E={body:_,headers:B,method:"POST",url:`${Z}/${u}`};return ae(E).pipe(de(fe))},A=Object.assign(Q,{accessibility:se,culture:ce,download:me,education:ie,literacy:pe,multiple:Ve,system:(u,_={})=>Q("Service/OFS/System.ashx",{method:u,param:_}),upload:u=>{const _=new FormData;return _.append("file",u),Q("Service/OFS/Upload.ashx",_)}});function Ne(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Y={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var Ee=Y.exports,X;function be(){return X||(X=1,(function(u,_){(function(B,E,s){var N=function(l,n,d){d=a.extend({},a.options,d);var c=a.runValidations(l,n,d);if(c.some(function(r){return a.isPromise(r.error)}))throw new Error("Use validate.async if you want support for promises");return N.processValidationResults(c,d)},a=N;a.extend=function(l){return[].slice.call(arguments,1).forEach(function(n){for(var d in n)l[d]=n[d]}),l},a.extend(N,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var l=a.format("%{major}.%{minor}.%{patch}",a.version);return a.isEmpty(a.version.metadata)||(l+="+"+a.version.metadata),l}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(l,n,d){var c=[],r,g,x,C,p,o,y;(a.isDomElement(l)||a.isJqueryElement(l))&&(l=a.collectFormValues(l));for(r in n){x=a.getDeepObjectValue(l,r),C=a.result(n[r],x,l,r,d,n);for(g in C){if(p=a.validators[g],!p)throw y=a.format("Unknown validator %{name}",{name:g}),new Error(y);o=C[g],o=a.result(o,x,l,r,d,n),o&&c.push({attribute:r,value:x,validator:g,globalOptions:d,attributes:l,options:o,error:p.call(p,x,o,r,l,d)})}}return c},processValidationResults:function(l,n){l=a.pruneEmptyErrors(l,n),l=a.expandMultipleErrors(l,n),l=a.convertErrorMessages(l,n);var d=n.format||"grouped";if(typeof a.formatters[d]=="function")l=a.formatters[d](l);else throw new Error(a.format("Unknown format %{format}",n));return a.isEmpty(l)?void 0:l},async:function(l,n,d){d=a.extend({},a.async.options,d);var c=d.wrapErrors||function(g){return g};d.cleanAttributes!==!1&&(l=a.cleanAttributes(l,n));var r=a.runValidations(l,n,d);return new a.Promise(function(g,x){a.waitForResults(r).then(function(){var C=a.processValidationResults(r,d);C?x(new c(C,d,l,n)):g(l)},function(C){x(C)})})},single:function(l,n,d){return d=a.extend({},a.single.options,d,{format:"flat",fullMessages:!1}),a({single:l},{single:n},d)},waitForResults:function(l){return l.reduce(function(n,d){return a.isPromise(d.error)?n.then(function(){return d.error.then(function(c){d.error=c||null})}):n},new a.Promise(function(n){n()}))},result:function(l){var n=[].slice.call(arguments,1);return typeof l=="function"&&(l=l.apply(null,n)),l},isNumber:function(l){return typeof l=="number"&&!isNaN(l)},isFunction:function(l){return typeof l=="function"},isInteger:function(l){return a.isNumber(l)&&l%1===0},isBoolean:function(l){return typeof l=="boolean"},isObject:function(l){return l===Object(l)},isDate:function(l){return l instanceof Date},isDefined:function(l){return l!=null},isPromise:function(l){return!!l&&a.isFunction(l.then)},isJqueryElement:function(l){return l&&a.isString(l.jquery)},isDomElement:function(l){return!l||!l.querySelectorAll||!l.querySelector?!1:a.isObject(document)&&l===document?!0:typeof HTMLElement=="object"?l instanceof HTMLElement:l&&typeof l=="object"&&l!==null&&l.nodeType===1&&typeof l.nodeName=="string"},isEmpty:function(l){var n;if(!a.isDefined(l))return!0;if(a.isFunction(l))return!1;if(a.isString(l))return a.EMPTY_STRING_REGEXP.test(l);if(a.isArray(l))return l.length===0;if(a.isDate(l))return!1;if(a.isObject(l)){for(n in l)return!1;return!0}return!1},format:a.extend(function(l,n){return a.isString(l)?l.replace(a.format.FORMAT_REGEXP,function(d,c,r){return c==="%"?"%{"+r+"}":String(n[r])}):l},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(l){return a.isNumber(l)?l*100%1===0?""+l:parseFloat(Math.round(l*100)/100).toFixed(2):a.isArray(l)?l.map(function(n){return a.prettify(n)}).join(", "):a.isObject(l)?a.isDefined(l.toString)?l.toString():JSON.stringify(l):(l=""+l,l.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(n,d,c){return""+d+" "+c.toLowerCase()}).toLowerCase())},stringifyValue:function(l,n){var d=n&&n.prettify||a.prettify;return d(l)},isString:function(l){return typeof l=="string"},isArray:function(l){return{}.toString.call(l)==="[object Array]"},isHash:function(l){return a.isObject(l)&&!a.isArray(l)&&!a.isFunction(l)},contains:function(l,n){return a.isDefined(l)?a.isArray(l)?l.indexOf(n)!==-1:n in l:!1},unique:function(l){return a.isArray(l)?l.filter(function(n,d,c){return c.indexOf(n)==d}):l},forEachKeyInKeypath:function(l,n,d){if(a.isString(n)){var c="",r,g=!1;for(r=0;r<n.length;++r)switch(n[r]){case".":g?(g=!1,c+="."):(l=d(l,c,!1),c="");break;case"\\":g?(g=!1,c+="\\"):g=!0;break;default:g=!1,c+=n[r];break}return d(l,c,!0)}},getDeepObjectValue:function(l,n){if(a.isObject(l))return a.forEachKeyInKeypath(l,n,function(d,c){if(a.isObject(d))return d[c]})},collectFormValues:function(l,n){var d={},c,r,g,x,C,p;if(a.isJqueryElement(l)&&(l=l[0]),!l)return d;for(n=n||{},x=l.querySelectorAll("input[name], textarea[name]"),c=0;c<x.length;++c)if(g=x.item(c),!a.isDefined(g.getAttribute("data-ignored"))){var o=g.name.replace(/\./g,"\\\\.");p=a.sanitizeFormValue(g.value,n),g.type==="number"?p=p?+p:null:g.type==="checkbox"?g.attributes.value?g.checked||(p=d[o]||null):p=g.checked:g.type==="radio"&&(g.checked||(p=d[o]||null)),d[o]=p}for(x=l.querySelectorAll("select[name]"),c=0;c<x.length;++c)if(g=x.item(c),!a.isDefined(g.getAttribute("data-ignored"))){if(g.multiple){p=[];for(r in g.options)C=g.options[r],C&&C.selected&&p.push(a.sanitizeFormValue(C.value,n))}else{var y=typeof g.options[g.selectedIndex]<"u"?g.options[g.selectedIndex].value:"";p=a.sanitizeFormValue(y,n)}d[g.name]=p}return d},sanitizeFormValue:function(l,n){return n.trim&&a.isString(l)&&(l=l.trim()),n.nullify!==!1&&l===""?null:l},capitalize:function(l){return a.isString(l)?l[0].toUpperCase()+l.slice(1):l},pruneEmptyErrors:function(l){return l.filter(function(n){return!a.isEmpty(n.error)})},expandMultipleErrors:function(l){var n=[];return l.forEach(function(d){a.isArray(d.error)?d.error.forEach(function(c){n.push(a.extend({},d,{error:c}))}):n.push(d)}),n},convertErrorMessages:function(l,n){n=n||{};var d=[],c=n.prettify||a.prettify;return l.forEach(function(r){var g=a.result(r.error,r.value,r.attribute,r.options,r.attributes,r.globalOptions);if(!a.isString(g)){d.push(r);return}g[0]==="^"?g=g.slice(1):n.fullMessages!==!1&&(g=a.capitalize(c(r.attribute))+" "+g),g=g.replace(/\\\^/g,"^"),g=a.format(g,{value:a.stringifyValue(r.value,n)}),d.push(a.extend({},r,{error:g}))}),d},groupErrorsByAttribute:function(l){var n={};return l.forEach(function(d){var c=n[d.attribute];c?c.push(d):n[d.attribute]=[d]}),n},flattenErrorsToArray:function(l){return l.map(function(n){return n.error}).filter(function(n,d,c){return c.indexOf(n)===d})},cleanAttributes:function(l,n){function d(g,x,C){return a.isObject(g[x])?g[x]:g[x]=C?!0:{}}function c(g){var x={},C;for(C in g)g[C]&&a.forEachKeyInKeypath(x,C,d);return x}function r(g,x){if(!a.isObject(g))return g;var C=a.extend({},g),p,o;for(o in g)p=x[o],a.isObject(p)?C[o]=r(C[o],p):p||delete C[o];return C}return!a.isObject(n)||!a.isObject(l)?{}:(n=c(n),r(l,n))},exposeModule:function(l,n,d,c,r){d?(c&&c.exports&&(d=c.exports=l),d.validate=l):(n.validate=l,l.isFunction(r)&&r.amd&&r([],function(){return l}))},warn:function(l){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+l)},error:function(l){typeof console<"u"&&console.error&&console.error("[validate.js] "+l)}}),N.validators={presence:function(l,n){if(n=a.extend({},this.options,n),n.allowEmpty!==!1?!a.isDefined(l):a.isEmpty(l))return n.message||this.message||"can't be blank"},length:function(l,n,d){if(a.isDefined(l)){n=a.extend({},this.options,n);var c=n.is,r=n.maximum,g=n.minimum,x=n.tokenizer||function(y){return y},C,p=[];l=x(l);var o=l.length;if(!a.isNumber(o))return n.message||this.notValid||"has an incorrect length";if(a.isNumber(c)&&o!==c&&(C=n.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",p.push(a.format(C,{count:c}))),a.isNumber(g)&&o<g&&(C=n.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",p.push(a.format(C,{count:g}))),a.isNumber(r)&&o>r&&(C=n.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",p.push(a.format(C,{count:r}))),p.length>0)return n.message||p}},numericality:function(l,n,d,c,r){if(a.isDefined(l)){n=a.extend({},this.options,n);var g=[],x,C,p={greaterThan:function(m,i){return m>i},greaterThanOrEqualTo:function(m,i){return m>=i},equalTo:function(m,i){return m===i},lessThan:function(m,i){return m<i},lessThanOrEqualTo:function(m,i){return m<=i},divisibleBy:function(m,i){return m%i===0}},o=n.prettify||r&&r.prettify||a.prettify;if(a.isString(l)&&n.strict){var y="^-?(0|[1-9]\\d*)";if(n.onlyInteger||(y+="(\\.\\d+)?"),y+="$",!new RegExp(y).test(l))return n.message||n.notValid||this.notValid||this.message||"must be a valid number"}if(n.noStrings!==!0&&a.isString(l)&&!a.isEmpty(l)&&(l=+l),!a.isNumber(l))return n.message||n.notValid||this.notValid||this.message||"is not a number";if(n.onlyInteger&&!a.isInteger(l))return n.message||n.notInteger||this.notInteger||this.message||"must be an integer";for(x in p)if(C=n[x],a.isNumber(C)&&!p[x](l,C)){var b="not"+a.capitalize(x),V=n[b]||this[b]||this.message||"must be %{type} %{count}";g.push(a.format(V,{count:C,type:o(x)}))}if(n.odd&&l%2!==1&&g.push(n.notOdd||this.notOdd||this.message||"must be odd"),n.even&&l%2!==0&&g.push(n.notEven||this.notEven||this.message||"must be even"),g.length)return n.message||g}},datetime:a.extend(function(l,n){if(!a.isFunction(this.parse)||!a.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(a.isDefined(l)){n=a.extend({},this.options,n);var d,c=[],r=n.earliest?this.parse(n.earliest,n):NaN,g=n.latest?this.parse(n.latest,n):NaN;if(l=this.parse(l,n),isNaN(l)||n.dateOnly&&l%864e5!==0)return d=n.notValid||n.message||this.notValid||"must be a valid date",a.format(d,{value:arguments[0]});if(!isNaN(r)&&l<r&&(d=n.tooEarly||n.message||this.tooEarly||"must be no earlier than %{date}",d=a.format(d,{value:this.format(l,n),date:this.format(r,n)}),c.push(d)),!isNaN(g)&&l>g&&(d=n.tooLate||n.message||this.tooLate||"must be no later than %{date}",d=a.format(d,{date:this.format(g,n),value:this.format(l,n)}),c.push(d)),c.length)return a.unique(c)}},{parse:null,format:null}),date:function(l,n){return n=a.extend({},n,{dateOnly:!0}),a.validators.datetime.call(a.validators.datetime,l,n)},format:function(l,n){(a.isString(n)||n instanceof RegExp)&&(n={pattern:n}),n=a.extend({},this.options,n);var d=n.message||this.message||"is invalid",c=n.pattern,r;if(a.isDefined(l)&&(!a.isString(l)||(a.isString(c)&&(c=new RegExp(n.pattern,n.flags)),r=c.exec(l),!r||r[0].length!=l.length)))return d},inclusion:function(l,n){if(a.isDefined(l)&&(a.isArray(n)&&(n={within:n}),n=a.extend({},this.options,n),!a.contains(n.within,l))){var d=n.message||this.message||"^%{value} is not included in the list";return a.format(d,{value:l})}},exclusion:function(l,n){if(a.isDefined(l)&&(a.isArray(n)&&(n={within:n}),n=a.extend({},this.options,n),!!a.contains(n.within,l))){var d=n.message||this.message||"^%{value} is restricted";return a.isString(n.within[l])&&(l=n.within[l]),a.format(d,{value:l})}},email:a.extend(function(l,n){n=a.extend({},this.options,n);var d=n.message||this.message||"is not a valid email";if(a.isDefined(l)&&(!a.isString(l)||!this.PATTERN.exec(l)))return d},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(l,n,d,c,r){if(a.isDefined(l)){a.isString(n)&&(n={attribute:n}),n=a.extend({},this.options,n);var g=n.message||this.message||"is not equal to %{attribute}";if(a.isEmpty(n.attribute)||!a.isString(n.attribute))throw new Error("The attribute must be a non empty string");var x=a.getDeepObjectValue(c,n.attribute),C=n.comparator||function(o,y){return o===y},p=n.prettify||r&&r.prettify||a.prettify;if(!C(l,x,n,d,c))return a.format(g,{attribute:p(n.attribute)})}},url:function(l,n){if(a.isDefined(l)){n=a.extend({},this.options,n);var d=n.message||this.message||"is not a valid url",c=n.schemes||this.schemes||["http","https"],r=n.allowLocal||this.allowLocal||!1,g=n.allowDataUrl||this.allowDataUrl||!1;if(!a.isString(l))return d;var x="^(?:(?:"+c.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",C="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(r?C+="?":x+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",x+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+C+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",g){var p="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",o="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",y="data:(?:"+p+")?(?:;base64)?,"+o;x="(?:"+x+")|(?:^"+y+"$)"}var b=new RegExp(x,"i");if(!b.exec(l))return d}},type:a.extend(function(l,n,d,c,r){if(a.isString(n)&&(n={type:n}),!!a.isDefined(l)){var g=a.extend({},this.options,n),x=g.type;if(!a.isDefined(x))throw new Error("No type was specified");var C;if(a.isFunction(x)?C=x:C=this.types[x],!a.isFunction(C))throw new Error("validate.validators.type.types."+x+" must be a function.");if(!C(l,g,d,c,r)){var p=n.message||this.messages[x]||this.message||g.message||(a.isFunction(x)?"must be of the correct type":"must be of type %{type}");return a.isFunction(p)&&(p=p(l,n,d,c,r)),a.format(p,{attribute:a.prettify(d),type:x})}}},{types:{object:function(l){return a.isObject(l)&&!a.isArray(l)},array:a.isArray,integer:a.isInteger,number:a.isNumber,string:a.isString,date:a.isDate,boolean:a.isBoolean},messages:{}})},N.formatters={detailed:function(l){return l},flat:a.flattenErrorsToArray,grouped:function(l){var n;l=a.groupErrorsByAttribute(l);for(n in l)l[n]=a.flattenErrorsToArray(l[n]);return l},constraint:function(l){var n;l=a.groupErrorsByAttribute(l);for(n in l)l[n]=l[n].map(function(d){return d.validator}).sort();return l}},N.exposeModule(N,this,B,E,s)}).call(Ee,_,u,null)})(Y,Y.exports)),Y.exports}var ke=be();const v=Ne(ke),O=(u,_,B="")=>{const E={};Object.keys(_).forEach(a=>{const l=_[a];v.isString(l)?E[a]={presence:{allowEmpty:!1,message:`^請輸入${l}`}}:E[a]=l});const s={},N=v(u,E);return N&&Object.keys(N).forEach(a=>s[`${B}${a}`]=N[a].join(",")),s},ge={class:"block"},ye={class:"mt-4"},ue={class:"table align-middle gray-table side-table"},xe={key:0},Be={key:1,class:"text-light-gray"},he={class:"d-flex flex-column gap-2"},$e={key:0},Ce={class:"mt-4"},_e={class:"table align-middle gray-table side-table"},Te={class:"row g-3"},we={class:"col-12 col-xl-2"},De={class:"text-gray mb-2"},Fe={class:"col-12 col-xl-3"},Se={class:"text-gray mb-2"},Ae={class:"col-12 col-xl-4"},Ue={class:"row g-1"},Me={class:"col-7"},Oe={class:"col-5"},je={class:"col-12 col-xl-3"},Ie={class:"text-gray mb-2"},Pe={class:"col-12"},qe={class:"text-gray mb-2"},Le={class:"mt-4"},Re={class:"table align-middle gray-table side-table"},ze={class:"mt-4"},Ge={class:"table align-middle gray-table side-table"},Je={key:0,class:"table-responsive mt-3 mb-0"},Qe={class:"table align-middle gray-table"},We={key:0},Ye={key:0},He={class:"d-flex gap-2"},Ke=["onClick"],Ze={class:"mt-4"},Xe={class:"table align-middle gray-table side-table"},ve={key:0,class:"block-bottom bg-light-teal"},et={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.ref(),a=e.computed(()=>z("accessibility",d.value.Status,1)),l=e.ref({}),n=e.computed(()=>c.value.filter(b=>!b.Deleted)),d=e.ref({}),c=e.ref([]),r=e.computed({get:()=>!!n.value.length,set:b=>{b?g():c.value.forEach(V=>V.Deleted=!0)}}),g=()=>c.value.push({}),x=_,C=()=>{A.accessibility("getApplication",{ID:B.id}).subscribe(b=>{d.value=b.Project,N.value=b.Contacts,c.value=b.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,I().init("accessibility",d.value),s.value=d.value.changeApply,d.value.changeApply=void 0})},p=b=>b.Deleted=!0,o=b=>{var m,i;if(l.value={},b&&!y()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const V={Project:d.value,Contacts:N.value,ReceivedSubsidies:c.value.filter(t=>t.ID||!t.Deleted),Before:(m=s.value)==null?void 0:m.Form1Before,After:(i=s.value)==null?void 0:i.Form1After,Submit:b?"true":"false"};A.accessibility("saveApplication",V).subscribe(t=>{b?x("next",t.ID):d.value.ID?C():window.location.href=`Application.aspx?ID=${t.ID}`})},y=()=>{let b={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value.OrgCategory==="2"&&(b.RegisteredNum="立案登記證字號"),l.value=O(d.value,b),b={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((V,m)=>Object.assign(l.value,O(V,b,`contact-${m}-`))),b={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},c.value.forEach((V,m)=>Object.assign(l.value,O(V,b,`received-${m}-`))),s.value&&(b={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(s.value,b))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(b=>{E.value=b[0],B.id?C():A.accessibility("getEmptyApplication").subscribe(V=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},V),N.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("accessibility",d.value)})})}),e.provide("editable",a),(b,V)=>{const m=e.resolveComponent("required-label"),i=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),f=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-boolean"),U=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ge,[V[42]||(V[42]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ye,[e.createElementVNode("table",ue,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[V[15]||(V[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[V[16]||(V[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",xe,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Be,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[V[17]||(V[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[18]||(V[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":V[0]||(V[0]=w=>e.unref(d).ProjectName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[19]||(V[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":V[1]||(V[1]=w=>e.unref(d).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[20]||(V[20]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",he,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":V[2]||(V[2]=w=>e.unref(d).OrgCategory=w)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",$e,[e.createVNode(i,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":V[3]||(V[3]=w=>e.unref(d).RegisteredNum=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[21]||(V[21]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":V[4]||(V[4]=w=>e.unref(d).TaxID=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[22]||(V[22]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":V[5]||(V[5]=w=>e.unref(d).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),V[43]||(V[43]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ce,[e.createElementVNode("table",_e,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Te,[e.createElementVNode("div",we,[e.createElementVNode("div",De,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[23]||(V[23]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(l)[`contact-${S}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fe,[e.createElementVNode("div",Se,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[24]||(V[24]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(l)[`contact-${S}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ae,[V[25]||(V[25]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ue,[e.createElementVNode("div",Me,[e.createVNode(i,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Oe,[e.createVNode(i,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",je,[e.createElementVNode("div",Ie,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[26]||(V[26]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(l)[`contact-${S}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Pe,[e.createElementVNode("div",qe,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[27]||(V[27]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(l)[`contact-${S}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),V[44]||(V[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Le,[e.createElementVNode("table",Re,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[28]||(V[28]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[V[29]||(V[29]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(f,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":V[6]||(V[6]=w=>e.unref(d).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[30]||(V[30]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":V[7]||(V[7]=w=>e.unref(d).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[31]||(V[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":V[8]||(V[8]=w=>e.unref(d).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[32]||(V[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":V[9]||(V[9]=w=>e.unref(d).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ze,[e.createElementVNode("table",Ge,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[V[38]||(V[38]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(k,{modelValue:e.unref(r),"onUpdate:modelValue":V[10]||(V[10]=w=>e.isRef(r)?r.value=w:null)},null,8,["modelValue"]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Je,[e.createElementVNode("table",Qe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[V[33]||(V[33]=e.createElementVNode("th",null,"計畫名稱",-1)),V[34]||(V[34]=e.createElementVNode("th",null,"補助單位",-1)),V[35]||(V[35]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",We,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l)[`received-${S}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l)[`received-${S}-Unit`],modelValue:w.Unit,"onUpdate:modelValue":M=>w.Unit=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${S}-Amount`],modelValue:w.Amount,"onUpdate:modelValue":M=>w.Amount=M},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Ye,[e.createElementVNode("div",He,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>p(w),type:"button"},[...V[36]||(V[36]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ke)):e.createCommentVNode("",!0),S+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...V[37]||(V[37]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[V[41]||(V[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ze,[e.createElementVNode("table",Xe,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[39]||(V[39]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":V[11]||(V[11]=w=>e.unref(s).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[40]||(V[40]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":V[12]||(V[12]=w=>e.unref(s).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",ve,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:V[13]||(V[13]=w=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:V[14]||(V[14]=w=>o(!0)),type:"button"},[...V[45]||(V[45]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},tt={class:"block"},lt={key:0,class:"text-pink lh-base mt-4"},ot={class:"mt-4"},nt={class:"table align-middle gray-table"},rt={class:"text-center"},at={key:0,width:"180"},dt={class:"text-center"},st={key:0},ct=["innerHTML"],mt=["href"],it={key:0,class:"text-center"},pt={key:0},Vt={key:1,class:"text-pink"},ft={key:1,class:"tag-group mt-2 gap-1"},Nt={key:0,class:"tag tag-green-light"},Et=["download","href"],bt=["onClick"],kt={class:"mt-4"},gt={class:"table align-middle gray-table side-table"},yt={key:0,class:"block-bottom bg-light-teal"},ut=["disabled"],xt={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([{Type:1,Title:"申請表",Template:"../../Template/ACC/附件01-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/ACC/附件02-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/ACC/附件03-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/ACC/附件04-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),N=e.computed(()=>E.value.some(p=>!p.Optional&&!p.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("accessibility",n.value.Status,2)),l=e.ref({}),n=e.ref({}),d=(p,o)=>{o.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:o.Path,Name:n.value.ProjectID+"_"+(p.Multiple?o.Name:`${p.Title}.pdf`)})},c=A.download,r=_,g=()=>{rxjs.forkJoin([A.accessibility("getAttachment",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=E.value.filter(y=>{var b;return!((b=y.Excludes)!=null&&b.includes(n.value.OrgCategory))}),E.value.forEach(y=>{y.Files=o.Attachments.filter(b=>b.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(b=>!b.Deleted).length)}),I().init("accessibility",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},x=p=>{var y,b;if(l.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:B.id,Attachments:E.value.reduce((V,m)=>V.concat(m.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(b=s.value)==null?void 0:b.Form5After,Submit:p?"true":"false"};A.accessibility("saveAttachment",o).subscribe(()=>{p?r("next"):g()})},C=()=>{if(s.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(s.value,p))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(p,o)=>{const y=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),V=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",tt,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",lt,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ot,[e.createElementVNode("table",nt,[e.createElementVNode("thead",rt,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",at,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",dt,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",st,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,ct)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,mt)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",it,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",pt,"已上傳")):(e.openBlock(),e.createElementBlock("span",Vt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>d(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",ft,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Nt,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,Et),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:f=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,bt)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",kt,[e.createElementVNode("table",gt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(s).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",yt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>x(!0)),disabled:e.unref(N),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ut)])):e.createCommentVNode("",!0)],64)}}},Bt={class:"block"},ht={class:"mt-4"},$t={class:"table-responsive mt-3 mb-0"},Ct={class:"table align-middle gray-table"},_t={key:0,width:"1"},Tt={key:0},wt={class:"d-flex gap-2"},Dt=["onClick"],Ft={class:"table-responsive mt-3 mb-0"},St={class:"table align-middle gray-table"},At={class:"mt-4"},Ut={class:"table align-middle gray-table side-table"},Mt={key:0,class:"block-bottom bg-light-teal"},Ot={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.computed(()=>z("accessibility",n.value.Status,4)),a=e.ref({}),l=e.computed(()=>E.value.filter(p=>!p.Deleted)),n=e.ref({}),d=()=>E.value.push({}),c=_,r=()=>{rxjs.forkJoin([A.accessibility("getBenefit",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=o.Benefits,E.value.length||d(),I().init("accessibility",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},g=p=>p.Deleted=!0,x=p=>{var y,b;if(a.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:n.value,Benefits:E.value,Before:(y=s.value)==null?void 0:y.Form4Before,After:(b=s.value)==null?void 0:b.Form4After,Submit:p?"true":"false"};A.accessibility("saveBenefit",o).subscribe(()=>{p?c("next"):r()})},C=()=>{let p={Benefit:"不可量化成果"};return a.value=O(n.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((o,y)=>Object.assign(a.value,O(o,p,`item-${y}-`))),s.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,O(s.value,p))),!Object.keys(a.value).length};return e.onMounted(r),e.provide("editable",N),(p,o)=>{const y=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),V=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Bt,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",ht,[e.createElementVNode("div",$t,[e.createElementVNode("table",Ct,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"目標值",-1)),o[7]||(o[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",_t,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${i}-Title`],modelValue:m.Title,"onUpdate:modelValue":t=>m.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${i}-Target`],modelValue:m.Target,"onUpdate:modelValue":t=>m.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a)[`item-${i}-Description`],rows:"1",modelValue:m.Description,"onUpdate:modelValue":t=>m.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Tt,[e.createElementVNode("div",wt,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>g(m),type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Dt)):e.createCommentVNode("",!0),i+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Ft,[e.createElementVNode("table",St,[o[10]||(o[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(n).Benefit=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",At,[e.createElementVNode("table",Ut,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form4Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":o[2]||(o[2]=m=>e.unref(s).Form4After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",Mt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[3]||(o[3]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[4]||(o[4]=m=>x(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},jt={class:"block"},It={class:"mt-4"},Pt={class:"table-responsive mt-3 mb-0"},qt={class:"table align-middle gray-table"},Lt={class:"text-end"},Rt={class:"text-end"},zt={class:"table-responsive"},Gt={class:"table align-middle gray-table"},Jt=["colspan"],Qt={key:0,width:"1"},Wt={class:"text-end"},Yt={key:0},Ht={class:"d-flex gap-2"},Kt=["onClick"],Zt={class:"mt-4"},Xt={class:"table-responsive mt-3 mb-0"},vt={class:"table align-middle gray-table"},el={key:0,width:"1"},tl={class:"text-end"},ll={key:0},ol={class:"d-flex gap-2"},nl=["onClick"],rl={class:"mt-4"},al={class:"table align-middle gray-table side-table"},dl={key:0,class:"block-bottom bg-light-teal"},sl={class:"text-center"},cl={class:"mb-5"},ml={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.computed(()=>z("accessibility",n.value.Status,3)),N=e.ref({}),a=e.computed(()=>c.value.filter(i=>!i.Deleted)),l=e.computed(()=>r.value.filter(i=>!i.Deleted)),n=e.ref({}),d=e.ref(),c=e.ref([]),r=e.ref([]),g=e.ref({}),x=e.ref(0),C=()=>c.value.push({}),p=()=>r.value.push({}),o=_,y=()=>{rxjs.forkJoin([A.accessibility("getFunding",{ID:B.id})]).subscribe(i=>{const t=i[0];n.value=t.Project,c.value=t.OtherSubsidies,r.value=t.BudgetPlans,g.value=t.GrantTargetSetting,c.value.length||C(),r.value.length||p(),I().init("accessibility",n.value),E.value=n.value.changeApply,n.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=(i,t)=>{var k,U;if(N.value={},i&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&n.value.ApplyAmount>g.value.GrantLimit*1e4){d.value.show(()=>V(i,!0));return}const f={Project:n.value,OtherSubsidies:c.value,BudgetPlans:r.value,Before:(k=E.value)==null?void 0:k.Form3Before,After:(U=E.value)==null?void 0:U.Form3After,Submit:i?"true":"false"};A.accessibility("saveFunding",f).subscribe(()=>{i?o("next"):y()})},m=()=>{let i={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=O(n.value,i),i={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},c.value.forEach((t,f)=>Object.assign(N.value,O(t,i,`other-${f}-`))),i={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,f)=>Object.assign(N.value,O(t,i,`plan-${f}-`))),E.value&&(i={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,O(E.value,i))),!Object.keys(N.value).length};return e.onMounted(y),e.provide("editable",s),e.watchEffect(()=>{n.value.OtherAmount=a.value.reduce((i,t)=>i+R(t.Amount),0),x.value=R(n.value.ApplyAmount)+R(n.value.SelfAmount)+R(n.value.OtherAmount),a.value.forEach(i=>i.percent=Math.round(R(i.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(i=>i.sum=R(i.Amount)+R(i.OtherAmount))}),(i,t)=>{var M;const f=e.resolveComponent("input-integer"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),S=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",jt,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",It,[e.createElementVNode("div",Pt,[e.createElementVNode("table",qt,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(n).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(n).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Lt,e.toDisplayString((M=e.unref(n).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Rt,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",zt,[e.createElementVNode("table",Gt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Jt)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",Qt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,h)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(N)[`other-${h}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":T=>F.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`other-${h}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Wt,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`other-${h}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":T=>F.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",Yt,[e.createElementVNode("div",Ht,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>b(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Kt)):e.createCommentVNode("",!0),h+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Zt,[e.createElementVNode("div",Xt,[e.createElementVNode("table",vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",el,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(F,h)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(N)[`plan-${h}-Title`],modelValue:F.Title,"onUpdate:modelValue":T=>F.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`plan-${h}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`plan-${h}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":T=>F.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",tl,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`plan-${h}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":T=>F.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",ll,[e.createElementVNode("div",ol,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>b(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nl)):e.createCommentVNode("",!0),h+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",rl,[e.createElementVNode("table",al,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(E).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(E).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(E).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(E).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",dl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>V(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(S,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",sl,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",cl,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(g).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},il={class:"block"},pl={class:"text-teal fw-bold py-3"},Vl={class:"table-responsive"},fl={class:"table align-middle gray-table"},Nl={class:"text-end"},El={class:"text-end"},bl={class:"mt-4"},kl={class:"table align-middle gray-table"},gl={class:"text-center"},yl={key:0,width:"180"},ul={class:"text-center"},xl=["href"],Bl={key:0,class:"text-center"},hl={key:0},$l={key:1,class:"text-pink"},Cl={key:1,class:"tag-group mt-2 gap-1"},_l={key:0,class:"tag tag-green-light"},Tl=["download","href"],wl=["onClick"],Dl={class:"block-bottom bg-light-teal"},Fl=!0,Sl={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(0),s=e.ref({}),N=e.ref([{Type:1,Title:"領據",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_第一期請款_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.accessibility("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("accessibility",s.value),N.value=N.value.filter(r=>{var g;return!((g=r.Excludes)!=null&&g.includes(s.value.OrgCategory))}),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",Fl),(c,r)=>{var p;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",il,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",pl,"核定經費: "+e.toDisplayString((p=e.unref(s).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("div",Vl,[e.createElementVNode("table",fl,[r[5]||(r[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Nl,e.toDisplayString(e.unref(E)),1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=o=>e.isRef(E)?E.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",El,e.toDisplayString(e.unref(a))+"%",1),r[4]||(r[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",bl,[e.createElementVNode("table",kl,[e.createElementVNode("thead",gl,[e.createElementVNode("tr",null,[r[6]||(r[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[7]||(r[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",yl,"狀態")),r[8]||(r[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(o,y)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",ul,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,xl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Bl,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",hl,"已上傳")):(e.openBlock(),e.createElementBlock("span",$l,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Cl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",_l,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(n)(b.Path)},e.toDisplayString(b.Name),9,Tl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>b.Deleted=!0,type:"button"},[...r[10]||(r[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,wl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Dl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=o=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=o=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Al={class:"block"},Ul={class:"text-teal fw-bold py-3"},Ml={class:"text-teal fw-bold pb-3"},Ol={class:"table-responsive"},jl={class:"table align-middle gray-table"},Il={class:"text-end"},Pl={class:"text-end"},ql={class:"mt-4"},Ll={class:"table align-middle gray-table"},Rl={class:"text-center"},zl={key:0,width:"180"},Gl={class:"text-center"},Jl=["href"],Ql={key:0,class:"text-center"},Wl={key:0},Yl={key:1,class:"text-pink"},Hl={key:1,class:"tag-group mt-2 gap-1"},Kl={key:0,class:"tag tag-green-light"},Zl=["download","href"],Xl=["onClick"],vl={class:"block-bottom bg-light-teal"},eo=!0,ee=3e4,to={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(3e4),s=e.ref({}),N=e.ref([{Type:1,Title:"領據",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/ACC/1-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/ACC/2-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/ACC/3-補助清單.docx",Files:[]},{Type:5,Title:"其他",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_第二期請款_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.accessibility("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("accessibility",s.value),N.value=N.value.filter(r=>{var g;return!((g=r.Excludes)!=null&&g.includes(s.value.OrgCategory))}),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",eo),(c,r)=>{var p;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Al,[r[10]||(r[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",Ul,"核定經費: "+e.toDisplayString((p=e.unref(s).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("p",Ml,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(E)).toLocaleString())+"元",1),e.createElementVNode("div",Ol,[e.createElementVNode("table",jl,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Il,e.toDisplayString(e.unref(E)-ee),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(ee)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=o=>e.isRef(E)?E.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",Pl,e.toDisplayString(e.unref(a))+"%",1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[12]||(r[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",ql,[e.createElementVNode("table",Ll,[e.createElementVNode("thead",Rl,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",zl,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(o,y)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Gl,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Jl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Ql,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Wl,"已上傳")):(e.openBlock(),e.createElementBlock("span",Yl,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Hl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Kl,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(n)(b.Path)},e.toDisplayString(b.Name),9,Zl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>b.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",vl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=o=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=o=>d()),type:"button"},[...r[13]||(r[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},lo={__name:"ProgressBar",setup(u){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(B,E)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"accessibility"})}}},oo={class:"block"},no={class:"mt-4"},ro={class:"table align-middle gray-table side-table"},ao={key:0,class:"d-flex align-items-center gap-2"},so={class:"input-group w-auto"},co={class:"text-teal-dark"},mo={key:1,class:"invalid mt-0"},io={class:"table-responsive mt-4"},po={class:"table align-middle gray-table"},Vo={key:0},fo={class:"input-group"},No={key:0,class:"invalid mt-0"},Eo={key:0},bo={class:"d-flex gap-2"},ko=["onClick"],go={class:"mt-4"},yo={class:"table align-middle gray-table"},uo={key:0},xo=["value"],Bo={key:0},ho={class:"d-flex gap-2"},$o=["onClick"],Co={class:"mt-4"},_o={class:"table align-middle gray-table side-table"},To={key:0,class:"block-bottom bg-light-teal"},wo={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),N=e.computed(()=>r.value.EndDate),a=e.computed(()=>z("accessibility",c.value.Status,2)),l=e.ref({}),n=e.computed(()=>g.value.filter(i=>!i.Deleted)),d=e.computed(()=>x.value.filter(i=>!i.Deleted)),c=e.ref({}),r=e.ref({}),g=e.ref([]),x=e.ref([]),C=()=>A.accessibility("createItem",{ID:B.id}).subscribe(i=>g.value.push(i)),p=()=>x.value.push({Type:0,ItemID:0}),o=_,y=()=>{rxjs.forkJoin([A.accessibility("getWorkSchedule",{ID:B.id})]).subscribe(i=>{const t=i[0];c.value=t.Project,r.value=t.GrantType,g.value=t.Items,x.value=t.Schedules,g.value.length||C(),x.value.length||p(),I().init("accessibility",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=i=>{var f,k;if(l.value={},i&&!m()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:c.value,Items:g.value,Schedules:x.value,Before:(f=s.value)==null?void 0:f.Form2Before,After:(k=s.value)==null?void 0:k.Form2After,Submit:i?"true":"false"};A.accessibility("saveWorkSchedule",t).subscribe(()=>{i?o("next"):y()})},m=()=>{let i={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(c.value,i),i={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},n.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`item-${f}-`))),i={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`schedule-${f}-`))),s.value&&(i={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(s.value,i))),!Object.keys(l.value).length};return e.onMounted(y),e.provide("editable",a),(i,t)=>{const f=e.resolveComponent("required-label"),k=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oo,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",no,[e.createElementVNode("table",ro,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",ao,[e.createElementVNode("div",so,[e.createVNode(k,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[0]||(t[0]=h=>e.unref(c).StartTime=h)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[1]||(t[1]=h=>e.unref(c).EndTime=h)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",co,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(N)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",mo,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",io,[e.createElementVNode("table",po,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Vo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`item-${T}-Title`],modelValue:h.Title,"onUpdate:modelValue":D=>h.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",fo,[e.createVNode(S,{"empty-value":0,modelValue:h.Begin,"onUpdate:modelValue":D=>h.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(S,{"empty-value":0,modelValue:h.End,"onUpdate:modelValue":D=>h.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${T}-Begin`]||e.unref(l)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",No,e.toDisplayString(e.unref(l)[`item-${T}-Begin`]||e.unref(l)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`item-${T}-Deadline`],modelValue:h.Deadline,"onUpdate:modelValue":D=>h.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`item-${T}-Content`],rows:"1",modelValue:h.Content,"onUpdate:modelValue":D=>h.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Eo,[e.createElementVNode("div",bo,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(h),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ko)):e.createCommentVNode("",!0),T+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",go,[e.createElementVNode("table",yo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",uo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${T}-Type`],options:E,modelValue:h.Type,"onUpdate:modelValue":D=>h.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${T}-ItemID`],options:e.unref(n),modelValue:h.ItemID,"onUpdate:modelValue":D=>h.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:j})=>[e.createElementVNode("option",{value:j.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(j.Title),9,xo)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`schedule-${T}-Deadline`],modelValue:h.Deadline,"onUpdate:modelValue":D=>h.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`schedule-${T}-Content`],rows:"1",modelValue:h.Content,"onUpdate:modelValue":D=>h.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Bo,[e.createElementVNode("div",ho,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(h),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,$o)):e.createCommentVNode("",!0),T+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Co,[e.createElementVNode("table",_o,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=h=>e.unref(s).Form2Before=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=h=>e.unref(s).Form2After=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",To,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=h=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=h=>V(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Do={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Fo={class:"modal-content"},So={class:"modal-body"},Ao={class:"d-flex justify-content-center mt-4 gap-4"},Uo={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Mo={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(u,{expose:_}){let B;const E=e.ref(),s=u,N=()=>{B&&B()};return _({show:l=>{B=l,bootstrap.Modal.getOrCreateInstance(E.value).show()}}),(l,n)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",Do,[e.createElementVNode("div",Fo,[n[0]||(n[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",So,[e.renderSlot(l.$slots,"default"),e.createElementVNode("div",Ao,[e.createElementVNode("button",Uo,e.toDisplayString(s.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:N,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(s.confirm),1)])])])])],512)]))}},Oo={class:"application-step"},jo=["onClick"],Io={class:"step-content"},Po={class:"step-label"},qo={key:0,class:"step-status edit"},Lo={key:1,class:"step-status"},Ro={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(u,{emit:_}){const B=e.computed(()=>z(s.type,E[s.type].status,s.step)),E=I(),s=u,N=l=>{s.review?a("click",l.step):l.step<=E[s.type].step&&(location.href=`${l.url}.aspx?ID=${s.id}`)},a=_;return(l,n)=>(e.openBlock(),e.createElementBlock("div",Oo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.steps,d=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(B)&&(d.step<e.unref(E)[u.type].step||d.step===u.step)}]),onClick:c=>N(d),key:d,role:"button"},[e.createElementVNode("div",Io,[e.createElementVNode("div",Po,e.toDisplayString(d.title),1),e.unref(B)&&d.step===u.step?(e.openBlock(),e.createElementBlock("div",qo,"編輯中")):d.step<e.unref(E)[u.type].step?(e.openBlock(),e.createElementBlock("div",Lo,"已完成")):e.createCommentVNode("",!0)])],10,jo))),128))]))}},zo={class:"block"},Go={class:"mt-4"},Jo={class:"table align-middle gray-table side-table"},Qo={key:0},Wo={key:1,class:"text-light-gray"},Yo={class:"d-flex gap-2"},Ho={key:0,class:"invalid mt-0"},Ko={class:"d-flex flex-column gap-2"},Zo={key:0},Xo={class:"mt-4"},vo={class:"table align-middle gray-table side-table"},en={class:"row g-3"},tn={class:"col-12 col-xl-2"},ln={class:"text-gray mb-2"},on={class:"col-12 col-xl-3"},nn={class:"text-gray mb-2"},rn={class:"col-12 col-xl-4"},an={class:"row g-1"},dn={class:"col-7"},sn={class:"col-5"},cn={class:"col-12 col-xl-3"},mn={class:"text-gray mb-2"},pn={class:"col-12"},Vn={class:"text-gray mb-2"},fn={class:"mt-4"},Nn={class:"table align-middle gray-table side-table"},En={class:"mt-4"},bn={class:"table align-middle gray-table side-table"},kn={key:0,class:"table-responsive mt-3 mb-0"},gn={class:"table align-middle gray-table"},yn={key:0},un={key:0},xn={class:"d-flex gap-2"},Bn=["onClick"],hn={class:"mt-4"},$n={class:"table align-middle gray-table side-table"},Cn={key:0,class:"block-bottom bg-light-teal"},_n={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.ref(),a=e.computed(()=>z("culture",r.value.Status,1)),l=e.ref({}),n=e.ref(null),d=e.ref([]),c=e.computed(()=>x.value.filter(t=>!t.Deleted)),r=e.ref({}),g=e.computed(()=>d.value.filter(t=>!t.ParentCode)),x=e.ref([]),C=e.computed(()=>d.value.filter(t=>t.ParentCode===n.value)),p=e.computed({get:()=>!!c.value.length,set:t=>{t?o():x.value.forEach(f=>f.Deleted=!0)}}),o=()=>x.value.push({}),y=_,b=()=>{A.culture("getApplication",{ID:B.id}).subscribe(t=>{var f;r.value=t.Project,N.value=t.Contacts,x.value=t.ReceivedSubsidies,n.value=((f=d.value.find(k=>k.Code===r.value.Field))==null?void 0:f.ParentCode)||null,r.value.OrgCategory=r.value.OrgCategory||null,I().init("culture",r.value),s.value=r.value.changeApply,r.value.changeApply=void 0})},V=t=>t.Deleted=!0,m=t=>{var k,U;if(l.value={},t&&!i()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:r.value,Contacts:N.value,ReceivedSubsidies:x.value.filter(w=>w.ID||!w.Deleted),Before:(k=s.value)==null?void 0:k.Form1Before,After:(U=s.value)==null?void 0:U.Form1After,Submit:t?"true":"false"};A.culture("saveApplication",f).subscribe(w=>{t?y("next",w.ID):r.value.ID?b():window.location.href=`Application.aspx?ID=${w.ID}`})},i=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return r.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),l.value=O(r.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((f,k)=>Object.assign(l.value,O(f,t,`contact-${k}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},x.value.forEach((f,k)=>Object.assign(l.value,O(f,t,`received-${k}-`))),s.value&&(t={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(s.value,t))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.culture("getZgsCodes",{CodeGroup:"CULField"}),A.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{d.value=t[0],E.value=t[1],B.id?b():A.culture("getEmptyApplication").subscribe(f=>{n.value=null,r.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},f),N.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("culture",r.value)})})}),e.provide("editable",a),e.watch(n,()=>{n.value?C.value.find(t=>r.value.Field===t.Code)||(r.value.Field=C.value[0].Code):r.value.Field=null}),(t,f)=>{const k=e.resolveComponent("required-label"),U=e.resolveComponent("input-text"),w=e.resolveComponent("input-select"),S=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-boolean"),F=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zo,[f[45]||(f[45]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Go,[e.createElementVNode("table",Jo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[f[17]||(f[17]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).Year),1)]),e.createElementVNode("tr",null,[f[18]||(f[18]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(r).ProjectID?(e.openBlock(),e.createElementBlock("span",Qo,e.toDisplayString(e.unref(r).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Wo,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[f[19]||(f[19]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[20]||(f[20]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).ProjectName,modelValue:e.unref(r).ProjectName,"onUpdate:modelValue":f[0]||(f[0]=h=>e.unref(r).ProjectName=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[21]||(f[21]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Yo,[e.createVNode(w,{"empty-value":null,options:e.unref(g),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n),"onUpdate:modelValue":f[1]||(f[1]=h=>e.isRef(n)?n.value=h:null)},null,8,["options","modelValue"]),e.createVNode(w,{"empty-value":null,disabled:!e.unref(n),options:e.unref(C),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).Field,"onUpdate:modelValue":f[2]||(f[2]=h=>e.unref(r).Field=h)},null,8,["disabled","options","modelValue"])]),e.unref(l).Field?(e.openBlock(),e.createElementBlock("div",Ho,e.toDisplayString(e.unref(l).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[22]||(f[22]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(r).OrgName,"onUpdate:modelValue":f[3]||(f[3]=h=>e.unref(r).OrgName=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[23]||(f[23]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ko,[e.createElementVNode("div",null,[e.createVNode(w,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).OrgCategory,"onUpdate:modelValue":f[4]||(f[4]=h=>e.unref(r).OrgCategory=h)},null,8,["error","options","modelValue"])]),e.unref(r).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Zo,[e.createVNode(U,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(r).RegisteredNum,"onUpdate:modelValue":f[5]||(f[5]=h=>e.unref(r).RegisteredNum=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[24]||(f[24]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(r).TaxID,"onUpdate:modelValue":f[6]||(f[6]=h=>e.unref(r).TaxID=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[25]||(f[25]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(r).Address,"onUpdate:modelValue":f[7]||(f[7]=h=>e.unref(r).Address=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),f[46]||(f[46]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Xo,[e.createElementVNode("table",vo,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(h.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",en,[e.createElementVNode("div",tn,[e.createElementVNode("div",ln,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[26]||(f[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${T}-Name`],modelValue:h.Name,"onUpdate:modelValue":D=>h.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",on,[e.createElementVNode("div",nn,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[27]||(f[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${T}-JobTitle`],modelValue:h.JobTitle,"onUpdate:modelValue":D=>h.JobTitle=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rn,[f[28]||(f[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",an,[e.createElementVNode("div",dn,[e.createVNode(U,{modelValue:h.Phone,"onUpdate:modelValue":D=>h.Phone=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",sn,[e.createVNode(U,{placeholder:"請輸入分機",size:"4",modelValue:h.PhoneExt,"onUpdate:modelValue":D=>h.PhoneExt=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",cn,[e.createElementVNode("div",mn,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[29]||(f[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${T}-MobilePhone`],modelValue:h.MobilePhone,"onUpdate:modelValue":D=>h.MobilePhone=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",pn,[e.createElementVNode("div",Vn,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[30]||(f[30]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${T}-EMail`],modelValue:h.EMail,"onUpdate:modelValue":D=>h.EMail=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),f[47]||(f[47]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",fn,[e.createElementVNode("table",Nn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[31]||(f[31]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[f[32]||(f[32]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(S,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(r).Target,"onUpdate:modelValue":f[8]||(f[8]=h=>e.unref(r).Target=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[33]||(f[33]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(r).Summary,"onUpdate:modelValue":f[9]||(f[9]=h=>e.unref(r).Summary=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[34]||(f[34]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Quantified,"onUpdate:modelValue":f[10]||(f[10]=h=>e.unref(r).Quantified=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[35]||(f[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Qualitative,"onUpdate:modelValue":f[11]||(f[11]=h=>e.unref(r).Qualitative=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",En,[e.createElementVNode("table",bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[f[41]||(f[41]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(M,{modelValue:e.unref(p),"onUpdate:modelValue":f[12]||(f[12]=h=>e.isRef(p)?p.value=h:null)},null,8,["modelValue"]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",kn,[e.createElementVNode("table",gn,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[36]||(f[36]=e.createElementVNode("th",null,"計畫名稱",-1)),f[37]||(f[37]=e.createElementVNode("th",null,"補助單位",-1)),f[38]||(f[38]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",yn,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${T}-Name`],modelValue:h.Name,"onUpdate:modelValue":D=>h.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${T}-Unit`],modelValue:h.Unit,"onUpdate:modelValue":D=>h.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l)[`received-${T}-Amount`],modelValue:h.Amount,"onUpdate:modelValue":D=>h.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",un,[e.createElementVNode("div",xn,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>V(h),type:"button"},[...f[39]||(f[39]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bn)):e.createCommentVNode("",!0),T+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...f[40]||(f[40]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[f[44]||(f[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",hn,[e.createElementVNode("table",$n,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[42]||(f[42]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":f[13]||(f[13]=h=>e.unref(s).Form1Before=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[43]||(f[43]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":f[14]||(f[14]=h=>e.unref(s).Form1After=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Cn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[15]||(f[15]=h=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[16]||(f[16]=h=>m(!0)),type:"button"},[...f[48]||(f[48]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Tn={class:"block"},wn={key:0,class:"text-pink lh-base mt-4"},Dn={class:"mt-4"},Fn={class:"table align-middle gray-table"},Sn={class:"text-center"},An={key:0,width:"180"},Un={class:"text-center"},Mn={key:0},On=["innerHTML"],jn=["href"],In={key:0,class:"text-center"},Pn={key:0},qn={key:1,class:"text-pink"},Ln={key:1,class:"tag-group mt-2 gap-1"},Rn={key:0,class:"tag tag-green-light"},zn=["download","href"],Gn=["onClick"],Jn={class:"mt-4"},Qn={class:"table align-middle gray-table side-table"},Wn={key:0,class:"block-bottom bg-light-teal"},Yn=["disabled"],Hn={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([{Type:1,Title:"申請表",Template:"../../Template/CUL/1.申請表.docx",Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:"../../Template/CUL/2.計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/CUL/3.執行承諾書.docx",Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:"../../Template/CUL/4.未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),s=e.ref(),N=e.computed(()=>E.value.some(p=>!p.Optional&&!p.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("culture",n.value.Status,5)),l=e.ref({}),n=e.ref({}),d=(p,o)=>{o.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:o.Path,Name:n.value.ProjectID+"_"+(p.Multiple?o.Name:`${p.Title}.pdf`)})},c=A.download,r=_,g=()=>{rxjs.forkJoin([A.culture("getAttachment",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=E.value.filter(y=>{var b;return!((b=y.Excludes)!=null&&b.includes(n.value.OrgCategory))}),n.value.Status>=42&&E.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]}),E.value.forEach(y=>{y.Files=o.Attachments.filter(b=>b.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(b=>!b.Deleted).length)}),I().init("culture",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},x=p=>{var y,b;if(l.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:B.id,Attachments:E.value.reduce((V,m)=>V.concat(m.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(b=s.value)==null?void 0:b.Form5After,Submit:p?"true":"false"};A.culture("saveAttachment",o).subscribe(()=>{p?r("next"):g()})},C=()=>{if(s.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(s.value,p))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(p,o)=>{const y=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),V=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Tn,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",wn,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Dn,[e.createElementVNode("table",Fn,[e.createElementVNode("thead",Sn,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",An,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",Un,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",Mn,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,On)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,jn)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",In,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",Pn,"已上傳")):(e.openBlock(),e.createElementBlock("span",qn,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>d(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Ln,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Rn,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,zn),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:f=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Gn)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Jn,[e.createElementVNode("table",Qn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(s).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Wn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>x(!0)),disabled:e.unref(N),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Yn)])):e.createCommentVNode("",!0)],64)}}},Kn={class:"block"},Zn={class:"mt-4"},Xn={class:"table-responsive mt-3 mb-0"},vn={class:"table align-middle gray-table"},er={class:"text-end"},tr={class:"text-end"},lr={class:"table-responsive"},or={class:"table align-middle gray-table"},nr=["colspan"],rr={key:0,width:"1"},ar={key:0},dr={class:"d-flex gap-2"},sr=["onClick"],cr={class:"mt-4"},mr={class:"table-responsive mt-3 mb-0"},ir={class:"table align-middle gray-table"},pr={key:0,width:"1"},Vr={class:"text-end"},fr={key:0},Nr={class:"d-flex gap-2"},Er=["onClick"],br={class:"mt-4"},kr={class:"table align-middle gray-table side-table"},gr={key:0,class:"block-bottom bg-light-teal"},yr={class:"text-center"},ur={class:"mb-5"},xr={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.computed(()=>z("culture",n.value.Status,3)),N=e.ref({}),a=e.computed(()=>r.value.filter(f=>!f.Deleted)),l=e.computed(()=>g.value.filter(f=>!f.Deleted)),n=e.ref({}),d=e.ref([]),c=e.ref(),r=e.ref([]),g=e.ref([]),x=e.ref({}),C=e.ref(0),p=()=>r.value.push({}),o=()=>g.value.push({ItemID:0}),y=_,b=()=>{rxjs.forkJoin([A.culture("getFunding",{ID:B.id})]).subscribe(f=>{const k=f[0];n.value=k.Project,r.value=k.OtherSubsidies,g.value=k.BudgetPlans,d.value=k.Items,x.value=k.GrantTargetSetting,r.value.length||p(),g.value.length||o(),I().init("culture",n.value),E.value=n.value.changeApply,n.value.changeApply=void 0})},V=f=>f.Deleted=!0,m=f=>f.Deleted=!0,i=(f,k)=>{var w,S;if(N.value={},f&&!t()){e.nextTick(()=>{var M;return(M=document.querySelector(".invalid"))==null?void 0:M.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!k&&n.value.ApplyAmount>x.value.GrantLimit*1e4){c.value.show(()=>i(f,!0));return}const U={Project:n.value,OtherSubsidies:r.value,BudgetPlans:g.value,Before:(w=E.value)==null?void 0:w.Form3Before,After:(S=E.value)==null?void 0:S.Form3After,Submit:f?"true":"false"};A.culture("saveFunding",U).subscribe(()=>{f?y("next"):b()})},t=()=>{let f={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=O(n.value,f),f={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},r.value.forEach((k,U)=>Object.assign(N.value,O(k,f,`other-${U}-`))),f={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},g.value.forEach((k,U)=>Object.assign(N.value,O(k,f,`plan-${U}-`))),E.value&&(f={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,O(E.value,f))),!Object.keys(N.value).length};return e.onMounted(b),e.provide("editable",s),e.watchEffect(()=>{n.value.OtherAmount=r.value.reduce((f,k)=>f+(k.Deleted?0:R(k.Amount)),0),C.value=R(n.value.ApplyAmount)+R(n.value.SelfAmount)+R(n.value.OtherAmount),g.value.forEach(f=>f.sum=R(f.Amount)+R(f.OtherAmount))}),(f,k)=>{var T;const U=e.resolveComponent("input-integer"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("required-label"),h=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kn,[k[25]||(k[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Zn,[e.createElementVNode("div",Xn,[e.createElementVNode("table",vn,[k[6]||(k[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":k[0]||(k[0]=D=>e.unref(n).ApplyAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":k[1]||(k[1]=D=>e.unref(n).SelfAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",er,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",tr,e.toDisplayString(e.unref(C).toLocaleString()),1)])])])]),k[12]||(k[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",lr,[e.createElementVNode("table",or,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,nr)]),e.createElementVNode("tr",null,[k[7]||(k[7]=e.createElementVNode("th",{width:"1"},null,-1)),k[8]||(k[8]=e.createElementVNode("th",null,"單位名稱",-1)),k[9]||(k[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",rr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(D,j)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,e.toDisplayString(j+1),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(N)[`other-${j}-Unit`],modelValue:D.Unit,"onUpdate:modelValue":P=>D.Unit=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`other-${j}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":P=>D.Amount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",ar,[e.createElementVNode("div",dr,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>V(D),type:"button"},[...k[10]||(k[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,sr)):e.createCommentVNode("",!0),j+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...k[11]||(k[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),k[26]||(k[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",cr,[e.createElementVNode("div",mr,[e.createElementVNode("table",ir,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[k[13]||(k[13]=e.createElementVNode("th",null,"重要工作項目",-1)),k[14]||(k[14]=e.createElementVNode("th",null,"預算項目",-1)),k[15]||(k[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),k[16]||(k[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),k[17]||(k[17]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),k[18]||(k[18]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",pr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(D,j)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(N)[`plan-${j}-ItemID`],options:e.unref(d),"text-name":"Title","value-name":"ID",modelValue:D.ItemID,"onUpdate:modelValue":P=>D.ItemID=P},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(N)[`plan-${j}-Title`],modelValue:D.Title,"onUpdate:modelValue":P=>D.Title=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`plan-${j}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":P=>D.Amount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`plan-${j}-OtherAmount`],modelValue:D.OtherAmount,"onUpdate:modelValue":P=>D.OtherAmount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Vr,e.toDisplayString(D.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(N)[`plan-${j}-Description`],rows:"1",modelValue:D.Description,"onUpdate:modelValue":P=>D.Description=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",fr,[e.createElementVNode("div",Nr,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>m(D),type:"button"},[...k[19]||(k[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Er)):e.createCommentVNode("",!0),j+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...k[20]||(k[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),k[21]||(k[21]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))]),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[k[24]||(k[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",br,[e.createElementVNode("table",kr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...k[22]||(k[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(E).Form3Before,"onUpdate:modelValue":k[2]||(k[2]=D=>e.unref(E).Form3Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...k[23]||(k[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(E).Form3After,"onUpdate:modelValue":k[3]||(k[3]=D=>e.unref(E).Form3After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",gr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[4]||(k[4]=D=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[5]||(k[5]=D=>i(!0)),type:"button"},[...k[27]||(k[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(h,{ref_key:"modal",ref:c},{default:e.withCtx(()=>[e.createElementVNode("div",yr,[k[28]||(k[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",ur,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(x).GrantLimit)+"萬",1),k[29]||(k[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),k[30]||(k[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Br={class:"block"},hr={key:0,class:"text-pink lh-base mt-3"},$r={class:"border"},Cr={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},_r={class:"d-flex gap-2 align-items-center flex-grow-1"},Tr={class:"text-nowrap"},wr={class:"flex-grow-1"},Dr={class:"d-flex gap-2"},Fr=["onClick"],Sr=["href"],Ar=["id"],Ur={class:"table align-middle gray-table side-table mb-0"},Mr={class:"mt-4"},Or={class:"table align-middle gray-table side-table"},jr={key:0,class:"block-bottom bg-light-teal"},Ir={__name:"Other",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.computed(()=>z("culture",a.value.Status,4)),N=e.ref({}),a=e.ref({}),l=e.ref([]),n=e.computed(()=>l.value.filter(p=>!p.Deleted)),d=()=>l.value.push({}),c=_,r=()=>{rxjs.forkJoin([A.culture("getRelatedProject",{ID:B.id})]).subscribe(p=>{const o=p[0];a.value=o.Project,l.value=o.Projects,I().init("culture",a.value),E.value=a.value.changeApply,a.value.changeApply=void 0})},g=p=>p.Deleted=!0,x=p=>{var y,b;if(N.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:B.id,Projects:l.value,Before:(y=E.value)==null?void 0:y.Form4Before,After:(b=E.value)==null?void 0:b.Form4After,Submit:p?"true":"false"};A.culture("saveRelatedProject",o).subscribe(()=>{p?c("next"):r()})},C=()=>{let p={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return n.value.forEach((o,y)=>Object.assign(N.value,O(o,p,`project-${y}-`))),E.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(N.value,O(E.value,p))),!Object.keys(N.value).length};return e.onMounted(r),e.provide("editable",s),(p,o)=>{const y=e.resolveComponent("required-label"),b=e.resolveComponent("input-text"),V=e.resolveComponent("input-integer"),m=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Br,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("p",hr," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(i,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:i},[e.createElementVNode("div",$r,[e.createElementVNode("div",Cr,[e.createElementVNode("div",_r,[e.createElementVNode("label",Tr,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[4]||(o[4]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",wr,[e.createVNode(b,{error:e.unref(N)[`project-${t}-Title`],modelValue:i.Title,"onUpdate:modelValue":f=>i.Title=f,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Dr,[e.unref(s)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(f=>g(i),["prevent"]),href:"#"},"刪除",8,Fr)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,Sr)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",Ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[5]||(o[5]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{class:"text-start w-auto",error:e.unref(N)[`project-${t}-Year`],modelValue:i.Year,"onUpdate:modelValue":f=>i.Year=f},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[6]||(o[6]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(N)[`project-${t}-OrgName`],modelValue:i.OrgName,"onUpdate:modelValue":f=>i.OrgName=f,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[7]||(o[7]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{class:"w-auto",error:e.unref(N)[`project-${t}-Amount`],modelValue:i.Amount,"onUpdate:modelValue":f=>i.Amount=f},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[8]||(o[8]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(N)[`project-${t}-Description`],rows:"4",modelValue:i.Description,"onUpdate:modelValue":f=>i.Description=f,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[9]||(o[9]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(N)[`project-${t}-Benefit`],rows:"4",modelValue:i.Benefit,"onUpdate:modelValue":f=>i.Benefit=f,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,Ar)])]))),128)),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:d,type:"button"},[...o[10]||(o[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Mr,[e.createElementVNode("table",Or,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(N).Form4Before,rows:"4",modelValue:e.unref(E).Form4Before,"onUpdate:modelValue":o[0]||(o[0]=i=>e.unref(E).Form4Before=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(N).Form4After,rows:"4",modelValue:e.unref(E).Form4After,"onUpdate:modelValue":o[1]||(o[1]=i=>e.unref(E).Form4After=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",jr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=i=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=i=>x(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Pr={class:"block"},qr={class:"text-teal fw-bold py-3"},Lr={class:"table-responsive"},Rr={class:"table align-middle gray-table"},zr={class:"text-end"},Gr={class:"text-end"},Jr={class:"mt-4"},Qr={class:"table align-middle gray-table"},Wr={class:"text-center"},Yr={key:0,width:"180"},Hr={class:"text-center"},Kr=["href"],Zr={key:0,class:"text-center"},Xr={key:0},vr={key:1,class:"text-pink"},ea={key:1,class:"tag-group mt-2 gap-1"},ta={key:0,class:"tag tag-green-light"},la=["download","href"],oa=["onClick"],na={class:"block-bottom bg-light-teal"},ra=!0,aa={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(0),s=e.ref({}),N=e.ref([{Type:1,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:2,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_第一期請款_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.culture("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("culture",s.value),N.value=N.value.filter(r=>{var g;return!((g=r.Excludes)!=null&&g.includes(s.value.OrgCategory))}),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",ra),(c,r)=>{var p;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pr,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",qr,"核定經費: "+e.toDisplayString((p=e.unref(s).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("div",Lr,[e.createElementVNode("table",Rr,[r[5]||(r[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",zr,e.toDisplayString(e.unref(E)),1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=o=>e.isRef(E)?E.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",Gr,e.toDisplayString(e.unref(a))+"%",1),r[4]||(r[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Jr,[e.createElementVNode("table",Qr,[e.createElementVNode("thead",Wr,[e.createElementVNode("tr",null,[r[6]||(r[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[7]||(r[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Yr,"狀態")),r[8]||(r[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(o,y)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Hr,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Kr)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Zr,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Xr,"已上傳")):(e.openBlock(),e.createElementBlock("span",vr,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ta,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(n)(b.Path)},e.toDisplayString(b.Name),9,la),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>b.Deleted=!0,type:"button"},[...r[10]||(r[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,oa))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",na,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=o=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=o=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},da={class:"block"},sa={class:"text-teal fw-bold py-3"},ca={class:"text-teal fw-bold pb-3"},ma={class:"table-responsive"},ia={class:"table align-middle gray-table"},pa={class:"text-end"},Va={class:"text-end"},fa={class:"mt-4"},Na={class:"table align-middle gray-table"},Ea={class:"text-center"},ba={key:0,width:"180"},ka={class:"text-center"},ga=["href"],ya={key:0,class:"text-center"},ua={key:0},xa={key:1,class:"text-pink"},Ba={key:1,class:"tag-group mt-2 gap-1"},ha={key:0,class:"tag tag-green-light"},$a=["download","href"],Ca=["onClick"],_a={class:"block-bottom bg-light-teal"},Ta=!0,te=3e4,wa={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(3e4),s=e.ref({}),N=e.ref([{Type:1,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:2,Title:"經費分攤表",Template:"../../Template/CUL/經費分攤表.docx",Files:[]},{Type:3,Title:"補助清單",Template:"../../Template/CUL/補助清單.docx",Files:[],Excludes:["1"]},{Type:4,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_第二期請款_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.culture("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("culture",s.value),N.value=N.value.filter(r=>{var g;return!((g=r.Excludes)!=null&&g.includes(s.value.OrgCategory))}),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",Ta),(c,r)=>{var p;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",da,[r[10]||(r[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",sa,"核定經費: "+e.toDisplayString((p=e.unref(s).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("p",ca,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(E)).toLocaleString())+"元",1),e.createElementVNode("div",ma,[e.createElementVNode("table",ia,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",pa,e.toDisplayString(e.unref(E)-te),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(te)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=o=>e.isRef(E)?E.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",Va,e.toDisplayString(e.unref(a))+"%",1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[12]||(r[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",fa,[e.createElementVNode("table",Na,[e.createElementVNode("thead",Ea,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",ba,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(o,y)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",ka,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,ga)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",ya,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",ua,"已上傳")):(e.openBlock(),e.createElementBlock("span",xa,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Ba,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ha,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(n)(b.Path)},e.toDisplayString(b.Name),9,$a),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>b.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ca))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",_a,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=o=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=o=>d()),type:"button"},[...r[13]||(r[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Da={class:"block rounded-top-4"},Fa={class:"horizontal-scrollable"},Sa={class:"timeline"},Aa={class:"year"},Ua={class:"month"},Ma=["onClick"],Oa={class:"square-title"},ja={class:"table-responsive mt-4"},Ia={class:"table align-middle gray-table"},Pa={class:"text-end"},qa={class:"table-responsive"},La={class:"table align-middle gray-table"},Ra={class:"text-end"},za={key:0,class:"invalid mt-0"},Ga={class:"mt-3"},Ja={class:"mt-3"},Qa=["rowspan"],Wa={key:0,class:"block-bottom bg-light-teal"},Ya={__name:"Progress",props:{id:{type:[Number,String]}},setup(u){const _=[{value:3,text:"完成"},{value:2,text:"部分完成"},{value:1,text:"未完成"}],B=u,E=e.ref(),s=e.ref({}),N=e.ref(0),a=e.ref({}),l=e.ref([]),n=e.ref({}),d=e.computed(()=>Math.round((N.value+l.value.filter(o=>o.Status===3).length)*100/c.value.length*10)/10),c=e.ref([]),r=e.ref([]),g=o=>{E.value=o,x()},x=()=>{A.culture("getMonthlyProgress",{ID:B.id,Year:E.value.year-1911,Month:E.value.month}).subscribe(o=>{const y=o.Logs,b=o.Items,V=o.Steps;let m=!1;N.value=0,n.value=o.Progress,c.value=o.Schedules,l.value=[],r.value.forEach(i=>{i.months.forEach(t=>{m||(t===E.value&&(m=!0),c.value.forEach(f=>{var k,U;if(f.Month===t.month)if(m||f.Status!==3){const w=y.find(S=>S.ScheduleID===f.ID)||{ScheduleID:f.ID,Status:f.Status};l.value.push(Object.assign(w,{Year:i.year,Month:f.Month,ItemTitle:(k=b.find(S=>S.ID===f.ItemID))==null?void 0:k.Title,Type:f.Type,StepTitle:(U=V.find(S=>S.ID===f.StepID))==null?void 0:U.Title}))}else N.value++}))})})})},C=o=>{if(s.value={},o&&!p()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const y={ID:n.value.ID,Description:n.value.Description||"",Status:o?1:0,Logs:l.value.map(b=>({ID:b.ID||0,ScheduleID:b.ScheduleID,Status:b.Status,DelayReason:b.DelayReason||"",ImprovedWay:b.ImprovedWay||""}))};A.culture("saveMonthlyProgress",y).subscribe(b=>{b&&(window.location.href="../inprogressList.aspx")})},p=()=>{let o={Description:"實際工作執行情形"};return s.value=O(n.value,o),l.value.forEach((y,b)=>{o={Status:{numericality:{greaterThan:0,message:"^請輸入本月是否完成"}}},[1,2].includes(y.Status)&&(o.DelayReason="落後原因",o.ImprovedWay="改善措施"),Object.assign(s.value,O(y,o,`item-${b}-`))}),!Object.keys(s.value).length};return e.onMounted(()=>{A.culture("getApplication",{ID:B.id}).subscribe(o=>{a.value=o.Project,I().init("culture",a.value);const y=new Date(a.value.StartTime),b=new Date(a.value.EndTime),V=Date.now();for(;;){const m=y.getFullYear(),i=y.getMonth(),t={year:m,month:i+1,disabled:new Date(m,i,20).getTime()>V};let f=r.value.find(k=>k.year===m);if(f?f.months.push(t):r.value.push({year:m,months:[t]}),m*100+i>=b.getFullYear()*100+b.getMonth())break;y.setMonth(i+1)}})}),(o,y)=>{const b=e.resolveComponent("input-textarea"),V=e.resolveComponent("input-radio-group");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Da,[e.createElementVNode("div",Fa,[y[3]||(y[3]=e.createElementVNode("button",{class:"btn-control btn-prev",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-left"})],-1)),e.createElementVNode("ul",Sa,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),m=>(e.openBlock(),e.createElementBlock("li",{key:m},[e.createElementVNode("span",Aa,e.toDisplayString(m.year-1911)+"年",1),e.createElementVNode("ul",Ua,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.months,i=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass({active:e.unref(E)===i,disabled:i.disabled}),key:i},[e.createElementVNode("a",{onClick:t=>g(i),href:"javascript:void(0)"},e.toDisplayString(i.month)+"月",9,Ma)],2))),128))])]))),128))]),y[4]||(y[4]=e.createElementVNode("button",{class:"btn-control btn-next",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-right"})],-1))]),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h5",Oa,e.toDisplayString(e.unref(E).year-1911)+"年"+e.toDisplayString(e.unref(E).month)+"月 實際進度",1),e.createElementVNode("div",ja,[e.createElementVNode("table",Ia,[y[5]||(y[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",{class:"text-center"},"實際工作執行情形（條列式說明）")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Pa,e.toDisplayString(e.unref(E).year-1911)+"年"+e.toDisplayString(e.unref(E).month)+"月",1),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(s).Description,rows:"4",modelValue:e.unref(n).Description,"onUpdate:modelValue":y[0]||(y[0]=m=>e.unref(n).Description=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",qa,[e.createElementVNode("table",La,[y[8]||(y[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",null,"重要工作項目"),e.createElementVNode("th",null,"工作進度%"),e.createElementVNode("th",null,"檢核工作"),e.createElementVNode("th",null,"本月是否完成"),e.createElementVNode("th",null,"年度目標達成數")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("th",Ra,e.toDisplayString(m.Year-1911)+"年"+e.toDisplayString(m.Month)+"月",1),e.createElementVNode("td",null,e.toDisplayString(m.ItemTitle),1),e.createElementVNode("td",null,e.toDisplayString(m.Type===1?"50%":"100%"),1),e.createElementVNode("td",null,e.toDisplayString(m.StepTitle),1),e.createElementVNode("td",null,[e.createVNode(V,{options:_,modelValue:m.Status,"onUpdate:modelValue":t=>m.Status=t},null,8,["modelValue","onUpdate:modelValue"]),e.unref(s)[`item-${i}-Status`]?(e.openBlock(),e.createElementBlock("div",za,e.toDisplayString(e.unref(s)[`item-${i}-Status`]),1)):e.createCommentVNode("",!0),[1,2].includes(m.Status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",Ga,[y[6]||(y[6]=e.createElementVNode("div",{class:"text-teal pb-2"},"落後原因",-1)),e.createVNode(b,{error:e.unref(s)[`item-${i}-DelayReason`],rows:"1",modelValue:m.DelayReason,"onUpdate:modelValue":t=>m.DelayReason=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ja,[y[7]||(y[7]=e.createElementVNode("div",{class:"text-teal pb-2"},"改善措施",-1)),e.createVNode(b,{error:e.unref(s)[`item-${i}-ImprovedWay`],rows:"1",modelValue:m.ImprovedWay,"onUpdate:modelValue":t=>m.ImprovedWay=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])],64)):e.createCommentVNode("",!0)]),i?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("td",{key:0,class:"text-end",rowspan:e.unref(l).length},e.toDisplayString(e.unref(d))+"% ",9,Qa))]))),128))])])])],64)):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Wa,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:y[1]||(y[1]=m=>C()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:y[2]||(y[2]=m=>C(!0)),type:"button"},[...y[9]||(y[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ha={__name:"ProgressBar",setup(u){const _=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(B,E)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"culture"})}}},le=(u,_)=>{const B=u.__vccOpts||u;for(const[E,s]of _)B[E]=s;return B},Ka={class:"block"},Za={class:"mt-4"},Xa={class:"table align-middle gray-table side-table"},va={key:0,class:"d-flex align-items-center gap-2"},ed={class:"input-group w-auto"},td={class:"text-teal-dark"},ld={key:1,class:"invalid mt-0"},od={class:"square-title mt-4"},nd={class:"mt-4"},rd=["onClick"],ad={class:"d-flex flex-column gap-2"},dd={class:"mt-4 d-flex flex-column gap-2"},sd={class:"d-flex flex-column gap-3 mt-4"},cd={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},md={class:"d-flex gap-2 align-items-center flex-grow-1"},id={class:"text-nowrap"},pd={class:"flex-grow-1"},Vd={class:"d-flex gap-2"},fd=["onClick"],Nd=["href"],Ed=["id"],bd={class:"table align-middle gray-table side-table mb-0"},kd={class:"p-0"},gd={class:"item-list"},yd={class:"mt-2 align-self-start text-center"},ud={class:"input-group"},xd={key:0,class:"invalid mt-0"},Bd={key:0,class:"d-flex gap-2 mt-1 align-self-start"},hd=["onClick"],$d=["onClick"],Cd={class:"row"},_d={class:"col"},Td=["value"],wd={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Dd=["onClick"],Fd=["onClick"],Sd={class:"col"},Ad=["value"],Ud={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Md=["onClick"],Od=["onClick"],jd=["onClick"],Id={class:"mt-4"},Pd={class:"table align-middle gray-table side-table"},qd={key:0,class:"block-bottom bg-light-teal"},Ld=le({__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.computed(()=>z("culture",n.value.Status,2)),N=e.computed(()=>c.value.EndDate),a=e.ref({}),l=e.computed(()=>d.value.filter(f=>!f.Deleted)),n=e.ref({}),d=e.ref([]),c=e.ref({}),r=()=>{A.culture("createGoal",{ID:B.id}).subscribe(f=>{d.value.push(Object.assign(f,{Items:[]}));const k=d.value[d.value.length-1];g(k)})},g=f=>{A.culture("createGoalItem",{ID:B.id,GoalID:f.ID}).subscribe(k=>{f.Items.push(Object.assign(k,{Steps:[],Schedules:[]}));const U=f.Items[f.Items.length-1];C(U),C(U),C(U),x(U,1),x(U,2)})},x=(f,k)=>A.culture("createGoalSchedule",{ID:B.id,ItemID:f.ID,Type:k}).subscribe(U=>f.Schedules.push(U)),C=f=>A.culture("createGoalStep",{ID:B.id,ItemID:f.ID}).subscribe(k=>f.Steps.push(k)),p=_,o=()=>{rxjs.forkJoin([A.culture("getWorkSchedule",{ID:B.id})]).subscribe(f=>{const k=f[0];n.value=k.Project,d.value=k.Goals,c.value=k.GrantType,d.value.length||r(),I().init("culture",n.value),E.value=n.value.changeApply,n.value.changeApply=void 0})},y=f=>f.Deleted=!0,b=f=>f.Deleted=!0,V=f=>f.Deleted=!0,m=f=>f.Deleted=!0,i=f=>{var U,w;if(a.value={},f&&!t()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const k={Project:n.value,Goals:d.value,Before:(U=E.value)==null?void 0:U.Form2Before,After:(w=E.value)==null?void 0:w.Form2After,Submit:f?"true":"false"};A.culture("saveWorkSchedule",k).subscribe(()=>{f?p("next"):o()})},t=()=>{let f={StartTime:"計畫期程",EndTime:"計畫期程"};a.value=O(n.value,f);const k={Title:"計畫目標",Content:"預期效益"},U={Title:"重要工作項目",Indicator:"績效指標"},w={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},S={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return d.value.filter(M=>!M.Deleted).forEach((M,F)=>{Object.assign(a.value,O(M,k,`goal-${F}-`)),M.Items.filter(h=>!h.Deleted).forEach((h,T)=>{Object.assign(a.value,O(h,U,`item-${F}-${T}-`)),h.Steps.filter(D=>!D.Deleted).forEach((D,j)=>Object.assign(a.value,O(D,w,`step-${F}-${T}-${j}-`))),h.Schedules.filter(D=>D.Type===1&&!D.Deleted).forEach((D,j)=>Object.assign(a.value,O(D,S,`schedule-${F}-${T}-1-${j}-`))),h.Schedules.filter(D=>D.Type===2&&!D.Deleted).forEach((D,j)=>Object.assign(a.value,O(D,S,`schedule-${F}-${T}-2-${j}-`)))})}),E.value&&(f={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(a.value,O(E.value,f))),!Object.keys(a.value).length};return e.onMounted(o),e.provide("editable",s),(f,k)=>{const U=e.resolveComponent("required-label"),w=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),M=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-month"),T=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ka,[k[30]||(k[30]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Za,[e.createElementVNode("table",Xa,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[6]||(k[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",va,[e.createElementVNode("div",ed,[e.createVNode(w,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(n).StartTime,"onUpdate:modelValue":k[0]||(k[0]=D=>e.unref(n).StartTime=D)},null,8,["max-date","modelValue"]),k[7]||(k[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(n).EndTime,"onUpdate:modelValue":k[1]||(k[1]=D=>e.unref(n).EndTime=D)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",td,[k[8]||(k[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(N)},null,8,["value"]),k[9]||(k[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(a).StartTime||e.unref(a).EndTime?(e.openBlock(),e.createElementBlock("div",ld,e.toDisplayString(e.unref(a).StartTime||e.unref(a).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",od,[k[11]||(k[11]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:r,type:"button"},[...k[10]||(k[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",nd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(D,j)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:D},[e.unref(s)&&e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:P=>y(D),type:"button"},"刪除",8,rd)):e.createCommentVNode("",!0),e.createElementVNode("div",ad,[k[12]||(k[12]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(a)[`goal-${j}-Title`],modelValue:D.Title,"onUpdate:modelValue":P=>D.Title=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",dd,[k[13]||(k[13]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(F,{error:e.unref(a)[`goal-${j}-Content`],rows:"4",modelValue:D.Content,"onUpdate:modelValue":P=>D.Content=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",sd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Items.filter(P=>!P.Deleted),(P,G)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:P},[e.createElementVNode("div",cd,[e.createElementVNode("div",md,[e.createElementVNode("label",id,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[14]||(k[14]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",pd,[e.createVNode(M,{error:e.unref(a)[`item-${j}-${G}-Title`],modelValue:P.Title,"onUpdate:modelValue":q=>P.Title=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Vd,[e.unref(s)&&D.Items.filter(q=>!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(q=>b(P),["prevent"]),href:"#"},"刪除",8,fd)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${G}`,role:"button"},"收合",8,Nd)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${G}`},[e.createElementVNode("table",bd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[15]||(k[15]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",kd,[e.createElementVNode("ul",gd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Steps.filter(q=>!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(s)}]),key:q},[e.createElementVNode("div",yd,e.toDisplayString(String.fromCharCode(65+J)),1),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(a)[`step-${j}-${G}-${J}-Title`],placeholder:"如:進行口訪紀錄",modelValue:q.Title,"onUpdate:modelValue":L=>q.Title=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",ud,[e.createVNode(h,{"empty-value":0,modelValue:q.Begin,"onUpdate:modelValue":L=>q.Begin=L},null,8,["modelValue","onUpdate:modelValue"]),k[16]||(k[16]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{"empty-value":0,modelValue:q.End,"onUpdate:modelValue":L=>q.End=L},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(a)[`step-${j}-${G}-${J}-Begin`]||e.unref(a)[`step-${j}-${G}-${J}-End`]?(e.openBlock(),e.createElementBlock("div",xd,e.toDisplayString(e.unref(a)[`step-${j}-${G}-${J}-Begin`]||e.unref(a)[`step-${j}-${G}-${J}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Bd,[P.Steps.filter(L=>!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:L=>m(q),type:"button"},[...k[17]||(k[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,hd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:L=>C(P),type:"button"},[...k[18]||(k[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,$d)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[19]||(k[19]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(a)[`item-${j}-${G}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:P.Indicator,"onUpdate:modelValue":q=>P.Indicator=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[20]||(k[20]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Cd,[e.createElementVNode("div",_d,[k[23]||(k[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Schedules.filter(q=>q.Type===1&&!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:q},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?3:4}`])},[e.createVNode(h,{error:e.unref(a)[`schedule-${j}-${G}-1-${J}-Month`],"empty-value":0,modelValue:q.Month,"onUpdate:modelValue":L=>q.Month=L},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?7:8}`])},[e.createVNode(T,{"empty-value":0,error:e.unref(a)[`schedule-${j}-${G}-1-${J}-StepID`],options:P.Steps.filter(L=>!L.Deleted),modelValue:q.StepID,"onUpdate:modelValue":L=>q.StepID=L},{default:e.withCtx(({index:L,option:H})=>[e.createElementVNode("option",{value:H.ID},e.toDisplayString(String.fromCharCode(65+L))+"."+e.toDisplayString(H.Title),9,Td)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(s)?(e.openBlock(),e.createElementBlock("div",wd,[P.Schedules.filter(L=>L.Type===1&&!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:L=>V(q),type:"button"},[...k[21]||(k[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Dd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:L=>x(P,1),type:"button"},[...k[22]||(k[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Fd)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Sd,[k[26]||(k[26]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Schedules.filter(q=>q.Type===2&&!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:q},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?3:4}`])},[e.createVNode(h,{error:e.unref(a)[`schedule-${j}-${G}-2-${J}-Month`],"empty-value":0,modelValue:q.Month,"onUpdate:modelValue":L=>q.Month=L},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?7:8}`])},[e.createVNode(T,{"empty-value":0,error:e.unref(a)[`schedule-${j}-${G}-2-${J}-StepID`],options:P.Steps.filter(L=>!L.Deleted),modelValue:q.StepID,"onUpdate:modelValue":L=>q.StepID=L},{default:e.withCtx(({index:L,option:H})=>[e.createElementVNode("option",{value:H.ID},e.toDisplayString(String.fromCharCode(65+L))+"."+e.toDisplayString(H.Title),9,Ad)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Ud,[P.Schedules.filter(L=>L.Type===2&&!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:L=>V(q),type:"button"},[...k[24]||(k[24]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Md)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:L=>x(P,2),type:"button"},[...k[25]||(k[25]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Od)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Ed)]))),128))]),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:P=>g(D),type:"button"},"新增工作項目",8,jd)):e.createCommentVNode("",!0)]))),128))]),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[k[29]||(k[29]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Id,[e.createElementVNode("table",Pd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[27]||(k[27]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(a).Form2Before,rows:"4",modelValue:e.unref(E).Form2Before,"onUpdate:modelValue":k[2]||(k[2]=D=>e.unref(E).Form2Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[28]||(k[28]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(a).Form2After,rows:"4",modelValue:e.unref(E).Form2After,"onUpdate:modelValue":k[3]||(k[3]=D=>e.unref(E).Form2After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",qd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[4]||(k[4]=D=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[5]||(k[5]=D=>i(!0)),type:"button"},[...k[31]||(k[31]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-84d8fceb"]]),Rd={class:"block"},zd={class:"mt-4"},Gd={class:"table align-middle gray-table side-table"},Jd={key:0},Qd={key:1,class:"text-light-gray"},Wd={class:"d-flex flex-column gap-2"},Yd={key:0},Hd={class:"mt-4"},Kd={class:"table align-middle gray-table side-table"},Zd={class:"row g-3"},Xd={class:"col-12 col-xl-2"},vd={class:"text-gray mb-2"},es={class:"col-12 col-xl-3"},ts={class:"text-gray mb-2"},ls={key:0,class:"col-12 col-xl-4"},os={class:"row g-1"},ns={class:"col-7"},rs={class:"col-5"},as={key:1,class:"col-12 col-xl-3"},ds={class:"text-gray mb-2"},ss={class:"mt-4"},cs={class:"table align-middle gray-table side-table"},ms={class:"d-flex align-items-center gap-2"},is={class:"input-group w-auto"},ps={key:0,class:"invalid mt-0"},Vs={class:"mt-4"},fs={class:"table-responsive mt-3 mb-0"},Ns={class:"table align-middle gray-table"},Es={class:"text-end"},bs={class:"text-end"},ks={class:"text-end"},gs={class:"text-end"},ys={class:"text-end"},us={class:"table align-middle gray-table side-table"},xs={key:0,class:"table-responsive mt-3 mb-0"},Bs={class:"table align-middle gray-table"},hs={key:0},$s={key:0},Cs={class:"d-flex gap-2"},_s=["onClick"],Ts={class:"mt-4"},ws={class:"table align-middle gray-table side-table"},Ds={key:0,class:"block-bottom bg-light-teal"},Fs={class:"text-center"},Ss={class:"mb-5"},As={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.ref(),a=e.computed(()=>z("education",d.value.Status,1)),l=e.ref({}),n=e.computed(()=>r.value.filter(i=>!i.Deleted)),d=e.ref({}),c=e.ref(),r=e.ref([]),g=e.ref(),x=e.ref(0),C=e.computed({get:()=>!!n.value.length,set:i=>{i?p():r.value.forEach(t=>t.Deleted=!0)}}),p=()=>r.value.push({}),o=_,y=()=>{A.education("getApplication",{ID:B.id}).subscribe(i=>{d.value=i.Project,N.value=i.Contacts,r.value=i.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,I().init("education",d.value),s.value=d.value.changeApply,d.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=(i,t)=>{var k,U;if(l.value={},i&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&g.value&&d.value.ApplyAmount>g.value.GrantLimit*1e4){c.value.show(()=>V(i,!0));return}const f={Project:d.value,Contacts:N.value,ReceivedSubsidies:r.value.filter(w=>w.ID||!w.Deleted),Before:(k=s.value)==null?void 0:k.Form1Before,After:(U=s.value)==null?void 0:U.Form1After,Submit:i?"true":"false"};A.education("saveApplication",f).subscribe(w=>{i?o("next",w.ID):d.value.ID?y():window.location.href=`Application.aspx?ID=${w.ID}`})},m=()=>{let i={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return d.value.OrgCategory==="2"&&(i.RegisteredNum="立案登記證字號"),l.value=O(d.value,i),i={Name:"姓名",JobTitle:"職稱"},Object.assign(l.value,O(N.value[0],i,"contact-0-")),i.MobilePhone="手機號碼",Object.assign(l.value,O(N.value[1],i,"contact-1-")),i={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},r.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`received-${f}-`))),s.value&&(i={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(s.value,i))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(i=>{E.value=i[0],B.id?y():A.education("getEmptyApplication").subscribe(t=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),N.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("education",d.value)})})}),e.provide("editable",a),e.watch(()=>d.value.OrgCategory,()=>{A.education("getGrantTargetSetting",{TargetTypeID:`EDC${d.value.OrgCategory}`}).subscribe(i=>{g.value=i})}),e.watchEffect(()=>{x.value=R(d.value.ApplyAmount)+R(d.value.SelfAmount)+R(d.value.OtherGovAmount)+R(d.value.OtherUnitAmount)}),(i,t)=>{const f=e.resolveComponent("required-label"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-select"),w=e.resolveComponent("input-tw-date"),S=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-integer"),F=e.resolveComponent("input-boolean"),h=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Rd,[t[52]||(t[52]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",zd,[e.createElementVNode("table",Gd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",Jd,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Qd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[22]||(t[22]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=T=>e.unref(d).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Wd,[e.createElementVNode("div",null,[e.createVNode(U,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=T=>e.unref(d).OrgCategory=T)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Yd,[e.createVNode(k,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=T=>e.unref(d).RegisteredNum=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":t[3]||(t[3]=T=>e.unref(d).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":t[4]||(t[4]=T=>e.unref(d).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":t[5]||(t[5]=T=>e.unref(d).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[53]||(t[53]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Hd,[e.createElementVNode("table",Kd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Zd,[e.createElementVNode("div",Xd,[e.createElementVNode("div",vd,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[28]||(t[28]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(k,{error:e.unref(l)[`contact-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":j=>T.Name=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",es,[e.createElementVNode("div",ts,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(k,{error:e.unref(l)[`contact-${D}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":j=>T.JobTitle=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),D?(e.openBlock(),e.createElementBlock("div",ls,[t[30]||(t[30]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",os,[e.createElementVNode("div",ns,[e.createVNode(k,{modelValue:T.Phone,"onUpdate:modelValue":j=>T.Phone=j,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rs,[e.createVNode(k,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":j=>T.PhoneExt=j,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),D?(e.openBlock(),e.createElementBlock("div",as,[e.createElementVNode("div",ds,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(k,{error:e.unref(l)[`contact-${D}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":j=>T.MobilePhone=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[54]||(t[54]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",ss,[e.createElementVNode("table",cs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[32]||(t[32]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",ms,[e.createElementVNode("div",is,[e.createVNode(w,{class:"w-auto",modelValue:e.unref(d).StartTime,"onUpdate:modelValue":t[6]||(t[6]=T=>e.unref(d).StartTime=T)},null,8,["modelValue"]),t[33]||(t[33]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto",modelValue:e.unref(d).EndTime,"onUpdate:modelValue":t[7]||(t[7]=T=>e.unref(d).EndTime=T)},null,8,["modelValue"])]),t[34]||(t[34]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",ps,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Target,modelValue:e.unref(d).Target,"onUpdate:modelValue":t[8]||(t[8]=T=>e.unref(d).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":t[9]||(t[9]=T=>e.unref(d).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":t[10]||(t[10]=T=>e.unref(d).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[55]||(t[55]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Vs,[t[43]||(t[43]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",fs,[e.createElementVNode("table",Ns,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Es,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",bs,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",ks,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[40]||(t[40]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",gs,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[41]||(t[41]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[42]||(t[42]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).ApplyAmount,modelValue:e.unref(d).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=T=>e.unref(d).ApplyAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).SelfAmount,modelValue:e.unref(d).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=T=>e.unref(d).SelfAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).OtherGovAmount,modelValue:e.unref(d).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=T=>e.unref(d).OtherGovAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).OtherUnitAmount,modelValue:e.unref(d).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=T=>e.unref(d).OtherUnitAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",ys,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])])]),e.createElementVNode("table",us,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[44]||(t[44]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{modelValue:e.unref(C),"onUpdate:modelValue":t[15]||(t[15]=T=>e.isRef(C)?C.value=T:null)},null,8,["modelValue"]),e.unref(C)?(e.openBlock(),e.createElementBlock("div",xs,[e.createElementVNode("table",Bs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[45]||(t[45]=e.createElementVNode("th",null,"計畫名稱",-1)),t[46]||(t[46]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",hs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`received-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":j=>T.Name=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`received-${D}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":j=>T.Amount=j},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",$s,[e.createElementVNode("div",Cs,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:j=>b(T),type:"button"},[...t[47]||(t[47]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,_s)):e.createCommentVNode("",!0),D+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[48]||(t[48]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[51]||(t[51]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("table",ws,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[49]||(t[49]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":t[16]||(t[16]=T=>e.unref(s).Form1Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[50]||(t[50]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":t[17]||(t[17]=T=>e.unref(s).Form1After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Ds,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[18]||(t[18]=T=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[19]||(t[19]=T=>V(!0)),type:"button"},[...t[56]||(t[56]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(h,{ref_key:"modal",ref:c},{default:e.withCtx(()=>{var T;return[e.createElementVNode("div",Fs,[t[57]||(t[57]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Ss,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((T=e.unref(g))==null?void 0:T.GrantLimit)+"萬",1),t[58]||(t[58]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[59]||(t[59]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},Us={class:"block"},Ms={key:0,class:"text-pink lh-base mt-4"},Os={class:"mt-4"},js={class:"table align-middle gray-table"},Is={class:"text-center"},Ps={key:0,width:"180"},qs={class:"text-center"},Ls={key:0},Rs=["innerHTML"],zs=["href"],Gs={key:0,class:"text-center"},Js={key:0},Qs={key:1,class:"text-pink"},Ws={key:1,class:"tag-group mt-2 gap-1"},Ys={key:0,class:"tag tag-green-light"},Hs=["download","href"],Ks=["onClick"],Zs={class:"mt-4"},Xs={class:"table align-middle gray-table side-table"},vs={key:0,class:"block-bottom bg-light-teal"},ec=["disabled"],tc={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([{Type:1,Title:"申請表",Template:"../../Template/EDC/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/EDC/2-申請計畫書.docx",Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/EDC/3-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]}]),s=e.ref(),N=e.computed(()=>E.value.some(p=>!p.Optional&&!p.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("education",n.value.Status,2)),l=e.ref({}),n=e.ref({}),d=(p,o)=>{o.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:o.Path,Name:n.value.ProjectID+"_"+(p.Multiple?o.Name:`${p.Title}.pdf`)})},c=A.download,r=_,g=()=>{rxjs.forkJoin([A.education("getAttachment",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=E.value.filter(y=>{var b;return!((b=y.Excludes)!=null&&b.includes(n.value.OrgCategory))}),E.value.forEach(y=>{y.Files=o.Attachments.filter(b=>b.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(b=>!b.Deleted).length)}),I().init("education",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},x=p=>{var y,b;if(l.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:B.id,Attachments:E.value.reduce((V,m)=>V.concat(m.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(b=s.value)==null?void 0:b.Form5After,Submit:p?"true":"false"};A.education("saveAttachment",o).subscribe(()=>{p?r("next"):g()})},C=()=>{if(s.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(s.value,p))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(p,o)=>{const y=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),V=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Us,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",Ms,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Os,[e.createElementVNode("table",js,[e.createElementVNode("thead",Is,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Ps,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",qs,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",Ls,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,Rs)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,zs)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Gs,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",Js,"已上傳")):(e.openBlock(),e.createElementBlock("span",Qs,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>d(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Ws,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ys,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,Hs),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:f=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ks)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Zs,[e.createElementVNode("table",Xs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(s).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",vs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>x(!0)),disabled:e.unref(N),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ec)])):e.createCommentVNode("",!0)],64)}}},lc={class:"block"},oc={class:"text-teal fw-bold py-3"},nc={class:"text-teal fw-bold pb-3"},rc={class:"table-responsive"},ac={class:"table align-middle gray-table"},dc={class:"text-end"},sc={class:"text-end"},cc={class:"mt-4"},mc={class:"table align-middle gray-table"},ic={class:"text-center"},pc={key:0,width:"180"},Vc={class:"text-center"},fc=["href"],Nc={key:0,class:"text-center"},Ec={key:0},bc={key:1,class:"text-pink"},kc={key:1,class:"tag-group mt-2 gap-1"},gc={key:0,class:"tag tag-green-light"},yc=["download","href"],uc=["onClick"],xc={class:"block-bottom bg-light-teal"},Bc=!0,hc=3e4,$c={__name:"Payment",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(3e4),s=e.ref({}),N=e.ref([{Type:1,Title:"收支明細表",Template:"../../Template/EDC/1-收支明細表.docx",Files:[]},{Type:2,Title:"受補助清單",Template:"../../Template/EDC/2-受補助清單.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/EDC/3-經費分攤表.docx",Files:[]},{Type:4,Title:"憑證",Template:"../../Template/EDC/4-憑證.docx",Files:[]},{Type:5,Title:"領據",Template:"../../Template/EDC/5-領據.docx",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.education("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("education",s.value),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",Bc),(c,r)=>{var p;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",lc,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於活動結束後一個月內提交成果報告及請款）",-1)),e.createElementVNode("p",oc,"核定經費: "+e.toDisplayString((p=e.unref(s).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("p",nc,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(E)).toLocaleString())+"元",1),e.createElementVNode("div",rc,[e.createElementVNode("table",ac,[r[5]||(r[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",dc,e.toDisplayString(e.unref(E)-hc),1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=o=>e.isRef(E)?E.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",sc,e.toDisplayString(e.unref(a))+"%",1),r[4]||(r[4]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",cc,[e.createElementVNode("table",mc,[e.createElementVNode("thead",ic,[e.createElementVNode("tr",null,[r[6]||(r[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[7]||(r[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",pc,"狀態")),r[8]||(r[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(o,y)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Vc,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,fc)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Nc,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Ec,"已上傳")):(e.openBlock(),e.createElementBlock("span",bc,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",kc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",gc,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(n)(b.Path)},e.toDisplayString(b.Name),9,yc),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>b.Deleted=!0,type:"button"},[...r[10]||(r[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,uc))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",xc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=o=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=o=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Cc={__name:"ProgressBar",setup(u){const _=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(B,E)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"education"})}}},_c={class:"modal-dialog modal-dialog-centered modal-md"},Tc={class:"modal-content"},wc={class:"modal-body"},Dc={class:"d-flex flex-column align-items-center mb-5 gap-3"},Fc={class:"fs-18"},Sc={__name:"ErrorModal",setup(u){const _=K(),B=e.ref();return e.onMounted(()=>B.value.addEventListener("hidden.bs.modal",()=>_.error=null)),e.watch(()=>_.error,()=>{_.error&&bootstrap.Modal.getOrCreateInstance(B.value).show()}),(E,s)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:B,tabindex:"-1"},[e.createElementVNode("div",_c,[e.createElementVNode("div",Tc,[s[2]||(s[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",wc,[e.createElementVNode("div",Dc,[s[0]||(s[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",Fc,e.toDisplayString(e.unref(_).error),1)]),s[1]||(s[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},Ac={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(u){const _=e.useModel(u,"modelValue"),B=[{value:!0,text:"是"},{value:!1,text:"否"}];return(E,s)=>{const N=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(N,{options:B,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=a=>_.value=a)},null,8,["modelValue"])}}},Uc=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(u,{emit:_}){const B=e.ref(),E=()=>{Array.from(B.value.files).forEach(N=>A.upload(N).subscribe(a=>s("file",a))),B.value.value=""},s=_;return(N,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:a[0]||(a[0]=l=>e.unref(B).click()),type:"button"},[...a[1]||(a[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:E,class:"d-none",ref_key:"input",ref:B,type:"file"},N.$attrs),null,16)],64))}}),Mc=["disabled","placeholder","type"],Oc={key:0,class:"invalid mt-0"},jc=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=e.inject("editable",!0),B=e.useModel(u,"modelValue");return e.watch(B,E=>{if(E){const s=(parseInt(E)||0).toString();E.toString()!==s&&(B.value=s)}}),(E,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?u.placeholder:"",style:{"text-align":"right"},type:u.type},E.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=N=>B.value=N)}),null,16,Mc),[[e.vModelDynamic,B.value]]),u.error?(e.openBlock(),e.createElementBlock("div",Oc,e.toDisplayString(u.error),1)):e.createCommentVNode("",!0)],64))}}),Ic={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(u){const _=e.useModel(u,"modelValue"),B=[];for(let E=1;E<=12;E++)B.push({value:E,text:`${E}月`});return(E,s)=>{const N=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(N,{options:B,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=a=>_.value=a)},null,8,["modelValue"])}}},Pc=["onChange","checked","disabled","id","value"],qc=["for"],Lc={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>re(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=e.inject("editable",!0),B=e.useModel(u,"modelValue"),E=s=>{B.value=s};return(s,N)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.options,a=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:a},[e.createElementVNode("input",{onChange:l=>E(a[u.valueName]),checked:a[u.valueName]===B.value,class:"form-check-input",disabled:!e.unref(_),id:`${u.id}-${a[u.valueName]}`,type:"radio",value:a[u.valueName]},null,40,Pc),e.createElementVNode("label",{class:"form-check-label",for:`${u.id}-${a[u.valueName]}`},e.toDisplayString(a[u.textName]),9,qc)]))),128))}},Rc=["disabled"],zc=["value"],Gc=["value"],Jc={key:0,class:"invalid mt-0"},Qc=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=e.inject("editable",!0),B=e.useModel(u,"modelValue");return(E,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:u.disabled||!e.unref(_)},E.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=N=>B.value=N)}),[e.unref(_)&&!B.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:u.emptyValue},e.toDisplayString(u.placeholder),9,zc)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.options,(N,a)=>e.renderSlot(E.$slots,"default",{key:N,index:a,option:N},()=>[e.createElementVNode("option",{value:N[u.valueName]},e.toDisplayString(N[u.textName]),9,Gc)])),128))],16,Rc),[[e.vModelSelect,B.value]]),u.error?(e.openBlock(),e.createElementBlock("div",Jc,e.toDisplayString(u.error),1)):e.createCommentVNode("",!0)],64))}}),Wc={class:"input-group"},Yc={key:0,class:"input-group-text"},Hc=["disabled","placeholder","type"],Kc={key:0,class:"invalid mt-0"},Zc=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=e.inject("editable",!0),B=e.useModel(u,"modelValue"),E=u;return E.maxLength&&e.watch(B,()=>{var s;((s=B.value)==null?void 0:s.length)>E.maxLength&&(B.value=B.value.substring(0,E.maxLength))}),(s,N)=>{const a=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wc,[u.prefix?(e.openBlock(),e.createElementBlock("span",Yc,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?u.placeholder:"",type:u.type},s.$attrs,{"onUpdate:modelValue":N[0]||(N[0]=l=>B.value=l)}),null,16,Hc),[[e.vModelDynamic,B.value]])]),u.error?(e.openBlock(),e.createElementBlock("div",Kc,e.toDisplayString(u.error),1)):e.createCommentVNode("",!0)],64)}}}),Xc=["disabled","placeholder"],vc={key:0,class:"fs-14 text-gray mt-2"},em={class:"text-pink"},tm={key:1,class:"invalid mt-0"},lm=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const _=e.inject("editable",!0),B=e.useModel(u,"modelValue"),E=u;return E.maxLength&&e.watch(B,()=>{var s;((s=B.value)==null?void 0:s.length)>E.maxLength&&(B.value=B.value.substring(0,E.maxLength))}),(s,N)=>{var a;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?u.placeholder:""},s.$attrs,{"onUpdate:modelValue":N[0]||(N[0]=l=>B.value=l)}),null,16,Xc),[[e.vModelText,B.value]]),e.unref(_)&&u.maxLength?(e.openBlock(),e.createElementBlock("div",vc,[N[1]||(N[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",em,e.toDisplayString(((a=B.value)==null?void 0:a.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(u.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),u.error?(e.openBlock(),e.createElementBlock("div",tm,e.toDisplayString(u.error),1)):e.createCommentVNode("",!0)],64)}}}),om=["disabled"],nm={key:0,class:"invalid"},rm=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(u,{emit:_}){let B;const E=u,s=e.ref(),N=e.inject("editable",!0),a=e.ref(),l=_,n=d=>{!d&&E.modelValue&&(d=moment(new Date(E.modelValue))),d?(s.value=d.format(E.displayFormat),l("update:modelValue",d.format(E.format))):(s.value="",l("update:modelValue","")),B.setStartDate(s.value||void 0)};return e.onMounted(()=>{const d=$(a.value);d.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:E.drops,locale:{format:E.displayFormat},maxDate:E.maxDate?new Date(E.maxDate):E.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(c,r)=>n(r.startDate)),B=d.data("daterangepicker"),n()}),e.onUnmounted(()=>B.remove()),e.watch(()=>E.modelValue,()=>n()),(d,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(N),ref_key:"element",ref:a,type:"text"},d.$attrs,{"onUpdate:modelValue":c[0]||(c[0]=r=>e.isRef(s)?s.value=r:null)}),null,16,om),[[e.vModelText,e.unref(s)]]),u.error?(e.openBlock(),e.createElementBlock("div",nm,e.toDisplayString(u.error),1)):e.createCommentVNode("",!0)],64))}}),am={key:0,class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},dm={class:"pagination","aria-label":"Pagination"},sm=["disabled"],cm={key:1,class:"pagination-item ellipsis",type:"button"},mm=["onClick"],im={class:"page-number"},pm={key:2,class:"pagination-item ellipsis",type:"button"},Vm={class:"page-number"},fm=["disabled"],Nm={class:"page-number-control"},Em={class:"page-number-control-item"},bm=["selected","value"],km={class:"page-number-control-item"},gm=["value","selected"],ym={__name:"ListPager",props:{count:{required:!0,type:Number},page:{required:!0,type:Number},pageSize:{required:!0,type:Number},slots:{default:3,type:Number}},emits:["change"],setup(u,{emit:_}){const B={},E=u,s=e.computed(()=>Math.ceil(E.count/E.pageSize)),N=(l,n)=>{n&&(l=Math.min(l,Math.ceil(E.count/n))),1<=l&&l<=s.value&&a("change",l,n||E.pageSize)},a=_;return e.watchEffect(()=>{B.from=E.page-parseInt(E.slots/2),B.to=E.page+parseInt((E.slots-1)/2),B.pages=[];for(let l=B.from;l<=B.to;l++)0<l&&l<=s.value&&B.pages.push(l)}),(l,n)=>E.count?(e.openBlock(),e.createElementBlock("div",am,[e.createElementVNode("nav",dm,[e.createElementVNode("button",{"aria-label":"Previous page",class:"nav-button",onClick:n[0]||(n[0]=d=>N(u.page-1)),disabled:u.page===1,type:"button"},[...n[6]||(n[6]=[e.createElementVNode("i",{class:"fas fa-chevron-left"},null,-1)])],8,sm),B.from>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"pagination-item",onClick:n[1]||(n[1]=d=>N(1)),type:"button"},[...n[7]||(n[7]=[e.createElementVNode("span",{class:"page-number"},"1",-1)])])):e.createCommentVNode("",!0),B.from>2?(e.openBlock(),e.createElementBlock("button",cm,[...n[8]||(n[8]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.pages,d=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["pagination-item",{active:u.page===d}]),onClick:c=>N(d),key:d,type:"button"},[e.createElementVNode("span",im,e.toDisplayString(d),1)],10,mm))),128)),e.unref(s)>B.to+1?(e.openBlock(),e.createElementBlock("button",pm,[...n[9]||(n[9]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),e.unref(s)>B.to?(e.openBlock(),e.createElementBlock("button",{key:3,class:"pagination-item",onClick:n[2]||(n[2]=d=>N(e.unref(s))),type:"button"},[e.createElementVNode("span",Vm,e.toDisplayString(e.unref(s)),1)])):e.createCommentVNode("",!0),e.createElementVNode("button",{"aria-label":"Next page",class:"nav-button",onClick:n[3]||(n[3]=d=>N(u.page+1)),type:"button",disabled:u.page===e.unref(s)},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fas fa-chevron-right"},null,-1)])],8,fm)]),e.createElementVNode("div",Nm,[e.createElementVNode("div",Em,[n[11]||(n[11]=e.createElementVNode("span",null,"跳到",-1)),e.createElementVNode("select",{onChange:n[4]||(n[4]=d=>N(d.target.value)),class:"form-select jump-to-page"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),d=>(e.openBlock(),e.createElementBlock("option",{key:d,selected:d===u.page,value:d},e.toDisplayString(d),9,bm))),128))],32),n[12]||(n[12]=e.createElementVNode("span",null,"頁",-1)),n[13]||(n[13]=e.createElementVNode("span",null,",",-1))]),e.createElementVNode("div",km,[n[14]||(n[14]=e.createElementVNode("span",null,"每頁顯示",-1)),e.createElementVNode("select",{onChange:n[5]||(n[5]=d=>N(u.page,d.target.value)),class:"form-select"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList([10,20,30],d=>e.createElementVNode("option",{value:d,selected:d===u.pageSize},e.toDisplayString(d),9,gm)),64))],32),n[15]||(n[15]=e.createElementVNode("span",null,"筆",-1))])])])):e.createCommentVNode("",!0)}},um={class:"block"},xm={class:"mt-4"},Bm={class:"table align-middle gray-table side-table"},hm={key:0},$m={key:1,class:"text-light-gray"},Cm={class:"mt-4"},_m={class:"table align-middle gray-table side-table"},Tm={class:"row g-3"},wm={class:"col-12 col-xl-2"},Dm={class:"text-gray mb-2"},Fm={class:"col-12 col-xl-3"},Sm={class:"text-gray mb-2"},Am={class:"col-12 col-xl-4"},Um={class:"row g-1"},Mm={class:"col-7"},Om={class:"col-5"},jm={class:"col-12 col-xl-3"},Im={class:"text-gray mb-2"},Pm={class:"col-12"},qm={class:"text-gray mb-2"},Lm={class:"mt-4"},Rm={class:"table align-middle gray-table side-table"},zm={class:"mt-4"},Gm={class:"table align-middle gray-table side-table"},Jm={key:0,class:"table-responsive mt-3 mb-0"},Qm={class:"table align-middle gray-table"},Wm={key:0},Ym={key:0},Hm={class:"d-flex gap-2"},Km=["onClick"],Zm={class:"mt-4"},Xm={class:"table align-middle gray-table side-table"},vm={key:0,class:"block-bottom bg-light-teal"},ei={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.ref(),N=e.computed(()=>z("literacy",d.value.Status,1)),a=e.ref({}),l=e.ref([]),n=e.computed(()=>c.value.filter(b=>!b.Deleted)),d=e.ref({}),c=e.ref([]),r=e.computed({get:()=>!!n.value.length,set:b=>{b?g():c.value.forEach(V=>V.Deleted=!0)}}),g=()=>c.value.push({}),x=_,C=()=>{A.literacy("getApplication",{ID:B.id}).subscribe(b=>{d.value=b.Project,E.value=b.Contacts,c.value=b.PreviousStudies,I().init("literacy",d.value),s.value=d.value.changeApply,d.value.changeApply=void 0})},p=b=>b.Deleted=!0,o=b=>{var m,i;if(a.value={},b&&!y()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const V={Project:d.value,Contacts:E.value,PreviousStudies:c.value.filter(t=>t.ID||!t.Deleted),Before:(m=s.value)==null?void 0:m.Form1Before,After:(i=s.value)==null?void 0:i.Form1After,Submit:b?"true":"false"};A.literacy("saveApplication",V).subscribe(t=>{b?x("next",t.ID):d.value.ID?C():window.location.href=`Application.aspx?ID=${t.ID}`})},y=()=>{let b={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value=O(d.value,b),b={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((V,m)=>Object.assign(a.value,O(V,b,`contact-${m}-`))),b={Title:"研習/課程名稱",TheDate:"辦理日期"},c.value.forEach((V,m)=>Object.assign(a.value,O(V,b,`study-${m}-`))),s.value&&(b={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(a.value,O(s.value,b))),!Object.keys(a.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(b=>{l.value=b[0],B.id?C():A.literacy("getEmptyApplication").subscribe(V=>{d.value=Object.assign({Field:null,FormStep:1,Status:1},V),E.value=[{Role:"申請人"}],I().init("literacy",d.value)})})}),e.provide("editable",N),e.watch(()=>[d.value.Field,d.value.OrgName],()=>{var b;if(N.value){const V=[];d.value.Field&&V.push((b=l.value.find(m=>m.Code===d.value.Field))==null?void 0:b.Descname),d.value.OrgName&&V.push(d.value.OrgName),d.value.ProjectName=V.join("-")}}),(b,V)=>{const m=e.resolveComponent("required-label"),i=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),f=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-boolean"),U=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",um,[V[40]||(V[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",xm,[e.createElementVNode("table",Bm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[V[14]||(V[14]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[V[15]||(V[15]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",hm,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",$m,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[V[16]||(V[16]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[17]||(V[17]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{disabled:"",modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":V[0]||(V[0]=w=>e.unref(d).ProjectName=w),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[18]||(V[18]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(a).Field,options:e.unref(l),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).Field,"onUpdate:modelValue":V[1]||(V[1]=w=>e.unref(d).Field=w)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[19]||(V[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(a).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":V[2]||(V[2]=w=>e.unref(d).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[20]||(V[20]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(a).OrgLeader,modelValue:e.unref(d).OrgLeader,"onUpdate:modelValue":V[3]||(V[3]=w=>e.unref(d).OrgLeader=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[21]||(V[21]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(a).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":V[4]||(V[4]=w=>e.unref(d).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),V[41]||(V[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Cm,[e.createElementVNode("table",_m,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Tm,[e.createElementVNode("div",wm,[e.createElementVNode("div",Dm,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[22]||(V[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(a)[`contact-${S}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fm,[e.createElementVNode("div",Sm,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[23]||(V[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(a)[`contact-${S}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Am,[V[24]||(V[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Um,[e.createElementVNode("div",Mm,[e.createVNode(i,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Om,[e.createVNode(i,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",jm,[e.createElementVNode("div",Im,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[25]||(V[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(a)[`contact-${S}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Pm,[e.createElementVNode("div",qm,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[26]||(V[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(a)[`contact-${S}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),V[42]||(V[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Lm,[e.createElementVNode("table",Rm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[27]||(V[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[V[28]||(V[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(f,{error:e.unref(a).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":V[5]||(V[5]=w=>e.unref(d).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[29]||(V[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":V[6]||(V[6]=w=>e.unref(d).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[30]||(V[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":V[7]||(V[7]=w=>e.unref(d).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[31]||(V[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":V[8]||(V[8]=w=>e.unref(d).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",zm,[e.createElementVNode("table",Gm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[V[36]||(V[36]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(k,{modelValue:e.unref(r),"onUpdate:modelValue":V[9]||(V[9]=w=>e.isRef(r)?r.value=w:null)},null,8,["modelValue"]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Jm,[e.createElementVNode("table",Qm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[V[32]||(V[32]=e.createElementVNode("th",null,"研習/課程名稱",-1)),V[33]||(V[33]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Wm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(a)[`study-${S}-Title`],modelValue:w.Title,"onUpdate:modelValue":M=>w.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(a)[`study-${S}-TheDate`],modelValue:w.TheDate,"onUpdate:modelValue":M=>w.TheDate=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Ym,[e.createElementVNode("div",Hm,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>p(w),type:"button"},[...V[34]||(V[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Km)):e.createCommentVNode("",!0),S+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...V[35]||(V[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[V[39]||(V[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Zm,[e.createElementVNode("table",Xm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[37]||(V[37]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":V[10]||(V[10]=w=>e.unref(s).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...V[38]||(V[38]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":V[11]||(V[11]=w=>e.unref(s).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",vm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:V[12]||(V[12]=w=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:V[13]||(V[13]=w=>o(!0)),type:"button"},[...V[43]||(V[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ti={class:"block"},li={key:0,class:"text-pink lh-base mt-4"},oi={class:"mt-4"},ni={class:"table align-middle gray-table"},ri={class:"text-center"},ai={key:0,width:"180"},di={class:"text-center"},si={key:0},ci=["innerHTML"],mi=["href"],ii={key:0,class:"text-center"},pi={key:0},Vi={key:1,class:"text-pink"},fi={key:1,class:"tag-group mt-2 gap-1"},Ni={key:0,class:"tag tag-green-light"},Ei=["download","href"],bi=["onClick"],ki={class:"mt-4"},gi={class:"table align-middle gray-table side-table"},yi={key:0,class:"block-bottom bg-light-teal"},ui=["disabled"],xi={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([{Type:1,Title:"申請表",Template:"../../Template/LIT/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/LIT/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/LIT/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/LIT/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),N=e.computed(()=>E.value.some(p=>!p.Optional&&!p.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("literacy",n.value.Status,2)),l=e.ref({}),n=e.ref({}),d=(p,o)=>{o.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:o.Path,Name:n.value.ProjectID+"_"+(p.Multiple?o.Name:`${p.Title}.pdf`)})},c=A.download,r=_,g=()=>{rxjs.forkJoin([A.literacy("getAttachment",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=E.value.filter(y=>{var b;return!((b=y.Excludes)!=null&&b.includes(n.value.OrgCategory))}),E.value.forEach(y=>{y.Files=o.Attachments.filter(b=>b.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(b=>!b.Deleted).length)}),I().init("literacy",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},x=p=>{var y,b;if(l.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:B.id,Attachments:E.value.reduce((V,m)=>V.concat(m.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(b=s.value)==null?void 0:b.Form5After,Submit:p?"true":"false"};A.literacy("saveAttachment",o).subscribe(()=>{p?r("next"):g()})},C=()=>{if(s.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(s.value,p))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(p,o)=>{const y=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),V=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ti,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",li,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",oi,[e.createElementVNode("table",ni,[e.createElementVNode("thead",ri,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",ai,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",di,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",si,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,ci)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,mi)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",ii,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",pi,"已上傳")):(e.openBlock(),e.createElementBlock("span",Vi,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>d(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",fi,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ni,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,Ei),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:f=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,bi)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ki,[e.createElementVNode("table",gi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(s).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",yi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>x(!0)),disabled:e.unref(N),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ui)])):e.createCommentVNode("",!0)],64)}}},Bi={class:"block"},hi={class:"mt-4"},$i={class:"table-responsive mt-3 mb-0"},Ci={class:"table align-middle gray-table"},_i={key:0,width:"1"},Ti={key:0},wi={class:"d-flex gap-2"},Di=["onClick"],Fi={class:"table-responsive mt-3 mb-0"},Si={class:"table align-middle gray-table"},Ai={class:"mt-4"},Ui={class:"table align-middle gray-table side-table"},Mi={key:0,class:"block-bottom bg-light-teal"},Oi={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.computed(()=>z("literacy",n.value.Status,4)),a=e.ref({}),l=e.computed(()=>E.value.filter(p=>!p.Deleted)),n=e.ref({}),d=()=>E.value.push({}),c=_,r=()=>{rxjs.forkJoin([A.literacy("getBenefit",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=o.Benefits,E.value.length||d(),I().init("literacy",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},g=p=>p.Deleted=!0,x=p=>{var y,b;if(a.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:n.value,Benefits:E.value,Before:(y=s.value)==null?void 0:y.Form4Before,After:(b=s.value)==null?void 0:b.Form4After,Submit:p?"true":"false"};A.literacy("saveBenefit",o).subscribe(()=>{p?c("next"):r()})},C=()=>{let p={Benefit:"不可量化成果"};return a.value=O(n.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((o,y)=>Object.assign(a.value,O(o,p,`item-${y}-`))),s.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,O(s.value,p))),!Object.keys(a.value).length};return e.onMounted(r),e.provide("editable",N),(p,o)=>{const y=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),V=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Bi,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",hi,[e.createElementVNode("div",$i,[e.createElementVNode("table",Ci,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"目標值",-1)),o[7]||(o[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",_i,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${i}-Title`],modelValue:m.Title,"onUpdate:modelValue":t=>m.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${i}-Target`],modelValue:m.Target,"onUpdate:modelValue":t=>m.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a)[`item-${i}-Description`],rows:"1",modelValue:m.Description,"onUpdate:modelValue":t=>m.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",Ti,[e.createElementVNode("div",wi,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>g(m),type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Di)):e.createCommentVNode("",!0),i+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Fi,[e.createElementVNode("table",Si,[o[10]||(o[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(n).Benefit=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ai,[e.createElementVNode("table",Ui,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form4Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":o[2]||(o[2]=m=>e.unref(s).Form4After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",Mi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[3]||(o[3]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[4]||(o[4]=m=>x(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ji={class:"block"},Ii={class:"mt-4"},Pi={class:"table-responsive mt-3 mb-0"},qi={class:"table align-middle gray-table"},Li={class:"text-end"},Ri={class:"text-end"},zi={class:"table-responsive"},Gi={class:"table align-middle gray-table"},Ji=["colspan"],Qi={key:0,width:"1"},Wi={class:"text-end"},Yi={key:0},Hi={class:"d-flex gap-2"},Ki=["onClick"],Zi={class:"mt-4"},Xi={class:"table-responsive mt-3 mb-0"},vi={class:"table align-middle gray-table"},ep={key:0,width:"1"},tp={class:"text-end"},lp={key:0},op={class:"d-flex gap-2"},np=["onClick"],rp={class:"mt-4"},ap={class:"table align-middle gray-table side-table"},dp={key:0,class:"block-bottom bg-light-teal"},sp={class:"text-center"},cp={class:"mb-5"},mp={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.computed(()=>z("literacy",n.value.Status,3)),N=e.ref({}),a=e.computed(()=>c.value.filter(i=>!i.Deleted)),l=e.computed(()=>r.value.filter(i=>!i.Deleted)),n=e.ref({}),d=e.ref(),c=e.ref([]),r=e.ref([]),g=e.ref({}),x=e.ref(0),C=()=>c.value.push({}),p=()=>r.value.push({}),o=_,y=()=>{rxjs.forkJoin([A.literacy("getFunding",{ID:B.id})]).subscribe(i=>{const t=i[0];n.value=t.Project,c.value=t.OtherSubsidies,r.value=t.BudgetPlans,g.value=t.GrantTargetSetting,c.value.length||C(),r.value.length||p(),I().init("literacy",n.value),E.value=n.value.changeApply,n.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=(i,t)=>{var k,U;if(N.value={},i&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&n.value.ApplyAmount>g.value.GrantLimit*1e4){d.value.show(()=>V(i,!0));return}const f={Project:n.value,OtherSubsidies:c.value,BudgetPlans:r.value,Before:(k=E.value)==null?void 0:k.Form3Before,After:(U=E.value)==null?void 0:U.Form3After,Submit:i?"true":"false"};A.literacy("saveFunding",f).subscribe(()=>{i?o("next"):y()})},m=()=>{let i={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=O(n.value,i),i={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},c.value.forEach((t,f)=>Object.assign(N.value,O(t,i,`other-${f}-`))),i={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,f)=>Object.assign(N.value,O(t,i,`plan-${f}-`))),E.value&&(i={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,O(E.value,i))),!Object.keys(N.value).length};return e.onMounted(y),e.provide("editable",s),e.watchEffect(()=>{n.value.OtherAmount=a.value.reduce((i,t)=>i+R(t.Amount),0),x.value=R(n.value.ApplyAmount)+R(n.value.SelfAmount)+R(n.value.OtherAmount),a.value.forEach(i=>i.percent=Math.round(R(i.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(i=>i.sum=R(i.Amount)+R(i.OtherAmount))}),(i,t)=>{var M;const f=e.resolveComponent("input-integer"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),S=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ji,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Ii,[e.createElementVNode("div",Pi,[e.createElementVNode("table",qi,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(n).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(n).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Li,e.toDisplayString((M=e.unref(n).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Ri,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",zi,[e.createElementVNode("table",Gi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Ji)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",Qi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,h)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(N)[`other-${h}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":T=>F.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`other-${h}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Wi,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`other-${h}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":T=>F.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",Yi,[e.createElementVNode("div",Hi,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>b(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ki)):e.createCommentVNode("",!0),h+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Zi,[e.createElementVNode("div",Xi,[e.createElementVNode("table",vi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",ep,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(F,h)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(N)[`plan-${h}-Title`],modelValue:F.Title,"onUpdate:modelValue":T=>F.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`plan-${h}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`plan-${h}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":T=>F.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",tp,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`plan-${h}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":T=>F.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",lp,[e.createElementVNode("div",op,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>b(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,np)):e.createCommentVNode("",!0),h+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",rp,[e.createElementVNode("table",ap,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(E).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(E).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(E).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(E).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",dp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>V(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(S,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",sp,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",cp,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(g).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},ip={class:"block"},pp={class:"text-teal fw-bold py-3"},Vp={class:"table-responsive"},fp={class:"table align-middle gray-table"},Np={class:"text-end"},Ep={class:"mt-4"},bp={class:"table align-middle gray-table"},kp={class:"text-center"},gp={key:0,width:"180"},yp={class:"text-center"},up=["href"],xp={key:0,class:"text-center"},Bp={key:0},hp={key:1,class:"text-pink"},$p={key:1,class:"tag-group mt-2 gap-1"},Cp={key:0,class:"tag tag-green-light"},_p=["download","href"],Tp=["onClick"],wp={class:"block-bottom bg-light-teal"},Dp=!0,Fp={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(0),s=e.ref({}),N=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]}]);e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0);const a=(d,c)=>{c.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:c.Path,Name:s.value.ProjectID+"_請款_"+(d.Multiple?c.Name:`${d.Title}.pdf`)})},l=A.download,n=d=>{};return e.onMounted(()=>{A.literacy("findApplication",{ID:B.id}).subscribe(d=>{s.value=d.Project,I().init("literacy",s.value),N.value=N.value.filter(c=>{var r;return!((r=c.Excludes)!=null&&r.includes(s.value.OrgCategory))}),N.value.forEach(c=>{c.Uploaded=e.computed(()=>c.Files.filter(r=>!r.Deleted).length)})})}),e.provide("editable",Dp),(d,c)=>{var x;const r=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ip,[c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後進行請款，預撥100%）",-1)),e.createElementVNode("p",pp,"核定經費: "+e.toDisplayString((x=e.unref(s).ApprovedAmount)==null?void 0:x.toLocaleString())+"元",1),e.createElementVNode("div",Vp,[e.createElementVNode("table",fp,[c[6]||(c[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Np,e.toDisplayString(e.unref(s).ApprovedAmount),1),c[2]||(c[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[3]||(c[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[4]||(c[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[5]||(c[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),c[13]||(c[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),c[14]||(c[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Ep,[e.createElementVNode("table",bp,[e.createElementVNode("thead",kp,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),c[8]||(c[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",gp,"狀態")),c[9]||(c[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(C,p)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",yp,e.toDisplayString(p+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Title),1)]),_:2},1024)]),C.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:C.Template,style:{width:"140px"},type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,up)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",xp,[C.Uploaded?(e.openBlock(),e.createElementBlock("span",Bp,"已上傳")):(e.openBlock(),e.createElementBlock("span",hp,"尚未上傳"))])),e.createElementVNode("td",null,[C.Multiple||!C.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:o=>a(C,o)},null,8,["onFile"])):e.createCommentVNode("",!0),C.Uploaded?(e.openBlock(),e.createElementBlock("div",$p,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Cp,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,_p),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>o.Deleted=!0,type:"button"},[...c[11]||(c[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Tp))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",wp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[0]||(c[0]=C=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[1]||(c[1]=C=>n()),type:"button"},[...c[15]||(c[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Sp={class:"block"},Ap={class:"text-teal fw-bold py-3"},Up={class:"text-teal fw-bold pb-3"},Mp={class:"table-responsive"},Op={class:"table align-middle gray-table"},jp={class:"text-end"},Ip={class:"text-end"},Pp={class:"text-end"},qp={class:"mt-4"},Lp={class:"table align-middle gray-table"},Rp={class:"text-center"},zp={key:0,width:"180"},Gp={class:"text-center"},Jp=["href"],Qp={key:0,class:"text-center"},Wp={key:0},Yp={key:1,class:"text-pink"},Hp={key:1,class:"tag-group mt-2 gap-1"},Kp={key:0,class:"tag tag-green-light"},Zp=["download","href"],Xp=["onClick"],vp={class:"block-bottom bg-light-teal"},eV=!0,tV={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(8e4),s=e.ref({}),N=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/LIT/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/LIT/3-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/LIT/4-補助清單.docx",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_結案核銷_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.literacy("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("literacy",s.value),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",eV),(c,r)=>{var p;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Sp,[r[10]||(r[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",Ap,"核定經費: "+e.toDisplayString((p=e.unref(s).ApprovedAmount)==null?void 0:p.toLocaleString())+"元",1),e.createElementVNode("p",Up,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(E)).toLocaleString())+"元",1),e.createElementVNode("div",Mp,[e.createElementVNode("table",Op,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",jp,e.toDisplayString(e.unref(s).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=o=>e.isRef(E)?E.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",Ip,e.toDisplayString(e.unref(a))+"%",1),e.createElementVNode("td",Pp,e.toDisplayString(e.unref(a))+"%",1)])])])]),r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[12]||(r[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",qp,[e.createElementVNode("table",Lp,[e.createElementVNode("thead",Rp,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",zp,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(o,y)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Gp,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Jp)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Qp,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Wp,"已上傳")):(e.openBlock(),e.createElementBlock("span",Yp,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Hp,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Kp,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(n)(b.Path)},e.toDisplayString(b.Name),9,Zp),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>b.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xp))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",vp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=o=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=o=>d()),type:"button"},[...r[13]||(r[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},lV={__name:"ProgressBar",setup(u){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(B,E)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"literacy"})}}},oV={class:"block"},nV={class:"mt-4"},rV={class:"table align-middle gray-table side-table"},aV={key:0,class:"d-flex align-items-center gap-2"},dV={class:"input-group w-auto"},sV={class:"text-teal-dark"},cV={key:1,class:"invalid mt-0"},mV={class:"table-responsive mt-4"},iV={class:"table align-middle gray-table"},pV={key:0},VV={class:"input-group"},fV={key:0,class:"invalid mt-0"},NV={key:0},EV={class:"d-flex gap-2"},bV=["onClick"],kV={class:"mt-4"},gV={class:"table align-middle gray-table"},yV={key:0},uV=["value"],xV={key:0},BV={class:"d-flex gap-2"},hV=["onClick"],$V={class:"mt-4"},CV={class:"table align-middle gray-table side-table"},_V={key:0,class:"block-bottom bg-light-teal"},TV={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),N=e.computed(()=>r.value.EndDate),a=e.computed(()=>z("literacy",c.value.Status,2)),l=e.ref({}),n=e.computed(()=>g.value.filter(i=>!i.Deleted)),d=e.computed(()=>x.value.filter(i=>!i.Deleted)),c=e.ref({}),r=e.ref({}),g=e.ref([]),x=e.ref([]),C=()=>A.literacy("createItem",{ID:B.id}).subscribe(i=>g.value.push(i)),p=()=>x.value.push({Type:0,ItemID:0}),o=_,y=()=>{rxjs.forkJoin([A.literacy("getWorkSchedule",{ID:B.id})]).subscribe(i=>{const t=i[0];c.value=t.Project,r.value=t.GrantType,g.value=t.Items,x.value=t.Schedules,g.value.length||C(),x.value.length||p(),I().init("literacy",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=i=>{var f,k;if(l.value={},i&&!m()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:c.value,Items:g.value,Schedules:x.value,Before:(f=s.value)==null?void 0:f.Form2Before,After:(k=s.value)==null?void 0:k.Form2After,Submit:i?"true":"false"};A.literacy("saveWorkSchedule",t).subscribe(()=>{i?o("next"):y()})},m=()=>{let i={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(c.value,i),i={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},n.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`item-${f}-`))),i={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`schedule-${f}-`))),s.value&&(i={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(s.value,i))),!Object.keys(l.value).length};return e.onMounted(y),e.provide("editable",a),(i,t)=>{const f=e.resolveComponent("required-label"),k=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oV,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",nV,[e.createElementVNode("table",rV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",aV,[e.createElementVNode("div",dV,[e.createVNode(k,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[0]||(t[0]=h=>e.unref(c).StartTime=h)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[1]||(t[1]=h=>e.unref(c).EndTime=h)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",sV,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(N)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",cV,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",mV,[e.createElementVNode("table",iV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",pV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`item-${T}-Title`],modelValue:h.Title,"onUpdate:modelValue":D=>h.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",VV,[e.createVNode(S,{"empty-value":0,modelValue:h.Begin,"onUpdate:modelValue":D=>h.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(S,{"empty-value":0,modelValue:h.End,"onUpdate:modelValue":D=>h.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${T}-Begin`]||e.unref(l)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",fV,e.toDisplayString(e.unref(l)[`item-${T}-Begin`]||e.unref(l)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`item-${T}-Deadline`],modelValue:h.Deadline,"onUpdate:modelValue":D=>h.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`item-${T}-Content`],rows:"1",modelValue:h.Content,"onUpdate:modelValue":D=>h.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",NV,[e.createElementVNode("div",EV,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(h),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bV)):e.createCommentVNode("",!0),T+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",kV,[e.createElementVNode("table",gV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",yV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${T}-Type`],options:E,modelValue:h.Type,"onUpdate:modelValue":D=>h.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${T}-ItemID`],options:e.unref(n),modelValue:h.ItemID,"onUpdate:modelValue":D=>h.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:j})=>[e.createElementVNode("option",{value:j.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(j.Title),9,uV)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`schedule-${T}-Deadline`],modelValue:h.Deadline,"onUpdate:modelValue":D=>h.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`schedule-${T}-Content`],rows:"1",modelValue:h.Content,"onUpdate:modelValue":D=>h.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",xV,[e.createElementVNode("div",BV,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(h),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,hV)):e.createCommentVNode("",!0),T+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$V,[e.createElementVNode("table",CV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=h=>e.unref(s).Form2Before=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=h=>e.unref(s).Form2After=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",_V,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=h=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=h=>V(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},wV={class:"block"},DV={class:"mt-4"},FV={class:"table align-middle gray-table side-table"},SV={key:0},AV={key:1,class:"text-light-gray"},UV={class:"mt-4"},MV={class:"table align-middle gray-table side-table"},OV={class:"row g-3"},jV={class:"col-12 col-xl-2"},IV={class:"text-gray mb-2"},PV={class:"col-12 col-xl-3"},qV={class:"text-gray mb-2"},LV={class:"col-12 col-xl-4"},RV={class:"row g-1"},zV={class:"col-7"},GV={class:"col-5"},JV={class:"col-12 col-xl-3"},QV={class:"text-gray mb-2"},WV={class:"col-12"},YV={class:"text-gray mb-2"},HV={class:"mt-4"},KV={class:"table align-middle gray-table side-table"},ZV={class:"mt-4"},XV={class:"table align-middle gray-table side-table"},vV={key:0,class:"table-responsive mt-3 mb-0"},ef={class:"table align-middle gray-table"},tf={key:0},lf={key:0},of={class:"d-flex gap-2"},nf=["onClick"],rf={class:"mt-4"},af={class:"table align-middle gray-table side-table"},df={key:0,class:"block-bottom bg-light-teal"},sf={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.ref(),a=e.computed(()=>z("multiple",c.value.Status,1)),l=e.ref({}),n=e.ref([]),d=e.computed(()=>r.value.filter(V=>!V.Deleted)),c=e.ref({}),r=e.ref([]),g=e.computed({get:()=>!!d.value.length,set:V=>{V?x():r.value.forEach(m=>m.Deleted=!0)}}),x=()=>r.value.push({}),C=_,p=()=>{A.multiple("getApplication",{ID:B.id}).subscribe(V=>{c.value=V.Project,N.value=V.Contacts,r.value=V.ReceivedSubsidies,c.value.OrgCategory=c.value.OrgCategory||null,I().init("multiple",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},o=V=>V.Deleted=!0,y=V=>{var i,t;if(l.value={},V&&!b()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}const m={Project:c.value,Contacts:N.value,ReceivedSubsidies:r.value.filter(f=>f.ID||!f.Deleted),Before:(i=s.value)==null?void 0:i.Form1Before,After:(t=s.value)==null?void 0:t.Form1After,Submit:V?"true":"false"};A.multiple("saveApplication",m).subscribe(f=>{V?C("next",f.ID):c.value.ID?p():window.location.href=`Application.aspx?ID=${f.ID}`})},b=()=>{let V={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return l.value=O(c.value,V),V={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((m,i)=>Object.assign(l.value,O(m,V,`contact-${i}-`))),V={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},r.value.forEach((m,i)=>Object.assign(l.value,O(m,V,`received-${i}-`))),s.value&&(V={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(s.value,V))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.multiple("getZgsCodes",{CodeGroup:"MULField"}),A.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(V=>{n.value=V[0],E.value=V[1],B.id?p():A.multiple("getEmptyApplication").subscribe(m=>{c.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},m),N.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("multiple",c.value)})})}),e.provide("editable",a),(V,m)=>{const i=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),f=e.resolveComponent("input-select"),k=e.resolveComponent("input-textarea"),U=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",wV,[m[43]||(m[43]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",DV,[e.createElementVNode("table",FV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[m[15]||(m[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).Year),1)]),e.createElementVNode("tr",null,[m[16]||(m[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(c).ProjectID?(e.openBlock(),e.createElementBlock("span",SV,e.toDisplayString(e.unref(c).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",AV,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[m[17]||(m[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[18]||(m[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).ProjectName,modelValue:e.unref(c).ProjectName,"onUpdate:modelValue":m[0]||(m[0]=S=>e.unref(c).ProjectName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[19]||(m[19]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{"empty-value":null,error:e.unref(l).Field,options:e.unref(n),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).Field,"onUpdate:modelValue":m[1]||(m[1]=S=>e.unref(c).Field=S)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[20]||(m[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(c).OrgName,"onUpdate:modelValue":m[2]||(m[2]=S=>e.unref(c).OrgName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[21]||(m[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).OrgCategory,"onUpdate:modelValue":m[3]||(m[3]=S=>e.unref(c).OrgCategory=S)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[22]||(m[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(c).TaxID,"onUpdate:modelValue":m[4]||(m[4]=S=>e.unref(c).TaxID=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[23]||(m[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(c).Address,"onUpdate:modelValue":m[5]||(m[5]=S=>e.unref(c).Address=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),m[44]||(m[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",UV,[e.createElementVNode("table",MV,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(S,M)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(S.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",OV,[e.createElementVNode("div",jV,[e.createElementVNode("div",IV,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[24]||(m[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-Name`],modelValue:S.Name,"onUpdate:modelValue":F=>S.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",PV,[e.createElementVNode("div",qV,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[25]||(m[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-JobTitle`],modelValue:S.JobTitle,"onUpdate:modelValue":F=>S.JobTitle=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",LV,[m[26]||(m[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",RV,[e.createElementVNode("div",zV,[e.createVNode(t,{modelValue:S.Phone,"onUpdate:modelValue":F=>S.Phone=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",GV,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:S.PhoneExt,"onUpdate:modelValue":F=>S.PhoneExt=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",JV,[e.createElementVNode("div",QV,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[27]||(m[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-MobilePhone`],modelValue:S.MobilePhone,"onUpdate:modelValue":F=>S.MobilePhone=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",WV,[e.createElementVNode("div",YV,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[28]||(m[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-EMail`],modelValue:S.EMail,"onUpdate:modelValue":F=>S.EMail=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),m[45]||(m[45]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",HV,[e.createElementVNode("table",KV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[29]||(m[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[m[30]||(m[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(k,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(c).Target,"onUpdate:modelValue":m[6]||(m[6]=S=>e.unref(c).Target=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[31]||(m[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(c).Summary,"onUpdate:modelValue":m[7]||(m[7]=S=>e.unref(c).Summary=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[32]||(m[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Quantified,"onUpdate:modelValue":m[8]||(m[8]=S=>e.unref(c).Quantified=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[33]||(m[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Qualitative,"onUpdate:modelValue":m[9]||(m[9]=S=>e.unref(c).Qualitative=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ZV,[e.createElementVNode("table",XV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[m[39]||(m[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(U,{modelValue:e.unref(g),"onUpdate:modelValue":m[10]||(m[10]=S=>e.isRef(g)?g.value=S:null)},null,8,["modelValue"]),e.unref(g)?(e.openBlock(),e.createElementBlock("div",vV,[e.createElementVNode("table",ef,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[m[34]||(m[34]=e.createElementVNode("th",null,"計畫名稱",-1)),m[35]||(m[35]=e.createElementVNode("th",null,"補助單位",-1)),m[36]||(m[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",tf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(S,M)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l)[`received-${M}-Name`],modelValue:S.Name,"onUpdate:modelValue":F=>S.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l)[`received-${M}-Unit`],modelValue:S.Unit,"onUpdate:modelValue":F=>S.Unit=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`received-${M}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":F=>S.Amount=F},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",lf,[e.createElementVNode("div",of,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:F=>o(S),type:"button"},[...m[37]||(m[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nf)):e.createCommentVNode("",!0),M+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:x,type:"button"},[...m[38]||(m[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[m[42]||(m[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",rf,[e.createElementVNode("table",af,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[40]||(m[40]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":m[11]||(m[11]=S=>e.unref(s).Form1Before=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...m[41]||(m[41]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":m[12]||(m[12]=S=>e.unref(s).Form1After=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",df,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:m[13]||(m[13]=S=>y()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:m[14]||(m[14]=S=>y(!0)),type:"button"},[...m[46]||(m[46]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},cf={class:"block"},mf={key:0,class:"text-pink lh-base mt-4"},pf={class:"mt-4"},Vf={class:"table align-middle gray-table"},ff={class:"text-center"},Nf={key:0,width:"180"},Ef={class:"text-center"},bf={key:0},kf=["innerHTML"],gf=["href"],yf={key:0,class:"text-center"},uf={key:0},xf={key:1,class:"text-pink"},Bf={key:1,class:"tag-group mt-2 gap-1"},hf={key:0,class:"tag tag-green-light"},$f=["download","href"],Cf=["onClick"],_f={class:"mt-4"},Tf={class:"table align-middle gray-table side-table"},wf={key:0,class:"block-bottom bg-light-teal"},Df=["disabled"],Ff={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([{Type:1,Title:"申請表",Template:"../../Template/MUL/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/MUL/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/MUL/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/MUL/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),N=e.computed(()=>E.value.some(p=>!p.Optional&&!p.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("multiple",n.value.Status,2)),l=e.ref({}),n=e.ref({}),d=(p,o)=>{o.Type==="application/pdf"&&p.Files.push({Type:p.Type,Path:o.Path,Name:n.value.ProjectID+"_"+(p.Multiple?o.Name:`${p.Title}.pdf`)})},c=A.download,r=_,g=()=>{rxjs.forkJoin([A.multiple("getAttachment",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=E.value.filter(y=>{var b;return!((b=y.Excludes)!=null&&b.includes(n.value.OrgCategory))}),n.value.Status>=42&&E.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/MUL/6-著作權授權同意書.docx",Files:[]}),E.value.forEach(y=>{y.Files=o.Attachments.filter(b=>b.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(b=>!b.Deleted).length)}),I().init("multiple",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},x=p=>{var y,b;if(l.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:B.id,Attachments:E.value.reduce((V,m)=>V.concat(m.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(b=s.value)==null?void 0:b.Form5After,Submit:p?"true":"false"};A.multiple("saveAttachment",o).subscribe(()=>{p?r("next"):g()})},C=()=>{if(s.value){const p={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(s.value,p))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(p,o)=>{const y=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),V=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",cf,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",mf,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",pf,[e.createElementVNode("table",Vf,[e.createElementVNode("thead",ff,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Nf,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",Ef,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",bf,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,kf)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,gf)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",yf,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",uf,"已上傳")):(e.openBlock(),e.createElementBlock("span",xf,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>d(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Bf,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",hf,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,$f),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:f=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Cf)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_f,[e.createElementVNode("table",Tf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(s).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",wf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>x(!0)),disabled:e.unref(N),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Df)])):e.createCommentVNode("",!0)],64)}}},Sf={class:"block"},Af={class:"mt-4"},Uf={class:"table-responsive mt-3 mb-0"},Mf={class:"table align-middle gray-table"},Of={key:0,width:"1"},jf={key:0},If={class:"d-flex gap-2"},Pf=["onClick"],qf={class:"table-responsive mt-3 mb-0"},Lf={class:"table align-middle gray-table"},Rf={class:"mt-4"},zf={class:"table align-middle gray-table side-table"},Gf={key:0,class:"block-bottom bg-light-teal"},Jf={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref([]),s=e.ref(),N=e.computed(()=>z("multiple",n.value.Status,4)),a=e.ref({}),l=e.computed(()=>E.value.filter(p=>!p.Deleted)),n=e.ref({}),d=()=>E.value.push({}),c=_,r=()=>{rxjs.forkJoin([A.multiple("getBenefit",{ID:B.id})]).subscribe(p=>{const o=p[0];n.value=o.Project,E.value=o.Benefits,E.value.length||d(),I().init("multiple",n.value),s.value=n.value.changeApply,n.value.changeApply=void 0})},g=p=>p.Deleted=!0,x=p=>{var y,b;if(a.value={},p&&!C()){e.nextTick(()=>{var V;return(V=document.querySelector(".invalid"))==null?void 0:V.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:n.value,Benefits:E.value,Before:(y=s.value)==null?void 0:y.Form4Before,After:(b=s.value)==null?void 0:b.Form4After,Submit:p?"true":"false"};A.multiple("saveBenefit",o).subscribe(()=>{p?c("next"):r()})},C=()=>{let p={Benefit:"不可量化成果"};return a.value=O(n.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((o,y)=>Object.assign(a.value,O(o,p,`item-${y}-`))),s.value&&(p={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,O(s.value,p))),!Object.keys(a.value).length};return e.onMounted(r),e.provide("editable",N),(p,o)=>{const y=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),V=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Sf,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Af,[e.createElementVNode("div",Uf,[e.createElementVNode("table",Mf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"目標值",-1)),o[7]||(o[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(N)?(e.openBlock(),e.createElementBlock("th",Of,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,i)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${i}-Title`],modelValue:m.Title,"onUpdate:modelValue":t=>m.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${i}-Target`],modelValue:m.Target,"onUpdate:modelValue":t=>m.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a)[`item-${i}-Description`],rows:"1",modelValue:m.Description,"onUpdate:modelValue":t=>m.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(N)?(e.openBlock(),e.createElementBlock("td",jf,[e.createElementVNode("div",If,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>g(m),type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Pf)):e.createCommentVNode("",!0),i+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",qf,[e.createElementVNode("table",Lf,[o[10]||(o[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(n).Benefit=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Rf,[e.createElementVNode("table",zf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(s).Form4Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":o[2]||(o[2]=m=>e.unref(s).Form4After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",Gf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[3]||(o[3]=m=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[4]||(o[4]=m=>x(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Qf={class:"block"},Wf={class:"mt-4"},Yf={class:"table-responsive mt-3 mb-0"},Hf={class:"table align-middle gray-table"},Kf={class:"text-end"},Zf={class:"text-end"},Xf={class:"table-responsive"},vf={class:"table align-middle gray-table"},eN=["colspan"],tN={key:0,width:"1"},lN={class:"text-end"},oN={key:0},nN={class:"d-flex gap-2"},rN=["onClick"],aN={class:"mt-4"},dN={class:"table-responsive mt-3 mb-0"},sN={class:"table align-middle gray-table"},cN={key:0,width:"1"},mN={class:"text-end"},iN={key:0},pN={class:"d-flex gap-2"},VN=["onClick"],fN={class:"mt-4"},NN={class:"table align-middle gray-table side-table"},EN={key:0,class:"block-bottom bg-light-teal"},bN={class:"text-center"},kN={class:"mb-5"},gN={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(),s=e.computed(()=>z("multiple",n.value.Status,3)),N=e.ref({}),a=e.computed(()=>c.value.filter(i=>!i.Deleted)),l=e.computed(()=>r.value.filter(i=>!i.Deleted)),n=e.ref({}),d=e.ref(),c=e.ref([]),r=e.ref([]),g=e.ref({}),x=e.ref(0),C=()=>c.value.push({}),p=()=>r.value.push({}),o=_,y=()=>{rxjs.forkJoin([A.multiple("getFunding",{ID:B.id})]).subscribe(i=>{const t=i[0];n.value=t.Project,c.value=t.OtherSubsidies,r.value=t.BudgetPlans,g.value=t.GrantTargetSetting,c.value.length||C(),r.value.length||p(),I().init("multiple",n.value),E.value=n.value.changeApply,n.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=(i,t)=>{var k,U;if(N.value={},i&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&n.value.ApplyAmount>g.value.GrantLimit*1e4){d.value.show(()=>V(i,!0));return}const f={Project:n.value,OtherSubsidies:c.value,BudgetPlans:r.value,Before:(k=E.value)==null?void 0:k.Form3Before,After:(U=E.value)==null?void 0:U.Form3After,Submit:i?"true":"false"};A.multiple("saveFunding",f).subscribe(()=>{i?o("next"):y()})},m=()=>{let i={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return N.value=O(n.value,i),i={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},c.value.forEach((t,f)=>Object.assign(N.value,O(t,i,`other-${f}-`))),i={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,f)=>Object.assign(N.value,O(t,i,`plan-${f}-`))),E.value&&(i={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(N.value,O(E.value,i))),!Object.keys(N.value).length};return e.onMounted(y),e.provide("editable",s),e.watchEffect(()=>{n.value.OtherAmount=a.value.reduce((i,t)=>i+R(t.Amount),0),x.value=R(n.value.ApplyAmount)+R(n.value.SelfAmount)+R(n.value.OtherAmount),a.value.forEach(i=>i.percent=Math.round(R(i.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(i=>i.sum=R(i.Amount)+R(i.OtherAmount))}),(i,t)=>{var M;const f=e.resolveComponent("input-integer"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),S=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Qf,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Wf,[e.createElementVNode("div",Yf,[e.createElementVNode("table",Hf,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(n).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(n).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Kf,e.toDisplayString((M=e.unref(n).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Zf,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Xf,[e.createElementVNode("table",vf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,eN)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",tN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,h)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(N)[`other-${h}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":T=>F.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`other-${h}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",lN,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`other-${h}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":T=>F.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",oN,[e.createElementVNode("div",nN,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>b(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,rN)):e.createCommentVNode("",!0),h+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",aN,[e.createElementVNode("div",dN,[e.createElementVNode("table",sN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",cN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(F,h)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(N)[`plan-${h}-Title`],modelValue:F.Title,"onUpdate:modelValue":T=>F.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`plan-${h}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(N)[`plan-${h}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":T=>F.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",mN,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N)[`plan-${h}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":T=>F.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",iN,[e.createElementVNode("div",pN,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>b(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,VN)):e.createCommentVNode("",!0),h+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",fN,[e.createElementVNode("table",NN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).Form3Before,rows:"4",modelValue:e.unref(E).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(E).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(N).Form3After,rows:"4",modelValue:e.unref(E).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(E).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",EN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>V(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(S,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",bN,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",kN,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(g).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},yN={class:"block"},uN={class:"text-teal fw-bold py-3"},xN={class:"table-responsive"},BN={class:"table align-middle gray-table"},hN={class:"text-end"},$N={class:"mt-4"},CN={class:"table align-middle gray-table"},_N={class:"text-center"},TN={key:0,width:"180"},wN={class:"text-center"},DN=["href"],FN={key:0,class:"text-center"},SN={key:0},AN={key:1,class:"text-pink"},UN={key:1,class:"tag-group mt-2 gap-1"},MN={key:0,class:"tag tag-green-light"},ON=["download","href"],jN=["onClick"],IN={class:"block-bottom bg-light-teal"},PN=!0,qN={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(0),s=e.ref({}),N=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]}]),a=(d,c)=>{c.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:c.Path,Name:s.value.ProjectID+"_第一期_"+(d.Multiple?c.Name:`${d.Title}.pdf`)})},l=A.download,n=d=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:B.id}).subscribe(d=>{s.value=d.Project,I().init("multiple",s.value),E.value=Math.round(s.value.ApprovedAmount*.7),N.value.forEach(c=>{c.Uploaded=e.computed(()=>c.Files.filter(r=>!r.Deleted).length)})})}),e.provide("editable",PN),(d,c)=>{var x;const r=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yN,[c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後請款，第一期預撥70%）",-1)),e.createElementVNode("p",uN,"核定經費: "+e.toDisplayString((x=e.unref(s).ApprovedAmount)==null?void 0:x.toLocaleString())+"元",1),e.createElementVNode("div",xN,[e.createElementVNode("table",BN,[c[6]||(c[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",hN,e.toDisplayString(e.unref(E)),1),c[2]||(c[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[3]||(c[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[4]||(c[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[5]||(c[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),c[13]||(c[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),c[14]||(c[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",$N,[e.createElementVNode("table",CN,[e.createElementVNode("thead",_N,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),c[8]||(c[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",TN,"狀態")),c[9]||(c[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(C,p)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",wN,e.toDisplayString(p+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Title),1)]),_:2},1024)]),C.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:C.Template,style:{width:"140px"},type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,DN)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",FN,[C.Uploaded?(e.openBlock(),e.createElementBlock("span",SN,"已上傳")):(e.openBlock(),e.createElementBlock("span",AN,"尚未上傳"))])),e.createElementVNode("td",null,[C.Multiple||!C.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:o=>a(C,o)},null,8,["onFile"])):e.createCommentVNode("",!0),C.Uploaded?(e.openBlock(),e.createElementBlock("div",UN,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",MN,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,ON),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>o.Deleted=!0,type:"button"},[...c[11]||(c[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,jN))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",IN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[0]||(c[0]=C=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[1]||(c[1]=C=>n()),type:"button"},[...c[15]||(c[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},LN={class:"block"},RN={class:"text-teal fw-bold py-3"},zN={class:"table-responsive"},GN={class:"table align-middle gray-table"},JN={class:"text-end"},QN={class:"text-end"},WN={class:"text-end"},YN={class:"text-end"},HN={class:"mt-4"},KN={class:"table align-middle gray-table"},ZN={class:"text-center"},XN={key:0,width:"180"},vN={class:"text-center"},e1=["href"],t1={key:0,class:"text-center"},l1={key:0},o1={key:1,class:"text-pink"},n1={key:1,class:"tag-group mt-2 gap-1"},r1={key:0,class:"tag tag-green-light"},a1=["download","href"],d1=["onClick"],s1={class:"block-bottom bg-light-teal"},c1=!0,m1={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(3e4),s=e.ref(0),N=e.ref({}),a=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),l=e.computed(()=>N.value.ApprovedAmount?Math.min(Math.round(E.value*100/N.value.ApprovedAmount*100)/100,100):0),n=e.computed(()=>s.value?Math.min(Math.round(E.value*100/s.value*100)/100,100):0),d=(g,x)=>{x.Type==="application/pdf"&&g.Files.push({Type:g.Type,Path:x.Path,Name:N.value.ProjectID+"_第二期_"+(g.Multiple?x.Name:`${g.Title}.pdf`)})},c=A.download,r=g=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:B.id}).subscribe(g=>{N.value=g.Project,I().init("multiple",N.value),s.value=Math.round(N.value.ApprovedAmount*.7),a.value.forEach(x=>{x.Uploaded=e.computed(()=>x.Files.filter(C=>!C.Deleted).length)})})}),e.provide("editable",c1),(g,x)=>{var y;const C=e.resolveComponent("input-integer"),p=e.resolveComponent("required-label"),o=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",LN,[x[9]||(x[9]=e.createElementVNode("h5",{class:"square-title"},"實際請款（於 9/30 前請款，須執行完成第一期款至少60%）（第二期預撥30%）",-1)),e.createElementVNode("p",RN,"核定經費: "+e.toDisplayString((y=e.unref(N).ApprovedAmount)==null?void 0:y.toLocaleString())+"元",1),e.createElementVNode("div",zN,[e.createElementVNode("table",GN,[x[3]||(x[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",JN,e.toDisplayString(e.unref(N).ApprovedAmount-e.unref(s)),1),e.createElementVNode("td",QN,e.toDisplayString(e.unref(s)),1),e.createElementVNode("td",null,[e.createVNode(C,{modelValue:e.unref(E),"onUpdate:modelValue":x[0]||(x[0]=b=>e.isRef(E)?E.value=b:null)},null,8,["modelValue"])]),e.createElementVNode("td",WN,e.toDisplayString(e.unref(l))+"%",1),e.createElementVNode("td",YN,e.toDisplayString(e.unref(n))+"%",1)])])])]),x[10]||(x[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),x[11]||(x[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",HN,[e.createElementVNode("table",KN,[e.createElementVNode("thead",ZN,[e.createElementVNode("tr",null,[x[4]||(x[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),x[5]||(x[5]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",XN,"狀態")),x[6]||(x[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(b,V)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",vN,e.toDisplayString(V+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(p,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024)]),b.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:b.Template,style:{width:"140px"},type:"button"},[...x[7]||(x[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,e1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",t1,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",l1,"已上傳")):(e.openBlock(),e.createElementBlock("span",o1,"尚未上傳"))])),e.createElementVNode("td",null,[b.Multiple||!b.Uploaded?(e.openBlock(),e.createBlock(o,{key:0,accept:".pdf",onFile:m=>d(b,m)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",n1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,m=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:m},[m.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",r1,[e.createElementVNode("a",{class:"tag-link my-1",download:m.Name,href:e.unref(c)(m.Path)},e.toDisplayString(m.Name),9,a1),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>m.Deleted=!0,type:"button"},[...x[8]||(x[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,d1))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",s1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:x[1]||(x[1]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:x[2]||(x[2]=b=>r()),type:"button"},[...x[12]||(x[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},i1={class:"block"},p1={class:"text-teal fw-bold py-3"},V1={class:"text-teal fw-bold pb-3"},f1={class:"table-responsive"},N1={class:"table align-middle gray-table"},E1={class:"text-end"},b1={class:"text-end"},k1={class:"text-end"},g1={class:"mt-4"},y1={class:"table align-middle gray-table"},u1={class:"text-center"},x1={key:0,width:"180"},B1={class:"text-center"},h1=["href"],$1={key:0,class:"text-center"},C1={key:0},_1={key:1,class:"text-pink"},T1={key:1,class:"tag-group mt-2 gap-1"},w1={key:0,class:"tag tag-green-light"},D1=["download","href"],F1=["onClick"],S1={class:"text-center"},A1={colspan:"2"},U1={class:"block-bottom bg-light-teal"},M1=!0,O1={__name:"Payment3",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref(8e4),s=e.ref({}),N=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(E.value*100/s.value.ApprovedAmount*100)/100,100):0),l=(c,r)=>{r.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:r.Path,Name:s.value.ProjectID+"_結案核銷_"+(c.Multiple?r.Name:`${c.Title}.pdf`)})},n=A.download,d=c=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:B.id}).subscribe(c=>{s.value=c.Project,I().init("multiple",s.value),N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",M1),(c,r)=>{var o;const g=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),C=e.resolveComponent("input-file"),p=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",i1,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",p1,"核定經費: "+e.toDisplayString((o=e.unref(s).ApprovedAmount)==null?void 0:o.toLocaleString())+"元",1),e.createElementVNode("p",V1,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(E)).toLocaleString())+"元",1),e.createElementVNode("div",f1,[e.createElementVNode("table",N1,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",E1,e.toDisplayString(e.unref(s).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(E),"onUpdate:modelValue":r[0]||(r[0]=y=>e.isRef(E)?E.value=y:null)},null,8,["modelValue"])]),e.createElementVNode("td",b1,e.toDisplayString(e.unref(a))+"%",1),e.createElementVNode("td",k1,e.toDisplayString(e.unref(a))+"%",1)])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",g1,[e.createElementVNode("table",y1,[e.createElementVNode("thead",u1,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",x1,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(y,b)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",B1,e.toDisplayString(b+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Title),1)]),_:2},1024)]),y.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:y.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,h1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",$1,[y.Uploaded?(e.openBlock(),e.createElementBlock("span",C1,"已上傳")):(e.openBlock(),e.createElementBlock("span",_1,"尚未上傳"))])),e.createElementVNode("td",null,[y.Multiple||!y.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:V=>l(y,V)},null,8,["onFile"])):e.createCommentVNode("",!0),y.Uploaded?(e.openBlock(),e.createElementBlock("div",T1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.Files,V=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:V},[V.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",w1,[e.createElementVNode("a",{class:"tag-link my-1",download:V.Name,href:e.unref(n)(V.Path)},e.toDisplayString(V.Name),9,D1),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:m=>V.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,F1))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128)),e.createElementVNode("tr",null,[e.createElementVNode("td",S1,e.toDisplayString(e.unref(N).length+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[...r[10]||(r[10]=[e.createTextVNode("其他資料（5分鐘精華影片）",-1)])]),_:1})])]),e.createElementVNode("td",A1,[e.createVNode(p)])])])])])]),e.createElementVNode("div",U1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=y=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=y=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},j1={__name:"ProgressBar",setup(u){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(B,E)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"multiple"})}}},I1={class:"block"},P1={class:"mt-4"},q1={class:"table align-middle gray-table side-table"},L1={key:0,class:"d-flex align-items-center gap-2"},R1={class:"input-group w-auto"},z1={class:"text-teal-dark"},G1={key:1,class:"invalid mt-0"},J1={class:"table-responsive mt-4"},Q1={class:"table align-middle gray-table"},W1={key:0},Y1={class:"input-group"},H1={key:0,class:"invalid mt-0"},K1={key:0},Z1={class:"d-flex gap-2"},X1=["onClick"],v1={class:"mt-4"},eE={class:"table align-middle gray-table"},tE={key:0},lE=["value"],oE={key:0},nE={class:"d-flex gap-2"},rE=["onClick"],aE={class:"mt-4"},dE={class:"table align-middle gray-table side-table"},sE={key:0,class:"block-bottom bg-light-teal"},cE={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),N=e.computed(()=>r.value.EndDate),a=e.computed(()=>z("multiple",c.value.Status,2)),l=e.ref({}),n=e.computed(()=>g.value.filter(i=>!i.Deleted)),d=e.computed(()=>x.value.filter(i=>!i.Deleted)),c=e.ref({}),r=e.ref({}),g=e.ref([]),x=e.ref([]),C=()=>A.multiple("createItem",{ID:B.id}).subscribe(i=>g.value.push(i)),p=()=>x.value.push({Type:0,ItemID:0}),o=_,y=()=>{rxjs.forkJoin([A.multiple("getWorkSchedule",{ID:B.id})]).subscribe(i=>{const t=i[0];c.value=t.Project,r.value=t.GrantType,g.value=t.Items,x.value=t.Schedules,g.value.length||C(),x.value.length||p(),I().init("multiple",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},b=i=>i.Deleted=!0,V=i=>{var f,k;if(l.value={},i&&!m()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:c.value,Items:g.value,Schedules:x.value,Before:(f=s.value)==null?void 0:f.Form2Before,After:(k=s.value)==null?void 0:k.Form2After,Submit:i?"true":"false"};A.multiple("saveWorkSchedule",t).subscribe(()=>{i?o("next"):y()})},m=()=>{let i={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(c.value,i),i={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},n.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`item-${f}-`))),i={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,f)=>Object.assign(l.value,O(t,i,`schedule-${f}-`))),s.value&&(i={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(s.value,i))),!Object.keys(l.value).length};return e.onMounted(y),e.provide("editable",a),(i,t)=>{const f=e.resolveComponent("required-label"),k=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",I1,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",P1,[e.createElementVNode("table",q1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(N)?(e.openBlock(),e.createElementBlock("div",L1,[e.createElementVNode("div",R1,[e.createVNode(k,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[0]||(t[0]=h=>e.unref(c).StartTime=h)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{class:"w-auto","max-date":e.unref(N),modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[1]||(t[1]=h=>e.unref(c).EndTime=h)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",z1,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(N)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",G1,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",J1,[e.createElementVNode("table",Q1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",W1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`item-${T}-Title`],modelValue:h.Title,"onUpdate:modelValue":D=>h.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Y1,[e.createVNode(S,{"empty-value":0,modelValue:h.Begin,"onUpdate:modelValue":D=>h.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(S,{"empty-value":0,modelValue:h.End,"onUpdate:modelValue":D=>h.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${T}-Begin`]||e.unref(l)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",H1,e.toDisplayString(e.unref(l)[`item-${T}-Begin`]||e.unref(l)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`item-${T}-Deadline`],modelValue:h.Deadline,"onUpdate:modelValue":D=>h.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`item-${T}-Content`],rows:"1",modelValue:h.Content,"onUpdate:modelValue":D=>h.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",K1,[e.createElementVNode("div",Z1,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(h),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,X1)):e.createCommentVNode("",!0),T+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",v1,[e.createElementVNode("table",eE,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",tE,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(h,T)=>(e.openBlock(),e.createElementBlock("tr",{key:h},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${T}-Type`],options:E,modelValue:h.Type,"onUpdate:modelValue":D=>h.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${T}-ItemID`],options:e.unref(n),modelValue:h.ItemID,"onUpdate:modelValue":D=>h.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:j})=>[e.createElementVNode("option",{value:j.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(j.Title),9,lE)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`schedule-${T}-Deadline`],modelValue:h.Deadline,"onUpdate:modelValue":D=>h.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`schedule-${T}-Content`],rows:"1",modelValue:h.Content,"onUpdate:modelValue":D=>h.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",oE,[e.createElementVNode("div",nE,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(h),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,rE)):e.createCommentVNode("",!0),T+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",aE,[e.createElementVNode("table",dE,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=h=>e.unref(s).Form2Before=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=h=>e.unref(s).Form2After=h),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",sE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=h=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=h=>V(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},mE={key:0,class:"scroll-bottom-panel"},iE={class:"d-flex flex-column gap-3 mb-3"},pE={class:"d-flex gap-2"},VE={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},fE={class:"text-nowrap my-2 d-flex align-items-center"},NE={__name:"ProjectChangeReview",props:{id:{type:[Number,String]},type:{type:String}},setup(u){const _=u,B=I(),E=[{value:1,text:"通過"},{value:2,text:"退回修改"}],s=e.ref({}),N=e.ref({ID:_.id,Result:1}),a=()=>{const n={};if(N.value.Result>1&&(n.Reason="原因"),s.value=O(N.value,n),Object.keys(s.value).length){l();return}A[_.type]("reviewApplicationChange",N.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=5")})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>N.value.Result,n=>{n>1&&l()}),(n,d)=>{const c=e.resolveComponent("input-radio-group"),r=e.resolveComponent("input-textarea");return e.unref(B)[u.type].organizer?(e.openBlock(),e.createElementBlock("div",mE,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",iE,[e.createElementVNode("li",pE,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",VE,[e.createElementVNode("div",fE,[e.createVNode(c,{options:E,modelValue:e.unref(N).Result,"onUpdate:modelValue":d[0]||(d[0]=g=>e.unref(N).Result=g)},null,8,["modelValue"])]),e.unref(N).Result>1?(e.openBlock(),e.createBlock(r,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(N).Reason,"onUpdate:modelValue":d[1]||(d[1]=g=>e.unref(N).Reason=g)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:a,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},EE={key:0,class:"scroll-bottom-panel"},bE={class:"d-flex flex-column gap-3 mb-3"},kE={class:"d-flex gap-2"},gE={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},yE={class:"text-nowrap my-2 d-flex align-items-center"},uE={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(u){const _=u,B=I(),E=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],s=e.ref({}),N=e.ref({ID:_.id,Result:1}),a=()=>{const n={};if(N.value.Result>1&&(n.Reason="原因"),s.value=O(N.value,n),Object.keys(s.value).length){l();return}A[_.type]("reviewApplication",N.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=4")})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>N.value.Result,n=>{n>1&&l()}),(n,d)=>{const c=e.resolveComponent("input-radio-group"),r=e.resolveComponent("input-textarea");return e.unref(B)[u.type].organizer?(e.openBlock(),e.createElementBlock("div",EE,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",bE,[e.createElementVNode("li",kE,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",gE,[e.createElementVNode("div",yE,[e.createVNode(c,{options:E,modelValue:e.unref(N).Result,"onUpdate:modelValue":d[0]||(d[0]=g=>e.unref(N).Result=g)},null,8,["modelValue"])]),e.unref(N).Result>1?(e.openBlock(),e.createBlock(r,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(N).Reason,"onUpdate:modelValue":d[1]||(d[1]=g=>e.unref(N).Reason=g)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:a,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},xE={class:"d-flex align-items-center gap-3"},BE={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},hE={class:"modal-content"},$E={class:"modal-header"},CE={class:"fs-24 fw-bold text-green-light"},_E={class:"modal-body"},TE={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},wE=["disabled"],DE={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(u){const _=u,B=e.computed(()=>!N.value||N.value===l[_.type].organizer),E=e.ref(),s=e.computed(()=>l[_.type].organizerName),N=e.ref(0),a=e.computed(()=>{var x;return(x=c.value.find(C=>C.UnitID===d.value))==null?void 0:x.reviewers}),l=I(),n=e.computed(()=>s.value?"移轉案件":"認領案件"),d=e.ref(0),c=e.ref([]),r=()=>{A[_.type]("queryReviewUnits").subscribe(x=>{c.value=x,rxjs.forkJoin(c.value.map(C=>A[_.type]("queryReviewersByUnit",{ID:C.UnitID}))).subscribe(C=>{C.forEach((p,o)=>{c.value[o].reviewers=p,p.some(y=>y.UserID===N.value)&&(d.value=c.value[o].UnitID)}),bootstrap.Modal.getOrCreateInstance(E.value).show()})})},g=()=>{A[_.type]("saveOrganizer",{ID:_.id,Organizer:N.value}).subscribe(x=>{x&&window.location.reload()})};return e.watch(s,()=>N.value=l[_.type].organizer),e.watch(d,()=>{a.value.some(x=>x.UserID===N.value)||(N.value=0)}),(x,C)=>{const p=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xE,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(s)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:r,type:"button"},e.toDisplayString(e.unref(n)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",BE,[e.createElementVNode("div",hE,[e.createElementVNode("div",$E,[e.createElementVNode("h4",CE,e.toDisplayString(e.unref(n)),1),C[2]||(C[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",_E,[e.createElementVNode("div",null,[C[3]||(C[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(p,{"empty-value":0,options:e.unref(c),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(d),"onUpdate:modelValue":C[0]||(C[0]=o=>e.isRef(d)?d.value=o:null)},null,8,["options","modelValue"]),e.createVNode(p,{class:"mt-2","empty-value":0,options:e.unref(a),"text-name":"Name","value-name":"UserID",modelValue:e.unref(N),"onUpdate:modelValue":C[1]||(C[1]=o=>e.isRef(N)?N.value=o:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",TE,[C[4]||(C[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:g,disabled:e.unref(B),type:"button"},"確認",8,wE)])])])])],512)]))],64)}}},FE={class:"step-line-wrapper"},SE={class:"step-line"},AE={key:0,class:"tag tag-white"},UE={key:1,class:"tag tag-white"},ME={key:0,class:"step-line"},OE={key:0,class:"tag tag-white"},jE={class:"step-line"},IE={key:0,class:"tag tag-white"},PE={key:0,class:"tag tag-white"},qE={__name:"ProjectProgress",props:{excludes:{default:[],type:Array},id:{type:[Number,String]},step:{required:!0,type:Number},type:{required:!0,type:String}},setup(u){const _=I(),B=u,E=s=>{location.href=`${s}.aspx?ID=${B.id}`};return(s,N)=>(e.openBlock(),e.createElementBlock("div",FE,[e.createElementVNode("div",SE,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:u.step===1}]),onClick:N[0]||(N[0]=a=>E("Audit")),role:"button"},[N[4]||(N[4]=e.createElementVNode("div",{class:"step-line-item-title"},"核定計畫",-1)),u.step===1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[[1,4].includes(e.unref(_)[B.type].changeStatus)?(e.openBlock(),e.createElementBlock("div",AE,"編輯中")):e.unref(_)[B.type].changeStatus===2?(e.openBlock(),e.createElementBlock("div",UE,"審核中")):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],2)]),u.excludes.includes(4)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",ME,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:u.step===4}]),onClick:N[1]||(N[1]=a=>E("Progress")),role:"button"},[N[5]||(N[5]=e.createElementVNode("div",{class:"step-line-item-title"},"每月進度",-1)),u.step===4?(e.openBlock(),e.createElementBlock("div",OE,"編輯中")):e.createCommentVNode("",!0)],2)])),e.createElementVNode("div",jE,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:u.step===5}]),onClick:N[2]||(N[2]=a=>E("Report")),role:"button"},[N[6]||(N[6]=e.createElementVNode("div",{class:"step-line-item-title"},"階段報告",-1)),u.step===5?(e.openBlock(),e.createElementBlock("div",IE,"編輯中")):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:u.step===6}]),onClick:N[3]||(N[3]=a=>E("Payment")),role:"button"},[N[7]||(N[7]=e.createElementVNode("div",{class:"step-line-item-title"},"請款核銷",-1)),u.step===6?(e.openBlock(),e.createElementBlock("div",PE,"編輯中")):e.createCommentVNode("",!0)],2)])]))}},LE={class:"block"},RE={class:"square-title"},zE=["innerHTML"],GE={class:"table-responsive mt-3"},JE={class:"table align-middle gray-table"},QE={class:"text-center"},WE=["href"],YE={key:0,class:"text-center"},HE={key:0},KE={key:1,class:"text-pink"},ZE={key:1,class:"tag-group mt-2 gap-1"},XE={key:0,class:"tag tag-green-light"},vE=["download","href"],eb=["onClick"],tb={key:0,class:"block-bottom bg-light-teal"},lb=!0,ob={__name:"ProjectReport",props:{data:{required:!0,type:Object},id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u;e.computed(()=>E.value.some(n=>!n.Optional&&!n.Files.filter(d=>!d.Deleted).length));const E=e.ref(B.data.docs.map(n=>({...n,Files:[]})));e.ref({});const s=(n,d)=>{d.Type==="application/zip"&&n.Files.push({Type:n.Type,Path:d.Path,Name:B.id+"_"+(n.Multiple?d.Name:`${n.Title}.zip`)})},N=A.download,a=()=>{E.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(d=>!d.Deleted).length)})},l=n=>{};return e.onMounted(a),e.provide("editable",lb),(n,d)=>{const c=e.resolveComponent("required-label"),r=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",LE,[e.createElementVNode("h5",RE,e.toDisplayString(u.data.subtitle),1),e.createElementVNode("p",{class:"text-pink mt-3 lh-base",innerHTML:u.data.description},null,8,zE),e.createElementVNode("div",GE,[e.createElementVNode("table",JE,[d[4]||(d[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"70",class:"text-center"},"附件編號"),e.createElementVNode("th",null,"附件名稱"),e.createElementVNode("th",{class:"text-center"},"狀態"),e.createElementVNode("th",null,"上傳附件")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(g,x)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",QE,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Title),1)]),_:2},1024)]),g.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:g.Template,style:{width:"140px"},type:"button"},[...d[2]||(d[2]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,WE)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",YE,[g.Uploaded?(e.openBlock(),e.createElementBlock("span",HE,"已上傳")):(e.openBlock(),e.createElementBlock("span",KE,"尚未上傳"))])),e.createElementVNode("td",null,[g.Multiple||!g.Uploaded?(e.openBlock(),e.createBlock(r,{key:0,accept:".zip",onFile:C=>s(g,C)},null,8,["onFile"])):e.createCommentVNode("",!0),g.Uploaded?(e.openBlock(),e.createElementBlock("div",ZE,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.Files,C=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:C},[C.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",XE,[e.createElementVNode("a",{class:"tag-link my-1",download:C.Name,href:e.unref(N)(C.Path)},e.toDisplayString(C.Name),9,vE),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>C.Deleted=!0,type:"button"},[...d[3]||(d[3]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,eb))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),(e.openBlock(),e.createElementBlock("div",tb,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[0]||(d[0]=g=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[1]||(d[1]=g=>l()),type:"button"},[...d[5]||(d[5]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])]))],64)}}},nb={key:0,class:"scroll-bottom-panel"},rb={class:"d-flex flex-column gap-3 mb-3"},ab={class:"d-flex gap-2"},db={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},sb={class:"text-nowrap mb-2 d-flex align-items-center"},cb={key:0,class:"invalid mt-0"},mb={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(u){const _=u,B=I(),E=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],s=e.ref({}),N=e.ref({ID:_.id,Result:1}),a=()=>{},l=()=>{},n=()=>{const c={};if(N.value.Result>1&&(c.Reason="原因"),N.value.Result===3&&(c.CorrectionDeadline="補正期限"),s.value=O(N.value,c),Object.keys(s.value).length){d();return}A[_.type]("reviewApplication",N.value).subscribe(r=>{r&&(window.location.href="../ReviewChecklist.aspx?type=1")})},d=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>N.value.Result,c=>{c>1&&d()}),(c,r)=>{const g=e.resolveComponent("input-radio-group"),x=e.resolveComponent("input-tw-date"),C=e.resolveComponent("input-textarea");return e.unref(B)[u.type].organizer?(e.openBlock(),e.createElementBlock("div",nb,[r[9]||(r[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",rb,[e.createElementVNode("li",{class:"d-flex gap-2"},[r[3]||(r[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:a,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[r[6]||(r[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),r[7]||(r[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[r[4]||(r[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:l,href:"javascript:void(0)"},"1"),r[5]||(r[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",ab,[r[8]||(r[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",db,[e.createElementVNode("div",sb,[e.createVNode(g,{options:E,modelValue:e.unref(N).Result,"onUpdate:modelValue":r[0]||(r[0]=p=>e.unref(N).Result=p)},null,8,["modelValue"]),e.createVNode(x,{class:"form-control",drops:"up",modelValue:e.unref(N).CorrectionDeadline,"onUpdate:modelValue":r[1]||(r[1]=p=>e.unref(N).CorrectionDeadline=p)},null,8,["modelValue"])]),e.unref(s).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",cb,e.toDisplayString(e.unref(s).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(N).Result>1?(e.openBlock(),e.createBlock(C,{key:1,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(N).Reason,"onUpdate:modelValue":r[2]||(r[2]=p=>e.unref(N).Reason=p)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:n,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},ib={class:"top-wrapper"},pb={class:"top-block"},Vb={class:"d-flex align-items-center gap-3"},fb={__name:"ProjectTitle",props:{id:{type:[Number,String]},type:{type:String}},setup(u){const _=u,B=I();return(E,s)=>(e.openBlock(),e.createElementBlock("div",ib,[e.createElementVNode("div",pb,[e.createElementVNode("div",Vb,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(B)[_.type].type)+"］"+e.toDisplayString(e.unref(B)[_.type].id)+"/"+e.toDisplayString(e.unref(B)[_.type].name),1)]),s[0]||(s[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},Nb={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},Eb={class:"d-flex gap-2"},bb={key:0,class:"btn text-teal-dark",type:"button"},kb={class:"d-flex gap-2"},gb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},yb={class:"modal-content"},ub={class:"modal-body"},xb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Bb={class:"modal-content"},hb={class:"modal-body"},$b={class:"d-flex flex-column gap-4 mb-5"},Cb={class:"d-flex align-items-center"},_b={class:"flex-grow-1"},Tb={__name:"ProjectToolbar",props:{id:{type:[Number,String]},type:{type:String}},setup(u){const _=I(),B=u,E=e.ref({}),s=e.ref(),N=e.ref({}),a=e.ref(),l=e.ref({}),n=e.ref(),d=()=>{const C={Reason:"計畫變更原因"};N.value=O(E.value,C),!Object.keys(N.value).length&&A[B.type]("applyChange",E.value).subscribe(p=>{p&&location.reload()})},c=()=>{E.value={ID:B.id},bootstrap.Modal.getOrCreateInstance(s.value).show()},r=()=>{bootstrap.Modal.getOrCreateInstance(a.value).show()},g=()=>{l.value={ID:B.id},bootstrap.Modal.getOrCreateInstance(n.value).show()},x=()=>{const C={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};N.value=O(l.value,C),!Object.keys(N.value).length&&A[B.type]("terminate",l.value).subscribe(p=>{p&&(location.href="../ApplicationChecklist.aspx")})};return(C,p)=>{const o=e.resolveComponent("project-organizer"),y=e.resolveComponent("input-textarea"),b=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Nb,[e.createElementVNode("div",Eb,[e.unref(_)[B.type].changeStatus?(e.openBlock(),e.createElementBlock("button",bb," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:c,type:"button"}," 計畫變更申請 ")),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:r,type:"button"},[...p[3]||(p[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])]),p[4]||(p[4]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-download"}),e.createTextVNode(" 下載核定計畫書 ")],-1))]),e.createElementVNode("div",kb,[e.createVNode(o,{id:u.id,type:u.type},null,8,["id","type"]),e.createElementVNode("button",{class:"btn btn-pink",onClick:g,type:"button"}," 計畫終止 ")])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:s,tabindex:"-1"},[e.createElementVNode("div",gb,[e.createElementVNode("div",yb,[p[8]||(p[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",ub,[p[6]||(p[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),p[7]||(p[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(y,{error:e.unref(N).Reason,modelValue:e.unref(E).Reason,"onUpdate:modelValue":p[0]||(p[0]=V=>e.unref(E).Reason=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[p[5]||(p[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:d},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:a,tabindex:"-1"},[...p[9]||(p[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:n,tabindex:"-1"},[e.createElementVNode("div",xb,[e.createElementVNode("div",Bb,[p[14]||(p[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",hb,[e.createElementVNode("div",$b,[e.createElementVNode("div",null,[p[10]||(p[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(y,{error:e.unref(N).RejectReason,modelValue:e.unref(l).RejectReason,"onUpdate:modelValue":p[1]||(p[1]=V=>e.unref(l).RejectReason=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),p[12]||(p[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",Cb,[p[11]||(p[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",_b,[e.createVNode(b,{error:e.unref(N).RecoveryAmount,modelValue:e.unref(l).RecoveryAmount,"onUpdate:modelValue":p[2]||(p[2]=V=>e.unref(l).RecoveryAmount=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[p[13]||(p[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:x},"送出")])])])])],512)]))],64)}}},wb={key:0,class:"text-pink"},Db={__name:"RequiredLabel",setup(u){const _=e.inject("editable",!0);return(B,E)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(_)?(e.openBlock(),e.createElementBlock("span",wb,"* ")):e.createCommentVNode("",!0),e.renderSlot(B.$slots,"default")],64))}},Fb={};function Sb(u,_){return e.openBlock(),e.createElementBlock(e.Fragment,null,[_[0]||(_[0]=e.createStaticVNode('<div class="search-form" action=""><div class="row g-3"><div class="col-3"><div class="fs-16 text-gray mb-2">年度</div><select class="form-select" name="" id=""><option value="">114年</option><option value="">113年</option></select></div></div></div>',1)),_[1]||(_[1]=e.createElementVNode("div",{class:"block rounded-4 mt-4"},[e.createElementVNode("div",{class:"title border-teal"},[e.createElementVNode("div",{class:"d-flex align-items-center gap-2"},[e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")])]),e.createElementVNode("button",{type:"button",class:"btn btn-teal-dark",onclick:"location.href='GrantEdit.aspx'"},[e.createElementVNode("i",{class:"fa-solid fa-plus"}),e.createTextVNode(" 新增類別 ")])]),e.createElementVNode("div",{class:"table-responsive",style:{"min-height":"400px"}},[e.createElementVNode("table",{class:"table teal-table","aria-label":"公告列表"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col"},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"補助類別全稱"),e.createElementVNode("th",{scope:"col",class:"text-start"},"簡稱"),e.createElementVNode("th",{scope:"col"},"代碼"),e.createElementVNode("th",{scope:"col"},"申請期間"),e.createElementVNode("th",{scope:"col"},"管理")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",{"data-th":"年度:"},"114"),e.createElementVNode("td",{"data-th":"補助類別全稱:",class:"text-start"},"114年度補助學術機構、研究機關(構)及海洋科技業者執行海洋科技專案"),e.createElementVNode("td",{"data-th":"簡稱:",class:"text-start"},"科專"),e.createElementVNode("td",{"data-th":"代碼:",class:"text-start"},"SCI"),e.createElementVNode("td",{"data-th":"申請期間:",class:"text-start"},"114/02/01 ~ 114/10/31"),e.createElementVNode("td",{"data-th":"管理:",class:"text-center"},[e.createElementVNode("div",{class:"d-inline-flex gap-2"},[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",type:"button",onclick:"location.href='GrantEdit.aspx?ID=1'"},[e.createElementVNode("i",{class:"fa-solid fa-pen","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"管理"})])])])])])])]),e.createElementVNode("div",{class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},[e.createElementVNode("nav",{class:"pagination","aria-label":"Pagination"},[e.createElementVNode("button",{class:"nav-button","aria-label":"Previous page",disabled:""},[e.createElementVNode("i",{class:"fas fa-chevron-left"})]),e.createElementVNode("button",{class:"nav-button","aria-label":"Next page",disabled:""},[e.createElementVNode("i",{class:"fas fa-chevron-right"})])]),e.createElementVNode("div",{class:"page-number-control"},[e.createElementVNode("div",{class:"page-number-control-item"},[e.createElementVNode("span",null,"跳到"),e.createElementVNode("select",{class:"form-select jump-to-page"}),e.createElementVNode("span",null,"頁"),e.createElementVNode("span",null,",")]),e.createElementVNode("div",{class:"page-number-control-item"},[e.createElementVNode("span",null,"每頁顯示"),e.createElementVNode("select",{id:"ddlPageSize",class:"form-select",onchange:"changePageSize()"},[e.createElementVNode("option",{value:"10"},"10"),e.createElementVNode("option",{value:"20"},"20"),e.createElementVNode("option",{value:"30"},"30")]),e.createElementVNode("span",null,"筆")])])])],-1))],64)}const Ab=le(Fb,[["render",Sb]]),Ub={class:"block rounded-4 mt-4"},Mb={class:"table-responsive",style:{"min-height":"400px"}},Ob={class:"table teal-table","aria-label":"公告列表"},jb={"data-th":"公告期間:"},Ib={key:1},Pb={"data-th":"公告標題:",class:"text-start"},qb={"data-th":"發布者:",class:"text-start"},Lb={"data-th":"功能:",class:"text-center"},Rb={class:"d-inline-flex gap-2"},zb=["href"],Gb=["onClick"],Jb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"},Qb={class:"modal-content"},Wb={class:"modal-body"},Yb={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},Hb={__name:"NewsList",setup(u){let _;const B=e.ref([]),E=e.ref(),s=e.ref(1),N=e.ref(10),a=e.computed(()=>B.value.slice((s.value-1)*N.value,s.value*N.value)),l=(d,c)=>{s.value=parseInt(d),N.value=parseInt(c)},n=(d,c)=>{c||(_=d,bootstrap.Modal.getOrCreateInstance(E.value).show()),A.system("deleteNews",{ID:d.ID}).subscribe(r=>{r&&(B.value=B.value.filter(g=>g!==d),bootstrap.Modal.getOrCreateInstance(E.value).hide())})};return e.onMounted(()=>{A.system("getNewsList").subscribe(d=>B.value=d.List)}),(d,c)=>{const r=e.resolveComponent("tw-date"),g=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ub,[c[5]||(c[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="NewsEdit.aspx"><i class="fa-solid fa-plus"></i> 新增公告 </a></div>',1)),e.createElementVNode("div",Mb,[e.createElementVNode("table",Ob,[c[4]||(c[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告期間"),e.createElementVNode("th",{class:"text-start",scope:"col"},"公告標題"),e.createElementVNode("th",{class:"text-start",scope:"col",style:{width:"200px"}},"發布者"),e.createElementVNode("th",{scope:"col",style:{width:"180px"}},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),x=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",jb,[e.createVNode(r,{value:x.EnableTime},null,8,["value"]),c[1]||(c[1]=e.createTextVNode(" ~ ",-1)),x.DisableTime?(e.openBlock(),e.createBlock(r,{key:0,value:x.DisableTime},null,8,["value"])):(e.openBlock(),e.createElementBlock("span",Ib,"未設定"))]),e.createElementVNode("td",Pb,e.toDisplayString(x.Title),1),e.createElementVNode("td",qb,e.toDisplayString(x.UserOrg)+" "+e.toDisplayString(x.UserName),1),e.createElementVNode("td",Lb,[e.createElementVNode("div",Rb,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`NewsEdit.aspx?id=${x.ID}`},[...c[2]||(c[2]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,zb),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:C=>n(x),type:"button"},[...c[3]||(c[3]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,Gb)])])]))),128))])])]),e.createVNode(g,{count:e.unref(B).length,onChange:l,page:e.unref(s),"page-size":e.unref(N)},null,8,["count","page","page-size"])]),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",Jb,[e.createElementVNode("div",Qb,[c[7]||(c[7]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 fw-bold text-green-light"},"確定刪除公告資料？"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Wb,[e.createElementVNode("div",Yb,[c[6]||(c[6]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[0]||(c[0]=x=>n(e.unref(_),!0)),type:"button"},"確認刪除")])])])])],512)],64)}}},Kb={class:"block rounded-top-4 mt-4 d-flex flex-column gap-5"},Zb={class:"table-responsive mt-3 mb-0"},Xb={class:"table align-middle gray-table side-table"},vb={class:"d-flex align-items-center gap-2"},ek={class:"input-group w-auto"},tk={key:0,class:"invalid mt-0"},lk={class:"d-flex mb-2 gap-3"},ok={class:"tag-group mt-3"},nk={key:0,class:"tag tag-green-light"},rk=["download","href"],ak=["onClick"],dk={class:"d-flex mb-2 gap-3"},sk={class:"image-preview mt-3"},ck={key:0,class:"image-preview__item"},mk=["src"],ik={class:"image-preview__item-overlay"},pk=["onClick"],Vk={class:"d-flex mb-2 gap-3"},fk={key:0,class:"table-responsive mt-3"},Nk={class:"table align-middle gray-table"},Ek={class:"text-center"},bk={class:"d-flex gap-1"},kk=["onClick"],oe={AccessibilityApplication:et,AccessibilityAttachment:xt,AccessibilityBenefit:Ot,AccessibilityFunding:ml,AccessibilityPayment1:Sl,AccessibilityPayment2:to,AccessibilityProgressBar:lo,AccessibilityWorkSchedule:wo,ConfirmModal:Mo,CommonProgressBar:Ro,CultureApplication:_n,CultureAttachment:Hn,CultureFunding:xr,CultureOther:Ir,CulturePayment1:aa,CulturePayment2:wa,CultureProgress:Ya,CultureProgressBar:Ha,CultureWorkSchedule:Ld,EducationApplication:As,EducationAttachment:tc,EducationPayment:$c,EducationProgressBar:Cc,ErrorModal:Sc,InputBoolean:Ac,InputFile:Uc,InputInteger:jc,InputMonth:Ic,InputRadioGroup:Lc,InputSelect:Qc,InputText:Zc,InputTextarea:lm,InputTwDate:rm,ListPager:ym,LiteracyApplication:ei,LiteracyAttachment:xi,LiteracyBenefit:Oi,LiteracyFunding:mp,LiteracyPayment1:Fp,LiteracyPayment2:tV,LiteracyProgressBar:lV,LiteracyWorkSchedule:TV,MultipleApplication:sf,MultipleAttachment:Ff,MultipleBenefit:Jf,MultipleFunding:gN,MultiplePayment1:qN,MultiplePayment2:m1,MultiplePayment3:O1,MultipleProgressBar:j1,MultipleWorkSchedule:cE,ProjectChangeReview:NE,ProjectCorrectionReview:uE,ProjectOrganizer:DE,ProjectProgress:qE,ProjectReport:ob,ProjectReview:mb,ProjectTitle:fb,ProjectToolbar:Tb,RequiredLabel:Db,SystemGrantList:Ab,SystemNewsList:Hb,SystemNewsForm:{__name:"NewsForm",props:{id:{type:[Number,String]}},emits:["next"],setup(u,{emit:_}){const B=u,E=e.ref({}),s=e.ref([]),N=e.computed(()=>n.value.filter(C=>!C.Deleted)),a=e.ref({}),l=e.ref([]),n=e.ref([]),d=(C,p)=>C.push({Path:p.Path,Name:p.Name}),c=A.download,r=_,g=()=>{if(!x()){e.nextTick(()=>{var p;return(p=document.querySelector(".invalid"))==null?void 0:p.scrollIntoView({behavior:"smooth",block:"center"})});return}const C={News:a.value,Files:s.value,Images:l.value,Videos:n.value};A.system("saveNews",C).subscribe(p=>{p&&r("next")})},x=()=>{let C={Title:"公告標題",EnableTime:"公告期間",Content:"內容"};return E.value=O(a.value,C),C={Title:"影片名稱",URL:"影片網址"},N.value.forEach((p,o)=>Object.assign(E.value,O(p,C,`video-${o}-`))),!Object.keys(E.value).length};return e.onMounted(()=>{B.id?A.system("getNews",{ID:B.id}).subscribe(C=>{a.value=C.News,s.value=C.Files,l.value=C.Images,n.value=C.Videos}):A.system("getEmptyNews").subscribe(C=>a.value=C)}),(C,p)=>{const o=e.resolveComponent("required-label"),y=e.resolveComponent("input-text"),b=e.resolveComponent("input-tw-date"),V=e.resolveComponent("input-textarea"),m=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kb,[e.createElementVNode("div",null,[p[12]||(p[12]=e.createElementVNode("h5",{class:"square-title"},"公告內容",-1)),e.createElementVNode("div",Zb,[e.createElementVNode("table",Xb,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[7]||(p[7]=e.createElementVNode("th",null,"發佈者",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).UserOrg)+"    "+e.toDisplayString(e.unref(a).UserName),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(o,null,{default:e.withCtx(()=>[...p[8]||(p[8]=[e.createTextVNode("公告標題",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(E).Title,modelValue:e.unref(a).Title,"onUpdate:modelValue":p[0]||(p[0]=i=>e.unref(a).Title=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(o,null,{default:e.withCtx(()=>[...p[9]||(p[9]=[e.createTextVNode("公告期間",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",vb,[e.createElementVNode("div",ek,[e.createVNode(b,{class:"w-auto",modelValue:e.unref(a).EnableTime,"onUpdate:modelValue":p[1]||(p[1]=i=>e.unref(a).EnableTime=i)},null,8,["modelValue"]),p[10]||(p[10]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(b,{class:"w-auto",modelValue:e.unref(a).DisableTime,"onUpdate:modelValue":p[2]||(p[2]=i=>e.unref(a).DisableTime=i)},null,8,["modelValue"])])]),e.unref(E).EnableTime?(e.openBlock(),e.createElementBlock("div",tk,e.toDisplayString(e.unref(E).EnableTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(o,null,{default:e.withCtx(()=>[...p[11]||(p[11]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(E).Content,modelValue:e.unref(a).Content,"onUpdate:modelValue":p[3]||(p[3]=i=>e.unref(a).Content=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.createElementVNode("div",null,[e.createElementVNode("div",lk,[p[13]||(p[13]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關附件")],-1)),e.createVNode(m,{accept:".pdf,.odt,.doc,.docx,.zip",onFile:p[4]||(p[4]=i=>d(e.unref(s),i))})]),p[15]||(p[15]=e.createElementVNode("span",{class:"text-pink"},"支援文件 pdf, odt, doc, docx (10MB以內)、ZIP 壓縮檔 (50MB以內)",-1)),e.createElementVNode("div",ok,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",nk,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(c)(i.Path)},e.toDisplayString(i.Name),9,rk),e.createElementVNode("button",{class:"tag-btn",onClick:t=>i.Deleted=!0,type:"button"},[...p[14]||(p[14]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ak)]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",dk,[p[16]||(p[16]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關圖片")],-1)),e.createVNode(m,{accept:".jpg,.png",onFile:p[5]||(p[5]=i=>d(e.unref(l),i))})]),p[18]||(p[18]=e.createElementVNode("span",{class:"text-pink"},"支援 JPG, PNG，檔案大小 10MB以內",-1)),e.createElementVNode("div",sk,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",ck,[e.createElementVNode("img",{alt:"picture",src:e.unref(c)(i.Path)},null,8,mk),e.createElementVNode("div",ik,[e.createElementVNode("button",{"aria-label":"移除圖片",class:"btn btn-remove-image",onClick:t=>i.Deleted=!0,type:"button"},[...p[17]||(p[17]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,pk)])]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",Vk,[p[20]||(p[20]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關影片")],-1)),e.createElementVNode("button",{"aria-label":"新增影片",class:"btn btn-teal-dark",onClick:p[6]||(p[6]=i=>e.unref(n).push({})),type:"button"},[...p[19]||(p[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增 ",-1)])])]),e.unref(N).length?(e.openBlock(),e.createElementBlock("div",fk,[e.createElementVNode("table",Nk,[p[22]||(p[22]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80",class:"text-center"},"項次"),e.createElementVNode("th",null,"影片名稱"),e.createElementVNode("th",null,"影片網址"),e.createElementVNode("th",{width:"120"},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(i,t)=>(e.openBlock(),e.createElementBlock("tr",{key:i},[e.createElementVNode("td",Ek,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(E)[`video-${t}-Title`],modelValue:i.Title,"onUpdate:modelValue":f=>i.Title=f,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(E)[`video-${t}-URL`],modelValue:i.URL,"onUpdate:modelValue":f=>i.URL=f,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",bk,[e.createElementVNode("button",{"aria-label":"刪除影片",class:"btn btn-sm btn-teal-dark",onClick:f=>i.Deleted=!0,type:"button"},[...p[21]||(p[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,kk)])])]))),128))])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",{class:"block-bottom bg-light-teal"},[e.createElementVNode("button",{class:"btn btn-teal",onClick:g,type:"button"},[...p[23]||(p[23]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確認送出",-1)])])])],64)}}},TwDate:{__name:"TwDate",props:{value:{default:null,type:String}},setup(u){const _=u,B=s=>{const N=s==null?void 0:s.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return N?`${parseInt(N[1],10)-1911}/${N[2]}/${N[3]}`:""},E=e.ref(B(_.value));return e.watch(()=>_.value,s=>E.value=B(s)),(s,N)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(E)),1))}}};return{api:A,install:u=>{for(const _ in oe)u.component(_,oe[_])},useProgressStore:I}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
