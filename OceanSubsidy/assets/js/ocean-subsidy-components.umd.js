(function(e,q){typeof exports=="object"&&typeof module<"u"?module.exports=q(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],q):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=q(e.Vue,e.Pinia))})(this,(function(e,q){"use strict";let Y=Date.now();const O=(y,h,E)=>(console.log(y,h,E),h===1),H=()=>`id--${Y++}`,I=y=>parseInt(y)||0,J=q.defineStore("message",{state:()=>({error:null})}),{ajax:Z}=rxjs.ajax,{map:K}=rxjs;let z="";const X=(y,h={})=>P("Service/OFS/Accessibility.ashx",{method:y,param:h}),v=(y,h={})=>P("Service/OFS/Culture.ashx",{method:y,param:h}),ee=y=>`${z}/Service/OFS/Download.ashx?path=${y}`,te=(y,h={})=>P("Service/OFS/Education.ashx",{method:y,param:h}),le=(y,h={})=>P("Service/OFS/Literacy.ashx",{method:y,param:h}),oe=(y,h={})=>P("Service/OFS/Multiple.ashx",{method:y,param:h}),ne=({response:y,status:h})=>{if(h===200){if(y.success)return y.data;J().error=y.message}},P=(y,h={})=>{const E={};h.constructor!==FormData&&(E["Content-Type"]="application/json");const p={body:h,headers:E,method:"POST",url:`${z}/${y}`};return Z(p).pipe(K(ne))},S=Object.assign(P,{accessibility:X,culture:v,download:ee,education:te,literacy:le,multiple:oe,upload:y=>{const h=new FormData;return h.append("file",y),P("Service/OFS/Upload.ashx",h)}});function re(y){return y&&y.__esModule&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y}var L={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var ae=L.exports,Q;function de(){return Q||(Q=1,(function(y,h){(function(E,p,m){var i=function(o,r,a){a=n.extend({},n.options,a);var s=n.runValidations(o,r,a);if(s.some(function(N){return n.isPromise(N.error)}))throw new Error("Use validate.async if you want support for promises");return i.processValidationResults(s,a)},n=i;n.extend=function(o){return[].slice.call(arguments,1).forEach(function(r){for(var a in r)o[a]=r[a]}),o},n.extend(i,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var o=n.format("%{major}.%{minor}.%{patch}",n.version);return n.isEmpty(n.version.metadata)||(o+="+"+n.version.metadata),o}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(o,r,a){var s=[],N,d,u,x,l,t,c;(n.isDomElement(o)||n.isJqueryElement(o))&&(o=n.collectFormValues(o));for(N in r){u=n.getDeepObjectValue(o,N),x=n.result(r[N],u,o,N,a,r);for(d in x){if(l=n.validators[d],!l)throw c=n.format("Unknown validator %{name}",{name:d}),new Error(c);t=x[d],t=n.result(t,u,o,N,a,r),t&&s.push({attribute:N,value:u,validator:d,globalOptions:a,attributes:o,options:t,error:l.call(l,u,t,N,o,a)})}}return s},processValidationResults:function(o,r){o=n.pruneEmptyErrors(o,r),o=n.expandMultipleErrors(o,r),o=n.convertErrorMessages(o,r);var a=r.format||"grouped";if(typeof n.formatters[a]=="function")o=n.formatters[a](o);else throw new Error(n.format("Unknown format %{format}",r));return n.isEmpty(o)?void 0:o},async:function(o,r,a){a=n.extend({},n.async.options,a);var s=a.wrapErrors||function(d){return d};a.cleanAttributes!==!1&&(o=n.cleanAttributes(o,r));var N=n.runValidations(o,r,a);return new n.Promise(function(d,u){n.waitForResults(N).then(function(){var x=n.processValidationResults(N,a);x?u(new s(x,a,o,r)):d(o)},function(x){u(x)})})},single:function(o,r,a){return a=n.extend({},n.single.options,a,{format:"flat",fullMessages:!1}),n({single:o},{single:r},a)},waitForResults:function(o){return o.reduce(function(r,a){return n.isPromise(a.error)?r.then(function(){return a.error.then(function(s){a.error=s||null})}):r},new n.Promise(function(r){r()}))},result:function(o){var r=[].slice.call(arguments,1);return typeof o=="function"&&(o=o.apply(null,r)),o},isNumber:function(o){return typeof o=="number"&&!isNaN(o)},isFunction:function(o){return typeof o=="function"},isInteger:function(o){return n.isNumber(o)&&o%1===0},isBoolean:function(o){return typeof o=="boolean"},isObject:function(o){return o===Object(o)},isDate:function(o){return o instanceof Date},isDefined:function(o){return o!=null},isPromise:function(o){return!!o&&n.isFunction(o.then)},isJqueryElement:function(o){return o&&n.isString(o.jquery)},isDomElement:function(o){return!o||!o.querySelectorAll||!o.querySelector?!1:n.isObject(document)&&o===document?!0:typeof HTMLElement=="object"?o instanceof HTMLElement:o&&typeof o=="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName=="string"},isEmpty:function(o){var r;if(!n.isDefined(o))return!0;if(n.isFunction(o))return!1;if(n.isString(o))return n.EMPTY_STRING_REGEXP.test(o);if(n.isArray(o))return o.length===0;if(n.isDate(o))return!1;if(n.isObject(o)){for(r in o)return!1;return!0}return!1},format:n.extend(function(o,r){return n.isString(o)?o.replace(n.format.FORMAT_REGEXP,function(a,s,N){return s==="%"?"%{"+N+"}":String(r[N])}):o},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(o){return n.isNumber(o)?o*100%1===0?""+o:parseFloat(Math.round(o*100)/100).toFixed(2):n.isArray(o)?o.map(function(r){return n.prettify(r)}).join(", "):n.isObject(o)?n.isDefined(o.toString)?o.toString():JSON.stringify(o):(o=""+o,o.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(r,a,s){return""+a+" "+s.toLowerCase()}).toLowerCase())},stringifyValue:function(o,r){var a=r&&r.prettify||n.prettify;return a(o)},isString:function(o){return typeof o=="string"},isArray:function(o){return{}.toString.call(o)==="[object Array]"},isHash:function(o){return n.isObject(o)&&!n.isArray(o)&&!n.isFunction(o)},contains:function(o,r){return n.isDefined(o)?n.isArray(o)?o.indexOf(r)!==-1:r in o:!1},unique:function(o){return n.isArray(o)?o.filter(function(r,a,s){return s.indexOf(r)==a}):o},forEachKeyInKeypath:function(o,r,a){if(n.isString(r)){var s="",N,d=!1;for(N=0;N<r.length;++N)switch(r[N]){case".":d?(d=!1,s+="."):(o=a(o,s,!1),s="");break;case"\\":d?(d=!1,s+="\\"):d=!0;break;default:d=!1,s+=r[N];break}return a(o,s,!0)}},getDeepObjectValue:function(o,r){if(n.isObject(o))return n.forEachKeyInKeypath(o,r,function(a,s){if(n.isObject(a))return a[s]})},collectFormValues:function(o,r){var a={},s,N,d,u,x,l;if(n.isJqueryElement(o)&&(o=o[0]),!o)return a;for(r=r||{},u=o.querySelectorAll("input[name], textarea[name]"),s=0;s<u.length;++s)if(d=u.item(s),!n.isDefined(d.getAttribute("data-ignored"))){var t=d.name.replace(/\./g,"\\\\.");l=n.sanitizeFormValue(d.value,r),d.type==="number"?l=l?+l:null:d.type==="checkbox"?d.attributes.value?d.checked||(l=a[t]||null):l=d.checked:d.type==="radio"&&(d.checked||(l=a[t]||null)),a[t]=l}for(u=o.querySelectorAll("select[name]"),s=0;s<u.length;++s)if(d=u.item(s),!n.isDefined(d.getAttribute("data-ignored"))){if(d.multiple){l=[];for(N in d.options)x=d.options[N],x&&x.selected&&l.push(n.sanitizeFormValue(x.value,r))}else{var c=typeof d.options[d.selectedIndex]<"u"?d.options[d.selectedIndex].value:"";l=n.sanitizeFormValue(c,r)}a[d.name]=l}return a},sanitizeFormValue:function(o,r){return r.trim&&n.isString(o)&&(o=o.trim()),r.nullify!==!1&&o===""?null:o},capitalize:function(o){return n.isString(o)?o[0].toUpperCase()+o.slice(1):o},pruneEmptyErrors:function(o){return o.filter(function(r){return!n.isEmpty(r.error)})},expandMultipleErrors:function(o){var r=[];return o.forEach(function(a){n.isArray(a.error)?a.error.forEach(function(s){r.push(n.extend({},a,{error:s}))}):r.push(a)}),r},convertErrorMessages:function(o,r){r=r||{};var a=[],s=r.prettify||n.prettify;return o.forEach(function(N){var d=n.result(N.error,N.value,N.attribute,N.options,N.attributes,N.globalOptions);if(!n.isString(d)){a.push(N);return}d[0]==="^"?d=d.slice(1):r.fullMessages!==!1&&(d=n.capitalize(s(N.attribute))+" "+d),d=d.replace(/\\\^/g,"^"),d=n.format(d,{value:n.stringifyValue(N.value,r)}),a.push(n.extend({},N,{error:d}))}),a},groupErrorsByAttribute:function(o){var r={};return o.forEach(function(a){var s=r[a.attribute];s?s.push(a):r[a.attribute]=[a]}),r},flattenErrorsToArray:function(o){return o.map(function(r){return r.error}).filter(function(r,a,s){return s.indexOf(r)===a})},cleanAttributes:function(o,r){function a(d,u,x){return n.isObject(d[u])?d[u]:d[u]=x?!0:{}}function s(d){var u={},x;for(x in d)d[x]&&n.forEachKeyInKeypath(u,x,a);return u}function N(d,u){if(!n.isObject(d))return d;var x=n.extend({},d),l,t;for(t in d)l=u[t],n.isObject(l)?x[t]=N(x[t],l):l||delete x[t];return x}return!n.isObject(r)||!n.isObject(o)?{}:(r=s(r),N(o,r))},exposeModule:function(o,r,a,s,N){a?(s&&s.exports&&(a=s.exports=o),a.validate=o):(r.validate=o,o.isFunction(N)&&N.amd&&N([],function(){return o}))},warn:function(o){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+o)},error:function(o){typeof console<"u"&&console.error&&console.error("[validate.js] "+o)}}),i.validators={presence:function(o,r){if(r=n.extend({},this.options,r),r.allowEmpty!==!1?!n.isDefined(o):n.isEmpty(o))return r.message||this.message||"can't be blank"},length:function(o,r,a){if(n.isDefined(o)){r=n.extend({},this.options,r);var s=r.is,N=r.maximum,d=r.minimum,u=r.tokenizer||function(c){return c},x,l=[];o=u(o);var t=o.length;if(!n.isNumber(t))return r.message||this.notValid||"has an incorrect length";if(n.isNumber(s)&&t!==s&&(x=r.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",l.push(n.format(x,{count:s}))),n.isNumber(d)&&t<d&&(x=r.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",l.push(n.format(x,{count:d}))),n.isNumber(N)&&t>N&&(x=r.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",l.push(n.format(x,{count:N}))),l.length>0)return r.message||l}},numericality:function(o,r,a,s,N){if(n.isDefined(o)){r=n.extend({},this.options,r);var d=[],u,x,l={greaterThan:function(T,B){return T>B},greaterThanOrEqualTo:function(T,B){return T>=B},equalTo:function(T,B){return T===B},lessThan:function(T,B){return T<B},lessThanOrEqualTo:function(T,B){return T<=B},divisibleBy:function(T,B){return T%B===0}},t=r.prettify||N&&N.prettify||n.prettify;if(n.isString(o)&&r.strict){var c="^-?(0|[1-9]\\d*)";if(r.onlyInteger||(c+="(\\.\\d+)?"),c+="$",!new RegExp(c).test(o))return r.message||r.notValid||this.notValid||this.message||"must be a valid number"}if(r.noStrings!==!0&&n.isString(o)&&!n.isEmpty(o)&&(o=+o),!n.isNumber(o))return r.message||r.notValid||this.notValid||this.message||"is not a number";if(r.onlyInteger&&!n.isInteger(o))return r.message||r.notInteger||this.notInteger||this.message||"must be an integer";for(u in l)if(x=r[u],n.isNumber(x)&&!l[u](o,x)){var f="not"+n.capitalize(u),k=r[f]||this[f]||this.message||"must be %{type} %{count}";d.push(n.format(k,{count:x,type:t(u)}))}if(r.odd&&o%2!==1&&d.push(r.notOdd||this.notOdd||this.message||"must be odd"),r.even&&o%2!==0&&d.push(r.notEven||this.notEven||this.message||"must be even"),d.length)return r.message||d}},datetime:n.extend(function(o,r){if(!n.isFunction(this.parse)||!n.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(n.isDefined(o)){r=n.extend({},this.options,r);var a,s=[],N=r.earliest?this.parse(r.earliest,r):NaN,d=r.latest?this.parse(r.latest,r):NaN;if(o=this.parse(o,r),isNaN(o)||r.dateOnly&&o%864e5!==0)return a=r.notValid||r.message||this.notValid||"must be a valid date",n.format(a,{value:arguments[0]});if(!isNaN(N)&&o<N&&(a=r.tooEarly||r.message||this.tooEarly||"must be no earlier than %{date}",a=n.format(a,{value:this.format(o,r),date:this.format(N,r)}),s.push(a)),!isNaN(d)&&o>d&&(a=r.tooLate||r.message||this.tooLate||"must be no later than %{date}",a=n.format(a,{date:this.format(d,r),value:this.format(o,r)}),s.push(a)),s.length)return n.unique(s)}},{parse:null,format:null}),date:function(o,r){return r=n.extend({},r,{dateOnly:!0}),n.validators.datetime.call(n.validators.datetime,o,r)},format:function(o,r){(n.isString(r)||r instanceof RegExp)&&(r={pattern:r}),r=n.extend({},this.options,r);var a=r.message||this.message||"is invalid",s=r.pattern,N;if(n.isDefined(o)&&(!n.isString(o)||(n.isString(s)&&(s=new RegExp(r.pattern,r.flags)),N=s.exec(o),!N||N[0].length!=o.length)))return a},inclusion:function(o,r){if(n.isDefined(o)&&(n.isArray(r)&&(r={within:r}),r=n.extend({},this.options,r),!n.contains(r.within,o))){var a=r.message||this.message||"^%{value} is not included in the list";return n.format(a,{value:o})}},exclusion:function(o,r){if(n.isDefined(o)&&(n.isArray(r)&&(r={within:r}),r=n.extend({},this.options,r),!!n.contains(r.within,o))){var a=r.message||this.message||"^%{value} is restricted";return n.isString(r.within[o])&&(o=r.within[o]),n.format(a,{value:o})}},email:n.extend(function(o,r){r=n.extend({},this.options,r);var a=r.message||this.message||"is not a valid email";if(n.isDefined(o)&&(!n.isString(o)||!this.PATTERN.exec(o)))return a},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(o,r,a,s,N){if(n.isDefined(o)){n.isString(r)&&(r={attribute:r}),r=n.extend({},this.options,r);var d=r.message||this.message||"is not equal to %{attribute}";if(n.isEmpty(r.attribute)||!n.isString(r.attribute))throw new Error("The attribute must be a non empty string");var u=n.getDeepObjectValue(s,r.attribute),x=r.comparator||function(t,c){return t===c},l=r.prettify||N&&N.prettify||n.prettify;if(!x(o,u,r,a,s))return n.format(d,{attribute:l(r.attribute)})}},url:function(o,r){if(n.isDefined(o)){r=n.extend({},this.options,r);var a=r.message||this.message||"is not a valid url",s=r.schemes||this.schemes||["http","https"],N=r.allowLocal||this.allowLocal||!1,d=r.allowDataUrl||this.allowDataUrl||!1;if(!n.isString(o))return a;var u="^(?:(?:"+s.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",x="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(N?x+="?":u+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",u+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+x+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",d){var l="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",t="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",c="data:(?:"+l+")?(?:;base64)?,"+t;u="(?:"+u+")|(?:^"+c+"$)"}var f=new RegExp(u,"i");if(!f.exec(o))return a}},type:n.extend(function(o,r,a,s,N){if(n.isString(r)&&(r={type:r}),!!n.isDefined(o)){var d=n.extend({},this.options,r),u=d.type;if(!n.isDefined(u))throw new Error("No type was specified");var x;if(n.isFunction(u)?x=u:x=this.types[u],!n.isFunction(x))throw new Error("validate.validators.type.types."+u+" must be a function.");if(!x(o,d,a,s,N)){var l=r.message||this.messages[u]||this.message||d.message||(n.isFunction(u)?"must be of the correct type":"must be of type %{type}");return n.isFunction(l)&&(l=l(o,r,a,s,N)),n.format(l,{attribute:n.prettify(a),type:u})}}},{types:{object:function(o){return n.isObject(o)&&!n.isArray(o)},array:n.isArray,integer:n.isInteger,number:n.isNumber,string:n.isString,date:n.isDate,boolean:n.isBoolean},messages:{}})},i.formatters={detailed:function(o){return o},flat:n.flattenErrorsToArray,grouped:function(o){var r;o=n.groupErrorsByAttribute(o);for(r in o)o[r]=n.flattenErrorsToArray(o[r]);return o},constraint:function(o){var r;o=n.groupErrorsByAttribute(o);for(r in o)o[r]=o[r].map(function(a){return a.validator}).sort();return o}},i.exposeModule(i,this,E,p,m)}).call(ae,h,y,null)})(L,L.exports)),L.exports}var se=de();const W=re(se),w=(y,h,E="")=>{const p={};Object.keys(h).forEach(n=>{const o=h[n];W.isString(o)?p[n]={presence:{allowEmpty:!1,message:`^請輸入${o}`}}:p[n]=o});const m={},i=W(y,p);return i&&Object.keys(i).forEach(n=>m[`${E}${n}`]=i[n].join(",")),m},F=q.defineStore("progress",{state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})}),ce={class:"block"},me={class:"mt-4"},ie={class:"table align-middle gray-table side-table"},Ve={key:0},pe={key:1,class:"text-light-gray"},fe={class:"d-flex flex-column gap-2"},Ne={key:0},ue={class:"mt-4"},Ee={class:"table align-middle gray-table side-table"},be={class:"row g-3"},ke={class:"col-12 col-xl-2"},ge={class:"text-gray mb-2"},ye={class:"col-12 col-xl-3"},he={class:"text-gray mb-2"},$e={class:"col-12 col-xl-4"},Be={class:"row g-1"},xe={class:"col-7"},Ce={class:"col-5"},_e={class:"col-12 col-xl-3"},Te={class:"text-gray mb-2"},Se={class:"col-12"},we={class:"text-gray mb-2"},De={class:"mt-4"},Ue={class:"table align-middle gray-table side-table"},Ae={class:"mt-4"},Me={class:"table align-middle gray-table side-table"},Fe={key:0,class:"table-responsive mt-3 mb-0"},Ie={class:"table align-middle gray-table"},Oe={key:0},je={key:0},Pe={class:"d-flex gap-2"},qe=["onClick"],Le={key:0,class:"block-bottom bg-light-teal"},Re={__name:"Application",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.ref(),m=e.computed(()=>O("accessibility",o.value.Status,1)),i=e.ref({}),n=e.computed(()=>r.value.filter(x=>!x.Deleted)),o=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!n.value.length,set:x=>{x?s():r.value.forEach(l=>l.Deleted=!0)}}),s=()=>r.value.push({}),N=x=>x.Deleted=!0,d=x=>{if(i.value={},x&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const l={Project:o.value,Contacts:p.value,ReceivedSubsidies:r.value.filter(t=>t.ID||!t.Deleted),Submit:x?"true":"false"};S.accessibility("saveApplication",l).subscribe(t=>{x?window.location.href=`WorkSchedule.aspx?ID=${t.ID}`:o.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let x={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return o.value.OrgCategory==="2"&&(x.RegisteredNum="立案登記證字號"),i.value=w(o.value,x),x={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},p.value.forEach((l,t)=>Object.assign(i.value,w(l,x,`contact-${t}-`))),x={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},r.value.forEach((l,t)=>Object.assign(i.value,w(l,x,`received-${t}-`))),!Object.keys(i.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(x=>{E.value=x[0],h.id?S.accessibility("getApplication",{ID:h.id}).subscribe(l=>{o.value=l.Project,p.value=l.Contacts,r.value=l.ReceivedSubsidies,o.value.OrgCategory=o.value.OrgCategory||null,F().accessibility={step:o.value.FormStep,status:o.value.Status}}):S.accessibility("getEmptyApplication").subscribe(l=>{o.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},l),p.value=[{Role:"負責人"},{Role:"聯絡人"}],F().accessibility={step:o.value.FormStep,status:o.value.Status}})})}),e.provide("editable",m),(x,l)=>{const t=e.resolveComponent("required-label"),c=e.resolveComponent("input-text"),f=e.resolveComponent("input-select"),k=e.resolveComponent("input-textarea"),T=e.resolveComponent("input-boolean"),B=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ce,[l[37]||(l[37]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",me,[e.createElementVNode("table",ie,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[13]||(l[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).Year),1)]),e.createElementVNode("tr",null,[l[14]||(l[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(o).ProjectID?(e.openBlock(),e.createElementBlock("span",Ve,e.toDisplayString(e.unref(o).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",pe,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[l[15]||(l[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[16]||(l[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(i).ProjectName,modelValue:e.unref(o).ProjectName,"onUpdate:modelValue":l[0]||(l[0]=g=>e.unref(o).ProjectName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[17]||(l[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(i).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(o).OrgName,"onUpdate:modelValue":l[1]||(l[1]=g=>e.unref(o).OrgName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[18]||(l[18]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",fe,[e.createElementVNode("div",null,[e.createVNode(f,{"empty-value":null,error:e.unref(i).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o).OrgCategory,"onUpdate:modelValue":l[2]||(l[2]=g=>e.unref(o).OrgCategory=g)},null,8,["error","options","modelValue"])]),e.unref(o).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Ne,[e.createVNode(c,{error:e.unref(i).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(o).RegisteredNum,"onUpdate:modelValue":l[3]||(l[3]=g=>e.unref(o).RegisteredNum=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[19]||(l[19]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(i).TaxID,modelValue:e.unref(o).TaxID,"onUpdate:modelValue":l[4]||(l[4]=g=>e.unref(o).TaxID=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[20]||(l[20]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(i).Address,placeholder:"請輸入地址",modelValue:e.unref(o).Address,"onUpdate:modelValue":l[5]||(l[5]=g=>e.unref(o).Address=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),l[38]||(l[38]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ue,[e.createElementVNode("table",Ee,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(g,V)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",be,[e.createElementVNode("div",ke,[e.createElementVNode("div",ge,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[21]||(l[21]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(i)[`contact-${V}-Name`],modelValue:g.Name,"onUpdate:modelValue":b=>g.Name=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ye,[e.createElementVNode("div",he,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[22]||(l[22]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(i)[`contact-${V}-JobTitle`],modelValue:g.JobTitle,"onUpdate:modelValue":b=>g.JobTitle=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",$e,[l[23]||(l[23]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Be,[e.createElementVNode("div",xe,[e.createVNode(c,{modelValue:g.Phone,"onUpdate:modelValue":b=>g.Phone=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ce,[e.createVNode(c,{placeholder:"請輸入分機",size:"4",modelValue:g.PhoneExt,"onUpdate:modelValue":b=>g.PhoneExt=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",_e,[e.createElementVNode("div",Te,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[24]||(l[24]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(i)[`contact-${V}-MobilePhone`],modelValue:g.MobilePhone,"onUpdate:modelValue":b=>g.MobilePhone=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Se,[e.createElementVNode("div",we,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[25]||(l[25]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(i)[`contact-${V}-EMail`],modelValue:g.EMail,"onUpdate:modelValue":b=>g.EMail=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),l[39]||(l[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",De,[e.createElementVNode("table",Ue,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[26]||(l[26]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[l[27]||(l[27]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(k,{error:e.unref(i).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(o).Target,"onUpdate:modelValue":l[6]||(l[6]=g=>e.unref(o).Target=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[28]||(l[28]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(i).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(o).Summary,"onUpdate:modelValue":l[7]||(l[7]=g=>e.unref(o).Summary=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[29]||(l[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(i).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Quantified,"onUpdate:modelValue":l[8]||(l[8]=g=>e.unref(o).Quantified=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[30]||(l[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(i).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Qualitative,"onUpdate:modelValue":l[9]||(l[9]=g=>e.unref(o).Qualitative=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Ae,[e.createElementVNode("table",Me,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[36]||(l[36]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(T,{modelValue:e.unref(a),"onUpdate:modelValue":l[10]||(l[10]=g=>e.isRef(a)?a.value=g:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Fe,[e.createElementVNode("table",Ie,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[l[31]||(l[31]=e.createElementVNode("th",null,"計畫名稱",-1)),l[32]||(l[32]=e.createElementVNode("th",null,"補助單位",-1)),l[33]||(l[33]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Oe,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(g,V)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(i)[`received-${V}-Name`],modelValue:g.Name,"onUpdate:modelValue":b=>g.Name=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(i)[`received-${V}-Unit`],modelValue:g.Unit,"onUpdate:modelValue":b=>g.Unit=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i)[`received-${V}-Amount`],modelValue:g.Amount,"onUpdate:modelValue":b=>g.Amount=b},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",je,[e.createElementVNode("div",Pe,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:b=>N(g),type:"button"},[...l[34]||(l[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,qe)):e.createCommentVNode("",!0),V+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...l[35]||(l[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Le,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:l[11]||(l[11]=g=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:l[12]||(l[12]=g=>d(!0)),type:"button"},[...l[40]||(l[40]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Je={class:"block"},ze={key:0,class:"text-pink lh-base mt-4"},Qe={class:"mt-4"},We={class:"table align-middle gray-table"},Ge={class:"text-center"},Ye={key:0,width:"180"},He={class:"text-center"},Ze={key:0},Ke=["innerHTML"],Xe={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},ve={key:0,class:"text-center"},et={key:0},tt={key:1,class:"text-pink"},lt={key:1,class:"tag-group mt-2 gap-1"},ot={key:0,class:"tag tag-green-light"},nt=["download","href"],rt=["onClick"],at={key:0,class:"block-bottom bg-light-teal"},dt=["disabled"],st={__name:"Attachment",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),p=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),m=e.computed(()=>O("accessibility",i.value.Status,2)),i=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:i.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=S.download,r=a=>{const s={ID:h.id,Attachments:E.value.reduce((N,d)=>N.concat(d.Files),[]),Submit:a?"true":"false"};S.accessibility("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getAttachment",{ID:h.id})]).subscribe(a=>{const s=a[0];i.value=s.Project,E.value=E.value.filter(N=>{var d;return!((d=N.Excludes)!=null&&d.includes(i.value.OrgCategory))}),E.value.forEach(N=>{N.Files=s.Attachments.filter(d=>d.Type===N.Type),N.Uploaded=e.computed(()=>N.Files.filter(d=>!d.Deleted).length)}),F().accessibility={step:i.value.FormStep,status:i.value.Status}})}),e.provide("editable",m),(a,s)=>{const N=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Je,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",ze,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Qe,[e.createElementVNode("table",We,[e.createElementVNode("thead",Ge,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Ye,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,x)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",He,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Ze,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(N,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(m)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Ke)):e.createCommentVNode("",!0),e.unref(m)&&u.Template?(e.openBlock(),e.createElementBlock("button",Xe,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",ve,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",et,"已上傳")):(e.openBlock(),e.createElementBlock("span",tt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(m)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",lt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ot,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,nt),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,rt)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",at,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(p),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,dt)])):e.createCommentVNode("",!0)],64)}}},ct={class:"block"},mt={class:"mt-4"},it={class:"table-responsive mt-3 mb-0"},Vt={class:"table align-middle gray-table"},pt={key:0,width:"1"},ft={key:0},Nt={class:"d-flex gap-2"},ut=["onClick"],Et={class:"table-responsive mt-3 mb-0"},bt={class:"table align-middle gray-table"},kt={key:0,class:"block-bottom bg-light-teal"},gt={__name:"Benefit",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.computed(()=>O("accessibility",n.value.Status,4)),m=e.ref({}),i=e.computed(()=>E.value.filter(N=>!N.Deleted)),n=e.ref({}),o=()=>E.value.push({}),r=N=>N.Deleted=!0,a=N=>{if(m.value={},N&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Project:n.value,Benefits:E.value,Submit:N?"true":"false"};S.accessibility("saveBenefit",d).subscribe(()=>{N?window.location.href=`Attachment.aspx?ID=${h.id}`:window.location.reload()})},s=()=>{let N={Benefit:"不可量化成果"};return m.value=w(n.value,N),N={Title:"指標",Target:"目標值",Description:"說明"},i.value.forEach((d,u)=>Object.assign(m.value,w(d,N,`item-${u}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getBenefit",{ID:h.id})]).subscribe(N=>{const d=N[0];n.value=d.Project,E.value=d.Benefits,E.value.length||o(),F().accessibility={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",p),(N,d)=>{const u=e.resolveComponent("input-text"),x=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ct,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",mt,[e.createElementVNode("div",it,[e.createElementVNode("table",Vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[d[3]||(d[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),d[4]||(d[4]=e.createElementVNode("th",null,"目標值",-1)),d[5]||(d[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(p)?(e.openBlock(),e.createElementBlock("th",pt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(l,t)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(m)[`item-${t}-Title`],modelValue:l.Title,"onUpdate:modelValue":c=>l.Title=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(m)[`item-${t}-Target`],modelValue:l.Target,"onUpdate:modelValue":c=>l.Target=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m)[`item-${t}-Description`],rows:"1",modelValue:l.Description,"onUpdate:modelValue":c=>l.Description=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",ft,[e.createElementVNode("div",Nt,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:c=>r(l),type:"button"},[...d[6]||(d[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ut)):e.createCommentVNode("",!0),t+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...d[7]||(d[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Et,[e.createElementVNode("table",bt,[d[8]||(d[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":d[0]||(d[0]=l=>e.unref(n).Benefit=l),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",kt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=l=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=l=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},yt={class:"block"},ht={class:"mt-4"},$t={class:"table-responsive mt-3 mb-0"},Bt={class:"table align-middle gray-table"},xt={class:"text-end"},Ct={class:"text-end"},_t={class:"table-responsive"},Tt={class:"table align-middle gray-table"},St=["colspan"],wt={key:0,width:"1"},Dt={class:"text-end"},Ut={key:0},At={class:"d-flex gap-2"},Mt=["onClick"],Ft={class:"mt-4"},It={class:"table-responsive mt-3 mb-0"},Ot={class:"table align-middle gray-table"},jt={key:0,width:"1"},Pt={class:"text-end"},qt={key:0},Lt={class:"d-flex gap-2"},Rt=["onClick"],Jt={key:0,class:"block-bottom bg-light-teal"},zt={__name:"Funding",props:{id:{type:Number}},setup(y){const h=y,E=e.computed(()=>O("accessibility",n.value.Status,3)),p=e.ref({}),m=e.computed(()=>o.value.filter(l=>!l.Deleted)),i=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref(0),s=()=>o.value.push({}),N=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(p.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,OtherSubsidies:o.value,BudgetPlans:r.value,Submit:l?"true":"false"};S.accessibility("saveFunding",t).subscribe(()=>{l?window.location.href=`Benefit.aspx?ID=${h.id}`:window.location.reload()})},x=()=>{let l={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return p.value=w(n.value,l),l={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},o.value.forEach((t,c)=>Object.assign(p.value,w(t,l,`other-${c}-`))),l={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,c)=>Object.assign(p.value,w(t,l,`plan-${c}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getFunding",{ID:h.id})]).subscribe(l=>{const t=l[0];n.value=t.Project,o.value=t.OtherSubsidies,r.value=t.BudgetPlans,o.value.length||s(),r.value.length||N(),F().accessibility={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=m.value.reduce((l,t)=>l+I(t.Amount),0),a.value=I(n.value.ApplyAmount)+I(n.value.SelfAmount)+I(n.value.OtherAmount),m.value.forEach(l=>l.percent=Math.round(I(l.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(l=>l.sum=I(l.Amount)+I(l.OtherAmount))}),(l,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),k=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yt,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",ht,[e.createElementVNode("div",$t,[e.createElementVNode("table",Bt,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(n).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(n).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",xt,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",Ct,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",_t,[e.createElementVNode("table",Tt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,St)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",wt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(B,g)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,e.toDisplayString(g+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(p)[`other-${g}-Unit`],modelValue:B.Unit,"onUpdate:modelValue":V=>B.Unit=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`other-${g}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":V=>B.Amount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Dt,e.toDisplayString(B.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`other-${g}-Content`],rows:"1",modelValue:B.Content,"onUpdate:modelValue":V=>B.Content=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Ut,[e.createElementVNode("div",At,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V=>d(B),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Mt)):e.createCommentVNode("",!0),g+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ft,[e.createElementVNode("div",It,[e.createElementVNode("table",Ot,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",jt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(B,g)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(p)[`plan-${g}-Title`],modelValue:B.Title,"onUpdate:modelValue":V=>B.Title=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`plan-${g}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":V=>B.Amount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`plan-${g}-OtherAmount`],modelValue:B.OtherAmount,"onUpdate:modelValue":V=>B.OtherAmount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Pt,e.toDisplayString(B.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`plan-${g}-Description`],rows:"1",modelValue:B.Description,"onUpdate:modelValue":V=>B.Description=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",qt,[e.createElementVNode("div",Lt,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V=>d(B),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Rt)):e.createCommentVNode("",!0),g+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Jt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=B=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=B=>u(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Qt={__name:"ProgressBar",setup(y){const h=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,p)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:h,type:"accessibility"})}}},Wt={class:"block"},Gt={class:"mt-4"},Yt={class:"table align-middle gray-table side-table"},Ht={class:"d-flex align-items-center gap-2"},Zt={class:"input-group w-auto"},Kt={key:0,class:"invalid mt-0"},Xt={class:"table-responsive mt-4"},vt={class:"table align-middle gray-table"},el={key:0},tl={class:"input-group"},ll={key:0,class:"invalid mt-0"},ol={key:0},nl={class:"d-flex gap-2"},rl=["onClick"],al={class:"mt-4"},dl={class:"table align-middle gray-table"},sl={key:0},cl={key:0},ml={class:"d-flex gap-2"},il=["onClick"],Vl={key:0,class:"block-bottom bg-light-teal"},pl={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const h=y,E=[{value:1,text:"50%"},{value:2,text:"100%"}],p=e.computed(()=>O("accessibility",o.value.Status,2)),m=e.ref({}),i=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.computed(()=>a.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref([]),s=()=>S.accessibility("createItem",{ID:h.id}).subscribe(l=>r.value.push(l)),N=()=>a.value.push({Type:0,ItemID:0}),d=l=>l.Deleted=!0,u=l=>{if(m.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Items:r.value,Schedules:a.value,Submit:l?"true":"false"};S.accessibility("saveWorkSchedule",t).subscribe(()=>{l?window.location.href=`Funding.aspx?ID=${h.id}`:window.location.reload()})},x=()=>{let l={StartTime:"計畫期程",EndTime:"計畫期程"};return m.value=w(o.value,l),l={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},i.value.forEach((t,c)=>Object.assign(m.value,w(t,l,`item-${c}-`))),l={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},n.value.forEach((t,c)=>Object.assign(m.value,w(t,l,`schedule-${c}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getWorkSchedule",{ID:h.id})]).subscribe(l=>{const t=l[0];o.value=t.Project,r.value=t.Items,a.value=t.Schedules,r.value.length||s(),a.value.length||N(),F().accessibility={step:o.value.FormStep,status:o.value.Status}})}),e.provide("editable",p),(l,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),B=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wt,[t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Gt,[e.createElementVNode("table",Yt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ht,[e.createElementVNode("div",Zt,[e.createVNode(f,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[0]||(t[0]=V=>e.unref(o).StartTime=V)},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[1]||(t[1]=V=>e.unref(o).EndTime=V)},null,8,["modelValue"])]),t[6]||(t[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(m).StartTime||e.unref(m).EndTime?(e.openBlock(),e.createElementBlock("div",Kt,e.toDisplayString(e.unref(m).StartTime||e.unref(m).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Xt,[e.createElementVNode("table",vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[11]||(t[11]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[7]||(t[7]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(p)?(e.openBlock(),e.createElementBlock("th",el,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+b)),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m)[`item-${b}-Title`],modelValue:V.Title,"onUpdate:modelValue":C=>V.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",tl,[e.createVNode(T,{"empty-value":0,modelValue:V.Begin,"onUpdate:modelValue":C=>V.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:V.End,"onUpdate:modelValue":C=>V.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(m)[`item-${b}-Begin`]||e.unref(m)[`item-${b}-End`]?(e.openBlock(),e.createElementBlock("div",ll,e.toDisplayString(e.unref(m)[`item-${b}-Begin`]||e.unref(m)[`item-${b}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(m)[`item-${b}-Deadline`],modelValue:V.Deadline,"onUpdate:modelValue":C=>V.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`item-${b}-Content`],rows:"1",modelValue:V.Content,"onUpdate:modelValue":C=>V.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",ol,[e.createElementVNode("div",nl,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,rl)):e.createCommentVNode("",!0),b+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",al,[e.createElementVNode("table",dl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[14]||(t[14]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[18]||(t[18]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(p)?(e.openBlock(),e.createElementBlock("th",sl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(m)[`schedule-${b}-Type`],options:E,modelValue:V.Type,"onUpdate:modelValue":C=>V.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(m)[`schedule-${b}-ItemID`],options:e.unref(i),"text-name":"Title","value-name":"ID",modelValue:V.ItemID,"onUpdate:modelValue":C=>V.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(V.ItemID?String.fromCharCode(65+e.unref(i).findIndex(C=>C.ID===V.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(m)[`schedule-${b}-Deadline`],modelValue:V.Deadline,"onUpdate:modelValue":C=>V.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`schedule-${b}-Content`],rows:"1",modelValue:V.Content,"onUpdate:modelValue":C=>V.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",cl,[e.createElementVNode("div",ml,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,il)):e.createCommentVNode("",!0),b+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Vl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=V=>u(!0)),type:"button"},[...t[24]||(t[24]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},fl={class:"application-step"},Nl=["onClick"],ul={class:"step-content"},El={class:"step-label"},bl={key:0,class:"step-status edit"},kl={key:1,class:"step-status"},gl={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(y,{emit:h}){const E=e.computed(()=>O(m.type,p[m.type].status,m.step)),p=F(),m=y,i=o=>{m.review?n("click",o.step):o.step<=p[m.type].step&&(location.href=`${o.url}.aspx?ID=${m.id}`)},n=h;return(o,r)=>(e.openBlock(),e.createElementBlock("div",fl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.steps,a=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(E)&&(a.step<e.unref(p)[y.type].step||a.step===y.step)}]),onClick:s=>i(a),key:a,role:"button"},[e.createElementVNode("div",ul,[e.createElementVNode("div",El,e.toDisplayString(a.title),1),e.unref(E)&&a.step===y.step?(e.openBlock(),e.createElementBlock("div",bl,"編輯中")):a.step<e.unref(p)[y.type].step?(e.openBlock(),e.createElementBlock("div",kl,"已完成")):e.createCommentVNode("",!0)])],10,Nl))),128))]))}},yl={class:"block"},hl={class:"mt-4"},$l={class:"table align-middle gray-table side-table"},Bl={key:0},xl={key:1,class:"text-light-gray"},Cl={class:"d-flex gap-2"},_l={key:0,class:"invalid mt-0"},Tl={class:"d-flex flex-column gap-2"},Sl={key:0},wl={class:"mt-4"},Dl={class:"table align-middle gray-table side-table"},Ul={class:"row g-3"},Al={class:"col-12 col-xl-2"},Ml={class:"text-gray mb-2"},Fl={class:"col-12 col-xl-3"},Il={class:"text-gray mb-2"},Ol={class:"col-12 col-xl-4"},jl={class:"row g-1"},Pl={class:"col-7"},ql={class:"col-5"},Ll={class:"col-12 col-xl-3"},Rl={class:"text-gray mb-2"},Jl={class:"col-12"},zl={class:"text-gray mb-2"},Ql={class:"mt-4"},Wl={class:"table align-middle gray-table side-table"},Gl={class:"mt-4"},Yl={class:"table align-middle gray-table side-table"},Hl={key:0,class:"table-responsive mt-3 mb-0"},Zl={class:"table align-middle gray-table"},Kl={key:0},Xl={key:0},vl={class:"d-flex gap-2"},eo=["onClick"],to={key:0,class:"block-bottom bg-light-teal"},lo={__name:"Application",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.ref(),m=e.computed(()=>O("culture",a.value.Status,1)),i=e.ref({}),n=e.ref(null),o=e.ref([]),r=e.computed(()=>N.value.filter(f=>!f.Deleted)),a=e.ref({}),s=e.computed(()=>o.value.filter(f=>!f.ParentCode)),N=e.ref([]),d=e.computed(()=>o.value.filter(f=>f.ParentCode===n.value)),u=e.computed({get:()=>!!r.value.length,set:f=>{f?x():N.value.forEach(k=>k.Deleted=!0)}}),x=()=>N.value.push({}),l=f=>f.Deleted=!0,t=f=>{if(i.value={},f&&!c()){e.nextTick(()=>{var T;return(T=document.querySelector(".invalid"))==null?void 0:T.scrollIntoView({behavior:"smooth",block:"center"})});return}const k={Project:a.value,Contacts:p.value,ReceivedSubsidies:N.value.filter(T=>T.ID||!T.Deleted),Submit:f?"true":"false"};S.culture("saveApplication",k).subscribe(T=>{f?window.location.href=`WorkSchedule.aspx?ID=${T.ID}`:a.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${T.ID}`})},c=()=>{let f={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value.OrgCategory==="3"&&(f.RegisteredNum="立案登記證字號"),i.value=w(a.value,f),f={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},p.value.forEach((k,T)=>Object.assign(i.value,w(k,f,`contact-${T}-`))),f={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},N.value.forEach((k,T)=>Object.assign(i.value,w(k,f,`received-${T}-`))),!Object.keys(i.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getZgsCodes",{CodeGroup:"CULField"}),S.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(f=>{o.value=f[0],E.value=f[1],h.id?S.culture("getApplication",{ID:h.id}).subscribe(k=>{var T;a.value=k.Project,p.value=k.Contacts,N.value=k.ReceivedSubsidies,n.value=((T=o.value.find(B=>B.Code===a.value.Field))==null?void 0:T.ParentCode)||null,a.value.OrgCategory=a.value.OrgCategory||null,F().culture={step:a.value.FormStep,status:a.value.Status}}):S.culture("getEmptyApplication").subscribe(k=>{n.value=null,a.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},k),p.value=[{Role:"負責人"},{Role:"聯絡人"}],F().culture={step:a.value.FormStep,status:a.value.Status}})})}),e.provide("editable",m),e.watch(n,()=>{n.value?d.value.find(f=>a.value.Field===f.Code)||(a.value.Field=d.value[0].Code):a.value.Field=null}),(f,k)=>{const T=e.resolveComponent("required-label"),B=e.resolveComponent("input-text"),g=e.resolveComponent("input-select"),V=e.resolveComponent("input-textarea"),b=e.resolveComponent("input-boolean"),C=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yl,[k[40]||(k[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",hl,[e.createElementVNode("table",$l,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[k[15]||(k[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).Year),1)]),e.createElementVNode("tr",null,[k[16]||(k[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(a).ProjectID?(e.openBlock(),e.createElementBlock("span",Bl,e.toDisplayString(e.unref(a).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",xl,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[k[17]||(k[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[18]||(k[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i).ProjectName,modelValue:e.unref(a).ProjectName,"onUpdate:modelValue":k[0]||(k[0]=_=>e.unref(a).ProjectName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[19]||(k[19]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Cl,[e.createVNode(g,{"empty-value":null,options:e.unref(s),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n),"onUpdate:modelValue":k[1]||(k[1]=_=>e.isRef(n)?n.value=_:null)},null,8,["options","modelValue"]),e.createVNode(g,{"empty-value":null,disabled:!e.unref(n),options:e.unref(d),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).Field,"onUpdate:modelValue":k[2]||(k[2]=_=>e.unref(a).Field=_)},null,8,["disabled","options","modelValue"])]),e.unref(i).Field?(e.openBlock(),e.createElementBlock("div",_l,e.toDisplayString(e.unref(i).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[20]||(k[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(a).OrgName,"onUpdate:modelValue":k[3]||(k[3]=_=>e.unref(a).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[21]||(k[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Tl,[e.createElementVNode("div",null,[e.createVNode(g,{"empty-value":null,error:e.unref(i).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).OrgCategory,"onUpdate:modelValue":k[4]||(k[4]=_=>e.unref(a).OrgCategory=_)},null,8,["error","options","modelValue"])]),e.unref(a).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Sl,[e.createVNode(B,{error:e.unref(i).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(a).RegisteredNum,"onUpdate:modelValue":k[5]||(k[5]=_=>e.unref(a).RegisteredNum=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[22]||(k[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i).TaxID,modelValue:e.unref(a).TaxID,"onUpdate:modelValue":k[6]||(k[6]=_=>e.unref(a).TaxID=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[23]||(k[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i).Address,placeholder:"請輸入地址",modelValue:e.unref(a).Address,"onUpdate:modelValue":k[7]||(k[7]=_=>e.unref(a).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),k[41]||(k[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",wl,[e.createElementVNode("table",Dl,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(_,D)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ul,[e.createElementVNode("div",Al,[e.createElementVNode("div",Ml,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[24]||(k[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(B,{error:e.unref(i)[`contact-${D}-Name`],modelValue:_.Name,"onUpdate:modelValue":M=>_.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fl,[e.createElementVNode("div",Il,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[25]||(k[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(B,{error:e.unref(i)[`contact-${D}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":M=>_.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ol,[k[26]||(k[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",jl,[e.createElementVNode("div",Pl,[e.createVNode(B,{modelValue:_.Phone,"onUpdate:modelValue":M=>_.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ql,[e.createVNode(B,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":M=>_.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Ll,[e.createElementVNode("div",Rl,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[27]||(k[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(B,{error:e.unref(i)[`contact-${D}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":M=>_.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Jl,[e.createElementVNode("div",zl,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[28]||(k[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(B,{error:e.unref(i)[`contact-${D}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":M=>_.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),k[42]||(k[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Ql,[e.createElementVNode("table",Wl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[29]||(k[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[k[30]||(k[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(V,{error:e.unref(i).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(a).Target,"onUpdate:modelValue":k[8]||(k[8]=_=>e.unref(a).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[31]||(k[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(i).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(a).Summary,"onUpdate:modelValue":k[9]||(k[9]=_=>e.unref(a).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[32]||(k[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(i).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Quantified,"onUpdate:modelValue":k[10]||(k[10]=_=>e.unref(a).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[33]||(k[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(i).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Qualitative,"onUpdate:modelValue":k[11]||(k[11]=_=>e.unref(a).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Gl,[e.createElementVNode("table",Yl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[k[39]||(k[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(u),"onUpdate:modelValue":k[12]||(k[12]=_=>e.isRef(u)?u.value=_:null)},null,8,["modelValue"]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Hl,[e.createElementVNode("table",Zl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[k[34]||(k[34]=e.createElementVNode("th",null,"計畫名稱",-1)),k[35]||(k[35]=e.createElementVNode("th",null,"補助單位",-1)),k[36]||(k[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Kl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(_,D)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i)[`received-${D}-Name`],modelValue:_.Name,"onUpdate:modelValue":M=>_.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i)[`received-${D}-Unit`],modelValue:_.Unit,"onUpdate:modelValue":M=>_.Unit=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(i)[`received-${D}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":M=>_.Amount=M},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Xl,[e.createElementVNode("div",vl,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>l(_),type:"button"},[...k[37]||(k[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,eo)):e.createCommentVNode("",!0),D+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:x,type:"button"},[...k[38]||(k[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",to,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[13]||(k[13]=_=>t()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[14]||(k[14]=_=>t(!0)),type:"button"},[...k[43]||(k[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},oo={class:"block"},no={key:0,class:"text-pink lh-base mt-4"},ro={class:"mt-4"},ao={class:"table align-middle gray-table"},so={class:"text-center"},co={key:0,width:"180"},mo={class:"text-center"},io={key:0},Vo=["innerHTML"],po={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},fo={key:0,class:"text-center"},No={key:0},uo={key:1,class:"text-pink"},Eo={key:1,class:"tag-group mt-2 gap-1"},bo={key:0,class:"tag tag-green-light"},ko=["download","href"],go=["onClick"],yo={key:0,class:"block-bottom bg-light-teal"},ho=["disabled"],$o={__name:"Attachment",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:!0,Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),p=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),m=e.computed(()=>O("culture",i.value.Status,5)),i=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:i.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=S.download,r=a=>{const s={ID:h.id,Attachments:E.value.reduce((N,d)=>N.concat(d.Files),[]),Submit:a?"true":"false"};S.culture("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getAttachment",{ID:h.id})]).subscribe(a=>{const s=a[0];i.value=s.Project,E.value=E.value.filter(N=>{var d;return!((d=N.Excludes)!=null&&d.includes(i.value.OrgCategory))}),E.value.forEach(N=>{N.Files=s.Attachments.filter(d=>d.Type===N.Type),N.Uploaded=e.computed(()=>N.Files.filter(d=>!d.Deleted).length)}),F().culture={step:i.value.FormStep,status:i.value.Status}})}),e.provide("editable",m),(a,s)=>{const N=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oo,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",no,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ro,[e.createElementVNode("table",ao,[e.createElementVNode("thead",so,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",co,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,x)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",mo,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",io,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(N,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(m)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Vo)):e.createCommentVNode("",!0),e.unref(m)&&u.Template?(e.openBlock(),e.createElementBlock("button",po,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",fo,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",No,"已上傳")):(e.openBlock(),e.createElementBlock("span",uo,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(m)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Eo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",bo,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,ko),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,go)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",yo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(p),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ho)])):e.createCommentVNode("",!0)],64)}}},Bo={class:"block"},xo={class:"mt-4"},Co={class:"table-responsive mt-3 mb-0"},_o={class:"table align-middle gray-table"},To={class:"text-end"},So={class:"text-end"},wo={class:"table-responsive"},Do={class:"table align-middle gray-table"},Uo=["colspan"],Ao={key:0,width:"1"},Mo={key:0},Fo={class:"d-flex gap-2"},Io=["onClick"],Oo={class:"mt-4"},jo={class:"table-responsive mt-3 mb-0"},Po={class:"table align-middle gray-table"},qo={key:0,width:"1"},Lo={class:"text-end"},Ro={key:0},Jo={class:"d-flex gap-2"},zo=["onClick"],Qo={key:0,class:"block-bottom bg-light-teal"},Wo={__name:"Funding",props:{id:{type:Number}},setup(y){const h=y,E=e.computed(()=>O("culture",n.value.Status,3)),p=e.ref({}),m=e.computed(()=>r.value.filter(c=>!c.Deleted)),i=e.computed(()=>a.value.filter(c=>!c.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref([]),s=e.ref(0),N=()=>r.value.push({}),d=()=>a.value.push({ItemID:0}),u=c=>c.Deleted=!0,x=c=>c.Deleted=!0,l=c=>{if(p.value={},c&&!t()){e.nextTick(()=>{var k;return(k=document.querySelector(".invalid"))==null?void 0:k.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:n.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:c?"true":"false"};S.culture("saveFunding",f).subscribe(()=>{c?window.location.href=`Other.aspx?ID=${h.id}`:window.location.reload()})},t=()=>{let c={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return p.value=w(n.value,c),c={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},r.value.forEach((f,k)=>Object.assign(p.value,w(f,c,`other-${k}-`))),c={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((f,k)=>Object.assign(p.value,w(f,c,`plan-${k}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getFunding",{ID:h.id})]).subscribe(c=>{const f=c[0];n.value=f.Project,r.value=f.OtherSubsidies,a.value=f.BudgetPlans,o.value=f.Items,r.value.length||N(),a.value.length||d(),F().culture={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=r.value.reduce((c,f)=>c+(f.Deleted?0:I(f.Amount)),0),s.value=I(n.value.ApplyAmount)+I(n.value.SelfAmount)+I(n.value.OtherAmount),a.value.forEach(c=>c.sum=I(c.Amount)+I(c.OtherAmount))}),(c,f)=>{var V;const k=e.resolveComponent("input-integer"),T=e.resolveComponent("input-text"),B=e.resolveComponent("input-select"),g=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Bo,[f[20]||(f[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",xo,[e.createElementVNode("div",Co,[e.createElementVNode("table",_o,[f[4]||(f[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":f[0]||(f[0]=b=>e.unref(n).ApplyAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":f[1]||(f[1]=b=>e.unref(n).SelfAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",To,e.toDisplayString((V=e.unref(n).OtherAmount)==null?void 0:V.toLocaleString()),1),e.createElementVNode("td",So,e.toDisplayString(e.unref(s).toLocaleString()),1)])])])]),f[10]||(f[10]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",wo,[e.createElementVNode("table",Do,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Uo)]),e.createElementVNode("tr",null,[f[5]||(f[5]=e.createElementVNode("th",{width:"1"},null,-1)),f[6]||(f[6]=e.createElementVNode("th",null,"單位名稱",-1)),f[7]||(f[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Ao,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(p)[`other-${C}-Unit`],modelValue:b.Unit,"onUpdate:modelValue":_=>b.Unit=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`other-${C}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Mo,[e.createElementVNode("div",Fo,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>u(b),type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Io)):e.createCommentVNode("",!0),C+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...f[9]||(f[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),f[21]||(f[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Oo,[e.createElementVNode("div",jo,[e.createElementVNode("table",Po,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[11]||(f[11]=e.createElementVNode("th",null,"重要工作項目",-1)),f[12]||(f[12]=e.createElementVNode("th",null,"預算項目",-1)),f[13]||(f[13]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),f[14]||(f[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),f[15]||(f[15]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),f[16]||(f[16]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",qo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(B,{"empty-value":0,error:e.unref(p)[`plan-${C}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:b.ItemID,"onUpdate:modelValue":_=>b.ItemID=_},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(p)[`plan-${C}-Title`],modelValue:b.Title,"onUpdate:modelValue":_=>b.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`plan-${C}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`plan-${C}-OtherAmount`],modelValue:b.OtherAmount,"onUpdate:modelValue":_=>b.OtherAmount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Lo,e.toDisplayString(b.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(p)[`plan-${C}-Description`],rows:"1",modelValue:b.Description,"onUpdate:modelValue":_=>b.Description=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Ro,[e.createElementVNode("div",Jo,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>x(b),type:"button"},[...f[17]||(f[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,zo)):e.createCommentVNode("",!0),C+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...f[18]||(f[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),f[19]||(f[19]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Qo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=b=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=b=>l(!0)),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Go={class:"block"},Yo={key:0,class:"text-pink lh-base mt-3"},Ho={class:"border"},Zo={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Ko={class:"d-flex gap-2 align-items-center flex-grow-1"},Xo={class:"text-nowrap"},vo={class:"flex-grow-1"},en={class:"d-flex gap-2"},tn=["onClick"],ln=["href"],on=["id"],nn={class:"table align-middle gray-table side-table mb-0"},rn={key:0,class:"block-bottom bg-light-teal"},an={__name:"Other",props:{id:{type:Number}},setup(y){const h=y,E=e.computed(()=>O("culture",m.value.Status,4)),p=e.ref({}),m=e.ref({}),i=e.ref([]),n=e.computed(()=>i.value.filter(N=>!N.Deleted)),o=()=>i.value.push({}),r=N=>N.Deleted=!0,a=N=>{if(p.value={},N&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={ID:h.id,Projects:i.value,Submit:N?"true":"false"};S.culture("saveRelatedProject",d).subscribe(()=>{N?window.location.href=`Attachment.aspx?ID=${h.id}`:window.location.reload()})},s=()=>{p.value={};const N={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return n.value.forEach((d,u)=>Object.assign(p.value,w(d,N,`project-${u}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getRelatedProject",{ID:h.id})]).subscribe(N=>{const d=N[0];m.value=d.Project,i.value=d.Projects,F().culture={step:m.value.FormStep,status:m.value.Status}})}),e.provide("editable",E),(N,d)=>{const u=e.resolveComponent("required-label"),x=e.resolveComponent("input-text"),l=e.resolveComponent("input-integer"),t=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Go,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("p",Yo," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(c,f)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:c},[e.createElementVNode("div",Ho,[e.createElementVNode("div",Zo,[e.createElementVNode("div",Ko,[e.createElementVNode("label",Xo,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[2]||(d[2]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",vo,[e.createVNode(x,{error:e.unref(p)[`project-${f}-Title`],modelValue:c.Title,"onUpdate:modelValue":k=>c.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",en,[e.unref(E)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(k=>r(c),["prevent"]),href:"#"},"刪除",8,tn)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${f}`,role:"button"},"收合",8,ln)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${f}`},[e.createElementVNode("table",nn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[3]||(d[3]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(l,{class:"text-start w-auto",error:e.unref(p)[`project-${f}-Year`],modelValue:c.Year,"onUpdate:modelValue":k=>c.Year=k},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[4]||(d[4]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(p)[`project-${f}-OrgName`],modelValue:c.OrgName,"onUpdate:modelValue":k=>c.OrgName=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[5]||(d[5]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(l,{class:"w-auto",error:e.unref(p)[`project-${f}-Amount`],modelValue:c.Amount,"onUpdate:modelValue":k=>c.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[6]||(d[6]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(p)[`project-${f}-Description`],rows:"4",modelValue:c.Description,"onUpdate:modelValue":k=>c.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[7]||(d[7]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(p)[`project-${f}-Benefit`],rows:"4",modelValue:c.Benefit,"onUpdate:modelValue":k=>c.Benefit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,on)])]))),128)),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:o,type:"button"},[...d[8]||(d[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",rn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[0]||(d[0]=c=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[1]||(d[1]=c=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},dn={__name:"ProgressBar",setup(y){const h=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,p)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:h,type:"culture"})}}},sn=(y,h)=>{const E=y.__vccOpts||y;for(const[p,m]of h)E[p]=m;return E},cn={class:"block"},mn={class:"mt-4"},Vn={class:"table align-middle gray-table side-table"},pn={class:"d-flex align-items-center gap-2"},fn={class:"input-group w-auto"},Nn={key:0,class:"invalid mt-0"},un={class:"square-title mt-4"},En={class:"mt-4"},bn=["onClick"],kn={class:"d-flex flex-column gap-2"},gn={class:"mt-4 d-flex flex-column gap-2"},yn={class:"d-flex flex-column gap-3 mt-4"},hn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},$n={class:"d-flex gap-2 align-items-center flex-grow-1"},Bn={class:"text-nowrap"},xn={class:"flex-grow-1"},Cn={class:"d-flex gap-2"},_n=["onClick"],Tn=["href"],Sn=["id"],wn={class:"table align-middle gray-table side-table mb-0"},Dn={class:"p-0"},Un={class:"item-list"},An={class:"mt-2 align-self-start text-center"},Mn={class:"input-group"},Fn={key:0,class:"invalid mt-0"},In={key:0,class:"d-flex gap-2 mt-1 align-self-start"},On=["onClick"],jn=["onClick"],Pn={class:"row"},qn={class:"col"},Ln=["value"],Rn={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Jn=["onClick"],zn=["onClick"],Qn={class:"col"},Wn=["value"],Gn={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Yn=["onClick"],Hn=["onClick"],Zn=["onClick"],Kn={key:0,class:"block-bottom bg-light-teal"},Xn=sn({__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const h=y,E=e.computed(()=>O("culture",i.value.Status,2)),p=e.ref({}),m=e.computed(()=>n.value.filter(c=>!c.Deleted)),i=e.ref({}),n=e.ref([]),o=()=>{const c={Items:[]};r(c),n.value.push(c)},r=c=>{const f={Steps:[],Schedules:[]};s(f),s(f),s(f),a(f,1),a(f,2),c.Items.push(f)},a=(c,f)=>c.Schedules.push({Type:f,Month:0,StepID:0}),s=c=>c.Steps.push({Begin:0,End:0}),N=c=>c.Deleted=!0,d=c=>c.Deleted=!0,u=c=>c.Deleted=!0,x=c=>c.Deleted=!0,l=c=>{if(p.value={},c&&!t()){e.nextTick(()=>{var k;return(k=document.querySelector(".invalid"))==null?void 0:k.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:i.value,Goals:n.value,Submit:c?"true":"false"};S.culture("saveWorkSchedule",f).subscribe(()=>{c?window.location.href=`Funding.aspx?ID=${h.id}`:window.location.reload()})},t=()=>{const c={StartTime:"計畫期程",EndTime:"計畫期程"};p.value=w(i.value,c);const f={Title:"計畫目標",Content:"預期效益"},k={Title:"重要工作項目",Indicator:"績效指標"},T={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},B={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return n.value.filter(g=>!g.Deleted).forEach((g,V)=>{Object.assign(p.value,w(g,f,`goal-${V}-`)),g.Items.filter(b=>!b.Deleted).forEach((b,C)=>{Object.assign(p.value,w(b,k,`item-${V}-${C}-`)),b.Steps.filter(_=>!_.Deleted).forEach((_,D)=>Object.assign(p.value,w(_,T,`step-${V}-${C}-${D}-`))),b.Schedules.filter(_=>_.Type===1&&!_.Deleted).forEach((_,D)=>Object.assign(p.value,w(_,B,`schedule-${V}-${C}-1-${D}-`))),b.Schedules.filter(_=>_.Type===2&&!_.Deleted).forEach((_,D)=>Object.assign(p.value,w(_,B,`schedule-${V}-${C}-2-${D}-`)))})}),!Object.keys(p.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getWorkSchedule",{ID:h.id})]).subscribe(c=>{const f=c[0];i.value=f.Project,n.value=f.Goals,n.value.length||o(),F().culture={step:i.value.FormStep,status:i.value.Status}})}),e.provide("editable",E),(c,f)=>{const k=e.resolveComponent("required-label"),T=e.resolveComponent("input-tw-date"),B=e.resolveComponent("input-text"),g=e.resolveComponent("input-textarea"),V=e.resolveComponent("input-month"),b=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",cn,[f[24]||(f[24]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",mn,[e.createElementVNode("table",Vn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[4]||(f[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",pn,[e.createElementVNode("div",fn,[e.createVNode(T,{class:"w-auto",modelValue:e.unref(i).StartTime,"onUpdate:modelValue":f[0]||(f[0]=C=>e.unref(i).StartTime=C)},null,8,["modelValue"]),f[5]||(f[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(T,{class:"w-auto",modelValue:e.unref(i).EndTime,"onUpdate:modelValue":f[1]||(f[1]=C=>e.unref(i).EndTime=C)},null,8,["modelValue"])]),f[6]||(f[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(p).StartTime||e.unref(p).EndTime?(e.openBlock(),e.createElementBlock("div",Nn,e.toDisplayString(e.unref(p).StartTime||e.unref(p).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",un,[f[8]||(f[8]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:o,type:"button"},[...f[7]||(f[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",En,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(C,_)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:C},[e.unref(E)&&e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:D=>N(C),type:"button"},"刪除",8,bn)):e.createCommentVNode("",!0),e.createElementVNode("div",kn,[f[9]||(f[9]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(B,{error:e.unref(p)[`goal-${_}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",gn,[f[10]||(f[10]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(g,{error:e.unref(p)[`goal-${_}-Content`],rows:"4",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",yn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Items.filter(D=>!D.Deleted),(D,M)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:D},[e.createElementVNode("div",hn,[e.createElementVNode("div",$n,[e.createElementVNode("label",Bn,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[11]||(f[11]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",xn,[e.createVNode(B,{error:e.unref(p)[`item-${_}-${M}-Title`],modelValue:D.Title,"onUpdate:modelValue":U=>D.Title=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Cn,[e.unref(E)&&C.Items.filter(U=>!U.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(U=>d(D),["prevent"]),href:"#"},"刪除",8,_n)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${M}`,role:"button"},"收合",8,Tn)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${M}`},[e.createElementVNode("table",wn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[12]||(f[12]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",Dn,[e.createElementVNode("ul",Un,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Steps.filter(U=>!U.Deleted),(U,j)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(E)}]),key:U},[e.createElementVNode("div",An,e.toDisplayString(String.fromCharCode(65+j)),1),e.createElementVNode("div",null,[e.createVNode(B,{error:e.unref(p)[`step-${_}-${M}-${j}-Title`],placeholder:"如:進行口訪紀錄",modelValue:U.Title,"onUpdate:modelValue":A=>U.Title=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",Mn,[e.createVNode(V,{"empty-value":0,modelValue:U.Begin,"onUpdate:modelValue":A=>U.Begin=A},null,8,["modelValue","onUpdate:modelValue"]),f[13]||(f[13]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(V,{"empty-value":0,modelValue:U.End,"onUpdate:modelValue":A=>U.End=A},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(p)[`step-${_}-${M}-${j}-Begin`]||e.unref(p)[`step-${_}-${M}-${j}-End`]?(e.openBlock(),e.createElementBlock("div",Fn,e.toDisplayString(e.unref(p)[`step-${_}-${M}-${j}-Begin`]||e.unref(p)[`step-${_}-${M}-${j}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",In,[D.Steps.filter(A=>!A.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>x(U),type:"button"},[...f[14]||(f[14]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,On)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:A=>s(D),type:"button"},[...f[15]||(f[15]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,jn)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[16]||(f[16]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(p)[`item-${_}-${M}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:D.Indicator,"onUpdate:modelValue":U=>D.Indicator=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...f[17]||(f[17]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Pn,[e.createElementVNode("div",qn,[f[20]||(f[20]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Schedules.filter(U=>U.Type===1&&!U.Deleted),(U,j)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:U},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?3:4}`])},[e.createVNode(V,{error:e.unref(p)[`schedule-${_}-${M}-1-${j}-Month`],"empty-value":0,modelValue:U.Month,"onUpdate:modelValue":A=>U.Month=A},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?7:8}`])},[e.createVNode(b,{"empty-value":0,error:e.unref(p)[`schedule-${_}-${M}-1-${j}-StepID`],options:D.Steps.filter(A=>!A.Deleted),modelValue:U.StepID,"onUpdate:modelValue":A=>U.StepID=A},{default:e.withCtx(({index:A,option:R})=>[e.createElementVNode("option",{value:R.ID},e.toDisplayString(String.fromCharCode(65+A))+"."+e.toDisplayString(R.Title),9,Ln)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Rn,[D.Schedules.filter(A=>A.Type===1&&!A.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>u(U),type:"button"},[...f[18]||(f[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Jn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:A=>a(D,1),type:"button"},[...f[19]||(f[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,zn)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Qn,[f[23]||(f[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Schedules.filter(U=>U.Type===2&&!U.Deleted),(U,j)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:U},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?3:4}`])},[e.createVNode(V,{error:e.unref(p)[`schedule-${_}-${M}-2-${j}-Month`],"empty-value":0,modelValue:U.Month,"onUpdate:modelValue":A=>U.Month=A},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?7:8}`])},[e.createVNode(b,{"empty-value":0,error:e.unref(p)[`schedule-${_}-${M}-2-${j}-StepID`],options:D.Steps.filter(A=>!A.Deleted),modelValue:U.StepID,"onUpdate:modelValue":A=>U.StepID=A},{default:e.withCtx(({index:A,option:R})=>[e.createElementVNode("option",{value:R.ID},e.toDisplayString(String.fromCharCode(65+A))+"."+e.toDisplayString(R.Title),9,Wn)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Gn,[D.Schedules.filter(A=>A.Type===2&&!A.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>u(U),type:"button"},[...f[21]||(f[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Yn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:A=>a(D,2),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Hn)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Sn)]))),128))]),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:D=>r(C),type:"button"},"新增工作項目",8,Zn)):e.createCommentVNode("",!0)]))),128))])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Kn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=C=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=C=>l(!0)),type:"button"},[...f[25]||(f[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-ca4b9d75"]]),vn={class:"block"},er={class:"mt-4"},tr={class:"table align-middle gray-table side-table"},lr={key:0},or={key:1,class:"text-light-gray"},nr={class:"d-flex flex-column gap-2"},rr={key:0},ar={class:"mt-4"},dr={class:"table align-middle gray-table side-table"},sr={class:"row g-3"},cr={class:"col-12 col-xl-2"},mr={class:"text-gray mb-2"},ir={class:"col-12 col-xl-3"},Vr={class:"text-gray mb-2"},pr={key:0,class:"col-12 col-xl-4"},fr={class:"row g-1"},Nr={class:"col-7"},ur={class:"col-5"},Er={key:1,class:"col-12 col-xl-3"},br={class:"text-gray mb-2"},kr={class:"mt-4"},gr={class:"table align-middle gray-table side-table"},yr={class:"d-flex align-items-center gap-2"},hr={class:"input-group w-auto"},$r={key:0,class:"invalid mt-0"},Br={class:"mt-4"},xr={class:"table-responsive mt-3 mb-0"},Cr={class:"table align-middle gray-table"},_r={class:"text-end"},Tr={class:"text-end"},Sr={class:"text-end"},wr={class:"text-end"},Dr={class:"text-end"},Ur={class:"table align-middle gray-table side-table"},Ar={key:0,class:"table-responsive mt-3 mb-0"},Mr={class:"table align-middle gray-table"},Fr={key:0},Ir={key:0},Or={class:"d-flex gap-2"},jr=["onClick"],Pr={key:0,class:"block-bottom bg-light-teal"},qr={__name:"Application",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.ref(),m=e.computed(()=>O("education",o.value.Status,1)),i=e.ref({}),n=e.computed(()=>r.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref(0),s=e.computed({get:()=>!!n.value.length,set:l=>{l?N():r.value.forEach(t=>t.Deleted=!0)}}),N=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(i.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Contacts:p.value,ReceivedSubsidies:r.value.filter(c=>c.ID||!c.Deleted),Submit:l?"true":"false"};S.education("saveApplication",t).subscribe(c=>{l?window.location.href=`Attachment.aspx?ID=${c.ID}`:o.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${c.ID}`})},x=()=>{let l={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return o.value.OrgCategory==="2"&&(l.RegisteredNum="立案登記證字號"),i.value=w(o.value,l),l={Name:"姓名",JobTitle:"職稱"},Object.assign(i.value,w(p.value[0],l,"contact-0-")),l.MobilePhone="手機號碼",Object.assign(i.value,w(p.value[1],l,"contact-1-")),l={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},r.value.forEach((t,c)=>Object.assign(i.value,w(t,l,`received-${c}-`))),!Object.keys(i.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(l=>{E.value=l[0],h.id?S.education("getApplication",{ID:h.id}).subscribe(t=>{o.value=t.Project,p.value=t.Contacts,r.value=t.ReceivedSubsidies,o.value.OrgCategory=o.value.OrgCategory||null,F().education={step:o.value.FormStep,status:o.value.Status}}):S.education("getEmptyApplication").subscribe(t=>{o.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),p.value=[{Role:"負責人"},{Role:"聯絡人"}],F().education={step:o.value.FormStep,status:o.value.Status}})})}),e.provide("editable",m),(l,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),k=e.resolveComponent("input-select"),T=e.resolveComponent("input-tw-date"),B=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-integer"),V=e.resolveComponent("input-boolean");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",vn,[t[47]||(t[47]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",er,[e.createElementVNode("table",tr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[18]||(t[18]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).Year),1)]),e.createElementVNode("tr",null,[t[19]||(t[19]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(o).ProjectID?(e.openBlock(),e.createElementBlock("span",lr,e.toDisplayString(e.unref(o).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",or,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).ProjectName,modelValue:e.unref(o).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=b=>e.unref(o).ProjectName=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",nr,[e.createElementVNode("div",null,[e.createVNode(k,{"empty-value":null,error:e.unref(i).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=b=>e.unref(o).OrgCategory=b)},null,8,["error","options","modelValue"])]),e.unref(o).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",rr,[e.createVNode(f,{error:e.unref(i).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(o).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=b=>e.unref(o).RegisteredNum=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(o).OrgName,"onUpdate:modelValue":t[3]||(t[3]=b=>e.unref(o).OrgName=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).TaxID,modelValue:e.unref(o).TaxID,"onUpdate:modelValue":t[4]||(t[4]=b=>e.unref(o).TaxID=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).Address,placeholder:"請輸入地址",modelValue:e.unref(o).Address,"onUpdate:modelValue":t[5]||(t[5]=b=>e.unref(o).Address=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[48]||(t[48]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ar,[e.createElementVNode("table",dr,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",sr,[e.createElementVNode("div",cr,[e.createElementVNode("div",mr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${C}-Name`],modelValue:b.Name,"onUpdate:modelValue":_=>b.Name=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ir,[e.createElementVNode("div",Vr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${C}-JobTitle`],modelValue:b.JobTitle,"onUpdate:modelValue":_=>b.JobTitle=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),C?(e.openBlock(),e.createElementBlock("div",pr,[t[28]||(t[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",fr,[e.createElementVNode("div",Nr,[e.createVNode(f,{modelValue:b.Phone,"onUpdate:modelValue":_=>b.Phone=_,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ur,[e.createVNode(f,{placeholder:"請輸入分機",size:"4",modelValue:b.PhoneExt,"onUpdate:modelValue":_=>b.PhoneExt=_,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),C?(e.openBlock(),e.createElementBlock("div",Er,[e.createElementVNode("div",br,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${C}-MobilePhone`],modelValue:b.MobilePhone,"onUpdate:modelValue":_=>b.MobilePhone=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[49]||(t[49]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",kr,[e.createElementVNode("table",gr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",yr,[e.createElementVNode("div",hr,[e.createVNode(T,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[6]||(t[6]=b=>e.unref(o).StartTime=b)},null,8,["modelValue"]),t[31]||(t[31]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(T,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[7]||(t[7]=b=>e.unref(o).EndTime=b)},null,8,["modelValue"])]),t[32]||(t[32]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(i).StartTime||e.unref(i).EndTime?(e.openBlock(),e.createElementBlock("div",$r,e.toDisplayString(e.unref(i).StartTime||e.unref(i).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[33]||(t[33]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).Target,modelValue:e.unref(o).Target,"onUpdate:modelValue":t[8]||(t[8]=b=>e.unref(o).Target=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[34]||(t[34]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(o).Summary,"onUpdate:modelValue":t[9]||(t[9]=b=>e.unref(o).Summary=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(i).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Quantified,"onUpdate:modelValue":t[10]||(t[10]=b=>e.unref(o).Quantified=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[50]||(t[50]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Br,[t[41]||(t[41]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",xr,[e.createElementVNode("table",Cr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",_r,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Tr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",Sr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",wr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[40]||(t[40]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(i).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=b=>e.unref(o).ApplyAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(i).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=b=>e.unref(o).SelfAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(i).OtherGovAmount,modelValue:e.unref(o).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=b=>e.unref(o).OtherGovAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(i).OtherUnitAmount,modelValue:e.unref(o).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=b=>e.unref(o).OtherUnitAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",Dr,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])])]),e.createElementVNode("table",Ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[42]||(t[42]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{modelValue:e.unref(s),"onUpdate:modelValue":t[15]||(t[15]=b=>e.isRef(s)?s.value=b:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Ar,[e.createElementVNode("table",Mr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[43]||(t[43]=e.createElementVNode("th",null,"計畫名稱",-1)),t[44]||(t[44]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Fr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i)[`received-${C}-Name`],modelValue:b.Name,"onUpdate:modelValue":_=>b.Name=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(i)[`received-${C}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Ir,[e.createElementVNode("div",Or,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>d(b),type:"button"},[...t[45]||(t[45]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jr)):e.createCommentVNode("",!0),C+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[46]||(t[46]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Pr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[16]||(t[16]=b=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[17]||(t[17]=b=>u(!0)),type:"button"},[...t[51]||(t[51]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Lr={class:"block"},Rr={key:0,class:"text-pink lh-base mt-4"},Jr={class:"mt-4"},zr={class:"table align-middle gray-table"},Qr={class:"text-center"},Wr={key:0,width:"180"},Gr={class:"text-center"},Yr={key:0},Hr=["innerHTML"],Zr={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Kr={key:0,class:"text-center"},Xr={key:0},vr={key:1,class:"text-pink"},ea={key:1,class:"tag-group mt-2 gap-1"},ta={key:0,class:"tag tag-green-light"},la=["download","href"],oa=["onClick"],na={key:0,class:"block-bottom bg-light-teal"},ra=["disabled"],aa={__name:"Attachment",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]}]),p=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),m=e.computed(()=>O("education",i.value.Status,2)),i=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:i.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=S.download,r=a=>{const s={ID:h.id,Attachments:E.value.reduce((N,d)=>N.concat(d.Files),[]),Submit:a?"true":"false"};S.education("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.education("getAttachment",{ID:h.id})]).subscribe(a=>{const s=a[0];i.value=s.Project,E.value=E.value.filter(N=>{var d;return!((d=N.Excludes)!=null&&d.includes(i.value.OrgCategory))}),E.value.forEach(N=>{N.Files=s.Attachments.filter(d=>d.Type===N.Type),N.Uploaded=e.computed(()=>N.Files.filter(d=>!d.Deleted).length)}),F().education={step:i.value.FormStep,status:i.value.Status}})}),e.provide("editable",m),(a,s)=>{const N=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Lr,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",Rr,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Jr,[e.createElementVNode("table",zr,[e.createElementVNode("thead",Qr,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Wr,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,x)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Gr,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Yr,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(N,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(m)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Hr)):e.createCommentVNode("",!0),e.unref(m)&&u.Template?(e.openBlock(),e.createElementBlock("button",Zr,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Kr,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",Xr,"已上傳")):(e.openBlock(),e.createElementBlock("span",vr,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(m)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ta,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,la),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,oa)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",na,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(p),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ra)])):e.createCommentVNode("",!0)],64)}}},da={__name:"ProgressBar",setup(y){const h=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(E,p)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:h,type:"education"})}}},sa={class:"modal-dialog modal-dialog-centered modal-md"},ca={class:"modal-content"},ma={class:"modal-body"},ia={class:"d-flex flex-column align-items-center mb-5 gap-3"},Va={class:"fs-18"},pa={__name:"ErrorModal",setup(y){const h=J(),E=e.ref();return e.onMounted(()=>E.value.addEventListener("hidden.bs.modal",()=>h.error=null)),e.watch(()=>h.error,()=>{h.error&&bootstrap.Modal.getOrCreateInstance(E.value).show()}),(p,m)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",sa,[e.createElementVNode("div",ca,[m[2]||(m[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",ma,[e.createElementVNode("div",ia,[m[0]||(m[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",Va,e.toDisplayString(e.unref(h).error),1)]),m[1]||(m[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},fa={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const h=e.useModel(y,"modelValue"),E=[{value:!0,text:"是"},{value:!1,text:"否"}];return(p,m)=>{const i=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(i,{options:E,modelValue:h.value,"onUpdate:modelValue":m[0]||(m[0]=n=>h.value=n)},null,8,["modelValue"])}}},Na=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(y,{emit:h}){const E=e.ref(),p=()=>{Array.from(E.value.files).forEach(i=>S.upload(i).subscribe(n=>m("file",n))),E.value.value=""},m=h;return(i,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:n[0]||(n[0]=o=>e.unref(E).click()),type:"button"},[...n[1]||(n[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:p,class:"d-none",ref_key:"input",ref:E,type:"file"},i.$attrs),null,16)],64))}}),ua=["disabled","placeholder","type"],Ea={key:0,class:"invalid mt-0"},ba=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const h=e.inject("editable",!0),E=e.useModel(y,"modelValue");return e.watch(E,p=>{if(p){const m=(parseInt(p)||0).toString();p.toString()!==m&&(E.value=m)}}),(p,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(h),placeholder:e.unref(h)?y.placeholder:"",style:{"text-align":"right"},type:y.type},p.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=i=>E.value=i)}),null,16,ua),[[e.vModelDynamic,E.value]]),y.error?(e.openBlock(),e.createElementBlock("div",Ea,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),ka={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const h=e.useModel(y,"modelValue"),E=[];for(let p=1;p<=12;p++)E.push({value:p,text:`${p}月`});return(p,m)=>{const i=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(i,{options:E,modelValue:h.value,"onUpdate:modelValue":m[0]||(m[0]=n=>h.value=n)},null,8,["modelValue"])}}},ga=["onChange","checked","disabled","id","value"],ya=["for"],ha={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>H(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const h=e.inject("editable",!0),E=e.useModel(y,"modelValue"),p=m=>{E.value=m};return(m,i)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,n=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:n},[e.createElementVNode("input",{onChange:o=>p(n[y.valueName]),checked:n[y.valueName]===E.value,class:"form-check-input",disabled:!e.unref(h),id:`${y.id}-${n[y.valueName]}`,type:"radio",value:n[y.valueName]},null,40,ga),e.createElementVNode("label",{class:"form-check-label",for:`${y.id}-${n[y.valueName]}`},e.toDisplayString(n[y.textName]),9,ya)]))),128))}},$a=["disabled"],Ba=["value"],xa=["value"],Ca={key:0,class:"invalid mt-0"},_a=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const h=e.inject("editable",!0),E=e.useModel(y,"modelValue");return(p,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:y.disabled||!e.unref(h)},p.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=i=>E.value=i)}),[e.unref(h)&&!E.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:y.emptyValue},e.toDisplayString(y.placeholder),9,Ba)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,(i,n)=>e.renderSlot(p.$slots,"default",{key:i,index:n,option:i},()=>[e.createElementVNode("option",{value:i[y.valueName]},e.toDisplayString(i[y.textName]),9,xa)])),128))],16,$a),[[e.vModelSelect,E.value]]),y.error?(e.openBlock(),e.createElementBlock("div",Ca,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Ta={class:"input-group"},Sa={key:0,class:"input-group-text"},wa=["disabled","placeholder","type"],Da={key:0,class:"invalid mt-0"},Ua=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const h=e.inject("editable",!0),E=e.useModel(y,"modelValue");return(p,m)=>{const i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ta,[y.prefix?(e.openBlock(),e.createElementBlock("span",Sa,[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(h),placeholder:e.unref(h)?y.placeholder:"",type:y.type},p.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=n=>E.value=n)}),null,16,wa),[[e.vModelDynamic,E.value]])]),y.error?(e.openBlock(),e.createElementBlock("div",Da,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),Aa=["disabled","placeholder"],Ma={key:0,class:"fs-14 text-gray mt-2"},Fa={class:"text-pink"},Ia={key:1,class:"invalid mt-0"},Oa=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const h=e.inject("editable",!0),E=e.useModel(y,"modelValue"),p=y;return p.maxLength&&e.watch(E,()=>{var m;((m=E.value)==null?void 0:m.length)>p.maxLength&&(E.value=E.value.substring(0,p.maxLength))}),(m,i)=>{var n;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(h),placeholder:e.unref(h)?y.placeholder:""},m.$attrs,{"onUpdate:modelValue":i[0]||(i[0]=o=>E.value=o)}),null,16,Aa),[[e.vModelText,E.value]]),e.unref(h)&&y.maxLength?(e.openBlock(),e.createElementBlock("div",Ma,[i[1]||(i[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Fa,e.toDisplayString(((n=E.value)==null?void 0:n.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(y.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),y.error?(e.openBlock(),e.createElementBlock("div",Ia,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),ja=["disabled"],Pa={key:0,class:"invalid"},qa=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(y,{emit:h}){let E;const p=y,m=e.ref(),i=e.inject("editable",!0),n=e.ref(),o=h,r=a=>{!a&&p.modelValue&&(a=moment(new Date(p.modelValue))),a?(m.value=a.format(p.displayFormat),o("update:modelValue",a.format(p.format))):(m.value="",o("update:modelValue","")),E.setStartDate(m.value||void 0)};return e.onMounted(()=>{const a=$(n.value);a.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:p.drops,locale:{format:p.displayFormat},maxDate:p.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(s,N)=>r(N.startDate)),E=a.data("daterangepicker"),r()}),e.onUnmounted(()=>E.remove()),e.watch(()=>p.modelValue,()=>r()),(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(i),ref_key:"element",ref:n,type:"text"},a.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=N=>e.isRef(m)?m.value=N:null)}),null,16,ja),[[e.vModelText,e.unref(m)]]),y.error?(e.openBlock(),e.createElementBlock("div",Pa,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),La={class:"block"},Ra={class:"mt-4"},Ja={class:"table align-middle gray-table side-table"},za={key:0},Qa={key:1,class:"text-light-gray"},Wa={class:"mt-4"},Ga={class:"table align-middle gray-table side-table"},Ya={class:"row g-3"},Ha={class:"col-12 col-xl-2"},Za={class:"text-gray mb-2"},Ka={class:"col-12 col-xl-3"},Xa={class:"text-gray mb-2"},va={class:"col-12 col-xl-4"},ed={class:"row g-1"},td={class:"col-7"},ld={class:"col-5"},od={class:"col-12 col-xl-3"},nd={class:"text-gray mb-2"},rd={class:"col-12"},ad={class:"text-gray mb-2"},dd={class:"mt-4"},sd={class:"table align-middle gray-table side-table"},cd={class:"mt-4"},md={class:"table align-middle gray-table side-table"},id={key:0,class:"table-responsive mt-3 mb-0"},Vd={class:"table align-middle gray-table"},pd={key:0},fd={key:0},Nd={class:"d-flex gap-2"},ud=["onClick"],Ed={key:0,class:"block-bottom bg-light-teal"},bd={__name:"Application",props:{id:{type:Number}},setup(y){const h=y,E=e.ref(),p=e.computed(()=>O("literacy",o.value.Status,1)),m=e.ref({}),i=e.ref([]),n=e.computed(()=>r.value.filter(x=>!x.Deleted)),o=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!n.value.length,set:x=>{x?s():r.value.forEach(l=>l.Deleted=!0)}}),s=()=>r.value.push({}),N=x=>x.Deleted=!0,d=x=>{if(m.value={},x&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const l={Project:o.value,Contacts:E.value,PreviousStudies:r.value.filter(t=>t.ID||!t.Deleted),Submit:x?"true":"false"};S.literacy("saveApplication",l).subscribe(t=>{x?window.location.href=`WorkSchedule.aspx?ID=${t.ID}`:o.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let x={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return m.value=w(o.value,x),x={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((l,t)=>Object.assign(m.value,w(l,x,`contact-${t}-`))),x={Title:"研習/課程名稱",TheDate:"辦理日期"},r.value.forEach((l,t)=>Object.assign(m.value,w(l,x,`study-${t}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(x=>{i.value=x[0],h.id?S.literacy("getApplication",{ID:h.id}).subscribe(l=>{o.value=l.Project,E.value=l.Contacts,r.value=l.PreviousStudies,F().literacy={step:o.value.FormStep,status:o.value.Status}}):S.literacy("getEmptyApplication").subscribe(l=>{o.value=Object.assign({Field:null,FormStep:1,Status:1},l),E.value=[{Role:"申請人"}],F().literacy={step:o.value.FormStep,status:o.value.Status}})})}),e.provide("editable",p),e.watch(()=>o.value.OrgName,()=>o.value.ProjectName=`素養-${o.value.OrgName}`),(x,l)=>{const t=e.resolveComponent("required-label"),c=e.resolveComponent("input-text"),f=e.resolveComponent("input-select"),k=e.resolveComponent("input-textarea"),T=e.resolveComponent("input-boolean"),B=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",La,[l[35]||(l[35]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Ra,[e.createElementVNode("table",Ja,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[12]||(l[12]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).Year),1)]),e.createElementVNode("tr",null,[l[13]||(l[13]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(o).ProjectID?(e.openBlock(),e.createElementBlock("span",za,e.toDisplayString(e.unref(o).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Qa,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[l[14]||(l[14]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[15]||(l[15]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{disabled:"",modelValue:e.unref(o).ProjectName,"onUpdate:modelValue":l[0]||(l[0]=g=>e.unref(o).ProjectName=g),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[16]||(l[16]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{"empty-value":null,error:e.unref(m).Field,options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o).Field,"onUpdate:modelValue":l[1]||(l[1]=g=>e.unref(o).Field=g)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[17]||(l[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(m).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(o).OrgName,"onUpdate:modelValue":l[2]||(l[2]=g=>e.unref(o).OrgName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[18]||(l[18]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(m).OrgLeader,modelValue:e.unref(o).OrgLeader,"onUpdate:modelValue":l[3]||(l[3]=g=>e.unref(o).OrgLeader=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[19]||(l[19]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(m).Address,placeholder:"請輸入地址",modelValue:e.unref(o).Address,"onUpdate:modelValue":l[4]||(l[4]=g=>e.unref(o).Address=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),l[36]||(l[36]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Wa,[e.createElementVNode("table",Ga,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(g,V)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ya,[e.createElementVNode("div",Ha,[e.createElementVNode("div",Za,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[20]||(l[20]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(m)[`contact-${V}-Name`],modelValue:g.Name,"onUpdate:modelValue":b=>g.Name=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ka,[e.createElementVNode("div",Xa,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[21]||(l[21]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(m)[`contact-${V}-JobTitle`],modelValue:g.JobTitle,"onUpdate:modelValue":b=>g.JobTitle=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",va,[l[22]||(l[22]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",ed,[e.createElementVNode("div",td,[e.createVNode(c,{modelValue:g.Phone,"onUpdate:modelValue":b=>g.Phone=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ld,[e.createVNode(c,{placeholder:"請輸入分機",size:"4",modelValue:g.PhoneExt,"onUpdate:modelValue":b=>g.PhoneExt=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",od,[e.createElementVNode("div",nd,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[23]||(l[23]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(m)[`contact-${V}-MobilePhone`],modelValue:g.MobilePhone,"onUpdate:modelValue":b=>g.MobilePhone=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rd,[e.createElementVNode("div",ad,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[24]||(l[24]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(c,{error:e.unref(m)[`contact-${V}-EMail`],modelValue:g.EMail,"onUpdate:modelValue":b=>g.EMail=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),l[37]||(l[37]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",dd,[e.createElementVNode("table",sd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[25]||(l[25]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[l[26]||(l[26]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(k,{error:e.unref(m).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(o).Target,"onUpdate:modelValue":l[5]||(l[5]=g=>e.unref(o).Target=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[27]||(l[27]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(o).Summary,"onUpdate:modelValue":l[6]||(l[6]=g=>e.unref(o).Summary=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[28]||(l[28]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Quantified,"onUpdate:modelValue":l[7]||(l[7]=g=>e.unref(o).Quantified=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[29]||(l[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Qualitative,"onUpdate:modelValue":l[8]||(l[8]=g=>e.unref(o).Qualitative=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",cd,[e.createElementVNode("table",md,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[34]||(l[34]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(T,{modelValue:e.unref(a),"onUpdate:modelValue":l[9]||(l[9]=g=>e.isRef(a)?a.value=g:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",id,[e.createElementVNode("table",Vd,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[l[30]||(l[30]=e.createElementVNode("th",null,"研習/課程名稱",-1)),l[31]||(l[31]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(p)?(e.openBlock(),e.createElementBlock("th",pd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(g,V)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(m)[`study-${V}-Title`],modelValue:g.Title,"onUpdate:modelValue":b=>g.Title=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`study-${V}-TheDate`],modelValue:g.TheDate,"onUpdate:modelValue":b=>g.TheDate=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",fd,[e.createElementVNode("div",Nd,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:b=>N(g),type:"button"},[...l[32]||(l[32]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ud)):e.createCommentVNode("",!0),V+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...l[33]||(l[33]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Ed,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:l[10]||(l[10]=g=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:l[11]||(l[11]=g=>d(!0)),type:"button"},[...l[38]||(l[38]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},kd={class:"block"},gd={key:0,class:"text-pink lh-base mt-4"},yd={class:"mt-4"},hd={class:"table align-middle gray-table"},$d={class:"text-center"},Bd={key:0,width:"180"},xd={class:"text-center"},Cd={key:0},_d=["innerHTML"],Td={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Sd={key:0,class:"text-center"},wd={key:0},Dd={key:1,class:"text-pink"},Ud={key:1,class:"tag-group mt-2 gap-1"},Ad={key:0,class:"tag tag-green-light"},Md=["download","href"],Fd=["onClick"],Id={key:0,class:"block-bottom bg-light-teal"},Od=["disabled"],jd={__name:"Attachment",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"著作權授權同意書",Template:!0,Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),p=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),m=e.computed(()=>O("literacy",i.value.Status,2)),i=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:i.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=S.download,r=a=>{const s={ID:h.id,Attachments:E.value.reduce((N,d)=>N.concat(d.Files),[]),Submit:a?"true":"false"};S.literacy("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getAttachment",{ID:h.id})]).subscribe(a=>{const s=a[0];i.value=s.Project,E.value=E.value.filter(N=>{var d;return!((d=N.Excludes)!=null&&d.includes(i.value.OrgCategory))}),E.value.forEach(N=>{N.Files=s.Attachments.filter(d=>d.Type===N.Type),N.Uploaded=e.computed(()=>N.Files.filter(d=>!d.Deleted).length)}),F().literacy={step:i.value.FormStep,status:i.value.Status}})}),e.provide("editable",m),(a,s)=>{const N=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",kd,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",gd,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",yd,[e.createElementVNode("table",hd,[e.createElementVNode("thead",$d,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",Bd,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,x)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",xd,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Cd,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(N,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(m)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,_d)):e.createCommentVNode("",!0),e.unref(m)&&u.Template?(e.openBlock(),e.createElementBlock("button",Td,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Sd,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",wd,"已上傳")):(e.openBlock(),e.createElementBlock("span",Dd,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(m)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Ud,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ad,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,Md),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Fd)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Id,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(p),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Od)])):e.createCommentVNode("",!0)],64)}}},Pd={class:"block"},qd={class:"mt-4"},Ld={class:"table-responsive mt-3 mb-0"},Rd={class:"table align-middle gray-table"},Jd={key:0,width:"1"},zd={key:0},Qd={class:"d-flex gap-2"},Wd=["onClick"],Gd={class:"table-responsive mt-3 mb-0"},Yd={class:"table align-middle gray-table"},Hd={key:0,class:"block-bottom bg-light-teal"},Zd={__name:"Benefit",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.computed(()=>O("literacy",n.value.Status,4)),m=e.ref({}),i=e.computed(()=>E.value.filter(N=>!N.Deleted)),n=e.ref({}),o=()=>E.value.push({}),r=N=>N.Deleted=!0,a=N=>{if(m.value={},N&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Project:n.value,Benefits:E.value,Submit:N?"true":"false"};S.literacy("saveBenefit",d).subscribe(()=>{N?window.location.href=`Attachment.aspx?ID=${h.id}`:window.location.reload()})},s=()=>{let N={Benefit:"不可量化成果"};return m.value=w(n.value,N),N={Title:"指標",Target:"目標值",Description:"說明"},i.value.forEach((d,u)=>Object.assign(m.value,w(d,N,`item-${u}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getBenefit",{ID:h.id})]).subscribe(N=>{const d=N[0];n.value=d.Project,E.value=d.Benefits,E.value.length||o(),F().literacy={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",p),(N,d)=>{const u=e.resolveComponent("input-text"),x=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pd,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",qd,[e.createElementVNode("div",Ld,[e.createElementVNode("table",Rd,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[d[3]||(d[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),d[4]||(d[4]=e.createElementVNode("th",null,"目標值",-1)),d[5]||(d[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(p)?(e.openBlock(),e.createElementBlock("th",Jd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(l,t)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(m)[`item-${t}-Title`],modelValue:l.Title,"onUpdate:modelValue":c=>l.Title=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(m)[`item-${t}-Target`],modelValue:l.Target,"onUpdate:modelValue":c=>l.Target=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m)[`item-${t}-Description`],rows:"1",modelValue:l.Description,"onUpdate:modelValue":c=>l.Description=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",zd,[e.createElementVNode("div",Qd,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:c=>r(l),type:"button"},[...d[6]||(d[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Wd)):e.createCommentVNode("",!0),t+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...d[7]||(d[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Gd,[e.createElementVNode("table",Yd,[d[8]||(d[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":d[0]||(d[0]=l=>e.unref(n).Benefit=l),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Hd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=l=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=l=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Kd={class:"block"},Xd={class:"mt-4"},vd={class:"table-responsive mt-3 mb-0"},es={class:"table align-middle gray-table"},ts={class:"text-end"},ls={class:"text-end"},os={class:"table-responsive"},ns={class:"table align-middle gray-table"},rs=["colspan"],as={key:0,width:"1"},ds={class:"text-end"},ss={key:0},cs={class:"d-flex gap-2"},ms=["onClick"],is={class:"mt-4"},Vs={class:"table-responsive mt-3 mb-0"},ps={class:"table align-middle gray-table"},fs={key:0,width:"1"},Ns={class:"text-end"},us={key:0},Es={class:"d-flex gap-2"},bs=["onClick"],ks={key:0,class:"block-bottom bg-light-teal"},gs={__name:"Funding",props:{id:{type:Number}},setup(y){const h=y,E=e.computed(()=>O("literacy",n.value.Status,3)),p=e.ref({}),m=e.computed(()=>o.value.filter(l=>!l.Deleted)),i=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref(0),s=()=>o.value.push({}),N=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(p.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,OtherSubsidies:o.value,BudgetPlans:r.value,Submit:l?"true":"false"};S.literacy("saveFunding",t).subscribe(()=>{l?window.location.href=`Benefit.aspx?ID=${h.id}`:window.location.reload()})},x=()=>{let l={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return p.value=w(n.value,l),l={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},o.value.forEach((t,c)=>Object.assign(p.value,w(t,l,`other-${c}-`))),l={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,c)=>Object.assign(p.value,w(t,l,`plan-${c}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getFunding",{ID:h.id})]).subscribe(l=>{const t=l[0];n.value=t.Project,o.value=t.OtherSubsidies,r.value=t.BudgetPlans,o.value.length||s(),r.value.length||N(),F().literacy={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=m.value.reduce((l,t)=>l+I(t.Amount),0),a.value=I(n.value.ApplyAmount)+I(n.value.SelfAmount)+I(n.value.OtherAmount),m.value.forEach(l=>l.percent=Math.round(I(l.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(l=>l.sum=I(l.Amount)+I(l.OtherAmount))}),(l,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),k=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kd,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Xd,[e.createElementVNode("div",vd,[e.createElementVNode("table",es,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(n).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(n).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",ts,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",ls,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",os,[e.createElementVNode("table",ns,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,rs)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",as,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(B,g)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,e.toDisplayString(g+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(p)[`other-${g}-Unit`],modelValue:B.Unit,"onUpdate:modelValue":V=>B.Unit=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`other-${g}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":V=>B.Amount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",ds,e.toDisplayString(B.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`other-${g}-Content`],rows:"1",modelValue:B.Content,"onUpdate:modelValue":V=>B.Content=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",ss,[e.createElementVNode("div",cs,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V=>d(B),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ms)):e.createCommentVNode("",!0),g+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",is,[e.createElementVNode("div",Vs,[e.createElementVNode("table",ps,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",fs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(B,g)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(p)[`plan-${g}-Title`],modelValue:B.Title,"onUpdate:modelValue":V=>B.Title=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`plan-${g}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":V=>B.Amount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`plan-${g}-OtherAmount`],modelValue:B.OtherAmount,"onUpdate:modelValue":V=>B.OtherAmount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Ns,e.toDisplayString(B.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`plan-${g}-Description`],rows:"1",modelValue:B.Description,"onUpdate:modelValue":V=>B.Description=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",us,[e.createElementVNode("div",Es,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V=>d(B),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bs)):e.createCommentVNode("",!0),g+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",ks,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=B=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=B=>u(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ys={__name:"ProgressBar",setup(y){const h=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,p)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:h,type:"literacy"})}}},hs={class:"block"},$s={class:"mt-4"},Bs={class:"table align-middle gray-table side-table"},xs={class:"d-flex align-items-center gap-2"},Cs={class:"input-group w-auto"},_s={key:0,class:"invalid mt-0"},Ts={class:"table-responsive mt-4"},Ss={class:"table align-middle gray-table"},ws={key:0},Ds={class:"input-group"},Us={key:0,class:"invalid mt-0"},As={key:0},Ms={class:"d-flex gap-2"},Fs=["onClick"],Is={class:"mt-4"},Os={class:"table align-middle gray-table"},js={key:0},Ps={key:0},qs={class:"d-flex gap-2"},Ls=["onClick"],Rs={key:0,class:"block-bottom bg-light-teal"},Js={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const h=y,E=[{value:1,text:"50%"},{value:2,text:"100%"}],p=e.computed(()=>O("literacy",o.value.Status,2)),m=e.ref({}),i=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.computed(()=>a.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref([]),s=()=>S.literacy("createItem",{ID:h.id}).subscribe(l=>r.value.push(l)),N=()=>a.value.push({Type:0,ItemID:0}),d=l=>l.Deleted=!0,u=l=>{if(m.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Items:r.value,Schedules:a.value,Submit:l?"true":"false"};S.literacy("saveWorkSchedule",t).subscribe(()=>{l?window.location.href=`Funding.aspx?ID=${h.id}`:window.location.reload()})},x=()=>{let l={StartTime:"計畫期程",EndTime:"計畫期程"};return m.value=w(o.value,l),l={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},i.value.forEach((t,c)=>Object.assign(m.value,w(t,l,`item-${c}-`))),l={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},n.value.forEach((t,c)=>Object.assign(m.value,w(t,l,`schedule-${c}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getWorkSchedule",{ID:h.id})]).subscribe(l=>{const t=l[0];o.value=t.Project,r.value=t.Items,a.value=t.Schedules,r.value.length||s(),a.value.length||N(),F().literacy={step:o.value.FormStep,status:o.value.Status}})}),e.provide("editable",p),(l,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),B=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hs,[t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",$s,[e.createElementVNode("table",Bs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",xs,[e.createElementVNode("div",Cs,[e.createVNode(f,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[0]||(t[0]=V=>e.unref(o).StartTime=V)},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[1]||(t[1]=V=>e.unref(o).EndTime=V)},null,8,["modelValue"])]),t[6]||(t[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(m).StartTime||e.unref(m).EndTime?(e.openBlock(),e.createElementBlock("div",_s,e.toDisplayString(e.unref(m).StartTime||e.unref(m).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("table",Ss,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[11]||(t[11]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[7]||(t[7]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(p)?(e.openBlock(),e.createElementBlock("th",ws,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+b)),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m)[`item-${b}-Title`],modelValue:V.Title,"onUpdate:modelValue":C=>V.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Ds,[e.createVNode(T,{"empty-value":0,modelValue:V.Begin,"onUpdate:modelValue":C=>V.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:V.End,"onUpdate:modelValue":C=>V.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(m)[`item-${b}-Begin`]||e.unref(m)[`item-${b}-End`]?(e.openBlock(),e.createElementBlock("div",Us,e.toDisplayString(e.unref(m)[`item-${b}-Begin`]||e.unref(m)[`item-${b}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(m)[`item-${b}-Deadline`],modelValue:V.Deadline,"onUpdate:modelValue":C=>V.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`item-${b}-Content`],rows:"1",modelValue:V.Content,"onUpdate:modelValue":C=>V.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",As,[e.createElementVNode("div",Ms,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Fs)):e.createCommentVNode("",!0),b+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Is,[e.createElementVNode("table",Os,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[14]||(t[14]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[18]||(t[18]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(p)?(e.openBlock(),e.createElementBlock("th",js,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(m)[`schedule-${b}-Type`],options:E,modelValue:V.Type,"onUpdate:modelValue":C=>V.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(m)[`schedule-${b}-ItemID`],options:e.unref(i),"text-name":"Title","value-name":"ID",modelValue:V.ItemID,"onUpdate:modelValue":C=>V.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(V.ItemID?String.fromCharCode(65+e.unref(i).findIndex(C=>C.ID===V.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(m)[`schedule-${b}-Deadline`],modelValue:V.Deadline,"onUpdate:modelValue":C=>V.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`schedule-${b}-Content`],rows:"1",modelValue:V.Content,"onUpdate:modelValue":C=>V.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",Ps,[e.createElementVNode("div",qs,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ls)):e.createCommentVNode("",!0),b+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Rs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=V=>u(!0)),type:"button"},[...t[24]||(t[24]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},zs={class:"block"},Qs={class:"mt-4"},Ws={class:"table align-middle gray-table side-table"},Gs={key:0},Ys={key:1,class:"text-light-gray"},Hs={class:"mt-4"},Zs={class:"table align-middle gray-table side-table"},Ks={class:"row g-3"},Xs={class:"col-12 col-xl-2"},vs={class:"text-gray mb-2"},ec={class:"col-12 col-xl-3"},tc={class:"text-gray mb-2"},lc={class:"col-12 col-xl-4"},oc={class:"row g-1"},nc={class:"col-7"},rc={class:"col-5"},ac={class:"col-12 col-xl-3"},dc={class:"text-gray mb-2"},sc={class:"col-12"},cc={class:"text-gray mb-2"},mc={class:"mt-4"},ic={class:"table align-middle gray-table side-table"},Vc={class:"mt-4"},pc={class:"table align-middle gray-table side-table"},fc={key:0,class:"table-responsive mt-3 mb-0"},Nc={class:"table align-middle gray-table"},uc={key:0},Ec={key:0},bc={class:"d-flex gap-2"},kc=["onClick"],gc={key:0,class:"block-bottom bg-light-teal"},yc={__name:"Application",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.ref(),m=e.computed(()=>O("multiple",r.value.Status,1)),i=e.ref({}),n=e.ref([]),o=e.computed(()=>a.value.filter(l=>!l.Deleted)),r=e.ref({}),a=e.ref([]),s=e.computed({get:()=>!!o.value.length,set:l=>{l?N():a.value.forEach(t=>t.Deleted=!0)}}),N=()=>a.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(i.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Contacts:p.value,ReceivedSubsidies:a.value.filter(c=>c.ID||!c.Deleted),Submit:l?"true":"false"};S.multiple("saveApplication",t).subscribe(c=>{l?window.location.href=`WorkSchedule.aspx?ID=${c.ID}`:r.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${c.ID}`})},x=()=>{let l={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return i.value=w(r.value,l),l={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},p.value.forEach((t,c)=>Object.assign(i.value,w(t,l,`contact-${c}-`))),l={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},a.value.forEach((t,c)=>Object.assign(i.value,w(t,l,`received-${c}-`))),!Object.keys(i.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getZgsCodes",{CodeGroup:"MULField"}),S.culture("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(l=>{n.value=l[0],E.value=l[1],h.id?S.multiple("getApplication",{ID:h.id}).subscribe(t=>{r.value=t.Project,p.value=t.Contacts,a.value=t.ReceivedSubsidies,r.value.OrgCategory=r.value.OrgCategory||null,F().multiple={step:r.value.FormStep,status:r.value.Status}}):S.multiple("getEmptyApplication").subscribe(t=>{r.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},t),p.value=[{Role:"負責人"},{Role:"聯絡人"}],F().multiple={step:r.value.FormStep,status:r.value.Status}})})}),e.provide("editable",m),(l,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),k=e.resolveComponent("input-select"),T=e.resolveComponent("input-textarea"),B=e.resolveComponent("input-boolean"),g=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zs,[t[38]||(t[38]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Qs,[e.createElementVNode("table",Ws,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).Year),1)]),e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(r).ProjectID?(e.openBlock(),e.createElementBlock("span",Gs,e.toDisplayString(e.unref(r).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Ys,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).ProjectName,modelValue:e.unref(r).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=V=>e.unref(r).ProjectName=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{"empty-value":null,error:e.unref(i).Field,options:e.unref(n),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).Field,"onUpdate:modelValue":t[1]||(t[1]=V=>e.unref(r).Field=V)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(r).OrgName,"onUpdate:modelValue":t[2]||(t[2]=V=>e.unref(r).OrgName=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{"empty-value":null,error:e.unref(i).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).OrgCategory,"onUpdate:modelValue":t[3]||(t[3]=V=>e.unref(r).OrgCategory=V)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).TaxID,modelValue:e.unref(r).TaxID,"onUpdate:modelValue":t[4]||(t[4]=V=>e.unref(r).TaxID=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i).Address,placeholder:"請輸入地址",modelValue:e.unref(r).Address,"onUpdate:modelValue":t[5]||(t[5]=V=>e.unref(r).Address=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[39]||(t[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Hs,[e.createElementVNode("table",Zs,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ks,[e.createElementVNode("div",Xs,[e.createElementVNode("div",vs,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${b}-Name`],modelValue:V.Name,"onUpdate:modelValue":C=>V.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ec,[e.createElementVNode("div",tc,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${b}-JobTitle`],modelValue:V.JobTitle,"onUpdate:modelValue":C=>V.JobTitle=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",lc,[t[24]||(t[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",oc,[e.createElementVNode("div",nc,[e.createVNode(f,{modelValue:V.Phone,"onUpdate:modelValue":C=>V.Phone=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rc,[e.createVNode(f,{placeholder:"請輸入分機",size:"4",modelValue:V.PhoneExt,"onUpdate:modelValue":C=>V.PhoneExt=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",ac,[e.createElementVNode("div",dc,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${b}-MobilePhone`],modelValue:V.MobilePhone,"onUpdate:modelValue":C=>V.MobilePhone=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",sc,[e.createElementVNode("div",cc,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(i)[`contact-${b}-EMail`],modelValue:V.EMail,"onUpdate:modelValue":C=>V.EMail=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),t[40]||(t[40]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",mc,[e.createElementVNode("table",ic,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[t[28]||(t[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(T,{error:e.unref(i).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(r).Target,"onUpdate:modelValue":t[6]||(t[6]=V=>e.unref(r).Target=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(i).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(r).Summary,"onUpdate:modelValue":t[7]||(t[7]=V=>e.unref(r).Summary=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(i).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Quantified,"onUpdate:modelValue":t[8]||(t[8]=V=>e.unref(r).Quantified=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(i).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Qualitative,"onUpdate:modelValue":t[9]||(t[9]=V=>e.unref(r).Qualitative=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Vc,[e.createElementVNode("table",pc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[37]||(t[37]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(B,{modelValue:e.unref(s),"onUpdate:modelValue":t[10]||(t[10]=V=>e.isRef(s)?s.value=V:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",fc,[e.createElementVNode("table",Nc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[32]||(t[32]=e.createElementVNode("th",null,"計畫名稱",-1)),t[33]||(t[33]=e.createElementVNode("th",null,"補助單位",-1)),t[34]||(t[34]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",uc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i)[`received-${b}-Name`],modelValue:V.Name,"onUpdate:modelValue":C=>V.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(i)[`received-${b}-Unit`],modelValue:V.Unit,"onUpdate:modelValue":C=>V.Unit=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(i)[`received-${b}-Amount`],modelValue:V.Amount,"onUpdate:modelValue":C=>V.Amount=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Ec,[e.createElementVNode("div",bc,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[35]||(t[35]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,kc)):e.createCommentVNode("",!0),b+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[36]||(t[36]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",gc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[11]||(t[11]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[12]||(t[12]=V=>u(!0)),type:"button"},[...t[41]||(t[41]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},hc={class:"block"},$c={key:0,class:"text-pink lh-base mt-4"},Bc={class:"mt-4"},xc={class:"table align-middle gray-table"},Cc={class:"text-center"},_c={key:0,width:"180"},Tc={class:"text-center"},Sc={key:0},wc=["innerHTML"],Dc={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Uc={key:0,class:"text-center"},Ac={key:0},Mc={key:1,class:"text-pink"},Fc={key:1,class:"tag-group mt-2 gap-1"},Ic={key:0,class:"tag tag-green-light"},Oc=["download","href"],jc=["onClick"],Pc={key:0,class:"block-bottom bg-light-teal"},qc=["disabled"],Lc={__name:"Attachment",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),p=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),m=e.computed(()=>O("multiple",i.value.Status,2)),i=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:i.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=S.download,r=a=>{const s={ID:h.id,Attachments:E.value.reduce((N,d)=>N.concat(d.Files),[]),Submit:a?"true":"false"};S.multiple("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getAttachment",{ID:h.id})]).subscribe(a=>{const s=a[0];i.value=s.Project,E.value=E.value.filter(N=>{var d;return!((d=N.Excludes)!=null&&d.includes(i.value.OrgCategory))}),E.value.forEach(N=>{N.Files=s.Attachments.filter(d=>d.Type===N.Type),N.Uploaded=e.computed(()=>N.Files.filter(d=>!d.Deleted).length)}),F().multiple={step:i.value.FormStep,status:i.value.Status}})}),e.provide("editable",m),(a,s)=>{const N=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hc,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("p",$c,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Bc,[e.createElementVNode("table",xc,[e.createElementVNode("thead",Cc,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(m)?(e.openBlock(),e.createElementBlock("th",_c,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,x)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Tc,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Sc,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(N,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(m)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,wc)):e.createCommentVNode("",!0),e.unref(m)&&u.Template?(e.openBlock(),e.createElementBlock("button",Dc,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("td",Uc,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",Ac,"已上傳")):(e.openBlock(),e.createElementBlock("span",Mc,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(m)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Fc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ic,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,Oc),e.unref(m)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,jc)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Pc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(p),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,qc)])):e.createCommentVNode("",!0)],64)}}},Rc={class:"block"},Jc={class:"mt-4"},zc={class:"table-responsive mt-3 mb-0"},Qc={class:"table align-middle gray-table"},Wc={key:0,width:"1"},Gc={key:0},Yc={class:"d-flex gap-2"},Hc=["onClick"],Zc={class:"table-responsive mt-3 mb-0"},Kc={class:"table align-middle gray-table"},Xc={key:0,class:"block-bottom bg-light-teal"},vc={__name:"Benefit",props:{id:{type:Number}},setup(y){const h=y,E=e.ref([]),p=e.computed(()=>O("multiple",n.value.Status,4)),m=e.ref({}),i=e.computed(()=>E.value.filter(N=>!N.Deleted)),n=e.ref({}),o=()=>E.value.push({}),r=N=>N.Deleted=!0,a=N=>{if(m.value={},N&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Project:n.value,Benefits:E.value,Submit:N?"true":"false"};S.multiple("saveBenefit",d).subscribe(()=>{N?window.location.href=`Attachment.aspx?ID=${h.id}`:window.location.reload()})},s=()=>{let N={Benefit:"不可量化成果"};return m.value=w(n.value,N),N={Title:"指標",Target:"目標值",Description:"說明"},i.value.forEach((d,u)=>Object.assign(m.value,w(d,N,`item-${u}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getBenefit",{ID:h.id})]).subscribe(N=>{const d=N[0];n.value=d.Project,E.value=d.Benefits,E.value.length||o(),F().multiple={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",p),(N,d)=>{const u=e.resolveComponent("input-text"),x=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Rc,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Jc,[e.createElementVNode("div",zc,[e.createElementVNode("table",Qc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[d[3]||(d[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),d[4]||(d[4]=e.createElementVNode("th",null,"目標值",-1)),d[5]||(d[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(p)?(e.openBlock(),e.createElementBlock("th",Wc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(l,t)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(m)[`item-${t}-Title`],modelValue:l.Title,"onUpdate:modelValue":c=>l.Title=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(m)[`item-${t}-Target`],modelValue:l.Target,"onUpdate:modelValue":c=>l.Target=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m)[`item-${t}-Description`],rows:"1",modelValue:l.Description,"onUpdate:modelValue":c=>l.Description=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",Gc,[e.createElementVNode("div",Yc,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:c=>r(l),type:"button"},[...d[6]||(d[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Hc)):e.createCommentVNode("",!0),t+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...d[7]||(d[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Zc,[e.createElementVNode("table",Kc,[d[8]||(d[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":d[0]||(d[0]=l=>e.unref(n).Benefit=l),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Xc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=l=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=l=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},em={class:"block"},tm={class:"mt-4"},lm={class:"table-responsive mt-3 mb-0"},om={class:"table align-middle gray-table"},nm={class:"text-end"},rm={class:"text-end"},am={class:"table-responsive"},dm={class:"table align-middle gray-table"},sm=["colspan"],cm={key:0,width:"1"},mm={class:"text-end"},im={key:0},Vm={class:"d-flex gap-2"},pm=["onClick"],fm={class:"mt-4"},Nm={class:"table-responsive mt-3 mb-0"},um={class:"table align-middle gray-table"},Em={key:0,width:"1"},bm={class:"text-end"},km={key:0},gm={class:"d-flex gap-2"},ym=["onClick"],hm={key:0,class:"block-bottom bg-light-teal"},$m={__name:"Funding",props:{id:{type:Number}},setup(y){const h=y,E=e.computed(()=>O("multiple",n.value.Status,3)),p=e.ref({}),m=e.computed(()=>o.value.filter(l=>!l.Deleted)),i=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref(0),s=()=>o.value.push({}),N=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(p.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,OtherSubsidies:o.value,BudgetPlans:r.value,Submit:l?"true":"false"};S.multiple("saveFunding",t).subscribe(()=>{l?window.location.href=`Benefit.aspx?ID=${h.id}`:window.location.reload()})},x=()=>{let l={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return p.value=w(n.value,l),l={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},o.value.forEach((t,c)=>Object.assign(p.value,w(t,l,`other-${c}-`))),l={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,c)=>Object.assign(p.value,w(t,l,`plan-${c}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getFunding",{ID:h.id})]).subscribe(l=>{const t=l[0];n.value=t.Project,o.value=t.OtherSubsidies,r.value=t.BudgetPlans,o.value.length||s(),r.value.length||N(),F().multiple={step:n.value.FormStep,status:n.value.Status}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=m.value.reduce((l,t)=>l+I(t.Amount),0),a.value=I(n.value.ApplyAmount)+I(n.value.SelfAmount)+I(n.value.OtherAmount),m.value.forEach(l=>l.percent=Math.round(I(l.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(l=>l.sum=I(l.Amount)+I(l.OtherAmount))}),(l,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),k=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",em,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",tm,[e.createElementVNode("div",lm,[e.createElementVNode("table",om,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(n).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(n).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",nm,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",rm,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",am,[e.createElementVNode("table",dm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,sm)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",cm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(B,g)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,e.toDisplayString(g+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(p)[`other-${g}-Unit`],modelValue:B.Unit,"onUpdate:modelValue":V=>B.Unit=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`other-${g}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":V=>B.Amount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",mm,e.toDisplayString(B.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`other-${g}-Content`],rows:"1",modelValue:B.Content,"onUpdate:modelValue":V=>B.Content=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",im,[e.createElementVNode("div",Vm,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V=>d(B),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pm)):e.createCommentVNode("",!0),g+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",fm,[e.createElementVNode("div",Nm,[e.createElementVNode("table",um,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Em,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(B,g)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(p)[`plan-${g}-Title`],modelValue:B.Title,"onUpdate:modelValue":V=>B.Title=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`plan-${g}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":V=>B.Amount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(p)[`plan-${g}-OtherAmount`],modelValue:B.OtherAmount,"onUpdate:modelValue":V=>B.OtherAmount=V},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",bm,e.toDisplayString(B.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`plan-${g}-Description`],rows:"1",modelValue:B.Description,"onUpdate:modelValue":V=>B.Description=V,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",km,[e.createElementVNode("div",gm,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:V=>d(B),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ym)):e.createCommentVNode("",!0),g+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",hm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=B=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=B=>u(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Bm={__name:"ProgressBar",setup(y){const h=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,p)=>{const m=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(m,{steps:h,type:"multiple"})}}},xm={class:"block"},Cm={class:"mt-4"},_m={class:"table align-middle gray-table side-table"},Tm={class:"d-flex align-items-center gap-2"},Sm={class:"input-group w-auto"},wm={key:0,class:"invalid mt-0"},Dm={class:"table-responsive mt-4"},Um={class:"table align-middle gray-table"},Am={key:0},Mm={class:"input-group"},Fm={key:0,class:"invalid mt-0"},Im={key:0},Om={class:"d-flex gap-2"},jm=["onClick"],Pm={class:"mt-4"},qm={class:"table align-middle gray-table"},Lm={key:0},Rm={key:0},Jm={class:"d-flex gap-2"},zm=["onClick"],Qm={key:0,class:"block-bottom bg-light-teal"},Wm={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const h=y,E=[{value:1,text:"50%"},{value:2,text:"100%"}],p=e.computed(()=>O("multiple",o.value.Status,2)),m=e.ref({}),i=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.computed(()=>a.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref([]),s=()=>S.multiple("createItem",{ID:h.id}).subscribe(l=>r.value.push(l)),N=()=>a.value.push({Type:0,ItemID:0}),d=l=>l.Deleted=!0,u=l=>{if(m.value={},l&&!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Items:r.value,Schedules:a.value,Submit:l?"true":"false"};S.multiple("saveWorkSchedule",t).subscribe(()=>{l?window.location.href=`Funding.aspx?ID=${h.id}`:window.location.reload()})},x=()=>{let l={StartTime:"計畫期程",EndTime:"計畫期程"};return m.value=w(o.value,l),l={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},i.value.forEach((t,c)=>Object.assign(m.value,w(t,l,`item-${c}-`))),l={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},n.value.forEach((t,c)=>Object.assign(m.value,w(t,l,`schedule-${c}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getWorkSchedule",{ID:h.id})]).subscribe(l=>{const t=l[0];o.value=t.Project,r.value=t.Items,a.value=t.Schedules,r.value.length||s(),a.value.length||N(),F().multiple={step:o.value.FormStep,status:o.value.Status}})}),e.provide("editable",p),(l,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),B=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xm,[t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Cm,[e.createElementVNode("table",_m,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Tm,[e.createElementVNode("div",Sm,[e.createVNode(f,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[0]||(t[0]=V=>e.unref(o).StartTime=V)},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[1]||(t[1]=V=>e.unref(o).EndTime=V)},null,8,["modelValue"])]),t[6]||(t[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(m).StartTime||e.unref(m).EndTime?(e.openBlock(),e.createElementBlock("div",wm,e.toDisplayString(e.unref(m).StartTime||e.unref(m).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Dm,[e.createElementVNode("table",Um,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[11]||(t[11]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[7]||(t[7]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(p)?(e.openBlock(),e.createElementBlock("th",Am,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+b)),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m)[`item-${b}-Title`],modelValue:V.Title,"onUpdate:modelValue":C=>V.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Mm,[e.createVNode(T,{"empty-value":0,modelValue:V.Begin,"onUpdate:modelValue":C=>V.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:V.End,"onUpdate:modelValue":C=>V.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(m)[`item-${b}-Begin`]||e.unref(m)[`item-${b}-End`]?(e.openBlock(),e.createElementBlock("div",Fm,e.toDisplayString(e.unref(m)[`item-${b}-Begin`]||e.unref(m)[`item-${b}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(m)[`item-${b}-Deadline`],modelValue:V.Deadline,"onUpdate:modelValue":C=>V.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`item-${b}-Content`],rows:"1",modelValue:V.Content,"onUpdate:modelValue":C=>V.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",Im,[e.createElementVNode("div",Om,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jm)):e.createCommentVNode("",!0),b+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Pm,[e.createElementVNode("table",qm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[14]||(t[14]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[18]||(t[18]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(p)?(e.openBlock(),e.createElementBlock("th",Lm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(V,b)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(m)[`schedule-${b}-Type`],options:E,modelValue:V.Type,"onUpdate:modelValue":C=>V.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(m)[`schedule-${b}-ItemID`],options:e.unref(i),"text-name":"Title","value-name":"ID",modelValue:V.ItemID,"onUpdate:modelValue":C=>V.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(V.ItemID?String.fromCharCode(65+e.unref(i).findIndex(C=>C.ID===V.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(m)[`schedule-${b}-Deadline`],modelValue:V.Deadline,"onUpdate:modelValue":C=>V.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(B,{error:e.unref(m)[`schedule-${b}-Content`],rows:"1",modelValue:V.Content,"onUpdate:modelValue":C=>V.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(p)?(e.openBlock(),e.createElementBlock("td",Rm,[e.createElementVNode("div",Jm,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(V),type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,zm)):e.createCommentVNode("",!0),b+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:N,type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Qm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=V=>u(!0)),type:"button"},[...t[24]||(t[24]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Gm={key:0,class:"text-pink"},G={AccessibilityApplication:Re,AccessibilityAttachment:st,AccessibilityBenefit:gt,AccessibilityFunding:zt,AccessibilityProgressBar:Qt,AccessibilityWorkSchedule:pl,CommonProgressBar:gl,CultureApplication:lo,CultureAttachment:$o,CultureFunding:Wo,CultureOther:an,CultureProgressBar:dn,CultureWorkSchedule:Xn,EducationApplication:qr,EducationAttachment:aa,EducationProgressBar:da,ErrorModal:pa,InputBoolean:fa,InputFile:Na,InputInteger:ba,InputMonth:ka,InputRadioGroup:ha,InputSelect:_a,InputText:Ua,InputTextarea:Oa,InputTwDate:qa,LiteracyApplication:bd,LiteracyAttachment:jd,LiteracyBenefit:Zd,LiteracyFunding:gs,LiteracyProgressBar:ys,LiteracyWorkSchedule:Js,MultipleApplication:yc,MultipleAttachment:Lc,MultipleBenefit:vc,MultipleFunding:$m,MultipleProgressBar:Bm,MultipleWorkSchedule:Wm,RequiredLabel:{__name:"RequiredLabel",setup(y){const h=e.inject("editable",!0);return(E,p)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(h)?(e.openBlock(),e.createElementBlock("span",Gm,"* ")):e.createCommentVNode("",!0),e.renderSlot(E.$slots,"default")],64))}}};return{install:y=>{for(const h in G)y.component(h,G[h])}}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
