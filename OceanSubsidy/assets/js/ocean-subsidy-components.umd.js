(function(e,R){typeof exports=="object"&&typeof module<"u"?module.exports=R(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],R):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=R(e.Vue,e.Pinia))})(this,(function(e,R){"use strict";let K=Date.now();const P=(y,k,b)=>{if(k===1||k===3)return!0;if(k===10)switch(y){case"culture":if([2,3,5].includes(b))return!0;break;case"multiple":if([2,3,4,5].includes(b))return!0;break;case"accessibility":if([2,3,4,5].includes(b))return!0;break}return!1},X=()=>`id--${K++}`,I=y=>parseInt(y)||0,Q=R.defineStore("message",{state:()=>({error:null})}),{ajax:v}=rxjs.ajax,{map:ee}=rxjs;let W="";const te=(y,k={})=>L("Service/OFS/Accessibility.ashx",{method:y,param:k}),le=(y,k={})=>L("Service/OFS/Culture.ashx",{method:y,param:k}),oe=y=>`${W}/Service/OFS/Download.ashx?path=${y}`,ne=(y,k={})=>L("Service/OFS/Education.ashx",{method:y,param:k}),re=(y,k={})=>L("Service/OFS/Literacy.ashx",{method:y,param:k}),ae=(y,k={})=>L("Service/OFS/Multiple.ashx",{method:y,param:k}),de=({response:y,status:k})=>{if(k===200){if(y.success)return y.data;Q().error=y.message}},L=(y,k={})=>{const b={};k.constructor!==FormData&&(b["Content-Type"]="application/json");const u={body:k,headers:b,method:"POST",url:`${W}/${y}`};return v(u).pipe(ee(de))},D=Object.assign(L,{accessibility:te,culture:le,download:oe,education:ne,literacy:re,multiple:ae,upload:y=>{const k=new FormData;return k.append("file",y),L("Service/OFS/Upload.ashx",k)}});function se(y){return y&&y.__esModule&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y}var J={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var ie=J.exports,Y;function ce(){return Y||(Y=1,(function(y,k){(function(b,u,V){var d=function(l,n,a){a=o.extend({},o.options,a);var s=o.runValidations(l,n,a);if(s.some(function(p){return o.isPromise(p.error)}))throw new Error("Use validate.async if you want support for promises");return d.processValidationResults(s,a)},o=d;o.extend=function(l){return[].slice.call(arguments,1).forEach(function(n){for(var a in n)l[a]=n[a]}),l},o.extend(d,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var l=o.format("%{major}.%{minor}.%{patch}",o.version);return o.isEmpty(o.version.metadata)||(l+="+"+o.version.metadata),l}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(l,n,a){var s=[],p,i,E,h,r,N,m;(o.isDomElement(l)||o.isJqueryElement(l))&&(l=o.collectFormValues(l));for(p in n){E=o.getDeepObjectValue(l,p),h=o.result(n[p],E,l,p,a,n);for(i in h){if(r=o.validators[i],!r)throw m=o.format("Unknown validator %{name}",{name:i}),new Error(m);N=h[i],N=o.result(N,E,l,p,a,n),N&&s.push({attribute:p,value:E,validator:i,globalOptions:a,attributes:l,options:N,error:r.call(r,E,N,p,l,a)})}}return s},processValidationResults:function(l,n){l=o.pruneEmptyErrors(l,n),l=o.expandMultipleErrors(l,n),l=o.convertErrorMessages(l,n);var a=n.format||"grouped";if(typeof o.formatters[a]=="function")l=o.formatters[a](l);else throw new Error(o.format("Unknown format %{format}",n));return o.isEmpty(l)?void 0:l},async:function(l,n,a){a=o.extend({},o.async.options,a);var s=a.wrapErrors||function(i){return i};a.cleanAttributes!==!1&&(l=o.cleanAttributes(l,n));var p=o.runValidations(l,n,a);return new o.Promise(function(i,E){o.waitForResults(p).then(function(){var h=o.processValidationResults(p,a);h?E(new s(h,a,l,n)):i(l)},function(h){E(h)})})},single:function(l,n,a){return a=o.extend({},o.single.options,a,{format:"flat",fullMessages:!1}),o({single:l},{single:n},a)},waitForResults:function(l){return l.reduce(function(n,a){return o.isPromise(a.error)?n.then(function(){return a.error.then(function(s){a.error=s||null})}):n},new o.Promise(function(n){n()}))},result:function(l){var n=[].slice.call(arguments,1);return typeof l=="function"&&(l=l.apply(null,n)),l},isNumber:function(l){return typeof l=="number"&&!isNaN(l)},isFunction:function(l){return typeof l=="function"},isInteger:function(l){return o.isNumber(l)&&l%1===0},isBoolean:function(l){return typeof l=="boolean"},isObject:function(l){return l===Object(l)},isDate:function(l){return l instanceof Date},isDefined:function(l){return l!=null},isPromise:function(l){return!!l&&o.isFunction(l.then)},isJqueryElement:function(l){return l&&o.isString(l.jquery)},isDomElement:function(l){return!l||!l.querySelectorAll||!l.querySelector?!1:o.isObject(document)&&l===document?!0:typeof HTMLElement=="object"?l instanceof HTMLElement:l&&typeof l=="object"&&l!==null&&l.nodeType===1&&typeof l.nodeName=="string"},isEmpty:function(l){var n;if(!o.isDefined(l))return!0;if(o.isFunction(l))return!1;if(o.isString(l))return o.EMPTY_STRING_REGEXP.test(l);if(o.isArray(l))return l.length===0;if(o.isDate(l))return!1;if(o.isObject(l)){for(n in l)return!1;return!0}return!1},format:o.extend(function(l,n){return o.isString(l)?l.replace(o.format.FORMAT_REGEXP,function(a,s,p){return s==="%"?"%{"+p+"}":String(n[p])}):l},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(l){return o.isNumber(l)?l*100%1===0?""+l:parseFloat(Math.round(l*100)/100).toFixed(2):o.isArray(l)?l.map(function(n){return o.prettify(n)}).join(", "):o.isObject(l)?o.isDefined(l.toString)?l.toString():JSON.stringify(l):(l=""+l,l.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(n,a,s){return""+a+" "+s.toLowerCase()}).toLowerCase())},stringifyValue:function(l,n){var a=n&&n.prettify||o.prettify;return a(l)},isString:function(l){return typeof l=="string"},isArray:function(l){return{}.toString.call(l)==="[object Array]"},isHash:function(l){return o.isObject(l)&&!o.isArray(l)&&!o.isFunction(l)},contains:function(l,n){return o.isDefined(l)?o.isArray(l)?l.indexOf(n)!==-1:n in l:!1},unique:function(l){return o.isArray(l)?l.filter(function(n,a,s){return s.indexOf(n)==a}):l},forEachKeyInKeypath:function(l,n,a){if(o.isString(n)){var s="",p,i=!1;for(p=0;p<n.length;++p)switch(n[p]){case".":i?(i=!1,s+="."):(l=a(l,s,!1),s="");break;case"\\":i?(i=!1,s+="\\"):i=!0;break;default:i=!1,s+=n[p];break}return a(l,s,!0)}},getDeepObjectValue:function(l,n){if(o.isObject(l))return o.forEachKeyInKeypath(l,n,function(a,s){if(o.isObject(a))return a[s]})},collectFormValues:function(l,n){var a={},s,p,i,E,h,r;if(o.isJqueryElement(l)&&(l=l[0]),!l)return a;for(n=n||{},E=l.querySelectorAll("input[name], textarea[name]"),s=0;s<E.length;++s)if(i=E.item(s),!o.isDefined(i.getAttribute("data-ignored"))){var N=i.name.replace(/\./g,"\\\\.");r=o.sanitizeFormValue(i.value,n),i.type==="number"?r=r?+r:null:i.type==="checkbox"?i.attributes.value?i.checked||(r=a[N]||null):r=i.checked:i.type==="radio"&&(i.checked||(r=a[N]||null)),a[N]=r}for(E=l.querySelectorAll("select[name]"),s=0;s<E.length;++s)if(i=E.item(s),!o.isDefined(i.getAttribute("data-ignored"))){if(i.multiple){r=[];for(p in i.options)h=i.options[p],h&&h.selected&&r.push(o.sanitizeFormValue(h.value,n))}else{var m=typeof i.options[i.selectedIndex]<"u"?i.options[i.selectedIndex].value:"";r=o.sanitizeFormValue(m,n)}a[i.name]=r}return a},sanitizeFormValue:function(l,n){return n.trim&&o.isString(l)&&(l=l.trim()),n.nullify!==!1&&l===""?null:l},capitalize:function(l){return o.isString(l)?l[0].toUpperCase()+l.slice(1):l},pruneEmptyErrors:function(l){return l.filter(function(n){return!o.isEmpty(n.error)})},expandMultipleErrors:function(l){var n=[];return l.forEach(function(a){o.isArray(a.error)?a.error.forEach(function(s){n.push(o.extend({},a,{error:s}))}):n.push(a)}),n},convertErrorMessages:function(l,n){n=n||{};var a=[],s=n.prettify||o.prettify;return l.forEach(function(p){var i=o.result(p.error,p.value,p.attribute,p.options,p.attributes,p.globalOptions);if(!o.isString(i)){a.push(p);return}i[0]==="^"?i=i.slice(1):n.fullMessages!==!1&&(i=o.capitalize(s(p.attribute))+" "+i),i=i.replace(/\\\^/g,"^"),i=o.format(i,{value:o.stringifyValue(p.value,n)}),a.push(o.extend({},p,{error:i}))}),a},groupErrorsByAttribute:function(l){var n={};return l.forEach(function(a){var s=n[a.attribute];s?s.push(a):n[a.attribute]=[a]}),n},flattenErrorsToArray:function(l){return l.map(function(n){return n.error}).filter(function(n,a,s){return s.indexOf(n)===a})},cleanAttributes:function(l,n){function a(i,E,h){return o.isObject(i[E])?i[E]:i[E]=h?!0:{}}function s(i){var E={},h;for(h in i)i[h]&&o.forEachKeyInKeypath(E,h,a);return E}function p(i,E){if(!o.isObject(i))return i;var h=o.extend({},i),r,N;for(N in i)r=E[N],o.isObject(r)?h[N]=p(h[N],r):r||delete h[N];return h}return!o.isObject(n)||!o.isObject(l)?{}:(n=s(n),p(l,n))},exposeModule:function(l,n,a,s,p){a?(s&&s.exports&&(a=s.exports=l),a.validate=l):(n.validate=l,l.isFunction(p)&&p.amd&&p([],function(){return l}))},warn:function(l){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+l)},error:function(l){typeof console<"u"&&console.error&&console.error("[validate.js] "+l)}}),d.validators={presence:function(l,n){if(n=o.extend({},this.options,n),n.allowEmpty!==!1?!o.isDefined(l):o.isEmpty(l))return n.message||this.message||"can't be blank"},length:function(l,n,a){if(o.isDefined(l)){n=o.extend({},this.options,n);var s=n.is,p=n.maximum,i=n.minimum,E=n.tokenizer||function(m){return m},h,r=[];l=E(l);var N=l.length;if(!o.isNumber(N))return n.message||this.notValid||"has an incorrect length";if(o.isNumber(s)&&N!==s&&(h=n.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",r.push(o.format(h,{count:s}))),o.isNumber(i)&&N<i&&(h=n.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",r.push(o.format(h,{count:i}))),o.isNumber(p)&&N>p&&(h=n.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",r.push(o.format(h,{count:p}))),r.length>0)return n.message||r}},numericality:function(l,n,a,s,p){if(o.isDefined(l)){n=o.extend({},this.options,n);var i=[],E,h,r={greaterThan:function(f,S){return f>S},greaterThanOrEqualTo:function(f,S){return f>=S},equalTo:function(f,S){return f===S},lessThan:function(f,S){return f<S},lessThanOrEqualTo:function(f,S){return f<=S},divisibleBy:function(f,S){return f%S===0}},N=n.prettify||p&&p.prettify||o.prettify;if(o.isString(l)&&n.strict){var m="^-?(0|[1-9]\\d*)";if(n.onlyInteger||(m+="(\\.\\d+)?"),m+="$",!new RegExp(m).test(l))return n.message||n.notValid||this.notValid||this.message||"must be a valid number"}if(n.noStrings!==!0&&o.isString(l)&&!o.isEmpty(l)&&(l=+l),!o.isNumber(l))return n.message||n.notValid||this.notValid||this.message||"is not a number";if(n.onlyInteger&&!o.isInteger(l))return n.message||n.notInteger||this.notInteger||this.message||"must be an integer";for(E in r)if(h=n[E],o.isNumber(h)&&!r[E](l,h)){var t="not"+o.capitalize(E),c=n[t]||this[t]||this.message||"must be %{type} %{count}";i.push(o.format(c,{count:h,type:N(E)}))}if(n.odd&&l%2!==1&&i.push(n.notOdd||this.notOdd||this.message||"must be odd"),n.even&&l%2!==0&&i.push(n.notEven||this.notEven||this.message||"must be even"),i.length)return n.message||i}},datetime:o.extend(function(l,n){if(!o.isFunction(this.parse)||!o.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(o.isDefined(l)){n=o.extend({},this.options,n);var a,s=[],p=n.earliest?this.parse(n.earliest,n):NaN,i=n.latest?this.parse(n.latest,n):NaN;if(l=this.parse(l,n),isNaN(l)||n.dateOnly&&l%864e5!==0)return a=n.notValid||n.message||this.notValid||"must be a valid date",o.format(a,{value:arguments[0]});if(!isNaN(p)&&l<p&&(a=n.tooEarly||n.message||this.tooEarly||"must be no earlier than %{date}",a=o.format(a,{value:this.format(l,n),date:this.format(p,n)}),s.push(a)),!isNaN(i)&&l>i&&(a=n.tooLate||n.message||this.tooLate||"must be no later than %{date}",a=o.format(a,{date:this.format(i,n),value:this.format(l,n)}),s.push(a)),s.length)return o.unique(s)}},{parse:null,format:null}),date:function(l,n){return n=o.extend({},n,{dateOnly:!0}),o.validators.datetime.call(o.validators.datetime,l,n)},format:function(l,n){(o.isString(n)||n instanceof RegExp)&&(n={pattern:n}),n=o.extend({},this.options,n);var a=n.message||this.message||"is invalid",s=n.pattern,p;if(o.isDefined(l)&&(!o.isString(l)||(o.isString(s)&&(s=new RegExp(n.pattern,n.flags)),p=s.exec(l),!p||p[0].length!=l.length)))return a},inclusion:function(l,n){if(o.isDefined(l)&&(o.isArray(n)&&(n={within:n}),n=o.extend({},this.options,n),!o.contains(n.within,l))){var a=n.message||this.message||"^%{value} is not included in the list";return o.format(a,{value:l})}},exclusion:function(l,n){if(o.isDefined(l)&&(o.isArray(n)&&(n={within:n}),n=o.extend({},this.options,n),!!o.contains(n.within,l))){var a=n.message||this.message||"^%{value} is restricted";return o.isString(n.within[l])&&(l=n.within[l]),o.format(a,{value:l})}},email:o.extend(function(l,n){n=o.extend({},this.options,n);var a=n.message||this.message||"is not a valid email";if(o.isDefined(l)&&(!o.isString(l)||!this.PATTERN.exec(l)))return a},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(l,n,a,s,p){if(o.isDefined(l)){o.isString(n)&&(n={attribute:n}),n=o.extend({},this.options,n);var i=n.message||this.message||"is not equal to %{attribute}";if(o.isEmpty(n.attribute)||!o.isString(n.attribute))throw new Error("The attribute must be a non empty string");var E=o.getDeepObjectValue(s,n.attribute),h=n.comparator||function(N,m){return N===m},r=n.prettify||p&&p.prettify||o.prettify;if(!h(l,E,n,a,s))return o.format(i,{attribute:r(n.attribute)})}},url:function(l,n){if(o.isDefined(l)){n=o.extend({},this.options,n);var a=n.message||this.message||"is not a valid url",s=n.schemes||this.schemes||["http","https"],p=n.allowLocal||this.allowLocal||!1,i=n.allowDataUrl||this.allowDataUrl||!1;if(!o.isString(l))return a;var E="^(?:(?:"+s.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",h="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(p?h+="?":E+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",E+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+h+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",i){var r="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",N="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",m="data:(?:"+r+")?(?:;base64)?,"+N;E="(?:"+E+")|(?:^"+m+"$)"}var t=new RegExp(E,"i");if(!t.exec(l))return a}},type:o.extend(function(l,n,a,s,p){if(o.isString(n)&&(n={type:n}),!!o.isDefined(l)){var i=o.extend({},this.options,n),E=i.type;if(!o.isDefined(E))throw new Error("No type was specified");var h;if(o.isFunction(E)?h=E:h=this.types[E],!o.isFunction(h))throw new Error("validate.validators.type.types."+E+" must be a function.");if(!h(l,i,a,s,p)){var r=n.message||this.messages[E]||this.message||i.message||(o.isFunction(E)?"must be of the correct type":"must be of type %{type}");return o.isFunction(r)&&(r=r(l,n,a,s,p)),o.format(r,{attribute:o.prettify(a),type:E})}}},{types:{object:function(l){return o.isObject(l)&&!o.isArray(l)},array:o.isArray,integer:o.isInteger,number:o.isNumber,string:o.isString,date:o.isDate,boolean:o.isBoolean},messages:{}})},d.formatters={detailed:function(l){return l},flat:o.flattenErrorsToArray,grouped:function(l){var n;l=o.groupErrorsByAttribute(l);for(n in l)l[n]=o.flattenErrorsToArray(l[n]);return l},constraint:function(l){var n;l=o.groupErrorsByAttribute(l);for(n in l)l[n]=l[n].map(function(a){return a.validator}).sort();return l}},d.exposeModule(d,this,b,u,V)}).call(ie,k,y,null)})(J,J.exports)),J.exports}var me=ce();const H=se(me),U=(y,k,b="")=>{const u={};Object.keys(k).forEach(o=>{const l=k[o];H.isString(l)?u[o]={presence:{allowEmpty:!1,message:`^請輸入${l}`}}:u[o]=l});const V={},d=H(y,u);return d&&Object.keys(d).forEach(o=>V[`${b}${o}`]=d[o].join(",")),V},F=R.defineStore("progress",{state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})}),Ve={class:"block"},pe={class:"mt-4"},fe={class:"table align-middle gray-table side-table"},Ne={key:0},ue={key:1,class:"text-light-gray"},Ee={class:"d-flex flex-column gap-2"},be={key:0},ge={class:"mt-4"},ke={class:"table align-middle gray-table side-table"},ye={class:"row g-3"},he={class:"col-12 col-xl-2"},$e={class:"text-gray mb-2"},xe={class:"col-12 col-xl-3"},Be={class:"text-gray mb-2"},Ce={class:"col-12 col-xl-4"},_e={class:"row g-1"},Te={class:"col-7"},we={class:"col-5"},Se={class:"col-12 col-xl-3"},De={class:"text-gray mb-2"},Ue={class:"col-12"},Ae={class:"text-gray mb-2"},Oe={class:"mt-4"},Me={class:"table align-middle gray-table side-table"},Fe={class:"mt-4"},Ie={class:"table align-middle gray-table side-table"},je={key:0,class:"table-responsive mt-3 mb-0"},Pe={class:"table align-middle gray-table"},ze={key:0},qe={key:0},Le={class:"d-flex gap-2"},Re=["onClick"],Je={key:0,class:"block-bottom bg-light-teal"},Ge={__name:"Application",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.ref(),V=e.computed(()=>P("accessibility",l.value.Status,1)),d=e.ref({}),o=e.computed(()=>n.value.filter(h=>!h.Deleted)),l=e.ref({}),n=e.ref([]),a=e.computed({get:()=>!!o.value.length,set:h=>{h?s():n.value.forEach(r=>r.Deleted=!0)}}),s=()=>n.value.push({}),p=h=>h.Deleted=!0,i=h=>{if(d.value={},h&&!E()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const r={Project:l.value,Contacts:u.value,ReceivedSubsidies:n.value.filter(N=>N.ID||!N.Deleted),Submit:h?"true":"false"};D.accessibility("saveApplication",r).subscribe(N=>{h?window.location.href=`WorkSchedule.aspx?ID=${N.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${N.ID}`})},E=()=>{let h={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return l.value.OrgCategory==="2"&&(h.RegisteredNum="立案登記證字號"),d.value=U(l.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((r,N)=>Object.assign(d.value,U(r,h,`contact-${N}-`))),h={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},n.value.forEach((r,N)=>Object.assign(d.value,U(r,h,`received-${N}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(h=>{b.value=h[0],k.id?D.accessibility("getApplication",{ID:k.id}).subscribe(r=>{l.value=r.Project,u.value=r.Contacts,n.value=r.ReceivedSubsidies,l.value.OrgCategory=l.value.OrgCategory||null,F().accessibility={step:l.value.FormStep,status:l.value.Status,organizer:l.value.Organizer,organizerName:l.value.OrganizerName}}):D.accessibility("getEmptyApplication").subscribe(r=>{l.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},r),u.value=[{Role:"負責人"},{Role:"聯絡人"}],F().accessibility={step:l.value.FormStep,status:l.value.Status}})})}),e.provide("editable",V),(h,r)=>{const N=e.resolveComponent("required-label"),m=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),c=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ve,[r[37]||(r[37]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",pe,[e.createElementVNode("table",fe,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[13]||(r[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[r[14]||(r[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",Ne,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",ue,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[r[15]||(r[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[16]||(r[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).ProjectName,modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":r[0]||(r[0]=_=>e.unref(l).ProjectName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[17]||(r[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":r[1]||(r[1]=_=>e.unref(l).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[18]||(r[18]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ee,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(b),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).OrgCategory,"onUpdate:modelValue":r[2]||(r[2]=_=>e.unref(l).OrgCategory=_)},null,8,["error","options","modelValue"])]),e.unref(l).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",be,[e.createVNode(m,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(l).RegisteredNum,"onUpdate:modelValue":r[3]||(r[3]=_=>e.unref(l).RegisteredNum=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[19]||(r[19]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(l).TaxID,"onUpdate:modelValue":r[4]||(r[4]=_=>e.unref(l).TaxID=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[20]||(r[20]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":r[5]||(r[5]=_=>e.unref(l).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),r[38]||(r[38]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ge,[e.createElementVNode("table",ke,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",ye,[e.createElementVNode("div",he,[e.createElementVNode("div",$e,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[21]||(r[21]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",xe,[e.createElementVNode("div",Be,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[22]||(r[22]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":x=>_.JobTitle=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ce,[r[23]||(r[23]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",_e,[e.createElementVNode("div",Te,[e.createVNode(m,{modelValue:_.Phone,"onUpdate:modelValue":x=>_.Phone=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",we,[e.createVNode(m,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":x=>_.PhoneExt=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Se,[e.createElementVNode("div",De,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[24]||(r[24]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":x=>_.MobilePhone=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ue,[e.createElementVNode("div",Ae,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[25]||(r[25]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":x=>_.EMail=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),r[39]||(r[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Oe,[e.createElementVNode("table",Me,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[26]||(r[26]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[r[27]||(r[27]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(c,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(l).Target,"onUpdate:modelValue":r[6]||(r[6]=_=>e.unref(l).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[28]||(r[28]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":r[7]||(r[7]=_=>e.unref(l).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[29]||(r[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":r[8]||(r[8]=_=>e.unref(l).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[30]||(r[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Qualitative,"onUpdate:modelValue":r[9]||(r[9]=_=>e.unref(l).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Fe,[e.createElementVNode("table",Ie,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[36]||(r[36]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(a),"onUpdate:modelValue":r[10]||(r[10]=_=>e.isRef(a)?a.value=_:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",je,[e.createElementVNode("table",Pe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[r[31]||(r[31]=e.createElementVNode("th",null,"計畫名稱",-1)),r[32]||(r[32]=e.createElementVNode("th",null,"補助單位",-1)),r[33]||(r[33]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ze,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d)[`received-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d)[`received-${T}-Unit`],modelValue:_.Unit,"onUpdate:modelValue":x=>_.Unit=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d)[`received-${T}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":x=>_.Amount=x},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",qe,[e.createElementVNode("div",Le,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:x=>p(_),type:"button"},[...r[34]||(r[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Re)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...r[35]||(r[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Je,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[11]||(r[11]=_=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[12]||(r[12]=_=>i(!0)),type:"button"},[...r[40]||(r[40]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Qe={class:"block"},We={key:0,class:"text-pink lh-base mt-4"},Ye={class:"mt-4"},He={class:"table align-middle gray-table"},Ze={class:"text-center"},Ke={key:0,width:"180"},Xe={class:"text-center"},ve={key:0},et=["innerHTML"],tt={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},lt={key:0,class:"text-center"},ot={key:0},nt={key:1,class:"text-pink"},rt={key:1,class:"tag-group mt-2 gap-1"},at={key:0,class:"tag tag-green-light"},dt=["download","href"],st=["onClick"],it={key:0,class:"block-bottom bg-light-teal"},ct=["disabled"],mt={__name:"Attachment",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),u=e.computed(()=>b.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("accessibility",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,n=a=>{const s={ID:k.id,Attachments:b.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};D.accessibility("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getAttachment",{ID:k.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,b.value=b.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),b.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),F().accessibility={step:d.value.FormStep,status:d.value.Status,organizer:d.value.Organizer,organizerName:d.value.OrganizerName}})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Qe,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",We,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Ye,[e.createElementVNode("table",He,[e.createElementVNode("thead",Ze,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ke,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(E,h)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",Xe,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[E.Optional?(e.openBlock(),e.createElementBlock("span",ve,e.toDisplayString(E.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(E.Title),1)]),_:2},1024))]),e.unref(V)&&E.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:E.Comment},null,8,et)):e.createCommentVNode("",!0),e.unref(V)&&E.Template?(e.openBlock(),e.createElementBlock("button",tt,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",lt,[E.Uploaded?(e.openBlock(),e.createElementBlock("span",ot,"已上傳")):(e.openBlock(),e.createElementBlock("span",nt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(E.Multiple||!E.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:r=>o(E,r)},null,8,["onFile"])):e.createCommentVNode("",!0),E.Uploaded?(e.openBlock(),e.createElementBlock("div",rt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.Files,r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",at,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(l)(r.Path)},e.toDisplayString(r.Name),9,dt),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>r.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,st)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",it,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=E=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=E=>n(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ct)])):e.createCommentVNode("",!0)],64)}}},Vt={class:"block"},pt={class:"mt-4"},ft={class:"table-responsive mt-3 mb-0"},Nt={class:"table align-middle gray-table"},ut={key:0,width:"1"},Et={key:0},bt={class:"d-flex gap-2"},gt=["onClick"],kt={class:"table-responsive mt-3 mb-0"},yt={class:"table align-middle gray-table"},ht={key:0,class:"block-bottom bg-light-teal"},$t={__name:"Benefit",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.computed(()=>P("accessibility",o.value.Status,4)),V=e.ref({}),d=e.computed(()=>b.value.filter(p=>!p.Deleted)),o=e.ref({}),l=()=>b.value.push({}),n=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var E;return(E=document.querySelector(".invalid"))==null?void 0:E.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:o.value,Benefits:b.value,Submit:p?"true":"false"};D.accessibility("saveBenefit",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${k.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((i,E)=>Object.assign(V.value,U(i,p,`item-${E}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getBenefit",{ID:k.id})]).subscribe(p=>{const i=p[0];o.value=i.Project,b.value=i.Benefits,b.value.length||l(),F().accessibility={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",u),(p,i)=>{const E=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Vt,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",pt,[e.createElementVNode("div",ft,[e.createElementVNode("table",Nt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[3]||(i[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),i[4]||(i[4]=e.createElementVNode("th",null,"目標值",-1)),i[5]||(i[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",ut,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(r,N)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(V)[`item-${N}-Title`],modelValue:r.Title,"onUpdate:modelValue":m=>r.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(V)[`item-${N}-Target`],modelValue:r.Target,"onUpdate:modelValue":m=>r.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:r.Description,"onUpdate:modelValue":m=>r.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Et,[e.createElementVNode("div",bt,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>n(r),type:"button"},[...i[6]||(i[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,gt)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...i[7]||(i[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",kt,[e.createElementVNode("table",yt,[i[8]||(i[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":i[0]||(i[0]=r=>e.unref(o).Benefit=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",ht,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[1]||(i[1]=r=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[2]||(i[2]=r=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},xt={class:"block"},Bt={class:"mt-4"},Ct={class:"table-responsive mt-3 mb-0"},_t={class:"table align-middle gray-table"},Tt={class:"text-end"},wt={class:"text-end"},St={class:"table-responsive"},Dt={class:"table align-middle gray-table"},Ut=["colspan"],At={key:0,width:"1"},Ot={class:"text-end"},Mt={key:0},Ft={class:"d-flex gap-2"},It=["onClick"],jt={class:"mt-4"},Pt={class:"table-responsive mt-3 mb-0"},zt={class:"table align-middle gray-table"},qt={key:0,width:"1"},Lt={class:"text-end"},Rt={key:0},Jt={class:"d-flex gap-2"},Gt=["onClick"],Qt={key:0,class:"block-bottom bg-light-teal"},Wt={class:"text-center"},Yt={class:"mb-5"},Ht={__name:"Funding",props:{id:{type:Number}},setup(y){const k=y,b=e.computed(()=>P("accessibility",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>n.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),o=e.ref({}),l=e.ref(),n=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),i=()=>n.value.push({}),E=()=>a.value.push({}),h=m=>m.Deleted=!0,r=(m,t)=>{if(u.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>r(m,!0));return}const c={Project:o.value,OtherSubsidies:n.value,BudgetPlans:a.value,Submit:m?"true":"false"};D.accessibility("saveFunding",c).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${k.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},n.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`other-${c}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`plan-${c}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getFunding",{ID:k.id})]).subscribe(m=>{const t=m[0];o.value=t.Project,n.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,n.value.length||i(),a.value.length||E(),F().accessibility={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",b),e.watchEffect(()=>{o.value.OtherAmount=V.value.reduce((m,t)=>m+I(t.Amount),0),p.value=I(o.value.ApplyAmount)+I(o.value.SelfAmount)+I(o.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(I(m.Amount)/o.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=I(m.Amount)+I(m.OtherAmount))}),(m,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xt,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Bt,[e.createElementVNode("div",Ct,[e.createElementVNode("table",_t,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(o).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(o).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",Tt,e.toDisplayString((T=e.unref(o).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",wt,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",St,[e.createElementVNode("table",Dt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(b)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Ut)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",At,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":g=>x.Unit=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":g=>x.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Ot,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":g=>x.Content=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",Mt,[e.createElementVNode("div",Ft,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:g=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,It)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",jt,[e.createElementVNode("div",Pt,[e.createElementVNode("table",zt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",qt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":g=>x.Title=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":g=>x.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":g=>x.OtherAmount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Lt,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":g=>x.Description=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",Rt,[e.createElementVNode("div",Jt,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:g=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Gt)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",Qt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>r(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",Wt,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Yt,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Zt={__name:"ProgressBar",setup(y){const k=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(b,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:k,type:"accessibility"})}}},Kt={class:"block"},Xt={class:"mt-4"},vt={class:"table align-middle gray-table side-table"},el={key:0,class:"d-flex align-items-center gap-2"},tl={class:"input-group w-auto"},ll={class:"text-teal-dark"},ol={key:1,class:"invalid mt-0"},nl={class:"table-responsive mt-4"},rl={class:"table align-middle gray-table"},al={key:0},dl={class:"input-group"},sl={key:0,class:"invalid mt-0"},il={key:0},cl={class:"d-flex gap-2"},ml=["onClick"],Vl={class:"mt-4"},pl={class:"table align-middle gray-table"},fl={key:0},Nl={key:0},ul={class:"d-flex gap-2"},El=["onClick"],bl={key:0,class:"block-bottom bg-light-teal"},gl={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const k=y,b=[{value:1,text:"50%"},{value:2,text:"100%"}],u=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("accessibility",n.value.Status,2)),d=e.ref({}),o=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),n=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),i=()=>D.accessibility("createItem",{ID:k.id}).subscribe(m=>s.value.push(m)),E=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,r=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};D.accessibility("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${k.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(n.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`item-${c}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`schedule-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.accessibility("getWorkSchedule",{ID:k.id})]).subscribe(m=>{const t=m[0];n.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||i(),p.value.length||E(),F().accessibility={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",V),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kt,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Xt,[e.createElementVNode("table",vt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",el,[e.createElementVNode("div",tl,[e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(n).StartTime,"onUpdate:modelValue":t[0]||(t[0]=g=>e.unref(n).StartTime=g)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(n).EndTime,"onUpdate:modelValue":t[1]||(t[1]=g=>e.unref(n).EndTime=g)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",ll,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(u)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",ol,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",nl,[e.createElementVNode("table",rl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",al,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:g.Title,"onUpdate:modelValue":C=>g.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",dl,[e.createVNode(T,{"empty-value":0,modelValue:g.Begin,"onUpdate:modelValue":C=>g.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:g.End,"onUpdate:modelValue":C=>g.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",sl,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:g.Deadline,"onUpdate:modelValue":C=>g.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:g.Content,"onUpdate:modelValue":C=>g.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",il,[e.createElementVNode("div",cl,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(g),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ml)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Vl,[e.createElementVNode("table",pl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",fl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:b,modelValue:g.Type,"onUpdate:modelValue":C=>g.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:g.ItemID,"onUpdate:modelValue":C=>g.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(g.ItemID?String.fromCharCode(65+e.unref(o).findIndex(C=>C.ID===g.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:g.Deadline,"onUpdate:modelValue":C=>g.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:g.Content,"onUpdate:modelValue":C=>g.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Nl,[e.createElementVNode("div",ul,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(g),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,El)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",bl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=g=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=g=>r(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},kl={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},yl={class:"modal-content"},hl={class:"modal-body"},$l={class:"d-flex justify-content-center mt-4 gap-4"},xl={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Bl={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(y,{expose:k}){let b;const u=e.ref(),V=y,d=()=>{b&&b()};return k({show:l=>{b=l,bootstrap.Modal.getOrCreateInstance(u.value).show()}}),(l,n)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:u,tabindex:"-1"},[e.createElementVNode("div",kl,[e.createElementVNode("div",yl,[n[0]||(n[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",hl,[e.renderSlot(l.$slots,"default"),e.createElementVNode("div",$l,[e.createElementVNode("button",xl,e.toDisplayString(V.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:d,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(V.confirm),1)])])])])],512)]))}},Cl={class:"application-step"},_l=["onClick"],Tl={class:"step-content"},wl={class:"step-label"},Sl={key:0,class:"step-status edit"},Dl={key:1,class:"step-status"},Ul={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(y,{emit:k}){const b=e.computed(()=>P(V.type,u[V.type].status,V.step)),u=F(),V=y,d=l=>{V.review?o("click",l.step):l.step<=u[V.type].step&&(location.href=`${l.url}.aspx?ID=${V.id}`)},o=k;return(l,n)=>(e.openBlock(),e.createElementBlock("div",Cl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.steps,a=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(b)&&(a.step<e.unref(u)[y.type].step||a.step===y.step)}]),onClick:s=>d(a),key:a,role:"button"},[e.createElementVNode("div",Tl,[e.createElementVNode("div",wl,e.toDisplayString(a.title),1),e.unref(b)&&a.step===y.step?(e.openBlock(),e.createElementBlock("div",Sl,"編輯中")):a.step<e.unref(u)[y.type].step?(e.openBlock(),e.createElementBlock("div",Dl,"已完成")):e.createCommentVNode("",!0)])],10,_l))),128))]))}},Al={class:"block"},Ol={class:"mt-4"},Ml={class:"table align-middle gray-table side-table"},Fl={key:0},Il={key:1,class:"text-light-gray"},jl={class:"d-flex gap-2"},Pl={key:0,class:"invalid mt-0"},zl={class:"d-flex flex-column gap-2"},ql={key:0},Ll={class:"mt-4"},Rl={class:"table align-middle gray-table side-table"},Jl={class:"row g-3"},Gl={class:"col-12 col-xl-2"},Ql={class:"text-gray mb-2"},Wl={class:"col-12 col-xl-3"},Yl={class:"text-gray mb-2"},Hl={class:"col-12 col-xl-4"},Zl={class:"row g-1"},Kl={class:"col-7"},Xl={class:"col-5"},vl={class:"col-12 col-xl-3"},eo={class:"text-gray mb-2"},to={class:"col-12"},lo={class:"text-gray mb-2"},oo={class:"mt-4"},no={class:"table align-middle gray-table side-table"},ro={class:"mt-4"},ao={class:"table align-middle gray-table side-table"},so={key:0,class:"table-responsive mt-3 mb-0"},io={class:"table align-middle gray-table"},co={key:0},mo={key:0},Vo={class:"d-flex gap-2"},po=["onClick"],fo={key:0,class:"block-bottom bg-light-teal"},No={__name:"Application",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.ref(),V=e.computed(()=>P("culture",a.value.Status,1)),d=e.ref({}),o=e.ref(null),l=e.ref([]),n=e.computed(()=>p.value.filter(t=>!t.Deleted)),a=e.ref({}),s=e.computed(()=>l.value.filter(t=>!t.ParentCode)),p=e.ref([]),i=e.computed(()=>l.value.filter(t=>t.ParentCode===o.value)),E=e.computed({get:()=>!!n.value.length,set:t=>{t?h():p.value.forEach(c=>c.Deleted=!0)}}),h=()=>p.value.push({}),r=t=>t.Deleted=!0,N=t=>{if(d.value={},t&&!m()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}const c={Project:a.value,Contacts:u.value,ReceivedSubsidies:p.value.filter(f=>f.ID||!f.Deleted),Submit:t?"true":"false"};D.culture("saveApplication",c).subscribe(f=>{t?window.location.href=`WorkSchedule.aspx?ID=${f.ID}`:a.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${f.ID}`})},m=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),d.value=U(a.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((c,f)=>Object.assign(d.value,U(c,t,`contact-${f}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},p.value.forEach((c,f)=>Object.assign(d.value,U(c,t,`received-${f}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getZgsCodes",{CodeGroup:"CULField"}),D.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{l.value=t[0],b.value=t[1],k.id?D.culture("getApplication",{ID:k.id}).subscribe(c=>{var f;a.value=c.Project,u.value=c.Contacts,p.value=c.ReceivedSubsidies,o.value=((f=l.value.find(S=>S.Code===a.value.Field))==null?void 0:f.ParentCode)||null,a.value.OrgCategory=a.value.OrgCategory||null,F().culture={step:a.value.FormStep,status:a.value.Status,organizer:a.value.Organizer,organizerName:a.value.OrganizerName}}):D.culture("getEmptyApplication").subscribe(c=>{o.value=null,a.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},c),u.value=[{Role:"負責人"},{Role:"聯絡人"}],F().culture={step:a.value.FormStep,status:a.value.Status}})})}),e.provide("editable",V),e.watch(o,()=>{o.value?i.value.find(t=>a.value.Field===t.Code)||(a.value.Field=i.value[0].Code):a.value.Field=null}),(t,c)=>{const f=e.resolveComponent("required-label"),S=e.resolveComponent("input-text"),_=e.resolveComponent("input-select"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Al,[c[40]||(c[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Ol,[e.createElementVNode("table",Ml,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[c[15]||(c[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).Year),1)]),e.createElementVNode("tr",null,[c[16]||(c[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(a).ProjectID?(e.openBlock(),e.createElementBlock("span",Fl,e.toDisplayString(e.unref(a).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Il,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[c[17]||(c[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[18]||(c[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).ProjectName,modelValue:e.unref(a).ProjectName,"onUpdate:modelValue":c[0]||(c[0]=g=>e.unref(a).ProjectName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[19]||(c[19]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",jl,[e.createVNode(_,{"empty-value":null,options:e.unref(s),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o),"onUpdate:modelValue":c[1]||(c[1]=g=>e.isRef(o)?o.value=g:null)},null,8,["options","modelValue"]),e.createVNode(_,{"empty-value":null,disabled:!e.unref(o),options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).Field,"onUpdate:modelValue":c[2]||(c[2]=g=>e.unref(a).Field=g)},null,8,["disabled","options","modelValue"])]),e.unref(d).Field?(e.openBlock(),e.createElementBlock("div",Pl,e.toDisplayString(e.unref(d).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[20]||(c[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(a).OrgName,"onUpdate:modelValue":c[3]||(c[3]=g=>e.unref(a).OrgName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[21]||(c[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",zl,[e.createElementVNode("div",null,[e.createVNode(_,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(b),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).OrgCategory,"onUpdate:modelValue":c[4]||(c[4]=g=>e.unref(a).OrgCategory=g)},null,8,["error","options","modelValue"])]),e.unref(a).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",ql,[e.createVNode(S,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(a).RegisteredNum,"onUpdate:modelValue":c[5]||(c[5]=g=>e.unref(a).RegisteredNum=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[22]||(c[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(a).TaxID,"onUpdate:modelValue":c[6]||(c[6]=g=>e.unref(a).TaxID=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[23]||(c[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(a).Address,"onUpdate:modelValue":c[7]||(c[7]=g=>e.unref(a).Address=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),c[41]||(c[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ll,[e.createElementVNode("table",Rl,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Jl,[e.createElementVNode("div",Gl,[e.createElementVNode("div",Ql,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[24]||(c[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-Name`],modelValue:g.Name,"onUpdate:modelValue":C=>g.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Wl,[e.createElementVNode("div",Yl,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[25]||(c[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-JobTitle`],modelValue:g.JobTitle,"onUpdate:modelValue":C=>g.JobTitle=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Hl,[c[26]||(c[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Zl,[e.createElementVNode("div",Kl,[e.createVNode(S,{modelValue:g.Phone,"onUpdate:modelValue":C=>g.Phone=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Xl,[e.createVNode(S,{placeholder:"請輸入分機",size:"4",modelValue:g.PhoneExt,"onUpdate:modelValue":C=>g.PhoneExt=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",vl,[e.createElementVNode("div",eo,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[27]||(c[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-MobilePhone`],modelValue:g.MobilePhone,"onUpdate:modelValue":C=>g.MobilePhone=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",to,[e.createElementVNode("div",lo,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[28]||(c[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(d)[`contact-${B}-EMail`],modelValue:g.EMail,"onUpdate:modelValue":C=>g.EMail=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),c[42]||(c[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",oo,[e.createElementVNode("table",no,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[29]||(c[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[c[30]||(c[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(T,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(a).Target,"onUpdate:modelValue":c[8]||(c[8]=g=>e.unref(a).Target=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[31]||(c[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(a).Summary,"onUpdate:modelValue":c[9]||(c[9]=g=>e.unref(a).Summary=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[32]||(c[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Quantified,"onUpdate:modelValue":c[10]||(c[10]=g=>e.unref(a).Quantified=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[33]||(c[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Qualitative,"onUpdate:modelValue":c[11]||(c[11]=g=>e.unref(a).Qualitative=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ro,[e.createElementVNode("table",ao,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[c[39]||(c[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(x,{modelValue:e.unref(E),"onUpdate:modelValue":c[12]||(c[12]=g=>e.isRef(E)?E.value=g:null)},null,8,["modelValue"]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",so,[e.createElementVNode("table",io,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[c[34]||(c[34]=e.createElementVNode("th",null,"計畫名稱",-1)),c[35]||(c[35]=e.createElementVNode("th",null,"補助單位",-1)),c[36]||(c[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",co,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d)[`received-${B}-Name`],modelValue:g.Name,"onUpdate:modelValue":C=>g.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(d)[`received-${B}-Unit`],modelValue:g.Unit,"onUpdate:modelValue":C=>g.Unit=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(d)[`received-${B}-Amount`],modelValue:g.Amount,"onUpdate:modelValue":C=>g.Amount=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",mo,[e.createElementVNode("div",Vo,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>r(g),type:"button"},[...c[37]||(c[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,po)):e.createCommentVNode("",!0),B+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...c[38]||(c[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",fo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[13]||(c[13]=g=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[14]||(c[14]=g=>N(!0)),type:"button"},[...c[43]||(c[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},uo={class:"block"},Eo={key:0,class:"text-pink lh-base mt-4"},bo={class:"mt-4"},go={class:"table align-middle gray-table"},ko={class:"text-center"},yo={key:0,width:"180"},ho={class:"text-center"},$o={key:0},xo=["innerHTML"],Bo={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Co={key:0,class:"text-center"},_o={key:0},To={key:1,class:"text-pink"},wo={key:1,class:"tag-group mt-2 gap-1"},So={key:0,class:"tag tag-green-light"},Do=["download","href"],Uo=["onClick"],Ao={key:0,class:"block-bottom bg-light-teal"},Oo=["disabled"],Mo={__name:"Attachment",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:!0,Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),u=e.computed(()=>b.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("culture",d.value.Status,5)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,n=a=>{const s={ID:k.id,Attachments:b.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};D.culture("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getAttachment",{ID:k.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,b.value=b.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),d.value.Status>=10&&b.value.push({Type:6,Title:"著作權授權同意書",Template:!0,Files:[]}),b.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),F().culture={step:d.value.FormStep,status:d.value.Status,organizer:d.value.Organizer,organizerName:d.value.OrganizerName}})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",uo,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",Eo,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",bo,[e.createElementVNode("table",go,[e.createElementVNode("thead",ko,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",yo,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(E,h)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",ho,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[E.Optional?(e.openBlock(),e.createElementBlock("span",$o,e.toDisplayString(E.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(E.Title),1)]),_:2},1024))]),e.unref(V)&&E.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:E.Comment},null,8,xo)):e.createCommentVNode("",!0),e.unref(V)&&E.Template?(e.openBlock(),e.createElementBlock("button",Bo,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Co,[E.Uploaded?(e.openBlock(),e.createElementBlock("span",_o,"已上傳")):(e.openBlock(),e.createElementBlock("span",To,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(E.Multiple||!E.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:r=>o(E,r)},null,8,["onFile"])):e.createCommentVNode("",!0),E.Uploaded?(e.openBlock(),e.createElementBlock("div",wo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.Files,r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",So,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(l)(r.Path)},e.toDisplayString(r.Name),9,Do),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>r.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Uo)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Ao,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=E=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=E=>n(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Oo)])):e.createCommentVNode("",!0)],64)}}},Fo={class:"block"},Io={class:"mt-4"},jo={class:"table-responsive mt-3 mb-0"},Po={class:"table align-middle gray-table"},zo={class:"text-end"},qo={class:"text-end"},Lo={class:"table-responsive"},Ro={class:"table align-middle gray-table"},Jo=["colspan"],Go={key:0,width:"1"},Qo={key:0},Wo={class:"d-flex gap-2"},Yo=["onClick"],Ho={class:"mt-4"},Zo={class:"table-responsive mt-3 mb-0"},Ko={class:"table align-middle gray-table"},Xo={key:0,width:"1"},vo={class:"text-end"},en={key:0},tn={class:"d-flex gap-2"},ln=["onClick"],on={key:0,class:"block-bottom bg-light-teal"},nn={class:"text-center"},rn={class:"mb-5"},an={__name:"Funding",props:{id:{type:Number}},setup(y){const k=y,b=e.computed(()=>P("culture",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>a.value.filter(c=>!c.Deleted)),d=e.computed(()=>s.value.filter(c=>!c.Deleted)),o=e.ref({}),l=e.ref([]),n=e.ref(),a=e.ref([]),s=e.ref([]),p=e.ref({}),i=e.ref(0),E=()=>a.value.push({}),h=()=>s.value.push({ItemID:0}),r=c=>c.Deleted=!0,N=c=>c.Deleted=!0,m=(c,f)=>{if(u.value={},c&&!t()){e.nextTick(()=>{var _;return(_=document.querySelector(".invalid"))==null?void 0:_.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!f&&o.value.ApplyAmount>p.value.GrantLimit*1e4){n.value.show(()=>m(c,!0));return}const S={Project:o.value,OtherSubsidies:a.value,BudgetPlans:s.value,Submit:c?"true":"false"};D.culture("saveFunding",S).subscribe(()=>{c?window.location.href=`Other.aspx?ID=${k.id}`:window.location.reload()})},t=()=>{let c={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,c),c={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},a.value.forEach((f,S)=>Object.assign(u.value,U(f,c,`other-${S}-`))),c={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},s.value.forEach((f,S)=>Object.assign(u.value,U(f,c,`plan-${S}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getFunding",{ID:k.id})]).subscribe(c=>{const f=c[0];o.value=f.Project,a.value=f.OtherSubsidies,s.value=f.BudgetPlans,l.value=f.Items,p.value=f.GrantTargetSetting,a.value.length||E(),s.value.length||h(),F().culture={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",b),e.watchEffect(()=>{o.value.OtherAmount=a.value.reduce((c,f)=>c+(f.Deleted?0:I(f.Amount)),0),i.value=I(o.value.ApplyAmount)+I(o.value.SelfAmount)+I(o.value.OtherAmount),s.value.forEach(c=>c.sum=I(c.Amount)+I(c.OtherAmount))}),(c,f)=>{var g;const S=e.resolveComponent("input-integer"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-select"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Fo,[f[20]||(f[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Io,[e.createElementVNode("div",jo,[e.createElementVNode("table",Po,[f[4]||(f[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":f[0]||(f[0]=B=>e.unref(o).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":f[1]||(f[1]=B=>e.unref(o).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",zo,e.toDisplayString((g=e.unref(o).OtherAmount)==null?void 0:g.toLocaleString()),1),e.createElementVNode("td",qo,e.toDisplayString(e.unref(i).toLocaleString()),1)])])])]),f[10]||(f[10]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Lo,[e.createElementVNode("table",Ro,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(b)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Jo)]),e.createElementVNode("tr",null,[f[5]||(f[5]=e.createElementVNode("th",{width:"1"},null,-1)),f[6]||(f[6]=e.createElementVNode("th",null,"單位名稱",-1)),f[7]||(f[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",Go,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(u)[`other-${C}-Unit`],modelValue:B.Unit,"onUpdate:modelValue":A=>B.Unit=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`other-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",Qo,[e.createElementVNode("div",Wo,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>r(B),type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Yo)):e.createCommentVNode("",!0),C+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...f[9]||(f[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),f[21]||(f[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ho,[e.createElementVNode("div",Zo,[e.createElementVNode("table",Ko,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[11]||(f[11]=e.createElementVNode("th",null,"重要工作項目",-1)),f[12]||(f[12]=e.createElementVNode("th",null,"預算項目",-1)),f[13]||(f[13]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),f[14]||(f[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),f[15]||(f[15]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),f[16]||(f[16]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",Xo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(T,{"empty-value":0,error:e.unref(u)[`plan-${C}-ItemID`],options:e.unref(l),"text-name":"Title","value-name":"ID",modelValue:B.ItemID,"onUpdate:modelValue":A=>B.ItemID=A},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(u)[`plan-${C}-Title`],modelValue:B.Title,"onUpdate:modelValue":A=>B.Title=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`plan-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`plan-${C}-OtherAmount`],modelValue:B.OtherAmount,"onUpdate:modelValue":A=>B.OtherAmount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",vo,e.toDisplayString(B.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(u)[`plan-${C}-Description`],rows:"1",modelValue:B.Description,"onUpdate:modelValue":A=>B.Description=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",en,[e.createElementVNode("div",tn,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>N(B),type:"button"},[...f[17]||(f[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ln)):e.createCommentVNode("",!0),C+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...f[18]||(f[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),f[19]||(f[19]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))])]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",on,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=B=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=B=>m(!0)),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(w,{ref_key:"modal",ref:n},{default:e.withCtx(()=>[e.createElementVNode("div",nn,[f[23]||(f[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",rn,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(p).GrantLimit)+"萬",1),f[24]||(f[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),f[25]||(f[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},dn={class:"block"},sn={key:0,class:"text-pink lh-base mt-3"},cn={class:"border"},mn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Vn={class:"d-flex gap-2 align-items-center flex-grow-1"},pn={class:"text-nowrap"},fn={class:"flex-grow-1"},Nn={class:"d-flex gap-2"},un=["onClick"],En=["href"],bn=["id"],gn={class:"table align-middle gray-table side-table mb-0"},kn={key:0,class:"block-bottom bg-light-teal"},yn={__name:"Other",props:{id:{type:Number}},setup(y){const k=y,b=e.computed(()=>P("culture",V.value.Status,4)),u=e.ref({}),V=e.ref({}),d=e.ref([]),o=e.computed(()=>d.value.filter(p=>!p.Deleted)),l=()=>d.value.push({}),n=p=>p.Deleted=!0,a=p=>{if(u.value={},p&&!s()){e.nextTick(()=>{var E;return(E=document.querySelector(".invalid"))==null?void 0:E.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={ID:k.id,Projects:d.value,Submit:p?"true":"false"};D.culture("saveRelatedProject",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${k.id}`:window.location.reload()})},s=()=>{u.value={};const p={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return o.value.forEach((i,E)=>Object.assign(u.value,U(i,p,`project-${E}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getRelatedProject",{ID:k.id})]).subscribe(p=>{const i=p[0];V.value=i.Project,d.value=i.Projects,F().culture={step:V.value.FormStep,status:V.value.Status,organizer:V.value.Organizer,organizerName:V.value.OrganizerName}})}),e.provide("editable",b),(p,i)=>{const E=e.resolveComponent("required-label"),h=e.resolveComponent("input-text"),r=e.resolveComponent("input-integer"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",dn,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("p",sn," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(m,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:m},[e.createElementVNode("div",cn,[e.createElementVNode("div",mn,[e.createElementVNode("div",Vn,[e.createElementVNode("label",pn,[e.createVNode(E,null,{default:e.withCtx(()=>[...i[2]||(i[2]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",fn,[e.createVNode(h,{error:e.unref(u)[`project-${t}-Title`],modelValue:m.Title,"onUpdate:modelValue":c=>m.Title=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Nn,[e.unref(b)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(c=>n(m),["prevent"]),href:"#"},"刪除",8,un)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,En)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...i[3]||(i[3]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{class:"text-start w-auto",error:e.unref(u)[`project-${t}-Year`],modelValue:m.Year,"onUpdate:modelValue":c=>m.Year=c},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...i[4]||(i[4]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(u)[`project-${t}-OrgName`],modelValue:m.OrgName,"onUpdate:modelValue":c=>m.OrgName=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...i[5]||(i[5]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(r,{class:"w-auto",error:e.unref(u)[`project-${t}-Amount`],modelValue:m.Amount,"onUpdate:modelValue":c=>m.Amount=c},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...i[6]||(i[6]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(u)[`project-${t}-Description`],rows:"4",modelValue:m.Description,"onUpdate:modelValue":c=>m.Description=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...i[7]||(i[7]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(u)[`project-${t}-Benefit`],rows:"4",modelValue:m.Benefit,"onUpdate:modelValue":c=>m.Benefit=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,bn)])]))),128)),e.unref(b)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:l,type:"button"},[...i[8]||(i[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",kn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[0]||(i[0]=m=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[1]||(i[1]=m=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},hn={__name:"ProgressBar",setup(y){const k=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(b,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:k,type:"culture"})}}},$n=(y,k)=>{const b=y.__vccOpts||y;for(const[u,V]of k)b[u]=V;return b},xn={class:"block"},Bn={class:"mt-4"},Cn={class:"table align-middle gray-table side-table"},_n={key:0,class:"d-flex align-items-center gap-2"},Tn={class:"input-group w-auto"},wn={class:"text-teal-dark"},Sn={key:1,class:"invalid mt-0"},Dn={class:"square-title mt-4"},Un={class:"mt-4"},An=["onClick"],On={class:"d-flex flex-column gap-2"},Mn={class:"mt-4 d-flex flex-column gap-2"},Fn={class:"d-flex flex-column gap-3 mt-4"},In={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},jn={class:"d-flex gap-2 align-items-center flex-grow-1"},Pn={class:"text-nowrap"},zn={class:"flex-grow-1"},qn={class:"d-flex gap-2"},Ln=["onClick"],Rn=["href"],Jn=["id"],Gn={class:"table align-middle gray-table side-table mb-0"},Qn={class:"p-0"},Wn={class:"item-list"},Yn={class:"mt-2 align-self-start text-center"},Hn={class:"input-group"},Zn={key:0,class:"invalid mt-0"},Kn={key:0,class:"d-flex gap-2 mt-1 align-self-start"},Xn=["onClick"],vn=["onClick"],er={class:"row"},tr={class:"col"},lr=["value"],or={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},nr=["onClick"],rr=["onClick"],ar={class:"col"},dr=["value"],sr={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},ir=["onClick"],cr=["onClick"],mr=["onClick"],Vr={key:0,class:"block-bottom bg-light-teal"},pr=$n({__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const k=y,b=e.computed(()=>P("culture",o.value.Status,2)),u=e.computed(()=>n.value.EndDate),V=e.ref({}),d=e.computed(()=>l.value.filter(c=>!c.Deleted)),o=e.ref({}),l=e.ref([]),n=e.ref({}),a=()=>{const c={Items:[]};s(c),l.value.push(c)},s=c=>{const f={Steps:[],Schedules:[]};i(f),i(f),i(f),p(f,1),p(f,2),c.Items.push(f)},p=(c,f)=>c.Schedules.push({Type:f,Month:0,StepID:0}),i=c=>D.culture("createGoalStep",{ID:k.id,ItemID:c.ID}).subscribe(f=>c.Steps.push(f)),E=c=>c.Deleted=!0,h=c=>c.Deleted=!0,r=c=>c.Deleted=!0,N=c=>c.Deleted=!0,m=c=>{if(V.value={},c&&!t()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:o.value,Goals:l.value,Submit:c?"true":"false"};D.culture("saveWorkSchedule",f).subscribe(()=>{c?window.location.href=`Funding.aspx?ID=${k.id}`:window.location.reload()})},t=()=>{const c={StartTime:"計畫期程",EndTime:"計畫期程"};V.value=U(o.value,c);const f={Title:"計畫目標",Content:"預期效益"},S={Title:"重要工作項目",Indicator:"績效指標"},_={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},T={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return l.value.filter(x=>!x.Deleted).forEach((x,w)=>{Object.assign(V.value,U(x,f,`goal-${w}-`)),x.Items.filter(g=>!g.Deleted).forEach((g,B)=>{Object.assign(V.value,U(g,S,`item-${w}-${B}-`)),g.Steps.filter(C=>!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,_,`step-${w}-${B}-${A}-`))),g.Schedules.filter(C=>C.Type===1&&!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,T,`schedule-${w}-${B}-1-${A}-`))),g.Schedules.filter(C=>C.Type===2&&!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,T,`schedule-${w}-${B}-2-${A}-`)))})}),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.culture("getWorkSchedule",{ID:k.id})]).subscribe(c=>{const f=c[0];o.value=f.Project,l.value=f.Goals,n.value=f.GrantType,l.value.length||a(),F().culture={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",b),(c,f)=>{const S=e.resolveComponent("required-label"),_=e.resolveComponent("input-tw-date"),T=e.resolveComponent("tw-date"),x=e.resolveComponent("input-text"),w=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-month"),B=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xn,[f[25]||(f[25]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Bn,[e.createElementVNode("table",Cn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[4]||(f[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",_n,[e.createElementVNode("div",Tn,[e.createVNode(_,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(o).StartTime,"onUpdate:modelValue":f[0]||(f[0]=C=>e.unref(o).StartTime=C)},null,8,["max-date","modelValue"]),f[5]||(f[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(_,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(o).EndTime,"onUpdate:modelValue":f[1]||(f[1]=C=>e.unref(o).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",wn,[f[6]||(f[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(T,{value:e.unref(u)},null,8,["value"]),f[7]||(f[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(V).StartTime||e.unref(V).EndTime?(e.openBlock(),e.createElementBlock("div",Sn,e.toDisplayString(e.unref(V).StartTime||e.unref(V).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",Dn,[f[9]||(f[9]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:a,type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Un,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(C,A)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:C},[e.unref(b)&&e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:j=>E(C),type:"button"},"刪除",8,An)):e.createCommentVNode("",!0),e.createElementVNode("div",On,[f[10]||(f[10]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`goal-${A}-Title`],modelValue:C.Title,"onUpdate:modelValue":j=>C.Title=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Mn,[f[11]||(f[11]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(w,{error:e.unref(V)[`goal-${A}-Content`],rows:"4",modelValue:C.Content,"onUpdate:modelValue":j=>C.Content=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Fn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Items.filter(j=>!j.Deleted),(j,z)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:j},[e.createElementVNode("div",In,[e.createElementVNode("div",jn,[e.createElementVNode("label",Pn,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[12]||(f[12]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",zn,[e.createVNode(x,{error:e.unref(V)[`item-${A}-${z}-Title`],modelValue:j.Title,"onUpdate:modelValue":O=>j.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",qn,[e.unref(b)&&C.Items.filter(O=>!O.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(O=>h(j),["prevent"]),href:"#"},"刪除",8,Ln)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${z}`,role:"button"},"收合",8,Rn)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${z}`},[e.createElementVNode("table",Gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[13]||(f[13]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",Qn,[e.createElementVNode("ul",Wn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Steps.filter(O=>!O.Deleted),(O,q)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(b)}]),key:O},[e.createElementVNode("div",Yn,e.toDisplayString(String.fromCharCode(65+q)),1),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`step-${A}-${z}-${q}-Title`],placeholder:"如:進行口訪紀錄",modelValue:O.Title,"onUpdate:modelValue":M=>O.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",Hn,[e.createVNode(g,{"empty-value":0,modelValue:O.Begin,"onUpdate:modelValue":M=>O.Begin=M},null,8,["modelValue","onUpdate:modelValue"]),f[14]||(f[14]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(g,{"empty-value":0,modelValue:O.End,"onUpdate:modelValue":M=>O.End=M},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(V)[`step-${A}-${z}-${q}-Begin`]||e.unref(V)[`step-${A}-${z}-${q}-End`]?(e.openBlock(),e.createElementBlock("div",Zn,e.toDisplayString(e.unref(V)[`step-${A}-${z}-${q}-Begin`]||e.unref(V)[`step-${A}-${z}-${q}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",Kn,[j.Steps.filter(M=>!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>N(O),type:"button"},[...f[15]||(f[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Xn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>i(j),type:"button"},[...f[16]||(f[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,vn)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[17]||(f[17]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(V)[`item-${A}-${z}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:j.Indicator,"onUpdate:modelValue":O=>j.Indicator=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...f[18]||(f[18]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",er,[e.createElementVNode("div",tr,[f[21]||(f[21]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Schedules.filter(O=>O.Type===1&&!O.Deleted),(O,q)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:O},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(b)?3:4}`])},[e.createVNode(g,{error:e.unref(V)[`schedule-${A}-${z}-1-${q}-Month`],"empty-value":0,modelValue:O.Month,"onUpdate:modelValue":M=>O.Month=M},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(b)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(V)[`schedule-${A}-${z}-1-${q}-StepID`],options:j.Steps.filter(M=>!M.Deleted),modelValue:O.StepID,"onUpdate:modelValue":M=>O.StepID=M},{default:e.withCtx(({index:M,option:G})=>[e.createElementVNode("option",{value:G.ID},e.toDisplayString(String.fromCharCode(65+M))+"."+e.toDisplayString(G.Title),9,lr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(b)?(e.openBlock(),e.createElementBlock("div",or,[j.Schedules.filter(M=>M.Type===1&&!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>r(O),type:"button"},[...f[19]||(f[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>p(j,1),type:"button"},[...f[20]||(f[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,rr)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",ar,[f[24]||(f[24]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Schedules.filter(O=>O.Type===2&&!O.Deleted),(O,q)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:O},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(b)?3:4}`])},[e.createVNode(g,{error:e.unref(V)[`schedule-${A}-${z}-2-${q}-Month`],"empty-value":0,modelValue:O.Month,"onUpdate:modelValue":M=>O.Month=M},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(b)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(V)[`schedule-${A}-${z}-2-${q}-StepID`],options:j.Steps.filter(M=>!M.Deleted),modelValue:O.StepID,"onUpdate:modelValue":M=>O.StepID=M},{default:e.withCtx(({index:M,option:G})=>[e.createElementVNode("option",{value:G.ID},e.toDisplayString(String.fromCharCode(65+M))+"."+e.toDisplayString(G.Title),9,dr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(b)?(e.openBlock(),e.createElementBlock("div",sr,[j.Schedules.filter(M=>M.Type===2&&!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>r(O),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ir)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>p(j,2),type:"button"},[...f[23]||(f[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,cr)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Jn)]))),128))]),e.unref(b)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:j=>s(C),type:"button"},"新增工作項目",8,mr)):e.createCommentVNode("",!0)]))),128))])]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",Vr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=C=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=C=>m(!0)),type:"button"},[...f[26]||(f[26]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-4dad75e0"]]),fr={class:"block"},Nr={class:"mt-4"},ur={class:"table align-middle gray-table side-table"},Er={key:0},br={key:1,class:"text-light-gray"},gr={class:"d-flex flex-column gap-2"},kr={key:0},yr={class:"mt-4"},hr={class:"table align-middle gray-table side-table"},$r={class:"row g-3"},xr={class:"col-12 col-xl-2"},Br={class:"text-gray mb-2"},Cr={class:"col-12 col-xl-3"},_r={class:"text-gray mb-2"},Tr={key:0,class:"col-12 col-xl-4"},wr={class:"row g-1"},Sr={class:"col-7"},Dr={class:"col-5"},Ur={key:1,class:"col-12 col-xl-3"},Ar={class:"text-gray mb-2"},Or={class:"mt-4"},Mr={class:"table align-middle gray-table side-table"},Fr={class:"d-flex align-items-center gap-2"},Ir={class:"input-group w-auto"},jr={key:0,class:"invalid mt-0"},Pr={class:"mt-4"},zr={class:"table-responsive mt-3 mb-0"},qr={class:"table align-middle gray-table"},Lr={class:"text-end"},Rr={class:"text-end"},Jr={class:"text-end"},Gr={class:"text-end"},Qr={class:"text-end"},Wr={class:"table align-middle gray-table side-table"},Yr={key:0,class:"table-responsive mt-3 mb-0"},Hr={class:"table align-middle gray-table"},Zr={key:0},Kr={key:0},Xr={class:"d-flex gap-2"},vr=["onClick"],ea={key:0,class:"block-bottom bg-light-teal"},ta={class:"text-center"},la={class:"mb-5"},oa={__name:"Application",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.ref(),V=e.computed(()=>P("education",l.value.Status,1)),d=e.ref({}),o=e.computed(()=>a.value.filter(m=>!m.Deleted)),l=e.ref({}),n=e.ref(),a=e.ref([]),s=e.ref(),p=e.ref(0),i=e.computed({get:()=>!!o.value.length,set:m=>{m?E():a.value.forEach(t=>t.Deleted=!0)}}),E=()=>a.value.push({}),h=m=>m.Deleted=!0,r=(m,t)=>{if(d.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&s.value&&l.value.ApplyAmount>s.value.GrantLimit*1e4){n.value.show(()=>r(m,!0));return}const c={Project:l.value,Contacts:u.value,ReceivedSubsidies:a.value.filter(f=>f.ID||!f.Deleted),Submit:m?"true":"false"};D.education("saveApplication",c).subscribe(f=>{m?window.location.href=`Attachment.aspx?ID=${f.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${f.ID}`})},N=()=>{let m={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return l.value.OrgCategory==="2"&&(m.RegisteredNum="立案登記證字號"),d.value=U(l.value,m),m={Name:"姓名",JobTitle:"職稱"},Object.assign(d.value,U(u.value[0],m,"contact-0-")),m.MobilePhone="手機號碼",Object.assign(d.value,U(u.value[1],m,"contact-1-")),m={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},a.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`received-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(m=>{b.value=m[0],k.id?D.education("getApplication",{ID:k.id}).subscribe(t=>{l.value=t.Project,u.value=t.Contacts,a.value=t.ReceivedSubsidies,l.value.OrgCategory=l.value.OrgCategory||null,F().education={step:l.value.FormStep,status:l.value.Status,organizer:l.value.Organizer,organizerName:l.value.OrganizerName}}):D.education("getEmptyApplication").subscribe(t=>{l.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),u.value=[{Role:"負責人"},{Role:"聯絡人"}],F().education={step:l.value.FormStep,status:l.value.Status}})})}),e.provide("editable",V),e.watch(()=>l.value.OrgCategory,()=>{D.education("getGrantTargetSetting",{TargetTypeID:`EDC${l.value.OrgCategory}`}).subscribe(m=>{s.value=m})}),e.watchEffect(()=>{p.value=I(l.value.ApplyAmount)+I(l.value.SelfAmount)+I(l.value.OtherGovAmount)+I(l.value.OtherUnitAmount)}),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),_=e.resolveComponent("input-tw-date"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-integer"),w=e.resolveComponent("input-boolean"),g=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fr,[t[47]||(t[47]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Nr,[e.createElementVNode("table",ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[18]||(t[18]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[t[19]||(t[19]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",Er,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",br,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).ProjectName,modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(l).ProjectName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",gr,[e.createElementVNode("div",null,[e.createVNode(S,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(b),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(l).OrgCategory=B)},null,8,["error","options","modelValue"])]),e.unref(l).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",kr,[e.createVNode(f,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(l).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=B=>e.unref(l).RegisteredNum=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":t[3]||(t[3]=B=>e.unref(l).OrgName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(l).TaxID,"onUpdate:modelValue":t[4]||(t[4]=B=>e.unref(l).TaxID=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":t[5]||(t[5]=B=>e.unref(l).Address=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[48]||(t[48]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",yr,[e.createElementVNode("table",hr,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",$r,[e.createElementVNode("div",xr,[e.createElementVNode("div",Br,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-Name`],modelValue:B.Name,"onUpdate:modelValue":A=>B.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Cr,[e.createElementVNode("div",_r,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-JobTitle`],modelValue:B.JobTitle,"onUpdate:modelValue":A=>B.JobTitle=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),C?(e.openBlock(),e.createElementBlock("div",Tr,[t[28]||(t[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",wr,[e.createElementVNode("div",Sr,[e.createVNode(f,{modelValue:B.Phone,"onUpdate:modelValue":A=>B.Phone=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Dr,[e.createVNode(f,{placeholder:"請輸入分機",size:"4",modelValue:B.PhoneExt,"onUpdate:modelValue":A=>B.PhoneExt=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),C?(e.openBlock(),e.createElementBlock("div",Ur,[e.createElementVNode("div",Ar,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-MobilePhone`],modelValue:B.MobilePhone,"onUpdate:modelValue":A=>B.MobilePhone=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[49]||(t[49]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Or,[e.createElementVNode("table",Mr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Fr,[e.createElementVNode("div",Ir,[e.createVNode(_,{class:"w-auto",modelValue:e.unref(l).StartTime,"onUpdate:modelValue":t[6]||(t[6]=B=>e.unref(l).StartTime=B)},null,8,["modelValue"]),t[31]||(t[31]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(_,{class:"w-auto",modelValue:e.unref(l).EndTime,"onUpdate:modelValue":t[7]||(t[7]=B=>e.unref(l).EndTime=B)},null,8,["modelValue"])]),t[32]||(t[32]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",jr,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[33]||(t[33]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Target,modelValue:e.unref(l).Target,"onUpdate:modelValue":t[8]||(t[8]=B=>e.unref(l).Target=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[34]||(t[34]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":t[9]||(t[9]=B=>e.unref(l).Summary=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":t[10]||(t[10]=B=>e.unref(l).Quantified=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[50]||(t[50]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Pr,[t[41]||(t[41]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",zr,[e.createElementVNode("table",qr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Lr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Rr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",Jr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Gr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[40]||(t[40]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=B=>e.unref(l).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=B=>e.unref(l).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).OtherGovAmount,modelValue:e.unref(l).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=B=>e.unref(l).OtherGovAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).OtherUnitAmount,modelValue:e.unref(l).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=B=>e.unref(l).OtherUnitAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",Qr,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])])]),e.createElementVNode("table",Wr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[42]||(t[42]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{modelValue:e.unref(i),"onUpdate:modelValue":t[15]||(t[15]=B=>e.isRef(i)?i.value=B:null)},null,8,["modelValue"]),e.unref(i)?(e.openBlock(),e.createElementBlock("div",Yr,[e.createElementVNode("table",Hr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[43]||(t[43]=e.createElementVNode("th",null,"計畫名稱",-1)),t[44]||(t[44]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Zr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`received-${C}-Name`],modelValue:B.Name,"onUpdate:modelValue":A=>B.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`received-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Kr,[e.createElementVNode("div",Xr,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>h(B),type:"button"},[...t[45]||(t[45]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,vr)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[46]||(t[46]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ea,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[16]||(t[16]=B=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[17]||(t[17]=B=>r(!0)),type:"button"},[...t[51]||(t[51]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(g,{ref_key:"modal",ref:n},{default:e.withCtx(()=>{var B;return[e.createElementVNode("div",ta,[t[52]||(t[52]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",la,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((B=e.unref(s))==null?void 0:B.GrantLimit)+"萬",1),t[53]||(t[53]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[54]||(t[54]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},na={class:"block"},ra={key:0,class:"text-pink lh-base mt-4"},aa={class:"mt-4"},da={class:"table align-middle gray-table"},sa={class:"text-center"},ia={key:0,width:"180"},ca={class:"text-center"},ma={key:0},Va=["innerHTML"],pa={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},fa={key:0,class:"text-center"},Na={key:0},ua={key:1,class:"text-pink"},Ea={key:1,class:"tag-group mt-2 gap-1"},ba={key:0,class:"tag tag-green-light"},ga=["download","href"],ka=["onClick"],ya={key:0,class:"block-bottom bg-light-teal"},ha=["disabled"],$a={__name:"Attachment",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]}]),u=e.computed(()=>b.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("education",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,n=a=>{const s={ID:k.id,Attachments:b.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};D.education("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.education("getAttachment",{ID:k.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,b.value=b.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),b.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),F().education={step:d.value.FormStep,status:d.value.Status,organizer:d.value.Organizer,organizerName:d.value.OrganizerName}})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",na,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",ra,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",aa,[e.createElementVNode("table",da,[e.createElementVNode("thead",sa,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ia,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(E,h)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",ca,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[E.Optional?(e.openBlock(),e.createElementBlock("span",ma,e.toDisplayString(E.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(E.Title),1)]),_:2},1024))]),e.unref(V)&&E.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:E.Comment},null,8,Va)):e.createCommentVNode("",!0),e.unref(V)&&E.Template?(e.openBlock(),e.createElementBlock("button",pa,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",fa,[E.Uploaded?(e.openBlock(),e.createElementBlock("span",Na,"已上傳")):(e.openBlock(),e.createElementBlock("span",ua,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(E.Multiple||!E.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:r=>o(E,r)},null,8,["onFile"])):e.createCommentVNode("",!0),E.Uploaded?(e.openBlock(),e.createElementBlock("div",Ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.Files,r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ba,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(l)(r.Path)},e.toDisplayString(r.Name),9,ga),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>r.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ka)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ya,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=E=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=E=>n(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ha)])):e.createCommentVNode("",!0)],64)}}},xa={__name:"ProgressBar",setup(y){const k=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(b,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:k,type:"education"})}}},Ba={class:"modal-dialog modal-dialog-centered modal-md"},Ca={class:"modal-content"},_a={class:"modal-body"},Ta={class:"d-flex flex-column align-items-center mb-5 gap-3"},wa={class:"fs-18"},Sa={__name:"ErrorModal",setup(y){const k=Q(),b=e.ref();return e.onMounted(()=>b.value.addEventListener("hidden.bs.modal",()=>k.error=null)),e.watch(()=>k.error,()=>{k.error&&bootstrap.Modal.getOrCreateInstance(b.value).show()}),(u,V)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:b,tabindex:"-1"},[e.createElementVNode("div",Ba,[e.createElementVNode("div",Ca,[V[2]||(V[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",_a,[e.createElementVNode("div",Ta,[V[0]||(V[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",wa,e.toDisplayString(e.unref(k).error),1)]),V[1]||(V[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},Da={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const k=e.useModel(y,"modelValue"),b=[{value:!0,text:"是"},{value:!1,text:"否"}];return(u,V)=>{const d=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(d,{options:b,modelValue:k.value,"onUpdate:modelValue":V[0]||(V[0]=o=>k.value=o)},null,8,["modelValue"])}}},Ua=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(y,{emit:k}){const b=e.ref(),u=()=>{Array.from(b.value.files).forEach(d=>D.upload(d).subscribe(o=>V("file",o))),b.value.value=""},V=k;return(d,o)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:o[0]||(o[0]=l=>e.unref(b).click()),type:"button"},[...o[1]||(o[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:u,class:"d-none",ref_key:"input",ref:b,type:"file"},d.$attrs),null,16)],64))}}),Aa=["disabled","placeholder","type"],Oa={key:0,class:"invalid mt-0"},Ma=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const k=e.inject("editable",!0),b=e.useModel(y,"modelValue");return e.watch(b,u=>{if(u){const V=(parseInt(u)||0).toString();u.toString()!==V&&(b.value=V)}}),(u,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(k),placeholder:e.unref(k)?y.placeholder:"",style:{"text-align":"right"},type:y.type},u.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=d=>b.value=d)}),null,16,Aa),[[e.vModelDynamic,b.value]]),y.error?(e.openBlock(),e.createElementBlock("div",Oa,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Fa={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const k=e.useModel(y,"modelValue"),b=[];for(let u=1;u<=12;u++)b.push({value:u,text:`${u}月`});return(u,V)=>{const d=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(d,{options:b,modelValue:k.value,"onUpdate:modelValue":V[0]||(V[0]=o=>k.value=o)},null,8,["modelValue"])}}},Ia=["onChange","checked","disabled","id","value"],ja=["for"],Pa={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>X(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const k=e.inject("editable",!0),b=e.useModel(y,"modelValue"),u=V=>{b.value=V};return(V,d)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,o=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:o},[e.createElementVNode("input",{onChange:l=>u(o[y.valueName]),checked:o[y.valueName]===b.value,class:"form-check-input",disabled:!e.unref(k),id:`${y.id}-${o[y.valueName]}`,type:"radio",value:o[y.valueName]},null,40,Ia),e.createElementVNode("label",{class:"form-check-label",for:`${y.id}-${o[y.valueName]}`},e.toDisplayString(o[y.textName]),9,ja)]))),128))}},za=["disabled"],qa=["value"],La=["value"],Ra={key:0,class:"invalid mt-0"},Ja=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const k=e.inject("editable",!0),b=e.useModel(y,"modelValue");return(u,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:y.disabled||!e.unref(k)},u.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=d=>b.value=d)}),[e.unref(k)&&!b.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:y.emptyValue},e.toDisplayString(y.placeholder),9,qa)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,(d,o)=>e.renderSlot(u.$slots,"default",{key:d,index:o,option:d},()=>[e.createElementVNode("option",{value:d[y.valueName]},e.toDisplayString(d[y.textName]),9,La)])),128))],16,za),[[e.vModelSelect,b.value]]),y.error?(e.openBlock(),e.createElementBlock("div",Ra,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Ga={class:"input-group"},Qa={key:0,class:"input-group-text"},Wa=["disabled","placeholder","type"],Ya={key:0,class:"invalid mt-0"},Ha=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const k=e.inject("editable",!0),b=e.useModel(y,"modelValue"),u=y;return u.maxLength&&e.watch(b,()=>{var V;((V=b.value)==null?void 0:V.length)>u.maxLength&&(b.value=b.value.substring(0,u.maxLength))}),(V,d)=>{const o=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ga,[y.prefix?(e.openBlock(),e.createElementBlock("span",Qa,[e.createVNode(o,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(k),placeholder:e.unref(k)?y.placeholder:"",type:y.type},V.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=l=>b.value=l)}),null,16,Wa),[[e.vModelDynamic,b.value]])]),y.error?(e.openBlock(),e.createElementBlock("div",Ya,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),Za=["disabled","placeholder"],Ka={key:0,class:"fs-14 text-gray mt-2"},Xa={class:"text-pink"},va={key:1,class:"invalid mt-0"},ed=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const k=e.inject("editable",!0),b=e.useModel(y,"modelValue"),u=y;return u.maxLength&&e.watch(b,()=>{var V;((V=b.value)==null?void 0:V.length)>u.maxLength&&(b.value=b.value.substring(0,u.maxLength))}),(V,d)=>{var o;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(k),placeholder:e.unref(k)?y.placeholder:""},V.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=l=>b.value=l)}),null,16,Za),[[e.vModelText,b.value]]),e.unref(k)&&y.maxLength?(e.openBlock(),e.createElementBlock("div",Ka,[d[1]||(d[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Xa,e.toDisplayString(((o=b.value)==null?void 0:o.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(y.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),y.error?(e.openBlock(),e.createElementBlock("div",va,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),td=["disabled"],ld={key:0,class:"invalid"},od=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(y,{emit:k}){let b;const u=y,V=e.ref(),d=e.inject("editable",!0),o=e.ref(),l=k,n=a=>{!a&&u.modelValue&&(a=moment(new Date(u.modelValue))),a?(V.value=a.format(u.displayFormat),l("update:modelValue",a.format(u.format))):(V.value="",l("update:modelValue","")),b.setStartDate(V.value||void 0)};return e.onMounted(()=>{const a=$(o.value);a.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:u.drops,locale:{format:u.displayFormat},maxDate:u.maxDate?new Date(u.maxDate):u.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(s,p)=>n(p.startDate)),b=a.data("daterangepicker"),n()}),e.onUnmounted(()=>b.remove()),e.watch(()=>u.modelValue,()=>n()),(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(d),ref_key:"element",ref:o,type:"text"},a.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=p=>e.isRef(V)?V.value=p:null)}),null,16,td),[[e.vModelText,e.unref(V)]]),y.error?(e.openBlock(),e.createElementBlock("div",ld,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),nd={class:"block"},rd={class:"mt-4"},ad={class:"table align-middle gray-table side-table"},dd={key:0},sd={key:1,class:"text-light-gray"},id={class:"mt-4"},cd={class:"table align-middle gray-table side-table"},md={class:"row g-3"},Vd={class:"col-12 col-xl-2"},pd={class:"text-gray mb-2"},fd={class:"col-12 col-xl-3"},Nd={class:"text-gray mb-2"},ud={class:"col-12 col-xl-4"},Ed={class:"row g-1"},bd={class:"col-7"},gd={class:"col-5"},kd={class:"col-12 col-xl-3"},yd={class:"text-gray mb-2"},hd={class:"col-12"},$d={class:"text-gray mb-2"},xd={class:"mt-4"},Bd={class:"table align-middle gray-table side-table"},Cd={class:"mt-4"},_d={class:"table align-middle gray-table side-table"},Td={key:0,class:"table-responsive mt-3 mb-0"},wd={class:"table align-middle gray-table"},Sd={key:0},Dd={key:0},Ud={class:"d-flex gap-2"},Ad=["onClick"],Od={key:0,class:"block-bottom bg-light-teal"},Md={__name:"Application",props:{id:{type:Number}},setup(y){const k=y,b=e.ref(),u=e.computed(()=>P("literacy",l.value.Status,1)),V=e.ref({}),d=e.ref([]),o=e.computed(()=>n.value.filter(h=>!h.Deleted)),l=e.ref({}),n=e.ref([]),a=e.computed({get:()=>!!o.value.length,set:h=>{h?s():n.value.forEach(r=>r.Deleted=!0)}}),s=()=>n.value.push({}),p=h=>h.Deleted=!0,i=h=>{if(V.value={},h&&!E()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const r={Project:l.value,Contacts:b.value,PreviousStudies:n.value.filter(N=>N.ID||!N.Deleted),Submit:h?"true":"false"};D.literacy("saveApplication",r).subscribe(N=>{h?window.location.href=`WorkSchedule.aspx?ID=${N.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${N.ID}`})},E=()=>{let h={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return V.value=U(l.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},b.value.forEach((r,N)=>Object.assign(V.value,U(r,h,`contact-${N}-`))),h={Title:"研習/課程名稱",TheDate:"辦理日期"},n.value.forEach((r,N)=>Object.assign(V.value,U(r,h,`study-${N}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(h=>{d.value=h[0],k.id?D.literacy("getApplication",{ID:k.id}).subscribe(r=>{l.value=r.Project,b.value=r.Contacts,n.value=r.PreviousStudies,F().literacy={step:l.value.FormStep,status:l.value.Status,organizer:l.value.Organizer,organizerName:l.value.OrganizerName}}):D.literacy("getEmptyApplication").subscribe(r=>{l.value=Object.assign({Field:null,FormStep:1,Status:1},r),b.value=[{Role:"申請人"}],F().literacy={step:l.value.FormStep,status:l.value.Status}})})}),e.provide("editable",u),e.watch(()=>[l.value.Field,l.value.OrgName],()=>{var h;if(u.value){const r=[];l.value.Field&&r.push((h=d.value.find(N=>N.Code===l.value.Field))==null?void 0:h.Descname),l.value.OrgName&&r.push(l.value.OrgName),l.value.ProjectName=r.join("-")}}),(h,r)=>{const N=e.resolveComponent("required-label"),m=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),c=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nd,[r[35]||(r[35]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",rd,[e.createElementVNode("table",ad,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[12]||(r[12]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[r[13]||(r[13]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",dd,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",sd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[r[14]||(r[14]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[15]||(r[15]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{disabled:"",modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":r[0]||(r[0]=_=>e.unref(l).ProjectName=_),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[16]||(r[16]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(V).Field,options:e.unref(d),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).Field,"onUpdate:modelValue":r[1]||(r[1]=_=>e.unref(l).Field=_)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[17]||(r[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":r[2]||(r[2]=_=>e.unref(l).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[18]||(r[18]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).OrgLeader,modelValue:e.unref(l).OrgLeader,"onUpdate:modelValue":r[3]||(r[3]=_=>e.unref(l).OrgLeader=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[19]||(r[19]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":r[4]||(r[4]=_=>e.unref(l).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),r[36]||(r[36]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",id,[e.createElementVNode("table",cd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",md,[e.createElementVNode("div",Vd,[e.createElementVNode("div",pd,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[20]||(r[20]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",fd,[e.createElementVNode("div",Nd,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[21]||(r[21]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":x=>_.JobTitle=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ud,[r[22]||(r[22]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ed,[e.createElementVNode("div",bd,[e.createVNode(m,{modelValue:_.Phone,"onUpdate:modelValue":x=>_.Phone=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",gd,[e.createVNode(m,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":x=>_.PhoneExt=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",kd,[e.createElementVNode("div",yd,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[23]||(r[23]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":x=>_.MobilePhone=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hd,[e.createElementVNode("div",$d,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[24]||(r[24]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":x=>_.EMail=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),r[37]||(r[37]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",xd,[e.createElementVNode("table",Bd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[25]||(r[25]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[r[26]||(r[26]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(c,{error:e.unref(V).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(l).Target,"onUpdate:modelValue":r[5]||(r[5]=_=>e.unref(l).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[27]||(r[27]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(V).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":r[6]||(r[6]=_=>e.unref(l).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[28]||(r[28]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(V).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":r[7]||(r[7]=_=>e.unref(l).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...r[29]||(r[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(V).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Qualitative,"onUpdate:modelValue":r[8]||(r[8]=_=>e.unref(l).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Cd,[e.createElementVNode("table",_d,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[34]||(r[34]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(a),"onUpdate:modelValue":r[9]||(r[9]=_=>e.isRef(a)?a.value=_:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Td,[e.createElementVNode("table",wd,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[r[30]||(r[30]=e.createElementVNode("th",null,"研習/課程名稱",-1)),r[31]||(r[31]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Sd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V)[`study-${T}-Title`],modelValue:_.Title,"onUpdate:modelValue":x=>_.Title=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`study-${T}-TheDate`],modelValue:_.TheDate,"onUpdate:modelValue":x=>_.TheDate=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Dd,[e.createElementVNode("div",Ud,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:x=>p(_),type:"button"},[...r[32]||(r[32]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ad)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...r[33]||(r[33]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Od,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[10]||(r[10]=_=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[11]||(r[11]=_=>i(!0)),type:"button"},[...r[38]||(r[38]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Fd={class:"block"},Id={key:0,class:"text-pink lh-base mt-4"},jd={class:"mt-4"},Pd={class:"table align-middle gray-table"},zd={class:"text-center"},qd={key:0,width:"180"},Ld={class:"text-center"},Rd={key:0},Jd=["innerHTML"],Gd={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Qd={key:0,class:"text-center"},Wd={key:0},Yd={key:1,class:"text-pink"},Hd={key:1,class:"tag-group mt-2 gap-1"},Zd={key:0,class:"tag tag-green-light"},Kd=["download","href"],Xd=["onClick"],vd={key:0,class:"block-bottom bg-light-teal"},es=["disabled"],ts={__name:"Attachment",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"著作權授權同意書",Template:!0,Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),u=e.computed(()=>b.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("literacy",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,n=a=>{const s={ID:k.id,Attachments:b.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};D.literacy("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getAttachment",{ID:k.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,b.value=b.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),b.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),F().literacy={step:d.value.FormStep,status:d.value.Status,organizer:d.value.Organizer,organizerName:d.value.OrganizerName}})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Fd,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",Id,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",jd,[e.createElementVNode("table",Pd,[e.createElementVNode("thead",zd,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",qd,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(E,h)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",Ld,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[E.Optional?(e.openBlock(),e.createElementBlock("span",Rd,e.toDisplayString(E.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(E.Title),1)]),_:2},1024))]),e.unref(V)&&E.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:E.Comment},null,8,Jd)):e.createCommentVNode("",!0),e.unref(V)&&E.Template?(e.openBlock(),e.createElementBlock("button",Gd,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Qd,[E.Uploaded?(e.openBlock(),e.createElementBlock("span",Wd,"已上傳")):(e.openBlock(),e.createElementBlock("span",Yd,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(E.Multiple||!E.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:r=>o(E,r)},null,8,["onFile"])):e.createCommentVNode("",!0),E.Uploaded?(e.openBlock(),e.createElementBlock("div",Hd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.Files,r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Zd,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(l)(r.Path)},e.toDisplayString(r.Name),9,Kd),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>r.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xd)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",vd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=E=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=E=>n(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,es)])):e.createCommentVNode("",!0)],64)}}},ls={class:"block"},os={class:"mt-4"},ns={class:"table-responsive mt-3 mb-0"},rs={class:"table align-middle gray-table"},as={key:0,width:"1"},ds={key:0},ss={class:"d-flex gap-2"},is=["onClick"],cs={class:"table-responsive mt-3 mb-0"},ms={class:"table align-middle gray-table"},Vs={key:0,class:"block-bottom bg-light-teal"},ps={__name:"Benefit",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.computed(()=>P("literacy",o.value.Status,4)),V=e.ref({}),d=e.computed(()=>b.value.filter(p=>!p.Deleted)),o=e.ref({}),l=()=>b.value.push({}),n=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var E;return(E=document.querySelector(".invalid"))==null?void 0:E.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:o.value,Benefits:b.value,Submit:p?"true":"false"};D.literacy("saveBenefit",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${k.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((i,E)=>Object.assign(V.value,U(i,p,`item-${E}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getBenefit",{ID:k.id})]).subscribe(p=>{const i=p[0];o.value=i.Project,b.value=i.Benefits,b.value.length||l(),F().literacy={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",u),(p,i)=>{const E=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ls,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",os,[e.createElementVNode("div",ns,[e.createElementVNode("table",rs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[3]||(i[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),i[4]||(i[4]=e.createElementVNode("th",null,"目標值",-1)),i[5]||(i[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",as,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(r,N)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(V)[`item-${N}-Title`],modelValue:r.Title,"onUpdate:modelValue":m=>r.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(V)[`item-${N}-Target`],modelValue:r.Target,"onUpdate:modelValue":m=>r.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:r.Description,"onUpdate:modelValue":m=>r.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",ds,[e.createElementVNode("div",ss,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>n(r),type:"button"},[...i[6]||(i[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,is)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...i[7]||(i[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",cs,[e.createElementVNode("table",ms,[i[8]||(i[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":i[0]||(i[0]=r=>e.unref(o).Benefit=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Vs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[1]||(i[1]=r=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[2]||(i[2]=r=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},fs={class:"block"},Ns={class:"mt-4"},us={class:"table-responsive mt-3 mb-0"},Es={class:"table align-middle gray-table"},bs={class:"text-end"},gs={class:"text-end"},ks={class:"table-responsive"},ys={class:"table align-middle gray-table"},hs=["colspan"],$s={key:0,width:"1"},xs={class:"text-end"},Bs={key:0},Cs={class:"d-flex gap-2"},_s=["onClick"],Ts={class:"mt-4"},ws={class:"table-responsive mt-3 mb-0"},Ss={class:"table align-middle gray-table"},Ds={key:0,width:"1"},Us={class:"text-end"},As={key:0},Os={class:"d-flex gap-2"},Ms=["onClick"],Fs={key:0,class:"block-bottom bg-light-teal"},Is={class:"text-center"},js={class:"mb-5"},Ps={__name:"Funding",props:{id:{type:Number}},setup(y){const k=y,b=e.computed(()=>P("literacy",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>n.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),o=e.ref({}),l=e.ref(),n=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),i=()=>n.value.push({}),E=()=>a.value.push({}),h=m=>m.Deleted=!0,r=(m,t)=>{if(u.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>r(m,!0));return}const c={Project:o.value,OtherSubsidies:n.value,BudgetPlans:a.value,Submit:m?"true":"false"};D.literacy("saveFunding",c).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${k.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},n.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`other-${c}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`plan-${c}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getFunding",{ID:k.id})]).subscribe(m=>{const t=m[0];o.value=t.Project,n.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,n.value.length||i(),a.value.length||E(),F().literacy={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",b),e.watchEffect(()=>{o.value.OtherAmount=V.value.reduce((m,t)=>m+I(t.Amount),0),p.value=I(o.value.ApplyAmount)+I(o.value.SelfAmount)+I(o.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(I(m.Amount)/o.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=I(m.Amount)+I(m.OtherAmount))}),(m,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fs,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Ns,[e.createElementVNode("div",us,[e.createElementVNode("table",Es,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(o).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(o).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",bs,e.toDisplayString((T=e.unref(o).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",gs,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",ks,[e.createElementVNode("table",ys,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(b)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,hs)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",$s,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":g=>x.Unit=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":g=>x.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",xs,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":g=>x.Content=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",Bs,[e.createElementVNode("div",Cs,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:g=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,_s)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("div",ws,[e.createElementVNode("table",Ss,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",Ds,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":g=>x.Title=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":g=>x.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":g=>x.OtherAmount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Us,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":g=>x.Description=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",As,[e.createElementVNode("div",Os,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:g=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ms)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",Fs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>r(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",Is,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",js,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},zs={__name:"ProgressBar",setup(y){const k=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(b,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:k,type:"literacy"})}}},qs={class:"block"},Ls={class:"mt-4"},Rs={class:"table align-middle gray-table side-table"},Js={key:0,class:"d-flex align-items-center gap-2"},Gs={class:"input-group w-auto"},Qs={class:"text-teal-dark"},Ws={key:1,class:"invalid mt-0"},Ys={class:"table-responsive mt-4"},Hs={class:"table align-middle gray-table"},Zs={key:0},Ks={class:"input-group"},Xs={key:0,class:"invalid mt-0"},vs={key:0},ei={class:"d-flex gap-2"},ti=["onClick"],li={class:"mt-4"},oi={class:"table align-middle gray-table"},ni={key:0},ri={key:0},ai={class:"d-flex gap-2"},di=["onClick"],si={key:0,class:"block-bottom bg-light-teal"},ii={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const k=y,b=[{value:1,text:"50%"},{value:2,text:"100%"}],u=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("literacy",n.value.Status,2)),d=e.ref({}),o=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),n=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),i=()=>D.literacy("createItem",{ID:k.id}).subscribe(m=>s.value.push(m)),E=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,r=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};D.literacy("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${k.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(n.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`item-${c}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`schedule-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.literacy("getWorkSchedule",{ID:k.id})]).subscribe(m=>{const t=m[0];n.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||i(),p.value.length||E(),F().literacy={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",V),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",qs,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Ls,[e.createElementVNode("table",Rs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",Js,[e.createElementVNode("div",Gs,[e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(n).StartTime,"onUpdate:modelValue":t[0]||(t[0]=g=>e.unref(n).StartTime=g)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(n).EndTime,"onUpdate:modelValue":t[1]||(t[1]=g=>e.unref(n).EndTime=g)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Qs,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(u)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",Ws,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Ys,[e.createElementVNode("table",Hs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Zs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:g.Title,"onUpdate:modelValue":C=>g.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Ks,[e.createVNode(T,{"empty-value":0,modelValue:g.Begin,"onUpdate:modelValue":C=>g.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:g.End,"onUpdate:modelValue":C=>g.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",Xs,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:g.Deadline,"onUpdate:modelValue":C=>g.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:g.Content,"onUpdate:modelValue":C=>g.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",vs,[e.createElementVNode("div",ei,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(g),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ti)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",li,[e.createElementVNode("table",oi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ni,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:b,modelValue:g.Type,"onUpdate:modelValue":C=>g.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:g.ItemID,"onUpdate:modelValue":C=>g.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(g.ItemID?String.fromCharCode(65+e.unref(o).findIndex(C=>C.ID===g.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:g.Deadline,"onUpdate:modelValue":C=>g.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:g.Content,"onUpdate:modelValue":C=>g.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",ri,[e.createElementVNode("div",ai,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(g),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,di)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",si,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=g=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=g=>r(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ci={class:"block"},mi={class:"mt-4"},Vi={class:"table align-middle gray-table side-table"},pi={key:0},fi={key:1,class:"text-light-gray"},Ni={class:"mt-4"},ui={class:"table align-middle gray-table side-table"},Ei={class:"row g-3"},bi={class:"col-12 col-xl-2"},gi={class:"text-gray mb-2"},ki={class:"col-12 col-xl-3"},yi={class:"text-gray mb-2"},hi={class:"col-12 col-xl-4"},$i={class:"row g-1"},xi={class:"col-7"},Bi={class:"col-5"},Ci={class:"col-12 col-xl-3"},_i={class:"text-gray mb-2"},Ti={class:"col-12"},wi={class:"text-gray mb-2"},Si={class:"mt-4"},Di={class:"table align-middle gray-table side-table"},Ui={class:"mt-4"},Ai={class:"table align-middle gray-table side-table"},Oi={key:0,class:"table-responsive mt-3 mb-0"},Mi={class:"table align-middle gray-table"},Fi={key:0},Ii={key:0},ji={class:"d-flex gap-2"},Pi=["onClick"],zi={key:0,class:"block-bottom bg-light-teal"},qi={__name:"Application",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.ref(),V=e.computed(()=>P("multiple",n.value.Status,1)),d=e.ref({}),o=e.ref([]),l=e.computed(()=>a.value.filter(r=>!r.Deleted)),n=e.ref({}),a=e.ref([]),s=e.computed({get:()=>!!l.value.length,set:r=>{r?p():a.value.forEach(N=>N.Deleted=!0)}}),p=()=>a.value.push({}),i=r=>r.Deleted=!0,E=r=>{if(d.value={},r&&!h()){e.nextTick(()=>{var m;return(m=document.querySelector(".invalid"))==null?void 0:m.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:n.value,Contacts:u.value,ReceivedSubsidies:a.value.filter(m=>m.ID||!m.Deleted),Submit:r?"true":"false"};D.multiple("saveApplication",N).subscribe(m=>{r?window.location.href=`WorkSchedule.aspx?ID=${m.ID}`:n.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${m.ID}`})},h=()=>{let r={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value=U(n.value,r),r={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((N,m)=>Object.assign(d.value,U(N,r,`contact-${m}-`))),r={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},a.value.forEach((N,m)=>Object.assign(d.value,U(N,r,`received-${m}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getZgsCodes",{CodeGroup:"MULField"}),D.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(r=>{o.value=r[0],b.value=r[1],k.id?D.multiple("getApplication",{ID:k.id}).subscribe(N=>{n.value=N.Project,u.value=N.Contacts,a.value=N.ReceivedSubsidies,n.value.OrgCategory=n.value.OrgCategory||null,F().multiple={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}}):D.multiple("getEmptyApplication").subscribe(N=>{n.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},N),u.value=[{Role:"負責人"},{Role:"聯絡人"}],F().multiple={step:n.value.FormStep,status:n.value.Status}})})}),e.provide("editable",V),(r,N)=>{const m=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),c=e.resolveComponent("input-select"),f=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-boolean"),_=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ci,[N[38]||(N[38]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",mi,[e.createElementVNode("table",Vi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[13]||(N[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(n).Year),1)]),e.createElementVNode("tr",null,[N[14]||(N[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(n).ProjectID?(e.openBlock(),e.createElementBlock("span",pi,e.toDisplayString(e.unref(n).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",fi,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(n).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[16]||(N[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).ProjectName,modelValue:e.unref(n).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=T=>e.unref(n).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[17]||(N[17]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{"empty-value":null,error:e.unref(d).Field,options:e.unref(o),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n).Field,"onUpdate:modelValue":N[1]||(N[1]=T=>e.unref(n).Field=T)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(n).OrgName,"onUpdate:modelValue":N[2]||(N[2]=T=>e.unref(n).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(b),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n).OrgCategory,"onUpdate:modelValue":N[3]||(N[3]=T=>e.unref(n).OrgCategory=T)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(n).TaxID,"onUpdate:modelValue":N[4]||(N[4]=T=>e.unref(n).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(n).Address,"onUpdate:modelValue":N[5]||(N[5]=T=>e.unref(n).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[39]||(N[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ni,[e.createElementVNode("table",ui,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(T,x)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ei,[e.createElementVNode("div",bi,[e.createElementVNode("div",gi,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-Name`],modelValue:T.Name,"onUpdate:modelValue":w=>T.Name=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ki,[e.createElementVNode("div",yi,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":w=>T.JobTitle=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hi,[N[24]||(N[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",$i,[e.createElementVNode("div",xi,[e.createVNode(t,{modelValue:T.Phone,"onUpdate:modelValue":w=>T.Phone=w,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Bi,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":w=>T.PhoneExt=w,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Ci,[e.createElementVNode("div",_i,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[25]||(N[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":w=>T.MobilePhone=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ti,[e.createElementVNode("div",wi,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-EMail`],modelValue:T.EMail,"onUpdate:modelValue":w=>T.EMail=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[40]||(N[40]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Si,[e.createElementVNode("table",Di,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[28]||(N[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(f,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(n).Target,"onUpdate:modelValue":N[6]||(N[6]=T=>e.unref(n).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[29]||(N[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(n).Summary,"onUpdate:modelValue":N[7]||(N[7]=T=>e.unref(n).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(n).Quantified,"onUpdate:modelValue":N[8]||(N[8]=T=>e.unref(n).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(n).Qualitative,"onUpdate:modelValue":N[9]||(N[9]=T=>e.unref(n).Qualitative=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Ui,[e.createElementVNode("table",Ai,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[37]||(N[37]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(S,{modelValue:e.unref(s),"onUpdate:modelValue":N[10]||(N[10]=T=>e.isRef(s)?s.value=T:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Oi,[e.createElementVNode("table",Mi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[32]||(N[32]=e.createElementVNode("th",null,"計畫名稱",-1)),N[33]||(N[33]=e.createElementVNode("th",null,"補助單位",-1)),N[34]||(N[34]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Fi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,x)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d)[`received-${x}-Name`],modelValue:T.Name,"onUpdate:modelValue":w=>T.Name=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d)[`received-${x}-Unit`],modelValue:T.Unit,"onUpdate:modelValue":w=>T.Unit=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`received-${x}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":w=>T.Amount=w},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Ii,[e.createElementVNode("div",ji,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:w=>i(T),type:"button"},[...N[35]||(N[35]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Pi)):e.createCommentVNode("",!0),x+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...N[36]||(N[36]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",zi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[11]||(N[11]=T=>E()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[12]||(N[12]=T=>E(!0)),type:"button"},[...N[41]||(N[41]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Li={class:"block"},Ri={key:0,class:"text-pink lh-base mt-4"},Ji={class:"mt-4"},Gi={class:"table align-middle gray-table"},Qi={class:"text-center"},Wi={key:0,width:"180"},Yi={class:"text-center"},Hi={key:0},Zi=["innerHTML"],Ki={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Xi={key:0,class:"text-center"},vi={key:0},ec={key:1,class:"text-pink"},tc={key:1,class:"tag-group mt-2 gap-1"},lc={key:0,class:"tag tag-green-light"},oc=["download","href"],nc=["onClick"],rc={key:0,class:"block-bottom bg-light-teal"},ac=["disabled"],dc={__name:"Attachment",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),u=e.computed(()=>b.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("multiple",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=D.download,n=a=>{const s={ID:k.id,Attachments:b.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};D.multiple("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getAttachment",{ID:k.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,b.value=b.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),d.value.Status>=10&&b.value.push({Type:6,Title:"著作權授權同意書",Template:!0,Files:[]}),b.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),F().multiple={step:d.value.FormStep,status:d.value.Status,organizer:d.value.Organizer,organizerName:d.value.OrganizerName}})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Li,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",Ri,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Ji,[e.createElementVNode("table",Gi,[e.createElementVNode("thead",Qi,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Wi,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(b),(E,h)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",Yi,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[E.Optional?(e.openBlock(),e.createElementBlock("span",Hi,e.toDisplayString(E.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(E.Title),1)]),_:2},1024))]),e.unref(V)&&E.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:E.Comment},null,8,Zi)):e.createCommentVNode("",!0),e.unref(V)&&E.Template?(e.openBlock(),e.createElementBlock("button",Ki,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Xi,[E.Uploaded?(e.openBlock(),e.createElementBlock("span",vi,"已上傳")):(e.openBlock(),e.createElementBlock("span",ec,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(E.Multiple||!E.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:r=>o(E,r)},null,8,["onFile"])):e.createCommentVNode("",!0),E.Uploaded?(e.openBlock(),e.createElementBlock("div",tc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E.Files,r=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:r},[r.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",lc,[e.createElementVNode("a",{class:"tag-link my-1",download:r.Name,href:e.unref(l)(r.Path)},e.toDisplayString(r.Name),9,oc),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>r.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,nc)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",rc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=E=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=E=>n(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ac)])):e.createCommentVNode("",!0)],64)}}},sc={class:"block"},ic={class:"mt-4"},cc={class:"table-responsive mt-3 mb-0"},mc={class:"table align-middle gray-table"},Vc={key:0,width:"1"},pc={key:0},fc={class:"d-flex gap-2"},Nc=["onClick"],uc={class:"table-responsive mt-3 mb-0"},Ec={class:"table align-middle gray-table"},bc={key:0,class:"block-bottom bg-light-teal"},gc={__name:"Benefit",props:{id:{type:Number}},setup(y){const k=y,b=e.ref([]),u=e.computed(()=>P("multiple",o.value.Status,4)),V=e.ref({}),d=e.computed(()=>b.value.filter(p=>!p.Deleted)),o=e.ref({}),l=()=>b.value.push({}),n=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var E;return(E=document.querySelector(".invalid"))==null?void 0:E.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:o.value,Benefits:b.value,Submit:p?"true":"false"};D.multiple("saveBenefit",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${k.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((i,E)=>Object.assign(V.value,U(i,p,`item-${E}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getBenefit",{ID:k.id})]).subscribe(p=>{const i=p[0];o.value=i.Project,b.value=i.Benefits,b.value.length||l(),F().multiple={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",u),(p,i)=>{const E=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",sc,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",ic,[e.createElementVNode("div",cc,[e.createElementVNode("table",mc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[3]||(i[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),i[4]||(i[4]=e.createElementVNode("th",null,"目標值",-1)),i[5]||(i[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Vc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(r,N)=>(e.openBlock(),e.createElementBlock("tr",{key:r},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(V)[`item-${N}-Title`],modelValue:r.Title,"onUpdate:modelValue":m=>r.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(V)[`item-${N}-Target`],modelValue:r.Target,"onUpdate:modelValue":m=>r.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:r.Description,"onUpdate:modelValue":m=>r.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",pc,[e.createElementVNode("div",fc,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>n(r),type:"button"},[...i[6]||(i[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Nc)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...i[7]||(i[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",uc,[e.createElementVNode("table",Ec,[i[8]||(i[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":i[0]||(i[0]=r=>e.unref(o).Benefit=r),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",bc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[1]||(i[1]=r=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[2]||(i[2]=r=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},kc={class:"block"},yc={class:"mt-4"},hc={class:"table-responsive mt-3 mb-0"},$c={class:"table align-middle gray-table"},xc={class:"text-end"},Bc={class:"text-end"},Cc={class:"table-responsive"},_c={class:"table align-middle gray-table"},Tc=["colspan"],wc={key:0,width:"1"},Sc={class:"text-end"},Dc={key:0},Uc={class:"d-flex gap-2"},Ac=["onClick"],Oc={class:"mt-4"},Mc={class:"table-responsive mt-3 mb-0"},Fc={class:"table align-middle gray-table"},Ic={key:0,width:"1"},jc={class:"text-end"},Pc={key:0},zc={class:"d-flex gap-2"},qc=["onClick"],Lc={key:0,class:"block-bottom bg-light-teal"},Rc={class:"text-center"},Jc={class:"mb-5"},Gc={__name:"Funding",props:{id:{type:Number}},setup(y){const k=y,b=e.computed(()=>P("multiple",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>n.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),o=e.ref({}),l=e.ref(),n=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),i=()=>n.value.push({}),E=()=>a.value.push({}),h=m=>m.Deleted=!0,r=(m,t)=>{if(u.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>r(m,!0));return}const c={Project:o.value,OtherSubsidies:n.value,BudgetPlans:a.value,Submit:m?"true":"false"};D.multiple("saveFunding",c).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${k.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},n.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`other-${c}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`plan-${c}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getFunding",{ID:k.id})]).subscribe(m=>{const t=m[0];o.value=t.Project,n.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,n.value.length||i(),a.value.length||E(),F().multiple={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",b),e.watchEffect(()=>{o.value.OtherAmount=V.value.reduce((m,t)=>m+I(t.Amount),0),p.value=I(o.value.ApplyAmount)+I(o.value.SelfAmount)+I(o.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(I(m.Amount)/o.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=I(m.Amount)+I(m.OtherAmount))}),(m,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",kc,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",yc,[e.createElementVNode("div",hc,[e.createElementVNode("table",$c,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(o).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(o).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",xc,e.toDisplayString((T=e.unref(o).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",Bc,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Cc,[e.createElementVNode("table",_c,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(b)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Tc)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",wc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":g=>x.Unit=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":g=>x.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Sc,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":g=>x.Content=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",Dc,[e.createElementVNode("div",Uc,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:g=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ac)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Oc,[e.createElementVNode("div",Mc,[e.createElementVNode("table",Fc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(b)?(e.openBlock(),e.createElementBlock("th",Ic,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":g=>x.Title=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":g=>x.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":g=>x.OtherAmount=g},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",jc,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(u)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":g=>x.Description=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(b)?(e.openBlock(),e.createElementBlock("td",Pc,[e.createElementVNode("div",zc,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:g=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,qc)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",Lc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>r(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",Rc,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Jc,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Qc={__name:"ProgressBar",setup(y){const k=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(b,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:k,type:"multiple"})}}},Wc={class:"block"},Yc={class:"mt-4"},Hc={class:"table align-middle gray-table side-table"},Zc={key:0,class:"d-flex align-items-center gap-2"},Kc={class:"input-group w-auto"},Xc={class:"text-teal-dark"},vc={key:1,class:"invalid mt-0"},em={class:"table-responsive mt-4"},tm={class:"table align-middle gray-table"},lm={key:0},om={class:"input-group"},nm={key:0,class:"invalid mt-0"},rm={key:0},am={class:"d-flex gap-2"},dm=["onClick"],sm={class:"mt-4"},im={class:"table align-middle gray-table"},cm={key:0},mm={key:0},Vm={class:"d-flex gap-2"},pm=["onClick"],fm={key:0,class:"block-bottom bg-light-teal"},Nm={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const k=y,b=[{value:1,text:"50%"},{value:2,text:"100%"}],u=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("multiple",n.value.Status,2)),d=e.ref({}),o=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),n=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),i=()=>D.multiple("createItem",{ID:k.id}).subscribe(m=>s.value.push(m)),E=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,r=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};D.multiple("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${k.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(n.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`item-${c}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`schedule-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([D.multiple("getWorkSchedule",{ID:k.id})]).subscribe(m=>{const t=m[0];n.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||i(),p.value.length||E(),F().multiple={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",V),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wc,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Yc,[e.createElementVNode("table",Hc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",Zc,[e.createElementVNode("div",Kc,[e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(n).StartTime,"onUpdate:modelValue":t[0]||(t[0]=g=>e.unref(n).StartTime=g)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(n).EndTime,"onUpdate:modelValue":t[1]||(t[1]=g=>e.unref(n).EndTime=g)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Xc,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(u)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",vc,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",em,[e.createElementVNode("table",tm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",lm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:g.Title,"onUpdate:modelValue":C=>g.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",om,[e.createVNode(T,{"empty-value":0,modelValue:g.Begin,"onUpdate:modelValue":C=>g.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:g.End,"onUpdate:modelValue":C=>g.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",nm,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:g.Deadline,"onUpdate:modelValue":C=>g.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:g.Content,"onUpdate:modelValue":C=>g.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",rm,[e.createElementVNode("div",am,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(g),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,dm)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",sm,[e.createElementVNode("table",im,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",cm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:b,modelValue:g.Type,"onUpdate:modelValue":C=>g.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:g.ItemID,"onUpdate:modelValue":C=>g.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(g.ItemID?String.fromCharCode(65+e.unref(o).findIndex(C=>C.ID===g.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:g.Deadline,"onUpdate:modelValue":C=>g.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:g.Content,"onUpdate:modelValue":C=>g.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",mm,[e.createElementVNode("div",Vm,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(g),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pm)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",fm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=g=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=g=>r(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},um={key:0,class:"scroll-bottom-panel"},Em={class:"d-flex flex-column gap-3 mb-3"},bm={class:"d-flex gap-2"},gm={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},km={class:"text-nowrap my-2 d-flex align-items-center"},ym={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(y){const k=y,b=F(),u=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],V=e.ref({}),d=e.ref({ID:k.id,Result:1}),o=()=>{const n={};if(d.value.Result>1&&(n.Reason="原因"),V.value=U(d.value,n),Object.keys(V.value).length){l();return}D[k.type]("reviewApplication",d.value).subscribe(a=>{})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>d.value.Result,n=>{n>1&&l()}),(n,a)=>{const s=e.resolveComponent("input-radio-group"),p=e.resolveComponent("input-textarea");return e.unref(b)[y.type].organizer?(e.openBlock(),e.createElementBlock("div",um,[a[3]||(a[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Em,[e.createElementVNode("li",bm,[a[2]||(a[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",gm,[e.createElementVNode("div",km,[e.createVNode(s,{options:u,modelValue:e.unref(d).Result,"onUpdate:modelValue":a[0]||(a[0]=i=>e.unref(d).Result=i)},null,8,["modelValue"])]),e.unref(d).Result>1?(e.openBlock(),e.createBlock(p,{key:0,error:e.unref(V).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(d).Reason,"onUpdate:modelValue":a[1]||(a[1]=i=>e.unref(d).Reason=i)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:o,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},hm={class:"d-flex align-items-center gap-3"},$m={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},xm={class:"modal-content"},Bm={class:"modal-header"},Cm={class:"fs-24 fw-bold text-green-light"},_m={class:"modal-body"},Tm={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},wm=["disabled"],Sm={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(y){const k=y,b=e.computed(()=>!d.value||d.value===l[k.type].organizer),u=e.ref(),V=e.computed(()=>l[k.type].organizerName),d=e.ref(0),o=e.computed(()=>{var E;return(E=s.value.find(h=>h.UnitID===a.value))==null?void 0:E.reviewers}),l=F(),n=e.computed(()=>V.value?"移轉案件":"認領案件"),a=e.ref(0),s=e.ref([]),p=()=>{D[k.type]("queryReviewUnits").subscribe(E=>{s.value=E,rxjs.forkJoin(s.value.map(h=>D[k.type]("queryReviewersByUnit",{ID:h.UnitID}))).subscribe(h=>{h.forEach((r,N)=>{s.value[N].reviewers=r,r.some(m=>m.UserID===d.value)&&(a.value=s.value[N].UnitID)}),bootstrap.Modal.getOrCreateInstance(u.value).show()})})},i=()=>{D[k.type]("saveOrganizer",{ID:k.id,Organizer:d.value}).subscribe(E=>{E&&window.location.reload()})};return e.watch(V,()=>d.value=l[k.type].organizer),e.watch(a,()=>{o.value.some(E=>E.UserID===d.value)||(d.value=0)}),(E,h)=>{const r=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hm,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(V)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:p,type:"button"},e.toDisplayString(e.unref(n)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:u,tabindex:"-1"},[e.createElementVNode("div",$m,[e.createElementVNode("div",xm,[e.createElementVNode("div",Bm,[e.createElementVNode("h4",Cm,e.toDisplayString(e.unref(n)),1),h[2]||(h[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",_m,[e.createElementVNode("div",null,[h[3]||(h[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(r,{"empty-value":0,options:e.unref(s),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(a),"onUpdate:modelValue":h[0]||(h[0]=N=>e.isRef(a)?a.value=N:null)},null,8,["options","modelValue"]),e.createVNode(r,{class:"mt-2","empty-value":0,options:e.unref(o),"text-name":"Name","value-name":"UserID",modelValue:e.unref(d),"onUpdate:modelValue":h[1]||(h[1]=N=>e.isRef(d)?d.value=N:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",Tm,[h[4]||(h[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:i,disabled:e.unref(b),type:"button"},"確認",8,wm)])])])])],512)]))],64)}}},Dm={key:0,class:"scroll-bottom-panel"},Um={class:"d-flex flex-column gap-3 mb-3"},Am={class:"d-flex gap-2"},Om={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Mm={class:"text-nowrap mb-2 d-flex align-items-center"},Fm={key:0,class:"invalid mt-0"},Im={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(y){const k=y,b=F(),u=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],V=e.ref({}),d=e.ref({ID:k.id,Result:1}),o=()=>{},l=()=>{},n=()=>{const s={};if(d.value.Result>1&&(s.Reason="原因"),d.value.Result===3&&(s.CorrectionDeadline="補正期限"),V.value=U(d.value,s),Object.keys(V.value).length){a();return}D[k.type]("reviewApplication",d.value).subscribe(p=>{})},a=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>d.value.Result,s=>{s>1&&a()}),(s,p)=>{const i=e.resolveComponent("input-radio-group"),E=e.resolveComponent("input-tw-date"),h=e.resolveComponent("input-textarea");return e.unref(b)[y.type].organizer?(e.openBlock(),e.createElementBlock("div",Dm,[p[9]||(p[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Um,[e.createElementVNode("li",{class:"d-flex gap-2"},[p[3]||(p[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:o,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[p[6]||(p[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),p[7]||(p[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[p[4]||(p[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:l,href:"javascript:void(0)"},"1"),p[5]||(p[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",Am,[p[8]||(p[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Om,[e.createElementVNode("div",Mm,[e.createVNode(i,{options:u,modelValue:e.unref(d).Result,"onUpdate:modelValue":p[0]||(p[0]=r=>e.unref(d).Result=r)},null,8,["modelValue"]),e.createVNode(E,{class:"form-control",drops:"up",modelValue:e.unref(d).CorrectionDeadline,"onUpdate:modelValue":p[1]||(p[1]=r=>e.unref(d).CorrectionDeadline=r)},null,8,["modelValue"])]),e.unref(V).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",Fm,e.toDisplayString(e.unref(V).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(d).Result>1?(e.openBlock(),e.createBlock(h,{key:1,error:e.unref(V).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(d).Reason,"onUpdate:modelValue":p[2]||(p[2]=r=>e.unref(d).Reason=r)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:n,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},jm={key:0,class:"text-pink"},Z={AccessibilityApplication:Ge,AccessibilityAttachment:mt,AccessibilityBenefit:$t,AccessibilityFunding:Ht,AccessibilityProgressBar:Zt,AccessibilityWorkSchedule:gl,ConfirmModal:Bl,CommonProgressBar:Ul,CultureApplication:No,CultureAttachment:Mo,CultureFunding:an,CultureOther:yn,CultureProgressBar:hn,CultureWorkSchedule:pr,EducationApplication:oa,EducationAttachment:$a,EducationProgressBar:xa,ErrorModal:Sa,InputBoolean:Da,InputFile:Ua,InputInteger:Ma,InputMonth:Fa,InputRadioGroup:Pa,InputSelect:Ja,InputText:Ha,InputTextarea:ed,InputTwDate:od,LiteracyApplication:Md,LiteracyAttachment:ts,LiteracyBenefit:ps,LiteracyFunding:Ps,LiteracyProgressBar:zs,LiteracyWorkSchedule:ii,MultipleApplication:qi,MultipleAttachment:dc,MultipleBenefit:gc,MultipleFunding:Gc,MultipleProgressBar:Qc,MultipleWorkSchedule:Nm,ProjectCorrectionReview:ym,ProjectOrganizer:Sm,ProjectReview:Im,RequiredLabel:{__name:"RequiredLabel",setup(y){const k=e.inject("editable",!0);return(b,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(k)?(e.openBlock(),e.createElementBlock("span",jm,"* ")):e.createCommentVNode("",!0),e.renderSlot(b.$slots,"default")],64))}},TwDate:{__name:"TwDate",props:{value:{default:null,type:String}},setup(y){const k=y,b=V=>{const d=V==null?void 0:V.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return d?`${parseInt(d[1],10)-1911}/${d[2]}/${d[3]}`:""},u=e.ref(b(k.value));return e.watch(()=>k.value,V=>u.value=b(V)),(V,d)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(u)),1))}}};return{install:y=>{for(const k in Z)y.component(k,Z[k])},useProgressStore:F}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
