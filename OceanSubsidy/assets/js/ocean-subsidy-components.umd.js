(function(e,H){typeof exports=="object"&&typeof module<"u"?module.exports=H(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],H):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=H(e.Vue,e.Pinia))})(this,(function(e,H){"use strict";const P=H.defineStore("progress",{actions:{init(B,_){var u,m;this[B]={id:_.ProjectID,type:(u=_.SubsidyPlanType)==null?void 0:u.split(" ")[0],name:_.ProjectName,step:_.FormStep,status:_.Status,progress:_.ProgressStatus,changeStatus:(m=_.changeApply)==null?void 0:m.Status,organizer:_.Organizer,organizerName:_.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})});let ne=Date.now();const z=(B,_,u)=>{const m=P();if([1,14].includes(m[B].status)||[1,4].includes(m[B].changeStatus))return!0;if(m[B].status===42)switch(B){case"culture":if([2,3,5].includes(u))return!0;break;case"multiple":if([2,3,4,5].includes(u))return!0;break;case"accessibility":if([2,3,4,5].includes(u))return!0;break}return!1},re=()=>`id--${ne++}`,R=B=>parseInt(B)||0,K=H.defineStore("message",{state:()=>({error:null})}),{ajax:ae}=rxjs.ajax,{map:de}=rxjs;let Z="";const se=(B,_={})=>Q("Service/OFS/Accessibility.ashx",{method:B,param:_}),ce=(B,_={})=>Q("Service/OFS/Culture.ashx",{method:B,param:_}),ie=B=>`${Z}/Service/OFS/Download.ashx?path=${B}`,me=(B,_={})=>Q("Service/OFS/Education.ashx",{method:B,param:_}),pe=(B,_={})=>Q("Service/OFS/Literacy.ashx",{method:B,param:_}),Ve=(B,_={})=>Q("Service/OFS/Multiple.ashx",{method:B,param:_}),fe=({response:B,status:_})=>{if(_===200){if(B.success)return B.data;K().error=B.message}},Q=(B,_={})=>{const u={};_.constructor!==FormData&&(u["Content-Type"]="application/json");const m={body:_,headers:u,method:"POST",url:`${Z}/${B}`};return ae(m).pipe(de(fe))},A=Object.assign(Q,{accessibility:se,culture:ce,download:ie,education:me,literacy:pe,multiple:Ve,system:(B,_={})=>Q("Service/OFS/System.ashx",{method:B,param:_}),upload:B=>{const _=new FormData;return _.append("file",B),Q("Service/OFS/Upload.ashx",_)}});function Ne(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}var Y={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var Ee=Y.exports,X;function be(){return X||(X=1,(function(B,_){(function(u,m,s){var V=function(o,l,d){d=a.extend({},a.options,d);var i=a.runValidations(o,l,d);if(i.some(function(r){return a.isPromise(r.error)}))throw new Error("Use validate.async if you want support for promises");return V.processValidationResults(i,d)},a=V;a.extend=function(o){return[].slice.call(arguments,1).forEach(function(l){for(var d in l)o[d]=l[d]}),o},a.extend(V,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var o=a.format("%{major}.%{minor}.%{patch}",a.version);return a.isEmpty(a.version.metadata)||(o+="+"+a.version.metadata),o}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(o,l,d){var i=[],r,b,x,k,c,n,y;(a.isDomElement(o)||a.isJqueryElement(o))&&(o=a.collectFormValues(o));for(r in l){x=a.getDeepObjectValue(o,r),k=a.result(l[r],x,o,r,d,l);for(b in k){if(c=a.validators[b],!c)throw y=a.format("Unknown validator %{name}",{name:b}),new Error(y);n=k[b],n=a.result(n,x,o,r,d,l),n&&i.push({attribute:r,value:x,validator:b,globalOptions:d,attributes:o,options:n,error:c.call(c,x,n,r,o,d)})}}return i},processValidationResults:function(o,l){o=a.pruneEmptyErrors(o,l),o=a.expandMultipleErrors(o,l),o=a.convertErrorMessages(o,l);var d=l.format||"grouped";if(typeof a.formatters[d]=="function")o=a.formatters[d](o);else throw new Error(a.format("Unknown format %{format}",l));return a.isEmpty(o)?void 0:o},async:function(o,l,d){d=a.extend({},a.async.options,d);var i=d.wrapErrors||function(b){return b};d.cleanAttributes!==!1&&(o=a.cleanAttributes(o,l));var r=a.runValidations(o,l,d);return new a.Promise(function(b,x){a.waitForResults(r).then(function(){var k=a.processValidationResults(r,d);k?x(new i(k,d,o,l)):b(o)},function(k){x(k)})})},single:function(o,l,d){return d=a.extend({},a.single.options,d,{format:"flat",fullMessages:!1}),a({single:o},{single:l},d)},waitForResults:function(o){return o.reduce(function(l,d){return a.isPromise(d.error)?l.then(function(){return d.error.then(function(i){d.error=i||null})}):l},new a.Promise(function(l){l()}))},result:function(o){var l=[].slice.call(arguments,1);return typeof o=="function"&&(o=o.apply(null,l)),o},isNumber:function(o){return typeof o=="number"&&!isNaN(o)},isFunction:function(o){return typeof o=="function"},isInteger:function(o){return a.isNumber(o)&&o%1===0},isBoolean:function(o){return typeof o=="boolean"},isObject:function(o){return o===Object(o)},isDate:function(o){return o instanceof Date},isDefined:function(o){return o!=null},isPromise:function(o){return!!o&&a.isFunction(o.then)},isJqueryElement:function(o){return o&&a.isString(o.jquery)},isDomElement:function(o){return!o||!o.querySelectorAll||!o.querySelector?!1:a.isObject(document)&&o===document?!0:typeof HTMLElement=="object"?o instanceof HTMLElement:o&&typeof o=="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName=="string"},isEmpty:function(o){var l;if(!a.isDefined(o))return!0;if(a.isFunction(o))return!1;if(a.isString(o))return a.EMPTY_STRING_REGEXP.test(o);if(a.isArray(o))return o.length===0;if(a.isDate(o))return!1;if(a.isObject(o)){for(l in o)return!1;return!0}return!1},format:a.extend(function(o,l){return a.isString(o)?o.replace(a.format.FORMAT_REGEXP,function(d,i,r){return i==="%"?"%{"+r+"}":String(l[r])}):o},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(o){return a.isNumber(o)?o*100%1===0?""+o:parseFloat(Math.round(o*100)/100).toFixed(2):a.isArray(o)?o.map(function(l){return a.prettify(l)}).join(", "):a.isObject(o)?a.isDefined(o.toString)?o.toString():JSON.stringify(o):(o=""+o,o.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(l,d,i){return""+d+" "+i.toLowerCase()}).toLowerCase())},stringifyValue:function(o,l){var d=l&&l.prettify||a.prettify;return d(o)},isString:function(o){return typeof o=="string"},isArray:function(o){return{}.toString.call(o)==="[object Array]"},isHash:function(o){return a.isObject(o)&&!a.isArray(o)&&!a.isFunction(o)},contains:function(o,l){return a.isDefined(o)?a.isArray(o)?o.indexOf(l)!==-1:l in o:!1},unique:function(o){return a.isArray(o)?o.filter(function(l,d,i){return i.indexOf(l)==d}):o},forEachKeyInKeypath:function(o,l,d){if(a.isString(l)){var i="",r,b=!1;for(r=0;r<l.length;++r)switch(l[r]){case".":b?(b=!1,i+="."):(o=d(o,i,!1),i="");break;case"\\":b?(b=!1,i+="\\"):b=!0;break;default:b=!1,i+=l[r];break}return d(o,i,!0)}},getDeepObjectValue:function(o,l){if(a.isObject(o))return a.forEachKeyInKeypath(o,l,function(d,i){if(a.isObject(d))return d[i]})},collectFormValues:function(o,l){var d={},i,r,b,x,k,c;if(a.isJqueryElement(o)&&(o=o[0]),!o)return d;for(l=l||{},x=o.querySelectorAll("input[name], textarea[name]"),i=0;i<x.length;++i)if(b=x.item(i),!a.isDefined(b.getAttribute("data-ignored"))){var n=b.name.replace(/\./g,"\\\\.");c=a.sanitizeFormValue(b.value,l),b.type==="number"?c=c?+c:null:b.type==="checkbox"?b.attributes.value?b.checked||(c=d[n]||null):c=b.checked:b.type==="radio"&&(b.checked||(c=d[n]||null)),d[n]=c}for(x=o.querySelectorAll("select[name]"),i=0;i<x.length;++i)if(b=x.item(i),!a.isDefined(b.getAttribute("data-ignored"))){if(b.multiple){c=[];for(r in b.options)k=b.options[r],k&&k.selected&&c.push(a.sanitizeFormValue(k.value,l))}else{var y=typeof b.options[b.selectedIndex]<"u"?b.options[b.selectedIndex].value:"";c=a.sanitizeFormValue(y,l)}d[b.name]=c}return d},sanitizeFormValue:function(o,l){return l.trim&&a.isString(o)&&(o=o.trim()),l.nullify!==!1&&o===""?null:o},capitalize:function(o){return a.isString(o)?o[0].toUpperCase()+o.slice(1):o},pruneEmptyErrors:function(o){return o.filter(function(l){return!a.isEmpty(l.error)})},expandMultipleErrors:function(o){var l=[];return o.forEach(function(d){a.isArray(d.error)?d.error.forEach(function(i){l.push(a.extend({},d,{error:i}))}):l.push(d)}),l},convertErrorMessages:function(o,l){l=l||{};var d=[],i=l.prettify||a.prettify;return o.forEach(function(r){var b=a.result(r.error,r.value,r.attribute,r.options,r.attributes,r.globalOptions);if(!a.isString(b)){d.push(r);return}b[0]==="^"?b=b.slice(1):l.fullMessages!==!1&&(b=a.capitalize(i(r.attribute))+" "+b),b=b.replace(/\\\^/g,"^"),b=a.format(b,{value:a.stringifyValue(r.value,l)}),d.push(a.extend({},r,{error:b}))}),d},groupErrorsByAttribute:function(o){var l={};return o.forEach(function(d){var i=l[d.attribute];i?i.push(d):l[d.attribute]=[d]}),l},flattenErrorsToArray:function(o){return o.map(function(l){return l.error}).filter(function(l,d,i){return i.indexOf(l)===d})},cleanAttributes:function(o,l){function d(b,x,k){return a.isObject(b[x])?b[x]:b[x]=k?!0:{}}function i(b){var x={},k;for(k in b)b[k]&&a.forEachKeyInKeypath(x,k,d);return x}function r(b,x){if(!a.isObject(b))return b;var k=a.extend({},b),c,n;for(n in b)c=x[n],a.isObject(c)?k[n]=r(k[n],c):c||delete k[n];return k}return!a.isObject(l)||!a.isObject(o)?{}:(l=i(l),r(o,l))},exposeModule:function(o,l,d,i,r){d?(i&&i.exports&&(d=i.exports=o),d.validate=o):(l.validate=o,o.isFunction(r)&&r.amd&&r([],function(){return o}))},warn:function(o){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+o)},error:function(o){typeof console<"u"&&console.error&&console.error("[validate.js] "+o)}}),V.validators={presence:function(o,l){if(l=a.extend({},this.options,l),l.allowEmpty!==!1?!a.isDefined(o):a.isEmpty(o))return l.message||this.message||"can't be blank"},length:function(o,l,d){if(a.isDefined(o)){l=a.extend({},this.options,l);var i=l.is,r=l.maximum,b=l.minimum,x=l.tokenizer||function(y){return y},k,c=[];o=x(o);var n=o.length;if(!a.isNumber(n))return l.message||this.notValid||"has an incorrect length";if(a.isNumber(i)&&n!==i&&(k=l.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",c.push(a.format(k,{count:i}))),a.isNumber(b)&&n<b&&(k=l.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",c.push(a.format(k,{count:b}))),a.isNumber(r)&&n>r&&(k=l.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",c.push(a.format(k,{count:r}))),c.length>0)return l.message||c}},numericality:function(o,l,d,i,r){if(a.isDefined(o)){l=a.extend({},this.options,l);var b=[],x,k,c={greaterThan:function(p,E){return p>E},greaterThanOrEqualTo:function(p,E){return p>=E},equalTo:function(p,E){return p===E},lessThan:function(p,E){return p<E},lessThanOrEqualTo:function(p,E){return p<=E},divisibleBy:function(p,E){return p%E===0}},n=l.prettify||r&&r.prettify||a.prettify;if(a.isString(o)&&l.strict){var y="^-?(0|[1-9]\\d*)";if(l.onlyInteger||(y+="(\\.\\d+)?"),y+="$",!new RegExp(y).test(o))return l.message||l.notValid||this.notValid||this.message||"must be a valid number"}if(l.noStrings!==!0&&a.isString(o)&&!a.isEmpty(o)&&(o=+o),!a.isNumber(o))return l.message||l.notValid||this.notValid||this.message||"is not a number";if(l.onlyInteger&&!a.isInteger(o))return l.message||l.notInteger||this.notInteger||this.message||"must be an integer";for(x in c)if(k=l[x],a.isNumber(k)&&!c[x](o,k)){var f="not"+a.capitalize(x),N=l[f]||this[f]||this.message||"must be %{type} %{count}";b.push(a.format(N,{count:k,type:n(x)}))}if(l.odd&&o%2!==1&&b.push(l.notOdd||this.notOdd||this.message||"must be odd"),l.even&&o%2!==0&&b.push(l.notEven||this.notEven||this.message||"must be even"),b.length)return l.message||b}},datetime:a.extend(function(o,l){if(!a.isFunction(this.parse)||!a.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(a.isDefined(o)){l=a.extend({},this.options,l);var d,i=[],r=l.earliest?this.parse(l.earliest,l):NaN,b=l.latest?this.parse(l.latest,l):NaN;if(o=this.parse(o,l),isNaN(o)||l.dateOnly&&o%864e5!==0)return d=l.notValid||l.message||this.notValid||"must be a valid date",a.format(d,{value:arguments[0]});if(!isNaN(r)&&o<r&&(d=l.tooEarly||l.message||this.tooEarly||"must be no earlier than %{date}",d=a.format(d,{value:this.format(o,l),date:this.format(r,l)}),i.push(d)),!isNaN(b)&&o>b&&(d=l.tooLate||l.message||this.tooLate||"must be no later than %{date}",d=a.format(d,{date:this.format(b,l),value:this.format(o,l)}),i.push(d)),i.length)return a.unique(i)}},{parse:null,format:null}),date:function(o,l){return l=a.extend({},l,{dateOnly:!0}),a.validators.datetime.call(a.validators.datetime,o,l)},format:function(o,l){(a.isString(l)||l instanceof RegExp)&&(l={pattern:l}),l=a.extend({},this.options,l);var d=l.message||this.message||"is invalid",i=l.pattern,r;if(a.isDefined(o)&&(!a.isString(o)||(a.isString(i)&&(i=new RegExp(l.pattern,l.flags)),r=i.exec(o),!r||r[0].length!=o.length)))return d},inclusion:function(o,l){if(a.isDefined(o)&&(a.isArray(l)&&(l={within:l}),l=a.extend({},this.options,l),!a.contains(l.within,o))){var d=l.message||this.message||"^%{value} is not included in the list";return a.format(d,{value:o})}},exclusion:function(o,l){if(a.isDefined(o)&&(a.isArray(l)&&(l={within:l}),l=a.extend({},this.options,l),!!a.contains(l.within,o))){var d=l.message||this.message||"^%{value} is restricted";return a.isString(l.within[o])&&(o=l.within[o]),a.format(d,{value:o})}},email:a.extend(function(o,l){l=a.extend({},this.options,l);var d=l.message||this.message||"is not a valid email";if(a.isDefined(o)&&(!a.isString(o)||!this.PATTERN.exec(o)))return d},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(o,l,d,i,r){if(a.isDefined(o)){a.isString(l)&&(l={attribute:l}),l=a.extend({},this.options,l);var b=l.message||this.message||"is not equal to %{attribute}";if(a.isEmpty(l.attribute)||!a.isString(l.attribute))throw new Error("The attribute must be a non empty string");var x=a.getDeepObjectValue(i,l.attribute),k=l.comparator||function(n,y){return n===y},c=l.prettify||r&&r.prettify||a.prettify;if(!k(o,x,l,d,i))return a.format(b,{attribute:c(l.attribute)})}},url:function(o,l){if(a.isDefined(o)){l=a.extend({},this.options,l);var d=l.message||this.message||"is not a valid url",i=l.schemes||this.schemes||["http","https"],r=l.allowLocal||this.allowLocal||!1,b=l.allowDataUrl||this.allowDataUrl||!1;if(!a.isString(o))return d;var x="^(?:(?:"+i.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",k="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(r?k+="?":x+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",x+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+k+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",b){var c="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",n="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",y="data:(?:"+c+")?(?:;base64)?,"+n;x="(?:"+x+")|(?:^"+y+"$)"}var f=new RegExp(x,"i");if(!f.exec(o))return d}},type:a.extend(function(o,l,d,i,r){if(a.isString(l)&&(l={type:l}),!!a.isDefined(o)){var b=a.extend({},this.options,l),x=b.type;if(!a.isDefined(x))throw new Error("No type was specified");var k;if(a.isFunction(x)?k=x:k=this.types[x],!a.isFunction(k))throw new Error("validate.validators.type.types."+x+" must be a function.");if(!k(o,b,d,i,r)){var c=l.message||this.messages[x]||this.message||b.message||(a.isFunction(x)?"must be of the correct type":"must be of type %{type}");return a.isFunction(c)&&(c=c(o,l,d,i,r)),a.format(c,{attribute:a.prettify(d),type:x})}}},{types:{object:function(o){return a.isObject(o)&&!a.isArray(o)},array:a.isArray,integer:a.isInteger,number:a.isNumber,string:a.isString,date:a.isDate,boolean:a.isBoolean},messages:{}})},V.formatters={detailed:function(o){return o},flat:a.flattenErrorsToArray,grouped:function(o){var l;o=a.groupErrorsByAttribute(o);for(l in o)o[l]=a.flattenErrorsToArray(o[l]);return o},constraint:function(o){var l;o=a.groupErrorsByAttribute(o);for(l in o)o[l]=o[l].map(function(d){return d.validator}).sort();return o}},V.exposeModule(V,this,u,m,s)}).call(Ee,_,B,null)})(Y,Y.exports)),Y.exports}var ge=be();const v=Ne(ge),I=(B,_,u="")=>{const m={};Object.keys(_).forEach(a=>{const o=_[a];v.isString(o)?m[a]={presence:{allowEmpty:!1,message:`^請輸入${o}`}}:m[a]=o});const s={},V=v(B,m);return V&&Object.keys(V).forEach(a=>s[`${u}${a}`]=V[a].join(",")),s},ke={class:"block"},ye={class:"mt-4"},ue={class:"table align-middle gray-table side-table"},xe={key:0},he={key:1,class:"text-light-gray"},$e={class:"d-flex flex-column gap-2"},Be={key:0},_e={class:"mt-4"},Ce={class:"table align-middle gray-table side-table"},Te={class:"row g-3"},we={class:"col-12 col-xl-2"},De={class:"text-gray mb-2"},Se={class:"col-12 col-xl-3"},Fe={class:"text-gray mb-2"},Ae={class:"col-12 col-xl-4"},Ue={class:"row g-1"},Me={class:"col-7"},Ie={class:"col-5"},je={class:"col-12 col-xl-3"},Pe={class:"text-gray mb-2"},Oe={class:"col-12"},Le={class:"text-gray mb-2"},qe={class:"mt-4"},Re={class:"table align-middle gray-table side-table"},ze={class:"mt-4"},Ge={class:"table align-middle gray-table side-table"},Je={key:0,class:"table-responsive mt-3 mb-0"},Qe={class:"table align-middle gray-table"},He={key:0},Ye={key:0},We={class:"d-flex gap-2"},Ke=["onClick"],Ze={class:"mt-4"},Xe={class:"table align-middle gray-table side-table"},ve={key:0,class:"block-bottom bg-light-teal"},et={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.ref(),a=e.computed(()=>z("accessibility",d.value.Status,1)),o=e.ref({}),l=e.computed(()=>i.value.filter(f=>!f.Deleted)),d=e.ref({}),i=e.ref([]),r=e.computed({get:()=>!!l.value.length,set:f=>{f?b():i.value.forEach(N=>N.Deleted=!0)}}),b=()=>i.value.push({}),x=_,k=()=>{A.accessibility("getApplication",{ID:u.id}).subscribe(f=>{d.value=f.Project,V.value=f.Contacts,i.value=f.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,P().init("accessibility",d.value),s.value=d.value.changeApply,d.value.changeApply=void 0})},c=f=>f.Deleted=!0,n=f=>{var p,E;if(o.value={},f&&!y()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:d.value,Contacts:V.value,ReceivedSubsidies:i.value.filter(t=>t.ID||!t.Deleted),Before:(p=s.value)==null?void 0:p.Form1Before,After:(E=s.value)==null?void 0:E.Form1After,Submit:f?"true":"false"};A.accessibility("saveApplication",N).subscribe(t=>{f?x("next",t.ID):d.value.ID?k():window.location.href=`Application.aspx?ID=${t.ID}`})},y=()=>{let f={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value.OrgCategory==="2"&&(f.RegisteredNum="立案登記證字號"),o.value=I(d.value,f),f={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((N,p)=>Object.assign(o.value,I(N,f,`contact-${p}-`))),f={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},i.value.forEach((N,p)=>Object.assign(o.value,I(N,f,`received-${p}-`))),s.value&&(f={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,f))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(f=>{m.value=f[0],u.id?k():A.accessibility("getEmptyApplication").subscribe(N=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},N),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("accessibility",d.value)})})}),e.provide("editable",a),(f,N)=>{const p=e.resolveComponent("required-label"),E=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),g=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ke,[N[42]||(N[42]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ye,[e.createElementVNode("table",ue,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[N[16]||(N[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",xe,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",he,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[17]||(N[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=w=>e.unref(d).ProjectName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":N[1]||(N[1]=w=>e.unref(d).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",$e,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(m),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":N[2]||(N[2]=w=>e.unref(d).OrgCategory=w)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Be,[e.createVNode(E,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":N[3]||(N[3]=w=>e.unref(d).RegisteredNum=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":N[4]||(N[4]=w=>e.unref(d).TaxID=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":N[5]||(N[5]=w=>e.unref(d).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[43]||(N[43]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",_e,[e.createElementVNode("table",Ce,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Te,[e.createElementVNode("div",we,[e.createElementVNode("div",De,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Se,[e.createElementVNode("div",Fe,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[24]||(N[24]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ae,[N[25]||(N[25]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ue,[e.createElementVNode("div",Me,[e.createVNode(E,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ie,[e.createVNode(E,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",je,[e.createElementVNode("div",Pe,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Oe,[e.createElementVNode("div",Le,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[44]||(N[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",qe,[e.createElementVNode("table",Re,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[28]||(N[28]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[29]||(N[29]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(g,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":N[6]||(N[6]=w=>e.unref(d).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":N[7]||(N[7]=w=>e.unref(d).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":N[8]||(N[8]=w=>e.unref(d).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[32]||(N[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":N[9]||(N[9]=w=>e.unref(d).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ze,[e.createElementVNode("table",Ge,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[38]||(N[38]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(h,{modelValue:e.unref(r),"onUpdate:modelValue":N[10]||(N[10]=w=>e.isRef(r)?r.value=w:null)},null,8,["modelValue"]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Je,[e.createElementVNode("table",Qe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[33]||(N[33]=e.createElementVNode("th",null,"計畫名稱",-1)),N[34]||(N[34]=e.createElementVNode("th",null,"補助單位",-1)),N[35]||(N[35]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",He,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o)[`received-${U}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o)[`received-${U}-Unit`],modelValue:w.Unit,"onUpdate:modelValue":M=>w.Unit=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${U}-Amount`],modelValue:w.Amount,"onUpdate:modelValue":M=>w.Amount=M},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Ye,[e.createElementVNode("div",We,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>c(w),type:"button"},[...N[36]||(N[36]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ke)):e.createCommentVNode("",!0),U+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...N[37]||(N[37]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[N[41]||(N[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ze,[e.createElementVNode("table",Xe,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[39]||(N[39]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":N[11]||(N[11]=w=>e.unref(s).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[40]||(N[40]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":N[12]||(N[12]=w=>e.unref(s).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",ve,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[13]||(N[13]=w=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[14]||(N[14]=w=>n(!0)),type:"button"},[...N[45]||(N[45]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},tt={class:"block"},lt={key:0,class:"text-pink lh-base mt-4"},ot={class:"mt-4"},nt={class:"table align-middle gray-table"},rt={class:"text-center"},at={key:0,width:"180"},dt={class:"text-center"},st={key:0},ct=["innerHTML"],it=["href"],mt={key:0,class:"text-center"},pt={key:0},Vt={key:1,class:"text-pink"},ft={key:1,class:"tag-group mt-2 gap-1"},Nt={key:0,class:"tag tag-green-light"},Et=["download","href"],bt=["onClick"],gt={class:"mt-4"},kt={class:"table align-middle gray-table side-table"},yt={key:0,class:"block-bottom bg-light-teal"},ut=["disabled"],xt={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([{Type:1,Title:"申請表",Template:"../../Template/ACC/附件01-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/ACC/附件02-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/ACC/附件03-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/ACC/附件04-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),V=e.computed(()=>m.value.some(c=>!c.Optional&&!c.Files.filter(n=>!n.Deleted).length)),a=e.computed(()=>z("accessibility",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},i=A.download,r=_,b=()=>{rxjs.forkJoin([A.accessibility("getAttachment",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=m.value.filter(y=>{var f;return!((f=y.Excludes)!=null&&f.includes(l.value.OrgCategory))}),m.value.forEach(y=>{y.Files=n.Attachments.filter(f=>f.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(f=>!f.Deleted).length)}),P().init("accessibility",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},x=c=>{var y,f;if(o.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:u.id,Attachments:m.value.reduce((N,p)=>N.concat(p.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(f=s.value)==null?void 0:f.Form5After,Submit:c?"true":"false"};A.accessibility("saveAttachment",n).subscribe(()=>{c?r("next"):b()})},k=()=>{if(s.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,c))}return!Object.keys(o.value).length};return e.onMounted(b),e.provide("editable",a),(c,n)=>{const y=e.resolveComponent("required-label"),f=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",tt,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",lt,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ot,[e.createElementVNode("table",nt,[e.createElementVNode("thead",rt,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",at,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",dt,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[p.Optional?(e.openBlock(),e.createElementBlock("span",st,e.toDisplayString(p.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p.Title),1)]),_:2},1024))]),e.unref(a)&&p.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:p.Comment},null,8,ct)):e.createCommentVNode("",!0),e.unref(a)&&p.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:p.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,it)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",mt,[p.Uploaded?(e.openBlock(),e.createElementBlock("span",pt,"已上傳")):(e.openBlock(),e.createElementBlock("span",Vt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(p.Multiple||!p.Uploaded)?(e.openBlock(),e.createBlock(f,{key:0,accept:".pdf",onFile:t=>d(p,t)},null,8,["onFile"])):e.createCommentVNode("",!0),p.Uploaded?(e.openBlock(),e.createElementBlock("div",ft,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Nt,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(i)(t.Path)},e.toDisplayString(t.Name),9,Et),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:g=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,bt)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",gt,[e.createElementVNode("table",kt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(s).Form5Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form5After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",yt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=p=>x(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ut)])):e.createCommentVNode("",!0)],64)}}},ht={class:"block"},$t={class:"mt-4"},Bt={class:"table-responsive mt-3 mb-0"},_t={class:"table align-middle gray-table"},Ct={key:0,width:"1"},Tt={key:0},wt={class:"d-flex gap-2"},Dt=["onClick"],St={class:"table-responsive mt-3 mb-0"},Ft={class:"table align-middle gray-table"},At={class:"mt-4"},Ut={class:"table align-middle gray-table side-table"},Mt={key:0,class:"block-bottom bg-light-teal"},It={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.computed(()=>z("accessibility",l.value.Status,4)),a=e.ref({}),o=e.computed(()=>m.value.filter(c=>!c.Deleted)),l=e.ref({}),d=()=>m.value.push({}),i=_,r=()=>{rxjs.forkJoin([A.accessibility("getBenefit",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=n.Benefits,m.value.length||d(),P().init("accessibility",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},b=c=>c.Deleted=!0,x=c=>{var y,f;if(a.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Benefits:m.value,Before:(y=s.value)==null?void 0:y.Form4Before,After:(f=s.value)==null?void 0:f.Form4After,Submit:c?"true":"false"};A.accessibility("saveBenefit",n).subscribe(()=>{c?i("next"):r()})},k=()=>{let c={Benefit:"不可量化成果"};return a.value=I(l.value,c),c={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((n,y)=>Object.assign(a.value,I(n,c,`item-${y}-`))),s.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,I(s.value,c))),!Object.keys(a.value).length};return e.onMounted(r),e.provide("editable",V),(c,n)=>{const y=e.resolveComponent("input-text"),f=e.resolveComponent("input-textarea"),N=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ht,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",$t,[e.createElementVNode("div",Bt,[e.createElementVNode("table",_t,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ct,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${E}-Title`],modelValue:p.Title,"onUpdate:modelValue":t=>p.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${E}-Target`],modelValue:p.Target,"onUpdate:modelValue":t=>p.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a)[`item-${E}-Description`],rows:"1",modelValue:p.Description,"onUpdate:modelValue":t=>p.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Tt,[e.createElementVNode("div",wt,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>b(p),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Dt)):e.createCommentVNode("",!0),E+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",St,[e.createElementVNode("table",Ft,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(l).Benefit=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",At,[e.createElementVNode("table",Ut,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form4Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":n[2]||(n[2]=p=>e.unref(s).Form4After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Mt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=p=>x(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},jt={class:"block"},Pt={class:"mt-4"},Ot={class:"table-responsive mt-3 mb-0"},Lt={class:"table align-middle gray-table"},qt={class:"text-end"},Rt={class:"text-end"},zt={class:"table-responsive"},Gt={class:"table align-middle gray-table"},Jt=["colspan"],Qt={key:0,width:"1"},Ht={class:"text-end"},Yt={key:0},Wt={class:"d-flex gap-2"},Kt=["onClick"],Zt={class:"mt-4"},Xt={class:"table-responsive mt-3 mb-0"},vt={class:"table align-middle gray-table"},el={key:0,width:"1"},tl={class:"text-end"},ll={key:0},ol={class:"d-flex gap-2"},nl=["onClick"],rl={class:"mt-4"},al={class:"table align-middle gray-table side-table"},dl={key:0,class:"block-bottom bg-light-teal"},sl={class:"text-center"},cl={class:"mb-5"},il={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.computed(()=>z("accessibility",l.value.Status,3)),V=e.ref({}),a=e.computed(()=>i.value.filter(E=>!E.Deleted)),o=e.computed(()=>r.value.filter(E=>!E.Deleted)),l=e.ref({}),d=e.ref(),i=e.ref([]),r=e.ref([]),b=e.ref({}),x=e.ref(0),k=()=>i.value.push({}),c=()=>r.value.push({}),n=_,y=()=>{rxjs.forkJoin([A.accessibility("getFunding",{ID:u.id})]).subscribe(E=>{const t=E[0];l.value=t.Project,i.value=t.OtherSubsidies,r.value=t.BudgetPlans,b.value=t.GrantTargetSetting,i.value.length||k(),r.value.length||c(),P().init("accessibility",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(V.value={},E&&!p()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>b.value.GrantLimit*1e4){d.value.show(()=>N(E,!0));return}const g={Project:l.value,OtherSubsidies:i.value,BudgetPlans:r.value,Before:(h=m.value)==null?void 0:h.Form3Before,After:(S=m.value)==null?void 0:S.Form3After,Submit:E?"true":"false"};A.accessibility("saveFunding",g).subscribe(()=>{E?n("next"):y()})},p=()=>{let E={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=I(l.value,E),E={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},i.value.forEach((t,g)=>Object.assign(V.value,I(t,E,`other-${g}-`))),E={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,g)=>Object.assign(V.value,I(t,E,`plan-${g}-`))),m.value&&(E={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,I(m.value,E))),!Object.keys(V.value).length};return e.onMounted(y),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=a.value.reduce((E,t)=>E+R(t.Amount),0),x.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),a.value.forEach(E=>E.percent=Math.round(R(E.Amount)/l.value.OtherAmount*1e4)/100),r.value.forEach(E=>E.sum=R(E.Amount)+R(E.OtherAmount))}),(E,t)=>{var M;const g=e.resolveComponent("input-integer"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),U=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",jt,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Pt,[e.createElementVNode("div",Ot,[e.createElementVNode("table",Lt,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(l).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(l).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",qt,e.toDisplayString((M=e.unref(l).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Rt,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",zt,[e.createElementVNode("table",Gt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Jt)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",Qt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,C)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`other-${C}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":T=>F.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`other-${C}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Ht,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`other-${C}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":T=>F.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",Yt,[e.createElementVNode("div",Wt,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>f(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Kt)):e.createCommentVNode("",!0),C+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Zt,[e.createElementVNode("div",Xt,[e.createElementVNode("table",vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",el,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(F,C)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`plan-${C}-Title`],modelValue:F.Title,"onUpdate:modelValue":T=>F.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":T=>F.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",tl,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`plan-${C}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":T=>F.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",ll,[e.createElementVNode("div",ol,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>f(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nl)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",rl,[e.createElementVNode("table",al,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(m).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(m).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(m).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(m).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",dl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>N(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(U,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",sl,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",cl,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(b).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},ml={class:"block"},pl={class:"text-teal fw-bold py-3"},Vl={class:"table-responsive"},fl={class:"table align-middle gray-table"},Nl={class:"text-end"},El={class:"text-end"},bl={class:"mt-4"},gl={class:"table align-middle gray-table"},kl={class:"text-center"},yl={key:0,width:"180"},ul={class:"text-center"},xl=["href"],hl={key:0,class:"text-center"},$l={key:0},Bl={key:1,class:"text-pink"},_l={key:1,class:"tag-group mt-2 gap-1"},Cl={key:0,class:"tag tag-green-light"},Tl=["download","href"],wl=["onClick"],Dl={class:"block-bottom bg-light-teal"},Sl=!0,Fl={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(0),s=e.ref({}),V=e.ref([{Type:1,Title:"領據",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_第一期請款_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.accessibility("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("accessibility",s.value),V.value=V.value.filter(r=>{var b;return!((b=r.Excludes)!=null&&b.includes(s.value.OrgCategory))}),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",Sl),(i,r)=>{var c;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ml,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",pl,"核定經費: "+e.toDisplayString((c=e.unref(s).ApprovedAmount)==null?void 0:c.toLocaleString())+"元",1),e.createElementVNode("div",Vl,[e.createElementVNode("table",fl,[r[5]||(r[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Nl,e.toDisplayString(e.unref(m)),1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=n=>e.isRef(m)?m.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",El,e.toDisplayString(e.unref(a))+"%",1),r[4]||(r[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",bl,[e.createElementVNode("table",gl,[e.createElementVNode("thead",kl,[e.createElementVNode("tr",null,[r[6]||(r[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[7]||(r[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",yl,"狀態")),r[8]||(r[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(n,y)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",ul,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,xl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",hl,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",$l,"已上傳")):(e.openBlock(),e.createElementBlock("span",Bl,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:f=>o(n,f)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",_l,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,f=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:f},[f.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Cl,[e.createElementVNode("a",{class:"tag-link my-1",download:f.Name,href:e.unref(l)(f.Path)},e.toDisplayString(f.Name),9,Tl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>f.Deleted=!0,type:"button"},[...r[10]||(r[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,wl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Dl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=n=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=n=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Al={class:"block"},Ul={class:"text-teal fw-bold py-3"},Ml={class:"text-teal fw-bold pb-3"},Il={class:"table-responsive"},jl={class:"table align-middle gray-table"},Pl={class:"text-end"},Ol={class:"text-end"},Ll={class:"mt-4"},ql={class:"table align-middle gray-table"},Rl={class:"text-center"},zl={key:0,width:"180"},Gl={class:"text-center"},Jl=["href"],Ql={key:0,class:"text-center"},Hl={key:0},Yl={key:1,class:"text-pink"},Wl={key:1,class:"tag-group mt-2 gap-1"},Kl={key:0,class:"tag tag-green-light"},Zl=["download","href"],Xl=["onClick"],vl={class:"block-bottom bg-light-teal"},eo=!0,ee=3e4,to={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(3e4),s=e.ref({}),V=e.ref([{Type:1,Title:"領據",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/ACC/1-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/ACC/2-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/ACC/3-補助清單.docx",Files:[]},{Type:5,Title:"其他",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_第二期請款_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.accessibility("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("accessibility",s.value),V.value=V.value.filter(r=>{var b;return!((b=r.Excludes)!=null&&b.includes(s.value.OrgCategory))}),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",eo),(i,r)=>{var c;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Al,[r[10]||(r[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",Ul,"核定經費: "+e.toDisplayString((c=e.unref(s).ApprovedAmount)==null?void 0:c.toLocaleString())+"元",1),e.createElementVNode("p",Ml,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(m)).toLocaleString())+"元",1),e.createElementVNode("div",Il,[e.createElementVNode("table",jl,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Pl,e.toDisplayString(e.unref(m)-ee),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(ee)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=n=>e.isRef(m)?m.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",Ol,e.toDisplayString(e.unref(a))+"%",1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[12]||(r[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Ll,[e.createElementVNode("table",ql,[e.createElementVNode("thead",Rl,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",zl,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(n,y)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",Gl,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Jl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Ql,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",Hl,"已上傳")):(e.openBlock(),e.createElementBlock("span",Yl,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:f=>o(n,f)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",Wl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,f=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:f},[f.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Kl,[e.createElementVNode("a",{class:"tag-link my-1",download:f.Name,href:e.unref(l)(f.Path)},e.toDisplayString(f.Name),9,Zl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>f.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",vl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=n=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=n=>d()),type:"button"},[...r[13]||(r[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},lo={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,m)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"accessibility"})}}},oo={class:"block"},no={class:"mt-4"},ro={class:"table align-middle gray-table side-table"},ao={key:0,class:"d-flex align-items-center gap-2"},so={class:"input-group w-auto"},co={class:"text-teal-dark"},io={key:1,class:"invalid mt-0"},mo={class:"table-responsive mt-4"},po={class:"table align-middle gray-table"},Vo={key:0},fo={class:"input-group"},No={key:0,class:"invalid mt-0"},Eo={key:0},bo={class:"d-flex gap-2"},go=["onClick"],ko={class:"mt-4"},yo={class:"table align-middle gray-table"},uo={key:0},xo=["value"],ho={key:0},$o={class:"d-flex gap-2"},Bo=["onClick"],_o={class:"mt-4"},Co={class:"table align-middle gray-table side-table"},To={key:0,class:"block-bottom bg-light-teal"},wo={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),V=e.computed(()=>r.value.EndDate),a=e.computed(()=>z("accessibility",i.value.Status,2)),o=e.ref({}),l=e.computed(()=>b.value.filter(E=>!E.Deleted)),d=e.computed(()=>x.value.filter(E=>!E.Deleted)),i=e.ref({}),r=e.ref({}),b=e.ref([]),x=e.ref([]),k=()=>A.accessibility("createItem",{ID:u.id}).subscribe(E=>b.value.push(E)),c=()=>x.value.push({Type:0,ItemID:0}),n=_,y=()=>{rxjs.forkJoin([A.accessibility("getWorkSchedule",{ID:u.id})]).subscribe(E=>{const t=E[0];i.value=t.Project,r.value=t.GrantType,b.value=t.Items,x.value=t.Schedules,b.value.length||k(),x.value.length||c(),P().init("accessibility",i.value),s.value=i.value.changeApply,i.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=E=>{var g,h;if(o.value={},E&&!p()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:i.value,Items:b.value,Schedules:x.value,Before:(g=s.value)==null?void 0:g.Form2Before,After:(h=s.value)==null?void 0:h.Form2After,Submit:E?"true":"false"};A.accessibility("saveWorkSchedule",t).subscribe(()=>{E?n("next"):y()})},p=()=>{let E={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=I(i.value,E),E={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`item-${g}-`))),E={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`schedule-${g}-`))),s.value&&(E={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",a),(E,t)=>{const g=e.resolveComponent("required-label"),h=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oo,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",no,[e.createElementVNode("table",ro,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",ao,[e.createElementVNode("div",so,[e.createVNode(h,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(i).StartTime,"onUpdate:modelValue":t[0]||(t[0]=C=>e.unref(i).StartTime=C)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(i).EndTime,"onUpdate:modelValue":t[1]||(t[1]=C=>e.unref(i).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",co,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(V)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",io,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",mo,[e.createElementVNode("table",po,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Vo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`item-${T}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",fo,[e.createVNode(U,{"empty-value":0,modelValue:C.Begin,"onUpdate:modelValue":D=>C.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(U,{"empty-value":0,modelValue:C.End,"onUpdate:modelValue":D=>C.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",No,e.toDisplayString(e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`item-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`item-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Eo,[e.createElementVNode("div",bo,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>f(C),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,go)):e.createCommentVNode("",!0),T+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",ko,[e.createElementVNode("table",yo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",uo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${T}-Type`],options:m,modelValue:C.Type,"onUpdate:modelValue":D=>C.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${T}-ItemID`],options:e.unref(l),modelValue:C.ItemID,"onUpdate:modelValue":D=>C.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:j})=>[e.createElementVNode("option",{value:j.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(j.Title),9,xo)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`schedule-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`schedule-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",ho,[e.createElementVNode("div",$o,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>f(C),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bo)):e.createCommentVNode("",!0),T+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_o,[e.createElementVNode("table",Co,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=C=>e.unref(s).Form2Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=C=>e.unref(s).Form2After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",To,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=C=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=C=>N(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Do={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},So={class:"modal-content"},Fo={class:"modal-body"},Ao={class:"d-flex justify-content-center mt-4 gap-4"},Uo={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Mo={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(B,{expose:_}){let u;const m=e.ref(),s=B,V=()=>{u&&u()};return _({show:o=>{u=o,bootstrap.Modal.getOrCreateInstance(m.value).show()}}),(o,l)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:m,tabindex:"-1"},[e.createElementVNode("div",Do,[e.createElementVNode("div",So,[l[0]||(l[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Fo,[e.renderSlot(o.$slots,"default"),e.createElementVNode("div",Ao,[e.createElementVNode("button",Uo,e.toDisplayString(s.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:V,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(s.confirm),1)])])])])],512)]))}},Io={class:"application-step"},jo=["onClick"],Po={class:"step-content"},Oo={class:"step-label"},Lo={key:0,class:"step-status edit"},qo={key:1,class:"step-status"},Ro={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(B,{emit:_}){const u=e.computed(()=>z(s.type,m[s.type].status,s.step)),m=P(),s=B,V=o=>{s.review?a("click",o.step):o.step<=m[s.type].step&&(location.href=`${o.url}.aspx?ID=${s.id}`)},a=_;return(o,l)=>(e.openBlock(),e.createElementBlock("div",Io,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.steps,d=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(u)&&(d.step<e.unref(m)[B.type].step||d.step===B.step)}]),onClick:i=>V(d),key:d,role:"button"},[e.createElementVNode("div",Po,[e.createElementVNode("div",Oo,e.toDisplayString(d.title),1),e.unref(u)&&d.step===B.step?(e.openBlock(),e.createElementBlock("div",Lo,"編輯中")):d.step<e.unref(m)[B.type].step?(e.openBlock(),e.createElementBlock("div",qo,"已完成")):e.createCommentVNode("",!0)])],10,jo))),128))]))}},zo={class:"block"},Go={class:"mt-4"},Jo={class:"table align-middle gray-table side-table"},Qo={key:0},Ho={key:1,class:"text-light-gray"},Yo={class:"d-flex gap-2"},Wo={key:0,class:"invalid mt-0"},Ko={class:"d-flex flex-column gap-2"},Zo={key:0},Xo={class:"mt-4"},vo={class:"table align-middle gray-table side-table"},en={class:"row g-3"},tn={class:"col-12 col-xl-2"},ln={class:"text-gray mb-2"},on={class:"col-12 col-xl-3"},nn={class:"text-gray mb-2"},rn={class:"col-12 col-xl-4"},an={class:"row g-1"},dn={class:"col-7"},sn={class:"col-5"},cn={class:"col-12 col-xl-3"},mn={class:"text-gray mb-2"},pn={class:"col-12"},Vn={class:"text-gray mb-2"},fn={class:"mt-4"},Nn={class:"table align-middle gray-table side-table"},En={class:"mt-4"},bn={class:"table align-middle gray-table side-table"},gn={key:0,class:"table-responsive mt-3 mb-0"},kn={class:"table align-middle gray-table"},yn={key:0},un={key:0},xn={class:"d-flex gap-2"},hn=["onClick"],$n={class:"mt-4"},Bn={class:"table align-middle gray-table side-table"},_n={key:0,class:"block-bottom bg-light-teal"},Cn={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.ref(),a=e.computed(()=>z("culture",r.value.Status,1)),o=e.ref({}),l=e.ref(null),d=e.ref([]),i=e.computed(()=>x.value.filter(t=>!t.Deleted)),r=e.ref({}),b=e.computed(()=>d.value.filter(t=>!t.ParentCode)),x=e.ref([]),k=e.computed(()=>d.value.filter(t=>t.ParentCode===l.value)),c=e.computed({get:()=>!!i.value.length,set:t=>{t?n():x.value.forEach(g=>g.Deleted=!0)}}),n=()=>x.value.push({}),y=_,f=()=>{A.culture("getApplication",{ID:u.id}).subscribe(t=>{var g;r.value=t.Project,V.value=t.Contacts,x.value=t.ReceivedSubsidies,l.value=((g=d.value.find(h=>h.Code===r.value.Field))==null?void 0:g.ParentCode)||null,r.value.OrgCategory=r.value.OrgCategory||null,P().init("culture",r.value),s.value=r.value.changeApply,r.value.changeApply=void 0})},N=t=>t.Deleted=!0,p=t=>{var h,S;if(o.value={},t&&!E()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}const g={Project:r.value,Contacts:V.value,ReceivedSubsidies:x.value.filter(w=>w.ID||!w.Deleted),Before:(h=s.value)==null?void 0:h.Form1Before,After:(S=s.value)==null?void 0:S.Form1After,Submit:t?"true":"false"};A.culture("saveApplication",g).subscribe(w=>{t?y("next",w.ID):r.value.ID?f():window.location.href=`Application.aspx?ID=${w.ID}`})},E=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return r.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),o.value=I(r.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((g,h)=>Object.assign(o.value,I(g,t,`contact-${h}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},x.value.forEach((g,h)=>Object.assign(o.value,I(g,t,`received-${h}-`))),s.value&&(t={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,t))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.culture("getZgsCodes",{CodeGroup:"CULField"}),A.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{d.value=t[0],m.value=t[1],u.id?f():A.culture("getEmptyApplication").subscribe(g=>{l.value=null,r.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},g),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("culture",r.value)})})}),e.provide("editable",a),e.watch(l,()=>{l.value?k.value.find(t=>r.value.Field===t.Code)||(r.value.Field=k.value[0].Code):r.value.Field=null}),(t,g)=>{const h=e.resolveComponent("required-label"),S=e.resolveComponent("input-text"),w=e.resolveComponent("input-select"),U=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-boolean"),F=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zo,[g[45]||(g[45]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Go,[e.createElementVNode("table",Jo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[g[17]||(g[17]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).Year),1)]),e.createElementVNode("tr",null,[g[18]||(g[18]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(r).ProjectID?(e.openBlock(),e.createElementBlock("span",Qo,e.toDisplayString(e.unref(r).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Ho,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[g[19]||(g[19]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[20]||(g[20]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).ProjectName,modelValue:e.unref(r).ProjectName,"onUpdate:modelValue":g[0]||(g[0]=C=>e.unref(r).ProjectName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[21]||(g[21]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Yo,[e.createVNode(w,{"empty-value":null,options:e.unref(b),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l),"onUpdate:modelValue":g[1]||(g[1]=C=>e.isRef(l)?l.value=C:null)},null,8,["options","modelValue"]),e.createVNode(w,{"empty-value":null,disabled:!e.unref(l),options:e.unref(k),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).Field,"onUpdate:modelValue":g[2]||(g[2]=C=>e.unref(r).Field=C)},null,8,["disabled","options","modelValue"])]),e.unref(o).Field?(e.openBlock(),e.createElementBlock("div",Wo,e.toDisplayString(e.unref(o).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[22]||(g[22]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(r).OrgName,"onUpdate:modelValue":g[3]||(g[3]=C=>e.unref(r).OrgName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[23]||(g[23]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ko,[e.createElementVNode("div",null,[e.createVNode(w,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(m),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).OrgCategory,"onUpdate:modelValue":g[4]||(g[4]=C=>e.unref(r).OrgCategory=C)},null,8,["error","options","modelValue"])]),e.unref(r).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Zo,[e.createVNode(S,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(r).RegisteredNum,"onUpdate:modelValue":g[5]||(g[5]=C=>e.unref(r).RegisteredNum=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[24]||(g[24]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(r).TaxID,"onUpdate:modelValue":g[6]||(g[6]=C=>e.unref(r).TaxID=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[25]||(g[25]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(r).Address,"onUpdate:modelValue":g[7]||(g[7]=C=>e.unref(r).Address=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),g[46]||(g[46]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Xo,[e.createElementVNode("table",vo,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",en,[e.createElementVNode("div",tn,[e.createElementVNode("div",ln,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[26]||(g[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-Name`],modelValue:C.Name,"onUpdate:modelValue":D=>C.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",on,[e.createElementVNode("div",nn,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[27]||(g[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-JobTitle`],modelValue:C.JobTitle,"onUpdate:modelValue":D=>C.JobTitle=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rn,[g[28]||(g[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",an,[e.createElementVNode("div",dn,[e.createVNode(S,{modelValue:C.Phone,"onUpdate:modelValue":D=>C.Phone=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",sn,[e.createVNode(S,{placeholder:"請輸入分機",size:"4",modelValue:C.PhoneExt,"onUpdate:modelValue":D=>C.PhoneExt=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",cn,[e.createElementVNode("div",mn,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[29]||(g[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-MobilePhone`],modelValue:C.MobilePhone,"onUpdate:modelValue":D=>C.MobilePhone=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",pn,[e.createElementVNode("div",Vn,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[30]||(g[30]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-EMail`],modelValue:C.EMail,"onUpdate:modelValue":D=>C.EMail=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),g[47]||(g[47]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",fn,[e.createElementVNode("table",Nn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[31]||(g[31]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[g[32]||(g[32]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(U,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(r).Target,"onUpdate:modelValue":g[8]||(g[8]=C=>e.unref(r).Target=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[33]||(g[33]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(r).Summary,"onUpdate:modelValue":g[9]||(g[9]=C=>e.unref(r).Summary=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[34]||(g[34]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Quantified,"onUpdate:modelValue":g[10]||(g[10]=C=>e.unref(r).Quantified=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[35]||(g[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Qualitative,"onUpdate:modelValue":g[11]||(g[11]=C=>e.unref(r).Qualitative=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",En,[e.createElementVNode("table",bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[g[41]||(g[41]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(M,{modelValue:e.unref(c),"onUpdate:modelValue":g[12]||(g[12]=C=>e.isRef(c)?c.value=C:null)},null,8,["modelValue"]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",gn,[e.createElementVNode("table",kn,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[g[36]||(g[36]=e.createElementVNode("th",null,"計畫名稱",-1)),g[37]||(g[37]=e.createElementVNode("th",null,"補助單位",-1)),g[38]||(g[38]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",yn,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${T}-Name`],modelValue:C.Name,"onUpdate:modelValue":D=>C.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${T}-Unit`],modelValue:C.Unit,"onUpdate:modelValue":D=>C.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(o)[`received-${T}-Amount`],modelValue:C.Amount,"onUpdate:modelValue":D=>C.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",un,[e.createElementVNode("div",xn,[e.unref(i).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>N(C),type:"button"},[...g[39]||(g[39]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,hn)):e.createCommentVNode("",!0),T+1===e.unref(i).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:n,type:"button"},[...g[40]||(g[40]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[g[44]||(g[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$n,[e.createElementVNode("table",Bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[42]||(g[42]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":g[13]||(g[13]=C=>e.unref(s).Form1Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...g[43]||(g[43]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":g[14]||(g[14]=C=>e.unref(s).Form1After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",_n,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:g[15]||(g[15]=C=>p()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:g[16]||(g[16]=C=>p(!0)),type:"button"},[...g[48]||(g[48]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Tn={class:"block"},wn={key:0,class:"text-pink lh-base mt-4"},Dn={class:"mt-4"},Sn={class:"table align-middle gray-table"},Fn={class:"text-center"},An={key:0,width:"180"},Un={class:"text-center"},Mn={key:0},In=["innerHTML"],jn=["href"],Pn={key:0,class:"text-center"},On={key:0},Ln={key:1,class:"text-pink"},qn={key:1,class:"tag-group mt-2 gap-1"},Rn={key:0,class:"tag tag-green-light"},zn=["download","href"],Gn=["onClick"],Jn={class:"mt-4"},Qn={class:"table align-middle gray-table side-table"},Hn={key:0,class:"block-bottom bg-light-teal"},Yn=["disabled"],Wn={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([{Type:1,Title:"申請表",Template:"../../Template/CUL/1.申請表.docx",Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:"../../Template/CUL/2.計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/CUL/3.執行承諾書.docx",Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:"../../Template/CUL/4.未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),s=e.ref(),V=e.computed(()=>m.value.some(c=>!c.Optional&&!c.Files.filter(n=>!n.Deleted).length)),a=e.computed(()=>z("culture",l.value.Status,5)),o=e.ref({}),l=e.ref({}),d=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},i=A.download,r=_,b=()=>{rxjs.forkJoin([A.culture("getAttachment",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=m.value.filter(y=>{var f;return!((f=y.Excludes)!=null&&f.includes(l.value.OrgCategory))}),l.value.Status>=42&&m.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]}),m.value.forEach(y=>{y.Files=n.Attachments.filter(f=>f.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(f=>!f.Deleted).length)}),P().init("culture",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},x=c=>{var y,f;if(o.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:u.id,Attachments:m.value.reduce((N,p)=>N.concat(p.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(f=s.value)==null?void 0:f.Form5After,Submit:c?"true":"false"};A.culture("saveAttachment",n).subscribe(()=>{c?r("next"):b()})},k=()=>{if(s.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,c))}return!Object.keys(o.value).length};return e.onMounted(b),e.provide("editable",a),(c,n)=>{const y=e.resolveComponent("required-label"),f=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Tn,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",wn,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Dn,[e.createElementVNode("table",Sn,[e.createElementVNode("thead",Fn,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",An,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",Un,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[p.Optional?(e.openBlock(),e.createElementBlock("span",Mn,e.toDisplayString(p.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p.Title),1)]),_:2},1024))]),e.unref(a)&&p.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:p.Comment},null,8,In)):e.createCommentVNode("",!0),e.unref(a)&&p.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:p.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,jn)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Pn,[p.Uploaded?(e.openBlock(),e.createElementBlock("span",On,"已上傳")):(e.openBlock(),e.createElementBlock("span",Ln,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(p.Multiple||!p.Uploaded)?(e.openBlock(),e.createBlock(f,{key:0,accept:".pdf",onFile:t=>d(p,t)},null,8,["onFile"])):e.createCommentVNode("",!0),p.Uploaded?(e.openBlock(),e.createElementBlock("div",qn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Rn,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(i)(t.Path)},e.toDisplayString(t.Name),9,zn),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:g=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Gn)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Jn,[e.createElementVNode("table",Qn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(s).Form5Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form5After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Hn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=p=>x(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Yn)])):e.createCommentVNode("",!0)],64)}}},Kn={class:"block"},Zn={class:"mt-4"},Xn={class:"table-responsive mt-3 mb-0"},vn={class:"table align-middle gray-table"},er={class:"text-end"},tr={class:"text-end"},lr={class:"table-responsive"},or={class:"table align-middle gray-table"},nr=["colspan"],rr={key:0,width:"1"},ar={key:0},dr={class:"d-flex gap-2"},sr=["onClick"],cr={class:"mt-4"},ir={class:"table-responsive mt-3 mb-0"},mr={class:"table align-middle gray-table"},pr={key:0,width:"1"},Vr={class:"text-end"},fr={key:0},Nr={class:"d-flex gap-2"},Er=["onClick"],br={class:"mt-4"},gr={class:"table align-middle gray-table side-table"},kr={key:0,class:"block-bottom bg-light-teal"},yr={class:"text-center"},ur={class:"mb-5"},xr={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.computed(()=>z("culture",l.value.Status,3)),V=e.ref({}),a=e.computed(()=>r.value.filter(g=>!g.Deleted)),o=e.computed(()=>b.value.filter(g=>!g.Deleted)),l=e.ref({}),d=e.ref([]),i=e.ref(),r=e.ref([]),b=e.ref([]),x=e.ref({}),k=e.ref(0),c=()=>r.value.push({}),n=()=>b.value.push({ItemID:0}),y=_,f=()=>{rxjs.forkJoin([A.culture("getFunding",{ID:u.id})]).subscribe(g=>{const h=g[0];l.value=h.Project,r.value=h.OtherSubsidies,b.value=h.BudgetPlans,d.value=h.Items,x.value=h.GrantTargetSetting,r.value.length||c(),b.value.length||n(),P().init("culture",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},N=g=>g.Deleted=!0,p=g=>g.Deleted=!0,E=(g,h)=>{var w,U;if(V.value={},g&&!t()){e.nextTick(()=>{var M;return(M=document.querySelector(".invalid"))==null?void 0:M.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!h&&l.value.ApplyAmount>x.value.GrantLimit*1e4){i.value.show(()=>E(g,!0));return}const S={Project:l.value,OtherSubsidies:r.value,BudgetPlans:b.value,Before:(w=m.value)==null?void 0:w.Form3Before,After:(U=m.value)==null?void 0:U.Form3After,Submit:g?"true":"false"};A.culture("saveFunding",S).subscribe(()=>{g?y("next"):f()})},t=()=>{let g={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=I(l.value,g),g={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},r.value.forEach((h,S)=>Object.assign(V.value,I(h,g,`other-${S}-`))),g={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},b.value.forEach((h,S)=>Object.assign(V.value,I(h,g,`plan-${S}-`))),m.value&&(g={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,I(m.value,g))),!Object.keys(V.value).length};return e.onMounted(f),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=r.value.reduce((g,h)=>g+(h.Deleted?0:R(h.Amount)),0),k.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),b.value.forEach(g=>g.sum=R(g.Amount)+R(g.OtherAmount))}),(g,h)=>{var T;const S=e.resolveComponent("input-integer"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-select"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("required-label"),C=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kn,[h[25]||(h[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Zn,[e.createElementVNode("div",Xn,[e.createElementVNode("table",vn,[h[6]||(h[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":h[0]||(h[0]=D=>e.unref(l).ApplyAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":h[1]||(h[1]=D=>e.unref(l).SelfAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",er,e.toDisplayString((T=e.unref(l).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",tr,e.toDisplayString(e.unref(k).toLocaleString()),1)])])])]),h[12]||(h[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",lr,[e.createElementVNode("table",or,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,nr)]),e.createElementVNode("tr",null,[h[7]||(h[7]=e.createElementVNode("th",{width:"1"},null,-1)),h[8]||(h[8]=e.createElementVNode("th",null,"單位名稱",-1)),h[9]||(h[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",rr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(D,j)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,e.toDisplayString(j+1),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(V)[`other-${j}-Unit`],modelValue:D.Unit,"onUpdate:modelValue":O=>D.Unit=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`other-${j}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":O=>D.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",ar,[e.createElementVNode("div",dr,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:O=>N(D),type:"button"},[...h[10]||(h[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,sr)):e.createCommentVNode("",!0),j+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...h[11]||(h[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),h[26]||(h[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",cr,[e.createElementVNode("div",ir,[e.createElementVNode("table",mr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[h[13]||(h[13]=e.createElementVNode("th",null,"重要工作項目",-1)),h[14]||(h[14]=e.createElementVNode("th",null,"預算項目",-1)),h[15]||(h[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),h[16]||(h[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),h[17]||(h[17]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),h[18]||(h[18]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",pr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(D,j)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,[e.createVNode(U,{"empty-value":0,error:e.unref(V)[`plan-${j}-ItemID`],options:e.unref(d),"text-name":"Title","value-name":"ID",modelValue:D.ItemID,"onUpdate:modelValue":O=>D.ItemID=O},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(V)[`plan-${j}-Title`],modelValue:D.Title,"onUpdate:modelValue":O=>D.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`plan-${j}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":O=>D.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`plan-${j}-OtherAmount`],modelValue:D.OtherAmount,"onUpdate:modelValue":O=>D.OtherAmount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Vr,e.toDisplayString(D.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(V)[`plan-${j}-Description`],rows:"1",modelValue:D.Description,"onUpdate:modelValue":O=>D.Description=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",fr,[e.createElementVNode("div",Nr,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:O=>p(D),type:"button"},[...h[19]||(h[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Er)):e.createCommentVNode("",!0),j+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:n,type:"button"},[...h[20]||(h[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),h[21]||(h[21]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[h[24]||(h[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",br,[e.createElementVNode("table",gr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...h[22]||(h[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(m).Form3Before,"onUpdate:modelValue":h[2]||(h[2]=D=>e.unref(m).Form3Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...h[23]||(h[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(m).Form3After,"onUpdate:modelValue":h[3]||(h[3]=D=>e.unref(m).Form3After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",kr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:h[4]||(h[4]=D=>E()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:h[5]||(h[5]=D=>E(!0)),type:"button"},[...h[27]||(h[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(C,{ref_key:"modal",ref:i},{default:e.withCtx(()=>[e.createElementVNode("div",yr,[h[28]||(h[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",ur,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(x).GrantLimit)+"萬",1),h[29]||(h[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),h[30]||(h[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},hr={class:"block"},$r={key:0,class:"text-pink lh-base mt-3"},Br={class:"border"},_r={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Cr={class:"d-flex gap-2 align-items-center flex-grow-1"},Tr={class:"text-nowrap"},wr={class:"flex-grow-1"},Dr={class:"d-flex gap-2"},Sr=["onClick"],Fr=["href"],Ar=["id"],Ur={class:"table align-middle gray-table side-table mb-0"},Mr={class:"mt-4"},Ir={class:"table align-middle gray-table side-table"},jr={key:0,class:"block-bottom bg-light-teal"},Pr={__name:"Other",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.computed(()=>z("culture",a.value.Status,4)),V=e.ref({}),a=e.ref({}),o=e.ref([]),l=e.computed(()=>o.value.filter(c=>!c.Deleted)),d=()=>o.value.push({}),i=_,r=()=>{rxjs.forkJoin([A.culture("getRelatedProject",{ID:u.id})]).subscribe(c=>{const n=c[0];a.value=n.Project,o.value=n.Projects,P().init("culture",a.value),m.value=a.value.changeApply,a.value.changeApply=void 0})},b=c=>c.Deleted=!0,x=c=>{var y,f;if(V.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:u.id,Projects:o.value,Before:(y=m.value)==null?void 0:y.Form4Before,After:(f=m.value)==null?void 0:f.Form4After,Submit:c?"true":"false"};A.culture("saveRelatedProject",n).subscribe(()=>{c?i("next"):r()})},k=()=>{let c={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return l.value.forEach((n,y)=>Object.assign(V.value,I(n,c,`project-${y}-`))),m.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(V.value,I(m.value,c))),!Object.keys(V.value).length};return e.onMounted(r),e.provide("editable",s),(c,n)=>{const y=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),N=e.resolveComponent("input-integer"),p=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hr,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("p",$r," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(E,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:E},[e.createElementVNode("div",Br,[e.createElementVNode("div",_r,[e.createElementVNode("div",Cr,[e.createElementVNode("label",Tr,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[4]||(n[4]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",wr,[e.createVNode(f,{error:e.unref(V)[`project-${t}-Title`],modelValue:E.Title,"onUpdate:modelValue":g=>E.Title=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Dr,[e.unref(s)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(g=>b(E),["prevent"]),href:"#"},"刪除",8,Sr)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,Fr)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",Ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[5]||(n[5]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{class:"text-start w-auto",error:e.unref(V)[`project-${t}-Year`],modelValue:E.Year,"onUpdate:modelValue":g=>E.Year=g},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[6]||(n[6]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(V)[`project-${t}-OrgName`],modelValue:E.OrgName,"onUpdate:modelValue":g=>E.OrgName=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[7]||(n[7]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{class:"w-auto",error:e.unref(V)[`project-${t}-Amount`],modelValue:E.Amount,"onUpdate:modelValue":g=>E.Amount=g},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[8]||(n[8]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(V)[`project-${t}-Description`],rows:"4",modelValue:E.Description,"onUpdate:modelValue":g=>E.Description=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[9]||(n[9]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(V)[`project-${t}-Benefit`],rows:"4",modelValue:E.Benefit,"onUpdate:modelValue":g=>E.Benefit=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,Ar)])]))),128)),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:d,type:"button"},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Mr,[e.createElementVNode("table",Ir,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(V).Form4Before,rows:"4",modelValue:e.unref(m).Form4Before,"onUpdate:modelValue":n[0]||(n[0]=E=>e.unref(m).Form4Before=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(V).Form4After,rows:"4",modelValue:e.unref(m).Form4After,"onUpdate:modelValue":n[1]||(n[1]=E=>e.unref(m).Form4After=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",jr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=E=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=E=>x(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Or={class:"block"},Lr={class:"text-teal fw-bold py-3"},qr={class:"table-responsive"},Rr={class:"table align-middle gray-table"},zr={class:"text-end"},Gr={class:"text-end"},Jr={class:"mt-4"},Qr={class:"table align-middle gray-table"},Hr={class:"text-center"},Yr={key:0,width:"180"},Wr={class:"text-center"},Kr=["href"],Zr={key:0,class:"text-center"},Xr={key:0},vr={key:1,class:"text-pink"},ea={key:1,class:"tag-group mt-2 gap-1"},ta={key:0,class:"tag tag-green-light"},la=["download","href"],oa=["onClick"],na={class:"block-bottom bg-light-teal"},ra=!0,aa={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(0),s=e.ref({}),V=e.ref([{Type:1,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:2,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_第一期請款_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.culture("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("culture",s.value),V.value=V.value.filter(r=>{var b;return!((b=r.Excludes)!=null&&b.includes(s.value.OrgCategory))}),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",ra),(i,r)=>{var c;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Or,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",Lr,"核定經費: "+e.toDisplayString((c=e.unref(s).ApprovedAmount)==null?void 0:c.toLocaleString())+"元",1),e.createElementVNode("div",qr,[e.createElementVNode("table",Rr,[r[5]||(r[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",zr,e.toDisplayString(e.unref(m)),1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=n=>e.isRef(m)?m.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",Gr,e.toDisplayString(e.unref(a))+"%",1),r[4]||(r[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Jr,[e.createElementVNode("table",Qr,[e.createElementVNode("thead",Hr,[e.createElementVNode("tr",null,[r[6]||(r[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[7]||(r[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Yr,"狀態")),r[8]||(r[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(n,y)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",Wr,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Kr)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Zr,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",Xr,"已上傳")):(e.openBlock(),e.createElementBlock("span",vr,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:f=>o(n,f)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,f=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:f},[f.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ta,[e.createElementVNode("a",{class:"tag-link my-1",download:f.Name,href:e.unref(l)(f.Path)},e.toDisplayString(f.Name),9,la),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>f.Deleted=!0,type:"button"},[...r[10]||(r[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,oa))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",na,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=n=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=n=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},da={class:"block"},sa={class:"text-teal fw-bold py-3"},ca={class:"text-teal fw-bold pb-3"},ia={class:"table-responsive"},ma={class:"table align-middle gray-table"},pa={class:"text-end"},Va={class:"text-end"},fa={class:"mt-4"},Na={class:"table align-middle gray-table"},Ea={class:"text-center"},ba={key:0,width:"180"},ga={class:"text-center"},ka=["href"],ya={key:0,class:"text-center"},ua={key:0},xa={key:1,class:"text-pink"},ha={key:1,class:"tag-group mt-2 gap-1"},$a={key:0,class:"tag tag-green-light"},Ba=["download","href"],_a=["onClick"],Ca={class:"block-bottom bg-light-teal"},Ta=!0,te=3e4,wa={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(3e4),s=e.ref({}),V=e.ref([{Type:1,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:2,Title:"經費分攤表",Template:"../../Template/CUL/經費分攤表.docx",Files:[]},{Type:3,Title:"補助清單",Template:"../../Template/CUL/補助清單.docx",Files:[],Excludes:["1"]},{Type:4,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_第二期請款_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.culture("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("culture",s.value),V.value=V.value.filter(r=>{var b;return!((b=r.Excludes)!=null&&b.includes(s.value.OrgCategory))}),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",Ta),(i,r)=>{var c;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",da,[r[10]||(r[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",sa,"核定經費: "+e.toDisplayString((c=e.unref(s).ApprovedAmount)==null?void 0:c.toLocaleString())+"元",1),e.createElementVNode("p",ca,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(m)).toLocaleString())+"元",1),e.createElementVNode("div",ia,[e.createElementVNode("table",ma,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",pa,e.toDisplayString(e.unref(m)-te),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(te)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=n=>e.isRef(m)?m.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",Va,e.toDisplayString(e.unref(a))+"%",1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[12]||(r[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",fa,[e.createElementVNode("table",Na,[e.createElementVNode("thead",Ea,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",ba,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(n,y)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",ga,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,ka)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",ya,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",ua,"已上傳")):(e.openBlock(),e.createElementBlock("span",xa,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:f=>o(n,f)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",ha,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,f=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:f},[f.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",$a,[e.createElementVNode("a",{class:"tag-link my-1",download:f.Name,href:e.unref(l)(f.Path)},e.toDisplayString(f.Name),9,Ba),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>f.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,_a))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Ca,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=n=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=n=>d()),type:"button"},[...r[13]||(r[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Da={class:"block rounded-top-4"},Sa={class:"horizontal-scrollable"},Fa={class:"timeline"},Aa={class:"year"},Ua={class:"month"},Ma=["onClick"],Ia={class:"square-title"},ja={class:"table-responsive mt-4"},Pa={class:"table align-middle gray-table"},Oa={class:"text-end"},La={class:"table-responsive"},qa={class:"table align-middle gray-table"},Ra={class:"text-end"},za={key:0,class:"invalid mt-0"},Ga={class:"mt-3"},Ja={class:"mt-3"},Qa=["rowspan"],Ha={key:0,class:"block-bottom bg-light-teal"},Ya={__name:"Progress",props:{id:{type:[Number,String]}},setup(B){const _=[{value:3,text:"完成"},{value:2,text:"部分完成"},{value:1,text:"未完成"}],u=B,m=e.ref(),s=e.ref({}),V=e.ref(0),a=e.ref({}),o=e.ref([]),l=e.ref({}),d=e.computed(()=>Math.round((V.value+o.value.filter(n=>n.Status===3).length)*100/i.value.length*10)/10),i=e.ref([]),r=e.ref([]),b=n=>{m.value=n,x()},x=()=>{A.culture("getMonthlyProgress",{ID:u.id,Year:m.value.year-1911,Month:m.value.month}).subscribe(n=>{const y=n.Logs,f=n.Items,N=n.Steps;let p=!1;V.value=0,l.value=n.Progress,i.value=n.Schedules,o.value=[],r.value.forEach(E=>{E.months.forEach(t=>{p||(t===m.value&&(p=!0),i.value.forEach(g=>{var h,S;if(g.Month===t.month)if(p||g.Status!==3){const w=y.find(U=>U.ScheduleID===g.ID)||{ScheduleID:g.ID,Status:g.Status};o.value.push(Object.assign(w,{Year:E.year,Month:g.Month,ItemTitle:(h=f.find(U=>U.ID===g.ItemID))==null?void 0:h.Title,Type:g.Type,StepTitle:(S=N.find(U=>U.ID===g.StepID))==null?void 0:S.Title}))}else V.value++}))})})})},k=n=>{if(s.value={},n&&!c()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}const y={ID:l.value.ID,Description:l.value.Description||"",Status:n?1:0,Logs:o.value.map(f=>({ID:f.ID||0,ScheduleID:f.ScheduleID,Status:f.Status,DelayReason:f.DelayReason||"",ImprovedWay:f.ImprovedWay||""}))};A.culture("saveMonthlyProgress",y).subscribe(f=>{f&&(window.location.href="../inprogressList.aspx")})},c=()=>{let n={Description:"實際工作執行情形"};return s.value=I(l.value,n),o.value.forEach((y,f)=>{n={Status:{numericality:{greaterThan:0,message:"^請輸入本月是否完成"}}},[1,2].includes(y.Status)&&(n.DelayReason="落後原因",n.ImprovedWay="改善措施"),Object.assign(s.value,I(y,n,`item-${f}-`))}),!Object.keys(s.value).length};return e.onMounted(()=>{A.culture("getApplication",{ID:u.id}).subscribe(n=>{a.value=n.Project,P().init("culture",a.value);const y=new Date(a.value.StartTime),f=new Date(a.value.EndTime),N=Date.now();for(;;){const p=y.getFullYear(),E=y.getMonth(),t={year:p,month:E+1,disabled:new Date(p,E,20).getTime()>N};let g=r.value.find(h=>h.year===p);if(g?g.months.push(t):r.value.push({year:p,months:[t]}),p*100+E>=f.getFullYear()*100+f.getMonth())break;y.setMonth(E+1)}})}),(n,y)=>{const f=e.resolveComponent("input-textarea"),N=e.resolveComponent("input-radio-group");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Da,[e.createElementVNode("div",Sa,[y[3]||(y[3]=e.createElementVNode("button",{class:"btn-control btn-prev",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-left"})],-1)),e.createElementVNode("ul",Fa,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),p=>(e.openBlock(),e.createElementBlock("li",{key:p},[e.createElementVNode("span",Aa,e.toDisplayString(p.year-1911)+"年",1),e.createElementVNode("ul",Ua,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.months,E=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass({active:e.unref(m)===E,disabled:E.disabled}),key:E},[e.createElementVNode("a",{onClick:t=>b(E),href:"javascript:void(0)"},e.toDisplayString(E.month)+"月",9,Ma)],2))),128))])]))),128))]),y[4]||(y[4]=e.createElementVNode("button",{class:"btn-control btn-next",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-right"})],-1))]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h5",Ia,e.toDisplayString(e.unref(m).year-1911)+"年"+e.toDisplayString(e.unref(m).month)+"月 實際進度",1),e.createElementVNode("div",ja,[e.createElementVNode("table",Pa,[y[5]||(y[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",{class:"text-center"},"實際工作執行情形（條列式說明）")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Oa,e.toDisplayString(e.unref(m).year-1911)+"年"+e.toDisplayString(e.unref(m).month)+"月",1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(s).Description,rows:"4",modelValue:e.unref(l).Description,"onUpdate:modelValue":y[0]||(y[0]=p=>e.unref(l).Description=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",La,[e.createElementVNode("table",qa,[y[8]||(y[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",null,"重要工作項目"),e.createElementVNode("th",null,"工作進度%"),e.createElementVNode("th",null,"檢核工作"),e.createElementVNode("th",null,"本月是否完成"),e.createElementVNode("th",null,"年度目標達成數")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("th",Ra,e.toDisplayString(p.Year-1911)+"年"+e.toDisplayString(p.Month)+"月",1),e.createElementVNode("td",null,e.toDisplayString(p.ItemTitle),1),e.createElementVNode("td",null,e.toDisplayString(p.Type===1?"50%":"100%"),1),e.createElementVNode("td",null,e.toDisplayString(p.StepTitle),1),e.createElementVNode("td",null,[e.createVNode(N,{options:_,modelValue:p.Status,"onUpdate:modelValue":t=>p.Status=t},null,8,["modelValue","onUpdate:modelValue"]),e.unref(s)[`item-${E}-Status`]?(e.openBlock(),e.createElementBlock("div",za,e.toDisplayString(e.unref(s)[`item-${E}-Status`]),1)):e.createCommentVNode("",!0),[1,2].includes(p.Status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",Ga,[y[6]||(y[6]=e.createElementVNode("div",{class:"text-teal pb-2"},"落後原因",-1)),e.createVNode(f,{error:e.unref(s)[`item-${E}-DelayReason`],rows:"1",modelValue:p.DelayReason,"onUpdate:modelValue":t=>p.DelayReason=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ja,[y[7]||(y[7]=e.createElementVNode("div",{class:"text-teal pb-2"},"改善措施",-1)),e.createVNode(f,{error:e.unref(s)[`item-${E}-ImprovedWay`],rows:"1",modelValue:p.ImprovedWay,"onUpdate:modelValue":t=>p.ImprovedWay=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])],64)):e.createCommentVNode("",!0)]),E?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("td",{key:0,class:"text-end",rowspan:e.unref(o).length},e.toDisplayString(e.unref(d))+"% ",9,Qa))]))),128))])])])],64)):e.createCommentVNode("",!0)]),e.unref(m)?(e.openBlock(),e.createElementBlock("div",Ha,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:y[1]||(y[1]=p=>k()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:y[2]||(y[2]=p=>k(!0)),type:"button"},[...y[9]||(y[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])):e.createCommentVNode("",!0)],64)}}},Wa={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,m)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"culture"})}}},Ka=(B,_)=>{const u=B.__vccOpts||B;for(const[m,s]of _)u[m]=s;return u},Za={class:"block"},Xa={class:"mt-4"},va={class:"table align-middle gray-table side-table"},ed={key:0,class:"d-flex align-items-center gap-2"},td={class:"input-group w-auto"},ld={class:"text-teal-dark"},od={key:1,class:"invalid mt-0"},nd={class:"square-title mt-4"},rd={class:"mt-4"},ad=["onClick"],dd={class:"d-flex flex-column gap-2"},sd={class:"mt-4 d-flex flex-column gap-2"},cd={class:"d-flex flex-column gap-3 mt-4"},id={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},md={class:"d-flex gap-2 align-items-center flex-grow-1"},pd={class:"text-nowrap"},Vd={class:"flex-grow-1"},fd={class:"d-flex gap-2"},Nd=["onClick"],Ed=["href"],bd=["id"],gd={class:"table align-middle gray-table side-table mb-0"},kd={class:"p-0"},yd={class:"item-list"},ud={class:"mt-2 align-self-start text-center"},xd={class:"input-group"},hd={key:0,class:"invalid mt-0"},$d={key:0,class:"d-flex gap-2 mt-1 align-self-start"},Bd=["onClick"],_d=["onClick"],Cd={class:"row"},Td={class:"col"},wd=["value"],Dd={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Sd=["onClick"],Fd=["onClick"],Ad={class:"col"},Ud=["value"],Md={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Id=["onClick"],jd=["onClick"],Pd=["onClick"],Od={class:"mt-4"},Ld={class:"table align-middle gray-table side-table"},qd={key:0,class:"block-bottom bg-light-teal"},Rd=Ka({__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.computed(()=>z("culture",l.value.Status,2)),V=e.computed(()=>i.value.EndDate),a=e.ref({}),o=e.computed(()=>d.value.filter(g=>!g.Deleted)),l=e.ref({}),d=e.ref([]),i=e.ref({}),r=()=>{A.culture("createGoal",{ID:u.id}).subscribe(g=>{d.value.push(Object.assign(g,{Items:[]}));const h=d.value[d.value.length-1];b(h)})},b=g=>{A.culture("createGoalItem",{ID:u.id,GoalID:g.ID}).subscribe(h=>{g.Items.push(Object.assign(h,{Steps:[],Schedules:[]}));const S=g.Items[g.Items.length-1];k(S),k(S),k(S),x(S,1),x(S,2)})},x=(g,h)=>A.culture("createGoalSchedule",{ID:u.id,ItemID:g.ID,Type:h}).subscribe(S=>g.Schedules.push(S)),k=g=>A.culture("createGoalStep",{ID:u.id,ItemID:g.ID}).subscribe(h=>g.Steps.push(h)),c=_,n=()=>{rxjs.forkJoin([A.culture("getWorkSchedule",{ID:u.id})]).subscribe(g=>{const h=g[0];l.value=h.Project,d.value=h.Goals,i.value=h.GrantType,d.value.length||r(),P().init("culture",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},y=g=>g.Deleted=!0,f=g=>g.Deleted=!0,N=g=>g.Deleted=!0,p=g=>g.Deleted=!0,E=g=>{var S,w;if(a.value={},g&&!t()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const h={Project:l.value,Goals:d.value,Before:(S=m.value)==null?void 0:S.Form2Before,After:(w=m.value)==null?void 0:w.Form2After,Submit:g?"true":"false"};A.culture("saveWorkSchedule",h).subscribe(()=>{g?c("next"):n()})},t=()=>{let g={StartTime:"計畫期程",EndTime:"計畫期程"};a.value=I(l.value,g);const h={Title:"計畫目標",Content:"預期效益"},S={Title:"重要工作項目",Indicator:"績效指標"},w={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},U={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return d.value.filter(M=>!M.Deleted).forEach((M,F)=>{Object.assign(a.value,I(M,h,`goal-${F}-`)),M.Items.filter(C=>!C.Deleted).forEach((C,T)=>{Object.assign(a.value,I(C,S,`item-${F}-${T}-`)),C.Steps.filter(D=>!D.Deleted).forEach((D,j)=>Object.assign(a.value,I(D,w,`step-${F}-${T}-${j}-`))),C.Schedules.filter(D=>D.Type===1&&!D.Deleted).forEach((D,j)=>Object.assign(a.value,I(D,U,`schedule-${F}-${T}-1-${j}-`))),C.Schedules.filter(D=>D.Type===2&&!D.Deleted).forEach((D,j)=>Object.assign(a.value,I(D,U,`schedule-${F}-${T}-2-${j}-`)))})}),m.value&&(g={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(a.value,I(m.value,g))),!Object.keys(a.value).length};return e.onMounted(n),e.provide("editable",s),(g,h)=>{const S=e.resolveComponent("required-label"),w=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),M=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),C=e.resolveComponent("input-month"),T=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Za,[h[30]||(h[30]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Xa,[e.createElementVNode("table",va,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[6]||(h[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",ed,[e.createElementVNode("div",td,[e.createVNode(w,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(l).StartTime,"onUpdate:modelValue":h[0]||(h[0]=D=>e.unref(l).StartTime=D)},null,8,["max-date","modelValue"]),h[7]||(h[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(l).EndTime,"onUpdate:modelValue":h[1]||(h[1]=D=>e.unref(l).EndTime=D)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",ld,[h[8]||(h[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(V)},null,8,["value"]),h[9]||(h[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(a).StartTime||e.unref(a).EndTime?(e.openBlock(),e.createElementBlock("div",od,e.toDisplayString(e.unref(a).StartTime||e.unref(a).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",nd,[h[11]||(h[11]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:r,type:"button"},[...h[10]||(h[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",rd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(D,j)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:D},[e.unref(s)&&e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:O=>y(D),type:"button"},"刪除",8,ad)):e.createCommentVNode("",!0),e.createElementVNode("div",dd,[h[12]||(h[12]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(a)[`goal-${j}-Title`],modelValue:D.Title,"onUpdate:modelValue":O=>D.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",sd,[h[13]||(h[13]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(F,{error:e.unref(a)[`goal-${j}-Content`],rows:"4",modelValue:D.Content,"onUpdate:modelValue":O=>D.Content=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",cd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Items.filter(O=>!O.Deleted),(O,G)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:O},[e.createElementVNode("div",id,[e.createElementVNode("div",md,[e.createElementVNode("label",pd,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[14]||(h[14]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",Vd,[e.createVNode(M,{error:e.unref(a)[`item-${j}-${G}-Title`],modelValue:O.Title,"onUpdate:modelValue":L=>O.Title=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",fd,[e.unref(s)&&D.Items.filter(L=>!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(L=>f(O),["prevent"]),href:"#"},"刪除",8,Nd)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${G}`,role:"button"},"收合",8,Ed)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${G}`},[e.createElementVNode("table",gd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[15]||(h[15]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",kd,[e.createElementVNode("ul",yd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Steps.filter(L=>!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(s)}]),key:L},[e.createElementVNode("div",ud,e.toDisplayString(String.fromCharCode(65+J)),1),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(a)[`step-${j}-${G}-${J}-Title`],placeholder:"如:進行口訪紀錄",modelValue:L.Title,"onUpdate:modelValue":q=>L.Title=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",xd,[e.createVNode(C,{"empty-value":0,modelValue:L.Begin,"onUpdate:modelValue":q=>L.Begin=q},null,8,["modelValue","onUpdate:modelValue"]),h[16]||(h[16]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(C,{"empty-value":0,modelValue:L.End,"onUpdate:modelValue":q=>L.End=q},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(a)[`step-${j}-${G}-${J}-Begin`]||e.unref(a)[`step-${j}-${G}-${J}-End`]?(e.openBlock(),e.createElementBlock("div",hd,e.toDisplayString(e.unref(a)[`step-${j}-${G}-${J}-Begin`]||e.unref(a)[`step-${j}-${G}-${J}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",$d,[O.Steps.filter(q=>!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:q=>p(L),type:"button"},[...h[17]||(h[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:q=>k(O),type:"button"},[...h[18]||(h[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,_d)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[19]||(h[19]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(a)[`item-${j}-${G}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:O.Indicator,"onUpdate:modelValue":L=>O.Indicator=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[20]||(h[20]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Cd,[e.createElementVNode("div",Td,[h[23]||(h[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Schedules.filter(L=>L.Type===1&&!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:L},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?3:4}`])},[e.createVNode(C,{error:e.unref(a)[`schedule-${j}-${G}-1-${J}-Month`],"empty-value":0,modelValue:L.Month,"onUpdate:modelValue":q=>L.Month=q},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?7:8}`])},[e.createVNode(T,{"empty-value":0,error:e.unref(a)[`schedule-${j}-${G}-1-${J}-StepID`],options:O.Steps.filter(q=>!q.Deleted),modelValue:L.StepID,"onUpdate:modelValue":q=>L.StepID=q},{default:e.withCtx(({index:q,option:W})=>[e.createElementVNode("option",{value:W.ID},e.toDisplayString(String.fromCharCode(65+q))+"."+e.toDisplayString(W.Title),9,wd)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Dd,[O.Schedules.filter(q=>q.Type===1&&!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:q=>N(L),type:"button"},[...h[21]||(h[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Sd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:q=>x(O,1),type:"button"},[...h[22]||(h[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Fd)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Ad,[h[26]||(h[26]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Schedules.filter(L=>L.Type===2&&!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:L},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?3:4}`])},[e.createVNode(C,{error:e.unref(a)[`schedule-${j}-${G}-2-${J}-Month`],"empty-value":0,modelValue:L.Month,"onUpdate:modelValue":q=>L.Month=q},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?7:8}`])},[e.createVNode(T,{"empty-value":0,error:e.unref(a)[`schedule-${j}-${G}-2-${J}-StepID`],options:O.Steps.filter(q=>!q.Deleted),modelValue:L.StepID,"onUpdate:modelValue":q=>L.StepID=q},{default:e.withCtx(({index:q,option:W})=>[e.createElementVNode("option",{value:W.ID},e.toDisplayString(String.fromCharCode(65+q))+"."+e.toDisplayString(W.Title),9,Ud)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Md,[O.Schedules.filter(q=>q.Type===2&&!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:q=>N(L),type:"button"},[...h[24]||(h[24]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Id)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:q=>x(O,2),type:"button"},[...h[25]||(h[25]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,jd)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,bd)]))),128))]),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:O=>b(D),type:"button"},"新增工作項目",8,Pd)):e.createCommentVNode("",!0)]))),128))]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[h[29]||(h[29]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Od,[e.createElementVNode("table",Ld,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[27]||(h[27]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(a).Form2Before,rows:"4",modelValue:e.unref(m).Form2Before,"onUpdate:modelValue":h[2]||(h[2]=D=>e.unref(m).Form2Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[28]||(h[28]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(a).Form2After,rows:"4",modelValue:e.unref(m).Form2After,"onUpdate:modelValue":h[3]||(h[3]=D=>e.unref(m).Form2After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",qd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:h[4]||(h[4]=D=>E()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:h[5]||(h[5]=D=>E(!0)),type:"button"},[...h[31]||(h[31]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-84d8fceb"]]),zd={class:"block"},Gd={class:"mt-4"},Jd={class:"table align-middle gray-table side-table"},Qd={key:0},Hd={key:1,class:"text-light-gray"},Yd={class:"d-flex flex-column gap-2"},Wd={key:0},Kd={class:"mt-4"},Zd={class:"table align-middle gray-table side-table"},Xd={class:"row g-3"},vd={class:"col-12 col-xl-2"},es={class:"text-gray mb-2"},ts={class:"col-12 col-xl-3"},ls={class:"text-gray mb-2"},os={key:0,class:"col-12 col-xl-4"},ns={class:"row g-1"},rs={class:"col-7"},as={class:"col-5"},ds={key:1,class:"col-12 col-xl-3"},ss={class:"text-gray mb-2"},cs={class:"mt-4"},is={class:"table align-middle gray-table side-table"},ms={class:"d-flex align-items-center gap-2"},ps={class:"input-group w-auto"},Vs={key:0,class:"invalid mt-0"},fs={class:"mt-4"},Ns={class:"table-responsive mt-3 mb-0"},Es={class:"table align-middle gray-table"},bs={class:"text-end"},gs={class:"text-end"},ks={class:"text-end"},ys={class:"text-end"},us={class:"text-end"},xs={class:"table align-middle gray-table side-table"},hs={key:0,class:"table-responsive mt-3 mb-0"},$s={class:"table align-middle gray-table"},Bs={key:0},_s={key:0},Cs={class:"d-flex gap-2"},Ts=["onClick"],ws={class:"mt-4"},Ds={class:"table align-middle gray-table side-table"},Ss={key:0,class:"block-bottom bg-light-teal"},Fs={class:"text-center"},As={class:"mb-5"},Us={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.ref(),a=e.computed(()=>z("education",d.value.Status,1)),o=e.ref({}),l=e.computed(()=>r.value.filter(E=>!E.Deleted)),d=e.ref({}),i=e.ref(),r=e.ref([]),b=e.ref(),x=e.ref(0),k=e.computed({get:()=>!!l.value.length,set:E=>{E?c():r.value.forEach(t=>t.Deleted=!0)}}),c=()=>r.value.push({}),n=_,y=()=>{A.education("getApplication",{ID:u.id}).subscribe(E=>{d.value=E.Project,V.value=E.Contacts,r.value=E.ReceivedSubsidies,d.value.OrgCategory=d.value.OrgCategory||null,P().init("education",d.value),s.value=d.value.changeApply,d.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(o.value={},E&&!p()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&b.value&&d.value.ApplyAmount>b.value.GrantLimit*1e4){i.value.show(()=>N(E,!0));return}const g={Project:d.value,Contacts:V.value,ReceivedSubsidies:r.value.filter(w=>w.ID||!w.Deleted),Before:(h=s.value)==null?void 0:h.Form1Before,After:(S=s.value)==null?void 0:S.Form1After,Submit:E?"true":"false"};A.education("saveApplication",g).subscribe(w=>{E?n("next",w.ID):d.value.ID?y():window.location.href=`Application.aspx?ID=${w.ID}`})},p=()=>{let E={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return d.value.OrgCategory==="2"&&(E.RegisteredNum="立案登記證字號"),o.value=I(d.value,E),E={Name:"姓名",JobTitle:"職稱"},Object.assign(o.value,I(V.value[0],E,"contact-0-")),E.MobilePhone="手機號碼",Object.assign(o.value,I(V.value[1],E,"contact-1-")),E={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},r.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`received-${g}-`))),s.value&&(E={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(E=>{m.value=E[0],u.id?y():A.education("getEmptyApplication").subscribe(t=>{d.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("education",d.value)})})}),e.provide("editable",a),e.watch(()=>d.value.OrgCategory,()=>{A.education("getGrantTargetSetting",{TargetTypeID:`EDC${d.value.OrgCategory}`}).subscribe(E=>{b.value=E})}),e.watchEffect(()=>{x.value=R(d.value.ApplyAmount)+R(d.value.SelfAmount)+R(d.value.OtherGovAmount)+R(d.value.OtherUnitAmount)}),(E,t)=>{const g=e.resolveComponent("required-label"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),w=e.resolveComponent("input-tw-date"),U=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-integer"),F=e.resolveComponent("input-boolean"),C=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zd,[t[52]||(t[52]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Gd,[e.createElementVNode("table",Jd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",Qd,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Hd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[22]||(t[22]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).ProjectName,modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=T=>e.unref(d).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Yd,[e.createElementVNode("div",null,[e.createVNode(S,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(m),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=T=>e.unref(d).OrgCategory=T)},null,8,["error","options","modelValue"])]),e.unref(d).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Wd,[e.createVNode(h,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(d).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=T=>e.unref(d).RegisteredNum=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":t[3]||(t[3]=T=>e.unref(d).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(d).TaxID,"onUpdate:modelValue":t[4]||(t[4]=T=>e.unref(d).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":t[5]||(t[5]=T=>e.unref(d).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[53]||(t[53]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Kd,[e.createElementVNode("table",Zd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Xd,[e.createElementVNode("div",vd,[e.createElementVNode("div",es,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[28]||(t[28]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(h,{error:e.unref(o)[`contact-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":j=>T.Name=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ts,[e.createElementVNode("div",ls,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(h,{error:e.unref(o)[`contact-${D}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":j=>T.JobTitle=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),D?(e.openBlock(),e.createElementBlock("div",os,[t[30]||(t[30]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",ns,[e.createElementVNode("div",rs,[e.createVNode(h,{modelValue:T.Phone,"onUpdate:modelValue":j=>T.Phone=j,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",as,[e.createVNode(h,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":j=>T.PhoneExt=j,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),D?(e.openBlock(),e.createElementBlock("div",ds,[e.createElementVNode("div",ss,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(h,{error:e.unref(o)[`contact-${D}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":j=>T.MobilePhone=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[54]||(t[54]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",cs,[e.createElementVNode("table",is,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[32]||(t[32]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",ms,[e.createElementVNode("div",ps,[e.createVNode(w,{class:"w-auto",modelValue:e.unref(d).StartTime,"onUpdate:modelValue":t[6]||(t[6]=T=>e.unref(d).StartTime=T)},null,8,["modelValue"]),t[33]||(t[33]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto",modelValue:e.unref(d).EndTime,"onUpdate:modelValue":t[7]||(t[7]=T=>e.unref(d).EndTime=T)},null,8,["modelValue"])]),t[34]||(t[34]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",Vs,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Target,modelValue:e.unref(d).Target,"onUpdate:modelValue":t[8]||(t[8]=T=>e.unref(d).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":t[9]||(t[9]=T=>e.unref(d).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":t[10]||(t[10]=T=>e.unref(d).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[55]||(t[55]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",fs,[t[43]||(t[43]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",Ns,[e.createElementVNode("table",Es,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",bs,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",gs,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",ks,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[40]||(t[40]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",ys,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[41]||(t[41]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[42]||(t[42]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).ApplyAmount,modelValue:e.unref(d).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=T=>e.unref(d).ApplyAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).SelfAmount,modelValue:e.unref(d).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=T=>e.unref(d).SelfAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).OtherGovAmount,modelValue:e.unref(d).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=T=>e.unref(d).OtherGovAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).OtherUnitAmount,modelValue:e.unref(d).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=T=>e.unref(d).OtherUnitAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",us,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])])]),e.createElementVNode("table",xs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[44]||(t[44]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{modelValue:e.unref(k),"onUpdate:modelValue":t[15]||(t[15]=T=>e.isRef(k)?k.value=T:null)},null,8,["modelValue"]),e.unref(k)?(e.openBlock(),e.createElementBlock("div",hs,[e.createElementVNode("table",$s,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[45]||(t[45]=e.createElementVNode("th",null,"計畫名稱",-1)),t[46]||(t[46]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Bs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`received-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":j=>T.Name=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`received-${D}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":j=>T.Amount=j},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",_s,[e.createElementVNode("div",Cs,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:j=>f(T),type:"button"},[...t[47]||(t[47]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ts)):e.createCommentVNode("",!0),D+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[48]||(t[48]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[51]||(t[51]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ws,[e.createElementVNode("table",Ds,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[49]||(t[49]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":t[16]||(t[16]=T=>e.unref(s).Form1Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[50]||(t[50]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":t[17]||(t[17]=T=>e.unref(s).Form1After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Ss,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[18]||(t[18]=T=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[19]||(t[19]=T=>N(!0)),type:"button"},[...t[56]||(t[56]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(C,{ref_key:"modal",ref:i},{default:e.withCtx(()=>{var T;return[e.createElementVNode("div",Fs,[t[57]||(t[57]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",As,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((T=e.unref(b))==null?void 0:T.GrantLimit)+"萬",1),t[58]||(t[58]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[59]||(t[59]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},Ms={class:"block"},Is={key:0,class:"text-pink lh-base mt-4"},js={class:"mt-4"},Ps={class:"table align-middle gray-table"},Os={class:"text-center"},Ls={key:0,width:"180"},qs={class:"text-center"},Rs={key:0},zs=["innerHTML"],Gs=["href"],Js={key:0,class:"text-center"},Qs={key:0},Hs={key:1,class:"text-pink"},Ys={key:1,class:"tag-group mt-2 gap-1"},Ws={key:0,class:"tag tag-green-light"},Ks=["download","href"],Zs=["onClick"],Xs={class:"mt-4"},vs={class:"table align-middle gray-table side-table"},ec={key:0,class:"block-bottom bg-light-teal"},tc=["disabled"],lc={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([{Type:1,Title:"申請表",Template:"../../Template/EDC/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/EDC/2-申請計畫書.docx",Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/EDC/3-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]}]),s=e.ref(),V=e.computed(()=>m.value.some(c=>!c.Optional&&!c.Files.filter(n=>!n.Deleted).length)),a=e.computed(()=>z("education",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},i=A.download,r=_,b=()=>{rxjs.forkJoin([A.education("getAttachment",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=m.value.filter(y=>{var f;return!((f=y.Excludes)!=null&&f.includes(l.value.OrgCategory))}),m.value.forEach(y=>{y.Files=n.Attachments.filter(f=>f.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(f=>!f.Deleted).length)}),P().init("education",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},x=c=>{var y,f;if(o.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:u.id,Attachments:m.value.reduce((N,p)=>N.concat(p.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(f=s.value)==null?void 0:f.Form5After,Submit:c?"true":"false"};A.education("saveAttachment",n).subscribe(()=>{c?r("next"):b()})},k=()=>{if(s.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,c))}return!Object.keys(o.value).length};return e.onMounted(b),e.provide("editable",a),(c,n)=>{const y=e.resolveComponent("required-label"),f=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ms,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",Is,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",js,[e.createElementVNode("table",Ps,[e.createElementVNode("thead",Os,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Ls,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",qs,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[p.Optional?(e.openBlock(),e.createElementBlock("span",Rs,e.toDisplayString(p.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p.Title),1)]),_:2},1024))]),e.unref(a)&&p.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:p.Comment},null,8,zs)):e.createCommentVNode("",!0),e.unref(a)&&p.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:p.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Gs)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Js,[p.Uploaded?(e.openBlock(),e.createElementBlock("span",Qs,"已上傳")):(e.openBlock(),e.createElementBlock("span",Hs,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(p.Multiple||!p.Uploaded)?(e.openBlock(),e.createBlock(f,{key:0,accept:".pdf",onFile:t=>d(p,t)},null,8,["onFile"])):e.createCommentVNode("",!0),p.Uploaded?(e.openBlock(),e.createElementBlock("div",Ys,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ws,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(i)(t.Path)},e.toDisplayString(t.Name),9,Ks),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:g=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Zs)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Xs,[e.createElementVNode("table",vs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(s).Form5Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form5After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",ec,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=p=>x(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,tc)])):e.createCommentVNode("",!0)],64)}}},oc={class:"block"},nc={class:"text-teal fw-bold py-3"},rc={class:"text-teal fw-bold pb-3"},ac={class:"table-responsive"},dc={class:"table align-middle gray-table"},sc={class:"text-end"},cc={class:"text-end"},ic={class:"mt-4"},mc={class:"table align-middle gray-table"},pc={class:"text-center"},Vc={key:0,width:"180"},fc={class:"text-center"},Nc=["href"],Ec={key:0,class:"text-center"},bc={key:0},gc={key:1,class:"text-pink"},kc={key:1,class:"tag-group mt-2 gap-1"},yc={key:0,class:"tag tag-green-light"},uc=["download","href"],xc=["onClick"],hc={class:"block-bottom bg-light-teal"},$c=!0,Bc=3e4,_c={__name:"Payment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(3e4),s=e.ref({}),V=e.ref([{Type:1,Title:"收支明細表",Template:"../../Template/EDC/1-收支明細表.docx",Files:[]},{Type:2,Title:"受補助清單",Template:"../../Template/EDC/2-受補助清單.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/EDC/3-經費分攤表.docx",Files:[]},{Type:4,Title:"憑證",Template:"../../Template/EDC/4-憑證.docx",Files:[]},{Type:5,Title:"領據",Template:"../../Template/EDC/5-領據.docx",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.education("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("education",s.value),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",$c),(i,r)=>{var c;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oc,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於活動結束後一個月內提交成果報告及請款）",-1)),e.createElementVNode("p",nc,"核定經費: "+e.toDisplayString((c=e.unref(s).ApprovedAmount)==null?void 0:c.toLocaleString())+"元",1),e.createElementVNode("p",rc,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(m)).toLocaleString())+"元",1),e.createElementVNode("div",ac,[e.createElementVNode("table",dc,[r[5]||(r[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",sc,e.toDisplayString(e.unref(m)-Bc),1),r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=n=>e.isRef(m)?m.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",cc,e.toDisplayString(e.unref(a))+"%",1),r[4]||(r[4]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",ic,[e.createElementVNode("table",mc,[e.createElementVNode("thead",pc,[e.createElementVNode("tr",null,[r[6]||(r[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[7]||(r[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Vc,"狀態")),r[8]||(r[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(n,y)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",fc,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Nc)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Ec,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",bc,"已上傳")):(e.openBlock(),e.createElementBlock("span",gc,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:f=>o(n,f)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",kc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,f=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:f},[f.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",yc,[e.createElementVNode("a",{class:"tag-link my-1",download:f.Name,href:e.unref(l)(f.Path)},e.toDisplayString(f.Name),9,uc),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>f.Deleted=!0,type:"button"},[...r[10]||(r[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,xc))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",hc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=n=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=n=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Cc={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(u,m)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"education"})}}},Tc={class:"modal-dialog modal-dialog-centered modal-md"},wc={class:"modal-content"},Dc={class:"modal-body"},Sc={class:"d-flex flex-column align-items-center mb-5 gap-3"},Fc={class:"fs-18"},Ac={__name:"ErrorModal",setup(B){const _=K(),u=e.ref();return e.onMounted(()=>u.value.addEventListener("hidden.bs.modal",()=>_.error=null)),e.watch(()=>_.error,()=>{_.error&&bootstrap.Modal.getOrCreateInstance(u.value).show()}),(m,s)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:u,tabindex:"-1"},[e.createElementVNode("div",Tc,[e.createElementVNode("div",wc,[s[2]||(s[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Dc,[e.createElementVNode("div",Sc,[s[0]||(s[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",Fc,e.toDisplayString(e.unref(_).error),1)]),s[1]||(s[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},Uc={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const _=e.useModel(B,"modelValue"),u=[{value:!0,text:"是"},{value:!1,text:"否"}];return(m,s)=>{const V=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(V,{options:u,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=a=>_.value=a)},null,8,["modelValue"])}}},Mc=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(B,{emit:_}){const u=e.ref(),m=()=>{Array.from(u.value.files).forEach(V=>A.upload(V).subscribe(a=>s("file",a))),u.value.value=""},s=_;return(V,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:a[0]||(a[0]=o=>e.unref(u).click()),type:"button"},[...a[1]||(a[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:m,class:"d-none",ref_key:"input",ref:u,type:"file"},V.$attrs),null,16)],64))}}),Ic=["disabled","placeholder","type"],jc={key:0,class:"invalid mt-0"},Pc=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),u=e.useModel(B,"modelValue");return e.watch(u,m=>{if(m){const s=(parseInt(m)||0).toString();m.toString()!==s&&(u.value=s)}}),(m,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?B.placeholder:"",style:{"text-align":"right"},type:B.type},m.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=V=>u.value=V)}),null,16,Ic),[[e.vModelDynamic,u.value]]),B.error?(e.openBlock(),e.createElementBlock("div",jc,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),Oc={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const _=e.useModel(B,"modelValue"),u=[];for(let m=1;m<=12;m++)u.push({value:m,text:`${m}月`});return(m,s)=>{const V=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(V,{options:u,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=a=>_.value=a)},null,8,["modelValue"])}}},Lc=["onChange","checked","disabled","id","value"],qc=["for"],Rc={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>re(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),u=e.useModel(B,"modelValue"),m=s=>{u.value=s};return(s,V)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,a=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:a},[e.createElementVNode("input",{onChange:o=>m(a[B.valueName]),checked:a[B.valueName]===u.value,class:"form-check-input",disabled:!e.unref(_),id:`${B.id}-${a[B.valueName]}`,type:"radio",value:a[B.valueName]},null,40,Lc),e.createElementVNode("label",{class:"form-check-label",for:`${B.id}-${a[B.valueName]}`},e.toDisplayString(a[B.textName]),9,qc)]))),128))}},zc=["disabled"],Gc=["value"],Jc=["value"],Qc={key:0,class:"invalid mt-0"},Hc=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),u=e.useModel(B,"modelValue");return(m,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:B.disabled||!e.unref(_)},m.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=V=>u.value=V)}),[e.unref(_)&&!u.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:B.emptyValue},e.toDisplayString(B.placeholder),9,Gc)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,(V,a)=>e.renderSlot(m.$slots,"default",{key:V,index:a,option:V},()=>[e.createElementVNode("option",{value:V[B.valueName]},e.toDisplayString(V[B.textName]),9,Jc)])),128))],16,zc),[[e.vModelSelect,u.value]]),B.error?(e.openBlock(),e.createElementBlock("div",Qc,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),Yc={class:"input-group"},Wc={key:0,class:"input-group-text"},Kc=["disabled","placeholder","type"],Zc={key:0,class:"invalid mt-0"},Xc=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),u=e.useModel(B,"modelValue"),m=B;return m.maxLength&&e.watch(u,()=>{var s;((s=u.value)==null?void 0:s.length)>m.maxLength&&(u.value=u.value.substring(0,m.maxLength))}),(s,V)=>{const a=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Yc,[B.prefix?(e.openBlock(),e.createElementBlock("span",Wc,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?B.placeholder:"",type:B.type},s.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=o=>u.value=o)}),null,16,Kc),[[e.vModelDynamic,u.value]])]),B.error?(e.openBlock(),e.createElementBlock("div",Zc,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),vc=["disabled","placeholder"],ei={key:0,class:"fs-14 text-gray mt-2"},ti={class:"text-pink"},li={key:1,class:"invalid mt-0"},oi=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),u=e.useModel(B,"modelValue"),m=B;return m.maxLength&&e.watch(u,()=>{var s;((s=u.value)==null?void 0:s.length)>m.maxLength&&(u.value=u.value.substring(0,m.maxLength))}),(s,V)=>{var a;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?B.placeholder:""},s.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=o=>u.value=o)}),null,16,vc),[[e.vModelText,u.value]]),e.unref(_)&&B.maxLength?(e.openBlock(),e.createElementBlock("div",ei,[V[1]||(V[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",ti,e.toDisplayString(((a=u.value)==null?void 0:a.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(B.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),B.error?(e.openBlock(),e.createElementBlock("div",li,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),ni=["disabled"],ri={key:0,class:"invalid"},ai=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(B,{emit:_}){let u;const m=B,s=e.ref(),V=e.inject("editable",!0),a=e.ref(),o=_,l=d=>{!d&&m.modelValue&&(d=moment(new Date(m.modelValue))),d?(s.value=d.format(m.displayFormat),o("update:modelValue",d.format(m.format))):(s.value="",o("update:modelValue","")),u.setStartDate(s.value||void 0)};return e.onMounted(()=>{const d=$(a.value);d.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:m.drops,locale:{format:m.displayFormat},maxDate:m.maxDate?new Date(m.maxDate):m.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(i,r)=>l(r.startDate)),u=d.data("daterangepicker"),l()}),e.onUnmounted(()=>u.remove()),e.watch(()=>m.modelValue,()=>l()),(d,i)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(V),ref_key:"element",ref:a,type:"text"},d.$attrs,{"onUpdate:modelValue":i[0]||(i[0]=r=>e.isRef(s)?s.value=r:null)}),null,16,ni),[[e.vModelText,e.unref(s)]]),B.error?(e.openBlock(),e.createElementBlock("div",ri,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),di={key:0,class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},si={class:"pagination","aria-label":"Pagination"},ci=["disabled"],ii={key:1,class:"pagination-item ellipsis",type:"button"},mi=["onClick"],pi={class:"page-number"},Vi={key:2,class:"pagination-item ellipsis",type:"button"},fi={class:"page-number"},Ni=["disabled"],Ei={class:"page-number-control"},bi={class:"page-number-control-item"},gi=["selected","value"],ki={class:"page-number-control-item"},yi=["value","selected"],ui={__name:"ListPager",props:{count:{required:!0,type:Number},page:{required:!0,type:Number},pageSize:{required:!0,type:Number},slots:{default:3,type:Number}},emits:["change"],setup(B,{emit:_}){const u={},m=B,s=e.computed(()=>Math.ceil(m.count/m.pageSize)),V=(o,l)=>{l&&(o=Math.min(o,Math.ceil(m.count/l))),1<=o&&o<=s.value&&a("change",o,l||m.pageSize)},a=_;return e.watchEffect(()=>{u.from=m.page-parseInt(m.slots/2),u.to=m.page+parseInt((m.slots-1)/2),u.pages=[];for(let o=u.from;o<=u.to;o++)0<o&&o<=s.value&&u.pages.push(o)}),(o,l)=>m.count?(e.openBlock(),e.createElementBlock("div",di,[e.createElementVNode("nav",si,[e.createElementVNode("button",{"aria-label":"Previous page",class:"nav-button",onClick:l[0]||(l[0]=d=>V(B.page-1)),disabled:B.page===1,type:"button"},[...l[6]||(l[6]=[e.createElementVNode("i",{class:"fas fa-chevron-left"},null,-1)])],8,ci),u.from>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"pagination-item",onClick:l[1]||(l[1]=d=>V(1)),type:"button"},[...l[7]||(l[7]=[e.createElementVNode("span",{class:"page-number"},"1",-1)])])):e.createCommentVNode("",!0),u.from>2?(e.openBlock(),e.createElementBlock("button",ii,[...l[8]||(l[8]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.pages,d=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["pagination-item",{active:B.page===d}]),onClick:i=>V(d),key:d,type:"button"},[e.createElementVNode("span",pi,e.toDisplayString(d),1)],10,mi))),128)),e.unref(s)>u.to+1?(e.openBlock(),e.createElementBlock("button",Vi,[...l[9]||(l[9]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),e.unref(s)>u.to?(e.openBlock(),e.createElementBlock("button",{key:3,class:"pagination-item",onClick:l[2]||(l[2]=d=>V(e.unref(s))),type:"button"},[e.createElementVNode("span",fi,e.toDisplayString(e.unref(s)),1)])):e.createCommentVNode("",!0),e.createElementVNode("button",{"aria-label":"Next page",class:"nav-button",onClick:l[3]||(l[3]=d=>V(B.page+1)),type:"button",disabled:B.page===e.unref(s)},[...l[10]||(l[10]=[e.createElementVNode("i",{class:"fas fa-chevron-right"},null,-1)])],8,Ni)]),e.createElementVNode("div",Ei,[e.createElementVNode("div",bi,[l[11]||(l[11]=e.createElementVNode("span",null,"跳到",-1)),e.createElementVNode("select",{onChange:l[4]||(l[4]=d=>V(d.target.value)),class:"form-select jump-to-page"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),d=>(e.openBlock(),e.createElementBlock("option",{key:d,selected:d===B.page,value:d},e.toDisplayString(d),9,gi))),128))],32),l[12]||(l[12]=e.createElementVNode("span",null,"頁",-1)),l[13]||(l[13]=e.createElementVNode("span",null,",",-1))]),e.createElementVNode("div",ki,[l[14]||(l[14]=e.createElementVNode("span",null,"每頁顯示",-1)),e.createElementVNode("select",{onChange:l[5]||(l[5]=d=>V(B.page,d.target.value)),class:"form-select"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList([10,20,30],d=>e.createElementVNode("option",{value:d,selected:d===B.pageSize},e.toDisplayString(d),9,yi)),64))],32),l[15]||(l[15]=e.createElementVNode("span",null,"筆",-1))])])])):e.createCommentVNode("",!0)}},xi={class:"block"},hi={class:"mt-4"},$i={class:"table align-middle gray-table side-table"},Bi={key:0},_i={key:1,class:"text-light-gray"},Ci={class:"mt-4"},Ti={class:"table align-middle gray-table side-table"},wi={class:"row g-3"},Di={class:"col-12 col-xl-2"},Si={class:"text-gray mb-2"},Fi={class:"col-12 col-xl-3"},Ai={class:"text-gray mb-2"},Ui={class:"col-12 col-xl-4"},Mi={class:"row g-1"},Ii={class:"col-7"},ji={class:"col-5"},Pi={class:"col-12 col-xl-3"},Oi={class:"text-gray mb-2"},Li={class:"col-12"},qi={class:"text-gray mb-2"},Ri={class:"mt-4"},zi={class:"table align-middle gray-table side-table"},Gi={class:"mt-4"},Ji={class:"table align-middle gray-table side-table"},Qi={key:0,class:"table-responsive mt-3 mb-0"},Hi={class:"table align-middle gray-table"},Yi={key:0},Wi={key:0},Ki={class:"d-flex gap-2"},Zi=["onClick"],Xi={class:"mt-4"},vi={class:"table align-middle gray-table side-table"},em={key:0,class:"block-bottom bg-light-teal"},tm={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.ref(),V=e.computed(()=>z("literacy",d.value.Status,1)),a=e.ref({}),o=e.ref([]),l=e.computed(()=>i.value.filter(f=>!f.Deleted)),d=e.ref({}),i=e.ref([]),r=e.computed({get:()=>!!l.value.length,set:f=>{f?b():i.value.forEach(N=>N.Deleted=!0)}}),b=()=>i.value.push({}),x=_,k=()=>{A.literacy("getApplication",{ID:u.id}).subscribe(f=>{d.value=f.Project,m.value=f.Contacts,i.value=f.PreviousStudies,P().init("literacy",d.value),s.value=d.value.changeApply,d.value.changeApply=void 0})},c=f=>f.Deleted=!0,n=f=>{var p,E;if(a.value={},f&&!y()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:d.value,Contacts:m.value,PreviousStudies:i.value.filter(t=>t.ID||!t.Deleted),Before:(p=s.value)==null?void 0:p.Form1Before,After:(E=s.value)==null?void 0:E.Form1After,Submit:f?"true":"false"};A.literacy("saveApplication",N).subscribe(t=>{f?x("next",t.ID):d.value.ID?k():window.location.href=`Application.aspx?ID=${t.ID}`})},y=()=>{let f={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value=I(d.value,f),f={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},m.value.forEach((N,p)=>Object.assign(a.value,I(N,f,`contact-${p}-`))),f={Title:"研習/課程名稱",TheDate:"辦理日期"},i.value.forEach((N,p)=>Object.assign(a.value,I(N,f,`study-${p}-`))),s.value&&(f={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(a.value,I(s.value,f))),!Object.keys(a.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(f=>{o.value=f[0],u.id?k():A.literacy("getEmptyApplication").subscribe(N=>{d.value=Object.assign({Field:null,FormStep:1,Status:1},N),m.value=[{Role:"申請人"}],P().init("literacy",d.value)})})}),e.provide("editable",V),e.watch(()=>[d.value.Field,d.value.OrgName],()=>{var f;if(V.value){const N=[];d.value.Field&&N.push((f=o.value.find(p=>p.Code===d.value.Field))==null?void 0:f.Descname),d.value.OrgName&&N.push(d.value.OrgName),d.value.ProjectName=N.join("-")}}),(f,N)=>{const p=e.resolveComponent("required-label"),E=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),g=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xi,[N[40]||(N[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",hi,[e.createElementVNode("table",$i,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[14]||(N[14]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).Year),1)]),e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(d).ProjectID?(e.openBlock(),e.createElementBlock("span",Bi,e.toDisplayString(e.unref(d).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",_i,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[16]||(N[16]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(d).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[17]||(N[17]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{disabled:"",modelValue:e.unref(d).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=w=>e.unref(d).ProjectName=w),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(a).Field,options:e.unref(o),"text-name":"Descname","value-name":"Code",modelValue:e.unref(d).Field,"onUpdate:modelValue":N[1]||(N[1]=w=>e.unref(d).Field=w)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(a).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(d).OrgName,"onUpdate:modelValue":N[2]||(N[2]=w=>e.unref(d).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(a).OrgLeader,modelValue:e.unref(d).OrgLeader,"onUpdate:modelValue":N[3]||(N[3]=w=>e.unref(d).OrgLeader=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(a).Address,placeholder:"請輸入地址",modelValue:e.unref(d).Address,"onUpdate:modelValue":N[4]||(N[4]=w=>e.unref(d).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[41]||(N[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ci,[e.createElementVNode("table",Ti,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",wi,[e.createElementVNode("div",Di,[e.createElementVNode("div",Si,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(a)[`contact-${U}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fi,[e.createElementVNode("div",Ai,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(a)[`contact-${U}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ui,[N[24]||(N[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Mi,[e.createElementVNode("div",Ii,[e.createVNode(E,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ji,[e.createVNode(E,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Pi,[e.createElementVNode("div",Oi,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[25]||(N[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(a)[`contact-${U}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Li,[e.createElementVNode("div",qi,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(a)[`contact-${U}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[42]||(N[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Ri,[e.createElementVNode("table",zi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[28]||(N[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(g,{error:e.unref(a).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(d).Target,"onUpdate:modelValue":N[5]||(N[5]=w=>e.unref(d).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[29]||(N[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(d).Summary,"onUpdate:modelValue":N[6]||(N[6]=w=>e.unref(d).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Quantified,"onUpdate:modelValue":N[7]||(N[7]=w=>e.unref(d).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(d).Qualitative,"onUpdate:modelValue":N[8]||(N[8]=w=>e.unref(d).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Gi,[e.createElementVNode("table",Ji,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[36]||(N[36]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(h,{modelValue:e.unref(r),"onUpdate:modelValue":N[9]||(N[9]=w=>e.isRef(r)?r.value=w:null)},null,8,["modelValue"]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Qi,[e.createElementVNode("table",Hi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[32]||(N[32]=e.createElementVNode("th",null,"研習/課程名稱",-1)),N[33]||(N[33]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Yi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(a)[`study-${U}-Title`],modelValue:w.Title,"onUpdate:modelValue":M=>w.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(a)[`study-${U}-TheDate`],modelValue:w.TheDate,"onUpdate:modelValue":M=>w.TheDate=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Wi,[e.createElementVNode("div",Ki,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>c(w),type:"button"},[...N[34]||(N[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Zi)):e.createCommentVNode("",!0),U+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...N[35]||(N[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[N[39]||(N[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Xi,[e.createElementVNode("table",vi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[37]||(N[37]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":N[10]||(N[10]=w=>e.unref(s).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...N[38]||(N[38]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":N[11]||(N[11]=w=>e.unref(s).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",em,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[12]||(N[12]=w=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[13]||(N[13]=w=>n(!0)),type:"button"},[...N[43]||(N[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},lm={class:"block"},om={key:0,class:"text-pink lh-base mt-4"},nm={class:"mt-4"},rm={class:"table align-middle gray-table"},am={class:"text-center"},dm={key:0,width:"180"},sm={class:"text-center"},cm={key:0},im=["innerHTML"],mm=["href"],pm={key:0,class:"text-center"},Vm={key:0},fm={key:1,class:"text-pink"},Nm={key:1,class:"tag-group mt-2 gap-1"},Em={key:0,class:"tag tag-green-light"},bm=["download","href"],gm=["onClick"],km={class:"mt-4"},ym={class:"table align-middle gray-table side-table"},um={key:0,class:"block-bottom bg-light-teal"},xm=["disabled"],hm={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([{Type:1,Title:"申請表",Template:"../../Template/LIT/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/LIT/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/LIT/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/LIT/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),V=e.computed(()=>m.value.some(c=>!c.Optional&&!c.Files.filter(n=>!n.Deleted).length)),a=e.computed(()=>z("literacy",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},i=A.download,r=_,b=()=>{rxjs.forkJoin([A.literacy("getAttachment",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=m.value.filter(y=>{var f;return!((f=y.Excludes)!=null&&f.includes(l.value.OrgCategory))}),m.value.forEach(y=>{y.Files=n.Attachments.filter(f=>f.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(f=>!f.Deleted).length)}),P().init("literacy",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},x=c=>{var y,f;if(o.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:u.id,Attachments:m.value.reduce((N,p)=>N.concat(p.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(f=s.value)==null?void 0:f.Form5After,Submit:c?"true":"false"};A.literacy("saveAttachment",n).subscribe(()=>{c?r("next"):b()})},k=()=>{if(s.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,c))}return!Object.keys(o.value).length};return e.onMounted(b),e.provide("editable",a),(c,n)=>{const y=e.resolveComponent("required-label"),f=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",lm,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",om,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",nm,[e.createElementVNode("table",rm,[e.createElementVNode("thead",am,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",dm,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",sm,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[p.Optional?(e.openBlock(),e.createElementBlock("span",cm,e.toDisplayString(p.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p.Title),1)]),_:2},1024))]),e.unref(a)&&p.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:p.Comment},null,8,im)):e.createCommentVNode("",!0),e.unref(a)&&p.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:p.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,mm)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",pm,[p.Uploaded?(e.openBlock(),e.createElementBlock("span",Vm,"已上傳")):(e.openBlock(),e.createElementBlock("span",fm,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(p.Multiple||!p.Uploaded)?(e.openBlock(),e.createBlock(f,{key:0,accept:".pdf",onFile:t=>d(p,t)},null,8,["onFile"])):e.createCommentVNode("",!0),p.Uploaded?(e.openBlock(),e.createElementBlock("div",Nm,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Em,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(i)(t.Path)},e.toDisplayString(t.Name),9,bm),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:g=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,gm)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",km,[e.createElementVNode("table",ym,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(s).Form5Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form5After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",um,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=p=>x(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,xm)])):e.createCommentVNode("",!0)],64)}}},$m={class:"block"},Bm={class:"mt-4"},_m={class:"table-responsive mt-3 mb-0"},Cm={class:"table align-middle gray-table"},Tm={key:0,width:"1"},wm={key:0},Dm={class:"d-flex gap-2"},Sm=["onClick"],Fm={class:"table-responsive mt-3 mb-0"},Am={class:"table align-middle gray-table"},Um={class:"mt-4"},Mm={class:"table align-middle gray-table side-table"},Im={key:0,class:"block-bottom bg-light-teal"},jm={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.computed(()=>z("literacy",l.value.Status,4)),a=e.ref({}),o=e.computed(()=>m.value.filter(c=>!c.Deleted)),l=e.ref({}),d=()=>m.value.push({}),i=_,r=()=>{rxjs.forkJoin([A.literacy("getBenefit",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=n.Benefits,m.value.length||d(),P().init("literacy",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},b=c=>c.Deleted=!0,x=c=>{var y,f;if(a.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Benefits:m.value,Before:(y=s.value)==null?void 0:y.Form4Before,After:(f=s.value)==null?void 0:f.Form4After,Submit:c?"true":"false"};A.literacy("saveBenefit",n).subscribe(()=>{c?i("next"):r()})},k=()=>{let c={Benefit:"不可量化成果"};return a.value=I(l.value,c),c={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((n,y)=>Object.assign(a.value,I(n,c,`item-${y}-`))),s.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,I(s.value,c))),!Object.keys(a.value).length};return e.onMounted(r),e.provide("editable",V),(c,n)=>{const y=e.resolveComponent("input-text"),f=e.resolveComponent("input-textarea"),N=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",$m,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Bm,[e.createElementVNode("div",_m,[e.createElementVNode("table",Cm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Tm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${E}-Title`],modelValue:p.Title,"onUpdate:modelValue":t=>p.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${E}-Target`],modelValue:p.Target,"onUpdate:modelValue":t=>p.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a)[`item-${E}-Description`],rows:"1",modelValue:p.Description,"onUpdate:modelValue":t=>p.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",wm,[e.createElementVNode("div",Dm,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>b(p),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Sm)):e.createCommentVNode("",!0),E+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Fm,[e.createElementVNode("table",Am,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(l).Benefit=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Um,[e.createElementVNode("table",Mm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form4Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":n[2]||(n[2]=p=>e.unref(s).Form4After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Im,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=p=>x(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Pm={class:"block"},Om={class:"mt-4"},Lm={class:"table-responsive mt-3 mb-0"},qm={class:"table align-middle gray-table"},Rm={class:"text-end"},zm={class:"text-end"},Gm={class:"table-responsive"},Jm={class:"table align-middle gray-table"},Qm=["colspan"],Hm={key:0,width:"1"},Ym={class:"text-end"},Wm={key:0},Km={class:"d-flex gap-2"},Zm=["onClick"],Xm={class:"mt-4"},vm={class:"table-responsive mt-3 mb-0"},ep={class:"table align-middle gray-table"},tp={key:0,width:"1"},lp={class:"text-end"},op={key:0},np={class:"d-flex gap-2"},rp=["onClick"],ap={class:"mt-4"},dp={class:"table align-middle gray-table side-table"},sp={key:0,class:"block-bottom bg-light-teal"},cp={class:"text-center"},ip={class:"mb-5"},mp={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.computed(()=>z("literacy",l.value.Status,3)),V=e.ref({}),a=e.computed(()=>i.value.filter(E=>!E.Deleted)),o=e.computed(()=>r.value.filter(E=>!E.Deleted)),l=e.ref({}),d=e.ref(),i=e.ref([]),r=e.ref([]),b=e.ref({}),x=e.ref(0),k=()=>i.value.push({}),c=()=>r.value.push({}),n=_,y=()=>{rxjs.forkJoin([A.literacy("getFunding",{ID:u.id})]).subscribe(E=>{const t=E[0];l.value=t.Project,i.value=t.OtherSubsidies,r.value=t.BudgetPlans,b.value=t.GrantTargetSetting,i.value.length||k(),r.value.length||c(),P().init("literacy",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(V.value={},E&&!p()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>b.value.GrantLimit*1e4){d.value.show(()=>N(E,!0));return}const g={Project:l.value,OtherSubsidies:i.value,BudgetPlans:r.value,Before:(h=m.value)==null?void 0:h.Form3Before,After:(S=m.value)==null?void 0:S.Form3After,Submit:E?"true":"false"};A.literacy("saveFunding",g).subscribe(()=>{E?n("next"):y()})},p=()=>{let E={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=I(l.value,E),E={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},i.value.forEach((t,g)=>Object.assign(V.value,I(t,E,`other-${g}-`))),E={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,g)=>Object.assign(V.value,I(t,E,`plan-${g}-`))),m.value&&(E={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,I(m.value,E))),!Object.keys(V.value).length};return e.onMounted(y),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=a.value.reduce((E,t)=>E+R(t.Amount),0),x.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),a.value.forEach(E=>E.percent=Math.round(R(E.Amount)/l.value.OtherAmount*1e4)/100),r.value.forEach(E=>E.sum=R(E.Amount)+R(E.OtherAmount))}),(E,t)=>{var M;const g=e.resolveComponent("input-integer"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),U=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pm,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Om,[e.createElementVNode("div",Lm,[e.createElementVNode("table",qm,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(l).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(l).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Rm,e.toDisplayString((M=e.unref(l).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",zm,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Gm,[e.createElementVNode("table",Jm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Qm)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",Hm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,C)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`other-${C}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":T=>F.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`other-${C}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Ym,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`other-${C}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":T=>F.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",Wm,[e.createElementVNode("div",Km,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>f(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Zm)):e.createCommentVNode("",!0),C+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Xm,[e.createElementVNode("div",vm,[e.createElementVNode("table",ep,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",tp,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(F,C)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`plan-${C}-Title`],modelValue:F.Title,"onUpdate:modelValue":T=>F.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":T=>F.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",lp,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`plan-${C}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":T=>F.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",op,[e.createElementVNode("div",np,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>f(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,rp)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ap,[e.createElementVNode("table",dp,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(m).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(m).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(m).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(m).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",sp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>N(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(U,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",cp,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",ip,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(b).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},pp={class:"block"},Vp={class:"text-teal fw-bold py-3"},fp={class:"table-responsive"},Np={class:"table align-middle gray-table"},Ep={class:"text-end"},bp={class:"mt-4"},gp={class:"table align-middle gray-table"},kp={class:"text-center"},yp={key:0,width:"180"},up={class:"text-center"},xp=["href"],hp={key:0,class:"text-center"},$p={key:0},Bp={key:1,class:"text-pink"},_p={key:1,class:"tag-group mt-2 gap-1"},Cp={key:0,class:"tag tag-green-light"},Tp=["download","href"],wp=["onClick"],Dp={class:"block-bottom bg-light-teal"},Sp=!0,Fp={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(0),s=e.ref({}),V=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]}]);e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0);const a=(d,i)=>{i.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:i.Path,Name:s.value.ProjectID+"_請款_"+(d.Multiple?i.Name:`${d.Title}.pdf`)})},o=A.download,l=d=>{};return e.onMounted(()=>{A.literacy("findApplication",{ID:u.id}).subscribe(d=>{s.value=d.Project,P().init("literacy",s.value),V.value=V.value.filter(i=>{var r;return!((r=i.Excludes)!=null&&r.includes(s.value.OrgCategory))}),V.value.forEach(i=>{i.Uploaded=e.computed(()=>i.Files.filter(r=>!r.Deleted).length)})})}),e.provide("editable",Sp),(d,i)=>{var x;const r=e.resolveComponent("required-label"),b=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",pp,[i[12]||(i[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後進行請款，預撥100%）",-1)),e.createElementVNode("p",Vp,"核定經費: "+e.toDisplayString((x=e.unref(s).ApprovedAmount)==null?void 0:x.toLocaleString())+"元",1),e.createElementVNode("div",fp,[e.createElementVNode("table",Np,[i[6]||(i[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Ep,e.toDisplayString(e.unref(s).ApprovedAmount),1),i[2]||(i[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),i[3]||(i[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),i[4]||(i[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),i[5]||(i[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),i[13]||(i[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),i[14]||(i[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",bp,[e.createElementVNode("table",gp,[e.createElementVNode("thead",kp,[e.createElementVNode("tr",null,[i[7]||(i[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),i[8]||(i[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",yp,"狀態")),i[9]||(i[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(k,c)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",up,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Title),1)]),_:2},1024)]),k.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:k.Template,style:{width:"140px"},type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,xp)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",hp,[k.Uploaded?(e.openBlock(),e.createElementBlock("span",$p,"已上傳")):(e.openBlock(),e.createElementBlock("span",Bp,"尚未上傳"))])),e.createElementVNode("td",null,[k.Multiple||!k.Uploaded?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:n=>a(k,n)},null,8,["onFile"])):e.createCommentVNode("",!0),k.Uploaded?(e.openBlock(),e.createElementBlock("div",_p,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Cp,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(o)(n.Path)},e.toDisplayString(n.Name),9,Tp),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>n.Deleted=!0,type:"button"},[...i[11]||(i[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,wp))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Dp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[0]||(i[0]=k=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[1]||(i[1]=k=>l()),type:"button"},[...i[15]||(i[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Ap={class:"block"},Up={class:"text-teal fw-bold py-3"},Mp={class:"text-teal fw-bold pb-3"},Ip={class:"table-responsive"},jp={class:"table align-middle gray-table"},Pp={class:"text-end"},Op={class:"text-end"},Lp={class:"text-end"},qp={class:"mt-4"},Rp={class:"table align-middle gray-table"},zp={class:"text-center"},Gp={key:0,width:"180"},Jp={class:"text-center"},Qp=["href"],Hp={key:0,class:"text-center"},Yp={key:0},Wp={key:1,class:"text-pink"},Kp={key:1,class:"tag-group mt-2 gap-1"},Zp={key:0,class:"tag tag-green-light"},Xp=["download","href"],vp=["onClick"],eV={class:"block-bottom bg-light-teal"},tV=!0,lV={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(8e4),s=e.ref({}),V=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/LIT/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/LIT/3-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/LIT/4-補助清單.docx",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_結案核銷_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.literacy("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("literacy",s.value),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",tV),(i,r)=>{var c;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ap,[r[10]||(r[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",Up,"核定經費: "+e.toDisplayString((c=e.unref(s).ApprovedAmount)==null?void 0:c.toLocaleString())+"元",1),e.createElementVNode("p",Mp,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(m)).toLocaleString())+"元",1),e.createElementVNode("div",Ip,[e.createElementVNode("table",jp,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",Pp,e.toDisplayString(e.unref(s).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=n=>e.isRef(m)?m.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",Op,e.toDisplayString(e.unref(a))+"%",1),e.createElementVNode("td",Lp,e.toDisplayString(e.unref(a))+"%",1)])])])]),r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[12]||(r[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",qp,[e.createElementVNode("table",Rp,[e.createElementVNode("thead",zp,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Gp,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(n,y)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",Jp,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Qp)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Hp,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",Yp,"已上傳")):(e.openBlock(),e.createElementBlock("span",Wp,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:f=>o(n,f)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",Kp,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,f=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:f},[f.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Zp,[e.createElementVNode("a",{class:"tag-link my-1",download:f.Name,href:e.unref(l)(f.Path)},e.toDisplayString(f.Name),9,Xp),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>f.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,vp))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",eV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=n=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=n=>d()),type:"button"},[...r[13]||(r[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},oV={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,m)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"literacy"})}}},nV={class:"block"},rV={class:"mt-4"},aV={class:"table align-middle gray-table side-table"},dV={key:0,class:"d-flex align-items-center gap-2"},sV={class:"input-group w-auto"},cV={class:"text-teal-dark"},iV={key:1,class:"invalid mt-0"},mV={class:"table-responsive mt-4"},pV={class:"table align-middle gray-table"},VV={key:0},fV={class:"input-group"},NV={key:0,class:"invalid mt-0"},EV={key:0},bV={class:"d-flex gap-2"},gV=["onClick"],kV={class:"mt-4"},yV={class:"table align-middle gray-table"},uV={key:0},xV=["value"],hV={key:0},$V={class:"d-flex gap-2"},BV=["onClick"],_V={class:"mt-4"},CV={class:"table align-middle gray-table side-table"},TV={key:0,class:"block-bottom bg-light-teal"},wV={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),V=e.computed(()=>r.value.EndDate),a=e.computed(()=>z("literacy",i.value.Status,2)),o=e.ref({}),l=e.computed(()=>b.value.filter(E=>!E.Deleted)),d=e.computed(()=>x.value.filter(E=>!E.Deleted)),i=e.ref({}),r=e.ref({}),b=e.ref([]),x=e.ref([]),k=()=>A.literacy("createItem",{ID:u.id}).subscribe(E=>b.value.push(E)),c=()=>x.value.push({Type:0,ItemID:0}),n=_,y=()=>{rxjs.forkJoin([A.literacy("getWorkSchedule",{ID:u.id})]).subscribe(E=>{const t=E[0];i.value=t.Project,r.value=t.GrantType,b.value=t.Items,x.value=t.Schedules,b.value.length||k(),x.value.length||c(),P().init("literacy",i.value),s.value=i.value.changeApply,i.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=E=>{var g,h;if(o.value={},E&&!p()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:i.value,Items:b.value,Schedules:x.value,Before:(g=s.value)==null?void 0:g.Form2Before,After:(h=s.value)==null?void 0:h.Form2After,Submit:E?"true":"false"};A.literacy("saveWorkSchedule",t).subscribe(()=>{E?n("next"):y()})},p=()=>{let E={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=I(i.value,E),E={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`item-${g}-`))),E={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`schedule-${g}-`))),s.value&&(E={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",a),(E,t)=>{const g=e.resolveComponent("required-label"),h=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nV,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",rV,[e.createElementVNode("table",aV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",dV,[e.createElementVNode("div",sV,[e.createVNode(h,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(i).StartTime,"onUpdate:modelValue":t[0]||(t[0]=C=>e.unref(i).StartTime=C)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(i).EndTime,"onUpdate:modelValue":t[1]||(t[1]=C=>e.unref(i).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",cV,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(V)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",iV,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",mV,[e.createElementVNode("table",pV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",VV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`item-${T}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",fV,[e.createVNode(U,{"empty-value":0,modelValue:C.Begin,"onUpdate:modelValue":D=>C.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(U,{"empty-value":0,modelValue:C.End,"onUpdate:modelValue":D=>C.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",NV,e.toDisplayString(e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`item-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`item-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",EV,[e.createElementVNode("div",bV,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>f(C),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,gV)):e.createCommentVNode("",!0),T+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",kV,[e.createElementVNode("table",yV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",uV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${T}-Type`],options:m,modelValue:C.Type,"onUpdate:modelValue":D=>C.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${T}-ItemID`],options:e.unref(l),modelValue:C.ItemID,"onUpdate:modelValue":D=>C.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:j})=>[e.createElementVNode("option",{value:j.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(j.Title),9,xV)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`schedule-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`schedule-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",hV,[e.createElementVNode("div",$V,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>f(C),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,BV)):e.createCommentVNode("",!0),T+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_V,[e.createElementVNode("table",CV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=C=>e.unref(s).Form2Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=C=>e.unref(s).Form2After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",TV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=C=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=C=>N(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},DV={class:"block"},SV={class:"mt-4"},FV={class:"table align-middle gray-table side-table"},AV={key:0},UV={key:1,class:"text-light-gray"},MV={class:"mt-4"},IV={class:"table align-middle gray-table side-table"},jV={class:"row g-3"},PV={class:"col-12 col-xl-2"},OV={class:"text-gray mb-2"},LV={class:"col-12 col-xl-3"},qV={class:"text-gray mb-2"},RV={class:"col-12 col-xl-4"},zV={class:"row g-1"},GV={class:"col-7"},JV={class:"col-5"},QV={class:"col-12 col-xl-3"},HV={class:"text-gray mb-2"},YV={class:"col-12"},WV={class:"text-gray mb-2"},KV={class:"mt-4"},ZV={class:"table align-middle gray-table side-table"},XV={class:"mt-4"},vV={class:"table align-middle gray-table side-table"},ef={key:0,class:"table-responsive mt-3 mb-0"},tf={class:"table align-middle gray-table"},lf={key:0},of={key:0},nf={class:"d-flex gap-2"},rf=["onClick"],af={class:"mt-4"},df={class:"table align-middle gray-table side-table"},sf={key:0,class:"block-bottom bg-light-teal"},cf={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.ref(),a=e.computed(()=>z("multiple",i.value.Status,1)),o=e.ref({}),l=e.ref([]),d=e.computed(()=>r.value.filter(N=>!N.Deleted)),i=e.ref({}),r=e.ref([]),b=e.computed({get:()=>!!d.value.length,set:N=>{N?x():r.value.forEach(p=>p.Deleted=!0)}}),x=()=>r.value.push({}),k=_,c=()=>{A.multiple("getApplication",{ID:u.id}).subscribe(N=>{i.value=N.Project,V.value=N.Contacts,r.value=N.ReceivedSubsidies,i.value.OrgCategory=i.value.OrgCategory||null,P().init("multiple",i.value),s.value=i.value.changeApply,i.value.changeApply=void 0})},n=N=>N.Deleted=!0,y=N=>{var E,t;if(o.value={},N&&!f()){e.nextTick(()=>{var g;return(g=document.querySelector(".invalid"))==null?void 0:g.scrollIntoView({behavior:"smooth",block:"center"})});return}const p={Project:i.value,Contacts:V.value,ReceivedSubsidies:r.value.filter(g=>g.ID||!g.Deleted),Before:(E=s.value)==null?void 0:E.Form1Before,After:(t=s.value)==null?void 0:t.Form1After,Submit:N?"true":"false"};A.multiple("saveApplication",p).subscribe(g=>{N?k("next",g.ID):i.value.ID?c():window.location.href=`Application.aspx?ID=${g.ID}`})},f=()=>{let N={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return o.value=I(i.value,N),N={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((p,E)=>Object.assign(o.value,I(p,N,`contact-${E}-`))),N={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},r.value.forEach((p,E)=>Object.assign(o.value,I(p,N,`received-${E}-`))),s.value&&(N={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,N))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.multiple("getZgsCodes",{CodeGroup:"MULField"}),A.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(N=>{l.value=N[0],m.value=N[1],u.id?c():A.multiple("getEmptyApplication").subscribe(p=>{i.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},p),V.value=[{Role:"負責人"},{Role:"聯絡人"}],P().init("multiple",i.value)})})}),e.provide("editable",a),(N,p)=>{const E=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),g=e.resolveComponent("input-select"),h=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",DV,[p[43]||(p[43]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",SV,[e.createElementVNode("table",FV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[15]||(p[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(i).Year),1)]),e.createElementVNode("tr",null,[p[16]||(p[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(i).ProjectID?(e.openBlock(),e.createElementBlock("span",AV,e.toDisplayString(e.unref(i).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",UV,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[p[17]||(p[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(i).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[18]||(p[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).ProjectName,modelValue:e.unref(i).ProjectName,"onUpdate:modelValue":p[0]||(p[0]=U=>e.unref(i).ProjectName=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[19]||(p[19]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":null,error:e.unref(o).Field,options:e.unref(l),"text-name":"Descname","value-name":"Code",modelValue:e.unref(i).Field,"onUpdate:modelValue":p[1]||(p[1]=U=>e.unref(i).Field=U)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[20]||(p[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(i).OrgName,"onUpdate:modelValue":p[2]||(p[2]=U=>e.unref(i).OrgName=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[21]||(p[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(m),"text-name":"Descname","value-name":"Code",modelValue:e.unref(i).OrgCategory,"onUpdate:modelValue":p[3]||(p[3]=U=>e.unref(i).OrgCategory=U)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[22]||(p[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(i).TaxID,"onUpdate:modelValue":p[4]||(p[4]=U=>e.unref(i).TaxID=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[23]||(p[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(i).Address,"onUpdate:modelValue":p[5]||(p[5]=U=>e.unref(i).Address=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),p[44]||(p[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",MV,[e.createElementVNode("table",IV,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(U,M)=>(e.openBlock(),e.createElementBlock("tr",{key:U},[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(U.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",jV,[e.createElementVNode("div",PV,[e.createElementVNode("div",OV,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[24]||(p[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-Name`],modelValue:U.Name,"onUpdate:modelValue":F=>U.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",LV,[e.createElementVNode("div",qV,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[25]||(p[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-JobTitle`],modelValue:U.JobTitle,"onUpdate:modelValue":F=>U.JobTitle=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",RV,[p[26]||(p[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",zV,[e.createElementVNode("div",GV,[e.createVNode(t,{modelValue:U.Phone,"onUpdate:modelValue":F=>U.Phone=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",JV,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:U.PhoneExt,"onUpdate:modelValue":F=>U.PhoneExt=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",QV,[e.createElementVNode("div",HV,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[27]||(p[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-MobilePhone`],modelValue:U.MobilePhone,"onUpdate:modelValue":F=>U.MobilePhone=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",YV,[e.createElementVNode("div",WV,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[28]||(p[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-EMail`],modelValue:U.EMail,"onUpdate:modelValue":F=>U.EMail=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),p[45]||(p[45]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",KV,[e.createElementVNode("table",ZV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[29]||(p[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[p[30]||(p[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(h,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(i).Target,"onUpdate:modelValue":p[6]||(p[6]=U=>e.unref(i).Target=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[31]||(p[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(i).Summary,"onUpdate:modelValue":p[7]||(p[7]=U=>e.unref(i).Summary=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[32]||(p[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(i).Quantified,"onUpdate:modelValue":p[8]||(p[8]=U=>e.unref(i).Quantified=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[33]||(p[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(i).Qualitative,"onUpdate:modelValue":p[9]||(p[9]=U=>e.unref(i).Qualitative=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",XV,[e.createElementVNode("table",vV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[39]||(p[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(S,{modelValue:e.unref(b),"onUpdate:modelValue":p[10]||(p[10]=U=>e.isRef(b)?b.value=U:null)},null,8,["modelValue"]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",ef,[e.createElementVNode("table",tf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[p[34]||(p[34]=e.createElementVNode("th",null,"計畫名稱",-1)),p[35]||(p[35]=e.createElementVNode("th",null,"補助單位",-1)),p[36]||(p[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",lf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(U,M)=>(e.openBlock(),e.createElementBlock("tr",{key:U},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o)[`received-${M}-Name`],modelValue:U.Name,"onUpdate:modelValue":F=>U.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o)[`received-${M}-Unit`],modelValue:U.Unit,"onUpdate:modelValue":F=>U.Unit=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`received-${M}-Amount`],modelValue:U.Amount,"onUpdate:modelValue":F=>U.Amount=F},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",of,[e.createElementVNode("div",nf,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:F=>n(U),type:"button"},[...p[37]||(p[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,rf)):e.createCommentVNode("",!0),M+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:x,type:"button"},[...p[38]||(p[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[p[42]||(p[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",af,[e.createElementVNode("table",df,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[40]||(p[40]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":p[11]||(p[11]=U=>e.unref(s).Form1Before=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...p[41]||(p[41]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":p[12]||(p[12]=U=>e.unref(s).Form1After=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",sf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:p[13]||(p[13]=U=>y()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:p[14]||(p[14]=U=>y(!0)),type:"button"},[...p[46]||(p[46]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},mf={class:"block"},pf={key:0,class:"text-pink lh-base mt-4"},Vf={class:"mt-4"},ff={class:"table align-middle gray-table"},Nf={class:"text-center"},Ef={key:0,width:"180"},bf={class:"text-center"},gf={key:0},kf=["innerHTML"],yf=["href"],uf={key:0,class:"text-center"},xf={key:0},hf={key:1,class:"text-pink"},$f={key:1,class:"tag-group mt-2 gap-1"},Bf={key:0,class:"tag tag-green-light"},_f=["download","href"],Cf=["onClick"],Tf={class:"mt-4"},wf={class:"table align-middle gray-table side-table"},Df={key:0,class:"block-bottom bg-light-teal"},Sf=["disabled"],Ff={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([{Type:1,Title:"申請表",Template:"../../Template/MUL/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/MUL/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/MUL/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/MUL/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),V=e.computed(()=>m.value.some(c=>!c.Optional&&!c.Files.filter(n=>!n.Deleted).length)),a=e.computed(()=>z("multiple",l.value.Status,2)),o=e.ref({}),l=e.ref({}),d=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},i=A.download,r=_,b=()=>{rxjs.forkJoin([A.multiple("getAttachment",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=m.value.filter(y=>{var f;return!((f=y.Excludes)!=null&&f.includes(l.value.OrgCategory))}),l.value.Status>=42&&m.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/MUL/6-著作權授權同意書.docx",Files:[]}),m.value.forEach(y=>{y.Files=n.Attachments.filter(f=>f.Type===y.Type),y.Uploaded=e.computed(()=>y.Files.filter(f=>!f.Deleted).length)}),P().init("multiple",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},x=c=>{var y,f;if(o.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:u.id,Attachments:m.value.reduce((N,p)=>N.concat(p.Files),[]),Before:(y=s.value)==null?void 0:y.Form5Before,After:(f=s.value)==null?void 0:f.Form5After,Submit:c?"true":"false"};A.multiple("saveAttachment",n).subscribe(()=>{c?r("next"):b()})},k=()=>{if(s.value){const c={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,c))}return!Object.keys(o.value).length};return e.onMounted(b),e.provide("editable",a),(c,n)=>{const y=e.resolveComponent("required-label"),f=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",mf,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",pf,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Vf,[e.createElementVNode("table",ff,[e.createElementVNode("thead",Nf,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Ef,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",bf,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[p.Optional?(e.openBlock(),e.createElementBlock("span",gf,e.toDisplayString(p.Title),1)):(e.openBlock(),e.createBlock(y,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p.Title),1)]),_:2},1024))]),e.unref(a)&&p.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:p.Comment},null,8,kf)):e.createCommentVNode("",!0),e.unref(a)&&p.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:p.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,yf)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",uf,[p.Uploaded?(e.openBlock(),e.createElementBlock("span",xf,"已上傳")):(e.openBlock(),e.createElementBlock("span",hf,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(p.Multiple||!p.Uploaded)?(e.openBlock(),e.createBlock(f,{key:0,accept:".pdf",onFile:t=>d(p,t)},null,8,["onFile"])):e.createCommentVNode("",!0),p.Uploaded?(e.openBlock(),e.createElementBlock("div",$f,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Bf,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(i)(t.Path)},e.toDisplayString(t.Name),9,_f),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:g=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Cf)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Tf,[e.createElementVNode("table",wf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(s).Form5Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(y,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form5After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Df,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=p=>x(!0)),disabled:e.unref(V),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Sf)])):e.createCommentVNode("",!0)],64)}}},Af={class:"block"},Uf={class:"mt-4"},Mf={class:"table-responsive mt-3 mb-0"},If={class:"table align-middle gray-table"},jf={key:0,width:"1"},Pf={key:0},Of={class:"d-flex gap-2"},Lf=["onClick"],qf={class:"table-responsive mt-3 mb-0"},Rf={class:"table align-middle gray-table"},zf={class:"mt-4"},Gf={class:"table align-middle gray-table side-table"},Jf={key:0,class:"block-bottom bg-light-teal"},Qf={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=e.ref(),V=e.computed(()=>z("multiple",l.value.Status,4)),a=e.ref({}),o=e.computed(()=>m.value.filter(c=>!c.Deleted)),l=e.ref({}),d=()=>m.value.push({}),i=_,r=()=>{rxjs.forkJoin([A.multiple("getBenefit",{ID:u.id})]).subscribe(c=>{const n=c[0];l.value=n.Project,m.value=n.Benefits,m.value.length||d(),P().init("multiple",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},b=c=>c.Deleted=!0,x=c=>{var y,f;if(a.value={},c&&!k()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Benefits:m.value,Before:(y=s.value)==null?void 0:y.Form4Before,After:(f=s.value)==null?void 0:f.Form4After,Submit:c?"true":"false"};A.multiple("saveBenefit",n).subscribe(()=>{c?i("next"):r()})},k=()=>{let c={Benefit:"不可量化成果"};return a.value=I(l.value,c),c={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((n,y)=>Object.assign(a.value,I(n,c,`item-${y}-`))),s.value&&(c={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,I(s.value,c))),!Object.keys(a.value).length};return e.onMounted(r),e.provide("editable",V),(c,n)=>{const y=e.resolveComponent("input-text"),f=e.resolveComponent("input-textarea"),N=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Af,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Uf,[e.createElementVNode("div",Mf,[e.createElementVNode("table",If,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",jf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${E}-Title`],modelValue:p.Title,"onUpdate:modelValue":t=>p.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(a)[`item-${E}-Target`],modelValue:p.Target,"onUpdate:modelValue":t=>p.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a)[`item-${E}-Description`],rows:"1",modelValue:p.Description,"onUpdate:modelValue":t=>p.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Pf,[e.createElementVNode("div",Of,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>b(p),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Lf)):e.createCommentVNode("",!0),E+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",qf,[e.createElementVNode("table",Rf,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":n[0]||(n[0]=p=>e.unref(l).Benefit=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",zf,[e.createElementVNode("table",Gf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=p=>e.unref(s).Form4Before=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":n[2]||(n[2]=p=>e.unref(s).Form4After=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Jf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=p=>x()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=p=>x(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Hf={class:"block"},Yf={class:"mt-4"},Wf={class:"table-responsive mt-3 mb-0"},Kf={class:"table align-middle gray-table"},Zf={class:"text-end"},Xf={class:"text-end"},vf={class:"table-responsive"},eN={class:"table align-middle gray-table"},tN=["colspan"],lN={key:0,width:"1"},oN={class:"text-end"},nN={key:0},rN={class:"d-flex gap-2"},aN=["onClick"],dN={class:"mt-4"},sN={class:"table-responsive mt-3 mb-0"},cN={class:"table align-middle gray-table"},iN={key:0,width:"1"},mN={class:"text-end"},pN={key:0},VN={class:"d-flex gap-2"},fN=["onClick"],NN={class:"mt-4"},EN={class:"table align-middle gray-table side-table"},bN={key:0,class:"block-bottom bg-light-teal"},gN={class:"text-center"},kN={class:"mb-5"},yN={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(),s=e.computed(()=>z("multiple",l.value.Status,3)),V=e.ref({}),a=e.computed(()=>i.value.filter(E=>!E.Deleted)),o=e.computed(()=>r.value.filter(E=>!E.Deleted)),l=e.ref({}),d=e.ref(),i=e.ref([]),r=e.ref([]),b=e.ref({}),x=e.ref(0),k=()=>i.value.push({}),c=()=>r.value.push({}),n=_,y=()=>{rxjs.forkJoin([A.multiple("getFunding",{ID:u.id})]).subscribe(E=>{const t=E[0];l.value=t.Project,i.value=t.OtherSubsidies,r.value=t.BudgetPlans,b.value=t.GrantTargetSetting,i.value.length||k(),r.value.length||c(),P().init("multiple",l.value),m.value=l.value.changeApply,l.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(V.value={},E&&!p()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>b.value.GrantLimit*1e4){d.value.show(()=>N(E,!0));return}const g={Project:l.value,OtherSubsidies:i.value,BudgetPlans:r.value,Before:(h=m.value)==null?void 0:h.Form3Before,After:(S=m.value)==null?void 0:S.Form3After,Submit:E?"true":"false"};A.multiple("saveFunding",g).subscribe(()=>{E?n("next"):y()})},p=()=>{let E={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=I(l.value,E),E={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},i.value.forEach((t,g)=>Object.assign(V.value,I(t,E,`other-${g}-`))),E={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,g)=>Object.assign(V.value,I(t,E,`plan-${g}-`))),m.value&&(E={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(V.value,I(m.value,E))),!Object.keys(V.value).length};return e.onMounted(y),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=a.value.reduce((E,t)=>E+R(t.Amount),0),x.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),a.value.forEach(E=>E.percent=Math.round(R(E.Amount)/l.value.OtherAmount*1e4)/100),r.value.forEach(E=>E.sum=R(E.Amount)+R(E.OtherAmount))}),(E,t)=>{var M;const g=e.resolveComponent("input-integer"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),U=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Hf,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Yf,[e.createElementVNode("div",Wf,[e.createElementVNode("table",Kf,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(l).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(l).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Zf,e.toDisplayString((M=e.unref(l).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Xf,e.toDisplayString(e.unref(x).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",vf,[e.createElementVNode("table",eN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,tN)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",lN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,C)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`other-${C}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":T=>F.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`other-${C}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",oN,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`other-${C}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":T=>F.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",nN,[e.createElementVNode("div",rN,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>f(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,aN)):e.createCommentVNode("",!0),C+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",dN,[e.createElementVNode("div",sN,[e.createElementVNode("table",cN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",iN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(F,C)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`plan-${C}-Title`],modelValue:F.Title,"onUpdate:modelValue":T=>F.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":T=>F.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":T=>F.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",mN,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V)[`plan-${C}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":T=>F.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",pN,[e.createElementVNode("div",VN,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>f(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,fN)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(m)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",NN,[e.createElementVNode("table",EN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).Form3Before,rows:"4",modelValue:e.unref(m).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(m).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(V).Form3After,rows:"4",modelValue:e.unref(m).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(m).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",bN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>N(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(U,{ref_key:"modal",ref:d},{default:e.withCtx(()=>[e.createElementVNode("div",gN,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",kN,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(b).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},uN={class:"block"},xN={class:"text-teal fw-bold py-3"},hN={class:"table-responsive"},$N={class:"table align-middle gray-table"},BN={class:"text-end"},_N={class:"mt-4"},CN={class:"table align-middle gray-table"},TN={class:"text-center"},wN={key:0,width:"180"},DN={class:"text-center"},SN=["href"],FN={key:0,class:"text-center"},AN={key:0},UN={key:1,class:"text-pink"},MN={key:1,class:"tag-group mt-2 gap-1"},IN={key:0,class:"tag tag-green-light"},jN=["download","href"],PN=["onClick"],ON={class:"block-bottom bg-light-teal"},LN=!0,qN={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(0),s=e.ref({}),V=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]}]),a=(d,i)=>{i.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:i.Path,Name:s.value.ProjectID+"_第一期_"+(d.Multiple?i.Name:`${d.Title}.pdf`)})},o=A.download,l=d=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:u.id}).subscribe(d=>{s.value=d.Project,P().init("multiple",s.value),m.value=Math.round(s.value.ApprovedAmount*.7),V.value.forEach(i=>{i.Uploaded=e.computed(()=>i.Files.filter(r=>!r.Deleted).length)})})}),e.provide("editable",LN),(d,i)=>{var x;const r=e.resolveComponent("required-label"),b=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",uN,[i[12]||(i[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後請款，第一期預撥70%）",-1)),e.createElementVNode("p",xN,"核定經費: "+e.toDisplayString((x=e.unref(s).ApprovedAmount)==null?void 0:x.toLocaleString())+"元",1),e.createElementVNode("div",hN,[e.createElementVNode("table",$N,[i[6]||(i[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",BN,e.toDisplayString(e.unref(m)),1),i[2]||(i[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),i[3]||(i[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),i[4]||(i[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),i[5]||(i[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),i[13]||(i[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),i[14]||(i[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",_N,[e.createElementVNode("table",CN,[e.createElementVNode("thead",TN,[e.createElementVNode("tr",null,[i[7]||(i[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),i[8]||(i[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",wN,"狀態")),i[9]||(i[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(k,c)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",DN,e.toDisplayString(c+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Title),1)]),_:2},1024)]),k.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:k.Template,style:{width:"140px"},type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,SN)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",FN,[k.Uploaded?(e.openBlock(),e.createElementBlock("span",AN,"已上傳")):(e.openBlock(),e.createElementBlock("span",UN,"尚未上傳"))])),e.createElementVNode("td",null,[k.Multiple||!k.Uploaded?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:n=>a(k,n)},null,8,["onFile"])):e.createCommentVNode("",!0),k.Uploaded?(e.openBlock(),e.createElementBlock("div",MN,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",IN,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(o)(n.Path)},e.toDisplayString(n.Name),9,jN),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:y=>n.Deleted=!0,type:"button"},[...i[11]||(i[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,PN))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",ON,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[0]||(i[0]=k=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[1]||(i[1]=k=>l()),type:"button"},[...i[15]||(i[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},RN={class:"block"},zN={class:"text-teal fw-bold py-3"},GN={class:"table-responsive"},JN={class:"table align-middle gray-table"},QN={class:"text-end"},HN={class:"text-end"},YN={class:"text-end"},WN={class:"text-end"},KN={class:"mt-4"},ZN={class:"table align-middle gray-table"},XN={class:"text-center"},vN={key:0,width:"180"},e1={class:"text-center"},t1=["href"],l1={key:0,class:"text-center"},o1={key:0},n1={key:1,class:"text-pink"},r1={key:1,class:"tag-group mt-2 gap-1"},a1={key:0,class:"tag tag-green-light"},d1=["download","href"],s1=["onClick"],c1={class:"block-bottom bg-light-teal"},i1=!0,m1={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(3e4),s=e.ref(0),V=e.ref({}),a=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),o=e.computed(()=>V.value.ApprovedAmount?Math.min(Math.round(m.value*100/V.value.ApprovedAmount*100)/100,100):0),l=e.computed(()=>s.value?Math.min(Math.round(m.value*100/s.value*100)/100,100):0),d=(b,x)=>{x.Type==="application/pdf"&&b.Files.push({Type:b.Type,Path:x.Path,Name:V.value.ProjectID+"_第二期_"+(b.Multiple?x.Name:`${b.Title}.pdf`)})},i=A.download,r=b=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:u.id}).subscribe(b=>{V.value=b.Project,P().init("multiple",V.value),s.value=Math.round(V.value.ApprovedAmount*.7),a.value.forEach(x=>{x.Uploaded=e.computed(()=>x.Files.filter(k=>!k.Deleted).length)})})}),e.provide("editable",i1),(b,x)=>{var y;const k=e.resolveComponent("input-integer"),c=e.resolveComponent("required-label"),n=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",RN,[x[9]||(x[9]=e.createElementVNode("h5",{class:"square-title"},"實際請款（於 9/30 前請款，須執行完成第一期款至少60%）（第二期預撥30%）",-1)),e.createElementVNode("p",zN,"核定經費: "+e.toDisplayString((y=e.unref(V).ApprovedAmount)==null?void 0:y.toLocaleString())+"元",1),e.createElementVNode("div",GN,[e.createElementVNode("table",JN,[x[3]||(x[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",QN,e.toDisplayString(e.unref(V).ApprovedAmount-e.unref(s)),1),e.createElementVNode("td",HN,e.toDisplayString(e.unref(s)),1),e.createElementVNode("td",null,[e.createVNode(k,{modelValue:e.unref(m),"onUpdate:modelValue":x[0]||(x[0]=f=>e.isRef(m)?m.value=f:null)},null,8,["modelValue"])]),e.createElementVNode("td",YN,e.toDisplayString(e.unref(o))+"%",1),e.createElementVNode("td",WN,e.toDisplayString(e.unref(l))+"%",1)])])])]),x[10]||(x[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),x[11]||(x[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",KN,[e.createElementVNode("table",ZN,[e.createElementVNode("thead",XN,[e.createElementVNode("tr",null,[x[4]||(x[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),x[5]||(x[5]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",vN,"狀態")),x[6]||(x[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(f,N)=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",e1,e.toDisplayString(N+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(f.Title),1)]),_:2},1024)]),f.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:f.Template,style:{width:"140px"},type:"button"},[...x[7]||(x[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,t1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",l1,[f.Uploaded?(e.openBlock(),e.createElementBlock("span",o1,"已上傳")):(e.openBlock(),e.createElementBlock("span",n1,"尚未上傳"))])),e.createElementVNode("td",null,[f.Multiple||!f.Uploaded?(e.openBlock(),e.createBlock(n,{key:0,accept:".pdf",onFile:p=>d(f,p)},null,8,["onFile"])):e.createCommentVNode("",!0),f.Uploaded?(e.openBlock(),e.createElementBlock("div",r1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(f.Files,p=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:p},[p.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",a1,[e.createElementVNode("a",{class:"tag-link my-1",download:p.Name,href:e.unref(i)(p.Path)},e.toDisplayString(p.Name),9,d1),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:E=>p.Deleted=!0,type:"button"},[...x[8]||(x[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,s1))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",c1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:x[1]||(x[1]=f=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:x[2]||(x[2]=f=>r()),type:"button"},[...x[12]||(x[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},p1={class:"block"},V1={class:"text-teal fw-bold py-3"},f1={class:"text-teal fw-bold pb-3"},N1={class:"table-responsive"},E1={class:"table align-middle gray-table"},b1={class:"text-end"},g1={class:"text-end"},k1={class:"text-end"},y1={class:"mt-4"},u1={class:"table align-middle gray-table"},x1={class:"text-center"},h1={key:0,width:"180"},$1={class:"text-center"},B1=["href"],_1={key:0,class:"text-center"},C1={key:0},T1={key:1,class:"text-pink"},w1={key:1,class:"tag-group mt-2 gap-1"},D1={key:0,class:"tag tag-green-light"},S1=["download","href"],F1=["onClick"],A1={class:"text-center"},U1={colspan:"2"},M1={class:"block-bottom bg-light-teal"},I1=!0,j1={__name:"Payment3",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref(8e4),s=e.ref({}),V=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),a=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(m.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(i,r)=>{r.Type==="application/pdf"&&i.Files.push({Type:i.Type,Path:r.Path,Name:s.value.ProjectID+"_結案核銷_"+(i.Multiple?r.Name:`${i.Title}.pdf`)})},l=A.download,d=i=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:u.id}).subscribe(i=>{s.value=i.Project,P().init("multiple",s.value),V.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(b=>!b.Deleted).length)})})}),e.provide("editable",I1),(i,r)=>{var n;const b=e.resolveComponent("input-integer"),x=e.resolveComponent("required-label"),k=e.resolveComponent("input-file"),c=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",p1,[r[11]||(r[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",V1,"核定經費: "+e.toDisplayString((n=e.unref(s).ApprovedAmount)==null?void 0:n.toLocaleString())+"元",1),e.createElementVNode("p",f1,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(m)).toLocaleString())+"元",1),e.createElementVNode("div",N1,[e.createElementVNode("table",E1,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[r[3]||(r[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",b1,e.toDisplayString(e.unref(s).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(m),"onUpdate:modelValue":r[0]||(r[0]=y=>e.isRef(m)?m.value=y:null)},null,8,["modelValue"])]),e.createElementVNode("td",g1,e.toDisplayString(e.unref(a))+"%",1),e.createElementVNode("td",k1,e.toDisplayString(e.unref(a))+"%",1)])])])]),r[12]||(r[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),r[13]||(r[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",y1,[e.createElementVNode("table",u1,[e.createElementVNode("thead",x1,[e.createElementVNode("tr",null,[r[5]||(r[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),r[6]||(r[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",h1,"狀態")),r[7]||(r[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(y,f)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",$1,e.toDisplayString(f+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Title),1)]),_:2},1024)]),y.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:y.Template,style:{width:"140px"},type:"button"},[...r[8]||(r[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,B1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",_1,[y.Uploaded?(e.openBlock(),e.createElementBlock("span",C1,"已上傳")):(e.openBlock(),e.createElementBlock("span",T1,"尚未上傳"))])),e.createElementVNode("td",null,[y.Multiple||!y.Uploaded?(e.openBlock(),e.createBlock(k,{key:0,accept:".pdf",onFile:N=>o(y,N)},null,8,["onFile"])):e.createCommentVNode("",!0),y.Uploaded?(e.openBlock(),e.createElementBlock("div",w1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.Files,N=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:N},[N.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",D1,[e.createElementVNode("a",{class:"tag-link my-1",download:N.Name,href:e.unref(l)(N.Path)},e.toDisplayString(N.Name),9,S1),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>N.Deleted=!0,type:"button"},[...r[9]||(r[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,F1))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128)),e.createElementVNode("tr",null,[e.createElementVNode("td",A1,e.toDisplayString(e.unref(V).length+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(x,null,{default:e.withCtx(()=>[...r[10]||(r[10]=[e.createTextVNode("其他資料（5分鐘精華影片）",-1)])]),_:1})])]),e.createElementVNode("td",U1,[e.createVNode(c)])])])])])]),e.createElementVNode("div",M1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:r[1]||(r[1]=y=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:r[2]||(r[2]=y=>d()),type:"button"},[...r[14]||(r[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},P1={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(u,m)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"multiple"})}}},O1={class:"block"},L1={class:"mt-4"},q1={class:"table align-middle gray-table side-table"},R1={key:0,class:"d-flex align-items-center gap-2"},z1={class:"input-group w-auto"},G1={class:"text-teal-dark"},J1={key:1,class:"invalid mt-0"},Q1={class:"table-responsive mt-4"},H1={class:"table align-middle gray-table"},Y1={key:0},W1={class:"input-group"},K1={key:0,class:"invalid mt-0"},Z1={key:0},X1={class:"d-flex gap-2"},v1=["onClick"],eE={class:"mt-4"},tE={class:"table align-middle gray-table"},lE={key:0},oE=["value"],nE={key:0},rE={class:"d-flex gap-2"},aE=["onClick"],dE={class:"mt-4"},sE={class:"table align-middle gray-table side-table"},cE={key:0,class:"block-bottom bg-light-teal"},iE={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),V=e.computed(()=>r.value.EndDate),a=e.computed(()=>z("multiple",i.value.Status,2)),o=e.ref({}),l=e.computed(()=>b.value.filter(E=>!E.Deleted)),d=e.computed(()=>x.value.filter(E=>!E.Deleted)),i=e.ref({}),r=e.ref({}),b=e.ref([]),x=e.ref([]),k=()=>A.multiple("createItem",{ID:u.id}).subscribe(E=>b.value.push(E)),c=()=>x.value.push({Type:0,ItemID:0}),n=_,y=()=>{rxjs.forkJoin([A.multiple("getWorkSchedule",{ID:u.id})]).subscribe(E=>{const t=E[0];i.value=t.Project,r.value=t.GrantType,b.value=t.Items,x.value=t.Schedules,b.value.length||k(),x.value.length||c(),P().init("multiple",i.value),s.value=i.value.changeApply,i.value.changeApply=void 0})},f=E=>E.Deleted=!0,N=E=>{var g,h;if(o.value={},E&&!p()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:i.value,Items:b.value,Schedules:x.value,Before:(g=s.value)==null?void 0:g.Form2Before,After:(h=s.value)==null?void 0:h.Form2After,Submit:E?"true":"false"};A.multiple("saveWorkSchedule",t).subscribe(()=>{E?n("next"):y()})},p=()=>{let E={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=I(i.value,E),E={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`item-${g}-`))),E={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},d.value.forEach((t,g)=>Object.assign(o.value,I(t,E,`schedule-${g}-`))),s.value&&(E={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",a),(E,t)=>{const g=e.resolveComponent("required-label"),h=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",O1,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",L1,[e.createElementVNode("table",q1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(V)?(e.openBlock(),e.createElementBlock("div",R1,[e.createElementVNode("div",z1,[e.createVNode(h,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(i).StartTime,"onUpdate:modelValue":t[0]||(t[0]=C=>e.unref(i).StartTime=C)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{class:"w-auto","max-date":e.unref(V),modelValue:e.unref(i).EndTime,"onUpdate:modelValue":t[1]||(t[1]=C=>e.unref(i).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",G1,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(V)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",J1,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Q1,[e.createElementVNode("table",H1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Y1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`item-${T}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",W1,[e.createVNode(U,{"empty-value":0,modelValue:C.Begin,"onUpdate:modelValue":D=>C.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(U,{"empty-value":0,modelValue:C.End,"onUpdate:modelValue":D=>C.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",K1,e.toDisplayString(e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`item-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`item-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Z1,[e.createElementVNode("div",X1,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>f(C),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,v1)):e.createCommentVNode("",!0),T+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:k,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",eE,[e.createElementVNode("table",tE,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",lE,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${T}-Type`],options:m,modelValue:C.Type,"onUpdate:modelValue":D=>C.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(o)[`schedule-${T}-ItemID`],options:e.unref(l),modelValue:C.ItemID,"onUpdate:modelValue":D=>C.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:j})=>[e.createElementVNode("option",{value:j.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(j.Title),9,oE)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`schedule-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`schedule-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",nE,[e.createElementVNode("div",rE,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>f(C),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,aE)):e.createCommentVNode("",!0),T+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",dE,[e.createElementVNode("table",sE,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=C=>e.unref(s).Form2Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(g,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=C=>e.unref(s).Form2After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",cE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=C=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=C=>N(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},mE={class:"block bg-light-teal-100 rounded-4 py-4"},pE={class:"fw-bold"},VE={class:"d-flex align-items-center gap-3 text-teal-dark mt-3"},fE={class:"block rounded-4 mt-4"},NE=["innerHTML"],EE={class:"mt-3 d-flex flex-column gap-2"},bE=["download","href"],gE={class:"mt-3"},kE=["data-caption","href"],yE=["alt","src"],uE={class:"mt-3 d-flex flex-column gap-2"},xE=["href"],hE={__name:"NewsDetail",props:{id:{type:[Number,String]}},setup(B){const _=B,u=e.ref(),m=e.ref([]),s=e.ref({}),V=e.ref([]),a=e.ref([]),o=A.download;return e.onMounted(()=>{A.system("getNews",{ID:_.id}).subscribe(l=>{s.value=l.News,m.value=l.Files,V.value=l.Images,a.value=l.Videos,e.nextTick(()=>{Fancybox.bind(u.value,"[data-fancybox]")})})}),(l,d)=>{const i=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",mE,[e.createElementVNode("h5",pE,e.toDisplayString(e.unref(s).Title),1),e.createElementVNode("ul",VE,[e.createElementVNode("li",null,[d[0]||(d[0]=e.createTextVNode("公告日期：",-1)),e.createVNode(i,{value:e.unref(s).EnableTime},null,8,["value"])]),e.createElementVNode("li",null,"公告單位："+e.toDisplayString(e.unref(s).UserOrg),1)])]),e.createElementVNode("div",fE,[e.createElementVNode("div",{class:"mb-5",style:{"white-space":"pre-line"},innerHTML:e.unref(s).Content},null,8,NE),e.unref(m).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[d[2]||(d[2]=e.createElementVNode("h5",{class:"square-title"},"相關附件",-1)),e.createElementVNode("ul",EE,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),r=>(e.openBlock(),e.createElementBlock("li",{key:r},[e.createElementVNode("a",{class:"link-black",download:r.Name,href:e.unref(o)(r.Path)},[e.createTextVNode(e.toDisplayString(r.Name)+" ",1),d[1]||(d[1]=e.createElementVNode("i",{class:"fa-solid fa-file-arrow-down text-teal-dark ms-1"},null,-1))],8,bE)]))),128))])],64)):e.createCommentVNode("",!0),e.unref(V).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[d[4]||(d[4]=e.createElementVNode("h5",{class:"square-title mt-5"},"相關照片",-1)),e.createElementVNode("div",gE,[e.createElementVNode("div",{class:"image-preview mt-3",ref_key:"container",ref:u},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(r,b)=>(e.openBlock(),e.createElementBlock("div",{class:"image-preview__item",key:r},[e.createElementVNode("a",{"data-fancybox":"gallery","data-caption":`相片 ${b}`,href:e.unref(o)(r.Path)},[e.createElementVNode("img",{alt:`相片 ${b}`,src:e.unref(o)(r.Path)},null,8,yE),d[3]||(d[3]=e.createElementVNode("div",{class:"image-preview__item-overlay"},[e.createElementVNode("button",{"aria-label":"檢視圖片",class:"btn btn-view-image",tabindex:"-1",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"})])],-1))],8,kE)]))),128))],512)])],64)):e.createCommentVNode("",!0),e.unref(a).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[d[6]||(d[6]=e.createElementVNode("h5",{class:"square-title mt-5"},"相關影片",-1)),e.createElementVNode("ul",uE,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),r=>(e.openBlock(),e.createElementBlock("li",{key:r},[e.createElementVNode("a",{class:"link-black",href:r.URL,target:"_blank"},[e.createTextVNode(e.toDisplayString(r.Title)+" ",1),d[5]||(d[5]=e.createStaticVNode('<svg class="ms-1" xmlns="http://www.w3.org/2000/svg" width="16" height="18" viewBox="0 0 19 24" fill="none"><g clip-path="url(#clip0_1051_6167)"><path d="M17.7333 0.5H12.6667C11.913 0.5 11.4 1.12067 11.4 1.76667C11.4 2.05167 11.4887 2.36833 11.7673 2.65967L13.4077 4.3L9.87367 7.834C9.60767 8.1 9.5 8.423 9.5 8.727C9.5 9.43633 10.0573 9.99367 10.7667 9.99367C11.096 9.99367 11.4127 9.87333 11.6597 9.62L15.1937 6.086L16.834 7.72633C17.1253 8.005 17.442 8.09367 17.727 8.09367C18.373 8.09367 18.9937 7.58067 18.9937 6.827V1.76667C18.9937 1.12067 18.4807 0.5 17.727 0.5H17.7333ZM15.2 7.88467L12.559 10.5257C12.084 11.0007 11.4443 11.2667 10.7667 11.2667C9.348 11.2667 8.23333 10.152 8.23333 8.73333C8.23333 8.05567 8.49933 7.42233 8.97433 6.941L11.6153 4.3L10.8743 3.559C10.716 3.39433 10.5957 3.217 10.488 3.03333H1.26667C0.563667 3.03333 0 3.597 0 4.3V18.2333C0 18.93 0.563667 19.5 1.26667 19.5H15.2C15.8967 19.5 16.4667 18.93 16.4667 18.2333V9.01833C16.2893 8.917 16.1183 8.79667 15.9663 8.651L15.2 7.88467Z" fill="#037F72"></path></g><defs><clipPath id="clip0_1051_6167"><rect width="19" height="19" fill="white" transform="translate(0 0.5)"></rect></clipPath></defs></svg>',1))],8,xE)]))),128))])],64)):e.createCommentVNode("",!0)])],64)}}},$E={class:"block rounded-4 mt-4"},BE={class:"table-responsive",style:{"min-height":"400px"}},_E={class:"table teal-table","aria-label":"公告列表"},CE={"data-th":"公告時間:"},TE={"data-th":"公告標題:",class:"text-start"},wE=["href"],DE={"data-th":"發布單位:",class:"text-start"},SE={__name:"NewsList",setup(B){const _=e.ref([]),u=e.ref(1),m=e.ref(10),s=e.computed(()=>_.value.slice((u.value-1)*m.value,u.value*m.value)),V=(a,o)=>{u.value=parseInt(a),m.value=parseInt(o)};return e.onMounted(()=>{A.system("getPublishedNewsList").subscribe(a=>_.value=a.List)}),(a,o)=>{const l=e.resolveComponent("tw-date"),d=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock("div",$E,[o[1]||(o[1]=e.createElementVNode("div",{class:"title border-teal"},[e.createElementVNode("div",{class:"d-flex align-items-center gap-2"},[e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")])])],-1)),e.createElementVNode("div",BE,[e.createElementVNode("table",_E,[o[0]||(o[0]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告時間"),e.createElementVNode("th",{scope:"col",class:"text-start"},"標題"),e.createElementVNode("th",{scope:"col",style:{width:"300px"}},"發布單位")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),i=>(e.openBlock(),e.createElementBlock("tr",{key:i},[e.createElementVNode("td",CE,[e.createVNode(l,{value:i.EnableTime},null,8,["value"])]),e.createElementVNode("td",TE,[e.createElementVNode("a",{class:"link-black",href:`NewsDetail.aspx?ID=${i.ID}`},e.toDisplayString(i.Title),9,wE)]),e.createElementVNode("td",DE,e.toDisplayString(i.UserOrg)+" "+e.toDisplayString(i.UserName),1)]))),128))])])]),e.createVNode(d,{count:e.unref(_).length,onChange:V,page:e.unref(u),"page-size":e.unref(m)},null,8,["count","page","page-size"])])}}},FE={key:0,class:"scroll-bottom-panel"},AE={class:"d-flex flex-column gap-3 mb-3"},UE={class:"d-flex gap-2"},ME={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},IE={class:"text-nowrap my-2 d-flex align-items-center"},jE={__name:"ProjectChangeReview",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const _=B,u=P(),m=[{value:1,text:"通過"},{value:2,text:"退回修改"}],s=e.ref({}),V=e.ref({ID:_.id,Result:1}),a=()=>{const l={};if(V.value.Result>1&&(l.Reason="原因"),s.value=I(V.value,l),Object.keys(s.value).length){o();return}A[_.type]("reviewApplicationChange",V.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=5")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>V.value.Result,l=>{l>1&&o()}),(l,d)=>{const i=e.resolveComponent("input-radio-group"),r=e.resolveComponent("input-textarea");return e.unref(u)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",FE,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",AE,[e.createElementVNode("li",UE,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",ME,[e.createElementVNode("div",IE,[e.createVNode(i,{options:m,modelValue:e.unref(V).Result,"onUpdate:modelValue":d[0]||(d[0]=b=>e.unref(V).Result=b)},null,8,["modelValue"])]),e.unref(V).Result>1?(e.openBlock(),e.createBlock(r,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(V).Reason,"onUpdate:modelValue":d[1]||(d[1]=b=>e.unref(V).Reason=b)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:a,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},PE={key:0,class:"scroll-bottom-panel"},OE={class:"d-flex flex-column gap-3 mb-3"},LE={class:"d-flex gap-2"},qE={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},RE={class:"text-nowrap my-2 d-flex align-items-center"},zE={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(B){const _=B,u=P(),m=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],s=e.ref({}),V=e.ref({ID:_.id,Result:1}),a=()=>{const l={};if(V.value.Result>1&&(l.Reason="原因"),s.value=I(V.value,l),Object.keys(s.value).length){o();return}A[_.type]("reviewApplication",V.value).subscribe(d=>{d&&(window.location.href="../ReviewChecklist.aspx?type=4")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>V.value.Result,l=>{l>1&&o()}),(l,d)=>{const i=e.resolveComponent("input-radio-group"),r=e.resolveComponent("input-textarea");return e.unref(u)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",PE,[d[3]||(d[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",OE,[e.createElementVNode("li",LE,[d[2]||(d[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",qE,[e.createElementVNode("div",RE,[e.createVNode(i,{options:m,modelValue:e.unref(V).Result,"onUpdate:modelValue":d[0]||(d[0]=b=>e.unref(V).Result=b)},null,8,["modelValue"])]),e.unref(V).Result>1?(e.openBlock(),e.createBlock(r,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(V).Reason,"onUpdate:modelValue":d[1]||(d[1]=b=>e.unref(V).Reason=b)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:a,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},GE={class:"d-flex align-items-center gap-3"},JE={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},QE={class:"modal-content"},HE={class:"modal-header"},YE={class:"fs-24 fw-bold text-green-light"},WE={class:"modal-body"},KE={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},ZE=["disabled"],XE={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(B){const _=B,u=e.computed(()=>!V.value||V.value===o[_.type].organizer),m=e.ref(),s=e.computed(()=>o[_.type].organizerName),V=e.ref(0),a=e.computed(()=>{var x;return(x=i.value.find(k=>k.UnitID===d.value))==null?void 0:x.reviewers}),o=P(),l=e.computed(()=>s.value?"移轉案件":"認領案件"),d=e.ref(0),i=e.ref([]),r=()=>{A[_.type]("queryReviewUnits").subscribe(x=>{i.value=x,rxjs.forkJoin(i.value.map(k=>A[_.type]("queryReviewersByUnit",{ID:k.UnitID}))).subscribe(k=>{k.forEach((c,n)=>{i.value[n].reviewers=c,c.some(y=>y.UserID===V.value)&&(d.value=i.value[n].UnitID)}),bootstrap.Modal.getOrCreateInstance(m.value).show()})})},b=()=>{A[_.type]("saveOrganizer",{ID:_.id,Organizer:V.value}).subscribe(x=>{x&&window.location.reload()})};return e.watch(s,()=>V.value=o[_.type].organizer),e.watch(d,()=>{a.value.some(x=>x.UserID===V.value)||(V.value=0)}),(x,k)=>{const c=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",GE,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(s)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:r,type:"button"},e.toDisplayString(e.unref(l)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:m,tabindex:"-1"},[e.createElementVNode("div",JE,[e.createElementVNode("div",QE,[e.createElementVNode("div",HE,[e.createElementVNode("h4",YE,e.toDisplayString(e.unref(l)),1),k[2]||(k[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",WE,[e.createElementVNode("div",null,[k[3]||(k[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(c,{"empty-value":0,options:e.unref(i),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(d),"onUpdate:modelValue":k[0]||(k[0]=n=>e.isRef(d)?d.value=n:null)},null,8,["options","modelValue"]),e.createVNode(c,{class:"mt-2","empty-value":0,options:e.unref(a),"text-name":"Name","value-name":"UserID",modelValue:e.unref(V),"onUpdate:modelValue":k[1]||(k[1]=n=>e.isRef(V)?V.value=n:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",KE,[k[4]||(k[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:b,disabled:e.unref(u),type:"button"},"確認",8,ZE)])])])])],512)]))],64)}}},vE={class:"step-line-wrapper"},eb={class:"step-line"},tb={key:0,class:"tag tag-white"},lb={key:1,class:"tag tag-white"},ob={key:0,class:"step-line"},nb={key:0,class:"tag tag-white"},rb={class:"step-line"},ab={key:0,class:"tag tag-white"},db={key:0,class:"tag tag-white"},sb={__name:"ProjectProgress",props:{excludes:{default:[],type:Array},id:{type:[Number,String]},step:{required:!0,type:Number},type:{required:!0,type:String}},setup(B){const _=P(),u=B,m=s=>{location.href=`${s}.aspx?ID=${u.id}`};return(s,V)=>(e.openBlock(),e.createElementBlock("div",vE,[e.createElementVNode("div",eb,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===1}]),onClick:V[0]||(V[0]=a=>m("Audit")),role:"button"},[V[4]||(V[4]=e.createElementVNode("div",{class:"step-line-item-title"},"核定計畫",-1)),B.step===1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[[1,4].includes(e.unref(_)[u.type].changeStatus)?(e.openBlock(),e.createElementBlock("div",tb,"編輯中")):e.unref(_)[u.type].changeStatus===2?(e.openBlock(),e.createElementBlock("div",lb,"審核中")):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],2)]),B.excludes.includes(4)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",ob,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===4}]),onClick:V[1]||(V[1]=a=>m("Progress")),role:"button"},[V[5]||(V[5]=e.createElementVNode("div",{class:"step-line-item-title"},"每月進度",-1)),B.step===4?(e.openBlock(),e.createElementBlock("div",nb,"編輯中")):e.createCommentVNode("",!0)],2)])),e.createElementVNode("div",rb,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===5}]),onClick:V[2]||(V[2]=a=>m("Report")),role:"button"},[V[6]||(V[6]=e.createElementVNode("div",{class:"step-line-item-title"},"階段報告",-1)),B.step===5?(e.openBlock(),e.createElementBlock("div",ab,"編輯中")):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===6}]),onClick:V[3]||(V[3]=a=>m("Payment")),role:"button"},[V[7]||(V[7]=e.createElementVNode("div",{class:"step-line-item-title"},"請款核銷",-1)),B.step===6?(e.openBlock(),e.createElementBlock("div",db,"編輯中")):e.createCommentVNode("",!0)],2)])]))}},cb={class:"block"},ib={class:"square-title"},mb=["innerHTML"],pb={class:"table-responsive mt-3"},Vb={class:"table align-middle gray-table"},fb={class:"text-center"},Nb=["href"],Eb={key:0,class:"text-center"},bb={key:0},gb={key:1,class:"text-pink"},kb={key:1,class:"tag-group mt-2 gap-1"},yb={key:0,class:"tag tag-green-light"},ub=["download","href"],xb=["onClick"],hb={key:0,class:"block-bottom bg-light-teal"},$b=!0,Bb={__name:"ProjectReport",props:{data:{required:!0,type:Object},id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B;e.computed(()=>m.value.some(l=>!l.Optional&&!l.Files.filter(d=>!d.Deleted).length));const m=e.ref(u.data.docs.map(l=>({...l,Files:[]})));e.ref({});const s=(l,d)=>{d.Type==="application/zip"&&l.Files.push({Type:l.Type,Path:d.Path,Name:u.id+"_"+(l.Multiple?d.Name:`${l.Title}.zip`)})},V=A.download,a=()=>{m.value.forEach(l=>{l.Uploaded=e.computed(()=>l.Files.filter(d=>!d.Deleted).length)})},o=l=>{};return e.onMounted(a),e.provide("editable",$b),(l,d)=>{const i=e.resolveComponent("required-label"),r=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",cb,[e.createElementVNode("h5",ib,e.toDisplayString(B.data.subtitle),1),e.createElementVNode("p",{class:"text-pink mt-3 lh-base",innerHTML:B.data.description},null,8,mb),e.createElementVNode("div",pb,[e.createElementVNode("table",Vb,[d[4]||(d[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"70",class:"text-center"},"附件編號"),e.createElementVNode("th",null,"附件名稱"),e.createElementVNode("th",{class:"text-center"},"狀態"),e.createElementVNode("th",null,"上傳附件")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(b,x)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",fb,e.toDisplayString(x+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024)]),b.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:b.Template,style:{width:"140px"},type:"button"},[...d[2]||(d[2]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Nb)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Eb,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",bb,"已上傳")):(e.openBlock(),e.createElementBlock("span",gb,"尚未上傳"))])),e.createElementVNode("td",null,[b.Multiple||!b.Uploaded?(e.openBlock(),e.createBlock(r,{key:0,accept:".zip",onFile:k=>s(b,k)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",kb,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,k=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:k},[k.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",yb,[e.createElementVNode("a",{class:"tag-link my-1",download:k.Name,href:e.unref(V)(k.Path)},e.toDisplayString(k.Name),9,ub),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:c=>k.Deleted=!0,type:"button"},[...d[3]||(d[3]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,xb))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),(e.openBlock(),e.createElementBlock("div",hb,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[0]||(d[0]=b=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[1]||(d[1]=b=>o()),type:"button"},[...d[5]||(d[5]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])]))],64)}}},_b={key:0,class:"scroll-bottom-panel"},Cb={class:"d-flex flex-column gap-3 mb-3"},Tb={class:"d-flex gap-2"},wb={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Db={class:"text-nowrap mb-2 d-flex align-items-center"},Sb={key:0,class:"invalid mt-0"},Fb={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(B){const _=B,u=P(),m=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],s=e.ref({}),V=e.ref({ID:_.id,Result:1}),a=()=>{},o=()=>{},l=()=>{const i={};if(V.value.Result>1&&(i.Reason="原因"),V.value.Result===3&&(i.CorrectionDeadline="補正期限"),s.value=I(V.value,i),Object.keys(s.value).length){d();return}A[_.type]("reviewApplication",V.value).subscribe(r=>{r&&(window.location.href="../ReviewChecklist.aspx?type=1")})},d=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>V.value.Result,i=>{i>1&&d()}),(i,r)=>{const b=e.resolveComponent("input-radio-group"),x=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-textarea");return e.unref(u)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",_b,[r[9]||(r[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Cb,[e.createElementVNode("li",{class:"d-flex gap-2"},[r[3]||(r[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:a,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[r[6]||(r[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),r[7]||(r[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[r[4]||(r[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:o,href:"javascript:void(0)"},"1"),r[5]||(r[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",Tb,[r[8]||(r[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",wb,[e.createElementVNode("div",Db,[e.createVNode(b,{options:m,modelValue:e.unref(V).Result,"onUpdate:modelValue":r[0]||(r[0]=c=>e.unref(V).Result=c)},null,8,["modelValue"]),e.createVNode(x,{class:"form-control",drops:"up",modelValue:e.unref(V).CorrectionDeadline,"onUpdate:modelValue":r[1]||(r[1]=c=>e.unref(V).CorrectionDeadline=c)},null,8,["modelValue"])]),e.unref(s).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",Sb,e.toDisplayString(e.unref(s).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(V).Result>1?(e.openBlock(),e.createBlock(k,{key:1,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(V).Reason,"onUpdate:modelValue":r[2]||(r[2]=c=>e.unref(V).Reason=c)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:l,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Ab={class:"top-wrapper"},Ub={class:"top-block"},Mb={class:"d-flex align-items-center gap-3"},Ib={__name:"ProjectTitle",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const _=B,u=P();return(m,s)=>(e.openBlock(),e.createElementBlock("div",Ab,[e.createElementVNode("div",Ub,[e.createElementVNode("div",Mb,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(u)[_.type].type)+"］"+e.toDisplayString(e.unref(u)[_.type].id)+"/"+e.toDisplayString(e.unref(u)[_.type].name),1)]),s[0]||(s[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},jb={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},Pb={class:"d-flex gap-2"},Ob={key:0,class:"btn text-teal-dark",type:"button"},Lb={class:"d-flex gap-2"},qb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Rb={class:"modal-content"},zb={class:"modal-body"},Gb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Jb={class:"modal-content"},Qb={class:"modal-body"},Hb={class:"d-flex flex-column gap-4 mb-5"},Yb={class:"d-flex align-items-center"},Wb={class:"flex-grow-1"},Kb={__name:"ProjectToolbar",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const _=P(),u=B,m=e.ref({}),s=e.ref(),V=e.ref({}),a=e.ref(),o=e.ref({}),l=e.ref(),d=()=>{const k={Reason:"計畫變更原因"};V.value=I(m.value,k),!Object.keys(V.value).length&&A[u.type]("applyChange",m.value).subscribe(c=>{c&&location.reload()})},i=()=>{m.value={ID:u.id},bootstrap.Modal.getOrCreateInstance(s.value).show()},r=()=>{bootstrap.Modal.getOrCreateInstance(a.value).show()},b=()=>{o.value={ID:u.id},bootstrap.Modal.getOrCreateInstance(l.value).show()},x=()=>{const k={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};V.value=I(o.value,k),!Object.keys(V.value).length&&A[u.type]("terminate",o.value).subscribe(c=>{c&&(location.href="../ApplicationChecklist.aspx")})};return(k,c)=>{const n=e.resolveComponent("project-organizer"),y=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",jb,[e.createElementVNode("div",Pb,[e.unref(_)[u.type].changeStatus?(e.openBlock(),e.createElementBlock("button",Ob," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:i,type:"button"}," 計畫變更申請 ")),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:r,type:"button"},[...c[3]||(c[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])]),c[4]||(c[4]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-download"}),e.createTextVNode(" 下載核定計畫書 ")],-1))]),e.createElementVNode("div",Lb,[e.createVNode(n,{id:B.id,type:B.type},null,8,["id","type"]),e.createElementVNode("button",{class:"btn btn-pink",onClick:b,type:"button"}," 計畫終止 ")])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:s,tabindex:"-1"},[e.createElementVNode("div",qb,[e.createElementVNode("div",Rb,[c[8]||(c[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",zb,[c[6]||(c[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),c[7]||(c[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(y,{error:e.unref(V).Reason,modelValue:e.unref(m).Reason,"onUpdate:modelValue":c[0]||(c[0]=N=>e.unref(m).Reason=N),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[c[5]||(c[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:d},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:a,tabindex:"-1"},[...c[9]||(c[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:l,tabindex:"-1"},[e.createElementVNode("div",Gb,[e.createElementVNode("div",Jb,[c[14]||(c[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Qb,[e.createElementVNode("div",Hb,[e.createElementVNode("div",null,[c[10]||(c[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(y,{error:e.unref(V).RejectReason,modelValue:e.unref(o).RejectReason,"onUpdate:modelValue":c[1]||(c[1]=N=>e.unref(o).RejectReason=N),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),c[12]||(c[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",Yb,[c[11]||(c[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",Wb,[e.createVNode(f,{error:e.unref(V).RecoveryAmount,modelValue:e.unref(o).RecoveryAmount,"onUpdate:modelValue":c[2]||(c[2]=N=>e.unref(o).RecoveryAmount=N),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[c[13]||(c[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:x},"送出")])])])])],512)]))],64)}}},Zb={class:"search bg-gray mt-4"},Xb={class:"search-form"},vb={class:"row g-3"},eg={class:"col-12 col-lg-4"},tg=["value"],lg={class:"col-12 col-lg-4"},og=["value"],ng={class:"row g-3"},rg={class:"col-12 col-lg-6"},ag={class:"col-12 col-lg-6"},dg={class:"total-list multiple-option"},sg={class:"all-total"},cg={class:"total-item-content"},ig={class:"count"},mg=["for"],pg={class:"total-item-title"},Vg={class:"total-item-content"},fg={class:"count"},Ng=["id","onUpdate:modelValue"],Eg={class:"block rounded-bottom-4"},bg={class:"title border-teal"},gg={class:"d-flex align-items-center gap-2"},kg={class:"text-teal"},yg={class:"table-responsive",style:{"min-height":"400px"}},ug={class:"table teal-table"},xg={class:"total-row"},hg={class:"text-end"},$g={class:"text-end"},Bg={class:"text-end"},_g={"data-th":"年度:"},Cg={"data-th":"類別:"},Tg={"data-th":"計畫名稱:",style:{"text-align":"left"}},wg=["href"],Dg={"data-th":"申請單位:",style:{"text-align":"left"}},Sg={"data-th":"申請本會補助:",class:"text-end"},Fg={"data-th":"配合款:",class:"text-end"},Ag={"data-th":"總經費:",class:"text-end"},Ug={"data-th":"狀態:",style:{"text-align":"center",width:"100px"}},Mg={class:"text-teal"},Ig={__name:"ApplyList",setup(B){const _=e.ref([{id:1,title:"申請中",checked:!0},{id:2,title:"審查中",checked:!0},{id:3,title:"已核定",checked:!0},{id:4,title:"未通過",checked:!0}]),u=e.ref([]),m=e.ref({}),s=e.ref([]),V=e.ref(1),a=e.ref(10),o=e.ref([]),l=e.computed(()=>i.value.filter(x=>_.value.find(k=>k.checked&&x.type===k.id))),d=e.computed(()=>l.value.slice((V.value-1)*a.value,V.value*a.value)),i=e.computed(()=>{let x=s.value;return m.value.category&&(x=x.filter(k=>k.Category===m.value.category)),m.value.unit&&(x=x.filter(k=>k.SupervisoryUnit===m.value.unit)),m.value.org&&(x=x.filter(k=>{var c;return(c=k.UserOrg)==null?void 0:c.includes(m.value.org)})),m.value.name&&(x=x.filter(k=>{var c;return k.ProjectID.includes(m.value.name)||((c=k.ProjectName)==null?void 0:c.includes(m.value.name))})),x}),r=(x,k)=>{V.value=parseInt(x),a.value=parseInt(k)},b=x=>{if(x.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${x.ProjectID}`;if(x.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${x.ProjectID}`;if(x.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${x.ProjectID}`;if(x.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${x.ProjectID}`;if(x.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${x.ProjectID}`};return e.onMounted(()=>{A.system("getApplyList").subscribe(x=>{s.value=x.List,s.value.forEach(k=>{[1,14].includes(k.Status)?k.type=1:[11,12,21,22,31,32,41,42,43,44].includes(k.Status)?k.type=2:[45,51,52,91].includes(k.Status)?k.type=3:k.type=4,u.value.includes(k.Category)||u.value.push(k.Category),o.value.includes(k.SupervisoryUnit)||o.value.push(k.SupervisoryUnit)})})}),(x,k)=>{const c=e.resolveComponent("input-text"),n=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Zb,[k[12]||(k[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Xb,[e.createElementVNode("div",vb,[k[8]||(k[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",eg,[k[5]||(k[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":k[0]||(k[0]=y=>e.unref(m).category=y)},[k[4]||(k[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),y=>(e.openBlock(),e.createElementBlock("option",{key:y,value:y},e.toDisplayString(y),9,tg))),128))],512),[[e.vModelSelect,e.unref(m).category]])]),e.createElementVNode("div",lg,[k[7]||(k[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":k[1]||(k[1]=y=>e.unref(m).unit=y)},[k[6]||(k[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),y=>(e.openBlock(),e.createElementBlock("option",{key:y,value:y},e.toDisplayString(y),9,og))),128))],512),[[e.vModelSelect,e.unref(m).unit]])])]),e.createElementVNode("div",ng,[e.createElementVNode("div",rg,[k[9]||(k[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(c,{modelValue:e.unref(m).org,"onUpdate:modelValue":k[2]||(k[2]=y=>e.unref(m).org=y),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",ag,[k[10]||(k[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(c,{modelValue:e.unref(m).name,"onUpdate:modelValue":k[3]||(k[3]=y=>e.unref(m).name=y),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),k[11]||(k[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("ul",dg,[e.createElementVNode("li",sg,[k[14]||(k[14]=e.createElementVNode("div",{class:"total-item-title"},"總申請",-1)),e.createElementVNode("div",cg,[e.createElementVNode("span",ig,e.toDisplayString(e.unref(i).length),1),k[13]||(k[13]=e.createElementVNode("span",{class:"unit"},"件",-1))])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),y=>(e.openBlock(),e.createElementBlock("li",{class:"total-item",key:y},[e.createElementVNode("label",{class:"checke-total",for:`apply-${y.id}`},[e.createElementVNode("div",null,[e.createElementVNode("div",pg,e.toDisplayString(y.title),1),e.createElementVNode("div",Vg,[e.createElementVNode("span",fg,e.toDisplayString(e.unref(i).filter(f=>f.type===y.id).length),1),k[15]||(k[15]=e.createElementVNode("span",{class:"unit"},"件",-1))])]),k[16]||(k[16]=e.createElementVNode("img",{class:"check-icon",src:"../../assets/img/check-white.svg"},null,-1))],8,mg),e.withDirectives(e.createElementVNode("input",{class:"total-checkbox",id:`apply-${y.id}`,type:"checkbox","onUpdate:modelValue":f=>y.checked=f},null,8,Ng),[[e.vModelCheckbox,y.checked]])]))),128))]),e.createElementVNode("div",Eg,[e.createElementVNode("div",bg,[e.createElementVNode("div",gg,[k[19]||(k[19]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[k[17]||(k[17]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",kg,e.toDisplayString(e.unref(l).length),1),k[18]||(k[18]=e.createTextVNode(" 筆資料",-1))])]),k[20]||(k[20]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",yg,[e.createElementVNode("table",ug,[e.createElementVNode("thead",null,[k[23]||(k[23]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"申請本會補助")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"總經費")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"狀態")])])],-1)),e.createElementVNode("tr",xg,[k[21]||(k[21]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",hg,e.toDisplayString(e.unref(l).reduce((y,f)=>y+f.ApplyAmount,0).toLocaleString()),1),e.createElementVNode("td",$g,e.toDisplayString(e.unref(l).reduce((y,f)=>y+f.OtherAmount,0).toLocaleString()),1),e.createElementVNode("td",Bg,e.toDisplayString(e.unref(l).reduce((y,f)=>y+f.ApplyAmount+f.OtherAmount,0).toLocaleString()),1),k[22]||(k[22]=e.createElementVNode("td",null,null,-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),y=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",_g,e.toDisplayString(y.Year),1),e.createElementVNode("td",Cg,e.toDisplayString(y.Category),1),e.createElementVNode("td",Tg,[e.createElementVNode("a",{class:"link-black",href:b(y),target:"_blank"},e.toDisplayString(y.ProjectName||"[未設定]"),9,wg)]),e.createElementVNode("td",Dg,e.toDisplayString(y.UserOrg),1),e.createElementVNode("td",Sg,e.toDisplayString(y.ApplyAmount.toLocaleString()),1),e.createElementVNode("td",Fg,e.toDisplayString(y.OtherAmount.toLocaleString()),1),e.createElementVNode("td",Ag,e.toDisplayString((y.ApplyAmount+y.OtherAmount).toLocaleString()),1),e.createElementVNode("td",Ug,[e.createElementVNode("span",Mg,e.toDisplayString(e.unref(_).find(f=>f.id===y.type).title),1)])]))),128))])])]),e.createVNode(n,{count:e.unref(l).length,onChange:r,page:e.unref(V),"page-size":e.unref(a)},null,8,["count","page","page-size"])])],64)}}},jg={class:"search bg-gray mt-4"},Pg={class:"search-form"},Og={class:"row g-3"},Lg={class:"col-12 col-lg-4"},qg=["value"],Rg={class:"col-12 col-lg-4"},zg=["value"],Gg={class:"row g-3"},Jg={class:"col-12 col-lg-6"},Qg={class:"col-12 col-lg-6"},Hg={class:"block rounded-bottom-4"},Yg={class:"title border-teal"},Wg={class:"d-flex align-items-center gap-2"},Kg={class:"text-teal"},Zg={class:"table-responsive",style:{"min-height":"400px"}},Xg={class:"table teal-table"},vg={class:"total-row"},ek={class:"text-end"},tk={class:"text-end"},lk={"data-th":"年度:"},ok={"data-th":"類別:"},nk={"data-th":"計畫名稱:",style:{"text-align":"left"}},rk=["href"],ak={"data-th":"申請單位:",style:{"text-align":"left"}},dk={"data-th":"本會補助金額:",class:"text-end"},sk={"data-th":"配合款:",class:"text-end"},ck={__name:"ApprovedList",setup(B){const _=e.ref([]),u=e.ref({}),m=e.ref([]),s=e.ref(1),V=e.ref(10),a=e.ref([]),o=e.computed(()=>l.value.slice((s.value-1)*V.value,s.value*V.value)),l=e.computed(()=>{let r=m.value;return u.value.category&&(r=r.filter(b=>b.Category===u.value.category)),u.value.unit&&(r=r.filter(b=>b.SupervisoryUnit===u.value.unit)),u.value.org&&(r=r.filter(b=>{var x;return(x=b.UserOrg)==null?void 0:x.includes(u.value.org)})),u.value.name&&(r=r.filter(b=>{var x;return b.ProjectID.includes(u.value.name)||((x=b.ProjectName)==null?void 0:x.includes(u.value.name))})),r}),d=(r,b)=>{s.value=parseInt(r),V.value=parseInt(b)},i=r=>{if(r.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${r.ProjectID}`;if(r.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${r.ProjectID}`;if(r.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${r.ProjectID}`;if(r.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${r.ProjectID}`;if(r.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${r.ProjectID}`};return e.onMounted(()=>{A.system("getApprovedList").subscribe(r=>{m.value=r.List,m.value.forEach(b=>{_.value.includes(b.Category)||_.value.push(b.Category),a.value.includes(b.SupervisoryUnit)||a.value.push(b.SupervisoryUnit)})})}),(r,b)=>{const x=e.resolveComponent("input-text"),k=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",jg,[b[12]||(b[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Pg,[e.createElementVNode("div",Og,[b[8]||(b[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",Lg,[b[5]||(b[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":b[0]||(b[0]=c=>e.unref(u).category=c)},[b[4]||(b[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),c=>(e.openBlock(),e.createElementBlock("option",{key:c,value:c},e.toDisplayString(c),9,qg))),128))],512),[[e.vModelSelect,e.unref(u).category]])]),e.createElementVNode("div",Rg,[b[7]||(b[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":b[1]||(b[1]=c=>e.unref(u).unit=c)},[b[6]||(b[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),c=>(e.openBlock(),e.createElementBlock("option",{key:c,value:c},e.toDisplayString(c),9,zg))),128))],512),[[e.vModelSelect,e.unref(u).unit]])])]),e.createElementVNode("div",Gg,[e.createElementVNode("div",Jg,[b[9]||(b[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(x,{modelValue:e.unref(u).org,"onUpdate:modelValue":b[2]||(b[2]=c=>e.unref(u).org=c),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Qg,[b[10]||(b[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(x,{modelValue:e.unref(u).name,"onUpdate:modelValue":b[3]||(b[3]=c=>e.unref(u).name=c),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),b[11]||(b[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("div",Hg,[e.createElementVNode("div",Yg,[e.createElementVNode("div",Wg,[b[15]||(b[15]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[b[13]||(b[13]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",Kg,e.toDisplayString(e.unref(l).length),1),b[14]||(b[14]=e.createTextVNode(" 筆資料",-1))])]),b[16]||(b[16]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",Zg,[e.createElementVNode("table",Xg,[e.createElementVNode("thead",null,[b[18]||(b[18]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會補助金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])])],-1)),e.createElementVNode("tr",vg,[b[17]||(b[17]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",ek,e.toDisplayString(e.unref(l).reduce((c,n)=>c+n.ApprovedAmount,0).toLocaleString()),1),e.createElementVNode("td",tk,e.toDisplayString(e.unref(l).reduce((c,n)=>c+n.OtherAmount,0).toLocaleString()),1)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),c=>(e.openBlock(),e.createElementBlock("tr",{key:c},[e.createElementVNode("td",lk,e.toDisplayString(c.Year),1),e.createElementVNode("td",ok,e.toDisplayString(c.Category),1),e.createElementVNode("td",nk,[e.createElementVNode("a",{class:"link-black",href:i(c),target:"_blank"},e.toDisplayString(c.ProjectName),9,rk)]),e.createElementVNode("td",ak,e.toDisplayString(c.UserOrg),1),e.createElementVNode("td",dk,e.toDisplayString(c.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",sk,e.toDisplayString(c.OtherAmount.toLocaleString()),1)]))),128))])])]),e.createVNode(k,{count:e.unref(l).length,onChange:d,page:e.unref(s),"page-size":e.unref(V)},null,8,["count","page","page-size"])])],64)}}},ik={class:"search bg-gray mt-4"},mk={class:"search-form"},pk={class:"row g-3"},Vk={class:"col-12 col-lg-4"},fk=["value"],Nk={class:"col-12 col-lg-4"},Ek=["value"],bk={class:"row g-3"},gk={class:"col-12 col-lg-6"},kk={class:"col-12 col-lg-6"},yk={class:"block rounded-bottom-4"},uk={class:"title border-teal"},xk={class:"d-flex align-items-center gap-2"},hk={class:"text-teal"},$k={class:"table-responsive",style:{"min-height":"400px"}},Bk={class:"table teal-table"},_k={class:"total-row"},Ck={class:"text-end"},Tk={class:"text-end"},wk={class:"text-end"},Dk={class:"text-end"},Sk={class:"text-end"},Fk={"data-th":"年度:"},Ak={"data-th":"類別:"},Uk={"data-th":"計畫名稱:",style:{"text-align":"left"}},Mk=["href"],Ik={"data-th":"申請單位:",style:{"text-align":"left"}},jk={"data-th":"本會補助金額:",class:"text-end"},Pk={"data-th":"配合款:",class:"text-end"},Ok={"data-th":"實支金額:",class:"text-end"},Lk={"data-th":"累積經費執行率:",class:"text-end"},qk={"data-th":"本會已撥金額:",class:"text-end"},Rk={__name:"InprogressList",setup(B){const _=e.ref([]),u=e.ref({}),m=e.ref([]),s=e.ref(1),V=e.ref(10),a=e.ref([]),o=e.computed(()=>i.value.reduce((k,c)=>k+c.ApprovedAmount,0)),l=e.computed(()=>i.value.slice((s.value-1)*V.value,s.value*V.value)),d=e.computed(()=>i.value.reduce((k,c)=>k+c.SpendAmount,0)),i=e.computed(()=>{let k=m.value;return u.value.category&&(k=k.filter(c=>c.Category===u.value.category)),u.value.unit&&(k=k.filter(c=>c.SupervisoryUnit===u.value.unit)),u.value.org&&(k=k.filter(c=>{var n;return(n=c.UserOrg)==null?void 0:n.includes(u.value.org)})),u.value.name&&(k=k.filter(c=>{var n;return c.ProjectID.includes(u.value.name)||((n=c.ProjectName)==null?void 0:n.includes(u.value.name))})),k}),r=(k,c)=>{s.value=parseInt(k),V.value=parseInt(c)},b=k=>{if(k.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${k.ProjectID}`;if(k.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${k.ProjectID}`;if(k.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${k.ProjectID}`;if(k.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${k.ProjectID}`;if(k.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${k.ProjectID}`},x=(k,c)=>c?Math.round(k*100/c*100)/100:0;return e.onMounted(()=>{A.system("getInprogressList").subscribe(k=>{m.value=k.List,m.value.forEach(c=>{_.value.includes(c.Category)||_.value.push(c.Category),a.value.includes(c.SupervisoryUnit)||a.value.push(c.SupervisoryUnit)})})}),(k,c)=>{const n=e.resolveComponent("input-text"),y=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ik,[c[12]||(c[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",mk,[e.createElementVNode("div",pk,[c[8]||(c[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",Vk,[c[5]||(c[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":c[0]||(c[0]=f=>e.unref(u).category=f)},[c[4]||(c[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),f=>(e.openBlock(),e.createElementBlock("option",{key:f,value:f},e.toDisplayString(f),9,fk))),128))],512),[[e.vModelSelect,e.unref(u).category]])]),e.createElementVNode("div",Nk,[c[7]||(c[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":c[1]||(c[1]=f=>e.unref(u).unit=f)},[c[6]||(c[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),f=>(e.openBlock(),e.createElementBlock("option",{key:f,value:f},e.toDisplayString(f),9,Ek))),128))],512),[[e.vModelSelect,e.unref(u).unit]])])]),e.createElementVNode("div",bk,[e.createElementVNode("div",gk,[c[9]||(c[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(n,{modelValue:e.unref(u).org,"onUpdate:modelValue":c[2]||(c[2]=f=>e.unref(u).org=f),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",kk,[c[10]||(c[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(n,{modelValue:e.unref(u).name,"onUpdate:modelValue":c[3]||(c[3]=f=>e.unref(u).name=f),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),c[11]||(c[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("div",yk,[e.createElementVNode("div",uk,[e.createElementVNode("div",xk,[c[15]||(c[15]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[c[13]||(c[13]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",hk,e.toDisplayString(e.unref(i).length),1),c[14]||(c[14]=e.createTextVNode(" 筆資料",-1))])]),c[16]||(c[16]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",$k,[e.createElementVNode("table",Bk,[e.createElementVNode("thead",null,[c[18]||(c[18]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會補助金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"實支金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"累積經費執行率")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會已撥金額")])])],-1)),e.createElementVNode("tr",_k,[c[17]||(c[17]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",Ck,e.toDisplayString(e.unref(o).toLocaleString()),1),e.createElementVNode("td",Tk,e.toDisplayString(e.unref(i).reduce((f,N)=>f+N.OtherAmount,0).toLocaleString()),1),e.createElementVNode("td",wk,e.toDisplayString(e.unref(d).toLocaleString()),1),e.createElementVNode("td",Dk,e.toDisplayString(x(e.unref(d),e.unref(o)).toLocaleString())+"%",1),e.createElementVNode("td",Sk,e.toDisplayString(e.unref(i).reduce((f,N)=>f+N.PaymentAmount,0).toLocaleString()),1)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),f=>(e.openBlock(),e.createElementBlock("tr",{key:f},[e.createElementVNode("td",Fk,e.toDisplayString(f.Year),1),e.createElementVNode("td",Ak,e.toDisplayString(f.Category),1),e.createElementVNode("td",Uk,[e.createElementVNode("a",{class:"link-black",href:b(f),target:"_blank"},e.toDisplayString(f.ProjectName),9,Mk)]),e.createElementVNode("td",Ik,e.toDisplayString(f.UserOrg),1),e.createElementVNode("td",jk,e.toDisplayString(f.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",Pk,e.toDisplayString(f.OtherAmount.toLocaleString()),1),e.createElementVNode("td",Ok,e.toDisplayString(f.SpendAmount.toLocaleString()),1),e.createElementVNode("td",Lk,e.toDisplayString(x(f.SpendAmount,f.ApprovedAmount).toLocaleString())+"%",1),e.createElementVNode("td",qk,e.toDisplayString(f.PaymentAmount.toLocaleString()),1)]))),128))])])]),e.createVNode(y,{count:e.unref(i).length,onChange:r,page:e.unref(s),"page-size":e.unref(V)},null,8,["count","page","page-size"])])],64)}}},zk={key:0,class:"text-pink"},Gk={__name:"RequiredLabel",setup(B){const _=e.inject("editable",!0);return(u,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(_)?(e.openBlock(),e.createElementBlock("span",zk,"* ")):e.createCommentVNode("",!0),e.renderSlot(u.$slots,"default")],64))}},le=H.defineStore("grant",{actions:{init(B){this.type=B}},state:()=>({type:null})}),Jk={class:"block"},Qk={class:"table align-middle gray-table side-table"},Hk=["value"],Yk={class:"table align-middle gray-table"},Wk={width:"1%"},Kk={width:"1%"},Zk={class:"d-flex gap-2"},Xk=["onClick"],vk={class:"d-flex align-items-center flex-wrap"},ey={class:"d-flex align-items-center text-nowrap me-3"},ty={class:"d-flex align-items-center text-nowrap"},ly={key:0,class:"invalid mt-0"},oy={key:0,class:"table align-middle gray-table"},ny={width:"1%"},ry={width:"1%"},ay={class:"d-flex gap-2"},dy=["onClick"],sy={key:0,class:"tag-group mt-2 gap-1"},cy={class:"tag tag-green-light"},iy=["download","href"],my={key:1},py={key:2,class:"invalid mt-0"},Vy={key:0},fy={class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},Ny={__name:"GrantForm1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=[{code:"SCI",title:"科專"},{code:"CUL",title:"文化"},{code:"EDC",title:"學校／民間"},{code:"CLB",title:"學校社團"},{code:"MUL",title:"多元"},{code:"LIT",title:"素養"},{code:"ACC",title:"無障礙"}],s=e.ref(!1),V=e.ref({}),a=e.ref({}),o=e.ref(),l=e.computed(()=>b.value.filter(y=>!y.Deleted)),d=e.computed(()=>r.value.filter(y=>!y.Deleted)),i=e.ref({}),r=e.ref([]),b=e.ref([]),x=A.download,k=_,c=y=>{var N,p,E;if(a.value={},V.value.Path=(N=o.value)==null?void 0:N.Path,V.value.Filename=(p=o.value)==null?void 0:p.Name,y&&!n()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}i.value.ShortName=(E=m.find(t=>t.code===i.value.TypeCode))==null?void 0:E.title;const f={GrantType:i.value,Content:V.value,Procedures:b.value,Links:r.value};A.system("saveGrantTypeContent",f).subscribe(t=>{t&&k("next")})},n=()=>{let y={ServiceContent:"內容",ContactPerson:"聯絡電話及分機",ContactTel:"聯絡人",Filename:"相關檔案"};return s.value&&(y.StatusReason="下架原因"),a.value=I(V.value,y),u.id||(y={TypeCode:"補助類別",Year:"年度",FullName:"補助類別全稱"},Object.assign(a.value,I(i.value,y))),l.value.length&&(y={Content:"內容"},l.value.forEach((f,N)=>Object.assign(a.value,I(f,y,`procedure-${N}-`)))),d.value.length&&(y={URL:"網址"},d.value.forEach((f,N)=>Object.assign(a.value,I(f,y,`link-${N}-`)))),!Object.keys(a.value).length};return e.onMounted(()=>{u.id?A.system("getGrantTypeContent",{ID:u.id}).subscribe(y=>{i.value=y.GrantType,V.value=y.Content,b.value=y.Procedures,r.value=y.Links,V.value.Filename&&(o.value={Name:V.value.Filename,Path:V.value.Path}),b.value.length||b.value.push({}),le().init(i.value.TypeCode)}):b.value.push({})}),(y,f)=>{const N=e.resolveComponent("required-label"),p=e.resolveComponent("input-select"),E=e.resolveComponent("input-integer"),t=e.resolveComponent("input-text"),g=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock("div",Jk,[e.createElementVNode("table",Qk,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[16]||(f[16]=[e.createTextVNode("補助類別(代碼)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{class:"w-auto",error:e.unref(a).TypeCode,options:m,modelValue:e.unref(i).TypeCode,"onUpdate:modelValue":f[0]||(f[0]=S=>e.unref(i).TypeCode=S)},{default:e.withCtx(({option:S})=>[e.createElementVNode("option",{value:S.code},e.toDisplayString(S.title)+" ("+e.toDisplayString(S.code)+")",9,Hk)]),_:1},8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[17]||(f[17]=[e.createTextVNode("年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{class:"w-auto",error:e.unref(a).Year,modelValue:e.unref(i).Year,"onUpdate:modelValue":f[1]||(f[1]=S=>e.unref(i).Year=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[18]||(f[18]=[e.createTextVNode("補助類別全稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(a).FullName,modelValue:e.unref(i).FullName,"onUpdate:modelValue":f[2]||(f[2]=S=>e.unref(i).FullName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[19]||(f[19]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a).ServiceContent,modelValue:e.unref(V).ServiceContent,"onUpdate:modelValue":f[3]||(f[3]=S=>e.unref(V).ServiceContent=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[f[20]||(f[20]=e.createElementVNode("th",null,"申辦資格",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(V).Criteria,"onUpdate:modelValue":f[4]||(f[4]=S=>e.unref(V).Criteria=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[21]||(f[21]=[e.createTextVNode("申辦流程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("table",Yk,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(S,w)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",Wk,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(a)[`procedure-${w}-Content`],modelValue:S.Content,"onUpdate:modelValue":U=>S.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Kk,[e.createElementVNode("div",Zk,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>S.Deleted=!0,type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Xk)):e.createCommentVNode("",!0),w+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f[5]||(f[5]=U=>e.unref(b).push({})),type:"button"},[...f[23]||(f[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])]))),128))])])])]),e.createElementVNode("tr",null,[f[24]||(f[24]=e.createElementVNode("th",null,"應備物品",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(V).Documentary,"onUpdate:modelValue":f[6]||(f[6]=S=>e.unref(V).Documentary=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[25]||(f[25]=[e.createTextVNode("聯絡窗口",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",vk,[e.createElementVNode("div",ey,[f[26]||(f[26]=e.createElementVNode("label",{class:"me-2"},"聯絡電話及分機",-1)),e.createVNode(t,{modelValue:e.unref(V).ContactTel,"onUpdate:modelValue":f[7]||(f[7]=S=>e.unref(V).ContactTel=S),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",ty,[f[27]||(f[27]=e.createElementVNode("label",{class:"me-2"},"聯絡人",-1)),e.createVNode(t,{modelValue:e.unref(V).ContactPerson,"onUpdate:modelValue":f[8]||(f[8]=S=>e.unref(V).ContactPerson=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.unref(a).ContactTel||e.unref(a).ContactPerson?(e.openBlock(),e.createElementBlock("div",ly,e.toDisplayString(e.unref(a).ContactTel||e.unref(a).ContactPerson),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[f[30]||(f[30]=e.createElementVNode("th",null,[e.createTextVNode("線上申辦"),e.createElementVNode("br"),e.createTextVNode("參考資料")],-1)),e.createElementVNode("td",null,[e.unref(d).length?(e.openBlock(),e.createElementBlock("table",oy,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(S,w)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",ny,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(a)[`link-${w}-URL`],modelValue:S.URL,"onUpdate:modelValue":U=>S.URL=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",ry,[e.createElementVNode("div",ay,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:U=>S.Deleted=!0,type:"button"},[...f[28]||(f[28]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,dy)])])]))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:f[9]||(f[9]=S=>e.unref(r).push({})),type:"button"},[...f[29]||(f[29]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增",-1)])])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...f[31]||(f[31]=[e.createTextVNode("相關檔案",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(顯示於首頁)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(o)?(e.openBlock(),e.createElementBlock("div",sy,[e.createElementVNode("span",cy,[e.createElementVNode("a",{class:"tag-link my-1",download:e.unref(o).Name,href:e.unref(x)(e.unref(o).Path)},e.toDisplayString(e.unref(o).Name),9,iy),e.createElementVNode("button",{class:"tag-btn",onClick:f[10]||(f[10]=S=>o.value=null),type:"button"},[...f[32]||(f[32]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])])])])):(e.openBlock(),e.createElementBlock("div",my,[e.createVNode(h,{onFile:f[11]||(f[11]=S=>o.value=S)})])),e.unref(a).Filename?(e.openBlock(),e.createElementBlock("div",py,e.toDisplayString(e.unref(a).Filename),1)):e.createCommentVNode("",!0)])]),e.unref(V).IsValid?(e.openBlock(),e.createElementBlock("tr",Vy,[f[34]||(f[34]=e.createElementVNode("th",null,"申請下架",-1)),e.createElementVNode("td",null,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"status-checkbox",type:"checkbox","onUpdate:modelValue":f[12]||(f[12]=S=>e.isRef(s)?s.value=S:null)},null,512),[[e.vModelCheckbox,e.unref(s)]]),f[33]||(f[33]=e.createElementVNode("label",{class:"form-check-label ms-1 mb-2",for:"status-checkbox"},"申請E政府下架（請輸入原因）",-1)),e.createVNode(g,{error:e.unref(a).StatusReason,modelValue:e.unref(V).StatusReason,"onUpdate:modelValue":f[13]||(f[13]=S=>e.unref(V).StatusReason=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",fy,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[14]||(f[14]=S=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[15]||(f[15]=S=>c(!0)),type:"button"},[...f[35]||(f[35]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確定發布",-1)])])])])}}},Ey={class:"block"},by={class:"table align-middle gray-table side-table"},gy={class:"p-0"},ky={class:"row align-items-center mb-0"},yy={class:"col p-4"},uy={class:"col p-4"},xy={class:"col p-4"},hy={class:"d-flex align-items-center flex-wrap gap-2"},$y={class:"input-group",style:{width:"360px"}},By={class:"d-flex align-items-center flex-wrap gap-2"},_y={class:"input-group",style:{width:"360px"}},Cy={style:{width:"360px"}},Ty={class:"d-flex align-items-center mb-2"},wy={class:"d-flex align-items-center mb-2"},Dy={class:"d-flex align-items-center mb-2"},Sy={class:"d-flex align-items-center mb-2"},Fy={class:"d-flex align-items-center gap-2"},Ay={class:"d-flex align-items-center flex-wrap gap-2"},Uy={class:"input-group",style:{width:"360px"}},My={class:"d-flex align-items-center flex-wrap gap-2"},Iy={class:"input-group",style:{width:"360px"}},jy={__name:"GrantForm2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref({}),s=e.ref(!1),V=_,a=()=>{const o={};s.value||(m.value.OverduePeriod=null),A.system("saveGrantType",{GrantType:Object.assign(m.value,o)}).subscribe(l=>{l&&V("next")})};return e.onMounted(()=>{A.system("getGrantType",{ID:u.id}).subscribe(o=>{m.value=o.GrantType,m.value.OverduePeriod&&(s.value=!0)})}),(o,l)=>{const d=e.resolveComponent("input-integer"),i=e.resolveComponent("input-text"),r=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock("div",Ey,[e.createElementVNode("table",by,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[18]||(l[18]=e.createElementVNode("th",null,"補助類別 全稱",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(m).FullName),1)]),e.createElementVNode("tr",null,[l[21]||(l[21]=e.createElementVNode("th",null,"補助類別 簡稱",-1)),e.createElementVNode("td",gy,[e.createElementVNode("div",ky,[e.createElementVNode("div",yy,e.toDisplayString(e.unref(m).ShortName),1),l[19]||(l[19]=e.createElementVNode("div",{class:"col p-4 text-nowrap",style:{"border-right":"8px solid #DDDDDD","background-color":"#F5F5F5"}},"代碼",-1)),e.createElementVNode("div",uy,e.toDisplayString(e.unref(m).TypeCode),1),l[20]||(l[20]=e.createElementVNode("div",{class:"col p-4 text-nowrap",style:{"border-right":"8px solid #DDDDDD","background-color":"#F5F5F5"}},"年度",-1)),e.createElementVNode("div",xy,e.toDisplayString(e.unref(m).Year),1)])])]),e.createElementVNode("tr",null,[l[22]||(l[22]=e.createElementVNode("th",null,"總預算經費(元)",-1)),e.createElementVNode("td",null,[e.createVNode(d,{class:"w-auto",modelValue:e.unref(m).BudgetFees,"onUpdate:modelValue":l[0]||(l[0]=b=>e.unref(m).BudgetFees=b),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[l[23]||(l[23]=e.createElementVNode("th",null,"身分標籤",-1)),e.createElementVNode("td",null,[e.createVNode(i,{modelValue:e.unref(m).TargetTags,"onUpdate:modelValue":l[1]||(l[1]=b=>e.unref(m).TargetTags=b),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[l[25]||(l[25]=e.createElementVNode("th",null,"申請期間",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",hy,[e.createElementVNode("div",$y,[e.createVNode(r,{modelValue:e.unref(m).ApplyStartDate,"onUpdate:modelValue":l[2]||(l[2]=b=>e.unref(m).ApplyStartDate=b)},null,8,["modelValue"]),l[24]||(l[24]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(r,{modelValue:e.unref(m).ApplyEndDate,"onUpdate:modelValue":l[3]||(l[3]=b=>e.unref(m).ApplyEndDate=b)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[26]||(l[26]=e.createElementVNode("th",null,"計畫期程迄日",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",By,[e.createElementVNode("div",_y,[e.createVNode(r,{modelValue:e.unref(m).PlanEndDate,"onUpdate:modelValue":l[4]||(l[4]=b=>e.unref(m).PlanEndDate=b)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[31]||(l[31]=e.createElementVNode("th",null,"申請階段審查",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",Cy,[e.createElementVNode("div",Ty,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-1",type:"checkbox","onUpdate:modelValue":l[5]||(l[5]=b=>e.unref(m).Review1Enabled=b)},null,512),[[e.vModelCheckbox,e.unref(m).Review1Enabled]]),l[27]||(l[27]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-1"},"1.",-1)),e.createVNode(i,{class:"w-auto","aria-label":"資格審查",placeholder:"資格審查",modelValue:e.unref(m).Review1Title,"onUpdate:modelValue":l[6]||(l[6]=b=>e.unref(m).Review1Title=b),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",wy,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-2",type:"checkbox","onUpdate:modelValue":l[7]||(l[7]=b=>e.unref(m).Review2Enabled=b)},null,512),[[e.vModelCheckbox,e.unref(m).Review2Enabled]]),l[28]||(l[28]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-2"},"2.",-1)),e.createVNode(i,{class:"w-auto","aria-label":"初審",placeholder:"初審",modelValue:e.unref(m).Review2Title,"onUpdate:modelValue":l[8]||(l[8]=b=>e.unref(m).Review2Title=b),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Dy,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-3",type:"checkbox","onUpdate:modelValue":l[9]||(l[9]=b=>e.unref(m).Review3Enabled=b)},null,512),[[e.vModelCheckbox,e.unref(m).Review3Enabled]]),l[29]||(l[29]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-3"},"3.",-1)),e.createVNode(i,{class:"w-auto","aria-label":"複審",placeholder:"複審",modelValue:e.unref(m).Review3Title,"onUpdate:modelValue":l[10]||(l[10]=b=>e.unref(m).Review3Title=b),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Sy,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-4",type:"checkbox","onUpdate:modelValue":l[11]||(l[11]=b=>e.unref(m).Review4Enabled=b)},null,512),[[e.vModelCheckbox,e.unref(m).Review4Enabled]]),l[30]||(l[30]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-4"},"4.",-1)),e.createVNode(i,{class:"w-auto","aria-label":"決審核定",placeholder:"決審核定",modelValue:e.unref(m).Review4Title,"onUpdate:modelValue":l[12]||(l[12]=b=>e.unref(m).Review4Title=b),modelModifiers:{trim:!0}},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[34]||(l[34]=e.createElementVNode("th",null,"補正補件期限",-1)),e.createElementVNode("td",Fy,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"overdue-period",type:"checkbox","onUpdate:modelValue":l[13]||(l[13]=b=>e.isRef(s)?s.value=b:null)},null,512),[[e.vModelCheckbox,e.unref(s)]]),l[33]||(l[33]=e.createElementVNode("label",{class:"form-check-label",for:"overdue-period"},"有期限",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(d,{class:"w-auto",modelValue:e.unref(m).OverduePeriod,"onUpdate:modelValue":l[14]||(l[14]=b=>e.unref(m).OverduePeriod=b),modelModifiers:{trim:!0}},null,8,["modelValue"]),l[32]||(l[32]=e.createTextVNode("天 ",-1))],64)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[l[35]||(l[35]=e.createElementVNode("th",null,[e.createTextVNode("期中報告"),e.createElementVNode("br"),e.createTextVNode("繳交期限")],-1)),e.createElementVNode("td",null,[e.createElementVNode("span",Ay,[e.createElementVNode("span",Uy,[e.createVNode(r,{modelValue:e.unref(m).MidtermDeadline,"onUpdate:modelValue":l[15]||(l[15]=b=>e.unref(m).MidtermDeadline=b)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[38]||(l[38]=e.createElementVNode("th",null,[e.createTextVNode("期末/成果報告"),e.createElementVNode("br"),e.createTextVNode("繳交期限")],-1)),e.createElementVNode("td",null,[e.createElementVNode("div",My,[e.createElementVNode("div",Iy,[e.createVNode(r,{disabled:e.unref(m).FinalOneMonth,modelValue:e.unref(m).FinalDeadline,"onUpdate:modelValue":l[16]||(l[16]=b=>e.unref(m).FinalDeadline=b)},null,8,["disabled","modelValue"])]),l[36]||(l[36]=e.createElementVNode("span",{class:"p-2"},"或",-1)),e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"final-one-month",type:"checkbox","onUpdate:modelValue":l[17]||(l[17]=b=>e.unref(m).FinalOneMonth=b)},null,512),[[e.vModelCheckbox,e.unref(m).FinalOneMonth]]),l[37]||(l[37]=e.createElementVNode("label",{class:"form-check-label",for:"final-one-month"},"計畫結束一個月後",-1))])])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:a,type:"button"},"儲存")])])}}},Py={class:"block"},Oy={class:"mt-4"},Ly={class:"table-responsive"},qy={class:"table align-middle gray-table"},Ry={class:"d-flex align-items-center gap-2"},zy=["id","onUpdate:modelValue"],Gy=["for"],Jy={__name:"GrantForm3",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref([]),s=_,V=()=>{const a=m.value.map(o=>({...o,MatchingFund:o.checked?o.MatchingFund:null}));A.system("saveGrantTargetSettings",{List:a}).subscribe(o=>{o&&s("next")})};return e.onMounted(()=>{A.system("getGrantTargetSettings",{ID:u.id}).subscribe(a=>{m.value=a.List,m.value.forEach(o=>{typeof o.MatchingFund=="number"&&(o.checked=!0)})})}),(a,o)=>{const l=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock("div",Py,[e.createElementVNode("div",Oy,[e.createElementVNode("div",Ly,[e.createElementVNode("table",qy,[o[1]||(o[1]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th"),e.createElementVNode("th",null,"適用申請單位類別"),e.createElementVNode("th",null,"補助經費上限(萬)"),e.createElementVNode("th",null,"配合款")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(d,i)=>(e.openBlock(),e.createElementBlock("tr",{key:d},[e.createElementVNode("td",null,e.toDisplayString(i+1),1),e.createElementVNode("td",null,e.toDisplayString(d.TargetName),1),e.createElementVNode("td",null,[e.createVNode(l,{modelValue:d.GrantLimit,"onUpdate:modelValue":r=>d.GrantLimit=r},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Ry,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:`checkbox-${i}`,type:"checkbox","onUpdate:modelValue":r=>d.checked=r},null,8,zy),[[e.vModelCheckbox,d.checked]]),e.createElementVNode("label",{class:"form-check-label ms-1",for:`checkbox-${i}`},"配合款分攤比例",8,Gy),d.checked?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(l,{class:"w-auto",modelValue:d.MatchingFund,"onUpdate:modelValue":r=>d.MatchingFund=r},null,8,["modelValue","onUpdate:modelValue"]),o[0]||(o[0]=e.createTextVNode("(%) ",-1))],64)):e.createCommentVNode("",!0)])])]))),128))])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:V,type:"button"},"儲存")])])}}},Qy={class:"block"},Hy={class:"mt-4"},Yy={class:"table-responsive"},Wy={class:"table align-middle gray-table side-table"},Ky={class:"input-group",style:{width:"400px"}},Zy={class:"teal-dark-tabs"},Xy={key:0,class:"table-responsive sub-table"},vy={class:"table align-middle gray-table"},eu={class:"d-flex gap-2"},tu=["onClick"],lu={key:1},ou={class:"d-flex gap-2"},nu={__name:"GrantForm4",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref({}),s=e.ref(),V=e.ref([]),a=e.ref({}),o=e.ref(1),l=e.ref(""),d=()=>{const x=/^(.*?)\s*<([^>]+)>$/;l.value.split(`
`).forEach(k=>{const c=k.trim().match(x);c&&a.value[s.value].push({CommitteeUser:c[1],Email:c[2]})}),o.value=1,l.value=""},i=_,r=()=>{if(!b()){e.nextTick(()=>{var x;return(x=document.querySelector(".invalid"))==null?void 0:x.scrollIntoView({behavior:"smooth",block:"center"})});return}A.system("saveReviewCommitteeList",{ID:s.value,List:a.value[s.value]}).subscribe(x=>{x&&i("next")})},b=()=>{const x={CommitteeUser:"姓名",Email:{presence:{message:"^請輸入 Email"},email:{message:"格式錯誤"}}};return m.value={},a.value[s.value].filter(k=>!k.Deleted).forEach((k,c)=>Object.assign(m.value,I(k,x,`item-${c}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{A.system("getReviewGroups",{ID:u.id}).subscribe(x=>{V.value=x.List,s.value=V.value[0].Value})}),e.watch(s,x=>{a.value[x]||A.system("getReviewCommitteeList",{ID:x}).subscribe(k=>{a.value[x]=k.List})}),(x,k)=>{var N;const c=e.resolveComponent("required-label"),n=e.resolveComponent("input-select"),y=e.resolveComponent("input-text"),f=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock("div",Qy,[e.createElementVNode("div",Hy,[e.createElementVNode("div",Yy,[e.createElementVNode("table",Wy,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...k[5]||(k[5]=[e.createTextVNode("審查組別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ky,[e.createVNode(n,{options:e.unref(V),"text-name":"Text","value-name":"Value",modelValue:e.unref(s),"onUpdate:modelValue":k[0]||(k[0]=p=>e.isRef(s)?s.value=p:null)},null,8,["options","modelValue"])])])]),e.createElementVNode("tr",null,[k[11]||(k[11]=e.createElementVNode("th",null,"審查委員名單",-1)),e.createElementVNode("td",null,[e.createElementVNode("ul",Zy,[e.createElementVNode("li",{class:e.normalizeClass({active:e.unref(o)===1})},[e.createElementVNode("a",{class:"tab-link",onClick:k[1]||(k[1]=p=>o.value=1),href:"javascript:void(0)"},"逐筆輸入")],2),e.createElementVNode("li",{class:e.normalizeClass({active:e.unref(o)===2})},[e.createElementVNode("a",{class:"tab-link",onClick:k[2]||(k[2]=p=>o.value=2),href:"javascript:void(0)"},"批次輸入")],2)]),e.unref(o)===1?(e.openBlock(),e.createElementBlock("div",Xy,[e.createElementVNode("table",vy,[k[7]||(k[7]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"1%"}),e.createElementVNode("th",null,"姓名"),e.createElementVNode("th",null,"Email"),e.createElementVNode("th",{width:"1%"})])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((N=e.unref(a)[e.unref(s)])==null?void 0:N.filter(p=>!p.Deleted),(p,E)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(m)[`item-${E}-CommitteeUser`],modelValue:p.CommitteeUser,"onUpdate:modelValue":t=>p.CommitteeUser=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(m)[`item-${E}-Email`],modelValue:p.Email,"onUpdate:modelValue":t=>p.Email=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",eu,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:t=>p.Deleted=!0,type:"button"},[...k[6]||(k[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,tu)])])]))),128))])]),e.createElementVNode("button",{class:"btn btn-sm btn-teal",onClick:k[3]||(k[3]=p=>{var E;return(E=e.unref(a)[e.unref(s)])==null?void 0:E.push({})}),type:"button"},[...k[8]||(k[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增",-1)])])])):e.createCommentVNode("",!0),e.unref(o)===2?(e.openBlock(),e.createElementBlock("div",lu,[e.createElementVNode("div",ou,[e.createVNode(f,{placeholder:`張曉明 <aming@gmail.com>
陳小華 <hwahchen@xxx.edu.tw>`,rows:"5",modelValue:e.unref(l),"onUpdate:modelValue":k[4]||(k[4]=p=>e.isRef(l)?l.value=p:null),modelModifiers:{trim:!0}},null,8,["modelValue"]),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:d,type:"button"},[...k[9]||(k[9]=[e.createElementVNode("i",{class:"fa-solid fa-plus"},null,-1),e.createTextVNode("新增",-1)])])]),k[10]||(k[10]=e.createElementVNode("label",{class:"form-text"},"輸入格式範例「姓名 <xxx@email.com>」，多筆請斷行輸入",-1))])):e.createCommentVNode("",!0)])])])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:r,type:"button"},"儲存")])])}}},ru={class:"search-form"},au={class:"row g-3"},du={class:"col-3"},su=["value"],cu={class:"block rounded-4 mt-4"},iu={class:"table-responsive",style:{"min-height":"400px"}},mu={"aria-label":"公告列表",class:"table teal-table"},pu={"data-th":"年度:"},Vu={"data-th":"補助類別全稱:",class:"text-start"},fu={"data-th":"簡稱:",class:"text-start"},Nu={"data-th":"代碼:",class:"text-start"},Eu={"data-th":"申請期間:",class:"text-start"},bu={"data-th":"管理:",class:"text-center"},gu={class:"d-inline-flex gap-2"},ku=["href"],yu={__name:"GrantList",setup(B){const _=e.ref([]),u=e.ref(),m=e.ref([]),s=e.computed(()=>_.value.filter(V=>V.Year===u.value));return e.onMounted(()=>{A.system("getGrantTypeList").subscribe(V=>{_.value=V.List,m.value=[],_.value.forEach(a=>{m.value.includes(a.Year)||m.value.push(a.Year)}),u.value=m.value.length?m.value[0]:null})}),(V,a)=>{const o=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ru,[e.createElementVNode("div",au,[e.createElementVNode("div",du,[a[1]||(a[1]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":a[0]||(a[0]=l=>e.isRef(u)?u.value=l:null)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),l=>(e.openBlock(),e.createElementBlock("option",{key:l,value:l},e.toDisplayString(l)+"年",9,su))),128))],512),[[e.vModelSelect,e.unref(u)]])])])]),e.createElementVNode("div",cu,[a[5]||(a[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="GrantEdit.aspx"><i class="fa-solid fa-plus"></i> 新增類別 </a></div>',1)),e.createElementVNode("div",iu,[e.createElementVNode("table",mu,[a[4]||(a[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col"},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"補助類別全稱"),e.createElementVNode("th",{scope:"col",class:"text-start"},"簡稱"),e.createElementVNode("th",{scope:"col"},"代碼"),e.createElementVNode("th",{scope:"col"},"申請期間"),e.createElementVNode("th",{scope:"col"},"管理")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),l=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",pu,e.toDisplayString(l.Year),1),e.createElementVNode("td",Vu,e.toDisplayString(l.FullName),1),e.createElementVNode("td",fu,e.toDisplayString(l.ShortName),1),e.createElementVNode("td",Nu,e.toDisplayString(l.TypeCode),1),e.createElementVNode("td",Eu,[e.createVNode(o,{"default-value":"未設定",value:l.ApplyStartDate},null,8,["value"]),a[2]||(a[2]=e.createTextVNode(" ~ ",-1)),e.createVNode(o,{"default-value":"未設定",value:l.ApplyEndDate},null,8,["value"])]),e.createElementVNode("td",bu,[e.createElementVNode("div",gu,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`GrantEdit.aspx?ID=${l.TypeID}`},[...a[3]||(a[3]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,ku)])])]))),128))])])])])],64)}}},uu={__name:"Home",setup(B){return(_,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[u[0]||(u[0]=e.createStaticVNode('<div class="search bg-gray rounded-4 mt-4"><h3 class="text-teal"><i class="fa-solid fa-magnifying-glass"></i> 查詢 </h3><div class="search-form" action=""><div class="row g-3"><div class="col-12 col-lg-6"><div class="fs-16 text-gray mb-2">年度</div><select class="form-select" name="" id=""><option value="">114</option><option value="">113</option></select></div><div class="col-12 col-lg-6"><div class="fs-16 text-gray mb-2">全部類別</div><select class="form-select" name="" id=""><option value="">全部</option><option value="">科專</option><option value="">文化</option><option value="">學校民間</option><option value="">學校社團</option></select></div></div><button type="button" class="btn btn-teal-dark d-table mx-auto"><i class="fa-solid fa-magnifying-glass"></i> 查詢 </button></div><div class="rounded-4 bg-white mt-4 p-4"><div class="row"><div class="col-12"><div class="row"><div class="col-12 col-lg-6 d-flex justify-content-between pe-4"><div class="fw-bold fs-4">總預算經費</div><div class="fw-bold text-primary fs-2">42,500 <span class="fs-6 text-black">千元</span></div></div></div></div></div></div><div class="rounded-4 bg-white mt-4 py-4"><div class="row"><div class="col-12 col-lg-3"><div class="text-center fs-4 fw-bold mb-4">經費執行率</div><div id="chartdiv1" style="width:100%;height:300px;"></div></div><div class="col-12 col-lg-3"><div class="text-center fs-4 fw-bold mb-4">支用比</div><div id="chartdiv2" style="width:100%;height:300px;"></div></div><div class="col-12 col-lg-6"><div class="d-flex justify-content-between align-items-center mb-4"><span class="fs-4 fw-bold">各類經費執行情形</span></div><div class="fs-6 text-end text-secondary me-5">單位：千元</div><div id="chartdiv3" style="width:100%;height:300px;"></div></div></div></div><div class="row"><div class="col-12 col-lg-6 pt-4"><div class="d-flex justify-content-between rounded-4 bg-white p-4"><div class="fw-bold fs-4">核定補助經費</div><div class="fw-bold text-primary fs-2">42,500 <span class="fs-6 text-black">千元</span></div></div></div><div class="col-12 col-lg-6 pt-4"><div class="d-flex justify-content-between rounded-4 bg-white p-4"><div class="fw-bold fs-4">賸餘款</div><div class="fw-bold text-primary fs-2">7,300 <span class="fs-6 text-black">千元</span></div></div></div><div class="col-12 col-lg-6 pt-4"><div class="d-flex justify-content-between rounded-4 bg-white p-4"><div class="fw-bold fs-4">實支金額</div><div class="fw-bold text-primary fs-2">35,200 <span class="fs-6 text-black">千元</span></div></div></div><div class="col-12 col-lg-6 pt-4"><div class="d-flex justify-content-between rounded-4 bg-white p-4"><div class="fw-bold fs-4">已撥付</div><div class="fw-bold text-primary fs-2">38,800 <span class="fs-6 text-black">千元</span></div></div></div></div><div class="rounded-4 bg-white p-4 mt-4 d-flex flex-column gap-5"><div><div class="mt-4"><div class="table-responsive"><table class="table align-middle gray-table"><thead><tr><th class="text-center">類別</th><th class="text-center">核定件數</th><th class="text-end">核定補助經費</th><th class="text-end">經費執行率</th></tr></thead><tbody><tr><td class="text-center">科專類</td><td class="text-center">20</td><td class="text-end">6,888,000,000</td><td class="text-end">67.88%</td></tr></tbody></table></div></div></div></div></div>',1)),u[1]||(u[1]=e.createElementVNode("div",{class:"block rounded-4 mt-4"},[e.createElementVNode("div",{class:"table-responsive",style:{"min-height":"400px"}},[e.createElementVNode("div",{class:"row"},[e.createElementVNode("div",{class:"col"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"依身分篩選適用規定"),e.createElementVNode("select",{class:"form-select",name:"",id:""},[e.createElementVNode("option",{value:""},"全部"),e.createElementVNode("option",{value:""},"海洋科技業者"),e.createElementVNode("option",{value:""},"研究機關(構)"),e.createElementVNode("option",{value:""},"大專院校")])])]),e.createElementVNode("table",{class:"table teal-table","aria-label":"申請計畫列表"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{}},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"類別"),e.createElementVNode("th",{scope:"col",style:{}},"補助計畫"),e.createElementVNode("th",{scope:"col",style:{}},"補助對象"),e.createElementVNode("th",{scope:"col",style:{}},"相關檔案"),e.createElementVNode("th",{scope:"col",style:{}})])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",{"data-th":"年度:"},"114"),e.createElementVNode("td",{"data-th":"類別:",class:"text-start"},"科專"),e.createElementVNode("td",{"data-th":"補助計畫:"},"114年度補助學術機構、研究機關(構)及海洋科技業者執行海洋科技專案"),e.createElementVNode("td",{"data-th":"補助對象:"},[e.createElementVNode("button",{type:"button",class:"btn-tooltip",style:{color:"#027f72"},"data-bs-toggle":"modal","data-bs-target":"#payDetailModal"},[e.createElementVNode("i",{class:"fa-solid fa-circle-info"})])]),e.createElementVNode("td",{"data-th":"相關檔案:"},[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-file-alt","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":"相關檔案"})])]),e.createElementVNode("td",{"data-th":"我要申請:"},[e.createElementVNode("button",{type:"button",class:"btn btn-teal-dark d-table mx-auto",onclick:"location.href='SCI/SciApplication.aspx?ProjectID=114SCI0001'"},[e.createElementVNode("i",{class:"fa-solid"}),e.createTextVNode(" 我要申請 ")])])])])])])],-1)),u[2]||(u[2]=e.createElementVNode("ul",{class:"total-list mt-4"},[e.createElementVNode("li",{class:"total-item",id:"total-item-1"},[e.createElementVNode("a",{href:"javascript:void(0)",onclick:"ReviewChecklist.switchReviewType(1)"},[e.createElementVNode("div",{class:"total-item-title"},"申請中尚未提送"),e.createElementVNode("div",{class:"total-item-content"},[e.createElementVNode("span",{class:"count"},"1"),e.createElementVNode("span",{class:"unit"},"件")])])]),e.createElementVNode("li",{class:"total-item",id:"total-item-2"},[e.createElementVNode("a",{href:"javascript:void(0)",onclick:"ReviewChecklist.switchReviewType(2)"},[e.createElementVNode("div",{class:"total-item-title"},"申請審查中"),e.createElementVNode("div",{class:"total-item-content"},[e.createElementVNode("span",{class:"count"},"4"),e.createElementVNode("span",{class:"unit"},"件")])])]),e.createElementVNode("li",{class:"total-item",id:"total-item-3"},[e.createElementVNode("a",{href:"javascript:void(0)",onclick:"ReviewChecklist.switchReviewType(3)"},[e.createElementVNode("div",{class:"total-item-title"},"審查意見待回覆"),e.createElementVNode("div",{class:"total-item-content"},[e.createElementVNode("span",{class:"count"},"1"),e.createElementVNode("span",{class:"unit"},"件")])])]),e.createElementVNode("li",{class:"total-item",id:"total-item-4"},[e.createElementVNode("a",{href:"javascript:void(0)",onclick:"ReviewChecklist.switchReviewType(4)"},[e.createElementVNode("div",{class:"total-item-title"},"執行中計畫"),e.createElementVNode("div",{class:"total-item-content"},[e.createElementVNode("span",{class:"count"},"4"),e.createElementVNode("span",{class:"unit"},"件")])])]),e.createElementVNode("li",{class:"total-item",id:"total-item-5"},[e.createElementVNode("a",{href:"javascript:void(0)",onclick:"ReviewChecklist.switchReviewType(5)"},[e.createElementVNode("div",{class:"total-item-title"},"執行階段待回覆"),e.createElementVNode("div",{class:"total-item-content"},[e.createElementVNode("span",{class:"count"},"1"),e.createElementVNode("span",{class:"unit"},"件")])])])],-1))],64))}},xu={class:"block rounded-4 mt-4"},hu={class:"table-responsive",style:{"min-height":"400px"}},$u={class:"table teal-table","aria-label":"公告列表"},Bu={"data-th":"公告期間:"},_u={key:1},Cu={"data-th":"公告標題:",class:"text-start"},Tu={"data-th":"發布者:",class:"text-start"},wu={"data-th":"功能:",class:"text-center"},Du={class:"d-inline-flex gap-2"},Su=["href"],Fu=["onClick"],Au={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"},Uu={class:"modal-content"},Mu={class:"modal-body"},Iu={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},ju={__name:"NewsList",setup(B){let _;const u=e.ref([]),m=e.ref(),s=e.ref(1),V=e.ref(10),a=e.computed(()=>u.value.slice((s.value-1)*V.value,s.value*V.value)),o=(d,i)=>{s.value=parseInt(d),V.value=parseInt(i)},l=(d,i)=>{i||(_=d,bootstrap.Modal.getOrCreateInstance(m.value).show()),A.system("deleteNews",{ID:d.ID}).subscribe(r=>{r&&(u.value=u.value.filter(b=>b!==d),bootstrap.Modal.getOrCreateInstance(m.value).hide())})};return e.onMounted(()=>{A.system("getNewsList").subscribe(d=>u.value=d.List)}),(d,i)=>{const r=e.resolveComponent("tw-date"),b=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xu,[i[5]||(i[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="NewsEdit.aspx"><i class="fa-solid fa-plus"></i> 新增公告 </a></div>',1)),e.createElementVNode("div",hu,[e.createElementVNode("table",$u,[i[4]||(i[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告期間"),e.createElementVNode("th",{class:"text-start",scope:"col"},"公告標題"),e.createElementVNode("th",{class:"text-start",scope:"col",style:{width:"200px"}},"發布者"),e.createElementVNode("th",{scope:"col",style:{width:"180px"}},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),x=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",Bu,[e.createVNode(r,{value:x.EnableTime},null,8,["value"]),i[1]||(i[1]=e.createTextVNode(" ~ ",-1)),x.DisableTime?(e.openBlock(),e.createBlock(r,{key:0,value:x.DisableTime},null,8,["value"])):(e.openBlock(),e.createElementBlock("span",_u,"未設定"))]),e.createElementVNode("td",Cu,e.toDisplayString(x.Title),1),e.createElementVNode("td",Tu,e.toDisplayString(x.UserOrg)+" "+e.toDisplayString(x.UserName),1),e.createElementVNode("td",wu,[e.createElementVNode("div",Du,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`NewsEdit.aspx?id=${x.ID}`},[...i[2]||(i[2]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,Su),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:k=>l(x),type:"button"},[...i[3]||(i[3]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,Fu)])])]))),128))])])]),e.createVNode(b,{count:e.unref(u).length,onChange:o,page:e.unref(s),"page-size":e.unref(V)},null,8,["count","page","page-size"])]),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:m,tabindex:"-1"},[e.createElementVNode("div",Au,[e.createElementVNode("div",Uu,[i[7]||(i[7]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 fw-bold text-green-light"},"確定刪除公告資料？"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Mu,[e.createElementVNode("div",Iu,[i[6]||(i[6]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[0]||(i[0]=x=>l(e.unref(_),!0)),type:"button"},"確認刪除")])])])])],512)],64)}}},Pu={class:"block rounded-top-4 mt-4 d-flex flex-column gap-5"},Ou={class:"table-responsive mt-3 mb-0"},Lu={class:"table align-middle gray-table side-table"},qu={class:"d-flex align-items-center gap-2"},Ru={class:"input-group w-auto"},zu={key:0,class:"invalid mt-0"},Gu={class:"d-flex mb-2 gap-3"},Ju={class:"tag-group mt-3"},Qu={key:0,class:"tag tag-green-light"},Hu=["download","href"],Yu=["onClick"],Wu={class:"d-flex mb-2 gap-3"},Ku={class:"image-preview mt-3"},Zu={key:0,class:"image-preview__item"},Xu=["src"],vu={class:"image-preview__item-overlay"},ex=["onClick"],tx={class:"d-flex mb-2 gap-3"},lx={key:0,class:"table-responsive mt-3"},ox={class:"table align-middle gray-table"},nx={class:"text-center"},rx={class:"d-flex gap-1"},ax=["onClick"],oe={AccessibilityApplication:et,AccessibilityAttachment:xt,AccessibilityBenefit:It,AccessibilityFunding:il,AccessibilityPayment1:Fl,AccessibilityPayment2:to,AccessibilityProgressBar:lo,AccessibilityWorkSchedule:wo,ConfirmModal:Mo,CommonProgressBar:Ro,CultureApplication:Cn,CultureAttachment:Wn,CultureFunding:xr,CultureOther:Pr,CulturePayment1:aa,CulturePayment2:wa,CultureProgress:Ya,CultureProgressBar:Wa,CultureWorkSchedule:Rd,EducationApplication:Us,EducationAttachment:lc,EducationPayment:_c,EducationProgressBar:Cc,ErrorModal:Ac,InputBoolean:Uc,InputFile:Mc,InputInteger:Pc,InputMonth:Oc,InputRadioGroup:Rc,InputSelect:Hc,InputText:Xc,InputTextarea:oi,InputTwDate:ai,ListPager:ui,LiteracyApplication:tm,LiteracyAttachment:hm,LiteracyBenefit:jm,LiteracyFunding:mp,LiteracyPayment1:Fp,LiteracyPayment2:lV,LiteracyProgressBar:oV,LiteracyWorkSchedule:wV,MultipleApplication:cf,MultipleAttachment:Ff,MultipleBenefit:Qf,MultipleFunding:yN,MultiplePayment1:qN,MultiplePayment2:m1,MultiplePayment3:j1,MultipleProgressBar:P1,MultipleWorkSchedule:iE,NewsDetail:hE,NewsList:SE,ProjectChangeReview:jE,ProjectCorrectionReview:zE,ProjectOrganizer:XE,ProjectProgress:sb,ProjectReport:Bb,ProjectReview:Fb,ProjectTitle:Ib,ProjectToolbar:Kb,ReportApplyList:Ig,ReportApprovedList:ck,ReportInprogressList:Rk,RequiredLabel:Gk,SystemGrantForm1:Ny,SystemGrantForm2:jy,SystemGrantForm3:Jy,SystemGrantForm4:nu,SystemGrantList:yu,SystemHome:uu,SystemNewsList:ju,SystemNewsForm:{__name:"NewsForm",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const u=B,m=e.ref({}),s=e.ref([]),V=e.computed(()=>l.value.filter(k=>!k.Deleted)),a=e.ref({}),o=e.ref([]),l=e.ref([]),d=(k,c)=>k.push({Path:c.Path,Name:c.Name}),i=A.download,r=_,b=()=>{if(!x()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const k={News:a.value,Files:s.value,Images:o.value,Videos:l.value};A.system("saveNews",k).subscribe(c=>{c&&r("next")})},x=()=>{let k={Title:"公告標題",EnableTime:"公告期間",Content:"內容"};return m.value=I(a.value,k),k={Title:"影片名稱",URL:"影片網址"},V.value.forEach((c,n)=>Object.assign(m.value,I(c,k,`video-${n}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{u.id?A.system("getNews",{ID:u.id}).subscribe(k=>{a.value=k.News,s.value=k.Files,o.value=k.Images,l.value=k.Videos}):A.system("getEmptyNews").subscribe(k=>a.value=k)}),(k,c)=>{const n=e.resolveComponent("required-label"),y=e.resolveComponent("input-text"),f=e.resolveComponent("input-tw-date"),N=e.resolveComponent("input-textarea"),p=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pu,[e.createElementVNode("div",null,[c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title"},"公告內容",-1)),e.createElementVNode("div",Ou,[e.createElementVNode("table",Lu,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",null,"發佈者",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).UserOrg)+"    "+e.toDisplayString(e.unref(a).UserName),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(n,null,{default:e.withCtx(()=>[...c[8]||(c[8]=[e.createTextVNode("公告標題",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(m).Title,modelValue:e.unref(a).Title,"onUpdate:modelValue":c[0]||(c[0]=E=>e.unref(a).Title=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(n,null,{default:e.withCtx(()=>[...c[9]||(c[9]=[e.createTextVNode("公告期間",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",qu,[e.createElementVNode("div",Ru,[e.createVNode(f,{class:"w-auto",modelValue:e.unref(a).EnableTime,"onUpdate:modelValue":c[1]||(c[1]=E=>e.unref(a).EnableTime=E)},null,8,["modelValue"]),c[10]||(c[10]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto",modelValue:e.unref(a).DisableTime,"onUpdate:modelValue":c[2]||(c[2]=E=>e.unref(a).DisableTime=E)},null,8,["modelValue"])])]),e.unref(m).EnableTime?(e.openBlock(),e.createElementBlock("div",zu,e.toDisplayString(e.unref(m).EnableTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(n,null,{default:e.withCtx(()=>[...c[11]||(c[11]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).Content,modelValue:e.unref(a).Content,"onUpdate:modelValue":c[3]||(c[3]=E=>e.unref(a).Content=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.createElementVNode("div",null,[e.createElementVNode("div",Gu,[c[13]||(c[13]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關附件")],-1)),e.createVNode(p,{accept:".pdf,.odt,.doc,.docx,.zip",onFile:c[4]||(c[4]=E=>d(e.unref(s),E))})]),c[15]||(c[15]=e.createElementVNode("span",{class:"text-pink"},"支援文件 pdf, odt, doc, docx (10MB以內)、ZIP 壓縮檔 (50MB以內)",-1)),e.createElementVNode("div",Ju,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),E=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:E},[E.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Qu,[e.createElementVNode("a",{class:"tag-link my-1",download:E.Name,href:e.unref(i)(E.Path)},e.toDisplayString(E.Name),9,Hu),e.createElementVNode("button",{class:"tag-btn",onClick:t=>E.Deleted=!0,type:"button"},[...c[14]||(c[14]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Yu)]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",Wu,[c[16]||(c[16]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關圖片")],-1)),e.createVNode(p,{accept:".jpg,.png",onFile:c[5]||(c[5]=E=>d(e.unref(o),E))})]),c[18]||(c[18]=e.createElementVNode("span",{class:"text-pink"},"支援 JPG, PNG，檔案大小 10MB以內",-1)),e.createElementVNode("div",Ku,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),E=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:E},[E.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",Zu,[e.createElementVNode("img",{alt:"picture",src:e.unref(i)(E.Path)},null,8,Xu),e.createElementVNode("div",vu,[e.createElementVNode("button",{"aria-label":"移除圖片",class:"btn btn-remove-image",onClick:t=>E.Deleted=!0,type:"button"},[...c[17]||(c[17]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,ex)])]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",tx,[c[20]||(c[20]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關影片")],-1)),e.createElementVNode("button",{"aria-label":"新增影片",class:"btn btn-teal-dark",onClick:c[6]||(c[6]=E=>e.unref(l).push({})),type:"button"},[...c[19]||(c[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增 ",-1)])])]),e.unref(V).length?(e.openBlock(),e.createElementBlock("div",lx,[e.createElementVNode("table",ox,[c[22]||(c[22]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80",class:"text-center"},"項次"),e.createElementVNode("th",null,"影片名稱"),e.createElementVNode("th",null,"影片網址"),e.createElementVNode("th",{width:"120"},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(E,t)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",nx,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(m)[`video-${t}-Title`],modelValue:E.Title,"onUpdate:modelValue":g=>E.Title=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(y,{error:e.unref(m)[`video-${t}-URL`],modelValue:E.URL,"onUpdate:modelValue":g=>E.URL=g,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",rx,[e.createElementVNode("button",{"aria-label":"刪除影片",class:"btn btn-sm btn-teal-dark",onClick:g=>E.Deleted=!0,type:"button"},[...c[21]||(c[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ax)])])]))),128))])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",{class:"block-bottom bg-light-teal"},[e.createElementVNode("button",{class:"btn btn-teal",onClick:b,type:"button"},[...c[23]||(c[23]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確認送出",-1)])])])],64)}}},TwDate:{__name:"TwDate",props:{defaultValue:{default:"",type:String},value:{default:null,type:String}},setup(B){const _=B,u=s=>{const V=s==null?void 0:s.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return V?`${parseInt(V[1],10)-1911}/${V[2]}/${V[3]}`:""},m=e.ref(u(_.value));return e.watch(()=>_.value,s=>m.value=u(s)),(s,V)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(m)||B.defaultValue),1))}}};return{api:A,install:B=>{for(const _ in oe)B.component(_,oe[_])},useGrantStore:le,useProgressStore:P}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
