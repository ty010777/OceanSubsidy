(function(e,W){typeof exports=="object"&&typeof module<"u"?module.exports=W(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],W):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=W(e.Vue,e.Pinia))})(this,(function(e,W){"use strict";const I=W.defineStore("progress",{actions:{init(x,T){var h,N;this[x]={id:T.ProjectID,type:(h=T.SubsidyPlanType)==null?void 0:h.split(" ")[0],name:T.ProjectName,step:T.FormStep,status:T.Status,progress:T.ProgressStatus,changeStatus:(N=T.changeApply)==null?void 0:N.Status,organizer:T.Organizer,organizerName:T.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})});let oe=Date.now();const z=(x,T,h)=>{const N=I();if([1,14].includes(N[x].status)||[1,4].includes(N[x].changeStatus))return!0;if(N[x].status===42)switch(x){case"culture":if([2,3,5].includes(h))return!0;break;case"multiple":if([2,3,4,5].includes(h))return!0;break;case"accessibility":if([2,3,4,5].includes(h))return!0;break}return!1},ne=()=>`id--${oe++}`,R=x=>parseInt(x)||0,K=W.defineStore("message",{state:()=>({error:null})}),{ajax:re}=rxjs.ajax,{map:ae}=rxjs;let Z="";const de=(x,T={})=>Q("Service/OFS/Accessibility.ashx",{method:x,param:T}),se=(x,T={})=>Q("Service/OFS/Culture.ashx",{method:x,param:T}),me=x=>`${Z}/Service/OFS/Download.ashx?path=${x}`,ce=(x,T={})=>Q("Service/OFS/Education.ashx",{method:x,param:T}),ie=(x,T={})=>Q("Service/OFS/Literacy.ashx",{method:x,param:T}),pe=(x,T={})=>Q("Service/OFS/Multiple.ashx",{method:x,param:T}),Ve=({response:x,status:T})=>{if(T===200){if(x.success)return x.data;K().error=x.message}},Q=(x,T={})=>{const h={};T.constructor!==FormData&&(h["Content-Type"]="application/json");const N={body:T,headers:h,method:"POST",url:`${Z}/${x}`};return re(N).pipe(ae(Ve))},A=Object.assign(Q,{accessibility:de,culture:se,download:me,education:ce,literacy:ie,multiple:pe,upload:x=>{const T=new FormData;return T.append("file",x),Q("Service/OFS/Upload.ashx",T)}});function fe(x){return x&&x.__esModule&&Object.prototype.hasOwnProperty.call(x,"default")?x.default:x}var Y={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var Ne=Y.exports,X;function Ee(){return X||(X=1,(function(x,T){(function(h,N,d){var f=function(l,r,s){s=a.extend({},a.options,s);var c=a.runValidations(l,r,s);if(c.some(function(n){return a.isPromise(n.error)}))throw new Error("Use validate.async if you want support for promises");return f.processValidationResults(c,s)},a=f;a.extend=function(l){return[].slice.call(arguments,1).forEach(function(r){for(var s in r)l[s]=r[s]}),l},a.extend(f,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var l=a.format("%{major}.%{minor}.%{patch}",a.version);return a.isEmpty(a.version.metadata)||(l+="+"+a.version.metadata),l}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(l,r,s){var c=[],n,g,B,C,E,o,u;(a.isDomElement(l)||a.isJqueryElement(l))&&(l=a.collectFormValues(l));for(n in r){B=a.getDeepObjectValue(l,n),C=a.result(r[n],B,l,n,s,r);for(g in C){if(E=a.validators[g],!E)throw u=a.format("Unknown validator %{name}",{name:g}),new Error(u);o=C[g],o=a.result(o,B,l,n,s,r),o&&c.push({attribute:n,value:B,validator:g,globalOptions:s,attributes:l,options:o,error:E.call(E,B,o,n,l,s)})}}return c},processValidationResults:function(l,r){l=a.pruneEmptyErrors(l,r),l=a.expandMultipleErrors(l,r),l=a.convertErrorMessages(l,r);var s=r.format||"grouped";if(typeof a.formatters[s]=="function")l=a.formatters[s](l);else throw new Error(a.format("Unknown format %{format}",r));return a.isEmpty(l)?void 0:l},async:function(l,r,s){s=a.extend({},a.async.options,s);var c=s.wrapErrors||function(g){return g};s.cleanAttributes!==!1&&(l=a.cleanAttributes(l,r));var n=a.runValidations(l,r,s);return new a.Promise(function(g,B){a.waitForResults(n).then(function(){var C=a.processValidationResults(n,s);C?B(new c(C,s,l,r)):g(l)},function(C){B(C)})})},single:function(l,r,s){return s=a.extend({},a.single.options,s,{format:"flat",fullMessages:!1}),a({single:l},{single:r},s)},waitForResults:function(l){return l.reduce(function(r,s){return a.isPromise(s.error)?r.then(function(){return s.error.then(function(c){s.error=c||null})}):r},new a.Promise(function(r){r()}))},result:function(l){var r=[].slice.call(arguments,1);return typeof l=="function"&&(l=l.apply(null,r)),l},isNumber:function(l){return typeof l=="number"&&!isNaN(l)},isFunction:function(l){return typeof l=="function"},isInteger:function(l){return a.isNumber(l)&&l%1===0},isBoolean:function(l){return typeof l=="boolean"},isObject:function(l){return l===Object(l)},isDate:function(l){return l instanceof Date},isDefined:function(l){return l!=null},isPromise:function(l){return!!l&&a.isFunction(l.then)},isJqueryElement:function(l){return l&&a.isString(l.jquery)},isDomElement:function(l){return!l||!l.querySelectorAll||!l.querySelector?!1:a.isObject(document)&&l===document?!0:typeof HTMLElement=="object"?l instanceof HTMLElement:l&&typeof l=="object"&&l!==null&&l.nodeType===1&&typeof l.nodeName=="string"},isEmpty:function(l){var r;if(!a.isDefined(l))return!0;if(a.isFunction(l))return!1;if(a.isString(l))return a.EMPTY_STRING_REGEXP.test(l);if(a.isArray(l))return l.length===0;if(a.isDate(l))return!1;if(a.isObject(l)){for(r in l)return!1;return!0}return!1},format:a.extend(function(l,r){return a.isString(l)?l.replace(a.format.FORMAT_REGEXP,function(s,c,n){return c==="%"?"%{"+n+"}":String(r[n])}):l},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(l){return a.isNumber(l)?l*100%1===0?""+l:parseFloat(Math.round(l*100)/100).toFixed(2):a.isArray(l)?l.map(function(r){return a.prettify(r)}).join(", "):a.isObject(l)?a.isDefined(l.toString)?l.toString():JSON.stringify(l):(l=""+l,l.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(r,s,c){return""+s+" "+c.toLowerCase()}).toLowerCase())},stringifyValue:function(l,r){var s=r&&r.prettify||a.prettify;return s(l)},isString:function(l){return typeof l=="string"},isArray:function(l){return{}.toString.call(l)==="[object Array]"},isHash:function(l){return a.isObject(l)&&!a.isArray(l)&&!a.isFunction(l)},contains:function(l,r){return a.isDefined(l)?a.isArray(l)?l.indexOf(r)!==-1:r in l:!1},unique:function(l){return a.isArray(l)?l.filter(function(r,s,c){return c.indexOf(r)==s}):l},forEachKeyInKeypath:function(l,r,s){if(a.isString(r)){var c="",n,g=!1;for(n=0;n<r.length;++n)switch(r[n]){case".":g?(g=!1,c+="."):(l=s(l,c,!1),c="");break;case"\\":g?(g=!1,c+="\\"):g=!0;break;default:g=!1,c+=r[n];break}return s(l,c,!0)}},getDeepObjectValue:function(l,r){if(a.isObject(l))return a.forEachKeyInKeypath(l,r,function(s,c){if(a.isObject(s))return s[c]})},collectFormValues:function(l,r){var s={},c,n,g,B,C,E;if(a.isJqueryElement(l)&&(l=l[0]),!l)return s;for(r=r||{},B=l.querySelectorAll("input[name], textarea[name]"),c=0;c<B.length;++c)if(g=B.item(c),!a.isDefined(g.getAttribute("data-ignored"))){var o=g.name.replace(/\./g,"\\\\.");E=a.sanitizeFormValue(g.value,r),g.type==="number"?E=E?+E:null:g.type==="checkbox"?g.attributes.value?g.checked||(E=s[o]||null):E=g.checked:g.type==="radio"&&(g.checked||(E=s[o]||null)),s[o]=E}for(B=l.querySelectorAll("select[name]"),c=0;c<B.length;++c)if(g=B.item(c),!a.isDefined(g.getAttribute("data-ignored"))){if(g.multiple){E=[];for(n in g.options)C=g.options[n],C&&C.selected&&E.push(a.sanitizeFormValue(C.value,r))}else{var u=typeof g.options[g.selectedIndex]<"u"?g.options[g.selectedIndex].value:"";E=a.sanitizeFormValue(u,r)}s[g.name]=E}return s},sanitizeFormValue:function(l,r){return r.trim&&a.isString(l)&&(l=l.trim()),r.nullify!==!1&&l===""?null:l},capitalize:function(l){return a.isString(l)?l[0].toUpperCase()+l.slice(1):l},pruneEmptyErrors:function(l){return l.filter(function(r){return!a.isEmpty(r.error)})},expandMultipleErrors:function(l){var r=[];return l.forEach(function(s){a.isArray(s.error)?s.error.forEach(function(c){r.push(a.extend({},s,{error:c}))}):r.push(s)}),r},convertErrorMessages:function(l,r){r=r||{};var s=[],c=r.prettify||a.prettify;return l.forEach(function(n){var g=a.result(n.error,n.value,n.attribute,n.options,n.attributes,n.globalOptions);if(!a.isString(g)){s.push(n);return}g[0]==="^"?g=g.slice(1):r.fullMessages!==!1&&(g=a.capitalize(c(n.attribute))+" "+g),g=g.replace(/\\\^/g,"^"),g=a.format(g,{value:a.stringifyValue(n.value,r)}),s.push(a.extend({},n,{error:g}))}),s},groupErrorsByAttribute:function(l){var r={};return l.forEach(function(s){var c=r[s.attribute];c?c.push(s):r[s.attribute]=[s]}),r},flattenErrorsToArray:function(l){return l.map(function(r){return r.error}).filter(function(r,s,c){return c.indexOf(r)===s})},cleanAttributes:function(l,r){function s(g,B,C){return a.isObject(g[B])?g[B]:g[B]=C?!0:{}}function c(g){var B={},C;for(C in g)g[C]&&a.forEachKeyInKeypath(B,C,s);return B}function n(g,B){if(!a.isObject(g))return g;var C=a.extend({},g),E,o;for(o in g)E=B[o],a.isObject(E)?C[o]=n(C[o],E):E||delete C[o];return C}return!a.isObject(r)||!a.isObject(l)?{}:(r=c(r),n(l,r))},exposeModule:function(l,r,s,c,n){s?(c&&c.exports&&(s=c.exports=l),s.validate=l):(r.validate=l,l.isFunction(n)&&n.amd&&n([],function(){return l}))},warn:function(l){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+l)},error:function(l){typeof console<"u"&&console.error&&console.error("[validate.js] "+l)}}),f.validators={presence:function(l,r){if(r=a.extend({},this.options,r),r.allowEmpty!==!1?!a.isDefined(l):a.isEmpty(l))return r.message||this.message||"can't be blank"},length:function(l,r,s){if(a.isDefined(l)){r=a.extend({},this.options,r);var c=r.is,n=r.maximum,g=r.minimum,B=r.tokenizer||function(u){return u},C,E=[];l=B(l);var o=l.length;if(!a.isNumber(o))return r.message||this.notValid||"has an incorrect length";if(a.isNumber(c)&&o!==c&&(C=r.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",E.push(a.format(C,{count:c}))),a.isNumber(g)&&o<g&&(C=r.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",E.push(a.format(C,{count:g}))),a.isNumber(n)&&o>n&&(C=r.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",E.push(a.format(C,{count:n}))),E.length>0)return r.message||E}},numericality:function(l,r,s,c,n){if(a.isDefined(l)){r=a.extend({},this.options,r);var g=[],B,C,E={greaterThan:function(m,V){return m>V},greaterThanOrEqualTo:function(m,V){return m>=V},equalTo:function(m,V){return m===V},lessThan:function(m,V){return m<V},lessThanOrEqualTo:function(m,V){return m<=V},divisibleBy:function(m,V){return m%V===0}},o=r.prettify||n&&n.prettify||a.prettify;if(a.isString(l)&&r.strict){var u="^-?(0|[1-9]\\d*)";if(r.onlyInteger||(u+="(\\.\\d+)?"),u+="$",!new RegExp(u).test(l))return r.message||r.notValid||this.notValid||this.message||"must be a valid number"}if(r.noStrings!==!0&&a.isString(l)&&!a.isEmpty(l)&&(l=+l),!a.isNumber(l))return r.message||r.notValid||this.notValid||this.message||"is not a number";if(r.onlyInteger&&!a.isInteger(l))return r.message||r.notInteger||this.notInteger||this.message||"must be an integer";for(B in E)if(C=r[B],a.isNumber(C)&&!E[B](l,C)){var b="not"+a.capitalize(B),i=r[b]||this[b]||this.message||"must be %{type} %{count}";g.push(a.format(i,{count:C,type:o(B)}))}if(r.odd&&l%2!==1&&g.push(r.notOdd||this.notOdd||this.message||"must be odd"),r.even&&l%2!==0&&g.push(r.notEven||this.notEven||this.message||"must be even"),g.length)return r.message||g}},datetime:a.extend(function(l,r){if(!a.isFunction(this.parse)||!a.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(a.isDefined(l)){r=a.extend({},this.options,r);var s,c=[],n=r.earliest?this.parse(r.earliest,r):NaN,g=r.latest?this.parse(r.latest,r):NaN;if(l=this.parse(l,r),isNaN(l)||r.dateOnly&&l%864e5!==0)return s=r.notValid||r.message||this.notValid||"must be a valid date",a.format(s,{value:arguments[0]});if(!isNaN(n)&&l<n&&(s=r.tooEarly||r.message||this.tooEarly||"must be no earlier than %{date}",s=a.format(s,{value:this.format(l,r),date:this.format(n,r)}),c.push(s)),!isNaN(g)&&l>g&&(s=r.tooLate||r.message||this.tooLate||"must be no later than %{date}",s=a.format(s,{date:this.format(g,r),value:this.format(l,r)}),c.push(s)),c.length)return a.unique(c)}},{parse:null,format:null}),date:function(l,r){return r=a.extend({},r,{dateOnly:!0}),a.validators.datetime.call(a.validators.datetime,l,r)},format:function(l,r){(a.isString(r)||r instanceof RegExp)&&(r={pattern:r}),r=a.extend({},this.options,r);var s=r.message||this.message||"is invalid",c=r.pattern,n;if(a.isDefined(l)&&(!a.isString(l)||(a.isString(c)&&(c=new RegExp(r.pattern,r.flags)),n=c.exec(l),!n||n[0].length!=l.length)))return s},inclusion:function(l,r){if(a.isDefined(l)&&(a.isArray(r)&&(r={within:r}),r=a.extend({},this.options,r),!a.contains(r.within,l))){var s=r.message||this.message||"^%{value} is not included in the list";return a.format(s,{value:l})}},exclusion:function(l,r){if(a.isDefined(l)&&(a.isArray(r)&&(r={within:r}),r=a.extend({},this.options,r),!!a.contains(r.within,l))){var s=r.message||this.message||"^%{value} is restricted";return a.isString(r.within[l])&&(l=r.within[l]),a.format(s,{value:l})}},email:a.extend(function(l,r){r=a.extend({},this.options,r);var s=r.message||this.message||"is not a valid email";if(a.isDefined(l)&&(!a.isString(l)||!this.PATTERN.exec(l)))return s},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(l,r,s,c,n){if(a.isDefined(l)){a.isString(r)&&(r={attribute:r}),r=a.extend({},this.options,r);var g=r.message||this.message||"is not equal to %{attribute}";if(a.isEmpty(r.attribute)||!a.isString(r.attribute))throw new Error("The attribute must be a non empty string");var B=a.getDeepObjectValue(c,r.attribute),C=r.comparator||function(o,u){return o===u},E=r.prettify||n&&n.prettify||a.prettify;if(!C(l,B,r,s,c))return a.format(g,{attribute:E(r.attribute)})}},url:function(l,r){if(a.isDefined(l)){r=a.extend({},this.options,r);var s=r.message||this.message||"is not a valid url",c=r.schemes||this.schemes||["http","https"],n=r.allowLocal||this.allowLocal||!1,g=r.allowDataUrl||this.allowDataUrl||!1;if(!a.isString(l))return s;var B="^(?:(?:"+c.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",C="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(n?C+="?":B+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",B+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+C+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",g){var E="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",o="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",u="data:(?:"+E+")?(?:;base64)?,"+o;B="(?:"+B+")|(?:^"+u+"$)"}var b=new RegExp(B,"i");if(!b.exec(l))return s}},type:a.extend(function(l,r,s,c,n){if(a.isString(r)&&(r={type:r}),!!a.isDefined(l)){var g=a.extend({},this.options,r),B=g.type;if(!a.isDefined(B))throw new Error("No type was specified");var C;if(a.isFunction(B)?C=B:C=this.types[B],!a.isFunction(C))throw new Error("validate.validators.type.types."+B+" must be a function.");if(!C(l,g,s,c,n)){var E=r.message||this.messages[B]||this.message||g.message||(a.isFunction(B)?"must be of the correct type":"must be of type %{type}");return a.isFunction(E)&&(E=E(l,r,s,c,n)),a.format(E,{attribute:a.prettify(s),type:B})}}},{types:{object:function(l){return a.isObject(l)&&!a.isArray(l)},array:a.isArray,integer:a.isInteger,number:a.isNumber,string:a.isString,date:a.isDate,boolean:a.isBoolean},messages:{}})},f.formatters={detailed:function(l){return l},flat:a.flattenErrorsToArray,grouped:function(l){var r;l=a.groupErrorsByAttribute(l);for(r in l)l[r]=a.flattenErrorsToArray(l[r]);return l},constraint:function(l){var r;l=a.groupErrorsByAttribute(l);for(r in l)l[r]=l[r].map(function(s){return s.validator}).sort();return l}},f.exposeModule(f,this,h,N,d)}).call(Ne,T,x,null)})(Y,Y.exports)),Y.exports}var be=Ee();const v=fe(be),O=(x,T,h="")=>{const N={};Object.keys(T).forEach(a=>{const l=T[a];v.isString(l)?N[a]={presence:{allowEmpty:!1,message:`^請輸入${l}`}}:N[a]=l});const d={},f=v(x,N);return f&&Object.keys(f).forEach(a=>d[`${h}${a}`]=f[a].join(",")),d},ke={class:"block"},ge={class:"mt-4"},ue={class:"table align-middle gray-table side-table"},ye={key:0},xe={key:1,class:"text-light-gray"},Be={class:"d-flex flex-column gap-2"},he={key:0},$e={class:"mt-4"},Ce={class:"table align-middle gray-table side-table"},_e={class:"row g-3"},Te={class:"col-12 col-xl-2"},we={class:"text-gray mb-2"},De={class:"col-12 col-xl-3"},Fe={class:"text-gray mb-2"},Se={class:"col-12 col-xl-4"},Ae={class:"row g-1"},Ue={class:"col-7"},Me={class:"col-5"},Oe={class:"col-12 col-xl-3"},Ie={class:"text-gray mb-2"},je={class:"col-12"},Pe={class:"text-gray mb-2"},qe={class:"mt-4"},Le={class:"table align-middle gray-table side-table"},Re={class:"mt-4"},ze={class:"table align-middle gray-table side-table"},Ge={key:0,class:"table-responsive mt-3 mb-0"},Je={class:"table align-middle gray-table"},Qe={key:0},We={key:0},Ye={class:"d-flex gap-2"},He=["onClick"],Ke={class:"mt-4"},Ze={class:"table align-middle gray-table side-table"},Xe={key:0,class:"block-bottom bg-light-teal"},ve={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.ref(),a=e.computed(()=>z("accessibility",s.value.Status,1)),l=e.ref({}),r=e.computed(()=>c.value.filter(b=>!b.Deleted)),s=e.ref({}),c=e.ref([]),n=e.computed({get:()=>!!r.value.length,set:b=>{b?g():c.value.forEach(i=>i.Deleted=!0)}}),g=()=>c.value.push({}),B=T,C=()=>{A.accessibility("getApplication",{ID:h.id}).subscribe(b=>{s.value=b.Project,f.value=b.Contacts,c.value=b.ReceivedSubsidies,s.value.OrgCategory=s.value.OrgCategory||null,I().init("accessibility",s.value),d.value=s.value.changeApply,s.value.changeApply=void 0})},E=b=>b.Deleted=!0,o=b=>{var m,V;if(l.value={},b&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:s.value,Contacts:f.value,ReceivedSubsidies:c.value.filter(t=>t.ID||!t.Deleted),Before:(m=d.value)==null?void 0:m.Form1Before,After:(V=d.value)==null?void 0:V.Form1After,Submit:b?"true":"false"};A.accessibility("saveApplication",i).subscribe(t=>{b?B("next",t.ID):s.value.ID?C():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let b={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return s.value.OrgCategory==="2"&&(b.RegisteredNum="立案登記證字號"),l.value=O(s.value,b),b={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},f.value.forEach((i,m)=>Object.assign(l.value,O(i,b,`contact-${m}-`))),b={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},c.value.forEach((i,m)=>Object.assign(l.value,O(i,b,`received-${m}-`))),d.value&&(b={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(d.value,b))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(b=>{N.value=b[0],h.id?C():A.accessibility("getEmptyApplication").subscribe(i=>{s.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},i),f.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("accessibility",s.value)})})}),e.provide("editable",a),(b,i)=>{const m=e.resolveComponent("required-label"),V=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),p=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-boolean"),U=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ke,[i[42]||(i[42]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ge,[e.createElementVNode("table",ue,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[15]||(i[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(s).Year),1)]),e.createElementVNode("tr",null,[i[16]||(i[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(s).ProjectID?(e.openBlock(),e.createElementBlock("span",ye,e.toDisplayString(e.unref(s).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",xe,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[i[17]||(i[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(s).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[18]||(i[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).ProjectName,modelValue:e.unref(s).ProjectName,"onUpdate:modelValue":i[0]||(i[0]=w=>e.unref(s).ProjectName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[19]||(i[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(s).OrgName,"onUpdate:modelValue":i[1]||(i[1]=w=>e.unref(s).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[20]||(i[20]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Be,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(s).OrgCategory,"onUpdate:modelValue":i[2]||(i[2]=w=>e.unref(s).OrgCategory=w)},null,8,["error","options","modelValue"])]),e.unref(s).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",he,[e.createVNode(V,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(s).RegisteredNum,"onUpdate:modelValue":i[3]||(i[3]=w=>e.unref(s).RegisteredNum=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[21]||(i[21]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(s).TaxID,"onUpdate:modelValue":i[4]||(i[4]=w=>e.unref(s).TaxID=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[22]||(i[22]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(s).Address,"onUpdate:modelValue":i[5]||(i[5]=w=>e.unref(s).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),i[43]||(i[43]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",$e,[e.createElementVNode("table",Ce,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",_e,[e.createElementVNode("div",Te,[e.createElementVNode("div",we,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[23]||(i[23]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(l)[`contact-${S}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",De,[e.createElementVNode("div",Fe,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[24]||(i[24]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(l)[`contact-${S}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Se,[i[25]||(i[25]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ae,[e.createElementVNode("div",Ue,[e.createVNode(V,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Me,[e.createVNode(V,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Oe,[e.createElementVNode("div",Ie,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[26]||(i[26]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(l)[`contact-${S}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",je,[e.createElementVNode("div",Pe,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[27]||(i[27]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(l)[`contact-${S}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),i[44]||(i[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",qe,[e.createElementVNode("table",Le,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[28]||(i[28]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[i[29]||(i[29]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(p,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(s).Target,"onUpdate:modelValue":i[6]||(i[6]=w=>e.unref(s).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[30]||(i[30]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(s).Summary,"onUpdate:modelValue":i[7]||(i[7]=w=>e.unref(s).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[31]||(i[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(s).Quantified,"onUpdate:modelValue":i[8]||(i[8]=w=>e.unref(s).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[32]||(i[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(s).Qualitative,"onUpdate:modelValue":i[9]||(i[9]=w=>e.unref(s).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Re,[e.createElementVNode("table",ze,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[38]||(i[38]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(k,{modelValue:e.unref(n),"onUpdate:modelValue":i[10]||(i[10]=w=>e.isRef(n)?n.value=w:null)},null,8,["modelValue"]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",Ge,[e.createElementVNode("table",Je,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[33]||(i[33]=e.createElementVNode("th",null,"計畫名稱",-1)),i[34]||(i[34]=e.createElementVNode("th",null,"補助單位",-1)),i[35]||(i[35]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Qe,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l)[`received-${S}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(l)[`received-${S}-Unit`],modelValue:w.Unit,"onUpdate:modelValue":M=>w.Unit=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${S}-Amount`],modelValue:w.Amount,"onUpdate:modelValue":M=>w.Amount=M},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",We,[e.createElementVNode("div",Ye,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>E(w),type:"button"},[...i[36]||(i[36]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,He)):e.createCommentVNode("",!0),S+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...i[37]||(i[37]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[i[41]||(i[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ke,[e.createElementVNode("table",Ze,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[39]||(i[39]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(d).Form1Before,"onUpdate:modelValue":i[11]||(i[11]=w=>e.unref(d).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[40]||(i[40]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(d).Form1After,"onUpdate:modelValue":i[12]||(i[12]=w=>e.unref(d).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Xe,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[13]||(i[13]=w=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[14]||(i[14]=w=>o(!0)),type:"button"},[...i[45]||(i[45]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},et={class:"block"},tt={key:0,class:"text-pink lh-base mt-4"},lt={class:"mt-4"},ot={class:"table align-middle gray-table"},nt={class:"text-center"},rt={key:0,width:"180"},at={class:"text-center"},dt={key:0},st=["innerHTML"],mt=["href"],ct={key:0,class:"text-center"},it={key:0},pt={key:1,class:"text-pink"},Vt={key:1,class:"tag-group mt-2 gap-1"},ft={key:0,class:"tag tag-green-light"},Nt=["download","href"],Et=["onClick"],bt={class:"mt-4"},kt={class:"table align-middle gray-table side-table"},gt={key:0,class:"block-bottom bg-light-teal"},ut=["disabled"],yt={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/ACC/附件01-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/ACC/附件02-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/ACC/附件03-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/ACC/附件04-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),d=e.ref(),f=e.computed(()=>N.value.some(E=>!E.Optional&&!E.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("accessibility",r.value.Status,2)),l=e.ref({}),r=e.ref({}),s=(E,o)=>{o.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:o.Path,Name:r.value.ProjectID+"_"+(E.Multiple?o.Name:`${E.Title}.pdf`)})},c=A.download,n=T,g=()=>{rxjs.forkJoin([A.accessibility("getAttachment",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=N.value.filter(u=>{var b;return!((b=u.Excludes)!=null&&b.includes(r.value.OrgCategory))}),N.value.forEach(u=>{u.Files=o.Attachments.filter(b=>b.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(b=>!b.Deleted).length)}),I().init("accessibility",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},B=E=>{var u,b;if(l.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:h.id,Attachments:N.value.reduce((i,m)=>i.concat(m.Files),[]),Before:(u=d.value)==null?void 0:u.Form5Before,After:(b=d.value)==null?void 0:b.Form5After,Submit:E?"true":"false"};A.accessibility("saveAttachment",o).subscribe(()=>{E?n("next"):g()})},C=()=>{if(d.value){const E={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(d.value,E))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(E,o)=>{const u=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",et,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",tt,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",lt,[e.createElementVNode("table",ot,[e.createElementVNode("thead",nt,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",rt,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",at,e.toDisplayString(V+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",dt,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,st)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,mt)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",ct,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",it,"已上傳")):(e.openBlock(),e.createElementBlock("span",pt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>s(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Vt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ft,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,Nt),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Et)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",bt,[e.createElementVNode("table",kt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(d).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(d).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(d).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",gt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>B(!0)),disabled:e.unref(f),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ut)])):e.createCommentVNode("",!0)],64)}}},xt={class:"block"},Bt={class:"mt-4"},ht={class:"table-responsive mt-3 mb-0"},$t={class:"table align-middle gray-table"},Ct={key:0,width:"1"},_t={key:0},Tt={class:"d-flex gap-2"},wt=["onClick"],Dt={class:"table-responsive mt-3 mb-0"},Ft={class:"table align-middle gray-table"},St={class:"mt-4"},At={class:"table align-middle gray-table side-table"},Ut={key:0,class:"block-bottom bg-light-teal"},Mt={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.computed(()=>z("accessibility",r.value.Status,4)),a=e.ref({}),l=e.computed(()=>N.value.filter(E=>!E.Deleted)),r=e.ref({}),s=()=>N.value.push({}),c=T,n=()=>{rxjs.forkJoin([A.accessibility("getBenefit",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=o.Benefits,N.value.length||s(),I().init("accessibility",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},g=E=>E.Deleted=!0,B=E=>{var u,b;if(a.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:r.value,Benefits:N.value,Before:(u=d.value)==null?void 0:u.Form4Before,After:(b=d.value)==null?void 0:b.Form4After,Submit:E?"true":"false"};A.accessibility("saveBenefit",o).subscribe(()=>{E?c("next"):n()})},C=()=>{let E={Benefit:"不可量化成果"};return a.value=O(r.value,E),E={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((o,u)=>Object.assign(a.value,O(o,E,`item-${u}-`))),d.value&&(E={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,O(d.value,E))),!Object.keys(a.value).length};return e.onMounted(n),e.provide("editable",f),(E,o)=>{const u=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xt,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Bt,[e.createElementVNode("div",ht,[e.createElementVNode("table",$t,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"目標值",-1)),o[7]||(o[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",Ct,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(a)[`item-${V}-Title`],modelValue:m.Title,"onUpdate:modelValue":t=>m.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(a)[`item-${V}-Target`],modelValue:m.Target,"onUpdate:modelValue":t=>m.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a)[`item-${V}-Description`],rows:"1",modelValue:m.Description,"onUpdate:modelValue":t=>m.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",_t,[e.createElementVNode("div",Tt,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>g(m),type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,wt)):e.createCommentVNode("",!0),V+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Dt,[e.createElementVNode("table",Ft,[o[10]||(o[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(r).Benefit,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(r).Benefit=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",St,[e.createElementVNode("table",At,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(d).Form4Before,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form4Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(d).Form4After,"onUpdate:modelValue":o[2]||(o[2]=m=>e.unref(d).Form4After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",Ut,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[3]||(o[3]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[4]||(o[4]=m=>B(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ot={class:"block"},It={class:"mt-4"},jt={class:"table-responsive mt-3 mb-0"},Pt={class:"table align-middle gray-table"},qt={class:"text-end"},Lt={class:"text-end"},Rt={class:"table-responsive"},zt={class:"table align-middle gray-table"},Gt=["colspan"],Jt={key:0,width:"1"},Qt={class:"text-end"},Wt={key:0},Yt={class:"d-flex gap-2"},Ht=["onClick"],Kt={class:"mt-4"},Zt={class:"table-responsive mt-3 mb-0"},Xt={class:"table align-middle gray-table"},vt={key:0,width:"1"},el={class:"text-end"},tl={key:0},ll={class:"d-flex gap-2"},ol=["onClick"],nl={class:"mt-4"},rl={class:"table align-middle gray-table side-table"},al={key:0,class:"block-bottom bg-light-teal"},dl={class:"text-center"},sl={class:"mb-5"},ml={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.computed(()=>z("accessibility",r.value.Status,3)),f=e.ref({}),a=e.computed(()=>c.value.filter(V=>!V.Deleted)),l=e.computed(()=>n.value.filter(V=>!V.Deleted)),r=e.ref({}),s=e.ref(),c=e.ref([]),n=e.ref([]),g=e.ref({}),B=e.ref(0),C=()=>c.value.push({}),E=()=>n.value.push({}),o=T,u=()=>{rxjs.forkJoin([A.accessibility("getFunding",{ID:h.id})]).subscribe(V=>{const t=V[0];r.value=t.Project,c.value=t.OtherSubsidies,n.value=t.BudgetPlans,g.value=t.GrantTargetSetting,c.value.length||C(),n.value.length||E(),I().init("accessibility",r.value),N.value=r.value.changeApply,r.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=(V,t)=>{var k,U;if(f.value={},V&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&r.value.ApplyAmount>g.value.GrantLimit*1e4){s.value.show(()=>i(V,!0));return}const p={Project:r.value,OtherSubsidies:c.value,BudgetPlans:n.value,Before:(k=N.value)==null?void 0:k.Form3Before,After:(U=N.value)==null?void 0:U.Form3After,Submit:V?"true":"false"};A.accessibility("saveFunding",p).subscribe(()=>{V?o("next"):u()})},m=()=>{let V={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=O(r.value,V),V={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},c.value.forEach((t,p)=>Object.assign(f.value,O(t,V,`other-${p}-`))),V={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},n.value.forEach((t,p)=>Object.assign(f.value,O(t,V,`plan-${p}-`))),N.value&&(V={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,O(N.value,V))),!Object.keys(f.value).length};return e.onMounted(u),e.provide("editable",d),e.watchEffect(()=>{r.value.OtherAmount=a.value.reduce((V,t)=>V+R(t.Amount),0),B.value=R(r.value.ApplyAmount)+R(r.value.SelfAmount)+R(r.value.OtherAmount),a.value.forEach(V=>V.percent=Math.round(R(V.Amount)/r.value.OtherAmount*1e4)/100),n.value.forEach(V=>V.sum=R(V.Amount)+R(V.OtherAmount))}),(V,t)=>{var M;const p=e.resolveComponent("input-integer"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),S=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ot,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",It,[e.createElementVNode("div",jt,[e.createElementVNode("table",Pt,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f).ApplyAmount,modelValue:e.unref(r).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(r).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f).SelfAmount,modelValue:e.unref(r).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(r).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",qt,e.toDisplayString((M=e.unref(r).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Lt,e.toDisplayString(e.unref(B).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Rt,[e.createElementVNode("table",zt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(d)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Gt)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",Jt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,y)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(f)[`other-${y}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":_=>F.Unit=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`other-${y}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":_=>F.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Qt,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`other-${y}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":_=>F.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",Wt,[e.createElementVNode("div",Yt,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>b(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ht)):e.createCommentVNode("",!0),y+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Kt,[e.createElementVNode("div",Zt,[e.createElementVNode("table",Xt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",vt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(F,y)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(f)[`plan-${y}-Title`],modelValue:F.Title,"onUpdate:modelValue":_=>F.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`plan-${y}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":_=>F.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`plan-${y}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":_=>F.OtherAmount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",el,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`plan-${y}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":_=>F.Description=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",tl,[e.createElementVNode("div",ll,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>b(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ol)):e.createCommentVNode("",!0),y+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",nl,[e.createElementVNode("table",rl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(N).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(N).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",al,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>i(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(S,{ref_key:"modal",ref:s},{default:e.withCtx(()=>[e.createElementVNode("div",dl,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",sl,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(g).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},cl={class:"block"},il={class:"text-teal fw-bold py-3"},pl={class:"table-responsive"},Vl={class:"table align-middle gray-table"},fl={class:"text-end"},Nl={class:"text-end"},El={class:"mt-4"},bl={class:"table align-middle gray-table"},kl={class:"text-center"},gl={key:0,width:"180"},ul={class:"text-center"},yl=["href"],xl={key:0,class:"text-center"},Bl={key:0},hl={key:1,class:"text-pink"},$l={key:1,class:"tag-group mt-2 gap-1"},Cl={key:0,class:"tag tag-green-light"},_l=["download","href"],Tl=["onClick"],wl={class:"block-bottom bg-light-teal"},Dl=!0,Fl={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(0),d=e.ref({}),f=e.ref([{Type:1,Title:"領據",Files:[]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_第一期請款_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.accessibility("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("accessibility",d.value),f.value=f.value.filter(n=>{var g;return!((g=n.Excludes)!=null&&g.includes(d.value.OrgCategory))}),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",Dl),(c,n)=>{var E;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",cl,[n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",il,"核定經費: "+e.toDisplayString((E=e.unref(d).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("div",pl,[e.createElementVNode("table",Vl,[n[5]||(n[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",fl,e.toDisplayString(e.unref(N)),1),n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=o=>e.isRef(N)?N.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",Nl,e.toDisplayString(e.unref(a))+"%",1),n[4]||(n[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[13]||(n[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",El,[e.createElementVNode("table",bl,[e.createElementVNode("thead",kl,[e.createElementVNode("tr",null,[n[6]||(n[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",gl,"狀態")),n[8]||(n[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(o,u)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",ul,e.toDisplayString(u+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,yl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",xl,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Bl,"已上傳")):(e.openBlock(),e.createElementBlock("span",hl,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",$l,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Cl,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(r)(b.Path)},e.toDisplayString(b.Name),9,_l),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>b.Deleted=!0,type:"button"},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Tl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",wl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=o=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=o=>s()),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Sl={class:"block"},Al={class:"text-teal fw-bold py-3"},Ul={class:"text-teal fw-bold pb-3"},Ml={class:"table-responsive"},Ol={class:"table align-middle gray-table"},Il={class:"text-end"},jl={class:"text-end"},Pl={class:"mt-4"},ql={class:"table align-middle gray-table"},Ll={class:"text-center"},Rl={key:0,width:"180"},zl={class:"text-center"},Gl=["href"],Jl={key:0,class:"text-center"},Ql={key:0},Wl={key:1,class:"text-pink"},Yl={key:1,class:"tag-group mt-2 gap-1"},Hl={key:0,class:"tag tag-green-light"},Kl=["download","href"],Zl=["onClick"],Xl={class:"block-bottom bg-light-teal"},vl=!0,ee=3e4,eo={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(3e4),d=e.ref({}),f=e.ref([{Type:1,Title:"領據",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/ACC/1-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/ACC/2-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/ACC/3-補助清單.docx",Files:[]},{Type:5,Title:"其他",Files:[]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_第二期請款_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.accessibility("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("accessibility",d.value),f.value=f.value.filter(n=>{var g;return!((g=n.Excludes)!=null&&g.includes(d.value.OrgCategory))}),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",vl),(c,n)=>{var E;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Sl,[n[10]||(n[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",Al,"核定經費: "+e.toDisplayString((E=e.unref(d).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("p",Ul,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(N)).toLocaleString())+"元",1),e.createElementVNode("div",Ml,[e.createElementVNode("table",Ol,[n[4]||(n[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Il,e.toDisplayString(e.unref(N)-ee),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(ee)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=o=>e.isRef(N)?N.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",jl,e.toDisplayString(e.unref(a))+"%",1),n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[12]||(n[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Pl,[e.createElementVNode("table",ql,[e.createElementVNode("thead",Ll,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Rl,"狀態")),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(o,u)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",zl,e.toDisplayString(u+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Gl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Jl,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Ql,"已上傳")):(e.openBlock(),e.createElementBlock("span",Wl,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Yl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Hl,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(r)(b.Path)},e.toDisplayString(b.Name),9,Kl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>b.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Zl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Xl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=o=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=o=>s()),type:"button"},[...n[13]||(n[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},to={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const d=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(d,{steps:T,type:"accessibility"})}}},lo={class:"block"},oo={class:"mt-4"},no={class:"table align-middle gray-table side-table"},ro={key:0,class:"d-flex align-items-center gap-2"},ao={class:"input-group w-auto"},so={class:"text-teal-dark"},mo={key:1,class:"invalid mt-0"},co={class:"table-responsive mt-4"},io={class:"table align-middle gray-table"},po={key:0},Vo={class:"input-group"},fo={key:0,class:"invalid mt-0"},No={key:0},Eo={class:"d-flex gap-2"},bo=["onClick"],ko={class:"mt-4"},go={class:"table align-middle gray-table"},uo={key:0},yo={key:0},xo={class:"d-flex gap-2"},Bo=["onClick"],ho={class:"mt-4"},$o={class:"table align-middle gray-table side-table"},Co={key:0,class:"block-bottom bg-light-teal"},_o={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=[{value:1,text:"50%"},{value:2,text:"100%"}],d=e.ref(),f=e.computed(()=>n.value.EndDate),a=e.computed(()=>z("accessibility",c.value.Status,2)),l=e.ref({}),r=e.computed(()=>g.value.filter(V=>!V.Deleted)),s=e.computed(()=>B.value.filter(V=>!V.Deleted)),c=e.ref({}),n=e.ref({}),g=e.ref([]),B=e.ref([]),C=()=>A.accessibility("createItem",{ID:h.id}).subscribe(V=>g.value.push(V)),E=()=>B.value.push({Type:0,ItemID:0}),o=T,u=()=>{rxjs.forkJoin([A.accessibility("getWorkSchedule",{ID:h.id})]).subscribe(V=>{const t=V[0];c.value=t.Project,n.value=t.GrantType,g.value=t.Items,B.value=t.Schedules,g.value.length||C(),B.value.length||E(),I().init("accessibility",c.value),d.value=c.value.changeApply,c.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=V=>{var p,k;if(l.value={},V&&!m()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:c.value,Items:g.value,Schedules:B.value,Before:(p=d.value)==null?void 0:p.Form2Before,After:(k=d.value)==null?void 0:k.Form2After,Submit:V?"true":"false"};A.accessibility("saveWorkSchedule",t).subscribe(()=>{V?o("next"):u()})},m=()=>{let V={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(c.value,V),V={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},r.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`item-${p}-`))),V={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},s.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`schedule-${p}-`))),d.value&&(V={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(d.value,V))),!Object.keys(l.value).length};return e.onMounted(u),e.provide("editable",a),(V,t)=>{const p=e.resolveComponent("required-label"),k=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",lo,[t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",oo,[e.createElementVNode("table",no,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",ro,[e.createElementVNode("div",ao,[e.createVNode(k,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[0]||(t[0]=y=>e.unref(c).StartTime=y)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[1]||(t[1]=y=>e.unref(c).EndTime=y)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",so,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(f)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",mo,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",co,[e.createElementVNode("table",io,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",po,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+_)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`item-${_}-Title`],modelValue:y.Title,"onUpdate:modelValue":D=>y.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Vo,[e.createVNode(S,{"empty-value":0,modelValue:y.Begin,"onUpdate:modelValue":D=>y.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(S,{"empty-value":0,modelValue:y.End,"onUpdate:modelValue":D=>y.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${_}-Begin`]||e.unref(l)[`item-${_}-End`]?(e.openBlock(),e.createElementBlock("div",fo,e.toDisplayString(e.unref(l)[`item-${_}-Begin`]||e.unref(l)[`item-${_}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`item-${_}-Deadline`],modelValue:y.Deadline,"onUpdate:modelValue":D=>y.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`item-${_}-Content`],rows:"1",modelValue:y.Content,"onUpdate:modelValue":D=>y.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",No,[e.createElementVNode("div",Eo,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(y),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bo)):e.createCommentVNode("",!0),_+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[29]||(t[29]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",ko,[e.createElementVNode("table",go,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[21]||(t[21]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",uo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${_}-Type`],options:N,modelValue:y.Type,"onUpdate:modelValue":D=>y.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${_}-ItemID`],options:e.unref(r),"text-name":"Title","value-name":"ID",modelValue:y.ItemID,"onUpdate:modelValue":D=>y.ItemID=D,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(y.ItemID?String.fromCharCode(65+e.unref(r).findIndex(D=>D.ID===y.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`schedule-${_}-Deadline`],modelValue:y.Deadline,"onUpdate:modelValue":D=>y.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`schedule-${_}-Content`],rows:"1",modelValue:y.Content,"onUpdate:modelValue":D=>y.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",yo,[e.createElementVNode("div",xo,[e.unref(s).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(y),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bo)):e.createCommentVNode("",!0),_+1===e.unref(s).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[23]||(t[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",ho,[e.createElementVNode("table",$o,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(d).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=y=>e.unref(d).Form2Before=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(d).Form2After,"onUpdate:modelValue":t[3]||(t[3]=y=>e.unref(d).Form2After=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Co,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=y=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=y=>i(!0)),type:"button"},[...t[30]||(t[30]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},To={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},wo={class:"modal-content"},Do={class:"modal-body"},Fo={class:"d-flex justify-content-center mt-4 gap-4"},So={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Ao={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(x,{expose:T}){let h;const N=e.ref(),d=x,f=()=>{h&&h()};return T({show:l=>{h=l,bootstrap.Modal.getOrCreateInstance(N.value).show()}}),(l,r)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:N,tabindex:"-1"},[e.createElementVNode("div",To,[e.createElementVNode("div",wo,[r[0]||(r[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Do,[e.renderSlot(l.$slots,"default"),e.createElementVNode("div",Fo,[e.createElementVNode("button",So,e.toDisplayString(d.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:f,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(d.confirm),1)])])])])],512)]))}},Uo={class:"application-step"},Mo=["onClick"],Oo={class:"step-content"},Io={class:"step-label"},jo={key:0,class:"step-status edit"},Po={key:1,class:"step-status"},qo={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(x,{emit:T}){const h=e.computed(()=>z(d.type,N[d.type].status,d.step)),N=I(),d=x,f=l=>{d.review?a("click",l.step):l.step<=N[d.type].step&&(location.href=`${l.url}.aspx?ID=${d.id}`)},a=T;return(l,r)=>(e.openBlock(),e.createElementBlock("div",Uo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.steps,s=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(h)&&(s.step<e.unref(N)[x.type].step||s.step===x.step)}]),onClick:c=>f(s),key:s,role:"button"},[e.createElementVNode("div",Oo,[e.createElementVNode("div",Io,e.toDisplayString(s.title),1),e.unref(h)&&s.step===x.step?(e.openBlock(),e.createElementBlock("div",jo,"編輯中")):s.step<e.unref(N)[x.type].step?(e.openBlock(),e.createElementBlock("div",Po,"已完成")):e.createCommentVNode("",!0)])],10,Mo))),128))]))}},Lo={class:"block"},Ro={class:"mt-4"},zo={class:"table align-middle gray-table side-table"},Go={key:0},Jo={key:1,class:"text-light-gray"},Qo={class:"d-flex gap-2"},Wo={key:0,class:"invalid mt-0"},Yo={class:"d-flex flex-column gap-2"},Ho={key:0},Ko={class:"mt-4"},Zo={class:"table align-middle gray-table side-table"},Xo={class:"row g-3"},vo={class:"col-12 col-xl-2"},en={class:"text-gray mb-2"},tn={class:"col-12 col-xl-3"},ln={class:"text-gray mb-2"},on={class:"col-12 col-xl-4"},nn={class:"row g-1"},rn={class:"col-7"},an={class:"col-5"},dn={class:"col-12 col-xl-3"},sn={class:"text-gray mb-2"},mn={class:"col-12"},cn={class:"text-gray mb-2"},pn={class:"mt-4"},Vn={class:"table align-middle gray-table side-table"},fn={class:"mt-4"},Nn={class:"table align-middle gray-table side-table"},En={key:0,class:"table-responsive mt-3 mb-0"},bn={class:"table align-middle gray-table"},kn={key:0},gn={key:0},un={class:"d-flex gap-2"},yn=["onClick"],xn={class:"mt-4"},Bn={class:"table align-middle gray-table side-table"},hn={key:0,class:"block-bottom bg-light-teal"},$n={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.ref(),a=e.computed(()=>z("culture",n.value.Status,1)),l=e.ref({}),r=e.ref(null),s=e.ref([]),c=e.computed(()=>B.value.filter(t=>!t.Deleted)),n=e.ref({}),g=e.computed(()=>s.value.filter(t=>!t.ParentCode)),B=e.ref([]),C=e.computed(()=>s.value.filter(t=>t.ParentCode===r.value)),E=e.computed({get:()=>!!c.value.length,set:t=>{t?o():B.value.forEach(p=>p.Deleted=!0)}}),o=()=>B.value.push({}),u=T,b=()=>{A.culture("getApplication",{ID:h.id}).subscribe(t=>{var p;n.value=t.Project,f.value=t.Contacts,B.value=t.ReceivedSubsidies,r.value=((p=s.value.find(k=>k.Code===n.value.Field))==null?void 0:p.ParentCode)||null,n.value.OrgCategory=n.value.OrgCategory||null,I().init("culture",n.value),d.value=n.value.changeApply,n.value.changeApply=void 0})},i=t=>t.Deleted=!0,m=t=>{var k,U;if(l.value={},t&&!V()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}const p={Project:n.value,Contacts:f.value,ReceivedSubsidies:B.value.filter(w=>w.ID||!w.Deleted),Before:(k=d.value)==null?void 0:k.Form1Before,After:(U=d.value)==null?void 0:U.Form1After,Submit:t?"true":"false"};A.culture("saveApplication",p).subscribe(w=>{t?u("next",w.ID):n.value.ID?b():window.location.href=`Application.aspx?ID=${w.ID}`})},V=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return n.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),l.value=O(n.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},f.value.forEach((p,k)=>Object.assign(l.value,O(p,t,`contact-${k}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},B.value.forEach((p,k)=>Object.assign(l.value,O(p,t,`received-${k}-`))),d.value&&(t={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(d.value,t))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.culture("getZgsCodes",{CodeGroup:"CULField"}),A.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{s.value=t[0],N.value=t[1],h.id?b():A.culture("getEmptyApplication").subscribe(p=>{r.value=null,n.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},p),f.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("culture",n.value)})})}),e.provide("editable",a),e.watch(r,()=>{r.value?C.value.find(t=>n.value.Field===t.Code)||(n.value.Field=C.value[0].Code):n.value.Field=null}),(t,p)=>{const k=e.resolveComponent("required-label"),U=e.resolveComponent("input-text"),w=e.resolveComponent("input-select"),S=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-boolean"),F=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Lo,[p[45]||(p[45]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Ro,[e.createElementVNode("table",zo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[17]||(p[17]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(n).Year),1)]),e.createElementVNode("tr",null,[p[18]||(p[18]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(n).ProjectID?(e.openBlock(),e.createElementBlock("span",Go,e.toDisplayString(e.unref(n).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Jo,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[p[19]||(p[19]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(n).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[20]||(p[20]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).ProjectName,modelValue:e.unref(n).ProjectName,"onUpdate:modelValue":p[0]||(p[0]=y=>e.unref(n).ProjectName=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[21]||(p[21]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Qo,[e.createVNode(w,{"empty-value":null,options:e.unref(g),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r),"onUpdate:modelValue":p[1]||(p[1]=y=>e.isRef(r)?r.value=y:null)},null,8,["options","modelValue"]),e.createVNode(w,{"empty-value":null,disabled:!e.unref(r),options:e.unref(C),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n).Field,"onUpdate:modelValue":p[2]||(p[2]=y=>e.unref(n).Field=y)},null,8,["disabled","options","modelValue"])]),e.unref(l).Field?(e.openBlock(),e.createElementBlock("div",Wo,e.toDisplayString(e.unref(l).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[22]||(p[22]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(n).OrgName,"onUpdate:modelValue":p[3]||(p[3]=y=>e.unref(n).OrgName=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[23]||(p[23]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Yo,[e.createElementVNode("div",null,[e.createVNode(w,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n).OrgCategory,"onUpdate:modelValue":p[4]||(p[4]=y=>e.unref(n).OrgCategory=y)},null,8,["error","options","modelValue"])]),e.unref(n).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Ho,[e.createVNode(U,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(n).RegisteredNum,"onUpdate:modelValue":p[5]||(p[5]=y=>e.unref(n).RegisteredNum=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[24]||(p[24]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(n).TaxID,"onUpdate:modelValue":p[6]||(p[6]=y=>e.unref(n).TaxID=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[25]||(p[25]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(n).Address,"onUpdate:modelValue":p[7]||(p[7]=y=>e.unref(n).Address=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),p[46]||(p[46]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ko,[e.createElementVNode("table",Zo,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Xo,[e.createElementVNode("div",vo,[e.createElementVNode("div",en,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[26]||(p[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${_}-Name`],modelValue:y.Name,"onUpdate:modelValue":D=>y.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",tn,[e.createElementVNode("div",ln,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[27]||(p[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${_}-JobTitle`],modelValue:y.JobTitle,"onUpdate:modelValue":D=>y.JobTitle=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",on,[p[28]||(p[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",nn,[e.createElementVNode("div",rn,[e.createVNode(U,{modelValue:y.Phone,"onUpdate:modelValue":D=>y.Phone=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",an,[e.createVNode(U,{placeholder:"請輸入分機",size:"4",modelValue:y.PhoneExt,"onUpdate:modelValue":D=>y.PhoneExt=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",dn,[e.createElementVNode("div",sn,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[29]||(p[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${_}-MobilePhone`],modelValue:y.MobilePhone,"onUpdate:modelValue":D=>y.MobilePhone=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",mn,[e.createElementVNode("div",cn,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[30]||(p[30]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(U,{error:e.unref(l)[`contact-${_}-EMail`],modelValue:y.EMail,"onUpdate:modelValue":D=>y.EMail=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),p[47]||(p[47]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",pn,[e.createElementVNode("table",Vn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[31]||(p[31]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[p[32]||(p[32]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(S,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(n).Target,"onUpdate:modelValue":p[8]||(p[8]=y=>e.unref(n).Target=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[33]||(p[33]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(n).Summary,"onUpdate:modelValue":p[9]||(p[9]=y=>e.unref(n).Summary=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[34]||(p[34]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(n).Quantified,"onUpdate:modelValue":p[10]||(p[10]=y=>e.unref(n).Quantified=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[35]||(p[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(n).Qualitative,"onUpdate:modelValue":p[11]||(p[11]=y=>e.unref(n).Qualitative=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",fn,[e.createElementVNode("table",Nn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[p[41]||(p[41]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(M,{modelValue:e.unref(E),"onUpdate:modelValue":p[12]||(p[12]=y=>e.isRef(E)?E.value=y:null)},null,8,["modelValue"]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",En,[e.createElementVNode("table",bn,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[p[36]||(p[36]=e.createElementVNode("th",null,"計畫名稱",-1)),p[37]||(p[37]=e.createElementVNode("th",null,"補助單位",-1)),p[38]||(p[38]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",kn,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${_}-Name`],modelValue:y.Name,"onUpdate:modelValue":D=>y.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(l)[`received-${_}-Unit`],modelValue:y.Unit,"onUpdate:modelValue":D=>y.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(l)[`received-${_}-Amount`],modelValue:y.Amount,"onUpdate:modelValue":D=>y.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",gn,[e.createElementVNode("div",un,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(y),type:"button"},[...p[39]||(p[39]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,yn)):e.createCommentVNode("",!0),_+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...p[40]||(p[40]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[p[44]||(p[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",xn,[e.createElementVNode("table",Bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[42]||(p[42]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(d).Form1Before,"onUpdate:modelValue":p[13]||(p[13]=y=>e.unref(d).Form1Before=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...p[43]||(p[43]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(d).Form1After,"onUpdate:modelValue":p[14]||(p[14]=y=>e.unref(d).Form1After=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",hn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:p[15]||(p[15]=y=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:p[16]||(p[16]=y=>m(!0)),type:"button"},[...p[48]||(p[48]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Cn={class:"block"},_n={key:0,class:"text-pink lh-base mt-4"},Tn={class:"mt-4"},wn={class:"table align-middle gray-table"},Dn={class:"text-center"},Fn={key:0,width:"180"},Sn={class:"text-center"},An={key:0},Un=["innerHTML"],Mn=["href"],On={key:0,class:"text-center"},In={key:0},jn={key:1,class:"text-pink"},Pn={key:1,class:"tag-group mt-2 gap-1"},qn={key:0,class:"tag tag-green-light"},Ln=["download","href"],Rn=["onClick"],zn={class:"mt-4"},Gn={class:"table align-middle gray-table side-table"},Jn={key:0,class:"block-bottom bg-light-teal"},Qn=["disabled"],Wn={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/CUL/1.申請表.docx",Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:"../../Template/CUL/2.計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/CUL/3.執行承諾書.docx",Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:"../../Template/CUL/4.未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),d=e.ref(),f=e.computed(()=>N.value.some(E=>!E.Optional&&!E.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("culture",r.value.Status,5)),l=e.ref({}),r=e.ref({}),s=(E,o)=>{o.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:o.Path,Name:r.value.ProjectID+"_"+(E.Multiple?o.Name:`${E.Title}.pdf`)})},c=A.download,n=T,g=()=>{rxjs.forkJoin([A.culture("getAttachment",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=N.value.filter(u=>{var b;return!((b=u.Excludes)!=null&&b.includes(r.value.OrgCategory))}),r.value.Status>=42&&N.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]}),N.value.forEach(u=>{u.Files=o.Attachments.filter(b=>b.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(b=>!b.Deleted).length)}),I().init("culture",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},B=E=>{var u,b;if(l.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:h.id,Attachments:N.value.reduce((i,m)=>i.concat(m.Files),[]),Before:(u=d.value)==null?void 0:u.Form5Before,After:(b=d.value)==null?void 0:b.Form5After,Submit:E?"true":"false"};A.culture("saveAttachment",o).subscribe(()=>{E?n("next"):g()})},C=()=>{if(d.value){const E={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(d.value,E))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(E,o)=>{const u=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Cn,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",_n,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Tn,[e.createElementVNode("table",wn,[e.createElementVNode("thead",Dn,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Fn,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",Sn,e.toDisplayString(V+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",An,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,Un)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Mn)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",On,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",In,"已上傳")):(e.openBlock(),e.createElementBlock("span",jn,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>s(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Pn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",qn,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,Ln),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Rn)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",zn,[e.createElementVNode("table",Gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(d).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(d).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(d).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Jn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>B(!0)),disabled:e.unref(f),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Qn)])):e.createCommentVNode("",!0)],64)}}},Yn={class:"block"},Hn={class:"mt-4"},Kn={class:"table-responsive mt-3 mb-0"},Zn={class:"table align-middle gray-table"},Xn={class:"text-end"},vn={class:"text-end"},er={class:"table-responsive"},tr={class:"table align-middle gray-table"},lr=["colspan"],or={key:0,width:"1"},nr={key:0},rr={class:"d-flex gap-2"},ar=["onClick"],dr={class:"mt-4"},sr={class:"table-responsive mt-3 mb-0"},mr={class:"table align-middle gray-table"},cr={key:0,width:"1"},ir={class:"text-end"},pr={key:0},Vr={class:"d-flex gap-2"},fr=["onClick"],Nr={class:"mt-4"},Er={class:"table align-middle gray-table side-table"},br={key:0,class:"block-bottom bg-light-teal"},kr={class:"text-center"},gr={class:"mb-5"},ur={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.computed(()=>z("culture",r.value.Status,3)),f=e.ref({}),a=e.computed(()=>n.value.filter(p=>!p.Deleted)),l=e.computed(()=>g.value.filter(p=>!p.Deleted)),r=e.ref({}),s=e.ref([]),c=e.ref(),n=e.ref([]),g=e.ref([]),B=e.ref({}),C=e.ref(0),E=()=>n.value.push({}),o=()=>g.value.push({ItemID:0}),u=T,b=()=>{rxjs.forkJoin([A.culture("getFunding",{ID:h.id})]).subscribe(p=>{const k=p[0];r.value=k.Project,n.value=k.OtherSubsidies,g.value=k.BudgetPlans,s.value=k.Items,B.value=k.GrantTargetSetting,n.value.length||E(),g.value.length||o(),I().init("culture",r.value),N.value=r.value.changeApply,r.value.changeApply=void 0})},i=p=>p.Deleted=!0,m=p=>p.Deleted=!0,V=(p,k)=>{var w,S;if(f.value={},p&&!t()){e.nextTick(()=>{var M;return(M=document.querySelector(".invalid"))==null?void 0:M.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!k&&r.value.ApplyAmount>B.value.GrantLimit*1e4){c.value.show(()=>V(p,!0));return}const U={Project:r.value,OtherSubsidies:n.value,BudgetPlans:g.value,Before:(w=N.value)==null?void 0:w.Form3Before,After:(S=N.value)==null?void 0:S.Form3After,Submit:p?"true":"false"};A.culture("saveFunding",U).subscribe(()=>{p?u("next"):b()})},t=()=>{let p={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=O(r.value,p),p={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},n.value.forEach((k,U)=>Object.assign(f.value,O(k,p,`other-${U}-`))),p={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},g.value.forEach((k,U)=>Object.assign(f.value,O(k,p,`plan-${U}-`))),N.value&&(p={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,O(N.value,p))),!Object.keys(f.value).length};return e.onMounted(b),e.provide("editable",d),e.watchEffect(()=>{r.value.OtherAmount=n.value.reduce((p,k)=>p+(k.Deleted?0:R(k.Amount)),0),C.value=R(r.value.ApplyAmount)+R(r.value.SelfAmount)+R(r.value.OtherAmount),g.value.forEach(p=>p.sum=R(p.Amount)+R(p.OtherAmount))}),(p,k)=>{var _;const U=e.resolveComponent("input-integer"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("required-label"),y=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Yn,[k[25]||(k[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Hn,[e.createElementVNode("div",Kn,[e.createElementVNode("table",Zn,[k[6]||(k[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).ApplyAmount,modelValue:e.unref(r).ApplyAmount,"onUpdate:modelValue":k[0]||(k[0]=D=>e.unref(r).ApplyAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).SelfAmount,modelValue:e.unref(r).SelfAmount,"onUpdate:modelValue":k[1]||(k[1]=D=>e.unref(r).SelfAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",Xn,e.toDisplayString((_=e.unref(r).OtherAmount)==null?void 0:_.toLocaleString()),1),e.createElementVNode("td",vn,e.toDisplayString(e.unref(C).toLocaleString()),1)])])])]),k[12]||(k[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",er,[e.createElementVNode("table",tr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(d)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,lr)]),e.createElementVNode("tr",null,[k[7]||(k[7]=e.createElementVNode("th",{width:"1"},null,-1)),k[8]||(k[8]=e.createElementVNode("th",null,"單位名稱",-1)),k[9]||(k[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",or,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(D,j)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,e.toDisplayString(j+1),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(f)[`other-${j}-Unit`],modelValue:D.Unit,"onUpdate:modelValue":P=>D.Unit=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`other-${j}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":P=>D.Amount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",nr,[e.createElementVNode("div",rr,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>i(D),type:"button"},[...k[10]||(k[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ar)):e.createCommentVNode("",!0),j+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...k[11]||(k[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),k[26]||(k[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",dr,[e.createElementVNode("div",sr,[e.createElementVNode("table",mr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[k[13]||(k[13]=e.createElementVNode("th",null,"重要工作項目",-1)),k[14]||(k[14]=e.createElementVNode("th",null,"預算項目",-1)),k[15]||(k[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),k[16]||(k[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),k[17]||(k[17]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),k[18]||(k[18]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",cr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(D,j)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,[e.createVNode(S,{"empty-value":0,error:e.unref(f)[`plan-${j}-ItemID`],options:e.unref(s),"text-name":"Title","value-name":"ID",modelValue:D.ItemID,"onUpdate:modelValue":P=>D.ItemID=P},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(f)[`plan-${j}-Title`],modelValue:D.Title,"onUpdate:modelValue":P=>D.Title=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`plan-${j}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":P=>D.Amount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`plan-${j}-OtherAmount`],modelValue:D.OtherAmount,"onUpdate:modelValue":P=>D.OtherAmount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",ir,e.toDisplayString(D.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(f)[`plan-${j}-Description`],rows:"1",modelValue:D.Description,"onUpdate:modelValue":P=>D.Description=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",pr,[e.createElementVNode("div",Vr,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>m(D),type:"button"},[...k[19]||(k[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,fr)):e.createCommentVNode("",!0),j+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...k[20]||(k[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),k[21]||(k[21]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[k[24]||(k[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Nr,[e.createElementVNode("table",Er,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...k[22]||(k[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":k[2]||(k[2]=D=>e.unref(N).Form3Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(F,null,{default:e.withCtx(()=>[...k[23]||(k[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":k[3]||(k[3]=D=>e.unref(N).Form3After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",br,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[4]||(k[4]=D=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[5]||(k[5]=D=>V(!0)),type:"button"},[...k[27]||(k[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(y,{ref_key:"modal",ref:c},{default:e.withCtx(()=>[e.createElementVNode("div",kr,[k[28]||(k[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",gr,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(B).GrantLimit)+"萬",1),k[29]||(k[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),k[30]||(k[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},yr={class:"block"},xr={key:0,class:"text-pink lh-base mt-3"},Br={class:"border"},hr={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},$r={class:"d-flex gap-2 align-items-center flex-grow-1"},Cr={class:"text-nowrap"},_r={class:"flex-grow-1"},Tr={class:"d-flex gap-2"},wr=["onClick"],Dr=["href"],Fr=["id"],Sr={class:"table align-middle gray-table side-table mb-0"},Ar={class:"mt-4"},Ur={class:"table align-middle gray-table side-table"},Mr={key:0,class:"block-bottom bg-light-teal"},Or={__name:"Other",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.computed(()=>z("culture",a.value.Status,4)),f=e.ref({}),a=e.ref({}),l=e.ref([]),r=e.computed(()=>l.value.filter(E=>!E.Deleted)),s=()=>l.value.push({}),c=T,n=()=>{rxjs.forkJoin([A.culture("getRelatedProject",{ID:h.id})]).subscribe(E=>{const o=E[0];a.value=o.Project,l.value=o.Projects,I().init("culture",a.value),N.value=a.value.changeApply,a.value.changeApply=void 0})},g=E=>E.Deleted=!0,B=E=>{var u,b;if(f.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:h.id,Projects:l.value,Before:(u=N.value)==null?void 0:u.Form4Before,After:(b=N.value)==null?void 0:b.Form4After,Submit:E?"true":"false"};A.culture("saveRelatedProject",o).subscribe(()=>{E?c("next"):n()})},C=()=>{let E={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return r.value.forEach((o,u)=>Object.assign(f.value,O(o,E,`project-${u}-`))),N.value&&(E={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(f.value,O(N.value,E))),!Object.keys(f.value).length};return e.onMounted(n),e.provide("editable",d),(E,o)=>{const u=e.resolveComponent("required-label"),b=e.resolveComponent("input-text"),i=e.resolveComponent("input-integer"),m=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yr,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("p",xr," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(V,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:V},[e.createElementVNode("div",Br,[e.createElementVNode("div",hr,[e.createElementVNode("div",$r,[e.createElementVNode("label",Cr,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[4]||(o[4]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",_r,[e.createVNode(b,{error:e.unref(f)[`project-${t}-Title`],modelValue:V.Title,"onUpdate:modelValue":p=>V.Title=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Tr,[e.unref(d)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(p=>g(V),["prevent"]),href:"#"},"刪除",8,wr)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,Dr)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",Sr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[5]||(o[5]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{class:"text-start w-auto",error:e.unref(f)[`project-${t}-Year`],modelValue:V.Year,"onUpdate:modelValue":p=>V.Year=p},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[6]||(o[6]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`project-${t}-OrgName`],modelValue:V.OrgName,"onUpdate:modelValue":p=>V.OrgName=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[7]||(o[7]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{class:"w-auto",error:e.unref(f)[`project-${t}-Amount`],modelValue:V.Amount,"onUpdate:modelValue":p=>V.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[8]||(o[8]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(f)[`project-${t}-Description`],rows:"4",modelValue:V.Description,"onUpdate:modelValue":p=>V.Description=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[9]||(o[9]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(f)[`project-${t}-Benefit`],rows:"4",modelValue:V.Benefit,"onUpdate:modelValue":p=>V.Benefit=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,Fr)])]))),128)),e.unref(d)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:s,type:"button"},[...o[10]||(o[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ar,[e.createElementVNode("table",Ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(f).Form4Before,rows:"4",modelValue:e.unref(N).Form4Before,"onUpdate:modelValue":o[0]||(o[0]=V=>e.unref(N).Form4Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(f).Form4After,rows:"4",modelValue:e.unref(N).Form4After,"onUpdate:modelValue":o[1]||(o[1]=V=>e.unref(N).Form4After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",Mr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=V=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=V=>B(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ir={class:"block"},jr={class:"text-teal fw-bold py-3"},Pr={class:"table-responsive"},qr={class:"table align-middle gray-table"},Lr={class:"text-end"},Rr={class:"text-end"},zr={class:"mt-4"},Gr={class:"table align-middle gray-table"},Jr={class:"text-center"},Qr={key:0,width:"180"},Wr={class:"text-center"},Yr=["href"],Hr={key:0,class:"text-center"},Kr={key:0},Zr={key:1,class:"text-pink"},Xr={key:1,class:"tag-group mt-2 gap-1"},vr={key:0,class:"tag tag-green-light"},ea=["download","href"],ta=["onClick"],la={class:"block-bottom bg-light-teal"},oa=!0,na={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(0),d=e.ref({}),f=e.ref([{Type:1,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:2,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_第一期請款_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.culture("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("culture",d.value),f.value=f.value.filter(n=>{var g;return!((g=n.Excludes)!=null&&g.includes(d.value.OrgCategory))}),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",oa),(c,n)=>{var E;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ir,[n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",jr,"核定經費: "+e.toDisplayString((E=e.unref(d).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("div",Pr,[e.createElementVNode("table",qr,[n[5]||(n[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Lr,e.toDisplayString(e.unref(N)),1),n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=o=>e.isRef(N)?N.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",Rr,e.toDisplayString(e.unref(a))+"%",1),n[4]||(n[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[13]||(n[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",zr,[e.createElementVNode("table",Gr,[e.createElementVNode("thead",Jr,[e.createElementVNode("tr",null,[n[6]||(n[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Qr,"狀態")),n[8]||(n[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(o,u)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Wr,e.toDisplayString(u+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Yr)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Hr,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Kr,"已上傳")):(e.openBlock(),e.createElementBlock("span",Zr,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Xr,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",vr,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(r)(b.Path)},e.toDisplayString(b.Name),9,ea),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>b.Deleted=!0,type:"button"},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ta))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",la,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=o=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=o=>s()),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},ra={class:"block"},aa={class:"text-teal fw-bold py-3"},da={class:"text-teal fw-bold pb-3"},sa={class:"table-responsive"},ma={class:"table align-middle gray-table"},ca={class:"text-end"},ia={class:"text-end"},pa={class:"mt-4"},Va={class:"table align-middle gray-table"},fa={class:"text-center"},Na={key:0,width:"180"},Ea={class:"text-center"},ba=["href"],ka={key:0,class:"text-center"},ga={key:0},ua={key:1,class:"text-pink"},ya={key:1,class:"tag-group mt-2 gap-1"},xa={key:0,class:"tag tag-green-light"},Ba=["download","href"],ha=["onClick"],$a={class:"block-bottom bg-light-teal"},Ca=!0,te=3e4,_a={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(3e4),d=e.ref({}),f=e.ref([{Type:1,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:2,Title:"經費分攤表",Template:"../../Template/CUL/經費分攤表.docx",Files:[]},{Type:3,Title:"補助清單",Template:"../../Template/CUL/補助清單.docx",Files:[],Excludes:["1"]},{Type:4,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_第二期請款_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.culture("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("culture",d.value),f.value=f.value.filter(n=>{var g;return!((g=n.Excludes)!=null&&g.includes(d.value.OrgCategory))}),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",Ca),(c,n)=>{var E;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ra,[n[10]||(n[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",aa,"核定經費: "+e.toDisplayString((E=e.unref(d).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("p",da,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(N)).toLocaleString())+"元",1),e.createElementVNode("div",sa,[e.createElementVNode("table",ma,[n[4]||(n[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",ca,e.toDisplayString(e.unref(N)-te),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(te)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=o=>e.isRef(N)?N.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",ia,e.toDisplayString(e.unref(a))+"%",1),n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[12]||(n[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",pa,[e.createElementVNode("table",Va,[e.createElementVNode("thead",fa,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",Na,"狀態")),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(o,u)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Ea,e.toDisplayString(u+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,ba)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",ka,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",ga,"已上傳")):(e.openBlock(),e.createElementBlock("span",ua,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",ya,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",xa,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(r)(b.Path)},e.toDisplayString(b.Name),9,Ba),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>b.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ha))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",$a,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=o=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=o=>s()),type:"button"},[...n[13]||(n[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Ta={class:"block rounded-top-4"},wa={class:"horizontal-scrollable"},Da={class:"timeline"},Fa={class:"year"},Sa={class:"month"},Aa=["onClick"],Ua={class:"square-title"},Ma={class:"table-responsive mt-4"},Oa={class:"table align-middle gray-table"},Ia={class:"text-end"},ja={class:"table-responsive"},Pa={class:"table align-middle gray-table"},qa={class:"text-end"},La={key:0,class:"invalid mt-0"},Ra={class:"mt-3"},za={class:"mt-3"},Ga=["rowspan"],Ja={key:0,class:"block-bottom bg-light-teal"},Qa={__name:"Progress",props:{id:{type:[Number,String]}},setup(x){const T=[{value:3,text:"完成"},{value:2,text:"部分完成"},{value:1,text:"未完成"}],h=x,N=e.ref(),d=e.ref({}),f=e.ref(0),a=e.ref({}),l=e.ref([]),r=e.ref({}),s=e.computed(()=>Math.round((f.value+l.value.filter(o=>o.Status===3).length)*100/c.value.length*10)/10),c=e.ref([]),n=e.ref([]),g=o=>{N.value=o,B()},B=()=>{A.culture("getMonthlyProgress",{ID:h.id,Year:N.value.year-1911,Month:N.value.month}).subscribe(o=>{const u=o.Logs,b=o.Items,i=o.Steps;let m=!1;f.value=0,r.value=o.Progress,c.value=o.Schedules,l.value=[],n.value.forEach(V=>{V.months.forEach(t=>{m||(t===N.value&&(m=!0),c.value.forEach(p=>{var k,U;if(p.Month===t.month)if(m||p.Status!==3){const w=u.find(S=>S.ScheduleID===p.ID)||{ScheduleID:p.ID,Status:p.Status};l.value.push(Object.assign(w,{Year:V.year,Month:p.Month,ItemTitle:(k=b.find(S=>S.ID===p.ItemID))==null?void 0:k.Title,Type:p.Type,StepTitle:(U=i.find(S=>S.ID===p.StepID))==null?void 0:U.Title}))}else f.value++}))})})})},C=o=>{if(d.value={},o&&!E()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const u={ID:r.value.ID,Description:r.value.Description||"",Status:o?1:0,Logs:l.value.map(b=>({ID:b.ID||0,ScheduleID:b.ScheduleID,Status:b.Status,DelayReason:b.DelayReason||"",ImprovedWay:b.ImprovedWay||""}))};A.culture("saveMonthlyProgress",u).subscribe(b=>{b&&(window.location.href="../inprogressList.aspx")})},E=()=>{let o={Description:"實際工作執行情形"};return d.value=O(r.value,o),l.value.forEach((u,b)=>{o={Status:{numericality:{greaterThan:0,message:"^請輸入本月是否完成"}}},[1,2].includes(u.Status)&&(o.DelayReason="落後原因",o.ImprovedWay="改善措施"),Object.assign(d.value,O(u,o,`item-${b}-`))}),!Object.keys(d.value).length};return e.onMounted(()=>{A.culture("getApplication",{ID:h.id}).subscribe(o=>{a.value=o.Project,I().init("culture",a.value);const u=new Date(a.value.StartTime),b=new Date(a.value.EndTime),i=Date.now();for(;;){const m=u.getFullYear(),V=u.getMonth(),t={year:m,month:V+1,disabled:new Date(m,V,20).getTime()>i};let p=n.value.find(k=>k.year===m);if(p?p.months.push(t):n.value.push({year:m,months:[t]}),m*100+V>=b.getFullYear()*100+b.getMonth())break;u.setMonth(V+1)}})}),(o,u)=>{const b=e.resolveComponent("input-textarea"),i=e.resolveComponent("input-radio-group");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ta,[e.createElementVNode("div",wa,[u[3]||(u[3]=e.createElementVNode("button",{class:"btn-control btn-prev",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-left"})],-1)),e.createElementVNode("ul",Da,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),m=>(e.openBlock(),e.createElementBlock("li",{key:m},[e.createElementVNode("span",Fa,e.toDisplayString(m.year-1911)+"年",1),e.createElementVNode("ul",Sa,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.months,V=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass({active:e.unref(N)===V,disabled:V.disabled}),key:V},[e.createElementVNode("a",{onClick:t=>g(V),href:"javascript:void(0)"},e.toDisplayString(V.month)+"月",9,Aa)],2))),128))])]))),128))]),u[4]||(u[4]=e.createElementVNode("button",{class:"btn-control btn-next",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-right"})],-1))]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h5",Ua,e.toDisplayString(e.unref(N).year-1911)+"年"+e.toDisplayString(e.unref(N).month)+"月 實際進度",1),e.createElementVNode("div",Ma,[e.createElementVNode("table",Oa,[u[5]||(u[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",{class:"text-center"},"實際工作執行情形（條列式說明）")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Ia,e.toDisplayString(e.unref(N).year-1911)+"年"+e.toDisplayString(e.unref(N).month)+"月",1),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(d).Description,rows:"4",modelValue:e.unref(r).Description,"onUpdate:modelValue":u[0]||(u[0]=m=>e.unref(r).Description=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ja,[e.createElementVNode("table",Pa,[u[8]||(u[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",null,"重要工作項目"),e.createElementVNode("th",null,"工作進度%"),e.createElementVNode("th",null,"檢核工作"),e.createElementVNode("th",null,"本月是否完成"),e.createElementVNode("th",null,"年度目標達成數")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("th",qa,e.toDisplayString(m.Year-1911)+"年"+e.toDisplayString(m.Month)+"月",1),e.createElementVNode("td",null,e.toDisplayString(m.ItemTitle),1),e.createElementVNode("td",null,e.toDisplayString(m.Type===1?"50%":"100%"),1),e.createElementVNode("td",null,e.toDisplayString(m.StepTitle),1),e.createElementVNode("td",null,[e.createVNode(i,{options:T,modelValue:m.Status,"onUpdate:modelValue":t=>m.Status=t},null,8,["modelValue","onUpdate:modelValue"]),e.unref(d)[`item-${V}-Status`]?(e.openBlock(),e.createElementBlock("div",La,e.toDisplayString(e.unref(d)[`item-${V}-Status`]),1)):e.createCommentVNode("",!0),[1,2].includes(m.Status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",Ra,[u[6]||(u[6]=e.createElementVNode("div",{class:"text-teal pb-2"},"落後原因",-1)),e.createVNode(b,{error:e.unref(d)[`item-${V}-DelayReason`],rows:"1",modelValue:m.DelayReason,"onUpdate:modelValue":t=>m.DelayReason=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",za,[u[7]||(u[7]=e.createElementVNode("div",{class:"text-teal pb-2"},"改善措施",-1)),e.createVNode(b,{error:e.unref(d)[`item-${V}-ImprovedWay`],rows:"1",modelValue:m.ImprovedWay,"onUpdate:modelValue":t=>m.ImprovedWay=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])],64)):e.createCommentVNode("",!0)]),V?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("td",{key:0,class:"text-end",rowspan:e.unref(l).length},e.toDisplayString(e.unref(s))+"% ",9,Ga))]))),128))])])])],64)):e.createCommentVNode("",!0)]),e.unref(N)?(e.openBlock(),e.createElementBlock("div",Ja,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:u[1]||(u[1]=m=>C()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:u[2]||(u[2]=m=>C(!0)),type:"button"},[...u[9]||(u[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])):e.createCommentVNode("",!0)],64)}}},Wa={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const d=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(d,{steps:T,type:"culture"})}}},Ya=(x,T)=>{const h=x.__vccOpts||x;for(const[N,d]of T)h[N]=d;return h},Ha={class:"block"},Ka={class:"mt-4"},Za={class:"table align-middle gray-table side-table"},Xa={key:0,class:"d-flex align-items-center gap-2"},va={class:"input-group w-auto"},ed={class:"text-teal-dark"},td={key:1,class:"invalid mt-0"},ld={class:"square-title mt-4"},od={class:"mt-4"},nd=["onClick"],rd={class:"d-flex flex-column gap-2"},ad={class:"mt-4 d-flex flex-column gap-2"},dd={class:"d-flex flex-column gap-3 mt-4"},sd={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},md={class:"d-flex gap-2 align-items-center flex-grow-1"},cd={class:"text-nowrap"},id={class:"flex-grow-1"},pd={class:"d-flex gap-2"},Vd=["onClick"],fd=["href"],Nd=["id"],Ed={class:"table align-middle gray-table side-table mb-0"},bd={class:"p-0"},kd={class:"item-list"},gd={class:"mt-2 align-self-start text-center"},ud={class:"input-group"},yd={key:0,class:"invalid mt-0"},xd={key:0,class:"d-flex gap-2 mt-1 align-self-start"},Bd=["onClick"],hd=["onClick"],$d={class:"row"},Cd={class:"col"},_d=["value"],Td={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},wd=["onClick"],Dd=["onClick"],Fd={class:"col"},Sd=["value"],Ad={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Ud=["onClick"],Md=["onClick"],Od=["onClick"],Id={class:"mt-4"},jd={class:"table align-middle gray-table side-table"},Pd={key:0,class:"block-bottom bg-light-teal"},qd=Ya({__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.computed(()=>z("culture",r.value.Status,2)),f=e.computed(()=>c.value.EndDate),a=e.ref({}),l=e.computed(()=>s.value.filter(p=>!p.Deleted)),r=e.ref({}),s=e.ref([]),c=e.ref({}),n=()=>{A.culture("createGoal",{ID:h.id}).subscribe(p=>{s.value.push(Object.assign(p,{Items:[]}));const k=s.value[s.value.length-1];g(k)})},g=p=>{A.culture("createGoalItem",{ID:h.id,GoalID:p.ID}).subscribe(k=>{p.Items.push(Object.assign(k,{Steps:[],Schedules:[]}));const U=p.Items[p.Items.length-1];C(U),C(U),C(U),B(U,1),B(U,2)})},B=(p,k)=>A.culture("createGoalSchedule",{ID:h.id,ItemID:p.ID,Type:k}).subscribe(U=>p.Schedules.push(U)),C=p=>A.culture("createGoalStep",{ID:h.id,ItemID:p.ID}).subscribe(k=>p.Steps.push(k)),E=T,o=()=>{rxjs.forkJoin([A.culture("getWorkSchedule",{ID:h.id})]).subscribe(p=>{const k=p[0];r.value=k.Project,s.value=k.Goals,c.value=k.GrantType,s.value.length||n(),I().init("culture",r.value),N.value=r.value.changeApply,r.value.changeApply=void 0})},u=p=>p.Deleted=!0,b=p=>p.Deleted=!0,i=p=>p.Deleted=!0,m=p=>p.Deleted=!0,V=p=>{var U,w;if(a.value={},p&&!t()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const k={Project:r.value,Goals:s.value,Before:(U=N.value)==null?void 0:U.Form2Before,After:(w=N.value)==null?void 0:w.Form2After,Submit:p?"true":"false"};A.culture("saveWorkSchedule",k).subscribe(()=>{p?E("next"):o()})},t=()=>{let p={StartTime:"計畫期程",EndTime:"計畫期程"};a.value=O(r.value,p);const k={Title:"計畫目標",Content:"預期效益"},U={Title:"重要工作項目",Indicator:"績效指標"},w={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},S={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return s.value.filter(M=>!M.Deleted).forEach((M,F)=>{Object.assign(a.value,O(M,k,`goal-${F}-`)),M.Items.filter(y=>!y.Deleted).forEach((y,_)=>{Object.assign(a.value,O(y,U,`item-${F}-${_}-`)),y.Steps.filter(D=>!D.Deleted).forEach((D,j)=>Object.assign(a.value,O(D,w,`step-${F}-${_}-${j}-`))),y.Schedules.filter(D=>D.Type===1&&!D.Deleted).forEach((D,j)=>Object.assign(a.value,O(D,S,`schedule-${F}-${_}-1-${j}-`))),y.Schedules.filter(D=>D.Type===2&&!D.Deleted).forEach((D,j)=>Object.assign(a.value,O(D,S,`schedule-${F}-${_}-2-${j}-`)))})}),N.value&&(p={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(a.value,O(N.value,p))),!Object.keys(a.value).length};return e.onMounted(o),e.provide("editable",d),(p,k)=>{const U=e.resolveComponent("required-label"),w=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),M=e.resolveComponent("input-text"),F=e.resolveComponent("input-textarea"),y=e.resolveComponent("input-month"),_=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ha,[k[30]||(k[30]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Ka,[e.createElementVNode("table",Za,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[6]||(k[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",Xa,[e.createElementVNode("div",va,[e.createVNode(w,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":k[0]||(k[0]=D=>e.unref(r).StartTime=D)},null,8,["max-date","modelValue"]),k[7]||(k[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":k[1]||(k[1]=D=>e.unref(r).EndTime=D)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",ed,[k[8]||(k[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(f)},null,8,["value"]),k[9]||(k[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(a).StartTime||e.unref(a).EndTime?(e.openBlock(),e.createElementBlock("div",td,e.toDisplayString(e.unref(a).StartTime||e.unref(a).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",ld,[k[11]||(k[11]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:n,type:"button"},[...k[10]||(k[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",od,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(D,j)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:D},[e.unref(d)&&e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:P=>u(D),type:"button"},"刪除",8,nd)):e.createCommentVNode("",!0),e.createElementVNode("div",rd,[k[12]||(k[12]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(a)[`goal-${j}-Title`],modelValue:D.Title,"onUpdate:modelValue":P=>D.Title=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",ad,[k[13]||(k[13]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(F,{error:e.unref(a)[`goal-${j}-Content`],rows:"4",modelValue:D.Content,"onUpdate:modelValue":P=>D.Content=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",dd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Items.filter(P=>!P.Deleted),(P,G)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:P},[e.createElementVNode("div",sd,[e.createElementVNode("div",md,[e.createElementVNode("label",cd,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[14]||(k[14]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",id,[e.createVNode(M,{error:e.unref(a)[`item-${j}-${G}-Title`],modelValue:P.Title,"onUpdate:modelValue":q=>P.Title=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",pd,[e.unref(d)&&D.Items.filter(q=>!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(q=>b(P),["prevent"]),href:"#"},"刪除",8,Vd)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${G}`,role:"button"},"收合",8,fd)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${G}`},[e.createElementVNode("table",Ed,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[15]||(k[15]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",bd,[e.createElementVNode("ul",kd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Steps.filter(q=>!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(d)}]),key:q},[e.createElementVNode("div",gd,e.toDisplayString(String.fromCharCode(65+J)),1),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(a)[`step-${j}-${G}-${J}-Title`],placeholder:"如:進行口訪紀錄",modelValue:q.Title,"onUpdate:modelValue":L=>q.Title=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",ud,[e.createVNode(y,{"empty-value":0,modelValue:q.Begin,"onUpdate:modelValue":L=>q.Begin=L},null,8,["modelValue","onUpdate:modelValue"]),k[16]||(k[16]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(y,{"empty-value":0,modelValue:q.End,"onUpdate:modelValue":L=>q.End=L},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(a)[`step-${j}-${G}-${J}-Begin`]||e.unref(a)[`step-${j}-${G}-${J}-End`]?(e.openBlock(),e.createElementBlock("div",yd,e.toDisplayString(e.unref(a)[`step-${j}-${G}-${J}-Begin`]||e.unref(a)[`step-${j}-${G}-${J}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",xd,[P.Steps.filter(L=>!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:L=>m(q),type:"button"},[...k[17]||(k[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:L=>C(P),type:"button"},[...k[18]||(k[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,hd)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[19]||(k[19]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(a)[`item-${j}-${G}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:P.Indicator,"onUpdate:modelValue":q=>P.Indicator=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[20]||(k[20]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",$d,[e.createElementVNode("div",Cd,[k[23]||(k[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Schedules.filter(q=>q.Type===1&&!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:q},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(d)?3:4}`])},[e.createVNode(y,{error:e.unref(a)[`schedule-${j}-${G}-1-${J}-Month`],"empty-value":0,modelValue:q.Month,"onUpdate:modelValue":L=>q.Month=L},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(d)?7:8}`])},[e.createVNode(_,{"empty-value":0,error:e.unref(a)[`schedule-${j}-${G}-1-${J}-StepID`],options:P.Steps.filter(L=>!L.Deleted),modelValue:q.StepID,"onUpdate:modelValue":L=>q.StepID=L},{default:e.withCtx(({index:L,option:H})=>[e.createElementVNode("option",{value:H.ID},e.toDisplayString(String.fromCharCode(65+L))+"."+e.toDisplayString(H.Title),9,_d)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(d)?(e.openBlock(),e.createElementBlock("div",Td,[P.Schedules.filter(L=>L.Type===1&&!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:L=>i(q),type:"button"},[...k[21]||(k[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,wd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:L=>B(P,1),type:"button"},[...k[22]||(k[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Dd)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Fd,[k[26]||(k[26]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(P.Schedules.filter(q=>q.Type===2&&!q.Deleted),(q,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:q},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(d)?3:4}`])},[e.createVNode(y,{error:e.unref(a)[`schedule-${j}-${G}-2-${J}-Month`],"empty-value":0,modelValue:q.Month,"onUpdate:modelValue":L=>q.Month=L},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(d)?7:8}`])},[e.createVNode(_,{"empty-value":0,error:e.unref(a)[`schedule-${j}-${G}-2-${J}-StepID`],options:P.Steps.filter(L=>!L.Deleted),modelValue:q.StepID,"onUpdate:modelValue":L=>q.StepID=L},{default:e.withCtx(({index:L,option:H})=>[e.createElementVNode("option",{value:H.ID},e.toDisplayString(String.fromCharCode(65+L))+"."+e.toDisplayString(H.Title),9,Sd)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(d)?(e.openBlock(),e.createElementBlock("div",Ad,[P.Schedules.filter(L=>L.Type===2&&!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:L=>i(q),type:"button"},[...k[24]||(k[24]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ud)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:L=>B(P,2),type:"button"},[...k[25]||(k[25]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Md)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Nd)]))),128))]),e.unref(d)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:P=>g(D),type:"button"},"新增工作項目",8,Od)):e.createCommentVNode("",!0)]))),128))]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[k[29]||(k[29]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Id,[e.createElementVNode("table",jd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[27]||(k[27]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(a).Form2Before,rows:"4",modelValue:e.unref(N).Form2Before,"onUpdate:modelValue":k[2]||(k[2]=D=>e.unref(N).Form2Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(U,null,{default:e.withCtx(()=>[...k[28]||(k[28]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{error:e.unref(a).Form2After,rows:"4",modelValue:e.unref(N).Form2After,"onUpdate:modelValue":k[3]||(k[3]=D=>e.unref(N).Form2After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",Pd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[4]||(k[4]=D=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[5]||(k[5]=D=>V(!0)),type:"button"},[...k[31]||(k[31]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-84d8fceb"]]),Ld={class:"block"},Rd={class:"mt-4"},zd={class:"table align-middle gray-table side-table"},Gd={key:0},Jd={key:1,class:"text-light-gray"},Qd={class:"d-flex flex-column gap-2"},Wd={key:0},Yd={class:"mt-4"},Hd={class:"table align-middle gray-table side-table"},Kd={class:"row g-3"},Zd={class:"col-12 col-xl-2"},Xd={class:"text-gray mb-2"},vd={class:"col-12 col-xl-3"},es={class:"text-gray mb-2"},ts={key:0,class:"col-12 col-xl-4"},ls={class:"row g-1"},os={class:"col-7"},ns={class:"col-5"},rs={key:1,class:"col-12 col-xl-3"},as={class:"text-gray mb-2"},ds={class:"mt-4"},ss={class:"table align-middle gray-table side-table"},ms={class:"d-flex align-items-center gap-2"},cs={class:"input-group w-auto"},is={key:0,class:"invalid mt-0"},ps={class:"mt-4"},Vs={class:"table-responsive mt-3 mb-0"},fs={class:"table align-middle gray-table"},Ns={class:"text-end"},Es={class:"text-end"},bs={class:"text-end"},ks={class:"text-end"},gs={class:"text-end"},us={class:"table align-middle gray-table side-table"},ys={key:0,class:"table-responsive mt-3 mb-0"},xs={class:"table align-middle gray-table"},Bs={key:0},hs={key:0},$s={class:"d-flex gap-2"},Cs=["onClick"],_s={class:"mt-4"},Ts={class:"table align-middle gray-table side-table"},ws={key:0,class:"block-bottom bg-light-teal"},Ds={class:"text-center"},Fs={class:"mb-5"},Ss={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.ref(),a=e.computed(()=>z("education",s.value.Status,1)),l=e.ref({}),r=e.computed(()=>n.value.filter(V=>!V.Deleted)),s=e.ref({}),c=e.ref(),n=e.ref([]),g=e.ref(),B=e.ref(0),C=e.computed({get:()=>!!r.value.length,set:V=>{V?E():n.value.forEach(t=>t.Deleted=!0)}}),E=()=>n.value.push({}),o=T,u=()=>{A.education("getApplication",{ID:h.id}).subscribe(V=>{s.value=V.Project,f.value=V.Contacts,n.value=V.ReceivedSubsidies,s.value.OrgCategory=s.value.OrgCategory||null,I().init("education",s.value),d.value=s.value.changeApply,s.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=(V,t)=>{var k,U;if(l.value={},V&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&g.value&&s.value.ApplyAmount>g.value.GrantLimit*1e4){c.value.show(()=>i(V,!0));return}const p={Project:s.value,Contacts:f.value,ReceivedSubsidies:n.value.filter(w=>w.ID||!w.Deleted),Before:(k=d.value)==null?void 0:k.Form1Before,After:(U=d.value)==null?void 0:U.Form1After,Submit:V?"true":"false"};A.education("saveApplication",p).subscribe(w=>{V?o("next",w.ID):s.value.ID?u():window.location.href=`Application.aspx?ID=${w.ID}`})},m=()=>{let V={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return s.value.OrgCategory==="2"&&(V.RegisteredNum="立案登記證字號"),l.value=O(s.value,V),V={Name:"姓名",JobTitle:"職稱"},Object.assign(l.value,O(f.value[0],V,"contact-0-")),V.MobilePhone="手機號碼",Object.assign(l.value,O(f.value[1],V,"contact-1-")),V={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},n.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`received-${p}-`))),d.value&&(V={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(d.value,V))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(V=>{N.value=V[0],h.id?u():A.education("getEmptyApplication").subscribe(t=>{s.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),f.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("education",s.value)})})}),e.provide("editable",a),e.watch(()=>s.value.OrgCategory,()=>{A.education("getGrantTargetSetting",{TargetTypeID:`EDC${s.value.OrgCategory}`}).subscribe(V=>{g.value=V})}),e.watchEffect(()=>{B.value=R(s.value.ApplyAmount)+R(s.value.SelfAmount)+R(s.value.OtherGovAmount)+R(s.value.OtherUnitAmount)}),(V,t)=>{const p=e.resolveComponent("required-label"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-select"),w=e.resolveComponent("input-tw-date"),S=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-integer"),F=e.resolveComponent("input-boolean"),y=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ld,[t[52]||(t[52]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Rd,[e.createElementVNode("table",zd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(s).Year),1)]),e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(s).ProjectID?(e.openBlock(),e.createElementBlock("span",Gd,e.toDisplayString(e.unref(s).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Jd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[22]||(t[22]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(s).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).ProjectName,modelValue:e.unref(s).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=_=>e.unref(s).ProjectName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Qd,[e.createElementVNode("div",null,[e.createVNode(U,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(s).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=_=>e.unref(s).OrgCategory=_)},null,8,["error","options","modelValue"])]),e.unref(s).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Wd,[e.createVNode(k,{error:e.unref(l).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(s).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=_=>e.unref(s).RegisteredNum=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(s).OrgName,"onUpdate:modelValue":t[3]||(t[3]=_=>e.unref(s).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(s).TaxID,"onUpdate:modelValue":t[4]||(t[4]=_=>e.unref(s).TaxID=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(s).Address,"onUpdate:modelValue":t[5]||(t[5]=_=>e.unref(s).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[53]||(t[53]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Yd,[e.createElementVNode("table",Hd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(_,D)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Kd,[e.createElementVNode("div",Zd,[e.createElementVNode("div",Xd,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[28]||(t[28]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(k,{error:e.unref(l)[`contact-${D}-Name`],modelValue:_.Name,"onUpdate:modelValue":j=>_.Name=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",vd,[e.createElementVNode("div",es,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(k,{error:e.unref(l)[`contact-${D}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":j=>_.JobTitle=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),D?(e.openBlock(),e.createElementBlock("div",ts,[t[30]||(t[30]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",ls,[e.createElementVNode("div",os,[e.createVNode(k,{modelValue:_.Phone,"onUpdate:modelValue":j=>_.Phone=j,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ns,[e.createVNode(k,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":j=>_.PhoneExt=j,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),D?(e.openBlock(),e.createElementBlock("div",rs,[e.createElementVNode("div",as,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(k,{error:e.unref(l)[`contact-${D}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":j=>_.MobilePhone=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[54]||(t[54]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",ds,[e.createElementVNode("table",ss,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[32]||(t[32]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",ms,[e.createElementVNode("div",cs,[e.createVNode(w,{class:"w-auto",modelValue:e.unref(s).StartTime,"onUpdate:modelValue":t[6]||(t[6]=_=>e.unref(s).StartTime=_)},null,8,["modelValue"]),t[33]||(t[33]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto",modelValue:e.unref(s).EndTime,"onUpdate:modelValue":t[7]||(t[7]=_=>e.unref(s).EndTime=_)},null,8,["modelValue"])]),t[34]||(t[34]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",is,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Target,modelValue:e.unref(s).Target,"onUpdate:modelValue":t[8]||(t[8]=_=>e.unref(s).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(s).Summary,"onUpdate:modelValue":t[9]||(t[9]=_=>e.unref(s).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(s).Quantified,"onUpdate:modelValue":t[10]||(t[10]=_=>e.unref(s).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[55]||(t[55]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",ps,[t[43]||(t[43]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",Vs,[e.createElementVNode("table",fs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Ns,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Es,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",bs,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[40]||(t[40]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",ks,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[41]||(t[41]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[42]||(t[42]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).ApplyAmount,modelValue:e.unref(s).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=_=>e.unref(s).ApplyAmount=_)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).SelfAmount,modelValue:e.unref(s).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=_=>e.unref(s).SelfAmount=_)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).OtherGovAmount,modelValue:e.unref(s).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=_=>e.unref(s).OtherGovAmount=_)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).OtherUnitAmount,modelValue:e.unref(s).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=_=>e.unref(s).OtherUnitAmount=_)},null,8,["error","modelValue"])]),e.createElementVNode("td",gs,e.toDisplayString(e.unref(B).toLocaleString()),1)])])])])]),e.createElementVNode("table",us,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[44]||(t[44]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(F,{modelValue:e.unref(C),"onUpdate:modelValue":t[15]||(t[15]=_=>e.isRef(C)?C.value=_:null)},null,8,["modelValue"]),e.unref(C)?(e.openBlock(),e.createElementBlock("div",ys,[e.createElementVNode("table",xs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[45]||(t[45]=e.createElementVNode("th",null,"計畫名稱",-1)),t[46]||(t[46]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Bs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(_,D)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`received-${D}-Name`],modelValue:_.Name,"onUpdate:modelValue":j=>_.Name=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`received-${D}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":j=>_.Amount=j},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",hs,[e.createElementVNode("div",$s,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:j=>b(_),type:"button"},[...t[47]||(t[47]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Cs)):e.createCommentVNode("",!0),D+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[48]||(t[48]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[51]||(t[51]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_s,[e.createElementVNode("table",Ts,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[49]||(t[49]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(d).Form1Before,"onUpdate:modelValue":t[16]||(t[16]=_=>e.unref(d).Form1Before=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[50]||(t[50]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(d).Form1After,"onUpdate:modelValue":t[17]||(t[17]=_=>e.unref(d).Form1After=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",ws,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[18]||(t[18]=_=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[19]||(t[19]=_=>i(!0)),type:"button"},[...t[56]||(t[56]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(y,{ref_key:"modal",ref:c},{default:e.withCtx(()=>{var _;return[e.createElementVNode("div",Ds,[t[57]||(t[57]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Fs,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((_=e.unref(g))==null?void 0:_.GrantLimit)+"萬",1),t[58]||(t[58]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[59]||(t[59]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},As={class:"block"},Us={key:0,class:"text-pink lh-base mt-4"},Ms={class:"mt-4"},Os={class:"table align-middle gray-table"},Is={class:"text-center"},js={key:0,width:"180"},Ps={class:"text-center"},qs={key:0},Ls=["innerHTML"],Rs=["href"],zs={key:0,class:"text-center"},Gs={key:0},Js={key:1,class:"text-pink"},Qs={key:1,class:"tag-group mt-2 gap-1"},Ws={key:0,class:"tag tag-green-light"},Ys=["download","href"],Hs=["onClick"],Ks={class:"mt-4"},Zs={class:"table align-middle gray-table side-table"},Xs={key:0,class:"block-bottom bg-light-teal"},vs=["disabled"],em={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/EDC/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/EDC/2-申請計畫書.docx",Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/EDC/3-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]}]),d=e.ref(),f=e.computed(()=>N.value.some(E=>!E.Optional&&!E.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("education",r.value.Status,2)),l=e.ref({}),r=e.ref({}),s=(E,o)=>{o.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:o.Path,Name:r.value.ProjectID+"_"+(E.Multiple?o.Name:`${E.Title}.pdf`)})},c=A.download,n=T,g=()=>{rxjs.forkJoin([A.education("getAttachment",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=N.value.filter(u=>{var b;return!((b=u.Excludes)!=null&&b.includes(r.value.OrgCategory))}),N.value.forEach(u=>{u.Files=o.Attachments.filter(b=>b.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(b=>!b.Deleted).length)}),I().init("education",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},B=E=>{var u,b;if(l.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:h.id,Attachments:N.value.reduce((i,m)=>i.concat(m.Files),[]),Before:(u=d.value)==null?void 0:u.Form5Before,After:(b=d.value)==null?void 0:b.Form5After,Submit:E?"true":"false"};A.education("saveAttachment",o).subscribe(()=>{E?n("next"):g()})},C=()=>{if(d.value){const E={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(d.value,E))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(E,o)=>{const u=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",As,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",Us,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Ms,[e.createElementVNode("table",Os,[e.createElementVNode("thead",Is,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",js,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",Ps,e.toDisplayString(V+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",qs,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,Ls)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Rs)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",zs,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",Gs,"已上傳")):(e.openBlock(),e.createElementBlock("span",Js,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>s(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Qs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ws,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,Ys),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Hs)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ks,[e.createElementVNode("table",Zs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(d).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(d).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(d).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Xs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>B(!0)),disabled:e.unref(f),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,vs)])):e.createCommentVNode("",!0)],64)}}},tm={class:"block"},lm={class:"text-teal fw-bold py-3"},om={class:"text-teal fw-bold pb-3"},nm={class:"table-responsive"},rm={class:"table align-middle gray-table"},am={class:"text-end"},dm={class:"text-end"},sm={class:"mt-4"},mm={class:"table align-middle gray-table"},cm={class:"text-center"},im={key:0,width:"180"},pm={class:"text-center"},Vm=["href"],fm={key:0,class:"text-center"},Nm={key:0},Em={key:1,class:"text-pink"},bm={key:1,class:"tag-group mt-2 gap-1"},km={key:0,class:"tag tag-green-light"},gm=["download","href"],um=["onClick"],ym={class:"block-bottom bg-light-teal"},xm=!0,Bm=3e4,hm={__name:"Payment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(3e4),d=e.ref({}),f=e.ref([{Type:1,Title:"收支明細表",Template:"../../Template/EDC/1-收支明細表.docx",Files:[]},{Type:2,Title:"受補助清單",Template:"../../Template/EDC/2-受補助清單.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/EDC/3-經費分攤表.docx",Files:[]},{Type:4,Title:"憑證",Template:"../../Template/EDC/4-憑證.docx",Files:[]},{Type:5,Title:"領據",Template:"../../Template/EDC/5-領據.docx",Files:[]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.education("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("education",d.value),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",xm),(c,n)=>{var E;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",tm,[n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於活動結束後一個月內提交成果報告及請款）",-1)),e.createElementVNode("p",lm,"核定經費: "+e.toDisplayString((E=e.unref(d).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("p",om,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(N)).toLocaleString())+"元",1),e.createElementVNode("div",nm,[e.createElementVNode("table",rm,[n[5]||(n[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",am,e.toDisplayString(e.unref(N)-Bm),1),n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=o=>e.isRef(N)?N.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",dm,e.toDisplayString(e.unref(a))+"%",1),n[4]||(n[4]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[13]||(n[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",sm,[e.createElementVNode("table",mm,[e.createElementVNode("thead",cm,[e.createElementVNode("tr",null,[n[6]||(n[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",im,"狀態")),n[8]||(n[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(o,u)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",pm,e.toDisplayString(u+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Vm)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",fm,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Nm,"已上傳")):(e.openBlock(),e.createElementBlock("span",Em,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",bm,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",km,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(r)(b.Path)},e.toDisplayString(b.Name),9,gm),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>b.Deleted=!0,type:"button"},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,um))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",ym,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=o=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=o=>s()),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},$m={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const d=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(d,{steps:T,type:"education"})}}},Cm={class:"modal-dialog modal-dialog-centered modal-md"},_m={class:"modal-content"},Tm={class:"modal-body"},wm={class:"d-flex flex-column align-items-center mb-5 gap-3"},Dm={class:"fs-18"},Fm={__name:"ErrorModal",setup(x){const T=K(),h=e.ref();return e.onMounted(()=>h.value.addEventListener("hidden.bs.modal",()=>T.error=null)),e.watch(()=>T.error,()=>{T.error&&bootstrap.Modal.getOrCreateInstance(h.value).show()}),(N,d)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:h,tabindex:"-1"},[e.createElementVNode("div",Cm,[e.createElementVNode("div",_m,[d[2]||(d[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Tm,[e.createElementVNode("div",wm,[d[0]||(d[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",Dm,e.toDisplayString(e.unref(T).error),1)]),d[1]||(d[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},Sm={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(x){const T=e.useModel(x,"modelValue"),h=[{value:!0,text:"是"},{value:!1,text:"否"}];return(N,d)=>{const f=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(f,{options:h,modelValue:T.value,"onUpdate:modelValue":d[0]||(d[0]=a=>T.value=a)},null,8,["modelValue"])}}},Am=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(x,{emit:T}){const h=e.ref(),N=()=>{Array.from(h.value.files).forEach(f=>A.upload(f).subscribe(a=>d("file",a))),h.value.value=""},d=T;return(f,a)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:a[0]||(a[0]=l=>e.unref(h).click()),type:"button"},[...a[1]||(a[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:N,class:"d-none",ref_key:"input",ref:h,type:"file"},f.$attrs),null,16)],64))}}),Um=["disabled","placeholder","type"],Mm={key:0,class:"invalid mt-0"},Om=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue");return e.watch(h,N=>{if(N){const d=(parseInt(N)||0).toString();N.toString()!==d&&(h.value=d)}}),(N,d)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(T),placeholder:e.unref(T)?x.placeholder:"",style:{"text-align":"right"},type:x.type},N.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=f=>h.value=f)}),null,16,Um),[[e.vModelDynamic,h.value]]),x.error?(e.openBlock(),e.createElementBlock("div",Mm,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64))}}),Im={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(x){const T=e.useModel(x,"modelValue"),h=[];for(let N=1;N<=12;N++)h.push({value:N,text:`${N}月`});return(N,d)=>{const f=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(f,{options:h,modelValue:T.value,"onUpdate:modelValue":d[0]||(d[0]=a=>T.value=a)},null,8,["modelValue"])}}},jm=["onChange","checked","disabled","id","value"],Pm=["for"],qm={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>ne(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue"),N=d=>{h.value=d};return(d,f)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.options,a=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:a},[e.createElementVNode("input",{onChange:l=>N(a[x.valueName]),checked:a[x.valueName]===h.value,class:"form-check-input",disabled:!e.unref(T),id:`${x.id}-${a[x.valueName]}`,type:"radio",value:a[x.valueName]},null,40,jm),e.createElementVNode("label",{class:"form-check-label",for:`${x.id}-${a[x.valueName]}`},e.toDisplayString(a[x.textName]),9,Pm)]))),128))}},Lm=["disabled"],Rm=["value"],zm=["value"],Gm={key:0,class:"invalid mt-0"},Jm=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue");return(N,d)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:x.disabled||!e.unref(T)},N.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=f=>h.value=f)}),[e.unref(T)&&!h.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:x.emptyValue},e.toDisplayString(x.placeholder),9,Rm)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.options,(f,a)=>e.renderSlot(N.$slots,"default",{key:f,index:a,option:f},()=>[e.createElementVNode("option",{value:f[x.valueName]},e.toDisplayString(f[x.textName]),9,zm)])),128))],16,Lm),[[e.vModelSelect,h.value]]),x.error?(e.openBlock(),e.createElementBlock("div",Gm,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64))}}),Qm={class:"input-group"},Wm={key:0,class:"input-group-text"},Ym=["disabled","placeholder","type"],Hm={key:0,class:"invalid mt-0"},Km=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue"),N=x;return N.maxLength&&e.watch(h,()=>{var d;((d=h.value)==null?void 0:d.length)>N.maxLength&&(h.value=h.value.substring(0,N.maxLength))}),(d,f)=>{const a=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Qm,[x.prefix?(e.openBlock(),e.createElementBlock("span",Wm,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(x.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(T),placeholder:e.unref(T)?x.placeholder:"",type:x.type},d.$attrs,{"onUpdate:modelValue":f[0]||(f[0]=l=>h.value=l)}),null,16,Ym),[[e.vModelDynamic,h.value]])]),x.error?(e.openBlock(),e.createElementBlock("div",Hm,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64)}}}),Zm=["disabled","placeholder"],Xm={key:0,class:"fs-14 text-gray mt-2"},vm={class:"text-pink"},ec={key:1,class:"invalid mt-0"},tc=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(x){const T=e.inject("editable",!0),h=e.useModel(x,"modelValue"),N=x;return N.maxLength&&e.watch(h,()=>{var d;((d=h.value)==null?void 0:d.length)>N.maxLength&&(h.value=h.value.substring(0,N.maxLength))}),(d,f)=>{var a;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(T),placeholder:e.unref(T)?x.placeholder:""},d.$attrs,{"onUpdate:modelValue":f[0]||(f[0]=l=>h.value=l)}),null,16,Zm),[[e.vModelText,h.value]]),e.unref(T)&&x.maxLength?(e.openBlock(),e.createElementBlock("div",Xm,[f[1]||(f[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",vm,e.toDisplayString(((a=h.value)==null?void 0:a.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(x.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),x.error?(e.openBlock(),e.createElementBlock("div",ec,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64)}}}),lc=["disabled"],oc={key:0,class:"invalid"},nc=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(x,{emit:T}){let h;const N=x,d=e.ref(),f=e.inject("editable",!0),a=e.ref(),l=T,r=s=>{!s&&N.modelValue&&(s=moment(new Date(N.modelValue))),s?(d.value=s.format(N.displayFormat),l("update:modelValue",s.format(N.format))):(d.value="",l("update:modelValue","")),h.setStartDate(d.value||void 0)};return e.onMounted(()=>{const s=$(a.value);s.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:N.drops,locale:{format:N.displayFormat},maxDate:N.maxDate?new Date(N.maxDate):N.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(c,n)=>r(n.startDate)),h=s.data("daterangepicker"),r()}),e.onUnmounted(()=>h.remove()),e.watch(()=>N.modelValue,()=>r()),(s,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(f),ref_key:"element",ref:a,type:"text"},s.$attrs,{"onUpdate:modelValue":c[0]||(c[0]=n=>e.isRef(d)?d.value=n:null)}),null,16,lc),[[e.vModelText,e.unref(d)]]),x.error?(e.openBlock(),e.createElementBlock("div",oc,e.toDisplayString(x.error),1)):e.createCommentVNode("",!0)],64))}}),rc={class:"block"},ac={class:"mt-4"},dc={class:"table align-middle gray-table side-table"},sc={key:0},mc={key:1,class:"text-light-gray"},cc={class:"mt-4"},ic={class:"table align-middle gray-table side-table"},pc={class:"row g-3"},Vc={class:"col-12 col-xl-2"},fc={class:"text-gray mb-2"},Nc={class:"col-12 col-xl-3"},Ec={class:"text-gray mb-2"},bc={class:"col-12 col-xl-4"},kc={class:"row g-1"},gc={class:"col-7"},uc={class:"col-5"},yc={class:"col-12 col-xl-3"},xc={class:"text-gray mb-2"},Bc={class:"col-12"},hc={class:"text-gray mb-2"},$c={class:"mt-4"},Cc={class:"table align-middle gray-table side-table"},_c={class:"mt-4"},Tc={class:"table align-middle gray-table side-table"},wc={key:0,class:"table-responsive mt-3 mb-0"},Dc={class:"table align-middle gray-table"},Fc={key:0},Sc={key:0},Ac={class:"d-flex gap-2"},Uc=["onClick"],Mc={class:"mt-4"},Oc={class:"table align-middle gray-table side-table"},Ic={key:0,class:"block-bottom bg-light-teal"},jc={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.ref(),f=e.computed(()=>z("literacy",s.value.Status,1)),a=e.ref({}),l=e.ref([]),r=e.computed(()=>c.value.filter(b=>!b.Deleted)),s=e.ref({}),c=e.ref([]),n=e.computed({get:()=>!!r.value.length,set:b=>{b?g():c.value.forEach(i=>i.Deleted=!0)}}),g=()=>c.value.push({}),B=T,C=()=>{A.literacy("getApplication",{ID:h.id}).subscribe(b=>{s.value=b.Project,N.value=b.Contacts,c.value=b.PreviousStudies,I().init("literacy",s.value),d.value=s.value.changeApply,s.value.changeApply=void 0})},E=b=>b.Deleted=!0,o=b=>{var m,V;if(a.value={},b&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:s.value,Contacts:N.value,PreviousStudies:c.value.filter(t=>t.ID||!t.Deleted),Before:(m=d.value)==null?void 0:m.Form1Before,After:(V=d.value)==null?void 0:V.Form1After,Submit:b?"true":"false"};A.literacy("saveApplication",i).subscribe(t=>{b?B("next",t.ID):s.value.ID?C():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let b={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value=O(s.value,b),b={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},N.value.forEach((i,m)=>Object.assign(a.value,O(i,b,`contact-${m}-`))),b={Title:"研習/課程名稱",TheDate:"辦理日期"},c.value.forEach((i,m)=>Object.assign(a.value,O(i,b,`study-${m}-`))),d.value&&(b={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(a.value,O(d.value,b))),!Object.keys(a.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(b=>{l.value=b[0],h.id?C():A.literacy("getEmptyApplication").subscribe(i=>{s.value=Object.assign({Field:null,FormStep:1,Status:1},i),N.value=[{Role:"申請人"}],I().init("literacy",s.value)})})}),e.provide("editable",f),e.watch(()=>[s.value.Field,s.value.OrgName],()=>{var b;if(f.value){const i=[];s.value.Field&&i.push((b=l.value.find(m=>m.Code===s.value.Field))==null?void 0:b.Descname),s.value.OrgName&&i.push(s.value.OrgName),s.value.ProjectName=i.join("-")}}),(b,i)=>{const m=e.resolveComponent("required-label"),V=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),p=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-boolean"),U=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",rc,[i[40]||(i[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ac,[e.createElementVNode("table",dc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[14]||(i[14]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(s).Year),1)]),e.createElementVNode("tr",null,[i[15]||(i[15]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(s).ProjectID?(e.openBlock(),e.createElementBlock("span",sc,e.toDisplayString(e.unref(s).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",mc,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[i[16]||(i[16]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(s).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[17]||(i[17]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{disabled:"",modelValue:e.unref(s).ProjectName,"onUpdate:modelValue":i[0]||(i[0]=w=>e.unref(s).ProjectName=w),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[18]||(i[18]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(a).Field,options:e.unref(l),"text-name":"Descname","value-name":"Code",modelValue:e.unref(s).Field,"onUpdate:modelValue":i[1]||(i[1]=w=>e.unref(s).Field=w)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[19]||(i[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(a).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(s).OrgName,"onUpdate:modelValue":i[2]||(i[2]=w=>e.unref(s).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[20]||(i[20]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(a).OrgLeader,modelValue:e.unref(s).OrgLeader,"onUpdate:modelValue":i[3]||(i[3]=w=>e.unref(s).OrgLeader=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[21]||(i[21]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(a).Address,placeholder:"請輸入地址",modelValue:e.unref(s).Address,"onUpdate:modelValue":i[4]||(i[4]=w=>e.unref(s).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),i[41]||(i[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",cc,[e.createElementVNode("table",ic,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",pc,[e.createElementVNode("div",Vc,[e.createElementVNode("div",fc,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[22]||(i[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(a)[`contact-${S}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Nc,[e.createElementVNode("div",Ec,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[23]||(i[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(a)[`contact-${S}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",bc,[i[24]||(i[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",kc,[e.createElementVNode("div",gc,[e.createVNode(V,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",uc,[e.createVNode(V,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",yc,[e.createElementVNode("div",xc,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[25]||(i[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(a)[`contact-${S}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Bc,[e.createElementVNode("div",hc,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[26]||(i[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(V,{error:e.unref(a)[`contact-${S}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),i[42]||(i[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",$c,[e.createElementVNode("table",Cc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[27]||(i[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[i[28]||(i[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(p,{error:e.unref(a).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(s).Target,"onUpdate:modelValue":i[5]||(i[5]=w=>e.unref(s).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[29]||(i[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(a).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(s).Summary,"onUpdate:modelValue":i[6]||(i[6]=w=>e.unref(s).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[30]||(i[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(a).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(s).Quantified,"onUpdate:modelValue":i[7]||(i[7]=w=>e.unref(s).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[31]||(i[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(a).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(s).Qualitative,"onUpdate:modelValue":i[8]||(i[8]=w=>e.unref(s).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",_c,[e.createElementVNode("table",Tc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[i[36]||(i[36]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(k,{modelValue:e.unref(n),"onUpdate:modelValue":i[9]||(i[9]=w=>e.isRef(n)?n.value=w:null)},null,8,["modelValue"]),e.unref(n)?(e.openBlock(),e.createElementBlock("div",wc,[e.createElementVNode("table",Dc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[32]||(i[32]=e.createElementVNode("th",null,"研習/課程名稱",-1)),i[33]||(i[33]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",Fc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(w,S)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(a)[`study-${S}-Title`],modelValue:w.Title,"onUpdate:modelValue":M=>w.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(a)[`study-${S}-TheDate`],modelValue:w.TheDate,"onUpdate:modelValue":M=>w.TheDate=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",Sc,[e.createElementVNode("div",Ac,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>E(w),type:"button"},[...i[34]||(i[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Uc)):e.createCommentVNode("",!0),S+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...i[35]||(i[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[i[39]||(i[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Mc,[e.createElementVNode("table",Oc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[37]||(i[37]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(a).Form1Before,rows:"4",modelValue:e.unref(d).Form1Before,"onUpdate:modelValue":i[10]||(i[10]=w=>e.unref(d).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...i[38]||(i[38]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(a).Form1After,rows:"4",modelValue:e.unref(d).Form1After,"onUpdate:modelValue":i[11]||(i[11]=w=>e.unref(d).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",Ic,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[12]||(i[12]=w=>o()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[13]||(i[13]=w=>o(!0)),type:"button"},[...i[43]||(i[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Pc={class:"block"},qc={key:0,class:"text-pink lh-base mt-4"},Lc={class:"mt-4"},Rc={class:"table align-middle gray-table"},zc={class:"text-center"},Gc={key:0,width:"180"},Jc={class:"text-center"},Qc={key:0},Wc=["innerHTML"],Yc=["href"],Hc={key:0,class:"text-center"},Kc={key:0},Zc={key:1,class:"text-pink"},Xc={key:1,class:"tag-group mt-2 gap-1"},vc={key:0,class:"tag tag-green-light"},ei=["download","href"],ti=["onClick"],li={class:"mt-4"},oi={class:"table align-middle gray-table side-table"},ni={key:0,class:"block-bottom bg-light-teal"},ri=["disabled"],ai={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/LIT/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/LIT/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/LIT/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/LIT/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),d=e.ref(),f=e.computed(()=>N.value.some(E=>!E.Optional&&!E.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("literacy",r.value.Status,2)),l=e.ref({}),r=e.ref({}),s=(E,o)=>{o.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:o.Path,Name:r.value.ProjectID+"_"+(E.Multiple?o.Name:`${E.Title}.pdf`)})},c=A.download,n=T,g=()=>{rxjs.forkJoin([A.literacy("getAttachment",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=N.value.filter(u=>{var b;return!((b=u.Excludes)!=null&&b.includes(r.value.OrgCategory))}),N.value.forEach(u=>{u.Files=o.Attachments.filter(b=>b.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(b=>!b.Deleted).length)}),I().init("literacy",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},B=E=>{var u,b;if(l.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:h.id,Attachments:N.value.reduce((i,m)=>i.concat(m.Files),[]),Before:(u=d.value)==null?void 0:u.Form5Before,After:(b=d.value)==null?void 0:b.Form5After,Submit:E?"true":"false"};A.literacy("saveAttachment",o).subscribe(()=>{E?n("next"):g()})},C=()=>{if(d.value){const E={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(d.value,E))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(E,o)=>{const u=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pc,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",qc,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Lc,[e.createElementVNode("table",Rc,[e.createElementVNode("thead",zc,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Gc,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",Jc,e.toDisplayString(V+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",Qc,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,Wc)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Yc)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",Hc,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",Kc,"已上傳")):(e.openBlock(),e.createElementBlock("span",Zc,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>s(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",Xc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",vc,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,ei),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ti)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",li,[e.createElementVNode("table",oi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(d).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(d).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(d).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",ni,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>B(!0)),disabled:e.unref(f),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ri)])):e.createCommentVNode("",!0)],64)}}},di={class:"block"},si={class:"mt-4"},mi={class:"table-responsive mt-3 mb-0"},ci={class:"table align-middle gray-table"},ii={key:0,width:"1"},pi={key:0},Vi={class:"d-flex gap-2"},fi=["onClick"],Ni={class:"table-responsive mt-3 mb-0"},Ei={class:"table align-middle gray-table"},bi={class:"mt-4"},ki={class:"table align-middle gray-table side-table"},gi={key:0,class:"block-bottom bg-light-teal"},ui={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.computed(()=>z("literacy",r.value.Status,4)),a=e.ref({}),l=e.computed(()=>N.value.filter(E=>!E.Deleted)),r=e.ref({}),s=()=>N.value.push({}),c=T,n=()=>{rxjs.forkJoin([A.literacy("getBenefit",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=o.Benefits,N.value.length||s(),I().init("literacy",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},g=E=>E.Deleted=!0,B=E=>{var u,b;if(a.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:r.value,Benefits:N.value,Before:(u=d.value)==null?void 0:u.Form4Before,After:(b=d.value)==null?void 0:b.Form4After,Submit:E?"true":"false"};A.literacy("saveBenefit",o).subscribe(()=>{E?c("next"):n()})},C=()=>{let E={Benefit:"不可量化成果"};return a.value=O(r.value,E),E={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((o,u)=>Object.assign(a.value,O(o,E,`item-${u}-`))),d.value&&(E={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,O(d.value,E))),!Object.keys(a.value).length};return e.onMounted(n),e.provide("editable",f),(E,o)=>{const u=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",di,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",si,[e.createElementVNode("div",mi,[e.createElementVNode("table",ci,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"目標值",-1)),o[7]||(o[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",ii,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(a)[`item-${V}-Title`],modelValue:m.Title,"onUpdate:modelValue":t=>m.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(a)[`item-${V}-Target`],modelValue:m.Target,"onUpdate:modelValue":t=>m.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a)[`item-${V}-Description`],rows:"1",modelValue:m.Description,"onUpdate:modelValue":t=>m.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",pi,[e.createElementVNode("div",Vi,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>g(m),type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,fi)):e.createCommentVNode("",!0),V+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Ni,[e.createElementVNode("table",Ei,[o[10]||(o[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(r).Benefit,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(r).Benefit=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",bi,[e.createElementVNode("table",ki,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(d).Form4Before,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form4Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(d).Form4After,"onUpdate:modelValue":o[2]||(o[2]=m=>e.unref(d).Form4After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",gi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[3]||(o[3]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[4]||(o[4]=m=>B(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},yi={class:"block"},xi={class:"mt-4"},Bi={class:"table-responsive mt-3 mb-0"},hi={class:"table align-middle gray-table"},$i={class:"text-end"},Ci={class:"text-end"},_i={class:"table-responsive"},Ti={class:"table align-middle gray-table"},wi=["colspan"],Di={key:0,width:"1"},Fi={class:"text-end"},Si={key:0},Ai={class:"d-flex gap-2"},Ui=["onClick"],Mi={class:"mt-4"},Oi={class:"table-responsive mt-3 mb-0"},Ii={class:"table align-middle gray-table"},ji={key:0,width:"1"},Pi={class:"text-end"},qi={key:0},Li={class:"d-flex gap-2"},Ri=["onClick"],zi={class:"mt-4"},Gi={class:"table align-middle gray-table side-table"},Ji={key:0,class:"block-bottom bg-light-teal"},Qi={class:"text-center"},Wi={class:"mb-5"},Yi={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.computed(()=>z("literacy",r.value.Status,3)),f=e.ref({}),a=e.computed(()=>c.value.filter(V=>!V.Deleted)),l=e.computed(()=>n.value.filter(V=>!V.Deleted)),r=e.ref({}),s=e.ref(),c=e.ref([]),n=e.ref([]),g=e.ref({}),B=e.ref(0),C=()=>c.value.push({}),E=()=>n.value.push({}),o=T,u=()=>{rxjs.forkJoin([A.literacy("getFunding",{ID:h.id})]).subscribe(V=>{const t=V[0];r.value=t.Project,c.value=t.OtherSubsidies,n.value=t.BudgetPlans,g.value=t.GrantTargetSetting,c.value.length||C(),n.value.length||E(),I().init("literacy",r.value),N.value=r.value.changeApply,r.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=(V,t)=>{var k,U;if(f.value={},V&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&r.value.ApplyAmount>g.value.GrantLimit*1e4){s.value.show(()=>i(V,!0));return}const p={Project:r.value,OtherSubsidies:c.value,BudgetPlans:n.value,Before:(k=N.value)==null?void 0:k.Form3Before,After:(U=N.value)==null?void 0:U.Form3After,Submit:V?"true":"false"};A.literacy("saveFunding",p).subscribe(()=>{V?o("next"):u()})},m=()=>{let V={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=O(r.value,V),V={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},c.value.forEach((t,p)=>Object.assign(f.value,O(t,V,`other-${p}-`))),V={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},n.value.forEach((t,p)=>Object.assign(f.value,O(t,V,`plan-${p}-`))),N.value&&(V={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,O(N.value,V))),!Object.keys(f.value).length};return e.onMounted(u),e.provide("editable",d),e.watchEffect(()=>{r.value.OtherAmount=a.value.reduce((V,t)=>V+R(t.Amount),0),B.value=R(r.value.ApplyAmount)+R(r.value.SelfAmount)+R(r.value.OtherAmount),a.value.forEach(V=>V.percent=Math.round(R(V.Amount)/r.value.OtherAmount*1e4)/100),n.value.forEach(V=>V.sum=R(V.Amount)+R(V.OtherAmount))}),(V,t)=>{var M;const p=e.resolveComponent("input-integer"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),S=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yi,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",xi,[e.createElementVNode("div",Bi,[e.createElementVNode("table",hi,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f).ApplyAmount,modelValue:e.unref(r).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(r).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f).SelfAmount,modelValue:e.unref(r).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(r).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",$i,e.toDisplayString((M=e.unref(r).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Ci,e.toDisplayString(e.unref(B).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",_i,[e.createElementVNode("table",Ti,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(d)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,wi)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",Di,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,y)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(f)[`other-${y}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":_=>F.Unit=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`other-${y}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":_=>F.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Fi,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`other-${y}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":_=>F.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",Si,[e.createElementVNode("div",Ai,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>b(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ui)):e.createCommentVNode("",!0),y+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Mi,[e.createElementVNode("div",Oi,[e.createElementVNode("table",Ii,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",ji,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(F,y)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(f)[`plan-${y}-Title`],modelValue:F.Title,"onUpdate:modelValue":_=>F.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`plan-${y}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":_=>F.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`plan-${y}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":_=>F.OtherAmount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Pi,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`plan-${y}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":_=>F.Description=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",qi,[e.createElementVNode("div",Li,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>b(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ri)):e.createCommentVNode("",!0),y+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",zi,[e.createElementVNode("table",Gi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(N).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(N).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",Ji,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>i(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(S,{ref_key:"modal",ref:s},{default:e.withCtx(()=>[e.createElementVNode("div",Qi,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Wi,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(g).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Hi={class:"block"},Ki={class:"text-teal fw-bold py-3"},Zi={class:"table-responsive"},Xi={class:"table align-middle gray-table"},vi={class:"text-end"},ep={class:"mt-4"},tp={class:"table align-middle gray-table"},lp={class:"text-center"},op={key:0,width:"180"},np={class:"text-center"},rp=["href"],ap={key:0,class:"text-center"},dp={key:0},sp={key:1,class:"text-pink"},mp={key:1,class:"tag-group mt-2 gap-1"},cp={key:0,class:"tag tag-green-light"},ip=["download","href"],pp=["onClick"],Vp={class:"block-bottom bg-light-teal"},fp=!0,Np={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(0),d=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]}]);e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0);const a=(s,c)=>{c.Type==="application/pdf"&&s.Files.push({Type:s.Type,Path:c.Path,Name:d.value.ProjectID+"_請款_"+(s.Multiple?c.Name:`${s.Title}.pdf`)})},l=A.download,r=s=>{};return e.onMounted(()=>{A.literacy("findApplication",{ID:h.id}).subscribe(s=>{d.value=s.Project,I().init("literacy",d.value),f.value=f.value.filter(c=>{var n;return!((n=c.Excludes)!=null&&n.includes(d.value.OrgCategory))}),f.value.forEach(c=>{c.Uploaded=e.computed(()=>c.Files.filter(n=>!n.Deleted).length)})})}),e.provide("editable",fp),(s,c)=>{var B;const n=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Hi,[c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後進行請款，預撥100%）",-1)),e.createElementVNode("p",Ki,"核定經費: "+e.toDisplayString((B=e.unref(d).ApprovedAmount)==null?void 0:B.toLocaleString())+"元",1),e.createElementVNode("div",Zi,[e.createElementVNode("table",Xi,[c[6]||(c[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",vi,e.toDisplayString(e.unref(d).ApprovedAmount),1),c[2]||(c[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[3]||(c[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[4]||(c[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[5]||(c[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),c[13]||(c[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),c[14]||(c[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",ep,[e.createElementVNode("table",tp,[e.createElementVNode("thead",lp,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),c[8]||(c[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",op,"狀態")),c[9]||(c[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(C,E)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",np,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(n,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Title),1)]),_:2},1024)]),C.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:C.Template,style:{width:"140px"},type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,rp)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",ap,[C.Uploaded?(e.openBlock(),e.createElementBlock("span",dp,"已上傳")):(e.openBlock(),e.createElementBlock("span",sp,"尚未上傳"))])),e.createElementVNode("td",null,[C.Multiple||!C.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:o=>a(C,o)},null,8,["onFile"])):e.createCommentVNode("",!0),C.Uploaded?(e.openBlock(),e.createElementBlock("div",mp,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",cp,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,ip),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:u=>o.Deleted=!0,type:"button"},[...c[11]||(c[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,pp))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Vp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[0]||(c[0]=C=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[1]||(c[1]=C=>r()),type:"button"},[...c[15]||(c[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Ep={class:"block"},bp={class:"text-teal fw-bold py-3"},kp={class:"text-teal fw-bold pb-3"},gp={class:"table-responsive"},up={class:"table align-middle gray-table"},yp={class:"text-end"},xp={class:"text-end"},Bp={class:"text-end"},hp={class:"mt-4"},$p={class:"table align-middle gray-table"},Cp={class:"text-center"},_p={key:0,width:"180"},Tp={class:"text-center"},wp=["href"],Dp={key:0,class:"text-center"},Fp={key:0},Sp={key:1,class:"text-pink"},Ap={key:1,class:"tag-group mt-2 gap-1"},Up={key:0,class:"tag tag-green-light"},Mp=["download","href"],Op=["onClick"],Ip={class:"block-bottom bg-light-teal"},jp=!0,Pp={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(8e4),d=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/LIT/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/LIT/3-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/LIT/4-補助清單.docx",Files:[]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_結案核銷_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.literacy("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("literacy",d.value),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",jp),(c,n)=>{var E;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ep,[n[10]||(n[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",bp,"核定經費: "+e.toDisplayString((E=e.unref(d).ApprovedAmount)==null?void 0:E.toLocaleString())+"元",1),e.createElementVNode("p",kp,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(N)).toLocaleString())+"元",1),e.createElementVNode("div",gp,[e.createElementVNode("table",up,[n[4]||(n[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",yp,e.toDisplayString(e.unref(d).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=o=>e.isRef(N)?N.value=o:null)},null,8,["modelValue"])]),e.createElementVNode("td",xp,e.toDisplayString(e.unref(a))+"%",1),e.createElementVNode("td",Bp,e.toDisplayString(e.unref(a))+"%",1)])])])]),n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[12]||(n[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",hp,[e.createElementVNode("table",$p,[e.createElementVNode("thead",Cp,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",_p,"狀態")),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(o,u)=>(e.openBlock(),e.createElementBlock("tr",{key:o},[e.createElementVNode("td",Tp,e.toDisplayString(u+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.Title),1)]),_:2},1024)]),o.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:o.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,wp)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Dp,[o.Uploaded?(e.openBlock(),e.createElementBlock("span",Fp,"已上傳")):(e.openBlock(),e.createElementBlock("span",Sp,"尚未上傳"))])),e.createElementVNode("td",null,[o.Multiple||!o.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:b=>l(o,b)},null,8,["onFile"])):e.createCommentVNode("",!0),o.Uploaded?(e.openBlock(),e.createElementBlock("div",Ap,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.Files,b=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:b},[b.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Up,[e.createElementVNode("a",{class:"tag-link my-1",download:b.Name,href:e.unref(r)(b.Path)},e.toDisplayString(b.Name),9,Mp),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:i=>b.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Op))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Ip,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=o=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=o=>s()),type:"button"},[...n[13]||(n[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},qp={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const d=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(d,{steps:T,type:"literacy"})}}},Lp={class:"block"},Rp={class:"mt-4"},zp={class:"table align-middle gray-table side-table"},Gp={key:0,class:"d-flex align-items-center gap-2"},Jp={class:"input-group w-auto"},Qp={class:"text-teal-dark"},Wp={key:1,class:"invalid mt-0"},Yp={class:"table-responsive mt-4"},Hp={class:"table align-middle gray-table"},Kp={key:0},Zp={class:"input-group"},Xp={key:0,class:"invalid mt-0"},vp={key:0},eV={class:"d-flex gap-2"},tV=["onClick"],lV={class:"mt-4"},oV={class:"table align-middle gray-table"},nV={key:0},rV={key:0},aV={class:"d-flex gap-2"},dV=["onClick"],sV={class:"mt-4"},mV={class:"table align-middle gray-table side-table"},cV={key:0,class:"block-bottom bg-light-teal"},iV={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=[{value:1,text:"50%"},{value:2,text:"100%"}],d=e.ref(),f=e.computed(()=>n.value.EndDate),a=e.computed(()=>z("literacy",c.value.Status,2)),l=e.ref({}),r=e.computed(()=>g.value.filter(V=>!V.Deleted)),s=e.computed(()=>B.value.filter(V=>!V.Deleted)),c=e.ref({}),n=e.ref({}),g=e.ref([]),B=e.ref([]),C=()=>A.literacy("createItem",{ID:h.id}).subscribe(V=>g.value.push(V)),E=()=>B.value.push({Type:0,ItemID:0}),o=T,u=()=>{rxjs.forkJoin([A.literacy("getWorkSchedule",{ID:h.id})]).subscribe(V=>{const t=V[0];c.value=t.Project,n.value=t.GrantType,g.value=t.Items,B.value=t.Schedules,g.value.length||C(),B.value.length||E(),I().init("literacy",c.value),d.value=c.value.changeApply,c.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=V=>{var p,k;if(l.value={},V&&!m()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:c.value,Items:g.value,Schedules:B.value,Before:(p=d.value)==null?void 0:p.Form2Before,After:(k=d.value)==null?void 0:k.Form2After,Submit:V?"true":"false"};A.literacy("saveWorkSchedule",t).subscribe(()=>{V?o("next"):u()})},m=()=>{let V={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(c.value,V),V={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},r.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`item-${p}-`))),V={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},s.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`schedule-${p}-`))),d.value&&(V={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(d.value,V))),!Object.keys(l.value).length};return e.onMounted(u),e.provide("editable",a),(V,t)=>{const p=e.resolveComponent("required-label"),k=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Lp,[t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Rp,[e.createElementVNode("table",zp,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",Gp,[e.createElementVNode("div",Jp,[e.createVNode(k,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[0]||(t[0]=y=>e.unref(c).StartTime=y)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[1]||(t[1]=y=>e.unref(c).EndTime=y)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Qp,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(f)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",Wp,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Yp,[e.createElementVNode("table",Hp,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",Kp,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+_)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`item-${_}-Title`],modelValue:y.Title,"onUpdate:modelValue":D=>y.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Zp,[e.createVNode(S,{"empty-value":0,modelValue:y.Begin,"onUpdate:modelValue":D=>y.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(S,{"empty-value":0,modelValue:y.End,"onUpdate:modelValue":D=>y.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${_}-Begin`]||e.unref(l)[`item-${_}-End`]?(e.openBlock(),e.createElementBlock("div",Xp,e.toDisplayString(e.unref(l)[`item-${_}-Begin`]||e.unref(l)[`item-${_}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`item-${_}-Deadline`],modelValue:y.Deadline,"onUpdate:modelValue":D=>y.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`item-${_}-Content`],rows:"1",modelValue:y.Content,"onUpdate:modelValue":D=>y.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",vp,[e.createElementVNode("div",eV,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(y),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,tV)):e.createCommentVNode("",!0),_+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[29]||(t[29]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",lV,[e.createElementVNode("table",oV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[21]||(t[21]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",nV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${_}-Type`],options:N,modelValue:y.Type,"onUpdate:modelValue":D=>y.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${_}-ItemID`],options:e.unref(r),"text-name":"Title","value-name":"ID",modelValue:y.ItemID,"onUpdate:modelValue":D=>y.ItemID=D,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(y.ItemID?String.fromCharCode(65+e.unref(r).findIndex(D=>D.ID===y.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`schedule-${_}-Deadline`],modelValue:y.Deadline,"onUpdate:modelValue":D=>y.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`schedule-${_}-Content`],rows:"1",modelValue:y.Content,"onUpdate:modelValue":D=>y.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",rV,[e.createElementVNode("div",aV,[e.unref(s).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(y),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,dV)):e.createCommentVNode("",!0),_+1===e.unref(s).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[23]||(t[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",sV,[e.createElementVNode("table",mV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(d).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=y=>e.unref(d).Form2Before=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(d).Form2After,"onUpdate:modelValue":t[3]||(t[3]=y=>e.unref(d).Form2After=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",cV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=y=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=y=>i(!0)),type:"button"},[...t[30]||(t[30]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},pV={class:"block"},VV={class:"mt-4"},fV={class:"table align-middle gray-table side-table"},NV={key:0},EV={key:1,class:"text-light-gray"},bV={class:"mt-4"},kV={class:"table align-middle gray-table side-table"},gV={class:"row g-3"},uV={class:"col-12 col-xl-2"},yV={class:"text-gray mb-2"},xV={class:"col-12 col-xl-3"},BV={class:"text-gray mb-2"},hV={class:"col-12 col-xl-4"},$V={class:"row g-1"},CV={class:"col-7"},_V={class:"col-5"},TV={class:"col-12 col-xl-3"},wV={class:"text-gray mb-2"},DV={class:"col-12"},FV={class:"text-gray mb-2"},SV={class:"mt-4"},AV={class:"table align-middle gray-table side-table"},UV={class:"mt-4"},MV={class:"table align-middle gray-table side-table"},OV={key:0,class:"table-responsive mt-3 mb-0"},IV={class:"table align-middle gray-table"},jV={key:0},PV={key:0},qV={class:"d-flex gap-2"},LV=["onClick"],RV={class:"mt-4"},zV={class:"table align-middle gray-table side-table"},GV={key:0,class:"block-bottom bg-light-teal"},JV={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.ref(),a=e.computed(()=>z("multiple",c.value.Status,1)),l=e.ref({}),r=e.ref([]),s=e.computed(()=>n.value.filter(i=>!i.Deleted)),c=e.ref({}),n=e.ref([]),g=e.computed({get:()=>!!s.value.length,set:i=>{i?B():n.value.forEach(m=>m.Deleted=!0)}}),B=()=>n.value.push({}),C=T,E=()=>{A.multiple("getApplication",{ID:h.id}).subscribe(i=>{c.value=i.Project,f.value=i.Contacts,n.value=i.ReceivedSubsidies,c.value.OrgCategory=c.value.OrgCategory||null,I().init("multiple",c.value),d.value=c.value.changeApply,c.value.changeApply=void 0})},o=i=>i.Deleted=!0,u=i=>{var V,t;if(l.value={},i&&!b()){e.nextTick(()=>{var p;return(p=document.querySelector(".invalid"))==null?void 0:p.scrollIntoView({behavior:"smooth",block:"center"})});return}const m={Project:c.value,Contacts:f.value,ReceivedSubsidies:n.value.filter(p=>p.ID||!p.Deleted),Before:(V=d.value)==null?void 0:V.Form1Before,After:(t=d.value)==null?void 0:t.Form1After,Submit:i?"true":"false"};A.multiple("saveApplication",m).subscribe(p=>{i?C("next",p.ID):c.value.ID?E():window.location.href=`Application.aspx?ID=${p.ID}`})},b=()=>{let i={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return l.value=O(c.value,i),i={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},f.value.forEach((m,V)=>Object.assign(l.value,O(m,i,`contact-${V}-`))),i={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},n.value.forEach((m,V)=>Object.assign(l.value,O(m,i,`received-${V}-`))),d.value&&(i={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(l.value,O(d.value,i))),!Object.keys(l.value).length};return e.onMounted(()=>{rxjs.forkJoin([A.multiple("getZgsCodes",{CodeGroup:"MULField"}),A.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(i=>{r.value=i[0],N.value=i[1],h.id?E():A.multiple("getEmptyApplication").subscribe(m=>{c.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},m),f.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("multiple",c.value)})})}),e.provide("editable",a),(i,m)=>{const V=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),p=e.resolveComponent("input-select"),k=e.resolveComponent("input-textarea"),U=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",pV,[m[43]||(m[43]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",VV,[e.createElementVNode("table",fV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[m[15]||(m[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).Year),1)]),e.createElementVNode("tr",null,[m[16]||(m[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(c).ProjectID?(e.openBlock(),e.createElementBlock("span",NV,e.toDisplayString(e.unref(c).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",EV,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[m[17]||(m[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[18]||(m[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).ProjectName,modelValue:e.unref(c).ProjectName,"onUpdate:modelValue":m[0]||(m[0]=S=>e.unref(c).ProjectName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[19]||(m[19]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{"empty-value":null,error:e.unref(l).Field,options:e.unref(r),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).Field,"onUpdate:modelValue":m[1]||(m[1]=S=>e.unref(c).Field=S)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[20]||(m[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(c).OrgName,"onUpdate:modelValue":m[2]||(m[2]=S=>e.unref(c).OrgName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[21]||(m[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{"empty-value":null,error:e.unref(l).OrgCategory,options:e.unref(N),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).OrgCategory,"onUpdate:modelValue":m[3]||(m[3]=S=>e.unref(c).OrgCategory=S)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[22]||(m[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).TaxID,"max-length":8,modelValue:e.unref(c).TaxID,"onUpdate:modelValue":m[4]||(m[4]=S=>e.unref(c).TaxID=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[23]||(m[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l).Address,placeholder:"請輸入地址",modelValue:e.unref(c).Address,"onUpdate:modelValue":m[5]||(m[5]=S=>e.unref(c).Address=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),m[44]||(m[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",bV,[e.createElementVNode("table",kV,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(S,M)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(S.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",gV,[e.createElementVNode("div",uV,[e.createElementVNode("div",yV,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[24]||(m[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-Name`],modelValue:S.Name,"onUpdate:modelValue":F=>S.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",xV,[e.createElementVNode("div",BV,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[25]||(m[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-JobTitle`],modelValue:S.JobTitle,"onUpdate:modelValue":F=>S.JobTitle=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hV,[m[26]||(m[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",$V,[e.createElementVNode("div",CV,[e.createVNode(t,{modelValue:S.Phone,"onUpdate:modelValue":F=>S.Phone=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",_V,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:S.PhoneExt,"onUpdate:modelValue":F=>S.PhoneExt=F,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",TV,[e.createElementVNode("div",wV,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[27]||(m[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-MobilePhone`],modelValue:S.MobilePhone,"onUpdate:modelValue":F=>S.MobilePhone=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",DV,[e.createElementVNode("div",FV,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[28]||(m[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(l)[`contact-${M}-EMail`],modelValue:S.EMail,"onUpdate:modelValue":F=>S.EMail=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),m[45]||(m[45]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",SV,[e.createElementVNode("table",AV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[29]||(m[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[m[30]||(m[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(k,{error:e.unref(l).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(c).Target,"onUpdate:modelValue":m[6]||(m[6]=S=>e.unref(c).Target=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[31]||(m[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(c).Summary,"onUpdate:modelValue":m[7]||(m[7]=S=>e.unref(c).Summary=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[32]||(m[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Quantified,"onUpdate:modelValue":m[8]||(m[8]=S=>e.unref(c).Quantified=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[33]||(m[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Qualitative,"onUpdate:modelValue":m[9]||(m[9]=S=>e.unref(c).Qualitative=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",UV,[e.createElementVNode("table",MV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[m[39]||(m[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(U,{modelValue:e.unref(g),"onUpdate:modelValue":m[10]||(m[10]=S=>e.isRef(g)?g.value=S:null)},null,8,["modelValue"]),e.unref(g)?(e.openBlock(),e.createElementBlock("div",OV,[e.createElementVNode("table",IV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[m[34]||(m[34]=e.createElementVNode("th",null,"計畫名稱",-1)),m[35]||(m[35]=e.createElementVNode("th",null,"補助單位",-1)),m[36]||(m[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",jV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(S,M)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l)[`received-${M}-Name`],modelValue:S.Name,"onUpdate:modelValue":F=>S.Name=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(l)[`received-${M}-Unit`],modelValue:S.Unit,"onUpdate:modelValue":F=>S.Unit=F,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`received-${M}-Amount`],modelValue:S.Amount,"onUpdate:modelValue":F=>S.Amount=F},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",PV,[e.createElementVNode("div",qV,[e.unref(s).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:F=>o(S),type:"button"},[...m[37]||(m[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,LV)):e.createCommentVNode("",!0),M+1===e.unref(s).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:B,type:"button"},[...m[38]||(m[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[m[42]||(m[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",RV,[e.createElementVNode("table",zV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[40]||(m[40]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Form1Before,rows:"4",modelValue:e.unref(d).Form1Before,"onUpdate:modelValue":m[11]||(m[11]=S=>e.unref(d).Form1Before=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...m[41]||(m[41]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l).Form1After,rows:"4",modelValue:e.unref(d).Form1After,"onUpdate:modelValue":m[12]||(m[12]=S=>e.unref(d).Form1After=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",GV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:m[13]||(m[13]=S=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:m[14]||(m[14]=S=>u(!0)),type:"button"},[...m[46]||(m[46]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},QV={class:"block"},WV={key:0,class:"text-pink lh-base mt-4"},YV={class:"mt-4"},HV={class:"table align-middle gray-table"},KV={class:"text-center"},ZV={key:0,width:"180"},XV={class:"text-center"},vV={key:0},ef=["innerHTML"],tf=["href"],lf={key:0,class:"text-center"},of={key:0},nf={key:1,class:"text-pink"},rf={key:1,class:"tag-group mt-2 gap-1"},af={key:0,class:"tag tag-green-light"},df=["download","href"],sf=["onClick"],mf={class:"mt-4"},cf={class:"table align-middle gray-table side-table"},pf={key:0,class:"block-bottom bg-light-teal"},Vf=["disabled"],ff={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([{Type:1,Title:"申請表",Template:"../../Template/MUL/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/MUL/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/MUL/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/MUL/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),d=e.ref(),f=e.computed(()=>N.value.some(E=>!E.Optional&&!E.Files.filter(o=>!o.Deleted).length)),a=e.computed(()=>z("multiple",r.value.Status,2)),l=e.ref({}),r=e.ref({}),s=(E,o)=>{o.Type==="application/pdf"&&E.Files.push({Type:E.Type,Path:o.Path,Name:r.value.ProjectID+"_"+(E.Multiple?o.Name:`${E.Title}.pdf`)})},c=A.download,n=T,g=()=>{rxjs.forkJoin([A.multiple("getAttachment",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=N.value.filter(u=>{var b;return!((b=u.Excludes)!=null&&b.includes(r.value.OrgCategory))}),r.value.Status>=42&&N.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/MUL/6-著作權授權同意書.docx",Files:[]}),N.value.forEach(u=>{u.Files=o.Attachments.filter(b=>b.Type===u.Type),u.Uploaded=e.computed(()=>u.Files.filter(b=>!b.Deleted).length)}),I().init("multiple",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},B=E=>{var u,b;if(l.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={ID:h.id,Attachments:N.value.reduce((i,m)=>i.concat(m.Files),[]),Before:(u=d.value)==null?void 0:u.Form5Before,After:(b=d.value)==null?void 0:b.Form5After,Submit:E?"true":"false"};A.multiple("saveAttachment",o).subscribe(()=>{E?n("next"):g()})},C=()=>{if(d.value){const E={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(l.value,O(d.value,E))}return!Object.keys(l.value).length};return e.onMounted(g),e.provide("editable",a),(E,o)=>{const u=e.resolveComponent("required-label"),b=e.resolveComponent("input-file"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",QV,[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("p",WV,[...o[4]||(o[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",YV,[e.createElementVNode("table",HV,[e.createElementVNode("thead",KV,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(a)?(e.openBlock(),e.createElementBlock("th",ZV,"狀態")):e.createCommentVNode("",!0),o[7]||(o[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",XV,e.toDisplayString(V+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[m.Optional?(e.openBlock(),e.createElementBlock("span",vV,e.toDisplayString(m.Title),1)):(e.openBlock(),e.createBlock(u,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(m.Title),1)]),_:2},1024))]),e.unref(a)&&m.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:m.Comment},null,8,ef)):e.createCommentVNode("",!0),e.unref(a)&&m.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:m.Template,style:{width:"140px"},type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,tf)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",lf,[m.Uploaded?(e.openBlock(),e.createElementBlock("span",of,"已上傳")):(e.openBlock(),e.createElementBlock("span",nf,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(a)&&(m.Multiple||!m.Uploaded)?(e.openBlock(),e.createBlock(b,{key:0,accept:".pdf",onFile:t=>s(m,t)},null,8,["onFile"])):e.createCommentVNode("",!0),m.Uploaded?(e.openBlock(),e.createElementBlock("div",rf,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",af,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(c)(t.Path)},e.toDisplayString(t.Name),9,df),e.unref(a)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:p=>t.Deleted=!0,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,sf)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[o[12]||(o[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",mf,[e.createElementVNode("table",cf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[10]||(o[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5Before,rows:"4",modelValue:e.unref(d).Form5Before,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(d).Form5Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(l).Form5After,rows:"4",modelValue:e.unref(d).Form5After,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form5After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",pf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[2]||(o[2]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[3]||(o[3]=m=>B(!0)),disabled:e.unref(f),type:"button"},[...o[14]||(o[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Vf)])):e.createCommentVNode("",!0)],64)}}},Nf={class:"block"},Ef={class:"mt-4"},bf={class:"table-responsive mt-3 mb-0"},kf={class:"table align-middle gray-table"},gf={key:0,width:"1"},uf={key:0},yf={class:"d-flex gap-2"},xf=["onClick"],Bf={class:"table-responsive mt-3 mb-0"},hf={class:"table align-middle gray-table"},$f={class:"mt-4"},Cf={class:"table align-middle gray-table side-table"},_f={key:0,class:"block-bottom bg-light-teal"},Tf={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref([]),d=e.ref(),f=e.computed(()=>z("multiple",r.value.Status,4)),a=e.ref({}),l=e.computed(()=>N.value.filter(E=>!E.Deleted)),r=e.ref({}),s=()=>N.value.push({}),c=T,n=()=>{rxjs.forkJoin([A.multiple("getBenefit",{ID:h.id})]).subscribe(E=>{const o=E[0];r.value=o.Project,N.value=o.Benefits,N.value.length||s(),I().init("multiple",r.value),d.value=r.value.changeApply,r.value.changeApply=void 0})},g=E=>E.Deleted=!0,B=E=>{var u,b;if(a.value={},E&&!C()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const o={Project:r.value,Benefits:N.value,Before:(u=d.value)==null?void 0:u.Form4Before,After:(b=d.value)==null?void 0:b.Form4After,Submit:E?"true":"false"};A.multiple("saveBenefit",o).subscribe(()=>{E?c("next"):n()})},C=()=>{let E={Benefit:"不可量化成果"};return a.value=O(r.value,E),E={Title:"指標",Target:"目標值",Description:"說明"},l.value.forEach((o,u)=>Object.assign(a.value,O(o,E,`item-${u}-`))),d.value&&(E={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(a.value,O(d.value,E))),!Object.keys(a.value).length};return e.onMounted(n),e.provide("editable",f),(E,o)=>{const u=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),i=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Nf,[o[14]||(o[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Ef,[e.createElementVNode("div",bf,[e.createElementVNode("table",kf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[o[5]||(o[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),o[6]||(o[6]=e.createElementVNode("th",null,"目標值",-1)),o[7]||(o[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",gf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(m,V)=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(a)[`item-${V}-Title`],modelValue:m.Title,"onUpdate:modelValue":t=>m.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(a)[`item-${V}-Target`],modelValue:m.Target,"onUpdate:modelValue":t=>m.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a)[`item-${V}-Description`],rows:"1",modelValue:m.Description,"onUpdate:modelValue":t=>m.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",uf,[e.createElementVNode("div",yf,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>g(m),type:"button"},[...o[8]||(o[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,xf)):e.createCommentVNode("",!0),V+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...o[9]||(o[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Bf,[e.createElementVNode("table",hf,[o[10]||(o[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Benefit,rows:"4",modelValue:e.unref(r).Benefit,"onUpdate:modelValue":o[0]||(o[0]=m=>e.unref(r).Benefit=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[o[13]||(o[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$f,[e.createElementVNode("table",Cf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...o[11]||(o[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4Before,rows:"4",modelValue:e.unref(d).Form4Before,"onUpdate:modelValue":o[1]||(o[1]=m=>e.unref(d).Form4Before=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...o[12]||(o[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(a).Form4After,rows:"4",modelValue:e.unref(d).Form4After,"onUpdate:modelValue":o[2]||(o[2]=m=>e.unref(d).Form4After=m),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",_f,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:o[3]||(o[3]=m=>B()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:o[4]||(o[4]=m=>B(!0)),type:"button"},[...o[15]||(o[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},wf={class:"block"},Df={class:"mt-4"},Ff={class:"table-responsive mt-3 mb-0"},Sf={class:"table align-middle gray-table"},Af={class:"text-end"},Uf={class:"text-end"},Mf={class:"table-responsive"},Of={class:"table align-middle gray-table"},If=["colspan"],jf={key:0,width:"1"},Pf={class:"text-end"},qf={key:0},Lf={class:"d-flex gap-2"},Rf=["onClick"],zf={class:"mt-4"},Gf={class:"table-responsive mt-3 mb-0"},Jf={class:"table align-middle gray-table"},Qf={key:0,width:"1"},Wf={class:"text-end"},Yf={key:0},Hf={class:"d-flex gap-2"},Kf=["onClick"],Zf={class:"mt-4"},Xf={class:"table align-middle gray-table side-table"},vf={key:0,class:"block-bottom bg-light-teal"},eN={class:"text-center"},tN={class:"mb-5"},lN={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(),d=e.computed(()=>z("multiple",r.value.Status,3)),f=e.ref({}),a=e.computed(()=>c.value.filter(V=>!V.Deleted)),l=e.computed(()=>n.value.filter(V=>!V.Deleted)),r=e.ref({}),s=e.ref(),c=e.ref([]),n=e.ref([]),g=e.ref({}),B=e.ref(0),C=()=>c.value.push({}),E=()=>n.value.push({}),o=T,u=()=>{rxjs.forkJoin([A.multiple("getFunding",{ID:h.id})]).subscribe(V=>{const t=V[0];r.value=t.Project,c.value=t.OtherSubsidies,n.value=t.BudgetPlans,g.value=t.GrantTargetSetting,c.value.length||C(),n.value.length||E(),I().init("multiple",r.value),N.value=r.value.changeApply,r.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=(V,t)=>{var k,U;if(f.value={},V&&!m()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&r.value.ApplyAmount>g.value.GrantLimit*1e4){s.value.show(()=>i(V,!0));return}const p={Project:r.value,OtherSubsidies:c.value,BudgetPlans:n.value,Before:(k=N.value)==null?void 0:k.Form3Before,After:(U=N.value)==null?void 0:U.Form3After,Submit:V?"true":"false"};A.multiple("saveFunding",p).subscribe(()=>{V?o("next"):u()})},m=()=>{let V={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=O(r.value,V),V={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},c.value.forEach((t,p)=>Object.assign(f.value,O(t,V,`other-${p}-`))),V={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},n.value.forEach((t,p)=>Object.assign(f.value,O(t,V,`plan-${p}-`))),N.value&&(V={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,O(N.value,V))),!Object.keys(f.value).length};return e.onMounted(u),e.provide("editable",d),e.watchEffect(()=>{r.value.OtherAmount=a.value.reduce((V,t)=>V+R(t.Amount),0),B.value=R(r.value.ApplyAmount)+R(r.value.SelfAmount)+R(r.value.OtherAmount),a.value.forEach(V=>V.percent=Math.round(R(V.Amount)/r.value.OtherAmount*1e4)/100),n.value.forEach(V=>V.sum=R(V.Amount)+R(V.OtherAmount))}),(V,t)=>{var M;const p=e.resolveComponent("input-integer"),k=e.resolveComponent("input-text"),U=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),S=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",wf,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Df,[e.createElementVNode("div",Ff,[e.createElementVNode("table",Sf,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f).ApplyAmount,modelValue:e.unref(r).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=F=>e.unref(r).ApplyAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f).SelfAmount,modelValue:e.unref(r).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=F=>e.unref(r).SelfAmount=F)},null,8,["error","modelValue"])]),e.createElementVNode("td",Af,e.toDisplayString((M=e.unref(r).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Uf,e.toDisplayString(e.unref(B).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Mf,[e.createElementVNode("table",Of,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(d)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,If)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",jf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(F,y)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,e.toDisplayString(y+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(f)[`other-${y}-Unit`],modelValue:F.Unit,"onUpdate:modelValue":_=>F.Unit=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`other-${y}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":_=>F.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Pf,e.toDisplayString(F.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`other-${y}-Content`],rows:"1",modelValue:F.Content,"onUpdate:modelValue":_=>F.Content=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",qf,[e.createElementVNode("div",Lf,[e.unref(a).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>b(F),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Rf)):e.createCommentVNode("",!0),y+1===e.unref(a).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",zf,[e.createElementVNode("div",Gf,[e.createElementVNode("table",Jf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(d)?(e.openBlock(),e.createElementBlock("th",Qf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(F,y)=>(e.openBlock(),e.createElementBlock("tr",{key:F},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(f)[`plan-${y}-Title`],modelValue:F.Title,"onUpdate:modelValue":_=>F.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`plan-${y}-Amount`],modelValue:F.Amount,"onUpdate:modelValue":_=>F.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(f)[`plan-${y}-OtherAmount`],modelValue:F.OtherAmount,"onUpdate:modelValue":_=>F.OtherAmount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Wf,e.toDisplayString(F.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f)[`plan-${y}-Description`],rows:"1",modelValue:F.Description,"onUpdate:modelValue":_=>F.Description=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(d)?(e.openBlock(),e.createElementBlock("td",Yf,[e.createElementVNode("div",Hf,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>b(F),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Kf)):e.createCommentVNode("",!0),y+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(N)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Zf,[e.createElementVNode("table",Xf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(N).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=F=>e.unref(N).Form3Before=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(N).Form3After,"onUpdate:modelValue":t[3]||(t[3]=F=>e.unref(N).Form3After=F),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",vf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=F=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=F=>i(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(S,{ref_key:"modal",ref:s},{default:e.withCtx(()=>[e.createElementVNode("div",eN,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",tN,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(g).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},oN={class:"block"},nN={class:"text-teal fw-bold py-3"},rN={class:"table-responsive"},aN={class:"table align-middle gray-table"},dN={class:"text-end"},sN={class:"mt-4"},mN={class:"table align-middle gray-table"},cN={class:"text-center"},iN={key:0,width:"180"},pN={class:"text-center"},VN=["href"],fN={key:0,class:"text-center"},NN={key:0},EN={key:1,class:"text-pink"},bN={key:1,class:"tag-group mt-2 gap-1"},kN={key:0,class:"tag tag-green-light"},gN=["download","href"],uN=["onClick"],yN={class:"block-bottom bg-light-teal"},xN=!0,BN={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(0),d=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]}]),a=(s,c)=>{c.Type==="application/pdf"&&s.Files.push({Type:s.Type,Path:c.Path,Name:d.value.ProjectID+"_第一期_"+(s.Multiple?c.Name:`${s.Title}.pdf`)})},l=A.download,r=s=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:h.id}).subscribe(s=>{d.value=s.Project,I().init("multiple",d.value),N.value=Math.round(d.value.ApprovedAmount*.7),f.value.forEach(c=>{c.Uploaded=e.computed(()=>c.Files.filter(n=>!n.Deleted).length)})})}),e.provide("editable",xN),(s,c)=>{var B;const n=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oN,[c[12]||(c[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後請款，第一期預撥70%）",-1)),e.createElementVNode("p",nN,"核定經費: "+e.toDisplayString((B=e.unref(d).ApprovedAmount)==null?void 0:B.toLocaleString())+"元",1),e.createElementVNode("div",rN,[e.createElementVNode("table",aN,[c[6]||(c[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",dN,e.toDisplayString(e.unref(N)),1),c[2]||(c[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[3]||(c[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[4]||(c[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),c[5]||(c[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),c[13]||(c[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),c[14]||(c[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",sN,[e.createElementVNode("table",mN,[e.createElementVNode("thead",cN,[e.createElementVNode("tr",null,[c[7]||(c[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),c[8]||(c[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",iN,"狀態")),c[9]||(c[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(C,E)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",pN,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(n,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Title),1)]),_:2},1024)]),C.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:C.Template,style:{width:"140px"},type:"button"},[...c[10]||(c[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,VN)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",fN,[C.Uploaded?(e.openBlock(),e.createElementBlock("span",NN,"已上傳")):(e.openBlock(),e.createElementBlock("span",EN,"尚未上傳"))])),e.createElementVNode("td",null,[C.Multiple||!C.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:o=>a(C,o)},null,8,["onFile"])):e.createCommentVNode("",!0),C.Uploaded?(e.openBlock(),e.createElementBlock("div",bN,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Files,o=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:o},[o.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",kN,[e.createElementVNode("a",{class:"tag-link my-1",download:o.Name,href:e.unref(l)(o.Path)},e.toDisplayString(o.Name),9,gN),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:u=>o.Deleted=!0,type:"button"},[...c[11]||(c[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,uN))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",yN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[0]||(c[0]=C=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[1]||(c[1]=C=>r()),type:"button"},[...c[15]||(c[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},hN={class:"block"},$N={class:"text-teal fw-bold py-3"},CN={class:"table-responsive"},_N={class:"table align-middle gray-table"},TN={class:"text-end"},wN={class:"text-end"},DN={class:"text-end"},FN={class:"text-end"},SN={class:"mt-4"},AN={class:"table align-middle gray-table"},UN={class:"text-center"},MN={key:0,width:"180"},ON={class:"text-center"},IN=["href"],jN={key:0,class:"text-center"},PN={key:0},qN={key:1,class:"text-pink"},LN={key:1,class:"tag-group mt-2 gap-1"},RN={key:0,class:"tag tag-green-light"},zN=["download","href"],GN=["onClick"],JN={class:"block-bottom bg-light-teal"},QN=!0,WN={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(3e4),d=e.ref(0),f=e.ref({}),a=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),l=e.computed(()=>f.value.ApprovedAmount?Math.min(Math.round(N.value*100/f.value.ApprovedAmount*100)/100,100):0),r=e.computed(()=>d.value?Math.min(Math.round(N.value*100/d.value*100)/100,100):0),s=(g,B)=>{B.Type==="application/pdf"&&g.Files.push({Type:g.Type,Path:B.Path,Name:f.value.ProjectID+"_第二期_"+(g.Multiple?B.Name:`${g.Title}.pdf`)})},c=A.download,n=g=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:h.id}).subscribe(g=>{f.value=g.Project,I().init("multiple",f.value),d.value=Math.round(f.value.ApprovedAmount*.7),a.value.forEach(B=>{B.Uploaded=e.computed(()=>B.Files.filter(C=>!C.Deleted).length)})})}),e.provide("editable",QN),(g,B)=>{var u;const C=e.resolveComponent("input-integer"),E=e.resolveComponent("required-label"),o=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hN,[B[9]||(B[9]=e.createElementVNode("h5",{class:"square-title"},"實際請款（於 9/30 前請款，須執行完成第一期款至少60%）（第二期預撥30%）",-1)),e.createElementVNode("p",$N,"核定經費: "+e.toDisplayString((u=e.unref(f).ApprovedAmount)==null?void 0:u.toLocaleString())+"元",1),e.createElementVNode("div",CN,[e.createElementVNode("table",_N,[B[3]||(B[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",TN,e.toDisplayString(e.unref(f).ApprovedAmount-e.unref(d)),1),e.createElementVNode("td",wN,e.toDisplayString(e.unref(d)),1),e.createElementVNode("td",null,[e.createVNode(C,{modelValue:e.unref(N),"onUpdate:modelValue":B[0]||(B[0]=b=>e.isRef(N)?N.value=b:null)},null,8,["modelValue"])]),e.createElementVNode("td",DN,e.toDisplayString(e.unref(l))+"%",1),e.createElementVNode("td",FN,e.toDisplayString(e.unref(r))+"%",1)])])])]),B[10]||(B[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),B[11]||(B[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",SN,[e.createElementVNode("table",AN,[e.createElementVNode("thead",UN,[e.createElementVNode("tr",null,[B[4]||(B[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),B[5]||(B[5]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",MN,"狀態")),B[6]||(B[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(b,i)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",ON,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(E,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024)]),b.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:b.Template,style:{width:"140px"},type:"button"},[...B[7]||(B[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,IN)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",jN,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",PN,"已上傳")):(e.openBlock(),e.createElementBlock("span",qN,"尚未上傳"))])),e.createElementVNode("td",null,[b.Multiple||!b.Uploaded?(e.openBlock(),e.createBlock(o,{key:0,accept:".pdf",onFile:m=>s(b,m)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",LN,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,m=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:m},[m.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",RN,[e.createElementVNode("a",{class:"tag-link my-1",download:m.Name,href:e.unref(c)(m.Path)},e.toDisplayString(m.Name),9,zN),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>m.Deleted=!0,type:"button"},[...B[8]||(B[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,GN))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",JN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:B[1]||(B[1]=b=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:B[2]||(B[2]=b=>n()),type:"button"},[...B[12]||(B[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},YN={class:"block"},HN={class:"text-teal fw-bold py-3"},KN={class:"text-teal fw-bold pb-3"},ZN={class:"table-responsive"},XN={class:"table align-middle gray-table"},vN={class:"text-end"},e1={class:"text-end"},t1={class:"text-end"},l1={class:"mt-4"},o1={class:"table align-middle gray-table"},n1={class:"text-center"},r1={key:0,width:"180"},a1={class:"text-center"},d1=["href"],s1={key:0,class:"text-center"},m1={key:0},c1={key:1,class:"text-pink"},i1={key:1,class:"tag-group mt-2 gap-1"},p1={key:0,class:"tag tag-green-light"},V1=["download","href"],f1=["onClick"],N1={class:"text-center"},E1={colspan:"2"},b1={class:"block-bottom bg-light-teal"},k1=!0,g1={__name:"Payment3",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=e.ref(8e4),d=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),a=e.computed(()=>d.value.ApprovedAmount?Math.min(Math.round(N.value*100/d.value.ApprovedAmount*100)/100,100):0),l=(c,n)=>{n.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:n.Path,Name:d.value.ProjectID+"_結案核銷_"+(c.Multiple?n.Name:`${c.Title}.pdf`)})},r=A.download,s=c=>{};return e.onMounted(()=>{A.multiple("findApplication",{ID:h.id}).subscribe(c=>{d.value=c.Project,I().init("multiple",d.value),f.value.forEach(n=>{n.Uploaded=e.computed(()=>n.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",k1),(c,n)=>{var o;const g=e.resolveComponent("input-integer"),B=e.resolveComponent("required-label"),C=e.resolveComponent("input-file"),E=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",YN,[n[11]||(n[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",HN,"核定經費: "+e.toDisplayString((o=e.unref(d).ApprovedAmount)==null?void 0:o.toLocaleString())+"元",1),e.createElementVNode("p",KN,"賸餘款: "+e.toDisplayString((e.unref(d).ApprovedAmount-e.unref(N)).toLocaleString())+"元",1),e.createElementVNode("div",ZN,[e.createElementVNode("table",XN,[n[4]||(n[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[3]||(n[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",vN,e.toDisplayString(e.unref(d).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(N),"onUpdate:modelValue":n[0]||(n[0]=u=>e.isRef(N)?N.value=u:null)},null,8,["modelValue"])]),e.createElementVNode("td",e1,e.toDisplayString(e.unref(a))+"%",1),e.createElementVNode("td",t1,e.toDisplayString(e.unref(a))+"%",1)])])])]),n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),n[13]||(n[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",l1,[e.createElementVNode("table",o1,[e.createElementVNode("thead",n1,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",r1,"狀態")),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(u,b)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",a1,e.toDisplayString(b+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024)]),u.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:u.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,d1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",s1,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",m1,"已上傳")):(e.openBlock(),e.createElementBlock("span",c1,"尚未上傳"))])),e.createElementVNode("td",null,[u.Multiple||!u.Uploaded?(e.openBlock(),e.createBlock(C,{key:0,accept:".pdf",onFile:i=>l(u,i)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",i1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",p1,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(r)(i.Path)},e.toDisplayString(i.Name),9,V1),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:m=>i.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,f1))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128)),e.createElementVNode("tr",null,[e.createElementVNode("td",N1,e.toDisplayString(e.unref(f).length+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(B,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("其他資料（5分鐘精華影片）",-1)])]),_:1})])]),e.createElementVNode("td",E1,[e.createVNode(E)])])])])])]),e.createElementVNode("div",b1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[1]||(n[1]=u=>s()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[2]||(n[2]=u=>s()),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},u1={__name:"ProgressBar",setup(x){const T=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(h,N)=>{const d=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(d,{steps:T,type:"multiple"})}}},y1={class:"block"},x1={class:"mt-4"},B1={class:"table align-middle gray-table side-table"},h1={key:0,class:"d-flex align-items-center gap-2"},$1={class:"input-group w-auto"},C1={class:"text-teal-dark"},_1={key:1,class:"invalid mt-0"},T1={class:"table-responsive mt-4"},w1={class:"table align-middle gray-table"},D1={key:0},F1={class:"input-group"},S1={key:0,class:"invalid mt-0"},A1={key:0},U1={class:"d-flex gap-2"},M1=["onClick"],O1={class:"mt-4"},I1={class:"table align-middle gray-table"},j1={key:0},P1={key:0},q1={class:"d-flex gap-2"},L1=["onClick"],R1={class:"mt-4"},z1={class:"table align-middle gray-table side-table"},G1={key:0,class:"block-bottom bg-light-teal"},J1={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x,N=[{value:1,text:"50%"},{value:2,text:"100%"}],d=e.ref(),f=e.computed(()=>n.value.EndDate),a=e.computed(()=>z("multiple",c.value.Status,2)),l=e.ref({}),r=e.computed(()=>g.value.filter(V=>!V.Deleted)),s=e.computed(()=>B.value.filter(V=>!V.Deleted)),c=e.ref({}),n=e.ref({}),g=e.ref([]),B=e.ref([]),C=()=>A.multiple("createItem",{ID:h.id}).subscribe(V=>g.value.push(V)),E=()=>B.value.push({Type:0,ItemID:0}),o=T,u=()=>{rxjs.forkJoin([A.multiple("getWorkSchedule",{ID:h.id})]).subscribe(V=>{const t=V[0];c.value=t.Project,n.value=t.GrantType,g.value=t.Items,B.value=t.Schedules,g.value.length||C(),B.value.length||E(),I().init("multiple",c.value),d.value=c.value.changeApply,c.value.changeApply=void 0})},b=V=>V.Deleted=!0,i=V=>{var p,k;if(l.value={},V&&!m()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:c.value,Items:g.value,Schedules:B.value,Before:(p=d.value)==null?void 0:p.Form2Before,After:(k=d.value)==null?void 0:k.Form2After,Submit:V?"true":"false"};A.multiple("saveWorkSchedule",t).subscribe(()=>{V?o("next"):u()})},m=()=>{let V={StartTime:"計畫期程",EndTime:"計畫期程"};return l.value=O(c.value,V),V={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},r.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`item-${p}-`))),V={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},s.value.forEach((t,p)=>Object.assign(l.value,O(t,V,`schedule-${p}-`))),d.value&&(V={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(l.value,O(d.value,V))),!Object.keys(l.value).length};return e.onMounted(u),e.provide("editable",a),(V,t)=>{const p=e.resolveComponent("required-label"),k=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),S=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),F=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",y1,[t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",x1,[e.createElementVNode("table",B1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",h1,[e.createElementVNode("div",$1,[e.createVNode(k,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[0]||(t[0]=y=>e.unref(c).StartTime=y)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[1]||(t[1]=y=>e.unref(c).EndTime=y)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",C1,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(f)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(l).StartTime||e.unref(l).EndTime?(e.openBlock(),e.createElementBlock("div",_1,e.toDisplayString(e.unref(l).StartTime||e.unref(l).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",T1,[e.createElementVNode("table",w1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",D1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+_)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(l)[`item-${_}-Title`],modelValue:y.Title,"onUpdate:modelValue":D=>y.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",F1,[e.createVNode(S,{"empty-value":0,modelValue:y.Begin,"onUpdate:modelValue":D=>y.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(S,{"empty-value":0,modelValue:y.End,"onUpdate:modelValue":D=>y.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(l)[`item-${_}-Begin`]||e.unref(l)[`item-${_}-End`]?(e.openBlock(),e.createElementBlock("div",S1,e.toDisplayString(e.unref(l)[`item-${_}-Begin`]||e.unref(l)[`item-${_}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`item-${_}-Deadline`],modelValue:y.Deadline,"onUpdate:modelValue":D=>y.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`item-${_}-Content`],rows:"1",modelValue:y.Content,"onUpdate:modelValue":D=>y.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",A1,[e.createElementVNode("div",U1,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(y),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,M1)):e.createCommentVNode("",!0),_+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:C,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[29]||(t[29]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",O1,[e.createElementVNode("table",I1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[21]||(t[21]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("th",j1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(y,_)=>(e.openBlock(),e.createElementBlock("tr",{key:y},[e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${_}-Type`],options:N,modelValue:y.Type,"onUpdate:modelValue":D=>y.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(F,{"empty-value":0,error:e.unref(l)[`schedule-${_}-ItemID`],options:e.unref(r),"text-name":"Title","value-name":"ID",modelValue:y.ItemID,"onUpdate:modelValue":D=>y.ItemID=D,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(y.ItemID?String.fromCharCode(65+e.unref(r).findIndex(D=>D.ID===y.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(l)[`schedule-${_}-Deadline`],modelValue:y.Deadline,"onUpdate:modelValue":D=>y.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l)[`schedule-${_}-Content`],rows:"1",modelValue:y.Content,"onUpdate:modelValue":D=>y.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("td",P1,[e.createElementVNode("div",q1,[e.unref(s).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>b(y),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,L1)):e.createCommentVNode("",!0),_+1===e.unref(s).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:E,type:"button"},[...t[23]||(t[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",R1,[e.createElementVNode("table",z1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2Before,rows:"4",modelValue:e.unref(d).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=y=>e.unref(d).Form2Before=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(p,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(l).Form2After,rows:"4",modelValue:e.unref(d).Form2After,"onUpdate:modelValue":t[3]||(t[3]=y=>e.unref(d).Form2After=y),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",G1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=y=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=y=>i(!0)),type:"button"},[...t[30]||(t[30]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Q1={key:0,class:"scroll-bottom-panel"},W1={class:"d-flex flex-column gap-3 mb-3"},Y1={class:"d-flex gap-2"},H1={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},K1={class:"text-nowrap my-2 d-flex align-items-center"},Z1={__name:"ProjectChangeReview",props:{id:{type:[Number,String]},type:{type:String}},setup(x){const T=x,h=I(),N=[{value:1,text:"通過"},{value:2,text:"退回修改"}],d=e.ref({}),f=e.ref({ID:T.id,Result:1}),a=()=>{const r={};if(f.value.Result>1&&(r.Reason="原因"),d.value=O(f.value,r),Object.keys(d.value).length){l();return}A[T.type]("reviewApplicationChange",f.value).subscribe(s=>{s&&(window.location.href="../ReviewChecklist.aspx?type=5")})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,r=>{r>1&&l()}),(r,s)=>{const c=e.resolveComponent("input-radio-group"),n=e.resolveComponent("input-textarea");return e.unref(h)[x.type].organizer?(e.openBlock(),e.createElementBlock("div",Q1,[s[3]||(s[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",W1,[e.createElementVNode("li",Y1,[s[2]||(s[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",H1,[e.createElementVNode("div",K1,[e.createVNode(c,{options:N,modelValue:e.unref(f).Result,"onUpdate:modelValue":s[0]||(s[0]=g=>e.unref(f).Result=g)},null,8,["modelValue"])]),e.unref(f).Result>1?(e.openBlock(),e.createBlock(n,{key:0,error:e.unref(d).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":s[1]||(s[1]=g=>e.unref(f).Reason=g)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:a,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},X1={key:0,class:"scroll-bottom-panel"},v1={class:"d-flex flex-column gap-3 mb-3"},eE={class:"d-flex gap-2"},tE={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},lE={class:"text-nowrap my-2 d-flex align-items-center"},oE={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(x){const T=x,h=I(),N=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],d=e.ref({}),f=e.ref({ID:T.id,Result:1}),a=()=>{const r={};if(f.value.Result>1&&(r.Reason="原因"),d.value=O(f.value,r),Object.keys(d.value).length){l();return}A[T.type]("reviewApplication",f.value).subscribe(s=>{s&&(window.location.href="../ReviewChecklist.aspx?type=4")})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,r=>{r>1&&l()}),(r,s)=>{const c=e.resolveComponent("input-radio-group"),n=e.resolveComponent("input-textarea");return e.unref(h)[x.type].organizer?(e.openBlock(),e.createElementBlock("div",X1,[s[3]||(s[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",v1,[e.createElementVNode("li",eE,[s[2]||(s[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",tE,[e.createElementVNode("div",lE,[e.createVNode(c,{options:N,modelValue:e.unref(f).Result,"onUpdate:modelValue":s[0]||(s[0]=g=>e.unref(f).Result=g)},null,8,["modelValue"])]),e.unref(f).Result>1?(e.openBlock(),e.createBlock(n,{key:0,error:e.unref(d).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":s[1]||(s[1]=g=>e.unref(f).Reason=g)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:a,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},nE={class:"d-flex align-items-center gap-3"},rE={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},aE={class:"modal-content"},dE={class:"modal-header"},sE={class:"fs-24 fw-bold text-green-light"},mE={class:"modal-body"},cE={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},iE=["disabled"],pE={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(x){const T=x,h=e.computed(()=>!f.value||f.value===l[T.type].organizer),N=e.ref(),d=e.computed(()=>l[T.type].organizerName),f=e.ref(0),a=e.computed(()=>{var B;return(B=c.value.find(C=>C.UnitID===s.value))==null?void 0:B.reviewers}),l=I(),r=e.computed(()=>d.value?"移轉案件":"認領案件"),s=e.ref(0),c=e.ref([]),n=()=>{A[T.type]("queryReviewUnits").subscribe(B=>{c.value=B,rxjs.forkJoin(c.value.map(C=>A[T.type]("queryReviewersByUnit",{ID:C.UnitID}))).subscribe(C=>{C.forEach((E,o)=>{c.value[o].reviewers=E,E.some(u=>u.UserID===f.value)&&(s.value=c.value[o].UnitID)}),bootstrap.Modal.getOrCreateInstance(N.value).show()})})},g=()=>{A[T.type]("saveOrganizer",{ID:T.id,Organizer:f.value}).subscribe(B=>{B&&window.location.reload()})};return e.watch(d,()=>f.value=l[T.type].organizer),e.watch(s,()=>{a.value.some(B=>B.UserID===f.value)||(f.value=0)}),(B,C)=>{const E=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nE,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(d)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:n,type:"button"},e.toDisplayString(e.unref(r)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:N,tabindex:"-1"},[e.createElementVNode("div",rE,[e.createElementVNode("div",aE,[e.createElementVNode("div",dE,[e.createElementVNode("h4",sE,e.toDisplayString(e.unref(r)),1),C[2]||(C[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",mE,[e.createElementVNode("div",null,[C[3]||(C[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(E,{"empty-value":0,options:e.unref(c),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(s),"onUpdate:modelValue":C[0]||(C[0]=o=>e.isRef(s)?s.value=o:null)},null,8,["options","modelValue"]),e.createVNode(E,{class:"mt-2","empty-value":0,options:e.unref(a),"text-name":"Name","value-name":"UserID",modelValue:e.unref(f),"onUpdate:modelValue":C[1]||(C[1]=o=>e.isRef(f)?f.value=o:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",cE,[C[4]||(C[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:g,disabled:e.unref(h),type:"button"},"確認",8,iE)])])])])],512)]))],64)}}},VE={class:"step-line-wrapper"},fE={class:"step-line"},NE={key:0,class:"tag tag-white"},EE={key:1,class:"tag tag-white"},bE={key:0,class:"step-line"},kE={key:0,class:"tag tag-white"},gE={class:"step-line"},uE={key:0,class:"tag tag-white"},yE={key:0,class:"tag tag-white"},xE={__name:"ProjectProgress",props:{excludes:{default:[],type:Array},id:{type:[Number,String]},step:{required:!0,type:Number},type:{required:!0,type:String}},setup(x){const T=I(),h=x,N=d=>{location.href=`${d}.aspx?ID=${h.id}`};return(d,f)=>(e.openBlock(),e.createElementBlock("div",VE,[e.createElementVNode("div",fE,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===1}]),onClick:f[0]||(f[0]=a=>N("Audit")),role:"button"},[f[4]||(f[4]=e.createElementVNode("div",{class:"step-line-item-title"},"核定計畫",-1)),x.step===1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[[1,4].includes(e.unref(T)[h.type].changeStatus)?(e.openBlock(),e.createElementBlock("div",NE,"編輯中")):e.unref(T)[h.type].changeStatus===2?(e.openBlock(),e.createElementBlock("div",EE,"審核中")):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],2)]),x.excludes.includes(4)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",bE,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===4}]),onClick:f[1]||(f[1]=a=>N("Progress")),role:"button"},[f[5]||(f[5]=e.createElementVNode("div",{class:"step-line-item-title"},"每月進度",-1)),x.step===4?(e.openBlock(),e.createElementBlock("div",kE,"編輯中")):e.createCommentVNode("",!0)],2)])),e.createElementVNode("div",gE,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===5}]),onClick:f[2]||(f[2]=a=>N("Report")),role:"button"},[f[6]||(f[6]=e.createElementVNode("div",{class:"step-line-item-title"},"階段報告",-1)),x.step===5?(e.openBlock(),e.createElementBlock("div",uE,"編輯中")):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:x.step===6}]),onClick:f[3]||(f[3]=a=>N("Payment")),role:"button"},[f[7]||(f[7]=e.createElementVNode("div",{class:"step-line-item-title"},"請款核銷",-1)),x.step===6?(e.openBlock(),e.createElementBlock("div",yE,"編輯中")):e.createCommentVNode("",!0)],2)])]))}},BE={class:"block"},hE={class:"square-title"},$E=["innerHTML"],CE={class:"table-responsive mt-3"},_E={class:"table align-middle gray-table"},TE={class:"text-center"},wE=["href"],DE={key:0,class:"text-center"},FE={key:0},SE={key:1,class:"text-pink"},AE={key:1,class:"tag-group mt-2 gap-1"},UE={key:0,class:"tag tag-green-light"},ME=["download","href"],OE=["onClick"],IE={key:0,class:"block-bottom bg-light-teal"},jE=!0,PE={__name:"ProjectReport",props:{data:{required:!0,type:Object},id:{type:[Number,String]}},emits:["next"],setup(x,{emit:T}){const h=x;e.computed(()=>N.value.some(r=>!r.Optional&&!r.Files.filter(s=>!s.Deleted).length));const N=e.ref(h.data.docs.map(r=>({...r,Files:[]})));e.ref({});const d=(r,s)=>{s.Type==="application/zip"&&r.Files.push({Type:r.Type,Path:s.Path,Name:h.id+"_"+(r.Multiple?s.Name:`${r.Title}.zip`)})},f=A.download,a=()=>{N.value.forEach(r=>{r.Uploaded=e.computed(()=>r.Files.filter(s=>!s.Deleted).length)})},l=r=>{};return e.onMounted(a),e.provide("editable",jE),(r,s)=>{const c=e.resolveComponent("required-label"),n=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",BE,[e.createElementVNode("h5",hE,e.toDisplayString(x.data.subtitle),1),e.createElementVNode("p",{class:"text-pink mt-3 lh-base",innerHTML:x.data.description},null,8,$E),e.createElementVNode("div",CE,[e.createElementVNode("table",_E,[s[4]||(s[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"70",class:"text-center"},"附件編號"),e.createElementVNode("th",null,"附件名稱"),e.createElementVNode("th",{class:"text-center"},"狀態"),e.createElementVNode("th",null,"上傳附件")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(N),(g,B)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",TE,e.toDisplayString(B+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Title),1)]),_:2},1024)]),g.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:g.Template,style:{width:"140px"},type:"button"},[...s[2]||(s[2]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,wE)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",DE,[g.Uploaded?(e.openBlock(),e.createElementBlock("span",FE,"已上傳")):(e.openBlock(),e.createElementBlock("span",SE,"尚未上傳"))])),e.createElementVNode("td",null,[g.Multiple||!g.Uploaded?(e.openBlock(),e.createBlock(n,{key:0,accept:".zip",onFile:C=>d(g,C)},null,8,["onFile"])):e.createCommentVNode("",!0),g.Uploaded?(e.openBlock(),e.createElementBlock("div",AE,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.Files,C=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:C},[C.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",UE,[e.createElementVNode("a",{class:"tag-link my-1",download:C.Name,href:e.unref(f)(C.Path)},e.toDisplayString(C.Name),9,ME),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:E=>C.Deleted=!0,type:"button"},[...s[3]||(s[3]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,OE))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),(e.openBlock(),e.createElementBlock("div",IE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=g=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=g=>l()),type:"button"},[...s[5]||(s[5]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])]))],64)}}},qE={key:0,class:"scroll-bottom-panel"},LE={class:"d-flex flex-column gap-3 mb-3"},RE={class:"d-flex gap-2"},zE={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},GE={class:"text-nowrap mb-2 d-flex align-items-center"},JE={key:0,class:"invalid mt-0"},QE={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(x){const T=x,h=I(),N=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],d=e.ref({}),f=e.ref({ID:T.id,Result:1}),a=()=>{},l=()=>{},r=()=>{const c={};if(f.value.Result>1&&(c.Reason="原因"),f.value.Result===3&&(c.CorrectionDeadline="補正期限"),d.value=O(f.value,c),Object.keys(d.value).length){s();return}A[T.type]("reviewApplication",f.value).subscribe(n=>{n&&(window.location.href="../ReviewChecklist.aspx?type=1")})},s=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,c=>{c>1&&s()}),(c,n)=>{const g=e.resolveComponent("input-radio-group"),B=e.resolveComponent("input-tw-date"),C=e.resolveComponent("input-textarea");return e.unref(h)[x.type].organizer?(e.openBlock(),e.createElementBlock("div",qE,[n[9]||(n[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",LE,[e.createElementVNode("li",{class:"d-flex gap-2"},[n[3]||(n[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:a,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[n[6]||(n[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),n[7]||(n[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[n[4]||(n[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:l,href:"javascript:void(0)"},"1"),n[5]||(n[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",RE,[n[8]||(n[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",zE,[e.createElementVNode("div",GE,[e.createVNode(g,{options:N,modelValue:e.unref(f).Result,"onUpdate:modelValue":n[0]||(n[0]=E=>e.unref(f).Result=E)},null,8,["modelValue"]),e.createVNode(B,{class:"form-control",drops:"up",modelValue:e.unref(f).CorrectionDeadline,"onUpdate:modelValue":n[1]||(n[1]=E=>e.unref(f).CorrectionDeadline=E)},null,8,["modelValue"])]),e.unref(d).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",JE,e.toDisplayString(e.unref(d).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(f).Result>1?(e.openBlock(),e.createBlock(C,{key:1,error:e.unref(d).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":n[2]||(n[2]=E=>e.unref(f).Reason=E)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},WE={class:"top-wrapper"},YE={class:"top-block"},HE={class:"d-flex align-items-center gap-3"},KE={__name:"ProjectTitle",props:{id:{type:[Number,String]},type:{type:String}},setup(x){const T=x,h=I();return(N,d)=>(e.openBlock(),e.createElementBlock("div",WE,[e.createElementVNode("div",YE,[e.createElementVNode("div",HE,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(h)[T.type].type)+"］"+e.toDisplayString(e.unref(h)[T.type].id)+"/"+e.toDisplayString(e.unref(h)[T.type].name),1)]),d[0]||(d[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},ZE={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},XE={class:"d-flex gap-2"},vE={key:0,class:"btn text-teal-dark",type:"button"},eb={class:"d-flex gap-2"},tb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},lb={class:"modal-content"},ob={class:"modal-body"},nb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},rb={class:"modal-content"},ab={class:"modal-body"},db={class:"d-flex flex-column gap-4 mb-5"},sb={class:"d-flex align-items-center"},mb={class:"flex-grow-1"},cb={__name:"ProjectToolbar",props:{id:{type:[Number,String]},type:{type:String}},setup(x){const T=I(),h=x,N=e.ref({}),d=e.ref(),f=e.ref({}),a=e.ref(),l=e.ref({}),r=e.ref(),s=()=>{const C={Reason:"計畫變更原因"};f.value=O(N.value,C),!Object.keys(f.value).length&&A[h.type]("applyChange",N.value).subscribe(E=>{E&&location.reload()})},c=()=>{N.value={ID:h.id},bootstrap.Modal.getOrCreateInstance(d.value).show()},n=()=>{bootstrap.Modal.getOrCreateInstance(a.value).show()},g=()=>{l.value={ID:h.id},bootstrap.Modal.getOrCreateInstance(r.value).show()},B=()=>{const C={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};f.value=O(l.value,C),!Object.keys(f.value).length&&A[h.type]("terminate",l.value).subscribe(E=>{E&&(location.href="../ApplicationChecklist.aspx")})};return(C,E)=>{const o=e.resolveComponent("project-organizer"),u=e.resolveComponent("input-textarea"),b=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ZE,[e.createElementVNode("div",XE,[e.unref(T)[h.type].changeStatus?(e.openBlock(),e.createElementBlock("button",vE," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:c,type:"button"}," 計畫變更申請 ")),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:n,type:"button"},[...E[3]||(E[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])]),E[4]||(E[4]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-download"}),e.createTextVNode(" 下載核定計畫書 ")],-1))]),e.createElementVNode("div",eb,[e.createVNode(o,{id:x.id,type:x.type},null,8,["id","type"]),e.createElementVNode("button",{class:"btn btn-pink",onClick:g,type:"button"}," 計畫終止 ")])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:d,tabindex:"-1"},[e.createElementVNode("div",tb,[e.createElementVNode("div",lb,[E[8]||(E[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",ob,[E[6]||(E[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),E[7]||(E[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(u,{error:e.unref(f).Reason,modelValue:e.unref(N).Reason,"onUpdate:modelValue":E[0]||(E[0]=i=>e.unref(N).Reason=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[E[5]||(E[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:s},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:a,tabindex:"-1"},[...E[9]||(E[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:r,tabindex:"-1"},[e.createElementVNode("div",nb,[e.createElementVNode("div",rb,[E[14]||(E[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",ab,[e.createElementVNode("div",db,[e.createElementVNode("div",null,[E[10]||(E[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(u,{error:e.unref(f).RejectReason,modelValue:e.unref(l).RejectReason,"onUpdate:modelValue":E[1]||(E[1]=i=>e.unref(l).RejectReason=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),E[12]||(E[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",sb,[E[11]||(E[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",mb,[e.createVNode(b,{error:e.unref(f).RecoveryAmount,modelValue:e.unref(l).RecoveryAmount,"onUpdate:modelValue":E[2]||(E[2]=i=>e.unref(l).RecoveryAmount=i),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[E[13]||(E[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:B},"送出")])])])])],512)]))],64)}}},ib={key:0,class:"text-pink"},le={AccessibilityApplication:ve,AccessibilityAttachment:yt,AccessibilityBenefit:Mt,AccessibilityFunding:ml,AccessibilityPayment1:Fl,AccessibilityPayment2:eo,AccessibilityProgressBar:to,AccessibilityWorkSchedule:_o,ConfirmModal:Ao,CommonProgressBar:qo,CultureApplication:$n,CultureAttachment:Wn,CultureFunding:ur,CultureOther:Or,CulturePayment1:na,CulturePayment2:_a,CultureProgress:Qa,CultureProgressBar:Wa,CultureWorkSchedule:qd,EducationApplication:Ss,EducationAttachment:em,EducationPayment:hm,EducationProgressBar:$m,ErrorModal:Fm,InputBoolean:Sm,InputFile:Am,InputInteger:Om,InputMonth:Im,InputRadioGroup:qm,InputSelect:Jm,InputText:Km,InputTextarea:tc,InputTwDate:nc,LiteracyApplication:jc,LiteracyAttachment:ai,LiteracyBenefit:ui,LiteracyFunding:Yi,LiteracyPayment1:Np,LiteracyPayment2:Pp,LiteracyProgressBar:qp,LiteracyWorkSchedule:iV,MultipleApplication:JV,MultipleAttachment:ff,MultipleBenefit:Tf,MultipleFunding:lN,MultiplePayment1:BN,MultiplePayment2:WN,MultiplePayment3:g1,MultipleProgressBar:u1,MultipleWorkSchedule:J1,ProjectChangeReview:Z1,ProjectCorrectionReview:oE,ProjectOrganizer:pE,ProjectProgress:xE,ProjectReport:PE,ProjectReview:QE,ProjectTitle:KE,ProjectToolbar:cb,RequiredLabel:{__name:"RequiredLabel",setup(x){const T=e.inject("editable",!0);return(h,N)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(T)?(e.openBlock(),e.createElementBlock("span",ib,"* ")):e.createCommentVNode("",!0),e.renderSlot(h.$slots,"default")],64))}},TwDate:{__name:"TwDate",props:{value:{default:null,type:String}},setup(x){const T=x,h=d=>{const f=d==null?void 0:d.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return f?`${parseInt(f[1],10)-1911}/${f[2]}/${f[3]}`:""},N=e.ref(h(T.value));return e.watch(()=>T.value,d=>N.value=h(d)),(d,f)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(N)),1))}}};return{api:A,install:x=>{for(const T in le)x.component(T,le[T])},useProgressStore:I}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
