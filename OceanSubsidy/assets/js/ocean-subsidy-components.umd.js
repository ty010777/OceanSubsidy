(function(e,Q){typeof exports=="object"&&typeof module<"u"?module.exports=Q(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],Q):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=Q(e.Vue,e.Pinia))})(this,(function(e,Q){"use strict";const j=Q.defineStore("progress",{actions:{init(B,_,x){var p,s;this[B]={id:_.ProjectID,type:(p=_.SubsidyPlanType)==null?void 0:p.split(" ")[0],name:_.ProjectName,step:_.FormStep,status:_.Status,progress:_.ProgressStatus,changeStatus:(s=_.changeApply)==null?void 0:s.Status,reportStatus:x==null?void 0:x.Status,organizer:_.Organizer,organizerName:_.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})});let ne=Date.now();const z=(B,_,x)=>{const p=j();if([1,14].includes(p[B].status)||[1,4].includes(p[B].changeStatus))return!0;if(p[B].status===42)switch(B){case"culture":if([2,3,5].includes(x))return!0;break;case"multiple":if([2,3,4,5].includes(x))return!0;break;case"accessibility":if([2,3,4,5].includes(x))return!0;break}return!1},re=()=>`id--${ne++}`,R=B=>parseInt(B)||0,Z=Q.defineStore("message",{state:()=>({error:null})}),{ajax:ae}=rxjs.ajax,{map:de}=rxjs;let K="";const se=(B,_={})=>Y("Service/OFS/Accessibility.ashx",{method:B,param:_}),ce=(B,_={})=>Y("Service/OFS/Culture.ashx",{method:B,param:_}),ie=B=>`${K}/Service/OFS/Download.ashx?path=${B}`,me=(B,_={})=>Y("Service/OFS/Education.ashx",{method:B,param:_}),pe=(B,_={})=>Y("Service/OFS/Literacy.ashx",{method:B,param:_}),Ve=(B,_={})=>Y("Service/OFS/Multiple.ashx",{method:B,param:_}),fe=({response:B,status:_})=>{if(_===200){if(B.success)return B.data;Z().error=B.message}},Y=(B,_={})=>{const x={};_.constructor!==FormData&&(x["Content-Type"]="application/json");const p={body:_,headers:x,method:"POST",url:`${K}/${B}`};return ae(p).pipe(de(fe))},F=Object.assign(Y,{accessibility:se,culture:ce,download:ie,education:me,literacy:pe,multiple:Ve,setBaseUrl:B=>K=B,system:(B,_={})=>Y("Service/OFS/System.ashx",{method:B,param:_}),upload:B=>{const _=new FormData;return _.append("file",B),Y("Service/OFS/Upload.ashx",_)}});function Ne(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}var W={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var Ee=W.exports,v;function be(){return v||(v=1,(function(B,_){(function(x,p,s){var f=function(o,l,c){c=r.extend({},r.options,c);var m=r.runValidations(o,l,c);if(m.some(function(a){return r.isPromise(a.error)}))throw new Error("Use validate.async if you want support for promises");return f.processValidationResults(m,c)},r=f;r.extend=function(o){return[].slice.call(arguments,1).forEach(function(l){for(var c in l)o[c]=l[c]}),o},r.extend(f,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var o=r.format("%{major}.%{minor}.%{patch}",r.version);return r.isEmpty(r.version.metadata)||(o+="+"+r.version.metadata),o}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(o,l,c){var m=[],a,y,u,g,d,n,k;(r.isDomElement(o)||r.isJqueryElement(o))&&(o=r.collectFormValues(o));for(a in l){u=r.getDeepObjectValue(o,a),g=r.result(l[a],u,o,a,c,l);for(y in g){if(d=r.validators[y],!d)throw k=r.format("Unknown validator %{name}",{name:y}),new Error(k);n=g[y],n=r.result(n,u,o,a,c,l),n&&m.push({attribute:a,value:u,validator:y,globalOptions:c,attributes:o,options:n,error:d.call(d,u,n,a,o,c)})}}return m},processValidationResults:function(o,l){o=r.pruneEmptyErrors(o,l),o=r.expandMultipleErrors(o,l),o=r.convertErrorMessages(o,l);var c=l.format||"grouped";if(typeof r.formatters[c]=="function")o=r.formatters[c](o);else throw new Error(r.format("Unknown format %{format}",l));return r.isEmpty(o)?void 0:o},async:function(o,l,c){c=r.extend({},r.async.options,c);var m=c.wrapErrors||function(y){return y};c.cleanAttributes!==!1&&(o=r.cleanAttributes(o,l));var a=r.runValidations(o,l,c);return new r.Promise(function(y,u){r.waitForResults(a).then(function(){var g=r.processValidationResults(a,c);g?u(new m(g,c,o,l)):y(o)},function(g){u(g)})})},single:function(o,l,c){return c=r.extend({},r.single.options,c,{format:"flat",fullMessages:!1}),r({single:o},{single:l},c)},waitForResults:function(o){return o.reduce(function(l,c){return r.isPromise(c.error)?l.then(function(){return c.error.then(function(m){c.error=m||null})}):l},new r.Promise(function(l){l()}))},result:function(o){var l=[].slice.call(arguments,1);return typeof o=="function"&&(o=o.apply(null,l)),o},isNumber:function(o){return typeof o=="number"&&!isNaN(o)},isFunction:function(o){return typeof o=="function"},isInteger:function(o){return r.isNumber(o)&&o%1===0},isBoolean:function(o){return typeof o=="boolean"},isObject:function(o){return o===Object(o)},isDate:function(o){return o instanceof Date},isDefined:function(o){return o!=null},isPromise:function(o){return!!o&&r.isFunction(o.then)},isJqueryElement:function(o){return o&&r.isString(o.jquery)},isDomElement:function(o){return!o||!o.querySelectorAll||!o.querySelector?!1:r.isObject(document)&&o===document?!0:typeof HTMLElement=="object"?o instanceof HTMLElement:o&&typeof o=="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName=="string"},isEmpty:function(o){var l;if(!r.isDefined(o))return!0;if(r.isFunction(o))return!1;if(r.isString(o))return r.EMPTY_STRING_REGEXP.test(o);if(r.isArray(o))return o.length===0;if(r.isDate(o))return!1;if(r.isObject(o)){for(l in o)return!1;return!0}return!1},format:r.extend(function(o,l){return r.isString(o)?o.replace(r.format.FORMAT_REGEXP,function(c,m,a){return m==="%"?"%{"+a+"}":String(l[a])}):o},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(o){return r.isNumber(o)?o*100%1===0?""+o:parseFloat(Math.round(o*100)/100).toFixed(2):r.isArray(o)?o.map(function(l){return r.prettify(l)}).join(", "):r.isObject(o)?r.isDefined(o.toString)?o.toString():JSON.stringify(o):(o=""+o,o.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(l,c,m){return""+c+" "+m.toLowerCase()}).toLowerCase())},stringifyValue:function(o,l){var c=l&&l.prettify||r.prettify;return c(o)},isString:function(o){return typeof o=="string"},isArray:function(o){return{}.toString.call(o)==="[object Array]"},isHash:function(o){return r.isObject(o)&&!r.isArray(o)&&!r.isFunction(o)},contains:function(o,l){return r.isDefined(o)?r.isArray(o)?o.indexOf(l)!==-1:l in o:!1},unique:function(o){return r.isArray(o)?o.filter(function(l,c,m){return m.indexOf(l)==c}):o},forEachKeyInKeypath:function(o,l,c){if(r.isString(l)){var m="",a,y=!1;for(a=0;a<l.length;++a)switch(l[a]){case".":y?(y=!1,m+="."):(o=c(o,m,!1),m="");break;case"\\":y?(y=!1,m+="\\"):y=!0;break;default:y=!1,m+=l[a];break}return c(o,m,!0)}},getDeepObjectValue:function(o,l){if(r.isObject(o))return r.forEachKeyInKeypath(o,l,function(c,m){if(r.isObject(c))return c[m]})},collectFormValues:function(o,l){var c={},m,a,y,u,g,d;if(r.isJqueryElement(o)&&(o=o[0]),!o)return c;for(l=l||{},u=o.querySelectorAll("input[name], textarea[name]"),m=0;m<u.length;++m)if(y=u.item(m),!r.isDefined(y.getAttribute("data-ignored"))){var n=y.name.replace(/\./g,"\\\\.");d=r.sanitizeFormValue(y.value,l),y.type==="number"?d=d?+d:null:y.type==="checkbox"?y.attributes.value?y.checked||(d=c[n]||null):d=y.checked:y.type==="radio"&&(y.checked||(d=c[n]||null)),c[n]=d}for(u=o.querySelectorAll("select[name]"),m=0;m<u.length;++m)if(y=u.item(m),!r.isDefined(y.getAttribute("data-ignored"))){if(y.multiple){d=[];for(a in y.options)g=y.options[a],g&&g.selected&&d.push(r.sanitizeFormValue(g.value,l))}else{var k=typeof y.options[y.selectedIndex]<"u"?y.options[y.selectedIndex].value:"";d=r.sanitizeFormValue(k,l)}c[y.name]=d}return c},sanitizeFormValue:function(o,l){return l.trim&&r.isString(o)&&(o=o.trim()),l.nullify!==!1&&o===""?null:o},capitalize:function(o){return r.isString(o)?o[0].toUpperCase()+o.slice(1):o},pruneEmptyErrors:function(o){return o.filter(function(l){return!r.isEmpty(l.error)})},expandMultipleErrors:function(o){var l=[];return o.forEach(function(c){r.isArray(c.error)?c.error.forEach(function(m){l.push(r.extend({},c,{error:m}))}):l.push(c)}),l},convertErrorMessages:function(o,l){l=l||{};var c=[],m=l.prettify||r.prettify;return o.forEach(function(a){var y=r.result(a.error,a.value,a.attribute,a.options,a.attributes,a.globalOptions);if(!r.isString(y)){c.push(a);return}y[0]==="^"?y=y.slice(1):l.fullMessages!==!1&&(y=r.capitalize(m(a.attribute))+" "+y),y=y.replace(/\\\^/g,"^"),y=r.format(y,{value:r.stringifyValue(a.value,l)}),c.push(r.extend({},a,{error:y}))}),c},groupErrorsByAttribute:function(o){var l={};return o.forEach(function(c){var m=l[c.attribute];m?m.push(c):l[c.attribute]=[c]}),l},flattenErrorsToArray:function(o){return o.map(function(l){return l.error}).filter(function(l,c,m){return m.indexOf(l)===c})},cleanAttributes:function(o,l){function c(y,u,g){return r.isObject(y[u])?y[u]:y[u]=g?!0:{}}function m(y){var u={},g;for(g in y)y[g]&&r.forEachKeyInKeypath(u,g,c);return u}function a(y,u){if(!r.isObject(y))return y;var g=r.extend({},y),d,n;for(n in y)d=u[n],r.isObject(d)?g[n]=a(g[n],d):d||delete g[n];return g}return!r.isObject(l)||!r.isObject(o)?{}:(l=m(l),a(o,l))},exposeModule:function(o,l,c,m,a){c?(m&&m.exports&&(c=m.exports=o),c.validate=o):(l.validate=o,o.isFunction(a)&&a.amd&&a([],function(){return o}))},warn:function(o){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+o)},error:function(o){typeof console<"u"&&console.error&&console.error("[validate.js] "+o)}}),f.validators={presence:function(o,l){if(l=r.extend({},this.options,l),l.allowEmpty!==!1?!r.isDefined(o):r.isEmpty(o))return l.message||this.message||"can't be blank"},length:function(o,l,c){if(r.isDefined(o)){l=r.extend({},this.options,l);var m=l.is,a=l.maximum,y=l.minimum,u=l.tokenizer||function(k){return k},g,d=[];o=u(o);var n=o.length;if(!r.isNumber(n))return l.message||this.notValid||"has an incorrect length";if(r.isNumber(m)&&n!==m&&(g=l.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",d.push(r.format(g,{count:m}))),r.isNumber(y)&&n<y&&(g=l.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",d.push(r.format(g,{count:y}))),r.isNumber(a)&&n>a&&(g=l.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",d.push(r.format(g,{count:a}))),d.length>0)return l.message||d}},numericality:function(o,l,c,m,a){if(r.isDefined(o)){l=r.extend({},this.options,l);var y=[],u,g,d={greaterThan:function(V,E){return V>E},greaterThanOrEqualTo:function(V,E){return V>=E},equalTo:function(V,E){return V===E},lessThan:function(V,E){return V<E},lessThanOrEqualTo:function(V,E){return V<=E},divisibleBy:function(V,E){return V%E===0}},n=l.prettify||a&&a.prettify||r.prettify;if(r.isString(o)&&l.strict){var k="^-?(0|[1-9]\\d*)";if(l.onlyInteger||(k+="(\\.\\d+)?"),k+="$",!new RegExp(k).test(o))return l.message||l.notValid||this.notValid||this.message||"must be a valid number"}if(l.noStrings!==!0&&r.isString(o)&&!r.isEmpty(o)&&(o=+o),!r.isNumber(o))return l.message||l.notValid||this.notValid||this.message||"is not a number";if(l.onlyInteger&&!r.isInteger(o))return l.message||l.notInteger||this.notInteger||this.message||"must be an integer";for(u in d)if(g=l[u],r.isNumber(g)&&!d[u](o,g)){var i="not"+r.capitalize(u),N=l[i]||this[i]||this.message||"must be %{type} %{count}";y.push(r.format(N,{count:g,type:n(u)}))}if(l.odd&&o%2!==1&&y.push(l.notOdd||this.notOdd||this.message||"must be odd"),l.even&&o%2!==0&&y.push(l.notEven||this.notEven||this.message||"must be even"),y.length)return l.message||y}},datetime:r.extend(function(o,l){if(!r.isFunction(this.parse)||!r.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(r.isDefined(o)){l=r.extend({},this.options,l);var c,m=[],a=l.earliest?this.parse(l.earliest,l):NaN,y=l.latest?this.parse(l.latest,l):NaN;if(o=this.parse(o,l),isNaN(o)||l.dateOnly&&o%864e5!==0)return c=l.notValid||l.message||this.notValid||"must be a valid date",r.format(c,{value:arguments[0]});if(!isNaN(a)&&o<a&&(c=l.tooEarly||l.message||this.tooEarly||"must be no earlier than %{date}",c=r.format(c,{value:this.format(o,l),date:this.format(a,l)}),m.push(c)),!isNaN(y)&&o>y&&(c=l.tooLate||l.message||this.tooLate||"must be no later than %{date}",c=r.format(c,{date:this.format(y,l),value:this.format(o,l)}),m.push(c)),m.length)return r.unique(m)}},{parse:null,format:null}),date:function(o,l){return l=r.extend({},l,{dateOnly:!0}),r.validators.datetime.call(r.validators.datetime,o,l)},format:function(o,l){(r.isString(l)||l instanceof RegExp)&&(l={pattern:l}),l=r.extend({},this.options,l);var c=l.message||this.message||"is invalid",m=l.pattern,a;if(r.isDefined(o)&&(!r.isString(o)||(r.isString(m)&&(m=new RegExp(l.pattern,l.flags)),a=m.exec(o),!a||a[0].length!=o.length)))return c},inclusion:function(o,l){if(r.isDefined(o)&&(r.isArray(l)&&(l={within:l}),l=r.extend({},this.options,l),!r.contains(l.within,o))){var c=l.message||this.message||"^%{value} is not included in the list";return r.format(c,{value:o})}},exclusion:function(o,l){if(r.isDefined(o)&&(r.isArray(l)&&(l={within:l}),l=r.extend({},this.options,l),!!r.contains(l.within,o))){var c=l.message||this.message||"^%{value} is restricted";return r.isString(l.within[o])&&(o=l.within[o]),r.format(c,{value:o})}},email:r.extend(function(o,l){l=r.extend({},this.options,l);var c=l.message||this.message||"is not a valid email";if(r.isDefined(o)&&(!r.isString(o)||!this.PATTERN.exec(o)))return c},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(o,l,c,m,a){if(r.isDefined(o)){r.isString(l)&&(l={attribute:l}),l=r.extend({},this.options,l);var y=l.message||this.message||"is not equal to %{attribute}";if(r.isEmpty(l.attribute)||!r.isString(l.attribute))throw new Error("The attribute must be a non empty string");var u=r.getDeepObjectValue(m,l.attribute),g=l.comparator||function(n,k){return n===k},d=l.prettify||a&&a.prettify||r.prettify;if(!g(o,u,l,c,m))return r.format(y,{attribute:d(l.attribute)})}},url:function(o,l){if(r.isDefined(o)){l=r.extend({},this.options,l);var c=l.message||this.message||"is not a valid url",m=l.schemes||this.schemes||["http","https"],a=l.allowLocal||this.allowLocal||!1,y=l.allowDataUrl||this.allowDataUrl||!1;if(!r.isString(o))return c;var u="^(?:(?:"+m.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",g="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(a?g+="?":u+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",u+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+g+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",y){var d="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",n="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",k="data:(?:"+d+")?(?:;base64)?,"+n;u="(?:"+u+")|(?:^"+k+"$)"}var i=new RegExp(u,"i");if(!i.exec(o))return c}},type:r.extend(function(o,l,c,m,a){if(r.isString(l)&&(l={type:l}),!!r.isDefined(o)){var y=r.extend({},this.options,l),u=y.type;if(!r.isDefined(u))throw new Error("No type was specified");var g;if(r.isFunction(u)?g=u:g=this.types[u],!r.isFunction(g))throw new Error("validate.validators.type.types."+u+" must be a function.");if(!g(o,y,c,m,a)){var d=l.message||this.messages[u]||this.message||y.message||(r.isFunction(u)?"must be of the correct type":"must be of type %{type}");return r.isFunction(d)&&(d=d(o,l,c,m,a)),r.format(d,{attribute:r.prettify(c),type:u})}}},{types:{object:function(o){return r.isObject(o)&&!r.isArray(o)},array:r.isArray,integer:r.isInteger,number:r.isNumber,string:r.isString,date:r.isDate,boolean:r.isBoolean},messages:{}})},f.formatters={detailed:function(o){return o},flat:r.flattenErrorsToArray,grouped:function(o){var l;o=r.groupErrorsByAttribute(o);for(l in o)o[l]=r.flattenErrorsToArray(o[l]);return o},constraint:function(o){var l;o=r.groupErrorsByAttribute(o);for(l in o)o[l]=o[l].map(function(c){return c.validator}).sort();return o}},f.exposeModule(f,this,x,p,s)}).call(Ee,_,B,null)})(W,W.exports)),W.exports}var ge=be();const ee=Ne(ge),I=(B,_,x="")=>{const p={};Object.keys(_).forEach(r=>{const o=_[r];ee.isString(o)?p[r]={presence:{allowEmpty:!1,message:`^請輸入${o}`}}:p[r]=o});const s={},f=ee(B,p);return f&&Object.keys(f).forEach(r=>s[`${x}${r}`]=f[r].join(",")),s},ke={class:"block"},ye={class:"mt-4"},ue={class:"table align-middle gray-table side-table"},xe={key:0},he={key:1,class:"text-light-gray"},$e={class:"d-flex flex-column gap-2"},Be={key:0},_e={class:"mt-4"},Ce={class:"table align-middle gray-table side-table"},Te={class:"row g-3"},we={class:"col-12 col-xl-2"},De={class:"text-gray mb-2"},Se={class:"col-12 col-xl-3"},Ae={class:"text-gray mb-2"},Fe={class:"col-12 col-xl-4"},Ue={class:"row g-1"},Me={class:"col-7"},Ie={class:"col-5"},Pe={class:"col-12 col-xl-3"},je={class:"text-gray mb-2"},Oe={class:"col-12"},Le={class:"text-gray mb-2"},qe={class:"mt-4"},Re={class:"table align-middle gray-table side-table"},ze={class:"mt-4"},Ge={class:"table align-middle gray-table side-table"},Je={key:0,class:"table-responsive mt-3 mb-0"},Ye={class:"table align-middle gray-table"},Qe={key:0},We={key:0},He={class:"d-flex gap-2"},Xe=["onClick"],Ke={class:"mt-4"},Ze={class:"table align-middle gray-table side-table"},ve={key:0,class:"block-bottom bg-light-teal"},et={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.ref(),r=e.computed(()=>z("accessibility",c.value.Status,1)),o=e.ref({}),l=e.computed(()=>m.value.filter(i=>!i.Deleted)),c=e.ref({}),m=e.ref([]),a=e.computed({get:()=>!!l.value.length,set:i=>{i?y():m.value.forEach(N=>N.Deleted=!0)}}),y=()=>m.value.push({}),u=_,g=()=>{F.accessibility("getApplication",{ID:x.id}).subscribe(i=>{c.value=i.Project,f.value=i.Contacts,m.value=i.ReceivedSubsidies,c.value.OrgCategory=c.value.OrgCategory||null,j().init("accessibility",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},d=i=>i.Deleted=!0,n=i=>{var V,E;if(o.value={},i&&!k()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:c.value,Contacts:f.value,ReceivedSubsidies:m.value.filter(t=>t.ID||!t.Deleted),Before:(V=s.value)==null?void 0:V.Form1Before,After:(E=s.value)==null?void 0:E.Form1After,Submit:i?"true":"false"};F.accessibility("saveApplication",N).subscribe(t=>{i?u("next",t.ID):c.value.ID?g():window.location.href=`Application.aspx?ID=${t.ID}`})},k=()=>{let i={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return c.value.OrgCategory==="2"&&(i.RegisteredNum="立案登記證字號"),o.value=I(c.value,i),i={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},f.value.forEach((N,V)=>Object.assign(o.value,I(N,i,`contact-${V}-`))),i={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},m.value.forEach((N,V)=>Object.assign(o.value,I(N,i,`received-${V}-`))),s.value&&(i={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,i))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([F.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(i=>{p.value=i[0],x.id?g():F.accessibility("getEmptyApplication").subscribe(N=>{c.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},N),f.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("accessibility",c.value)})})}),e.provide("editable",r),(i,N)=>{const V=e.resolveComponent("required-label"),E=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),b=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ke,[N[42]||(N[42]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ye,[e.createElementVNode("table",ue,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).Year),1)]),e.createElementVNode("tr",null,[N[16]||(N[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(c).ProjectID?(e.openBlock(),e.createElementBlock("span",xe,e.toDisplayString(e.unref(c).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",he,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[17]||(N[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).ProjectName,modelValue:e.unref(c).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=w=>e.unref(c).ProjectName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(c).OrgName,"onUpdate:modelValue":N[1]||(N[1]=w=>e.unref(c).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",$e,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(p),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).OrgCategory,"onUpdate:modelValue":N[2]||(N[2]=w=>e.unref(c).OrgCategory=w)},null,8,["error","options","modelValue"])]),e.unref(c).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Be,[e.createVNode(E,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(c).RegisteredNum,"onUpdate:modelValue":N[3]||(N[3]=w=>e.unref(c).RegisteredNum=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(c).TaxID,"onUpdate:modelValue":N[4]||(N[4]=w=>e.unref(c).TaxID=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(c).Address,"onUpdate:modelValue":N[5]||(N[5]=w=>e.unref(c).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[43]||(N[43]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",_e,[e.createElementVNode("table",Ce,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Te,[e.createElementVNode("div",we,[e.createElementVNode("div",De,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Se,[e.createElementVNode("div",Ae,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[24]||(N[24]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Fe,[N[25]||(N[25]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ue,[e.createElementVNode("div",Me,[e.createVNode(E,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ie,[e.createVNode(E,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Pe,[e.createElementVNode("div",je,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Oe,[e.createElementVNode("div",Le,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(o)[`contact-${U}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[44]||(N[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",qe,[e.createElementVNode("table",Re,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[28]||(N[28]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[29]||(N[29]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(b,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(c).Target,"onUpdate:modelValue":N[6]||(N[6]=w=>e.unref(c).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(c).Summary,"onUpdate:modelValue":N[7]||(N[7]=w=>e.unref(c).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Quantified,"onUpdate:modelValue":N[8]||(N[8]=w=>e.unref(c).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[32]||(N[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Qualitative,"onUpdate:modelValue":N[9]||(N[9]=w=>e.unref(c).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ze,[e.createElementVNode("table",Ge,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[38]||(N[38]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(h,{modelValue:e.unref(a),"onUpdate:modelValue":N[10]||(N[10]=w=>e.isRef(a)?a.value=w:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Je,[e.createElementVNode("table",Ye,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[33]||(N[33]=e.createElementVNode("th",null,"計畫名稱",-1)),N[34]||(N[34]=e.createElementVNode("th",null,"補助單位",-1)),N[35]||(N[35]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Qe,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o)[`received-${U}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(o)[`received-${U}-Unit`],modelValue:w.Unit,"onUpdate:modelValue":M=>w.Unit=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${U}-Amount`],modelValue:w.Amount,"onUpdate:modelValue":M=>w.Amount=M},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",We,[e.createElementVNode("div",He,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>d(w),type:"button"},[...N[36]||(N[36]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Xe)):e.createCommentVNode("",!0),U+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:y,type:"button"},[...N[37]||(N[37]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[N[41]||(N[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ke,[e.createElementVNode("table",Ze,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[39]||(N[39]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":N[11]||(N[11]=w=>e.unref(s).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[40]||(N[40]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":N[12]||(N[12]=w=>e.unref(s).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",ve,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[13]||(N[13]=w=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[14]||(N[14]=w=>n(!0)),type:"button"},[...N[45]||(N[45]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},tt={class:"block"},lt={key:0,class:"text-pink lh-base mt-4"},ot={class:"mt-4"},nt={class:"table align-middle gray-table"},rt={class:"text-center"},at={key:0,width:"180"},dt={class:"text-center"},st={key:0},ct=["innerHTML"],it=["href"],mt={key:0,class:"text-center"},pt={key:0},Vt={key:1,class:"text-pink"},ft={key:1,class:"tag-group mt-2 gap-1"},Nt={key:0,class:"tag tag-green-light"},Et=["download","href"],bt=["onClick"],gt={class:"mt-4"},kt={class:"table align-middle gray-table side-table"},yt={key:0,class:"block-bottom bg-light-teal"},ut=["disabled"],xt={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([{Type:1,Title:"申請表",Template:"../../Template/ACC/附件01-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/ACC/附件02-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/ACC/附件03-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/ACC/附件04-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),f=e.computed(()=>p.value.some(d=>!d.Optional&&!d.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("accessibility",l.value.Status,2)),o=e.ref({}),l=e.ref({}),c=(d,n)=>{n.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(d.Multiple?n.Name:`${d.Title}.pdf`)})},m=F.download,a=_,y=()=>{rxjs.forkJoin([F.accessibility("getAttachment",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=p.value.filter(k=>{var i;return!((i=k.Excludes)!=null&&i.includes(l.value.OrgCategory))}),p.value.forEach(k=>{k.Files=n.Attachments.filter(i=>i.Type===k.Type),k.Uploaded=e.computed(()=>k.Files.filter(i=>!i.Deleted).length)}),j().init("accessibility",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},u=d=>{var k,i;if(o.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:x.id,Attachments:p.value.reduce((N,V)=>N.concat(V.Files),[]),Before:(k=s.value)==null?void 0:k.Form5Before,After:(i=s.value)==null?void 0:i.Form5After,Submit:d?"true":"false"};F.accessibility("saveAttachment",n).subscribe(()=>{d?a("next"):y()})},g=()=>{if(s.value){const d={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,d))}return!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",r),(d,n)=>{const k=e.resolveComponent("required-label"),i=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",tt,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",lt,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ot,[e.createElementVNode("table",nt,[e.createElementVNode("thead",rt,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",at,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",dt,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[V.Optional?(e.openBlock(),e.createElementBlock("span",st,e.toDisplayString(V.Title),1)):(e.openBlock(),e.createBlock(k,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Title),1)]),_:2},1024))]),e.unref(r)&&V.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:V.Comment},null,8,ct)):e.createCommentVNode("",!0),e.unref(r)&&V.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:V.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,it)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",mt,[V.Uploaded?(e.openBlock(),e.createElementBlock("span",pt,"已上傳")):(e.openBlock(),e.createElementBlock("span",Vt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(V.Multiple||!V.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:t=>c(V,t)},null,8,["onFile"])):e.createCommentVNode("",!0),V.Uploaded?(e.openBlock(),e.createElementBlock("div",ft,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Nt,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(m)(t.Path)},e.toDisplayString(t.Name),9,Et),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:b=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,bt)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",gt,[e.createElementVNode("table",kt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(s).Form5Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form5After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",yt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=V=>u(!0)),disabled:e.unref(f),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ut)])):e.createCommentVNode("",!0)],64)}}},ht={class:"block"},$t={class:"mt-4"},Bt={class:"table-responsive mt-3 mb-0"},_t={class:"table align-middle gray-table"},Ct={key:0,width:"1"},Tt={key:0},wt={class:"d-flex gap-2"},Dt=["onClick"],St={class:"table-responsive mt-3 mb-0"},At={class:"table align-middle gray-table"},Ft={class:"mt-4"},Ut={class:"table align-middle gray-table side-table"},Mt={key:0,class:"block-bottom bg-light-teal"},It={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.computed(()=>z("accessibility",l.value.Status,4)),r=e.ref({}),o=e.computed(()=>p.value.filter(d=>!d.Deleted)),l=e.ref({}),c=()=>p.value.push({}),m=_,a=()=>{rxjs.forkJoin([F.accessibility("getBenefit",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=n.Benefits,p.value.length||c(),j().init("accessibility",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},y=d=>d.Deleted=!0,u=d=>{var k,i;if(r.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Benefits:p.value,Before:(k=s.value)==null?void 0:k.Form4Before,After:(i=s.value)==null?void 0:i.Form4After,Submit:d?"true":"false"};F.accessibility("saveBenefit",n).subscribe(()=>{d?m("next"):a()})},g=()=>{let d={Benefit:"不可量化成果"};return r.value=I(l.value,d),d={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((n,k)=>Object.assign(r.value,I(n,d,`item-${k}-`))),s.value&&(d={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(r.value,I(s.value,d))),!Object.keys(r.value).length};return e.onMounted(a),e.provide("editable",f),(d,n)=>{const k=e.resolveComponent("input-text"),i=e.resolveComponent("input-textarea"),N=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ht,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",$t,[e.createElementVNode("div",Bt,[e.createElementVNode("table",_t,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",Ct,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(r)[`item-${E}-Title`],modelValue:V.Title,"onUpdate:modelValue":t=>V.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(r)[`item-${E}-Target`],modelValue:V.Target,"onUpdate:modelValue":t=>V.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r)[`item-${E}-Description`],rows:"1",modelValue:V.Description,"onUpdate:modelValue":t=>V.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",Tt,[e.createElementVNode("div",wt,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>y(V),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Dt)):e.createCommentVNode("",!0),E+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",St,[e.createElementVNode("table",At,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(l).Benefit=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ft,[e.createElementVNode("table",Ut,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form4Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":n[2]||(n[2]=V=>e.unref(s).Form4After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",Mt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=V=>u(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Pt={class:"block"},jt={class:"mt-4"},Ot={class:"table-responsive mt-3 mb-0"},Lt={class:"table align-middle gray-table"},qt={class:"text-end"},Rt={class:"text-end"},zt={class:"table-responsive"},Gt={class:"table align-middle gray-table"},Jt=["colspan"],Yt={key:0,width:"1"},Qt={class:"text-end"},Wt={key:0},Ht={class:"d-flex gap-2"},Xt=["onClick"],Kt={class:"mt-4"},Zt={class:"table-responsive mt-3 mb-0"},vt={class:"table align-middle gray-table"},el={key:0,width:"1"},tl={class:"text-end"},ll={key:0},ol={class:"d-flex gap-2"},nl=["onClick"],rl={class:"mt-4"},al={class:"table align-middle gray-table side-table"},dl={key:0,class:"block-bottom bg-light-teal"},sl={class:"text-center"},cl={class:"mb-5"},il={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.computed(()=>z("accessibility",l.value.Status,3)),f=e.ref({}),r=e.computed(()=>m.value.filter(E=>!E.Deleted)),o=e.computed(()=>a.value.filter(E=>!E.Deleted)),l=e.ref({}),c=e.ref(),m=e.ref([]),a=e.ref([]),y=e.ref({}),u=e.ref(0),g=()=>m.value.push({}),d=()=>a.value.push({}),n=_,k=()=>{rxjs.forkJoin([F.accessibility("getFunding",{ID:x.id})]).subscribe(E=>{const t=E[0];l.value=t.Project,m.value=t.OtherSubsidies,a.value=t.BudgetPlans,y.value=t.GrantTargetSetting,m.value.length||g(),a.value.length||d(),j().init("accessibility",l.value),p.value=l.value.changeApply,l.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(f.value={},E&&!V()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>y.value.GrantLimit*1e4){c.value.show(()=>N(E,!0));return}const b={Project:l.value,OtherSubsidies:m.value,BudgetPlans:a.value,Before:(h=p.value)==null?void 0:h.Form3Before,After:(S=p.value)==null?void 0:S.Form3After,Submit:E?"true":"false"};F.accessibility("saveFunding",b).subscribe(()=>{E?n("next"):k()})},V=()=>{let E={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=I(l.value,E),E={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},m.value.forEach((t,b)=>Object.assign(f.value,I(t,E,`other-${b}-`))),E={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,b)=>Object.assign(f.value,I(t,E,`plan-${b}-`))),p.value&&(E={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,I(p.value,E))),!Object.keys(f.value).length};return e.onMounted(k),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=r.value.reduce((E,t)=>E+R(t.Amount),0),u.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),r.value.forEach(E=>E.percent=Math.round(R(E.Amount)/l.value.OtherAmount*1e4)/100),a.value.forEach(E=>E.sum=R(E.Amount)+R(E.OtherAmount))}),(E,t)=>{var M;const b=e.resolveComponent("input-integer"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),U=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pt,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",jt,[e.createElementVNode("div",Ot,[e.createElementVNode("table",Lt,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=A=>e.unref(l).ApplyAmount=A)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=A=>e.unref(l).SelfAmount=A)},null,8,["error","modelValue"])]),e.createElementVNode("td",qt,e.toDisplayString((M=e.unref(l).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Rt,e.toDisplayString(e.unref(u).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",zt,[e.createElementVNode("table",Gt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Jt)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",Yt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(A,C)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(f)[`other-${C}-Unit`],modelValue:A.Unit,"onUpdate:modelValue":T=>A.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`other-${C}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":T=>A.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Qt,e.toDisplayString(A.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`other-${C}-Content`],rows:"1",modelValue:A.Content,"onUpdate:modelValue":T=>A.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",Wt,[e.createElementVNode("div",Ht,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>i(A),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Xt)):e.createCommentVNode("",!0),C+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Kt,[e.createElementVNode("div",Zt,[e.createElementVNode("table",vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",el,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(A,C)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(f)[`plan-${C}-Title`],modelValue:A.Title,"onUpdate:modelValue":T=>A.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`plan-${C}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":T=>A.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`plan-${C}-OtherAmount`],modelValue:A.OtherAmount,"onUpdate:modelValue":T=>A.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",tl,e.toDisplayString(A.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`plan-${C}-Description`],rows:"1",modelValue:A.Description,"onUpdate:modelValue":T=>A.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",ll,[e.createElementVNode("div",ol,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>i(A),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nl)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",rl,[e.createElementVNode("table",al,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(p).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=A=>e.unref(p).Form3Before=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(p).Form3After,"onUpdate:modelValue":t[3]||(t[3]=A=>e.unref(p).Form3After=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",dl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=A=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=A=>N(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(U,{ref_key:"modal",ref:c},{default:e.withCtx(()=>[e.createElementVNode("div",sl,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",cl,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(y).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},ml={class:"block"},pl={class:"text-teal fw-bold py-3"},Vl={class:"table-responsive"},fl={class:"table align-middle gray-table"},Nl={class:"text-end"},El={class:"text-end"},bl={class:"mt-4"},gl={class:"table align-middle gray-table"},kl={class:"text-center"},yl={key:0,width:"180"},ul={class:"text-center"},xl=["href"],hl={key:0,class:"text-center"},$l={key:0},Bl={key:1,class:"text-pink"},_l={key:1,class:"tag-group mt-2 gap-1"},Cl={key:0,class:"tag tag-green-light"},Tl=["download","href"],wl=["onClick"],Dl={class:"block-bottom bg-light-teal"},Sl=!0,Al={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(0),s=e.ref({}),f=e.ref([{Type:1,Title:"領據",Files:[]}]),r=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(m,a)=>{a.Type==="application/pdf"&&m.Files.push({Type:m.Type,Path:a.Path,Name:s.value.ProjectID+"_第一期請款_"+(m.Multiple?a.Name:`${m.Title}.pdf`)})},l=F.download,c=m=>{};return e.onMounted(()=>{F.accessibility("findApplication",{ID:x.id}).subscribe(m=>{s.value=m.Project,j().init("accessibility",s.value),f.value=f.value.filter(a=>{var y;return!((y=a.Excludes)!=null&&y.includes(s.value.OrgCategory))}),f.value.forEach(a=>{a.Uploaded=e.computed(()=>a.Files.filter(y=>!y.Deleted).length)})})}),e.provide("editable",Sl),(m,a)=>{var d;const y=e.resolveComponent("input-integer"),u=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ml,[a[11]||(a[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期中報告通過後進行請款，實支實付上限50%）",-1)),e.createElementVNode("p",pl,"核定經費: "+e.toDisplayString((d=e.unref(s).ApprovedAmount)==null?void 0:d.toLocaleString())+"元",1),e.createElementVNode("div",Vl,[e.createElementVNode("table",fl,[a[5]||(a[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Nl,e.toDisplayString(e.unref(p)),1),a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(p),"onUpdate:modelValue":a[0]||(a[0]=n=>e.isRef(p)?p.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",El,e.toDisplayString(e.unref(r))+"%",1),a[4]||(a[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),a[12]||(a[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[13]||(a[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",bl,[e.createElementVNode("table",gl,[e.createElementVNode("thead",kl,[e.createElementVNode("tr",null,[a[6]||(a[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[7]||(a[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",yl,"狀態")),a[8]||(a[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(n,k)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",ul,e.toDisplayString(k+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,xl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",hl,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",$l,"已上傳")):(e.openBlock(),e.createElementBlock("span",Bl,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:i=>o(n,i)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",_l,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Cl,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(l)(i.Path)},e.toDisplayString(i.Name),9,Tl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>i.Deleted=!0,type:"button"},[...a[10]||(a[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,wl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Dl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[1]||(a[1]=n=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[2]||(a[2]=n=>c()),type:"button"},[...a[14]||(a[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Fl={class:"block"},Ul={class:"text-teal fw-bold py-3"},Ml={class:"text-teal fw-bold pb-3"},Il={class:"table-responsive"},Pl={class:"table align-middle gray-table"},jl={class:"text-end"},Ol={class:"text-end"},Ll={class:"mt-4"},ql={class:"table align-middle gray-table"},Rl={class:"text-center"},zl={key:0,width:"180"},Gl={class:"text-center"},Jl=["href"],Yl={key:0,class:"text-center"},Ql={key:0},Wl={key:1,class:"text-pink"},Hl={key:1,class:"tag-group mt-2 gap-1"},Xl={key:0,class:"tag tag-green-light"},Kl=["download","href"],Zl=["onClick"],vl={class:"block-bottom bg-light-teal"},eo=!0,te=3e4,to={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(3e4),s=e.ref({}),f=e.ref([{Type:1,Title:"領據",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/ACC/1-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/ACC/2-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/ACC/3-補助清單.docx",Files:[]},{Type:5,Title:"其他",Files:[]}]),r=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(m,a)=>{a.Type==="application/pdf"&&m.Files.push({Type:m.Type,Path:a.Path,Name:s.value.ProjectID+"_第二期請款_"+(m.Multiple?a.Name:`${m.Title}.pdf`)})},l=F.download,c=m=>{};return e.onMounted(()=>{F.accessibility("findApplication",{ID:x.id}).subscribe(m=>{s.value=m.Project,j().init("accessibility",s.value),f.value=f.value.filter(a=>{var y;return!((y=a.Excludes)!=null&&y.includes(s.value.OrgCategory))}),f.value.forEach(a=>{a.Uploaded=e.computed(()=>a.Files.filter(y=>!y.Deleted).length)})})}),e.provide("editable",eo),(m,a)=>{var d;const y=e.resolveComponent("input-integer"),u=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Fl,[a[10]||(a[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",Ul,"核定經費: "+e.toDisplayString((d=e.unref(s).ApprovedAmount)==null?void 0:d.toLocaleString())+"元",1),e.createElementVNode("p",Ml,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(p)).toLocaleString())+"元",1),e.createElementVNode("div",Il,[e.createElementVNode("table",Pl,[a[4]||(a[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",jl,e.toDisplayString(e.unref(p)-te),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(te)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(p),"onUpdate:modelValue":a[0]||(a[0]=n=>e.isRef(p)?p.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",Ol,e.toDisplayString(e.unref(r))+"%",1),a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),a[11]||(a[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[12]||(a[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Ll,[e.createElementVNode("table",ql,[e.createElementVNode("thead",Rl,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",zl,"狀態")),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(n,k)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",Gl,e.toDisplayString(k+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Jl)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",Yl,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",Ql,"已上傳")):(e.openBlock(),e.createElementBlock("span",Wl,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:i=>o(n,i)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",Hl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Xl,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(l)(i.Path)},e.toDisplayString(i.Name),9,Kl),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>i.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Zl))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",vl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[1]||(a[1]=n=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[2]||(a[2]=n=>c()),type:"button"},[...a[13]||(a[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},lo={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(x,p)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"accessibility"})}}},oo={class:"block"},no={class:"mt-4"},ro={class:"table align-middle gray-table side-table"},ao={key:0,class:"d-flex align-items-center gap-2"},so={class:"input-group w-auto"},co={class:"text-teal-dark"},io={key:1,class:"invalid mt-0"},mo={class:"table-responsive mt-4"},po={class:"table align-middle gray-table"},Vo={key:0},fo={class:"input-group"},No={key:0,class:"invalid mt-0"},Eo={key:0},bo={class:"d-flex gap-2"},go=["onClick"],ko={class:"mt-4"},yo={class:"table align-middle gray-table"},uo={key:0},xo=["value"],ho={key:0},$o={class:"d-flex gap-2"},Bo=["onClick"],_o={class:"mt-4"},Co={class:"table align-middle gray-table side-table"},To={key:0,class:"block-bottom bg-light-teal"},wo={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),f=e.computed(()=>a.value.EndDate),r=e.computed(()=>z("accessibility",m.value.Status,2)),o=e.ref({}),l=e.computed(()=>y.value.filter(E=>!E.Deleted)),c=e.computed(()=>u.value.filter(E=>!E.Deleted)),m=e.ref({}),a=e.ref({}),y=e.ref([]),u=e.ref([]),g=()=>F.accessibility("createItem",{ID:x.id}).subscribe(E=>y.value.push(E)),d=()=>u.value.push({Type:0,ItemID:0}),n=_,k=()=>{rxjs.forkJoin([F.accessibility("getWorkSchedule",{ID:x.id})]).subscribe(E=>{const t=E[0];m.value=t.Project,a.value=t.GrantType,y.value=t.Items,u.value=t.Schedules,y.value.length||g(),u.value.length||d(),j().init("accessibility",m.value),s.value=m.value.changeApply,m.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=E=>{var b,h;if(o.value={},E&&!V()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:m.value,Items:y.value,Schedules:u.value,Before:(b=s.value)==null?void 0:b.Form2Before,After:(h=s.value)==null?void 0:h.Form2After,Submit:E?"true":"false"};F.accessibility("saveWorkSchedule",t).subscribe(()=>{E?n("next"):k()})},V=()=>{let E={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=I(m.value,E),E={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`item-${b}-`))),E={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},c.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`schedule-${b}-`))),s.value&&(E={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(k),e.provide("editable",r),(E,t)=>{const b=e.resolveComponent("required-label"),h=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),A=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oo,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",no,[e.createElementVNode("table",ro,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",ao,[e.createElementVNode("div",so,[e.createVNode(h,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(m).StartTime,"onUpdate:modelValue":t[0]||(t[0]=C=>e.unref(m).StartTime=C)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(m).EndTime,"onUpdate:modelValue":t[1]||(t[1]=C=>e.unref(m).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",co,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(f)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",io,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",mo,[e.createElementVNode("table",po,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Vo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`item-${T}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",fo,[e.createVNode(U,{"empty-value":0,modelValue:C.Begin,"onUpdate:modelValue":D=>C.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(U,{"empty-value":0,modelValue:C.End,"onUpdate:modelValue":D=>C.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",No,e.toDisplayString(e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`item-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`item-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Eo,[e.createElementVNode("div",bo,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(C),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,go)):e.createCommentVNode("",!0),T+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",ko,[e.createElementVNode("table",yo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",uo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(o)[`schedule-${T}-Type`],options:p,modelValue:C.Type,"onUpdate:modelValue":D=>C.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(o)[`schedule-${T}-ItemID`],options:e.unref(l),modelValue:C.ItemID,"onUpdate:modelValue":D=>C.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:P})=>[e.createElementVNode("option",{value:P.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(P.Title),9,xo)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`schedule-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`schedule-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",ho,[e.createElementVNode("div",$o,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(C),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Bo)):e.createCommentVNode("",!0),T+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",_o,[e.createElementVNode("table",Co,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=C=>e.unref(s).Form2Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=C=>e.unref(s).Form2After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",To,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=C=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=C=>N(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Do={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},So={class:"modal-content"},Ao={class:"modal-body"},Fo={class:"d-flex justify-content-center mt-4 gap-4"},Uo={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Mo={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(B,{expose:_}){let x;const p=e.ref(),s=B,f=()=>{x&&x()};return _({show:o=>{x=o,bootstrap.Modal.getOrCreateInstance(p.value).show()}}),(o,l)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:p,tabindex:"-1"},[e.createElementVNode("div",Do,[e.createElementVNode("div",So,[l[0]||(l[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Ao,[e.renderSlot(o.$slots,"default"),e.createElementVNode("div",Fo,[e.createElementVNode("button",Uo,e.toDisplayString(s.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:f,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(s.confirm),1)])])])])],512)]))}},Io={class:"application-step"},Po=["onClick"],jo={class:"step-content"},Oo={class:"step-label"},Lo={key:0,class:"step-status edit"},qo={key:1,class:"step-status"},Ro={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(B,{emit:_}){const x=e.computed(()=>z(s.type,p[s.type].status,s.step)),p=j(),s=B,f=o=>{s.review?r("click",o.step):o.step<=p[s.type].step&&(location.href=`${o.url}.aspx?ID=${s.id}`)},r=_;return(o,l)=>(e.openBlock(),e.createElementBlock("div",Io,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.steps,c=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(x)&&(c.step<e.unref(p)[B.type].step||c.step===B.step)}]),onClick:m=>f(c),key:c,role:"button"},[e.createElementVNode("div",jo,[e.createElementVNode("div",Oo,e.toDisplayString(c.title),1),e.unref(x)&&c.step===B.step?(e.openBlock(),e.createElementBlock("div",Lo,"編輯中")):c.step<e.unref(p)[B.type].step?(e.openBlock(),e.createElementBlock("div",qo,"已完成")):e.createCommentVNode("",!0)])],10,Po))),128))]))}},zo={class:"block"},Go={class:"mt-4"},Jo={class:"table align-middle gray-table side-table"},Yo={key:0},Qo={key:1,class:"text-light-gray"},Wo={class:"d-flex gap-2"},Ho={key:0,class:"invalid mt-0"},Xo={class:"d-flex flex-column gap-2"},Ko={key:0},Zo={class:"mt-4"},vo={class:"table align-middle gray-table side-table"},en={class:"row g-3"},tn={class:"col-12 col-xl-2"},ln={class:"text-gray mb-2"},on={class:"col-12 col-xl-3"},nn={class:"text-gray mb-2"},rn={class:"col-12 col-xl-4"},an={class:"row g-1"},dn={class:"col-7"},sn={class:"col-5"},cn={class:"col-12 col-xl-3"},mn={class:"text-gray mb-2"},pn={class:"col-12"},Vn={class:"text-gray mb-2"},fn={class:"mt-4"},Nn={class:"table align-middle gray-table side-table"},En={class:"mt-4"},bn={class:"table align-middle gray-table side-table"},gn={key:0,class:"table-responsive mt-3 mb-0"},kn={class:"table align-middle gray-table"},yn={key:0},un={key:0},xn={class:"d-flex gap-2"},hn=["onClick"],$n={class:"mt-4"},Bn={class:"table align-middle gray-table side-table"},_n={key:0,class:"block-bottom bg-light-teal"},Cn={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.ref(),r=e.computed(()=>z("culture",a.value.Status,1)),o=e.ref({}),l=e.ref(null),c=e.ref([]),m=e.computed(()=>u.value.filter(t=>!t.Deleted)),a=e.ref({}),y=e.computed(()=>c.value.filter(t=>!t.ParentCode)),u=e.ref([]),g=e.computed(()=>c.value.filter(t=>t.ParentCode===l.value)),d=e.computed({get:()=>!!m.value.length,set:t=>{t?n():u.value.forEach(b=>b.Deleted=!0)}}),n=()=>u.value.push({}),k=_,i=()=>{F.culture("getApplication",{ID:x.id}).subscribe(t=>{var b;a.value=t.Project,f.value=t.Contacts,u.value=t.ReceivedSubsidies,l.value=((b=c.value.find(h=>h.Code===a.value.Field))==null?void 0:b.ParentCode)||null,a.value.OrgCategory=a.value.OrgCategory||null,j().init("culture",a.value),s.value=a.value.changeApply,a.value.changeApply=void 0})},N=t=>t.Deleted=!0,V=t=>{var h,S;if(o.value={},t&&!E()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}const b={Project:a.value,Contacts:f.value,ReceivedSubsidies:u.value.filter(w=>w.ID||!w.Deleted),Before:(h=s.value)==null?void 0:h.Form1Before,After:(S=s.value)==null?void 0:S.Form1After,Submit:t?"true":"false"};F.culture("saveApplication",b).subscribe(w=>{t?k("next",w.ID):a.value.ID?i():window.location.href=`Application.aspx?ID=${w.ID}`})},E=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),o.value=I(a.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},f.value.forEach((b,h)=>Object.assign(o.value,I(b,t,`contact-${h}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},u.value.forEach((b,h)=>Object.assign(o.value,I(b,t,`received-${h}-`))),s.value&&(t={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,t))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([F.culture("getZgsCodes",{CodeGroup:"CULField"}),F.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{c.value=t[0],p.value=t[1],x.id?i():F.culture("getEmptyApplication").subscribe(b=>{l.value=null,a.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},b),f.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("culture",a.value)})})}),e.provide("editable",r),e.watch(l,()=>{l.value?g.value.find(t=>a.value.Field===t.Code)||(a.value.Field=g.value[0].Code):a.value.Field=null}),(t,b)=>{const h=e.resolveComponent("required-label"),S=e.resolveComponent("input-text"),w=e.resolveComponent("input-select"),U=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-boolean"),A=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zo,[b[45]||(b[45]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Go,[e.createElementVNode("table",Jo,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[b[17]||(b[17]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).Year),1)]),e.createElementVNode("tr",null,[b[18]||(b[18]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(a).ProjectID?(e.openBlock(),e.createElementBlock("span",Yo,e.toDisplayString(e.unref(a).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Qo,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[b[19]||(b[19]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[20]||(b[20]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).ProjectName,modelValue:e.unref(a).ProjectName,"onUpdate:modelValue":b[0]||(b[0]=C=>e.unref(a).ProjectName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[21]||(b[21]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Wo,[e.createVNode(w,{"empty-value":null,options:e.unref(y),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l),"onUpdate:modelValue":b[1]||(b[1]=C=>e.isRef(l)?l.value=C:null)},null,8,["options","modelValue"]),e.createVNode(w,{"empty-value":null,disabled:!e.unref(l),options:e.unref(g),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).Field,"onUpdate:modelValue":b[2]||(b[2]=C=>e.unref(a).Field=C)},null,8,["disabled","options","modelValue"])]),e.unref(o).Field?(e.openBlock(),e.createElementBlock("div",Ho,e.toDisplayString(e.unref(o).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[22]||(b[22]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(a).OrgName,"onUpdate:modelValue":b[3]||(b[3]=C=>e.unref(a).OrgName=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[23]||(b[23]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Xo,[e.createElementVNode("div",null,[e.createVNode(w,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(p),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).OrgCategory,"onUpdate:modelValue":b[4]||(b[4]=C=>e.unref(a).OrgCategory=C)},null,8,["error","options","modelValue"])]),e.unref(a).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Ko,[e.createVNode(S,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(a).RegisteredNum,"onUpdate:modelValue":b[5]||(b[5]=C=>e.unref(a).RegisteredNum=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[24]||(b[24]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(a).TaxID,"onUpdate:modelValue":b[6]||(b[6]=C=>e.unref(a).TaxID=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[25]||(b[25]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(a).Address,"onUpdate:modelValue":b[7]||(b[7]=C=>e.unref(a).Address=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),b[46]||(b[46]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Zo,[e.createElementVNode("table",vo,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(C.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",en,[e.createElementVNode("div",tn,[e.createElementVNode("div",ln,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[26]||(b[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-Name`],modelValue:C.Name,"onUpdate:modelValue":D=>C.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",on,[e.createElementVNode("div",nn,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[27]||(b[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-JobTitle`],modelValue:C.JobTitle,"onUpdate:modelValue":D=>C.JobTitle=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rn,[b[28]||(b[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",an,[e.createElementVNode("div",dn,[e.createVNode(S,{modelValue:C.Phone,"onUpdate:modelValue":D=>C.Phone=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",sn,[e.createVNode(S,{placeholder:"請輸入分機",size:"4",modelValue:C.PhoneExt,"onUpdate:modelValue":D=>C.PhoneExt=D,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",cn,[e.createElementVNode("div",mn,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[29]||(b[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-MobilePhone`],modelValue:C.MobilePhone,"onUpdate:modelValue":D=>C.MobilePhone=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",pn,[e.createElementVNode("div",Vn,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[30]||(b[30]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(S,{error:e.unref(o)[`contact-${T}-EMail`],modelValue:C.EMail,"onUpdate:modelValue":D=>C.EMail=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),b[47]||(b[47]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",fn,[e.createElementVNode("table",Nn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[31]||(b[31]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[b[32]||(b[32]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(U,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(a).Target,"onUpdate:modelValue":b[8]||(b[8]=C=>e.unref(a).Target=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[33]||(b[33]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(a).Summary,"onUpdate:modelValue":b[9]||(b[9]=C=>e.unref(a).Summary=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[34]||(b[34]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Quantified,"onUpdate:modelValue":b[10]||(b[10]=C=>e.unref(a).Quantified=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[35]||(b[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Qualitative,"onUpdate:modelValue":b[11]||(b[11]=C=>e.unref(a).Qualitative=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",En,[e.createElementVNode("table",bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[b[41]||(b[41]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(M,{modelValue:e.unref(d),"onUpdate:modelValue":b[12]||(b[12]=C=>e.isRef(d)?d.value=C:null)},null,8,["modelValue"]),e.unref(d)?(e.openBlock(),e.createElementBlock("div",gn,[e.createElementVNode("table",kn,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[b[36]||(b[36]=e.createElementVNode("th",null,"計畫名稱",-1)),b[37]||(b[37]=e.createElementVNode("th",null,"補助單位",-1)),b[38]||(b[38]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",yn,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${T}-Name`],modelValue:C.Name,"onUpdate:modelValue":D=>C.Name=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(o)[`received-${T}-Unit`],modelValue:C.Unit,"onUpdate:modelValue":D=>C.Unit=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(o)[`received-${T}-Amount`],modelValue:C.Amount,"onUpdate:modelValue":D=>C.Amount=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",un,[e.createElementVNode("div",xn,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>N(C),type:"button"},[...b[39]||(b[39]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,hn)):e.createCommentVNode("",!0),T+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:n,type:"button"},[...b[40]||(b[40]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[b[44]||(b[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",$n,[e.createElementVNode("table",Bn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[42]||(b[42]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":b[13]||(b[13]=C=>e.unref(s).Form1Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(h,null,{default:e.withCtx(()=>[...b[43]||(b[43]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":b[14]||(b[14]=C=>e.unref(s).Form1After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",_n,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:b[15]||(b[15]=C=>V()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:b[16]||(b[16]=C=>V(!0)),type:"button"},[...b[48]||(b[48]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Tn={class:"block"},wn={key:0,class:"text-pink lh-base mt-4"},Dn={class:"mt-4"},Sn={class:"table align-middle gray-table"},An={class:"text-center"},Fn={key:0,width:"180"},Un={class:"text-center"},Mn={key:0},In=["innerHTML"],Pn=["href"],jn={key:0,class:"text-center"},On={key:0},Ln={key:1,class:"text-pink"},qn={key:1,class:"tag-group mt-2 gap-1"},Rn={key:0,class:"tag tag-green-light"},zn=["download","href"],Gn=["onClick"],Jn={class:"mt-4"},Yn={class:"table align-middle gray-table side-table"},Qn={key:0,class:"block-bottom bg-light-teal"},Wn=["disabled"],Hn={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([{Type:1,Title:"申請表",Template:"../../Template/CUL/1.申請表.docx",Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:"../../Template/CUL/2.計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/CUL/3.執行承諾書.docx",Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:"../../Template/CUL/4.未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),s=e.ref(),f=e.computed(()=>p.value.some(d=>!d.Optional&&!d.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("culture",l.value.Status,5)),o=e.ref({}),l=e.ref({}),c=(d,n)=>{n.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(d.Multiple?n.Name:`${d.Title}.pdf`)})},m=F.download,a=_,y=()=>{rxjs.forkJoin([F.culture("getAttachment",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=p.value.filter(k=>{var i;return!((i=k.Excludes)!=null&&i.includes(l.value.OrgCategory))}),l.value.Status>=42&&p.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]}),p.value.forEach(k=>{k.Files=n.Attachments.filter(i=>i.Type===k.Type),k.Uploaded=e.computed(()=>k.Files.filter(i=>!i.Deleted).length)}),j().init("culture",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},u=d=>{var k,i;if(o.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:x.id,Attachments:p.value.reduce((N,V)=>N.concat(V.Files),[]),Before:(k=s.value)==null?void 0:k.Form5Before,After:(i=s.value)==null?void 0:i.Form5After,Submit:d?"true":"false"};F.culture("saveAttachment",n).subscribe(()=>{d?a("next"):y()})},g=()=>{if(s.value){const d={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,d))}return!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",r),(d,n)=>{const k=e.resolveComponent("required-label"),i=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Tn,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",wn,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Dn,[e.createElementVNode("table",Sn,[e.createElementVNode("thead",An,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",Fn,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",Un,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[V.Optional?(e.openBlock(),e.createElementBlock("span",Mn,e.toDisplayString(V.Title),1)):(e.openBlock(),e.createBlock(k,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Title),1)]),_:2},1024))]),e.unref(r)&&V.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:V.Comment},null,8,In)):e.createCommentVNode("",!0),e.unref(r)&&V.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:V.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Pn)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",jn,[V.Uploaded?(e.openBlock(),e.createElementBlock("span",On,"已上傳")):(e.openBlock(),e.createElementBlock("span",Ln,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(V.Multiple||!V.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:t=>c(V,t)},null,8,["onFile"])):e.createCommentVNode("",!0),V.Uploaded?(e.openBlock(),e.createElementBlock("div",qn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Rn,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(m)(t.Path)},e.toDisplayString(t.Name),9,zn),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:b=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Gn)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Jn,[e.createElementVNode("table",Yn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(s).Form5Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form5After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Qn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=V=>u(!0)),disabled:e.unref(f),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Wn)])):e.createCommentVNode("",!0)],64)}}},Xn={class:"block"},Kn={class:"mt-4"},Zn={class:"table-responsive mt-3 mb-0"},vn={class:"table align-middle gray-table"},er={class:"text-end"},tr={class:"text-end"},lr={class:"table-responsive"},or={class:"table align-middle gray-table"},nr=["colspan"],rr={key:0,width:"1"},ar={key:0},dr={class:"d-flex gap-2"},sr=["onClick"],cr={class:"mt-4"},ir={class:"table-responsive mt-3 mb-0"},mr={class:"table align-middle gray-table"},pr={key:0,width:"1"},Vr={class:"text-end"},fr={key:0},Nr={class:"d-flex gap-2"},Er=["onClick"],br={class:"mt-4"},gr={class:"table align-middle gray-table side-table"},kr={key:0,class:"block-bottom bg-light-teal"},yr={class:"text-center"},ur={class:"mb-5"},xr={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.computed(()=>z("culture",l.value.Status,3)),f=e.ref({}),r=e.computed(()=>a.value.filter(b=>!b.Deleted)),o=e.computed(()=>y.value.filter(b=>!b.Deleted)),l=e.ref({}),c=e.ref([]),m=e.ref(),a=e.ref([]),y=e.ref([]),u=e.ref({}),g=e.ref(0),d=()=>a.value.push({}),n=()=>y.value.push({ItemID:0}),k=_,i=()=>{rxjs.forkJoin([F.culture("getFunding",{ID:x.id})]).subscribe(b=>{const h=b[0];l.value=h.Project,a.value=h.OtherSubsidies,y.value=h.BudgetPlans,c.value=h.Items,u.value=h.GrantTargetSetting,a.value.length||d(),y.value.length||n(),j().init("culture",l.value),p.value=l.value.changeApply,l.value.changeApply=void 0})},N=b=>b.Deleted=!0,V=b=>b.Deleted=!0,E=(b,h)=>{var w,U;if(f.value={},b&&!t()){e.nextTick(()=>{var M;return(M=document.querySelector(".invalid"))==null?void 0:M.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!h&&l.value.ApplyAmount>u.value.GrantLimit*1e4){m.value.show(()=>E(b,!0));return}const S={Project:l.value,OtherSubsidies:a.value,BudgetPlans:y.value,Before:(w=p.value)==null?void 0:w.Form3Before,After:(U=p.value)==null?void 0:U.Form3After,Submit:b?"true":"false"};F.culture("saveFunding",S).subscribe(()=>{b?k("next"):i()})},t=()=>{let b={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=I(l.value,b),b={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},a.value.forEach((h,S)=>Object.assign(f.value,I(h,b,`other-${S}-`))),b={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},y.value.forEach((h,S)=>Object.assign(f.value,I(h,b,`plan-${S}-`))),p.value&&(b={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,I(p.value,b))),!Object.keys(f.value).length};return e.onMounted(i),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=a.value.reduce((b,h)=>b+(h.Deleted?0:R(h.Amount)),0),g.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),y.value.forEach(b=>b.sum=R(b.Amount)+R(b.OtherAmount))}),(b,h)=>{var T;const S=e.resolveComponent("input-integer"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-select"),M=e.resolveComponent("input-textarea"),A=e.resolveComponent("required-label"),C=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Xn,[h[25]||(h[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Kn,[e.createElementVNode("div",Zn,[e.createElementVNode("table",vn,[h[6]||(h[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":h[0]||(h[0]=D=>e.unref(l).ApplyAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":h[1]||(h[1]=D=>e.unref(l).SelfAmount=D)},null,8,["error","modelValue"])]),e.createElementVNode("td",er,e.toDisplayString((T=e.unref(l).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",tr,e.toDisplayString(e.unref(g).toLocaleString()),1)])])])]),h[12]||(h[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",lr,[e.createElementVNode("table",or,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,nr)]),e.createElementVNode("tr",null,[h[7]||(h[7]=e.createElementVNode("th",{width:"1"},null,-1)),h[8]||(h[8]=e.createElementVNode("th",null,"單位名稱",-1)),h[9]||(h[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",rr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(D,P)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,e.toDisplayString(P+1),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(f)[`other-${P}-Unit`],modelValue:D.Unit,"onUpdate:modelValue":O=>D.Unit=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`other-${P}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":O=>D.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",ar,[e.createElementVNode("div",dr,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:O=>N(D),type:"button"},[...h[10]||(h[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,sr)):e.createCommentVNode("",!0),P+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...h[11]||(h[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),h[26]||(h[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",cr,[e.createElementVNode("div",ir,[e.createElementVNode("table",mr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[h[13]||(h[13]=e.createElementVNode("th",null,"重要工作項目",-1)),h[14]||(h[14]=e.createElementVNode("th",null,"預算項目",-1)),h[15]||(h[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),h[16]||(h[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),h[17]||(h[17]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),h[18]||(h[18]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",pr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(D,P)=>(e.openBlock(),e.createElementBlock("tr",{key:D},[e.createElementVNode("td",null,[e.createVNode(U,{"empty-value":0,error:e.unref(f)[`plan-${P}-ItemID`],options:e.unref(c),"text-name":"Title","value-name":"ID",modelValue:D.ItemID,"onUpdate:modelValue":O=>D.ItemID=O},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(f)[`plan-${P}-Title`],modelValue:D.Title,"onUpdate:modelValue":O=>D.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`plan-${P}-Amount`],modelValue:D.Amount,"onUpdate:modelValue":O=>D.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`plan-${P}-OtherAmount`],modelValue:D.OtherAmount,"onUpdate:modelValue":O=>D.OtherAmount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Vr,e.toDisplayString(D.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(f)[`plan-${P}-Description`],rows:"1",modelValue:D.Description,"onUpdate:modelValue":O=>D.Description=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",fr,[e.createElementVNode("div",Nr,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:O=>V(D),type:"button"},[...h[19]||(h[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Er)):e.createCommentVNode("",!0),P+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:n,type:"button"},[...h[20]||(h[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),h[21]||(h[21]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))]),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[h[24]||(h[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",br,[e.createElementVNode("table",gr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(A,null,{default:e.withCtx(()=>[...h[22]||(h[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(p).Form3Before,"onUpdate:modelValue":h[2]||(h[2]=D=>e.unref(p).Form3Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(A,null,{default:e.withCtx(()=>[...h[23]||(h[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(p).Form3After,"onUpdate:modelValue":h[3]||(h[3]=D=>e.unref(p).Form3After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",kr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:h[4]||(h[4]=D=>E()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:h[5]||(h[5]=D=>E(!0)),type:"button"},[...h[27]||(h[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(C,{ref_key:"modal",ref:m},{default:e.withCtx(()=>[e.createElementVNode("div",yr,[h[28]||(h[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",ur,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(u).GrantLimit)+"萬",1),h[29]||(h[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),h[30]||(h[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},hr={class:"block"},$r={key:0,class:"text-pink lh-base mt-3"},Br={class:"border"},_r={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Cr={class:"d-flex gap-2 align-items-center flex-grow-1"},Tr={class:"text-nowrap"},wr={class:"flex-grow-1"},Dr={class:"d-flex gap-2"},Sr=["onClick"],Ar=["href"],Fr=["id"],Ur={class:"table align-middle gray-table side-table mb-0"},Mr={class:"mt-4"},Ir={class:"table align-middle gray-table side-table"},Pr={key:0,class:"block-bottom bg-light-teal"},jr={__name:"Other",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.computed(()=>z("culture",r.value.Status,4)),f=e.ref({}),r=e.ref({}),o=e.ref([]),l=e.computed(()=>o.value.filter(d=>!d.Deleted)),c=()=>o.value.push({}),m=_,a=()=>{rxjs.forkJoin([F.culture("getRelatedProject",{ID:x.id})]).subscribe(d=>{const n=d[0];r.value=n.Project,o.value=n.Projects,j().init("culture",r.value),p.value=r.value.changeApply,r.value.changeApply=void 0})},y=d=>d.Deleted=!0,u=d=>{var k,i;if(f.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:x.id,Projects:o.value,Before:(k=p.value)==null?void 0:k.Form4Before,After:(i=p.value)==null?void 0:i.Form4After,Submit:d?"true":"false"};F.culture("saveRelatedProject",n).subscribe(()=>{d?m("next"):a()})},g=()=>{let d={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return l.value.forEach((n,k)=>Object.assign(f.value,I(n,d,`project-${k}-`))),p.value&&(d={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(f.value,I(p.value,d))),!Object.keys(f.value).length};return e.onMounted(a),e.provide("editable",s),(d,n)=>{const k=e.resolveComponent("required-label"),i=e.resolveComponent("input-text"),N=e.resolveComponent("input-integer"),V=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hr,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("p",$r," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(E,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:E},[e.createElementVNode("div",Br,[e.createElementVNode("div",_r,[e.createElementVNode("div",Cr,[e.createElementVNode("label",Tr,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[4]||(n[4]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",wr,[e.createVNode(i,{error:e.unref(f)[`project-${t}-Title`],modelValue:E.Title,"onUpdate:modelValue":b=>E.Title=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Dr,[e.unref(s)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(b=>y(E),["prevent"]),href:"#"},"刪除",8,Sr)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,Ar)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",Ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[5]||(n[5]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{class:"text-start w-auto",error:e.unref(f)[`project-${t}-Year`],modelValue:E.Year,"onUpdate:modelValue":b=>E.Year=b},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[6]||(n[6]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(f)[`project-${t}-OrgName`],modelValue:E.OrgName,"onUpdate:modelValue":b=>E.OrgName=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[7]||(n[7]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{class:"w-auto",error:e.unref(f)[`project-${t}-Amount`],modelValue:E.Amount,"onUpdate:modelValue":b=>E.Amount=b},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[8]||(n[8]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(f)[`project-${t}-Description`],rows:"4",modelValue:E.Description,"onUpdate:modelValue":b=>E.Description=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[9]||(n[9]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(f)[`project-${t}-Benefit`],rows:"4",modelValue:E.Benefit,"onUpdate:modelValue":b=>E.Benefit=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,Fr)])]))),128)),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:c,type:"button"},[...n[10]||(n[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Mr,[e.createElementVNode("table",Ir,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(f).Form4Before,rows:"4",modelValue:e.unref(p).Form4Before,"onUpdate:modelValue":n[0]||(n[0]=E=>e.unref(p).Form4Before=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{error:e.unref(f).Form4After,rows:"4",modelValue:e.unref(p).Form4After,"onUpdate:modelValue":n[1]||(n[1]=E=>e.unref(p).Form4After=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Pr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=E=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=E=>u(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Or={class:"block"},Lr={class:"square-title"},qr={class:"text-teal fw-bold py-3"},Rr={class:"table-responsive"},zr={class:"table align-middle gray-table"},Gr={class:"text-end"},Jr={class:"text-end"},Yr={class:"mt-4"},Qr={class:"table align-middle gray-table"},Wr={class:"text-center"},Hr={key:0,width:"180"},Xr={class:"text-center"},Kr=["href"],Zr={key:0,class:"text-center"},vr={key:0},ea={key:1,class:"text-pink"},ta={key:1,class:"tag-group mt-2 gap-1"},la={key:0,class:"tag tag-green-light"},oa=["download","href"],na=["onClick"],ra={class:"block-bottom bg-light-teal"},aa=["disabled"],da={__name:"Payment1",props:{id:{type:[Number,String]},setting:{type:Object}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(0),s=e.computed(()=>o.value.some(g=>!g.Files.filter(d=>!d.Deleted).length)),f=e.ref(!0),r=e.ref({}),o=e.ref([{Type:11,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:12,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),l=e.computed(()=>r.value.ApprovedAmount?Math.min(Math.round(p.value*100/r.value.ApprovedAmount*100)/100,100):0),c=(g,d)=>{d.Type==="application/pdf"&&g.Files.push({Type:g.Type,Path:d.Path,Name:`${r.value.ProjectID}_第一期請款_${g.Title}.pdf`})},m=F.download,a=_,y=()=>{F.culture("getPayment",{ID:x.id,Stage:1}).subscribe(g=>{r.value=g.Project,j().init("culture",r.value),o.value=o.value.filter(n=>{var k;return!((k=n.Excludes)!=null&&k.includes(r.value.OrgCategory))}),o.value.forEach(n=>{n.Files=g.Attachments.filter(k=>k.Type===n.Type),n.Uploaded=e.computed(()=>n.Files.filter(k=>!k.Deleted).length)});const d=g.Payments.find(n=>n.Stage===1);d&&(p.value=d.CurrentRequestAmount),f.value=!d||d.Status==="暫存"})},u=g=>{const d={ID:x.id,Stage:1,Amount:p.value,Attachments:o.value.reduce((n,k)=>n.concat(k.Files),[]),Submit:g?"true":"false"};F.culture("savePayment",d).subscribe(()=>{g?a("next"):y()})};return e.onMounted(y),e.provide("editable",f),(g,d)=>{var N;const n=e.resolveComponent("input-integer"),k=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Or,[e.createElementVNode("h5",Lr,e.toDisplayString(B.setting.DisbursementType)+e.toDisplayString(B.setting.Note),1),e.createElementVNode("p",qr,"核定經費: "+e.toDisplayString((N=e.unref(r).ApprovedAmount)==null?void 0:N.toLocaleString())+"元",1),e.createElementVNode("div",Rr,[e.createElementVNode("table",zr,[d[5]||(d[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Gr,e.toDisplayString(e.unref(p)),1),d[3]||(d[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(n,{modelValue:e.unref(p),"onUpdate:modelValue":d[0]||(d[0]=V=>e.isRef(p)?p.value=V:null)},null,8,["modelValue"])]),e.createElementVNode("td",Jr,e.toDisplayString(e.unref(l))+"%",1),d[4]||(d[4]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),d[11]||(d[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),d[12]||(d[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Yr,[e.createElementVNode("table",Qr,[e.createElementVNode("thead",Wr,[e.createElementVNode("tr",null,[d[6]||(d[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),d[7]||(d[7]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",Hr,"狀態")):e.createCommentVNode("",!0),d[8]||(d[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",Xr,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(k,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Title),1)]),_:2},1024)]),e.unref(f)&&V.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:V.Template,style:{width:"140px"},type:"button"},[...d[9]||(d[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Kr)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",Zr,[V.Uploaded?(e.openBlock(),e.createElementBlock("span",vr,"已上傳")):(e.openBlock(),e.createElementBlock("span",ea,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(f)&&!V.Uploaded?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:t=>c(V,t)},null,8,["onFile"])):e.createCommentVNode("",!0),V.Uploaded?(e.openBlock(),e.createElementBlock("div",ta,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",la,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(m)(t.Path)},e.toDisplayString(t.Name),9,oa),e.unref(f)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:b=>t.Deleted=!0,type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,na)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",ra,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=V=>u(!0)),disabled:e.unref(s),type:"button"},[...d[13]||(d[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,aa)])],64)}}},sa={class:"block"},ca={class:"text-teal fw-bold py-3"},ia={class:"text-teal fw-bold pb-3"},ma={class:"table-responsive"},pa={class:"table align-middle gray-table"},Va={class:"text-end"},fa={class:"text-end"},Na={class:"mt-4"},Ea={class:"table align-middle gray-table"},ba={class:"text-center"},ga={key:0,width:"180"},ka={class:"text-center"},ya=["href"],ua={key:0,class:"text-center"},xa={key:0},ha={key:1,class:"text-pink"},$a={key:1,class:"tag-group mt-2 gap-1"},Ba={key:0,class:"tag tag-green-light"},_a=["download","href"],Ca=["onClick"],Ta={class:"block-bottom bg-light-teal"},wa=!0,le=3e4,Da={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(3e4),s=e.ref({}),f=e.ref([{Type:21,Title:"經費收支單",Template:"../../Template/CUL/經費收支單.docx",Files:[]},{Type:22,Title:"經費分攤表",Template:"../../Template/CUL/經費分攤表.docx",Files:[]},{Type:23,Title:"補助清單",Template:"../../Template/CUL/補助清單.docx",Files:[],Excludes:["1"]},{Type:24,Title:"發票憑證",Files:[],Excludes:["1","2"]}]),r=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(m,a)=>{a.Type==="application/pdf"&&m.Files.push({Type:m.Type,Path:a.Path,Name:s.value.ProjectID+"_第二期請款_"+(m.Multiple?a.Name:`${m.Title}.pdf`)})},l=F.download,c=m=>{};return e.onMounted(()=>{F.culture("findApplication",{ID:x.id}).subscribe(m=>{s.value=m.Project,j().init("culture",s.value),f.value=f.value.filter(a=>{var y;return!((y=a.Excludes)!=null&&y.includes(s.value.OrgCategory))}),f.value.forEach(a=>{a.Uploaded=e.computed(()=>a.Files.filter(y=>!y.Deleted).length)})})}),e.provide("editable",wa),(m,a)=>{var d;const y=e.resolveComponent("input-integer"),u=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",sa,[a[10]||(a[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於期末報告通過後進行請款，實支實付累計100%）",-1)),e.createElementVNode("p",ca,"核定經費: "+e.toDisplayString((d=e.unref(s).ApprovedAmount)==null?void 0:d.toLocaleString())+"元",1),e.createElementVNode("p",ia,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(p)).toLocaleString())+"元",1),e.createElementVNode("div",ma,[e.createElementVNode("table",pa,[a[4]||(a[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",Va,e.toDisplayString(e.unref(p)-le),1),e.createElementVNode("td",{class:"text-end"},e.toDisplayString(le)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(p),"onUpdate:modelValue":a[0]||(a[0]=n=>e.isRef(p)?p.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",fa,e.toDisplayString(e.unref(r))+"%",1),a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),a[11]||(a[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[12]||(a[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",Na,[e.createElementVNode("table",Ea,[e.createElementVNode("thead",ba,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",ga,"狀態")),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(n,k)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",ka,e.toDisplayString(k+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,ya)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",ua,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",xa,"已上傳")):(e.openBlock(),e.createElementBlock("span",ha,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:i=>o(n,i)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",$a,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ba,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(l)(i.Path)},e.toDisplayString(i.Name),9,_a),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>i.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ca))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",Ta,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[1]||(a[1]=n=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[2]||(a[2]=n=>c()),type:"button"},[...a[13]||(a[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Sa={class:"block rounded-top-4"},Aa={class:"horizontal-scrollable"},Fa={class:"timeline"},Ua={class:"year"},Ma={class:"month"},Ia=["onClick"],Pa={class:"square-title"},ja={class:"table-responsive mt-4"},Oa={class:"table align-middle gray-table"},La={class:"text-end"},qa={class:"table-responsive"},Ra={class:"table align-middle gray-table"},za={class:"text-end"},Ga={key:0,class:"invalid mt-0"},Ja={class:"mt-3"},Ya={class:"mt-3"},Qa=["rowspan"],Wa={key:0,class:"block-bottom bg-light-teal"},Ha={__name:"Progress",props:{id:{type:[Number,String]}},setup(B){const _=[{value:3,text:"完成"},{value:2,text:"部分完成"},{value:1,text:"未完成"}],x=B,p=e.ref(),s=e.ref({}),f=e.ref(0),r=e.ref({}),o=e.ref([]),l=e.ref({}),c=e.computed(()=>Math.round((f.value+o.value.filter(n=>n.Status===3).length)*100/m.value.length*10)/10),m=e.ref([]),a=e.ref([]),y=n=>{p.value=n,u()},u=()=>{F.culture("getMonthlyProgress",{ID:x.id,Year:p.value.year-1911,Month:p.value.month}).subscribe(n=>{const k=n.Logs,i=n.Items,N=n.Steps;let V=!1;f.value=0,l.value=n.Progress,m.value=n.Schedules,o.value=[],a.value.forEach(E=>{E.months.forEach(t=>{V||(t===p.value&&(V=!0),m.value.forEach(b=>{var h,S;if(b.Month===t.month)if(V||b.Status!==3){const w=k.find(U=>U.ScheduleID===b.ID)||{ScheduleID:b.ID,Status:b.Status};o.value.push(Object.assign(w,{Year:E.year,Month:b.Month,ItemTitle:(h=i.find(U=>U.ID===b.ItemID))==null?void 0:h.Title,Type:b.Type,StepTitle:(S=N.find(U=>U.ID===b.StepID))==null?void 0:S.Title}))}else f.value++}))})})})},g=n=>{if(s.value={},n&&!d()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const k={ID:l.value.ID,Description:l.value.Description||"",Status:n?1:0,Logs:o.value.map(i=>({ID:i.ID||0,ScheduleID:i.ScheduleID,Status:i.Status,DelayReason:i.DelayReason||"",ImprovedWay:i.ImprovedWay||""}))};F.culture("saveMonthlyProgress",k).subscribe(i=>{i&&(window.location.href="../inprogressList.aspx")})},d=()=>{let n={Description:"實際工作執行情形"};return s.value=I(l.value,n),o.value.forEach((k,i)=>{n={Status:{numericality:{greaterThan:0,message:"^請輸入本月是否完成"}}},[1,2].includes(k.Status)&&(n.DelayReason="落後原因",n.ImprovedWay="改善措施"),Object.assign(s.value,I(k,n,`item-${i}-`))}),!Object.keys(s.value).length};return e.onMounted(()=>{F.culture("getApplication",{ID:x.id}).subscribe(n=>{r.value=n.Project,j().init("culture",r.value);const k=new Date(r.value.StartTime),i=new Date(r.value.EndTime),N=Date.now();for(;;){const V=k.getFullYear(),E=k.getMonth(),t={year:V,month:E+1,disabled:new Date(V,E,20).getTime()>N};let b=a.value.find(h=>h.year===V);if(b?b.months.push(t):a.value.push({year:V,months:[t]}),V*100+E>=i.getFullYear()*100+i.getMonth())break;k.setMonth(E+1)}})}),(n,k)=>{const i=e.resolveComponent("input-textarea"),N=e.resolveComponent("input-radio-group");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Sa,[e.createElementVNode("div",Aa,[k[3]||(k[3]=e.createElementVNode("button",{class:"btn-control btn-prev",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-left"})],-1)),e.createElementVNode("ul",Fa,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),V=>(e.openBlock(),e.createElementBlock("li",{key:V},[e.createElementVNode("span",Ua,e.toDisplayString(V.year-1911)+"年",1),e.createElementVNode("ul",Ma,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.months,E=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass({active:e.unref(p)===E,disabled:E.disabled}),key:E},[e.createElementVNode("a",{onClick:t=>y(E),href:"javascript:void(0)"},e.toDisplayString(E.month)+"月",9,Ia)],2))),128))])]))),128))]),k[4]||(k[4]=e.createElementVNode("button",{class:"btn-control btn-next",type:"button"},[e.createElementVNode("i",{class:"fas fa-angle-right"})],-1))]),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h5",Pa,e.toDisplayString(e.unref(p).year-1911)+"年"+e.toDisplayString(e.unref(p).month)+"月 實際進度",1),e.createElementVNode("div",ja,[e.createElementVNode("table",Oa,[k[5]||(k[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",{class:"text-center"},"實際工作執行情形（條列式說明）")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",La,e.toDisplayString(e.unref(p).year-1911)+"年"+e.toDisplayString(e.unref(p).month)+"月",1),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(s).Description,rows:"4",modelValue:e.unref(l).Description,"onUpdate:modelValue":k[0]||(k[0]=V=>e.unref(l).Description=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",qa,[e.createElementVNode("table",Ra,[k[8]||(k[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"月份"),e.createElementVNode("th",null,"重要工作項目"),e.createElementVNode("th",null,"工作進度%"),e.createElementVNode("th",null,"檢核工作"),e.createElementVNode("th",null,"本月是否完成"),e.createElementVNode("th",null,"年度目標達成數")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("th",za,e.toDisplayString(V.Year-1911)+"年"+e.toDisplayString(V.Month)+"月",1),e.createElementVNode("td",null,e.toDisplayString(V.ItemTitle),1),e.createElementVNode("td",null,e.toDisplayString(V.Type===1?"50%":"100%"),1),e.createElementVNode("td",null,e.toDisplayString(V.StepTitle),1),e.createElementVNode("td",null,[e.createVNode(N,{options:_,modelValue:V.Status,"onUpdate:modelValue":t=>V.Status=t},null,8,["modelValue","onUpdate:modelValue"]),e.unref(s)[`item-${E}-Status`]?(e.openBlock(),e.createElementBlock("div",Ga,e.toDisplayString(e.unref(s)[`item-${E}-Status`]),1)):e.createCommentVNode("",!0),[1,2].includes(V.Status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createElementVNode("div",Ja,[k[6]||(k[6]=e.createElementVNode("div",{class:"text-teal pb-2"},"落後原因",-1)),e.createVNode(i,{error:e.unref(s)[`item-${E}-DelayReason`],rows:"1",modelValue:V.DelayReason,"onUpdate:modelValue":t=>V.DelayReason=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ya,[k[7]||(k[7]=e.createElementVNode("div",{class:"text-teal pb-2"},"改善措施",-1)),e.createVNode(i,{error:e.unref(s)[`item-${E}-ImprovedWay`],rows:"1",modelValue:V.ImprovedWay,"onUpdate:modelValue":t=>V.ImprovedWay=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])],64)):e.createCommentVNode("",!0)]),E?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("td",{key:0,class:"text-end",rowspan:e.unref(o).length},e.toDisplayString(e.unref(c))+"% ",9,Qa))]))),128))])])])],64)):e.createCommentVNode("",!0)]),e.unref(p)?(e.openBlock(),e.createElementBlock("div",Wa,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[1]||(k[1]=V=>g()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[2]||(k[2]=V=>g(!0)),type:"button"},[...k[9]||(k[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])):e.createCommentVNode("",!0)],64)}}},Xa={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(x,p)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"culture"})}}},Ka=(B,_)=>{const x=B.__vccOpts||B;for(const[p,s]of _)x[p]=s;return x},Za={class:"block"},va={class:"mt-4"},ed={class:"table align-middle gray-table side-table"},td={key:0,class:"d-flex align-items-center gap-2"},ld={class:"input-group w-auto"},od={class:"text-teal-dark"},nd={key:1,class:"invalid mt-0"},rd={class:"square-title mt-4"},ad={class:"mt-4"},dd=["onClick"],sd={class:"d-flex flex-column gap-2"},cd={class:"mt-4 d-flex flex-column gap-2"},id={class:"d-flex flex-column gap-3 mt-4"},md={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},pd={class:"d-flex gap-2 align-items-center flex-grow-1"},Vd={class:"text-nowrap"},fd={class:"flex-grow-1"},Nd={class:"d-flex gap-2"},Ed=["onClick"],bd=["href"],gd=["id"],kd={class:"table align-middle gray-table side-table mb-0"},yd={class:"p-0"},ud={class:"item-list"},xd={class:"mt-2 align-self-start text-center"},hd={class:"input-group"},$d={key:0,class:"invalid mt-0"},Bd={key:0,class:"d-flex gap-2 mt-1 align-self-start"},_d=["onClick"],Cd=["onClick"],Td={class:"row"},wd={class:"col"},Dd=["value"],Sd={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Ad=["onClick"],Fd=["onClick"],Ud={class:"col"},Md=["value"],Id={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Pd=["onClick"],jd=["onClick"],Od=["onClick"],Ld={class:"mt-4"},qd={class:"table align-middle gray-table side-table"},Rd={key:0,class:"block-bottom bg-light-teal"},zd=Ka({__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.computed(()=>z("culture",l.value.Status,2)),f=e.computed(()=>m.value.EndDate),r=e.ref({}),o=e.computed(()=>c.value.filter(b=>!b.Deleted)),l=e.ref({}),c=e.ref([]),m=e.ref({}),a=()=>{F.culture("createGoal",{ID:x.id}).subscribe(b=>{c.value.push(Object.assign(b,{Items:[]}));const h=c.value[c.value.length-1];y(h)})},y=b=>{F.culture("createGoalItem",{ID:x.id,GoalID:b.ID}).subscribe(h=>{b.Items.push(Object.assign(h,{Steps:[],Schedules:[]}));const S=b.Items[b.Items.length-1];g(S),g(S),g(S),u(S,1),u(S,2)})},u=(b,h)=>F.culture("createGoalSchedule",{ID:x.id,ItemID:b.ID,Type:h}).subscribe(S=>b.Schedules.push(S)),g=b=>F.culture("createGoalStep",{ID:x.id,ItemID:b.ID}).subscribe(h=>b.Steps.push(h)),d=_,n=()=>{rxjs.forkJoin([F.culture("getWorkSchedule",{ID:x.id})]).subscribe(b=>{const h=b[0];l.value=h.Project,c.value=h.Goals,m.value=h.GrantType,c.value.length||a(),j().init("culture",l.value),p.value=l.value.changeApply,l.value.changeApply=void 0})},k=b=>b.Deleted=!0,i=b=>b.Deleted=!0,N=b=>b.Deleted=!0,V=b=>b.Deleted=!0,E=b=>{var S,w;if(r.value={},b&&!t()){e.nextTick(()=>{var U;return(U=document.querySelector(".invalid"))==null?void 0:U.scrollIntoView({behavior:"smooth",block:"center"})});return}const h={Project:l.value,Goals:c.value,Before:(S=p.value)==null?void 0:S.Form2Before,After:(w=p.value)==null?void 0:w.Form2After,Submit:b?"true":"false"};F.culture("saveWorkSchedule",h).subscribe(()=>{b?d("next"):n()})},t=()=>{let b={StartTime:"計畫期程",EndTime:"計畫期程"};r.value=I(l.value,b);const h={Title:"計畫目標",Content:"預期效益"},S={Title:"重要工作項目",Indicator:"績效指標"},w={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},U={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return c.value.filter(M=>!M.Deleted).forEach((M,A)=>{Object.assign(r.value,I(M,h,`goal-${A}-`)),M.Items.filter(C=>!C.Deleted).forEach((C,T)=>{Object.assign(r.value,I(C,S,`item-${A}-${T}-`)),C.Steps.filter(D=>!D.Deleted).forEach((D,P)=>Object.assign(r.value,I(D,w,`step-${A}-${T}-${P}-`))),C.Schedules.filter(D=>D.Type===1&&!D.Deleted).forEach((D,P)=>Object.assign(r.value,I(D,U,`schedule-${A}-${T}-1-${P}-`))),C.Schedules.filter(D=>D.Type===2&&!D.Deleted).forEach((D,P)=>Object.assign(r.value,I(D,U,`schedule-${A}-${T}-2-${P}-`)))})}),p.value&&(b={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(r.value,I(p.value,b))),!Object.keys(r.value).length};return e.onMounted(n),e.provide("editable",s),(b,h)=>{const S=e.resolveComponent("required-label"),w=e.resolveComponent("input-tw-date"),U=e.resolveComponent("tw-date"),M=e.resolveComponent("input-text"),A=e.resolveComponent("input-textarea"),C=e.resolveComponent("input-month"),T=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Za,[h[30]||(h[30]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",va,[e.createElementVNode("table",ed,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[6]||(h[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",td,[e.createElementVNode("div",ld,[e.createVNode(w,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(l).StartTime,"onUpdate:modelValue":h[0]||(h[0]=D=>e.unref(l).StartTime=D)},null,8,["max-date","modelValue"]),h[7]||(h[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(l).EndTime,"onUpdate:modelValue":h[1]||(h[1]=D=>e.unref(l).EndTime=D)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",od,[h[8]||(h[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(U,{value:e.unref(f)},null,8,["value"]),h[9]||(h[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(r).StartTime||e.unref(r).EndTime?(e.openBlock(),e.createElementBlock("div",nd,e.toDisplayString(e.unref(r).StartTime||e.unref(r).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",rd,[h[11]||(h[11]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:a,type:"button"},[...h[10]||(h[10]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",ad,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(D,P)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:D},[e.unref(s)&&e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:O=>k(D),type:"button"},"刪除",8,dd)):e.createCommentVNode("",!0),e.createElementVNode("div",sd,[h[12]||(h[12]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(r)[`goal-${P}-Title`],modelValue:D.Title,"onUpdate:modelValue":O=>D.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",cd,[h[13]||(h[13]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(A,{error:e.unref(r)[`goal-${P}-Content`],rows:"4",modelValue:D.Content,"onUpdate:modelValue":O=>D.Content=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",id,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Items.filter(O=>!O.Deleted),(O,G)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:O},[e.createElementVNode("div",md,[e.createElementVNode("div",pd,[e.createElementVNode("label",Vd,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[14]||(h[14]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",fd,[e.createVNode(M,{error:e.unref(r)[`item-${P}-${G}-Title`],modelValue:O.Title,"onUpdate:modelValue":L=>O.Title=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Nd,[e.unref(s)&&D.Items.filter(L=>!L.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(L=>i(O),["prevent"]),href:"#"},"刪除",8,Ed)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${G}`,role:"button"},"收合",8,bd)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${G}`},[e.createElementVNode("table",kd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[15]||(h[15]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",yd,[e.createElementVNode("ul",ud,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Steps.filter(L=>!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(s)}]),key:L},[e.createElementVNode("div",xd,e.toDisplayString(String.fromCharCode(65+J)),1),e.createElementVNode("div",null,[e.createVNode(M,{error:e.unref(r)[`step-${P}-${G}-${J}-Title`],placeholder:"如:進行口訪紀錄",modelValue:L.Title,"onUpdate:modelValue":q=>L.Title=q,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",hd,[e.createVNode(C,{"empty-value":0,modelValue:L.Begin,"onUpdate:modelValue":q=>L.Begin=q},null,8,["modelValue","onUpdate:modelValue"]),h[16]||(h[16]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(C,{"empty-value":0,modelValue:L.End,"onUpdate:modelValue":q=>L.End=q},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(r)[`step-${P}-${G}-${J}-Begin`]||e.unref(r)[`step-${P}-${G}-${J}-End`]?(e.openBlock(),e.createElementBlock("div",$d,e.toDisplayString(e.unref(r)[`step-${P}-${G}-${J}-Begin`]||e.unref(r)[`step-${P}-${G}-${J}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Bd,[O.Steps.filter(q=>!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:q=>V(L),type:"button"},[...h[17]||(h[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,_d)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:q=>g(O),type:"button"},[...h[18]||(h[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Cd)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[19]||(h[19]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(r)[`item-${P}-${G}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:O.Indicator,"onUpdate:modelValue":L=>O.Indicator=L,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[20]||(h[20]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Td,[e.createElementVNode("div",wd,[h[23]||(h[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Schedules.filter(L=>L.Type===1&&!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:L},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?3:4}`])},[e.createVNode(C,{error:e.unref(r)[`schedule-${P}-${G}-1-${J}-Month`],"empty-value":0,modelValue:L.Month,"onUpdate:modelValue":q=>L.Month=q},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?7:8}`])},[e.createVNode(T,{"empty-value":0,error:e.unref(r)[`schedule-${P}-${G}-1-${J}-StepID`],options:O.Steps.filter(q=>!q.Deleted),modelValue:L.StepID,"onUpdate:modelValue":q=>L.StepID=q},{default:e.withCtx(({index:q,option:X})=>[e.createElementVNode("option",{value:X.ID},e.toDisplayString(String.fromCharCode(65+q))+"."+e.toDisplayString(X.Title),9,Dd)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Sd,[O.Schedules.filter(q=>q.Type===1&&!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:q=>N(L),type:"button"},[...h[21]||(h[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ad)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:q=>u(O,1),type:"button"},[...h[22]||(h[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Fd)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Ud,[h[26]||(h[26]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(O.Schedules.filter(L=>L.Type===2&&!L.Deleted),(L,J)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:L},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?3:4}`])},[e.createVNode(C,{error:e.unref(r)[`schedule-${P}-${G}-2-${J}-Month`],"empty-value":0,modelValue:L.Month,"onUpdate:modelValue":q=>L.Month=q},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(s)?7:8}`])},[e.createVNode(T,{"empty-value":0,error:e.unref(r)[`schedule-${P}-${G}-2-${J}-StepID`],options:O.Steps.filter(q=>!q.Deleted),modelValue:L.StepID,"onUpdate:modelValue":q=>L.StepID=q},{default:e.withCtx(({index:q,option:X})=>[e.createElementVNode("option",{value:X.ID},e.toDisplayString(String.fromCharCode(65+q))+"."+e.toDisplayString(X.Title),9,Md)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Id,[O.Schedules.filter(q=>q.Type===2&&!q.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:q=>N(L),type:"button"},[...h[24]||(h[24]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Pd)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:q=>u(O,2),type:"button"},[...h[25]||(h[25]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,jd)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,gd)]))),128))]),e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:O=>y(D),type:"button"},"新增工作項目",8,Od)):e.createCommentVNode("",!0)]))),128))]),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[h[29]||(h[29]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ld,[e.createElementVNode("table",qd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[27]||(h[27]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(r).Form2Before,rows:"4",modelValue:e.unref(p).Form2Before,"onUpdate:modelValue":h[2]||(h[2]=D=>e.unref(p).Form2Before=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(S,null,{default:e.withCtx(()=>[...h[28]||(h[28]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{error:e.unref(r).Form2After,rows:"4",modelValue:e.unref(p).Form2After,"onUpdate:modelValue":h[3]||(h[3]=D=>e.unref(p).Form2After=D),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Rd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:h[4]||(h[4]=D=>E()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:h[5]||(h[5]=D=>E(!0)),type:"button"},[...h[31]||(h[31]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-84d8fceb"]]),Gd={class:"block"},Jd={class:"mt-4"},Yd={class:"table align-middle gray-table side-table"},Qd={key:0},Wd={key:1,class:"text-light-gray"},Hd={class:"d-flex flex-column gap-2"},Xd={key:0},Kd={class:"mt-4"},Zd={class:"table align-middle gray-table side-table"},vd={class:"row g-3"},es={class:"col-12 col-xl-2"},ts={class:"text-gray mb-2"},ls={class:"col-12 col-xl-3"},os={class:"text-gray mb-2"},ns={key:0,class:"col-12 col-xl-4"},rs={class:"row g-1"},as={class:"col-7"},ds={class:"col-5"},ss={key:1,class:"col-12 col-xl-3"},cs={class:"text-gray mb-2"},is={class:"mt-4"},ms={class:"table align-middle gray-table side-table"},ps={class:"d-flex align-items-center gap-2"},Vs={class:"input-group w-auto"},fs={key:0,class:"invalid mt-0"},Ns={class:"mt-4"},Es={class:"table-responsive mt-3 mb-0"},bs={class:"table align-middle gray-table"},gs={class:"text-end"},ks={class:"text-end"},ys={class:"text-end"},us={class:"text-end"},xs={class:"text-end"},hs={class:"table align-middle gray-table side-table"},$s={key:0,class:"table-responsive mt-3 mb-0"},Bs={class:"table align-middle gray-table"},_s={key:0},Cs={key:0},Ts={class:"d-flex gap-2"},ws=["onClick"],Ds={class:"mt-4"},Ss={class:"table align-middle gray-table side-table"},As={key:0,class:"block-bottom bg-light-teal"},Fs={class:"text-center"},Us={class:"mb-5"},Ms={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.ref(),r=e.computed(()=>z("education",c.value.Status,1)),o=e.ref({}),l=e.computed(()=>a.value.filter(E=>!E.Deleted)),c=e.ref({}),m=e.ref(),a=e.ref([]),y=e.ref(),u=e.ref(0),g=e.computed({get:()=>!!l.value.length,set:E=>{E?d():a.value.forEach(t=>t.Deleted=!0)}}),d=()=>a.value.push({}),n=_,k=()=>{F.education("getApplication",{ID:x.id}).subscribe(E=>{c.value=E.Project,f.value=E.Contacts,a.value=E.ReceivedSubsidies,c.value.OrgCategory=c.value.OrgCategory||null,j().init("education",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(o.value={},E&&!V()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&y.value&&c.value.ApplyAmount>y.value.GrantLimit*1e4){m.value.show(()=>N(E,!0));return}const b={Project:c.value,Contacts:f.value,ReceivedSubsidies:a.value.filter(w=>w.ID||!w.Deleted),Before:(h=s.value)==null?void 0:h.Form1Before,After:(S=s.value)==null?void 0:S.Form1After,Submit:E?"true":"false"};F.education("saveApplication",b).subscribe(w=>{E?n("next",w.ID):c.value.ID?k():window.location.href=`Application.aspx?ID=${w.ID}`})},V=()=>{let E={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return c.value.OrgCategory==="2"&&(E.RegisteredNum="立案登記證字號"),o.value=I(c.value,E),E={Name:"姓名",JobTitle:"職稱"},Object.assign(o.value,I(f.value[0],E,"contact-0-")),E.MobilePhone="手機號碼",Object.assign(o.value,I(f.value[1],E,"contact-1-")),E={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},a.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`received-${b}-`))),s.value&&(E={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([F.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(E=>{p.value=E[0],x.id?k():F.education("getEmptyApplication").subscribe(t=>{c.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),f.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("education",c.value)})})}),e.provide("editable",r),e.watch(()=>c.value.OrgCategory,()=>{F.education("getGrantTargetSetting",{TargetTypeID:`EDC${c.value.OrgCategory}`}).subscribe(E=>{y.value=E})}),e.watchEffect(()=>{u.value=R(c.value.ApplyAmount)+R(c.value.SelfAmount)+R(c.value.OtherGovAmount)+R(c.value.OtherUnitAmount)}),(E,t)=>{const b=e.resolveComponent("required-label"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-select"),w=e.resolveComponent("input-tw-date"),U=e.resolveComponent("input-textarea"),M=e.resolveComponent("input-integer"),A=e.resolveComponent("input-boolean"),C=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Gd,[t[52]||(t[52]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Jd,[e.createElementVNode("table",Yd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).Year),1)]),e.createElementVNode("tr",null,[t[21]||(t[21]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(c).ProjectID?(e.openBlock(),e.createElementBlock("span",Qd,e.toDisplayString(e.unref(c).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Wd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[22]||(t[22]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).ProjectName,modelValue:e.unref(c).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=T=>e.unref(c).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Hd,[e.createElementVNode("div",null,[e.createVNode(S,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(p),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=T=>e.unref(c).OrgCategory=T)},null,8,["error","options","modelValue"])]),e.unref(c).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Xd,[e.createVNode(h,{error:e.unref(o).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(c).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=T=>e.unref(c).RegisteredNum=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(c).OrgName,"onUpdate:modelValue":t[3]||(t[3]=T=>e.unref(c).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(c).TaxID,"onUpdate:modelValue":t[4]||(t[4]=T=>e.unref(c).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(c).Address,"onUpdate:modelValue":t[5]||(t[5]=T=>e.unref(c).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[53]||(t[53]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Kd,[e.createElementVNode("table",Zd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",vd,[e.createElementVNode("div",es,[e.createElementVNode("div",ts,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[28]||(t[28]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(h,{error:e.unref(o)[`contact-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":P=>T.Name=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ls,[e.createElementVNode("div",os,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(h,{error:e.unref(o)[`contact-${D}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":P=>T.JobTitle=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),D?(e.openBlock(),e.createElementBlock("div",ns,[t[30]||(t[30]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",rs,[e.createElementVNode("div",as,[e.createVNode(h,{modelValue:T.Phone,"onUpdate:modelValue":P=>T.Phone=P,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ds,[e.createVNode(h,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":P=>T.PhoneExt=P,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),D?(e.openBlock(),e.createElementBlock("div",ss,[e.createElementVNode("div",cs,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(h,{error:e.unref(o)[`contact-${D}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":P=>T.MobilePhone=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[54]||(t[54]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",is,[e.createElementVNode("table",ms,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[32]||(t[32]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",ps,[e.createElementVNode("div",Vs,[e.createVNode(w,{class:"w-auto",modelValue:e.unref(c).StartTime,"onUpdate:modelValue":t[6]||(t[6]=T=>e.unref(c).StartTime=T)},null,8,["modelValue"]),t[33]||(t[33]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(w,{class:"w-auto",modelValue:e.unref(c).EndTime,"onUpdate:modelValue":t[7]||(t[7]=T=>e.unref(c).EndTime=T)},null,8,["modelValue"])]),t[34]||(t[34]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",fs,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Target,modelValue:e.unref(c).Target,"onUpdate:modelValue":t[8]||(t[8]=T=>e.unref(c).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(c).Summary,"onUpdate:modelValue":t[9]||(t[9]=T=>e.unref(c).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Quantified,"onUpdate:modelValue":t[10]||(t[10]=T=>e.unref(c).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[55]||(t[55]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Ns,[t[43]||(t[43]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",Es,[e.createElementVNode("table",bs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",gs,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",ks,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",ys,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[40]||(t[40]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",us,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[41]||(t[41]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[42]||(t[42]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).ApplyAmount,modelValue:e.unref(c).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=T=>e.unref(c).ApplyAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).SelfAmount,modelValue:e.unref(c).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=T=>e.unref(c).SelfAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).OtherGovAmount,modelValue:e.unref(c).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=T=>e.unref(c).OtherGovAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).OtherUnitAmount,modelValue:e.unref(c).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=T=>e.unref(c).OtherUnitAmount=T)},null,8,["error","modelValue"])]),e.createElementVNode("td",xs,e.toDisplayString(e.unref(u).toLocaleString()),1)])])])])]),e.createElementVNode("table",hs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[44]||(t[44]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(A,{modelValue:e.unref(g),"onUpdate:modelValue":t[15]||(t[15]=T=>e.isRef(g)?g.value=T:null)},null,8,["modelValue"]),e.unref(g)?(e.openBlock(),e.createElementBlock("div",$s,[e.createElementVNode("table",Bs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[45]||(t[45]=e.createElementVNode("th",null,"計畫名稱",-1)),t[46]||(t[46]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",_s,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,D)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`received-${D}-Name`],modelValue:T.Name,"onUpdate:modelValue":P=>T.Name=P,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`received-${D}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":P=>T.Amount=P},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Cs,[e.createElementVNode("div",Ts,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:P=>i(T),type:"button"},[...t[47]||(t[47]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ws)):e.createCommentVNode("",!0),D+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[48]||(t[48]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[51]||(t[51]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Ds,[e.createElementVNode("table",Ss,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[49]||(t[49]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":t[16]||(t[16]=T=>e.unref(s).Form1Before=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[50]||(t[50]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(U,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":t[17]||(t[17]=T=>e.unref(s).Form1After=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",As,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[18]||(t[18]=T=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[19]||(t[19]=T=>N(!0)),type:"button"},[...t[56]||(t[56]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(C,{ref_key:"modal",ref:m},{default:e.withCtx(()=>{var T;return[e.createElementVNode("div",Fs,[t[57]||(t[57]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Us,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((T=e.unref(y))==null?void 0:T.GrantLimit)+"萬",1),t[58]||(t[58]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[59]||(t[59]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},Is={class:"block"},Ps={key:0,class:"text-pink lh-base mt-4"},js={class:"mt-4"},Os={class:"table align-middle gray-table"},Ls={class:"text-center"},qs={key:0,width:"180"},Rs={class:"text-center"},zs={key:0},Gs=["innerHTML"],Js=["href"],Ys={key:0,class:"text-center"},Qs={key:0},Ws={key:1,class:"text-pink"},Hs={key:1,class:"tag-group mt-2 gap-1"},Xs={key:0,class:"tag tag-green-light"},Ks=["download","href"],Zs=["onClick"],vs={class:"mt-4"},ec={class:"table align-middle gray-table side-table"},tc={key:0,class:"block-bottom bg-light-teal"},lc=["disabled"],oc={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([{Type:1,Title:"申請表",Template:"../../Template/EDC/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/EDC/2-申請計畫書.docx",Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/EDC/3-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]}]),s=e.ref(),f=e.computed(()=>p.value.some(d=>!d.Optional&&!d.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("education",l.value.Status,2)),o=e.ref({}),l=e.ref({}),c=(d,n)=>{n.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(d.Multiple?n.Name:`${d.Title}.pdf`)})},m=F.download,a=_,y=()=>{rxjs.forkJoin([F.education("getAttachment",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=p.value.filter(k=>{var i;return!((i=k.Excludes)!=null&&i.includes(l.value.OrgCategory))}),p.value.forEach(k=>{k.Files=n.Attachments.filter(i=>i.Type===k.Type),k.Uploaded=e.computed(()=>k.Files.filter(i=>!i.Deleted).length)}),j().init("education",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},u=d=>{var k,i;if(o.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:x.id,Attachments:p.value.reduce((N,V)=>N.concat(V.Files),[]),Before:(k=s.value)==null?void 0:k.Form5Before,After:(i=s.value)==null?void 0:i.Form5After,Submit:d?"true":"false"};F.education("saveAttachment",n).subscribe(()=>{d?a("next"):y()})},g=()=>{if(s.value){const d={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,d))}return!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",r),(d,n)=>{const k=e.resolveComponent("required-label"),i=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Is,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",Ps,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",js,[e.createElementVNode("table",Os,[e.createElementVNode("thead",Ls,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",qs,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",Rs,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[V.Optional?(e.openBlock(),e.createElementBlock("span",zs,e.toDisplayString(V.Title),1)):(e.openBlock(),e.createBlock(k,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Title),1)]),_:2},1024))]),e.unref(r)&&V.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:V.Comment},null,8,Gs)):e.createCommentVNode("",!0),e.unref(r)&&V.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:V.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Js)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Ys,[V.Uploaded?(e.openBlock(),e.createElementBlock("span",Qs,"已上傳")):(e.openBlock(),e.createElementBlock("span",Ws,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(V.Multiple||!V.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:t=>c(V,t)},null,8,["onFile"])):e.createCommentVNode("",!0),V.Uploaded?(e.openBlock(),e.createElementBlock("div",Hs,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Xs,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(m)(t.Path)},e.toDisplayString(t.Name),9,Ks),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:b=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Zs)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",vs,[e.createElementVNode("table",ec,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(s).Form5Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form5After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",tc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=V=>u(!0)),disabled:e.unref(f),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,lc)])):e.createCommentVNode("",!0)],64)}}},nc={class:"block"},rc={class:"text-teal fw-bold py-3"},ac={class:"text-teal fw-bold pb-3"},dc={class:"table-responsive"},sc={class:"table align-middle gray-table"},cc={class:"text-end"},ic={class:"text-end"},mc={class:"mt-4"},pc={class:"table align-middle gray-table"},Vc={class:"text-center"},fc={key:0,width:"180"},Nc={class:"text-center"},Ec=["href"],bc={key:0,class:"text-center"},gc={key:0},kc={key:1,class:"text-pink"},yc={key:1,class:"tag-group mt-2 gap-1"},uc={key:0,class:"tag tag-green-light"},xc=["download","href"],hc=["onClick"],$c={class:"block-bottom bg-light-teal"},Bc=!0,_c=3e4,Cc={__name:"Payment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(3e4),s=e.ref({}),f=e.ref([{Type:1,Title:"收支明細表",Template:"../../Template/EDC/1-收支明細表.docx",Files:[]},{Type:2,Title:"受補助清單",Template:"../../Template/EDC/2-受補助清單.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/EDC/3-經費分攤表.docx",Files:[]},{Type:4,Title:"憑證",Template:"../../Template/EDC/4-憑證.docx",Files:[]},{Type:5,Title:"領據",Template:"../../Template/EDC/5-領據.docx",Files:[]}]),r=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(m,a)=>{a.Type==="application/pdf"&&m.Files.push({Type:m.Type,Path:a.Path,Name:s.value.ProjectID+"_"+(m.Multiple?a.Name:`${m.Title}.pdf`)})},l=F.download,c=m=>{};return e.onMounted(()=>{F.education("findApplication",{ID:x.id}).subscribe(m=>{s.value=m.Project,j().init("education",s.value),f.value.forEach(a=>{a.Uploaded=e.computed(()=>a.Files.filter(y=>!y.Deleted).length)})})}),e.provide("editable",Bc),(m,a)=>{var d;const y=e.resolveComponent("input-integer"),u=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nc,[a[11]||(a[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於活動結束後一個月內提交成果報告及請款）",-1)),e.createElementVNode("p",rc,"核定經費: "+e.toDisplayString((d=e.unref(s).ApprovedAmount)==null?void 0:d.toLocaleString())+"元",1),e.createElementVNode("p",ac,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(p)).toLocaleString())+"元",1),e.createElementVNode("div",dc,[e.createElementVNode("table",sc,[a[5]||(a[5]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",cc,e.toDisplayString(e.unref(p)-_c),1),a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(p),"onUpdate:modelValue":a[0]||(a[0]=n=>e.isRef(p)?p.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",ic,e.toDisplayString(e.unref(r))+"%",1),a[4]||(a[4]=e.createElementVNode("td",{class:"text-end"},"100%",-1))])])])]),a[12]||(a[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[13]||(a[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",mc,[e.createElementVNode("table",pc,[e.createElementVNode("thead",Vc,[e.createElementVNode("tr",null,[a[6]||(a[6]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[7]||(a[7]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",fc,"狀態")),a[8]||(a[8]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(n,k)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",Nc,e.toDisplayString(k+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Ec)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",bc,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",gc,"已上傳")):(e.openBlock(),e.createElementBlock("span",kc,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:i=>o(n,i)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",yc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",uc,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(l)(i.Path)},e.toDisplayString(i.Name),9,xc),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>i.Deleted=!0,type:"button"},[...a[10]||(a[10]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,hc))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",$c,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[1]||(a[1]=n=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[2]||(a[2]=n=>c()),type:"button"},[...a[14]||(a[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Tc={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(x,p)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"education"})}}},wc={class:"modal-dialog modal-dialog-centered modal-md"},Dc={class:"modal-content"},Sc={class:"modal-body"},Ac={class:"d-flex flex-column align-items-center mb-5 gap-3"},Fc={class:"fs-18"},Uc={__name:"ErrorModal",setup(B){const _=Z(),x=e.ref();return e.onMounted(()=>x.value.addEventListener("hidden.bs.modal",()=>_.error=null)),e.watch(()=>_.error,()=>{_.error&&bootstrap.Modal.getOrCreateInstance(x.value).show()}),(p,s)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:x,tabindex:"-1"},[e.createElementVNode("div",wc,[e.createElementVNode("div",Dc,[s[2]||(s[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Sc,[e.createElementVNode("div",Ac,[s[0]||(s[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",Fc,e.toDisplayString(e.unref(_).error),1)]),s[1]||(s[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},H=Q.defineStore("grant",{actions:{init(B){this.type=B}},state:()=>({type:null,typeList:[{code:"SCI",title:"科專"},{code:"CUL",title:"文化"},{code:"EDC",title:"學校／民間"},{code:"CLB",title:"學校社團"},{code:"MUL",title:"多元"},{code:"LIT",title:"素養"},{code:"ACC",title:"無障礙"}]})}),Mc={class:"search bg-gray rounded-4 mt-4"},Ic={class:"search-form",action:""},Pc={class:"row g-3"},jc={class:"col-12 col-lg-6"},Oc={key:0,class:"rounded-4 bg-white mt-4 p-4"},Lc={class:"row"},qc={class:"col-12"},Rc={class:"row"},zc={class:"col-12 col-lg-6 d-flex justify-content-between pe-4"},Gc={class:"fw-bold text-primary fs-2"},Jc={key:1,class:"rounded-4 bg-white mt-4 py-4"},Yc={class:"row"},Qc={class:"col-12 col-lg-3"},Wc={class:"col-12 col-lg-3"},Hc={class:"col-12 col-lg-6"},Xc={key:2,class:"row"},Kc={class:"col-12 col-lg-6 pt-4"},Zc={class:"d-flex justify-content-between rounded-4 bg-white p-4"},vc={class:"fw-bold text-primary fs-2"},ei={class:"col-12 col-lg-6 pt-4"},ti={class:"d-flex justify-content-between rounded-4 bg-white p-4"},li={class:"fw-bold text-primary fs-2"},oi={class:"col-12 col-lg-6 pt-4"},ni={class:"d-flex justify-content-between rounded-4 bg-white p-4"},ri={class:"fw-bold text-primary fs-2"},ai={class:"col-12 col-lg-6 pt-4"},di={class:"d-flex justify-content-between rounded-4 bg-white p-4"},si={class:"fw-bold text-primary fs-2"},ci={class:"rounded-4 bg-white p-4 mt-4 d-flex flex-column gap-5"},ii={class:"mt-4"},mi={class:"table-responsive"},pi={class:"table align-middle gray-table"},Vi={class:"text-center"},fi={class:"text-center"},Ni={href:"Report/ApprovedList.aspx"},Ei={class:"text-end"},bi={class:"text-end"},gi={class:"block rounded-4 mt-4"},ki={class:"table-responsive",style:{"min-height":"400px"}},yi={class:"row"},ui={class:"col"},xi=["value"],hi={class:"table teal-table","aria-label":"申請計畫列表"},$i={"data-th":"年度:"},Bi={"data-th":"類別:",class:"text-start"},_i={"data-th":"補助計畫:"},Ci={"data-th":"補助對象:"},Ti={"data-th":"相關檔案:"},wi=["download","href"],Di={"data-th":"我要申請:"},Si=["href"],Ai={class:"total-list mt-4"},Fi=["href"],Ui={class:"total-item-title"},Mi={class:"total-item-content"},Ii={class:"count"},Pi={__name:"HomeDashboard",setup(B){const _=H().typeList,x=[{title:"申請中尚未提送",url:"ApplicationChecklist.aspx",count:e.computed(()=>p.value.filter(k=>[1,14].includes(k.Status)).length)},{title:"申請審查中",url:"ApplicationChecklist.aspx",count:e.computed(()=>p.value.filter(k=>[11,12,21,22,31,32,41,42,43,44].includes(k.Status)).length)},{title:"審查意見待回覆",url:"ApplicationChecklist.aspx",count:e.computed(()=>0)},{title:"執行中計畫",url:"inprogressList.aspx",count:e.computed(()=>p.value.filter(k=>[51,52].includes(k.Status)).length)},{title:"執行階段待回覆",url:"inprogressList.aspx",count:e.computed(()=>0)}],p=e.ref([]),s=e.ref([]),f=e.ref(""),r=e.ref([]),o=e.ref([]),l=e.ref([]),c=e.ref(),m=e.computed(()=>{let k=s.value;return f.value&&(k=k.filter(i=>i.tags.includes(f.value))),k}),a=e.computed(()=>c.value?l.value.filter(k=>k.Category===c.value):l.value),y=e.computed(()=>({ApprovedAmount:a.value.reduce((k,i)=>k+i.ApprovedAmount,0),RemainingAmount:a.value.reduce((k,i)=>k+i.ApprovedAmount-i.SpendAmount,0),SpendAmount:a.value.reduce((k,i)=>k+i.SpendAmount,0),PaymentAmount:a.value.reduce((k,i)=>k+i.PaymentAmount,0),BudgetFees:a.value.reduce((k,i)=>k+i.BudgetFees,0)})),u=F.download,g=k=>o.value.filter(i=>i.GrantTypeID===k.TypeCode).map((i,N)=>`${N+1}.${i.Note}`).join("<br>"),d=k=>{switch(k.TypeCode){case"SCI":return"SCI/SciApplication.aspx?GrantTypeID=SCI";case"CLB":return"CLB/ClbApplication.aspx?GrantTypeID=CLB";default:return`${k.TypeCode}/Application.aspx`}},n=(k,i,N=2)=>{if(i){const V=10**N;return Math.round(k*100/i*V)/V}return 0};return e.onMounted(()=>{F.system("dashboard").subscribe(k=>{s.value=k.GrantTypes,o.value=k.Settings,p.value=k.ApplyList,l.value=k.StatList,s.value.forEach(i=>{var N;i.tags=(N=i.TargetTags)==null?void 0:N.split(`
`).map(V=>V.trim()),i.tags.forEach(V=>{r.value.includes(V)||r.value.push(V)})})})}),(k,i)=>{const N=e.resolveComponent("input-select"),V=e.resolveComponent("report-pie-chart"),E=e.resolveComponent("report-mix-chart"),t=e.resolveComponent("tooltip");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Mc,[i[20]||(i[20]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Ic,[e.createElementVNode("div",Pc,[i[3]||(i[3]=e.createElementVNode("div",{class:"col-12 col-lg-6"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",{value:""},"114")])],-1)),e.createElementVNode("div",jc,[i[2]||(i[2]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"全部類別",-1)),e.createVNode(N,{options:e.unref(_),placeholder:"全部","text-name":"title","value-name":"code",modelValue:e.unref(c),"onUpdate:modelValue":i[0]||(i[0]=b=>e.isRef(c)?c.value=b:null)},null,8,["options","modelValue"])])]),i[4]||(i[4]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))]),e.unref(y)?(e.openBlock(),e.createElementBlock("div",Oc,[e.createElementVNode("div",Lc,[e.createElementVNode("div",qc,[e.createElementVNode("div",Rc,[e.createElementVNode("div",zc,[i[6]||(i[6]=e.createElementVNode("div",{class:"fw-bold fs-4"},"總預算經費",-1)),e.createElementVNode("div",Gc,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(y).BudgetFees/1e3).toLocaleString())+" ",1),i[5]||(i[5]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])])])])])):e.createCommentVNode("",!0),e.unref(y)?(e.openBlock(),e.createElementBlock("div",Jc,[e.createElementVNode("div",Yc,[e.createElementVNode("div",Qc,[i[7]||(i[7]=e.createElementVNode("div",{class:"text-center fs-4 fw-bold mb-4"},"經費執行率",-1)),e.createVNode(V,{active:"已執行",color:9323693,inactive:"未執行",percent:n(e.unref(y).SpendAmount,e.unref(y).ApprovedAmount,1),style:{width:"100%",height:"300px"}},null,8,["percent"])]),e.createElementVNode("div",Wc,[i[8]||(i[8]=e.createElementVNode("div",{class:"text-center fs-4 fw-bold mb-4"},"支用比",-1)),e.createVNode(V,{active:"已支用",color:3447003,inactive:"未支用",percent:Math.min(n(e.unref(y).SpendAmount,e.unref(y).PaymentAmount,1),100),style:{width:"100%",height:"300px"}},null,8,["percent"])]),e.createElementVNode("div",Hc,[i[9]||(i[9]=e.createElementVNode("div",{class:"d-flex justify-content-between align-items-center mb-4"},[e.createElementVNode("span",{class:"fs-4 fw-bold"},"各類經費執行情形")],-1)),i[10]||(i[10]=e.createElementVNode("div",{class:"fs-6 text-end text-secondary me-5"},"單位：千元",-1)),e.createVNode(E,{list:e.unref(l),style:{width:"100%",height:"300px"}},null,8,["list"])])])])):e.createCommentVNode("",!0),e.unref(y)?(e.openBlock(),e.createElementBlock("div",Xc,[e.createElementVNode("div",Kc,[e.createElementVNode("div",Zc,[i[12]||(i[12]=e.createElementVNode("div",{class:"fw-bold fs-4"},"核定補助經費",-1)),e.createElementVNode("div",vc,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(y).ApprovedAmount/1e3).toLocaleString())+" ",1),i[11]||(i[11]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])]),e.createElementVNode("div",ei,[e.createElementVNode("div",ti,[i[14]||(i[14]=e.createElementVNode("div",{class:"fw-bold fs-4"},"賸餘款",-1)),e.createElementVNode("div",li,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(y).RemainingAmount/1e3).toLocaleString())+" ",1),i[13]||(i[13]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])]),e.createElementVNode("div",oi,[e.createElementVNode("div",ni,[i[16]||(i[16]=e.createElementVNode("div",{class:"fw-bold fs-4"},"實支金額",-1)),e.createElementVNode("div",ri,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(y).SpendAmount/1e3).toLocaleString())+" ",1),i[15]||(i[15]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])]),e.createElementVNode("div",ai,[e.createElementVNode("div",di,[i[18]||(i[18]=e.createElementVNode("div",{class:"fw-bold fs-4"},"已撥付",-1)),e.createElementVNode("div",si,[e.createTextVNode(e.toDisplayString(Math.floor(e.unref(y).PaymentAmount/1e3).toLocaleString())+" ",1),i[17]||(i[17]=e.createElementVNode("span",{class:"fs-6 text-black"},"千元",-1))])])])])):e.createCommentVNode("",!0),e.createElementVNode("div",ci,[e.createElementVNode("div",null,[e.createElementVNode("div",ii,[e.createElementVNode("div",mi,[e.createElementVNode("table",pi,[i[19]||(i[19]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-center"},"類別"),e.createElementVNode("th",{class:"text-center"},"核定件數"),e.createElementVNode("th",{class:"text-end"},"核定補助經費"),e.createElementVNode("th",{class:"text-end"},"經費執行率")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),b=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Vi,e.toDisplayString(e.unref(_).find(h=>h.code===b.Category).title),1),e.createElementVNode("td",fi,[e.createElementVNode("a",Ni,e.toDisplayString(b.Count),1)]),e.createElementVNode("td",Ei,e.toDisplayString(b.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",bi,e.toDisplayString(n(b.SpendAmount,b.ApprovedAmount))+"%",1)]))),128))])])])])])])]),e.createElementVNode("div",gi,[e.createElementVNode("div",ki,[e.createElementVNode("div",yi,[e.createElementVNode("div",ui,[i[22]||(i[22]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"依身分篩選適用規定",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":i[1]||(i[1]=b=>e.isRef(f)?f.value=b:null)},[i[21]||(i[21]=e.createElementVNode("option",{value:""},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),b=>(e.openBlock(),e.createElementBlock("option",{key:b,value:b},e.toDisplayString(b),9,xi))),128))],512),[[e.vModelSelect,e.unref(f)]])])]),e.createElementVNode("table",hi,[i[25]||(i[25]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col"},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"類別"),e.createElementVNode("th",{scope:"col"},"補助計畫"),e.createElementVNode("th",{scope:"col"},"補助對象"),e.createElementVNode("th",{scope:"col"},"相關檔案"),e.createElementVNode("th",{scope:"col"})])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),b=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",$i,e.toDisplayString(b.Year),1),e.createElementVNode("td",Bi,e.toDisplayString(b.ShortName),1),e.createElementVNode("td",_i,e.toDisplayString(b.FullName),1),e.createElementVNode("td",Ci,[e.createVNode(t,{"data-bs-html":"true",title:g(b)},null,8,["title"])]),e.createElementVNode("td",Ti,[b.Path?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark",download:b.Filename,href:e.unref(u)(b.Path),style:{display:"inline"}},[...i[23]||(i[23]=[e.createElementVNode("i",{class:"fas fa-file-alt"},null,-1)])],8,wi)):e.createCommentVNode("",!0)]),e.createElementVNode("td",Di,[e.createElementVNode("a",{class:"btn btn-teal-dark",href:d(b),target:"_blank"},[...i[24]||(i[24]=[e.createElementVNode("i",{class:"fa-solid"},null,-1),e.createTextVNode("我要申請",-1)])],8,Si)])]))),128))])])])]),e.createElementVNode("ul",Ai,[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(x,b=>e.createElementVNode("li",{class:"total-item",key:b},[e.createElementVNode("a",{href:b.url},[e.createElementVNode("div",Ui,e.toDisplayString(b.title),1),e.createElementVNode("div",Mi,[e.createElementVNode("span",Ii,e.toDisplayString(b.count),1),i[26]||(i[26]=e.createElementVNode("span",{class:"unit"},"件",-1))])],8,Fi)])),64))])],64)}}},ji={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const _=e.useModel(B,"modelValue"),x=[{value:!0,text:"是"},{value:!1,text:"否"}];return(p,s)=>{const f=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(f,{options:x,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=r=>_.value=r)},null,8,["modelValue"])}}},Oi=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(B,{emit:_}){const x=e.ref(),p=()=>{Array.from(x.value.files).forEach(f=>F.upload(f).subscribe(r=>s("file",r))),x.value.value=""},s=_;return(f,r)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:r[0]||(r[0]=o=>e.unref(x).click()),type:"button"},[...r[1]||(r[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:p,class:"d-none",ref_key:"input",ref:x,type:"file"},f.$attrs),null,16)],64))}}),Li=["disabled","placeholder","type"],qi={key:0,class:"invalid mt-0"},Ri=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),x=e.useModel(B,"modelValue");return e.watch(x,p=>{if(p){const s=(parseInt(p)||0).toString();p.toString()!==s&&(x.value=s)}}),(p,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?B.placeholder:"",style:{"text-align":"right"},type:B.type},p.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=f=>x.value=f)}),null,16,Li),[[e.vModelDynamic,x.value]]),B.error?(e.openBlock(),e.createElementBlock("div",qi,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),zi={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const _=e.useModel(B,"modelValue"),x=[];for(let p=1;p<=12;p++)x.push({value:p,text:`${p}月`});return(p,s)=>{const f=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(f,{options:x,modelValue:_.value,"onUpdate:modelValue":s[0]||(s[0]=r=>_.value=r)},null,8,["modelValue"])}}},Gi=["onChange","checked","disabled","id","value"],Ji=["for"],Yi={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>re(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),x=e.useModel(B,"modelValue"),p=s=>{x.value=s};return(s,f)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,r=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:r},[e.createElementVNode("input",{onChange:o=>p(r[B.valueName]),checked:r[B.valueName]===x.value,class:"form-check-input",disabled:!e.unref(_),id:`${B.id}-${r[B.valueName]}`,type:"radio",value:r[B.valueName]},null,40,Gi),e.createElementVNode("label",{class:"form-check-label",for:`${B.id}-${r[B.valueName]}`},e.toDisplayString(r[B.textName]),9,Ji)]))),128))}},Qi=["disabled"],Wi=["value"],Hi=["value"],Xi={key:0,class:"invalid mt-0"},Ki=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),x=e.useModel(B,"modelValue");return(p,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:B.disabled||!e.unref(_)},p.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=f=>x.value=f)}),[e.unref(_)&&!x.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:B.emptyValue},e.toDisplayString(B.placeholder),9,Wi)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,(f,r)=>e.renderSlot(p.$slots,"default",{key:f,index:r,option:f},()=>[e.createElementVNode("option",{value:f[B.valueName]},e.toDisplayString(f[B.textName]),9,Hi)])),128))],16,Qi),[[e.vModelSelect,x.value]]),B.error?(e.openBlock(),e.createElementBlock("div",Xi,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),Zi={class:"input-group"},vi={key:0,class:"input-group-text"},em=["disabled","placeholder","type"],tm={key:0,class:"invalid mt-0"},lm=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),x=e.useModel(B,"modelValue"),p=B;return p.maxLength&&e.watch(x,()=>{var s;((s=x.value)==null?void 0:s.length)>p.maxLength&&(x.value=x.value.substring(0,p.maxLength))}),(s,f)=>{const r=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Zi,[B.prefix?(e.openBlock(),e.createElementBlock("span",vi,[e.createVNode(r,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?B.placeholder:"",type:B.type},s.$attrs,{"onUpdate:modelValue":f[0]||(f[0]=o=>x.value=o)}),null,16,em),[[e.vModelDynamic,x.value]])]),B.error?(e.openBlock(),e.createElementBlock("div",tm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),om=["disabled","placeholder"],nm={key:0,class:"fs-14 text-gray mt-2"},rm={class:"text-pink"},am={key:1,class:"invalid mt-0"},dm=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const _=e.inject("editable",!0),x=e.useModel(B,"modelValue"),p=B;return p.maxLength&&e.watch(x,()=>{var s;((s=x.value)==null?void 0:s.length)>p.maxLength&&(x.value=x.value.substring(0,p.maxLength))}),(s,f)=>{var r;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(_),placeholder:e.unref(_)?B.placeholder:""},s.$attrs,{"onUpdate:modelValue":f[0]||(f[0]=o=>x.value=o)}),null,16,om),[[e.vModelText,x.value]]),e.unref(_)&&B.maxLength?(e.openBlock(),e.createElementBlock("div",nm,[f[1]||(f[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",rm,e.toDisplayString(((r=x.value)==null?void 0:r.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(B.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),B.error?(e.openBlock(),e.createElementBlock("div",am,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),sm=["disabled"],cm={key:0,class:"invalid"},im=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(B,{emit:_}){let x;const p=B,s=e.ref(),f=e.inject("editable",!0),r=e.ref(),o=_,l=c=>{!c&&p.modelValue&&(c=moment(new Date(p.modelValue))),c?(s.value=c.format(p.displayFormat),o("update:modelValue",c.format(p.format))):(s.value="",o("update:modelValue","")),x.setStartDate(s.value||void 0)};return e.onMounted(()=>{const c=$(r.value);c.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:p.drops,locale:{format:p.displayFormat},maxDate:p.maxDate?new Date(p.maxDate):p.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(m,a)=>l(a.startDate)),x=c.data("daterangepicker"),l()}),e.onUnmounted(()=>x.remove()),e.watch(()=>p.modelValue,()=>l()),(c,m)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(f),ref_key:"element",ref:r,type:"text"},c.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=a=>e.isRef(s)?s.value=a:null)}),null,16,sm),[[e.vModelText,e.unref(s)]]),B.error?(e.openBlock(),e.createElementBlock("div",cm,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),mm={key:0,class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},pm={class:"pagination","aria-label":"Pagination"},Vm=["disabled"],fm={key:1,class:"pagination-item ellipsis",type:"button"},Nm=["onClick"],Em={class:"page-number"},bm={key:2,class:"pagination-item ellipsis",type:"button"},gm={class:"page-number"},km=["disabled"],ym={class:"page-number-control"},um={class:"page-number-control-item"},xm=["selected","value"],hm={class:"page-number-control-item"},$m=["value","selected"],Bm={__name:"ListPager",props:{count:{required:!0,type:Number},page:{required:!0,type:Number},pageSize:{required:!0,type:Number},slots:{default:3,type:Number}},emits:["change"],setup(B,{emit:_}){const x={},p=B,s=e.computed(()=>Math.ceil(p.count/p.pageSize)),f=(o,l)=>{l&&(o=Math.min(o,Math.ceil(p.count/l))),1<=o&&o<=s.value&&r("change",o,l||p.pageSize)},r=_;return e.watchEffect(()=>{x.from=p.page-parseInt(p.slots/2),x.to=p.page+parseInt((p.slots-1)/2),x.pages=[];for(let o=x.from;o<=x.to;o++)0<o&&o<=s.value&&x.pages.push(o)}),(o,l)=>p.count?(e.openBlock(),e.createElementBlock("div",mm,[e.createElementVNode("nav",pm,[e.createElementVNode("button",{"aria-label":"Previous page",class:"nav-button",onClick:l[0]||(l[0]=c=>f(B.page-1)),disabled:B.page===1,type:"button"},[...l[6]||(l[6]=[e.createElementVNode("i",{class:"fas fa-chevron-left"},null,-1)])],8,Vm),x.from>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"pagination-item",onClick:l[1]||(l[1]=c=>f(1)),type:"button"},[...l[7]||(l[7]=[e.createElementVNode("span",{class:"page-number"},"1",-1)])])):e.createCommentVNode("",!0),x.from>2?(e.openBlock(),e.createElementBlock("button",fm,[...l[8]||(l[8]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(x.pages,c=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["pagination-item",{active:B.page===c}]),onClick:m=>f(c),key:c,type:"button"},[e.createElementVNode("span",Em,e.toDisplayString(c),1)],10,Nm))),128)),e.unref(s)>x.to+1?(e.openBlock(),e.createElementBlock("button",bm,[...l[9]||(l[9]=[e.createElementVNode("span",null,"...",-1)])])):e.createCommentVNode("",!0),e.unref(s)>x.to?(e.openBlock(),e.createElementBlock("button",{key:3,class:"pagination-item",onClick:l[2]||(l[2]=c=>f(e.unref(s))),type:"button"},[e.createElementVNode("span",gm,e.toDisplayString(e.unref(s)),1)])):e.createCommentVNode("",!0),e.createElementVNode("button",{"aria-label":"Next page",class:"nav-button",onClick:l[3]||(l[3]=c=>f(B.page+1)),type:"button",disabled:B.page===e.unref(s)},[...l[10]||(l[10]=[e.createElementVNode("i",{class:"fas fa-chevron-right"},null,-1)])],8,km)]),e.createElementVNode("div",ym,[e.createElementVNode("div",um,[l[11]||(l[11]=e.createElementVNode("span",null,"跳到",-1)),e.createElementVNode("select",{onChange:l[4]||(l[4]=c=>f(c.target.value)),class:"form-select jump-to-page"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),c=>(e.openBlock(),e.createElementBlock("option",{key:c,selected:c===B.page,value:c},e.toDisplayString(c),9,xm))),128))],32),l[12]||(l[12]=e.createElementVNode("span",null,"頁",-1)),l[13]||(l[13]=e.createElementVNode("span",null,",",-1))]),e.createElementVNode("div",hm,[l[14]||(l[14]=e.createElementVNode("span",null,"每頁顯示",-1)),e.createElementVNode("select",{onChange:l[5]||(l[5]=c=>f(B.page,c.target.value)),class:"form-select"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList([10,20,30],c=>e.createElementVNode("option",{value:c,selected:c===B.pageSize},e.toDisplayString(c),9,$m)),64))],32),l[15]||(l[15]=e.createElementVNode("span",null,"筆",-1))])])])):e.createCommentVNode("",!0)}},_m={class:"block"},Cm={class:"mt-4"},Tm={class:"table align-middle gray-table side-table"},wm={key:0},Dm={key:1,class:"text-light-gray"},Sm={class:"mt-4"},Am={class:"table align-middle gray-table side-table"},Fm={class:"row g-3"},Um={class:"col-12 col-xl-2"},Mm={class:"text-gray mb-2"},Im={class:"col-12 col-xl-3"},Pm={class:"text-gray mb-2"},jm={class:"col-12 col-xl-4"},Om={class:"row g-1"},Lm={class:"col-7"},qm={class:"col-5"},Rm={class:"col-12 col-xl-3"},zm={class:"text-gray mb-2"},Gm={class:"col-12"},Jm={class:"text-gray mb-2"},Ym={class:"mt-4"},Qm={class:"table align-middle gray-table side-table"},Wm={class:"mt-4"},Hm={class:"table align-middle gray-table side-table"},Xm={key:0,class:"table-responsive mt-3 mb-0"},Km={class:"table align-middle gray-table"},Zm={key:0},vm={key:0},ep={class:"d-flex gap-2"},tp=["onClick"],lp={class:"mt-4"},op={class:"table align-middle gray-table side-table"},np={key:0,class:"block-bottom bg-light-teal"},rp={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.ref(),f=e.computed(()=>z("literacy",c.value.Status,1)),r=e.ref({}),o=e.ref([]),l=e.computed(()=>m.value.filter(i=>!i.Deleted)),c=e.ref({}),m=e.ref([]),a=e.computed({get:()=>!!l.value.length,set:i=>{i?y():m.value.forEach(N=>N.Deleted=!0)}}),y=()=>m.value.push({}),u=_,g=()=>{F.literacy("getApplication",{ID:x.id}).subscribe(i=>{c.value=i.Project,p.value=i.Contacts,m.value=i.PreviousStudies,j().init("literacy",c.value),s.value=c.value.changeApply,c.value.changeApply=void 0})},d=i=>i.Deleted=!0,n=i=>{var V,E;if(r.value={},i&&!k()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:c.value,Contacts:p.value,PreviousStudies:m.value.filter(t=>t.ID||!t.Deleted),Before:(V=s.value)==null?void 0:V.Form1Before,After:(E=s.value)==null?void 0:E.Form1After,Submit:i?"true":"false"};F.literacy("saveApplication",N).subscribe(t=>{i?u("next",t.ID):c.value.ID?g():window.location.href=`Application.aspx?ID=${t.ID}`})},k=()=>{let i={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return r.value=I(c.value,i),i={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},p.value.forEach((N,V)=>Object.assign(r.value,I(N,i,`contact-${V}-`))),i={Title:"研習/課程名稱",TheDate:"辦理日期"},m.value.forEach((N,V)=>Object.assign(r.value,I(N,i,`study-${V}-`))),s.value&&(i={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(r.value,I(s.value,i))),!Object.keys(r.value).length};return e.onMounted(()=>{rxjs.forkJoin([F.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(i=>{o.value=i[0],x.id?g():F.literacy("getEmptyApplication").subscribe(N=>{c.value=Object.assign({Field:null,FormStep:1,Status:1},N),p.value=[{Role:"申請人"}],j().init("literacy",c.value)})})}),e.provide("editable",f),e.watch(()=>[c.value.Field,c.value.OrgName],()=>{var i;if(f.value){const N=[];c.value.Field&&N.push((i=o.value.find(V=>V.Code===c.value.Field))==null?void 0:i.Descname),c.value.OrgName&&N.push(c.value.OrgName),c.value.ProjectName=N.join("-")}}),(i,N)=>{const V=e.resolveComponent("required-label"),E=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),b=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-boolean"),S=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",_m,[N[40]||(N[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Cm,[e.createElementVNode("table",Tm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[14]||(N[14]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).Year),1)]),e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(c).ProjectID?(e.openBlock(),e.createElementBlock("span",wm,e.toDisplayString(e.unref(c).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Dm,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[16]||(N[16]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(c).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[17]||(N[17]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{disabled:"",modelValue:e.unref(c).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=w=>e.unref(c).ProjectName=w),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(r).Field,options:e.unref(o),"text-name":"Descname","value-name":"Code",modelValue:e.unref(c).Field,"onUpdate:modelValue":N[1]||(N[1]=w=>e.unref(c).Field=w)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(r).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(c).OrgName,"onUpdate:modelValue":N[2]||(N[2]=w=>e.unref(c).OrgName=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(r).OrgLeader,modelValue:e.unref(c).OrgLeader,"onUpdate:modelValue":N[3]||(N[3]=w=>e.unref(c).OrgLeader=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(r).Address,placeholder:"請輸入地址",modelValue:e.unref(c).Address,"onUpdate:modelValue":N[4]||(N[4]=w=>e.unref(c).Address=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[41]||(N[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Sm,[e.createElementVNode("table",Am,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(w.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Fm,[e.createElementVNode("div",Um,[e.createElementVNode("div",Mm,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(r)[`contact-${U}-Name`],modelValue:w.Name,"onUpdate:modelValue":M=>w.Name=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Im,[e.createElementVNode("div",Pm,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(r)[`contact-${U}-JobTitle`],modelValue:w.JobTitle,"onUpdate:modelValue":M=>w.JobTitle=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",jm,[N[24]||(N[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Om,[e.createElementVNode("div",Lm,[e.createVNode(E,{modelValue:w.Phone,"onUpdate:modelValue":M=>w.Phone=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",qm,[e.createVNode(E,{placeholder:"請輸入分機",size:"4",modelValue:w.PhoneExt,"onUpdate:modelValue":M=>w.PhoneExt=M,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Rm,[e.createElementVNode("div",zm,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[25]||(N[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(r)[`contact-${U}-MobilePhone`],modelValue:w.MobilePhone,"onUpdate:modelValue":M=>w.MobilePhone=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Gm,[e.createElementVNode("div",Jm,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(E,{error:e.unref(r)[`contact-${U}-EMail`],modelValue:w.EMail,"onUpdate:modelValue":M=>w.EMail=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[42]||(N[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Ym,[e.createElementVNode("table",Qm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[28]||(N[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(b,{error:e.unref(r).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(c).Target,"onUpdate:modelValue":N[5]||(N[5]=w=>e.unref(c).Target=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[29]||(N[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(c).Summary,"onUpdate:modelValue":N[6]||(N[6]=w=>e.unref(c).Summary=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Quantified,"onUpdate:modelValue":N[7]||(N[7]=w=>e.unref(c).Quantified=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(c).Qualitative,"onUpdate:modelValue":N[8]||(N[8]=w=>e.unref(c).Qualitative=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Wm,[e.createElementVNode("table",Hm,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[36]||(N[36]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(h,{modelValue:e.unref(a),"onUpdate:modelValue":N[9]||(N[9]=w=>e.isRef(a)?a.value=w:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Xm,[e.createElementVNode("table",Km,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[32]||(N[32]=e.createElementVNode("th",null,"研習/課程名稱",-1)),N[33]||(N[33]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",Zm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(w,U)=>(e.openBlock(),e.createElementBlock("tr",{key:w},[e.createElementVNode("td",null,[e.createVNode(E,{error:e.unref(r)[`study-${U}-Title`],modelValue:w.Title,"onUpdate:modelValue":M=>w.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(r)[`study-${U}-TheDate`],modelValue:w.TheDate,"onUpdate:modelValue":M=>w.TheDate=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",vm,[e.createElementVNode("div",ep,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>d(w),type:"button"},[...N[34]||(N[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,tp)):e.createCommentVNode("",!0),U+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:y,type:"button"},[...N[35]||(N[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[N[39]||(N[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",lp,[e.createElementVNode("table",op,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[37]||(N[37]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":N[10]||(N[10]=w=>e.unref(s).Form1Before=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(V,null,{default:e.withCtx(()=>[...N[38]||(N[38]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":N[11]||(N[11]=w=>e.unref(s).Form1After=w),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",np,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[12]||(N[12]=w=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[13]||(N[13]=w=>n(!0)),type:"button"},[...N[43]||(N[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ap={class:"block"},dp={key:0,class:"text-pink lh-base mt-4"},sp={class:"mt-4"},cp={class:"table align-middle gray-table"},ip={class:"text-center"},mp={key:0,width:"180"},pp={class:"text-center"},Vp={key:0},fp=["innerHTML"],Np=["href"],Ep={key:0,class:"text-center"},bp={key:0},gp={key:1,class:"text-pink"},kp={key:1,class:"tag-group mt-2 gap-1"},yp={key:0,class:"tag tag-green-light"},up=["download","href"],xp=["onClick"],hp={class:"mt-4"},$p={class:"table align-middle gray-table side-table"},Bp={key:0,class:"block-bottom bg-light-teal"},_p=["disabled"],Cp={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([{Type:1,Title:"申請表",Template:"../../Template/LIT/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/LIT/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/LIT/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/LIT/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"著作權授權同意書",Template:"../../Template/LIT/5-著作權授權同意書.docx",Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),f=e.computed(()=>p.value.some(d=>!d.Optional&&!d.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("literacy",l.value.Status,2)),o=e.ref({}),l=e.ref({}),c=(d,n)=>{n.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(d.Multiple?n.Name:`${d.Title}.pdf`)})},m=F.download,a=_,y=()=>{rxjs.forkJoin([F.literacy("getAttachment",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=p.value.filter(k=>{var i;return!((i=k.Excludes)!=null&&i.includes(l.value.OrgCategory))}),p.value.forEach(k=>{k.Files=n.Attachments.filter(i=>i.Type===k.Type),k.Uploaded=e.computed(()=>k.Files.filter(i=>!i.Deleted).length)}),j().init("literacy",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},u=d=>{var k,i;if(o.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:x.id,Attachments:p.value.reduce((N,V)=>N.concat(V.Files),[]),Before:(k=s.value)==null?void 0:k.Form5Before,After:(i=s.value)==null?void 0:i.Form5After,Submit:d?"true":"false"};F.literacy("saveAttachment",n).subscribe(()=>{d?a("next"):y()})},g=()=>{if(s.value){const d={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,d))}return!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",r),(d,n)=>{const k=e.resolveComponent("required-label"),i=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ap,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",dp,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",sp,[e.createElementVNode("table",cp,[e.createElementVNode("thead",ip,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",mp,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",pp,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[V.Optional?(e.openBlock(),e.createElementBlock("span",Vp,e.toDisplayString(V.Title),1)):(e.openBlock(),e.createBlock(k,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Title),1)]),_:2},1024))]),e.unref(r)&&V.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:V.Comment},null,8,fp)):e.createCommentVNode("",!0),e.unref(r)&&V.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:V.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,Np)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Ep,[V.Uploaded?(e.openBlock(),e.createElementBlock("span",bp,"已上傳")):(e.openBlock(),e.createElementBlock("span",gp,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(V.Multiple||!V.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:t=>c(V,t)},null,8,["onFile"])):e.createCommentVNode("",!0),V.Uploaded?(e.openBlock(),e.createElementBlock("div",kp,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",yp,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(m)(t.Path)},e.toDisplayString(t.Name),9,up),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:b=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,xp)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",hp,[e.createElementVNode("table",$p,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(s).Form5Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form5After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Bp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=V=>u(!0)),disabled:e.unref(f),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,_p)])):e.createCommentVNode("",!0)],64)}}},Tp={class:"block"},wp={class:"mt-4"},Dp={class:"table-responsive mt-3 mb-0"},Sp={class:"table align-middle gray-table"},Ap={key:0,width:"1"},Fp={key:0},Up={class:"d-flex gap-2"},Mp=["onClick"],Ip={class:"table-responsive mt-3 mb-0"},Pp={class:"table align-middle gray-table"},jp={class:"mt-4"},Op={class:"table align-middle gray-table side-table"},Lp={key:0,class:"block-bottom bg-light-teal"},qp={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.computed(()=>z("literacy",l.value.Status,4)),r=e.ref({}),o=e.computed(()=>p.value.filter(d=>!d.Deleted)),l=e.ref({}),c=()=>p.value.push({}),m=_,a=()=>{rxjs.forkJoin([F.literacy("getBenefit",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=n.Benefits,p.value.length||c(),j().init("literacy",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},y=d=>d.Deleted=!0,u=d=>{var k,i;if(r.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Benefits:p.value,Before:(k=s.value)==null?void 0:k.Form4Before,After:(i=s.value)==null?void 0:i.Form4After,Submit:d?"true":"false"};F.literacy("saveBenefit",n).subscribe(()=>{d?m("next"):a()})},g=()=>{let d={Benefit:"不可量化成果"};return r.value=I(l.value,d),d={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((n,k)=>Object.assign(r.value,I(n,d,`item-${k}-`))),s.value&&(d={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(r.value,I(s.value,d))),!Object.keys(r.value).length};return e.onMounted(a),e.provide("editable",f),(d,n)=>{const k=e.resolveComponent("input-text"),i=e.resolveComponent("input-textarea"),N=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Tp,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",wp,[e.createElementVNode("div",Dp,[e.createElementVNode("table",Sp,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",Ap,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(r)[`item-${E}-Title`],modelValue:V.Title,"onUpdate:modelValue":t=>V.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(r)[`item-${E}-Target`],modelValue:V.Target,"onUpdate:modelValue":t=>V.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r)[`item-${E}-Description`],rows:"1",modelValue:V.Description,"onUpdate:modelValue":t=>V.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",Fp,[e.createElementVNode("div",Up,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>y(V),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Mp)):e.createCommentVNode("",!0),E+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Ip,[e.createElementVNode("table",Pp,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(l).Benefit=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",jp,[e.createElementVNode("table",Op,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form4Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":n[2]||(n[2]=V=>e.unref(s).Form4After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",Lp,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=V=>u(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Rp={class:"block"},zp={class:"mt-4"},Gp={class:"table-responsive mt-3 mb-0"},Jp={class:"table align-middle gray-table"},Yp={class:"text-end"},Qp={class:"text-end"},Wp={class:"table-responsive"},Hp={class:"table align-middle gray-table"},Xp=["colspan"],Kp={key:0,width:"1"},Zp={class:"text-end"},vp={key:0},eV={class:"d-flex gap-2"},tV=["onClick"],lV={class:"mt-4"},oV={class:"table-responsive mt-3 mb-0"},nV={class:"table align-middle gray-table"},rV={key:0,width:"1"},aV={class:"text-end"},dV={key:0},sV={class:"d-flex gap-2"},cV=["onClick"],iV={class:"mt-4"},mV={class:"table align-middle gray-table side-table"},pV={key:0,class:"block-bottom bg-light-teal"},VV={class:"text-center"},fV={class:"mb-5"},NV={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.computed(()=>z("literacy",l.value.Status,3)),f=e.ref({}),r=e.computed(()=>m.value.filter(E=>!E.Deleted)),o=e.computed(()=>a.value.filter(E=>!E.Deleted)),l=e.ref({}),c=e.ref(),m=e.ref([]),a=e.ref([]),y=e.ref({}),u=e.ref(0),g=()=>m.value.push({}),d=()=>a.value.push({}),n=_,k=()=>{rxjs.forkJoin([F.literacy("getFunding",{ID:x.id})]).subscribe(E=>{const t=E[0];l.value=t.Project,m.value=t.OtherSubsidies,a.value=t.BudgetPlans,y.value=t.GrantTargetSetting,m.value.length||g(),a.value.length||d(),j().init("literacy",l.value),p.value=l.value.changeApply,l.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(f.value={},E&&!V()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>y.value.GrantLimit*1e4){c.value.show(()=>N(E,!0));return}const b={Project:l.value,OtherSubsidies:m.value,BudgetPlans:a.value,Before:(h=p.value)==null?void 0:h.Form3Before,After:(S=p.value)==null?void 0:S.Form3After,Submit:E?"true":"false"};F.literacy("saveFunding",b).subscribe(()=>{E?n("next"):k()})},V=()=>{let E={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=I(l.value,E),E={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},m.value.forEach((t,b)=>Object.assign(f.value,I(t,E,`other-${b}-`))),E={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,b)=>Object.assign(f.value,I(t,E,`plan-${b}-`))),p.value&&(E={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,I(p.value,E))),!Object.keys(f.value).length};return e.onMounted(k),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=r.value.reduce((E,t)=>E+R(t.Amount),0),u.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),r.value.forEach(E=>E.percent=Math.round(R(E.Amount)/l.value.OtherAmount*1e4)/100),a.value.forEach(E=>E.sum=R(E.Amount)+R(E.OtherAmount))}),(E,t)=>{var M;const b=e.resolveComponent("input-integer"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),U=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Rp,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",zp,[e.createElementVNode("div",Gp,[e.createElementVNode("table",Jp,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=A=>e.unref(l).ApplyAmount=A)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=A=>e.unref(l).SelfAmount=A)},null,8,["error","modelValue"])]),e.createElementVNode("td",Yp,e.toDisplayString((M=e.unref(l).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",Qp,e.toDisplayString(e.unref(u).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Wp,[e.createElementVNode("table",Hp,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Xp)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",Kp,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(A,C)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(f)[`other-${C}-Unit`],modelValue:A.Unit,"onUpdate:modelValue":T=>A.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`other-${C}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":T=>A.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Zp,e.toDisplayString(A.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`other-${C}-Content`],rows:"1",modelValue:A.Content,"onUpdate:modelValue":T=>A.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",vp,[e.createElementVNode("div",eV,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>i(A),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,tV)):e.createCommentVNode("",!0),C+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",lV,[e.createElementVNode("div",oV,[e.createElementVNode("table",nV,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",rV,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(A,C)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(f)[`plan-${C}-Title`],modelValue:A.Title,"onUpdate:modelValue":T=>A.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`plan-${C}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":T=>A.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`plan-${C}-OtherAmount`],modelValue:A.OtherAmount,"onUpdate:modelValue":T=>A.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",aV,e.toDisplayString(A.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`plan-${C}-Description`],rows:"1",modelValue:A.Description,"onUpdate:modelValue":T=>A.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",dV,[e.createElementVNode("div",sV,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>i(A),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,cV)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",iV,[e.createElementVNode("table",mV,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(p).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=A=>e.unref(p).Form3Before=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(p).Form3After,"onUpdate:modelValue":t[3]||(t[3]=A=>e.unref(p).Form3After=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",pV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=A=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=A=>N(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(U,{ref_key:"modal",ref:c},{default:e.withCtx(()=>[e.createElementVNode("div",VV,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",fV,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(y).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},EV={class:"block"},bV={class:"text-teal fw-bold py-3"},gV={class:"table-responsive"},kV={class:"table align-middle gray-table"},yV={class:"text-end"},uV={class:"mt-4"},xV={class:"table align-middle gray-table"},hV={class:"text-center"},$V={key:0,width:"180"},BV={class:"text-center"},_V=["href"],CV={key:0,class:"text-center"},TV={key:0},wV={key:1,class:"text-pink"},DV={key:1,class:"tag-group mt-2 gap-1"},SV={key:0,class:"tag tag-green-light"},AV=["download","href"],FV=["onClick"],UV={class:"block-bottom bg-light-teal"},MV=!0,IV={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(0),s=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]}]);e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0);const r=(c,m)=>{m.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:m.Path,Name:s.value.ProjectID+"_請款_"+(c.Multiple?m.Name:`${c.Title}.pdf`)})},o=F.download,l=c=>{};return e.onMounted(()=>{F.literacy("findApplication",{ID:x.id}).subscribe(c=>{s.value=c.Project,j().init("literacy",s.value),f.value=f.value.filter(m=>{var a;return!((a=m.Excludes)!=null&&a.includes(s.value.OrgCategory))}),f.value.forEach(m=>{m.Uploaded=e.computed(()=>m.Files.filter(a=>!a.Deleted).length)})})}),e.provide("editable",MV),(c,m)=>{var u;const a=e.resolveComponent("required-label"),y=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",EV,[m[12]||(m[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後進行請款，預撥100%）",-1)),e.createElementVNode("p",bV,"核定經費: "+e.toDisplayString((u=e.unref(s).ApprovedAmount)==null?void 0:u.toLocaleString())+"元",1),e.createElementVNode("div",gV,[e.createElementVNode("table",kV,[m[6]||(m[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",yV,e.toDisplayString(e.unref(s).ApprovedAmount),1),m[2]||(m[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),m[3]||(m[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),m[4]||(m[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),m[5]||(m[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),m[13]||(m[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),m[14]||(m[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",uV,[e.createElementVNode("table",xV,[e.createElementVNode("thead",hV,[e.createElementVNode("tr",null,[m[7]||(m[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),m[8]||(m[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",$V,"狀態")),m[9]||(m[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(g,d)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",BV,e.toDisplayString(d+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Title),1)]),_:2},1024)]),g.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:g.Template,style:{width:"140px"},type:"button"},[...m[10]||(m[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,_V)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",CV,[g.Uploaded?(e.openBlock(),e.createElementBlock("span",TV,"已上傳")):(e.openBlock(),e.createElementBlock("span",wV,"尚未上傳"))])),e.createElementVNode("td",null,[g.Multiple||!g.Uploaded?(e.openBlock(),e.createBlock(y,{key:0,accept:".pdf",onFile:n=>r(g,n)},null,8,["onFile"])):e.createCommentVNode("",!0),g.Uploaded?(e.openBlock(),e.createElementBlock("div",DV,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",SV,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(o)(n.Path)},e.toDisplayString(n.Name),9,AV),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:k=>n.Deleted=!0,type:"button"},[...m[11]||(m[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,FV))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",UV,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:m[0]||(m[0]=g=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:m[1]||(m[1]=g=>l()),type:"button"},[...m[15]||(m[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},PV={class:"block"},jV={class:"text-teal fw-bold py-3"},OV={class:"text-teal fw-bold pb-3"},LV={class:"table-responsive"},qV={class:"table align-middle gray-table"},RV={class:"text-end"},zV={class:"text-end"},GV={class:"text-end"},JV={class:"mt-4"},YV={class:"table align-middle gray-table"},QV={class:"text-center"},WV={key:0,width:"180"},HV={class:"text-center"},XV=["href"],KV={key:0,class:"text-center"},ZV={key:0},vV={key:1,class:"text-pink"},ef={key:1,class:"tag-group mt-2 gap-1"},tf={key:0,class:"tag tag-green-light"},lf=["download","href"],of=["onClick"],nf={class:"block-bottom bg-light-teal"},rf=!0,af={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(8e4),s=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/LIT/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/LIT/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/LIT/3-經費分攤表.docx",Files:[]},{Type:4,Title:"補助清單",Template:"../../Template/LIT/4-補助清單.docx",Files:[]}]),r=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(m,a)=>{a.Type==="application/pdf"&&m.Files.push({Type:m.Type,Path:a.Path,Name:s.value.ProjectID+"_結案核銷_"+(m.Multiple?a.Name:`${m.Title}.pdf`)})},l=F.download,c=m=>{};return e.onMounted(()=>{F.literacy("findApplication",{ID:x.id}).subscribe(m=>{s.value=m.Project,j().init("literacy",s.value),f.value.forEach(a=>{a.Uploaded=e.computed(()=>a.Files.filter(y=>!y.Deleted).length)})})}),e.provide("editable",rf),(m,a)=>{var d;const y=e.resolveComponent("input-integer"),u=e.resolveComponent("required-label"),g=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",PV,[a[10]||(a[10]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",jV,"核定經費: "+e.toDisplayString((d=e.unref(s).ApprovedAmount)==null?void 0:d.toLocaleString())+"元",1),e.createElementVNode("p",OV,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(p)).toLocaleString())+"元",1),e.createElementVNode("div",LV,[e.createElementVNode("table",qV,[a[4]||(a[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",RV,e.toDisplayString(e.unref(s).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(p),"onUpdate:modelValue":a[0]||(a[0]=n=>e.isRef(p)?p.value=n:null)},null,8,["modelValue"])]),e.createElementVNode("td",zV,e.toDisplayString(e.unref(r))+"%",1),e.createElementVNode("td",GV,e.toDisplayString(e.unref(r))+"%",1)])])])]),a[11]||(a[11]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[12]||(a[12]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",JV,[e.createElementVNode("table",YV,[e.createElementVNode("thead",QV,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",WV,"狀態")),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(n,k)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",HV,e.toDisplayString(k+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(n.Title),1)]),_:2},1024)]),n.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:n.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,XV)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",KV,[n.Uploaded?(e.openBlock(),e.createElementBlock("span",ZV,"已上傳")):(e.openBlock(),e.createElementBlock("span",vV,"尚未上傳"))])),e.createElementVNode("td",null,[n.Multiple||!n.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:i=>o(n,i)},null,8,["onFile"])):e.createCommentVNode("",!0),n.Uploaded?(e.openBlock(),e.createElementBlock("div",ef,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.Files,i=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:i},[i.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",tf,[e.createElementVNode("a",{class:"tag-link my-1",download:i.Name,href:e.unref(l)(i.Path)},e.toDisplayString(i.Name),9,lf),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>i.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,of))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",nf,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[1]||(a[1]=n=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[2]||(a[2]=n=>c()),type:"button"},[...a[13]||(a[13]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},df={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(x,p)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"literacy"})}}},sf={class:"block"},cf={class:"mt-4"},mf={class:"table align-middle gray-table side-table"},pf={key:0,class:"d-flex align-items-center gap-2"},Vf={class:"input-group w-auto"},ff={class:"text-teal-dark"},Nf={key:1,class:"invalid mt-0"},Ef={class:"table-responsive mt-4"},bf={class:"table align-middle gray-table"},gf={key:0},kf={class:"input-group"},yf={key:0,class:"invalid mt-0"},uf={key:0},xf={class:"d-flex gap-2"},hf=["onClick"],$f={class:"mt-4"},Bf={class:"table align-middle gray-table"},_f={key:0},Cf=["value"],Tf={key:0},wf={class:"d-flex gap-2"},Df=["onClick"],Sf={class:"mt-4"},Af={class:"table align-middle gray-table side-table"},Ff={key:0,class:"block-bottom bg-light-teal"},Uf={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),f=e.computed(()=>a.value.EndDate),r=e.computed(()=>z("literacy",m.value.Status,2)),o=e.ref({}),l=e.computed(()=>y.value.filter(E=>!E.Deleted)),c=e.computed(()=>u.value.filter(E=>!E.Deleted)),m=e.ref({}),a=e.ref({}),y=e.ref([]),u=e.ref([]),g=()=>F.literacy("createItem",{ID:x.id}).subscribe(E=>y.value.push(E)),d=()=>u.value.push({Type:0,ItemID:0}),n=_,k=()=>{rxjs.forkJoin([F.literacy("getWorkSchedule",{ID:x.id})]).subscribe(E=>{const t=E[0];m.value=t.Project,a.value=t.GrantType,y.value=t.Items,u.value=t.Schedules,y.value.length||g(),u.value.length||d(),j().init("literacy",m.value),s.value=m.value.changeApply,m.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=E=>{var b,h;if(o.value={},E&&!V()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:m.value,Items:y.value,Schedules:u.value,Before:(b=s.value)==null?void 0:b.Form2Before,After:(h=s.value)==null?void 0:h.Form2After,Submit:E?"true":"false"};F.literacy("saveWorkSchedule",t).subscribe(()=>{E?n("next"):k()})},V=()=>{let E={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=I(m.value,E),E={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`item-${b}-`))),E={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},c.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`schedule-${b}-`))),s.value&&(E={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(k),e.provide("editable",r),(E,t)=>{const b=e.resolveComponent("required-label"),h=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),A=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",sf,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",cf,[e.createElementVNode("table",mf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",pf,[e.createElementVNode("div",Vf,[e.createVNode(h,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(m).StartTime,"onUpdate:modelValue":t[0]||(t[0]=C=>e.unref(m).StartTime=C)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(m).EndTime,"onUpdate:modelValue":t[1]||(t[1]=C=>e.unref(m).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",ff,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(f)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",Nf,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Ef,[e.createElementVNode("table",bf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",gf,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`item-${T}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",kf,[e.createVNode(U,{"empty-value":0,modelValue:C.Begin,"onUpdate:modelValue":D=>C.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(U,{"empty-value":0,modelValue:C.End,"onUpdate:modelValue":D=>C.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",yf,e.toDisplayString(e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`item-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`item-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",uf,[e.createElementVNode("div",xf,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(C),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,hf)):e.createCommentVNode("",!0),T+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",$f,[e.createElementVNode("table",Bf,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",_f,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(o)[`schedule-${T}-Type`],options:p,modelValue:C.Type,"onUpdate:modelValue":D=>C.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(o)[`schedule-${T}-ItemID`],options:e.unref(l),modelValue:C.ItemID,"onUpdate:modelValue":D=>C.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:P})=>[e.createElementVNode("option",{value:P.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(P.Title),9,Cf)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`schedule-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`schedule-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",Tf,[e.createElementVNode("div",wf,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(C),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Df)):e.createCommentVNode("",!0),T+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",Sf,[e.createElementVNode("table",Af,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=C=>e.unref(s).Form2Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=C=>e.unref(s).Form2After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Ff,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=C=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=C=>N(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Mf={class:"block"},If={class:"mt-4"},Pf={class:"table align-middle gray-table side-table"},jf={key:0},Of={key:1,class:"text-light-gray"},Lf={class:"mt-4"},qf={class:"table align-middle gray-table side-table"},Rf={class:"row g-3"},zf={class:"col-12 col-xl-2"},Gf={class:"text-gray mb-2"},Jf={class:"col-12 col-xl-3"},Yf={class:"text-gray mb-2"},Qf={class:"col-12 col-xl-4"},Wf={class:"row g-1"},Hf={class:"col-7"},Xf={class:"col-5"},Kf={class:"col-12 col-xl-3"},Zf={class:"text-gray mb-2"},vf={class:"col-12"},eN={class:"text-gray mb-2"},tN={class:"mt-4"},lN={class:"table align-middle gray-table side-table"},oN={class:"mt-4"},nN={class:"table align-middle gray-table side-table"},rN={key:0,class:"table-responsive mt-3 mb-0"},aN={class:"table align-middle gray-table"},dN={key:0},sN={key:0},cN={class:"d-flex gap-2"},iN=["onClick"],mN={class:"mt-4"},pN={class:"table align-middle gray-table side-table"},VN={key:0,class:"block-bottom bg-light-teal"},fN={__name:"Application",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.ref(),r=e.computed(()=>z("multiple",m.value.Status,1)),o=e.ref({}),l=e.ref([]),c=e.computed(()=>a.value.filter(N=>!N.Deleted)),m=e.ref({}),a=e.ref([]),y=e.computed({get:()=>!!c.value.length,set:N=>{N?u():a.value.forEach(V=>V.Deleted=!0)}}),u=()=>a.value.push({}),g=_,d=()=>{F.multiple("getApplication",{ID:x.id}).subscribe(N=>{m.value=N.Project,f.value=N.Contacts,a.value=N.ReceivedSubsidies,m.value.OrgCategory=m.value.OrgCategory||null,j().init("multiple",m.value),s.value=m.value.changeApply,m.value.changeApply=void 0})},n=N=>N.Deleted=!0,k=N=>{var E,t;if(o.value={},N&&!i()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const V={Project:m.value,Contacts:f.value,ReceivedSubsidies:a.value.filter(b=>b.ID||!b.Deleted),Before:(E=s.value)==null?void 0:E.Form1Before,After:(t=s.value)==null?void 0:t.Form1After,Submit:N?"true":"false"};F.multiple("saveApplication",V).subscribe(b=>{N?g("next",b.ID):m.value.ID?d():window.location.href=`Application.aspx?ID=${b.ID}`})},i=()=>{let N={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return o.value=I(m.value,N),N={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},f.value.forEach((V,E)=>Object.assign(o.value,I(V,N,`contact-${E}-`))),N={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},a.value.forEach((V,E)=>Object.assign(o.value,I(V,N,`received-${E}-`))),s.value&&(N={Form1Before:"變更前說明",Form1After:"變更後說明"},Object.assign(o.value,I(s.value,N))),!Object.keys(o.value).length};return e.onMounted(()=>{rxjs.forkJoin([F.multiple("getZgsCodes",{CodeGroup:"MULField"}),F.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(N=>{l.value=N[0],p.value=N[1],x.id?d():F.multiple("getEmptyApplication").subscribe(V=>{m.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},V),f.value=[{Role:"負責人"},{Role:"聯絡人"}],j().init("multiple",m.value)})})}),e.provide("editable",r),(N,V)=>{const E=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),b=e.resolveComponent("input-select"),h=e.resolveComponent("input-textarea"),S=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Mf,[V[43]||(V[43]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",If,[e.createElementVNode("table",Pf,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[V[15]||(V[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(m).Year),1)]),e.createElementVNode("tr",null,[V[16]||(V[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(m).ProjectID?(e.openBlock(),e.createElementBlock("span",jf,e.toDisplayString(e.unref(m).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Of,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[V[17]||(V[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(m).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[18]||(V[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).ProjectName,modelValue:e.unref(m).ProjectName,"onUpdate:modelValue":V[0]||(V[0]=U=>e.unref(m).ProjectName=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[19]||(V[19]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{"empty-value":null,error:e.unref(o).Field,options:e.unref(l),"text-name":"Descname","value-name":"Code",modelValue:e.unref(m).Field,"onUpdate:modelValue":V[1]||(V[1]=U=>e.unref(m).Field=U)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[20]||(V[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(m).OrgName,"onUpdate:modelValue":V[2]||(V[2]=U=>e.unref(m).OrgName=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[21]||(V[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{"empty-value":null,error:e.unref(o).OrgCategory,options:e.unref(p),"text-name":"Descname","value-name":"Code",modelValue:e.unref(m).OrgCategory,"onUpdate:modelValue":V[3]||(V[3]=U=>e.unref(m).OrgCategory=U)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[22]||(V[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).TaxID,"max-length":8,modelValue:e.unref(m).TaxID,"onUpdate:modelValue":V[4]||(V[4]=U=>e.unref(m).TaxID=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[23]||(V[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o).Address,placeholder:"請輸入地址",modelValue:e.unref(m).Address,"onUpdate:modelValue":V[5]||(V[5]=U=>e.unref(m).Address=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),V[44]||(V[44]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Lf,[e.createElementVNode("table",qf,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(U,M)=>(e.openBlock(),e.createElementBlock("tr",{key:U},[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(U.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Rf,[e.createElementVNode("div",zf,[e.createElementVNode("div",Gf,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[24]||(V[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-Name`],modelValue:U.Name,"onUpdate:modelValue":A=>U.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Jf,[e.createElementVNode("div",Yf,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[25]||(V[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-JobTitle`],modelValue:U.JobTitle,"onUpdate:modelValue":A=>U.JobTitle=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Qf,[V[26]||(V[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Wf,[e.createElementVNode("div",Hf,[e.createVNode(t,{modelValue:U.Phone,"onUpdate:modelValue":A=>U.Phone=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Xf,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:U.PhoneExt,"onUpdate:modelValue":A=>U.PhoneExt=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Kf,[e.createElementVNode("div",Zf,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[27]||(V[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-MobilePhone`],modelValue:U.MobilePhone,"onUpdate:modelValue":A=>U.MobilePhone=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",vf,[e.createElementVNode("div",eN,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[28]||(V[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(o)[`contact-${M}-EMail`],modelValue:U.EMail,"onUpdate:modelValue":A=>U.EMail=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),V[45]||(V[45]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",tN,[e.createElementVNode("table",lN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[29]||(V[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[V[30]||(V[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(h,{error:e.unref(o).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(m).Target,"onUpdate:modelValue":V[6]||(V[6]=U=>e.unref(m).Target=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[31]||(V[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(m).Summary,"onUpdate:modelValue":V[7]||(V[7]=U=>e.unref(m).Summary=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[32]||(V[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(m).Quantified,"onUpdate:modelValue":V[8]||(V[8]=U=>e.unref(m).Quantified=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[33]||(V[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(m).Qualitative,"onUpdate:modelValue":V[9]||(V[9]=U=>e.unref(m).Qualitative=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",oN,[e.createElementVNode("table",nN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[V[39]||(V[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(S,{modelValue:e.unref(y),"onUpdate:modelValue":V[10]||(V[10]=U=>e.isRef(y)?y.value=U:null)},null,8,["modelValue"]),e.unref(y)?(e.openBlock(),e.createElementBlock("div",rN,[e.createElementVNode("table",aN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[V[34]||(V[34]=e.createElementVNode("th",null,"計畫名稱",-1)),V[35]||(V[35]=e.createElementVNode("th",null,"補助單位",-1)),V[36]||(V[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",dN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(U,M)=>(e.openBlock(),e.createElementBlock("tr",{key:U},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o)[`received-${M}-Name`],modelValue:U.Name,"onUpdate:modelValue":A=>U.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(o)[`received-${M}-Unit`],modelValue:U.Unit,"onUpdate:modelValue":A=>U.Unit=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`received-${M}-Amount`],modelValue:U.Amount,"onUpdate:modelValue":A=>U.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",sN,[e.createElementVNode("div",cN,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>n(U),type:"button"},[...V[37]||(V[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,iN)):e.createCommentVNode("",!0),M+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:u,type:"button"},[...V[38]||(V[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[V[42]||(V[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",mN,[e.createElementVNode("table",pN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[40]||(V[40]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Form1Before,rows:"4",modelValue:e.unref(s).Form1Before,"onUpdate:modelValue":V[11]||(V[11]=U=>e.unref(s).Form1Before=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(E,null,{default:e.withCtx(()=>[...V[41]||(V[41]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o).Form1After,rows:"4",modelValue:e.unref(s).Form1After,"onUpdate:modelValue":V[12]||(V[12]=U=>e.unref(s).Form1After=U),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",VN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:V[13]||(V[13]=U=>k()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:V[14]||(V[14]=U=>k(!0)),type:"button"},[...V[46]||(V[46]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},NN={class:"block"},EN={key:0,class:"text-pink lh-base mt-4"},bN={class:"mt-4"},gN={class:"table align-middle gray-table"},kN={class:"text-center"},yN={key:0,width:"180"},uN={class:"text-center"},xN={key:0},hN=["innerHTML"],$N=["href"],BN={key:0,class:"text-center"},_N={key:0},CN={key:1,class:"text-pink"},TN={key:1,class:"tag-group mt-2 gap-1"},wN={key:0,class:"tag tag-green-light"},DN=["download","href"],SN=["onClick"],AN={class:"mt-4"},FN={class:"table align-middle gray-table side-table"},UN={key:0,class:"block-bottom bg-light-teal"},MN=["disabled"],IN={__name:"Attachment",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([{Type:1,Title:"申請表",Template:"../../Template/MUL/1-申請表.docx",Files:[]},{Type:2,Title:"計畫書",Template:"../../Template/MUL/2-計畫書.docx",Files:[]},{Type:3,Title:"執行承諾書",Template:"../../Template/MUL/3-執行承諾書.docx",Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:"../../Template/MUL/4-未違反公職人員利益衝突迴避法切結書及事前揭露表.docx",Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),s=e.ref(),f=e.computed(()=>p.value.some(d=>!d.Optional&&!d.Files.filter(n=>!n.Deleted).length)),r=e.computed(()=>z("multiple",l.value.Status,2)),o=e.ref({}),l=e.ref({}),c=(d,n)=>{n.Type==="application/pdf"&&d.Files.push({Type:d.Type,Path:n.Path,Name:l.value.ProjectID+"_"+(d.Multiple?n.Name:`${d.Title}.pdf`)})},m=F.download,a=_,y=()=>{rxjs.forkJoin([F.multiple("getAttachment",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=p.value.filter(k=>{var i;return!((i=k.Excludes)!=null&&i.includes(l.value.OrgCategory))}),l.value.Status>=42&&p.value.push({Type:6,Title:"著作權授權同意書",Template:"../../Template/MUL/6-著作權授權同意書.docx",Files:[]}),p.value.forEach(k=>{k.Files=n.Attachments.filter(i=>i.Type===k.Type),k.Uploaded=e.computed(()=>k.Files.filter(i=>!i.Deleted).length)}),j().init("multiple",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},u=d=>{var k,i;if(o.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={ID:x.id,Attachments:p.value.reduce((N,V)=>N.concat(V.Files),[]),Before:(k=s.value)==null?void 0:k.Form5Before,After:(i=s.value)==null?void 0:i.Form5After,Submit:d?"true":"false"};F.multiple("saveAttachment",n).subscribe(()=>{d?a("next"):y()})},g=()=>{if(s.value){const d={Form5Before:"變更前說明",Form5After:"變更後說明"};Object.assign(o.value,I(s.value,d))}return!Object.keys(o.value).length};return e.onMounted(y),e.provide("editable",r),(d,n)=>{const k=e.resolveComponent("required-label"),i=e.resolveComponent("input-file"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",NN,[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("p",EN,[...n[4]||(n[4]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",bN,[e.createElementVNode("table",gN,[e.createElementVNode("thead",kN,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(r)?(e.openBlock(),e.createElementBlock("th",yN,"狀態")):e.createCommentVNode("",!0),n[7]||(n[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",uN,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[V.Optional?(e.openBlock(),e.createElementBlock("span",xN,e.toDisplayString(V.Title),1)):(e.openBlock(),e.createBlock(k,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(V.Title),1)]),_:2},1024))]),e.unref(r)&&V.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:V.Comment},null,8,hN)):e.createCommentVNode("",!0),e.unref(r)&&V.Template?(e.openBlock(),e.createElementBlock("a",{key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:V.Template,style:{width:"140px"},type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,$N)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",BN,[V.Uploaded?(e.openBlock(),e.createElementBlock("span",_N,"已上傳")):(e.openBlock(),e.createElementBlock("span",CN,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&(V.Multiple||!V.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:t=>c(V,t)},null,8,["onFile"])):e.createCommentVNode("",!0),V.Uploaded?(e.openBlock(),e.createElementBlock("div",TN,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.Files,t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t},[t.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",wN,[e.createElementVNode("a",{class:"tag-link my-1",download:t.Name,href:e.unref(m)(t.Path)},e.toDisplayString(t.Name),9,DN),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:b=>t.Deleted=!0,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,SN)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n[12]||(n[12]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",AN,[e.createElementVNode("table",FN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[10]||(n[10]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5Before,rows:"4",modelValue:e.unref(s).Form5Before,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(s).Form5Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(o).Form5After,rows:"4",modelValue:e.unref(s).Form5After,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form5After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",UN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[2]||(n[2]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[3]||(n[3]=V=>u(!0)),disabled:e.unref(f),type:"button"},[...n[14]||(n[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,MN)])):e.createCommentVNode("",!0)],64)}}},PN={class:"block"},jN={class:"mt-4"},ON={class:"table-responsive mt-3 mb-0"},LN={class:"table align-middle gray-table"},qN={key:0,width:"1"},RN={key:0},zN={class:"d-flex gap-2"},GN=["onClick"],JN={class:"table-responsive mt-3 mb-0"},YN={class:"table align-middle gray-table"},QN={class:"mt-4"},WN={class:"table align-middle gray-table side-table"},HN={key:0,class:"block-bottom bg-light-teal"},XN={__name:"Benefit",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=e.ref(),f=e.computed(()=>z("multiple",l.value.Status,4)),r=e.ref({}),o=e.computed(()=>p.value.filter(d=>!d.Deleted)),l=e.ref({}),c=()=>p.value.push({}),m=_,a=()=>{rxjs.forkJoin([F.multiple("getBenefit",{ID:x.id})]).subscribe(d=>{const n=d[0];l.value=n.Project,p.value=n.Benefits,p.value.length||c(),j().init("multiple",l.value),s.value=l.value.changeApply,l.value.changeApply=void 0})},y=d=>d.Deleted=!0,u=d=>{var k,i;if(r.value={},d&&!g()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Benefits:p.value,Before:(k=s.value)==null?void 0:k.Form4Before,After:(i=s.value)==null?void 0:i.Form4After,Submit:d?"true":"false"};F.multiple("saveBenefit",n).subscribe(()=>{d?m("next"):a()})},g=()=>{let d={Benefit:"不可量化成果"};return r.value=I(l.value,d),d={Title:"指標",Target:"目標值",Description:"說明"},o.value.forEach((n,k)=>Object.assign(r.value,I(n,d,`item-${k}-`))),s.value&&(d={Form4Before:"變更前說明",Form4After:"變更後說明"},Object.assign(r.value,I(s.value,d))),!Object.keys(r.value).length};return e.onMounted(a),e.provide("editable",f),(d,n)=>{const k=e.resolveComponent("input-text"),i=e.resolveComponent("input-textarea"),N=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",PN,[n[14]||(n[14]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",jN,[e.createElementVNode("div",ON,[e.createElementVNode("table",LN,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[5]||(n[5]=e.createElementVNode("th",null,"可量化成果－指標",-1)),n[6]||(n[6]=e.createElementVNode("th",null,"目標值",-1)),n[7]||(n[7]=e.createElementVNode("th",null,"說明",-1)),e.unref(f)?(e.openBlock(),e.createElementBlock("th",qN,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(r)[`item-${E}-Title`],modelValue:V.Title,"onUpdate:modelValue":t=>V.Title=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(r)[`item-${E}-Target`],modelValue:V.Target,"onUpdate:modelValue":t=>V.Target=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r)[`item-${E}-Description`],rows:"1",modelValue:V.Description,"onUpdate:modelValue":t=>V.Description=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(f)?(e.openBlock(),e.createElementBlock("td",RN,[e.createElementVNode("div",zN,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:t=>y(V),type:"button"},[...n[8]||(n[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,GN)):e.createCommentVNode("",!0),E+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:c,type:"button"},[...n[9]||(n[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",JN,[e.createElementVNode("table",YN,[n[10]||(n[10]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Benefit,rows:"4",modelValue:e.unref(l).Benefit,"onUpdate:modelValue":n[0]||(n[0]=V=>e.unref(l).Benefit=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[n[13]||(n[13]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",QN,[e.createElementVNode("table",WN,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[11]||(n[11]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Form4Before,rows:"4",modelValue:e.unref(s).Form4Before,"onUpdate:modelValue":n[1]||(n[1]=V=>e.unref(s).Form4Before=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[12]||(n[12]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(r).Form4After,rows:"4",modelValue:e.unref(s).Form4After,"onUpdate:modelValue":n[2]||(n[2]=V=>e.unref(s).Form4After=V),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(f)?(e.openBlock(),e.createElementBlock("div",HN,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[3]||(n[3]=V=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[4]||(n[4]=V=>u(!0)),type:"button"},[...n[15]||(n[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},KN={class:"block"},ZN={class:"mt-4"},vN={class:"table-responsive mt-3 mb-0"},e1={class:"table align-middle gray-table"},t1={class:"text-end"},l1={class:"text-end"},o1={class:"table-responsive"},n1={class:"table align-middle gray-table"},r1=["colspan"],a1={key:0,width:"1"},d1={class:"text-end"},s1={key:0},c1={class:"d-flex gap-2"},i1=["onClick"],m1={class:"mt-4"},p1={class:"table-responsive mt-3 mb-0"},V1={class:"table align-middle gray-table"},f1={key:0,width:"1"},N1={class:"text-end"},E1={key:0},b1={class:"d-flex gap-2"},g1=["onClick"],k1={class:"mt-4"},y1={class:"table align-middle gray-table side-table"},u1={key:0,class:"block-bottom bg-light-teal"},x1={class:"text-center"},h1={class:"mb-5"},$1={__name:"Funding",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(),s=e.computed(()=>z("multiple",l.value.Status,3)),f=e.ref({}),r=e.computed(()=>m.value.filter(E=>!E.Deleted)),o=e.computed(()=>a.value.filter(E=>!E.Deleted)),l=e.ref({}),c=e.ref(),m=e.ref([]),a=e.ref([]),y=e.ref({}),u=e.ref(0),g=()=>m.value.push({}),d=()=>a.value.push({}),n=_,k=()=>{rxjs.forkJoin([F.multiple("getFunding",{ID:x.id})]).subscribe(E=>{const t=E[0];l.value=t.Project,m.value=t.OtherSubsidies,a.value=t.BudgetPlans,y.value=t.GrantTargetSetting,m.value.length||g(),a.value.length||d(),j().init("multiple",l.value),p.value=l.value.changeApply,l.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=(E,t)=>{var h,S;if(f.value={},E&&!V()){e.nextTick(()=>{var w;return(w=document.querySelector(".invalid"))==null?void 0:w.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&l.value.ApplyAmount>y.value.GrantLimit*1e4){c.value.show(()=>N(E,!0));return}const b={Project:l.value,OtherSubsidies:m.value,BudgetPlans:a.value,Before:(h=p.value)==null?void 0:h.Form3Before,After:(S=p.value)==null?void 0:S.Form3After,Submit:E?"true":"false"};F.multiple("saveFunding",b).subscribe(()=>{E?n("next"):k()})},V=()=>{let E={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return f.value=I(l.value,E),E={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},m.value.forEach((t,b)=>Object.assign(f.value,I(t,E,`other-${b}-`))),E={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,b)=>Object.assign(f.value,I(t,E,`plan-${b}-`))),p.value&&(E={Form3Before:"變更前說明",Form3After:"變更後說明"},Object.assign(f.value,I(p.value,E))),!Object.keys(f.value).length};return e.onMounted(k),e.provide("editable",s),e.watchEffect(()=>{l.value.OtherAmount=r.value.reduce((E,t)=>E+R(t.Amount),0),u.value=R(l.value.ApplyAmount)+R(l.value.SelfAmount)+R(l.value.OtherAmount),r.value.forEach(E=>E.percent=Math.round(R(E.Amount)/l.value.OtherAmount*1e4)/100),a.value.forEach(E=>E.sum=R(E.Amount)+R(E.OtherAmount))}),(E,t)=>{var M;const b=e.resolveComponent("input-integer"),h=e.resolveComponent("input-text"),S=e.resolveComponent("input-textarea"),w=e.resolveComponent("required-label"),U=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",KN,[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",ZN,[e.createElementVNode("div",vN,[e.createElementVNode("table",e1,[t[6]||(t[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=A=>e.unref(l).ApplyAmount=A)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=A=>e.unref(l).SelfAmount=A)},null,8,["error","modelValue"])]),e.createElementVNode("td",t1,e.toDisplayString((M=e.unref(l).OtherAmount)==null?void 0:M.toLocaleString()),1),e.createElementVNode("td",l1,e.toDisplayString(e.unref(u).toLocaleString()),1)])])])]),t[14]||(t[14]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",o1,[e.createElementVNode("table",n1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(s)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,r1)]),e.createElementVNode("tr",null,[t[7]||(t[7]=e.createElementVNode("th",{width:"1"},null,-1)),t[8]||(t[8]=e.createElementVNode("th",null,"單位名稱",-1)),t[9]||(t[9]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[10]||(t[10]=e.createElementVNode("th",null,"比例",-1)),t[11]||(t[11]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",a1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(A,C)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(f)[`other-${C}-Unit`],modelValue:A.Unit,"onUpdate:modelValue":T=>A.Unit=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`other-${C}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":T=>A.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",d1,e.toDisplayString(A.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`other-${C}-Content`],rows:"1",modelValue:A.Content,"onUpdate:modelValue":T=>A.Content=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",s1,[e.createElementVNode("div",c1,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>i(A),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,i1)):e.createCommentVNode("",!0),C+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",m1,[e.createElementVNode("div",p1,[e.createElementVNode("table",V1,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"預算項目",-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[17]||(t[17]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[18]||(t[18]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[19]||(t[19]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock("th",f1,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(A,C)=>(e.openBlock(),e.createElementBlock("tr",{key:A},[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(f)[`plan-${C}-Title`],modelValue:A.Title,"onUpdate:modelValue":T=>A.Title=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`plan-${C}-Amount`],modelValue:A.Amount,"onUpdate:modelValue":T=>A.Amount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(f)[`plan-${C}-OtherAmount`],modelValue:A.OtherAmount,"onUpdate:modelValue":T=>A.OtherAmount=T},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",N1,e.toDisplayString(A.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f)[`plan-${C}-Description`],rows:"1",modelValue:A.Description,"onUpdate:modelValue":T=>A.Description=T,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(s)?(e.openBlock(),e.createElementBlock("td",E1,[e.createElementVNode("div",b1,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:T=>i(A),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,g1)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(p)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",k1,[e.createElementVNode("table",y1,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).Form3Before,rows:"4",modelValue:e.unref(p).Form3Before,"onUpdate:modelValue":t[2]||(t[2]=A=>e.unref(p).Form3Before=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(w,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(S,{error:e.unref(f).Form3After,rows:"4",modelValue:e.unref(p).Form3After,"onUpdate:modelValue":t[3]||(t[3]=A=>e.unref(p).Form3After=A),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",u1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=A=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=A=>N(!0)),type:"button"},[...t[27]||(t[27]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(U,{ref_key:"modal",ref:c},{default:e.withCtx(()=>[e.createElementVNode("div",x1,[t[28]||(t[28]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",h1,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(y).GrantLimit)+"萬",1),t[29]||(t[29]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[30]||(t[30]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},B1={class:"block"},_1={class:"text-teal fw-bold py-3"},C1={class:"table-responsive"},T1={class:"table align-middle gray-table"},w1={class:"text-end"},D1={class:"mt-4"},S1={class:"table align-middle gray-table"},A1={class:"text-center"},F1={key:0,width:"180"},U1={class:"text-center"},M1=["href"],I1={key:0,class:"text-center"},P1={key:0},j1={key:1,class:"text-pink"},O1={key:1,class:"tag-group mt-2 gap-1"},L1={key:0,class:"tag tag-green-light"},q1=["download","href"],R1=["onClick"],z1={class:"block-bottom bg-light-teal"},G1=!0,J1={__name:"Payment1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(0),s=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]}]),r=(c,m)=>{m.Type==="application/pdf"&&c.Files.push({Type:c.Type,Path:m.Path,Name:s.value.ProjectID+"_第一期_"+(c.Multiple?m.Name:`${c.Title}.pdf`)})},o=F.download,l=c=>{};return e.onMounted(()=>{F.multiple("findApplication",{ID:x.id}).subscribe(c=>{s.value=c.Project,j().init("multiple",s.value),p.value=Math.round(s.value.ApprovedAmount*.7),f.value.forEach(m=>{m.Uploaded=e.computed(()=>m.Files.filter(a=>!a.Deleted).length)})})}),e.provide("editable",G1),(c,m)=>{var u;const a=e.resolveComponent("required-label"),y=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",B1,[m[12]||(m[12]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於計畫核定後請款，第一期預撥70%）",-1)),e.createElementVNode("p",_1,"核定經費: "+e.toDisplayString((u=e.unref(s).ApprovedAmount)==null?void 0:u.toLocaleString())+"元",1),e.createElementVNode("div",C1,[e.createElementVNode("table",T1,[m[6]||(m[6]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",w1,e.toDisplayString(e.unref(p)),1),m[2]||(m[2]=e.createElementVNode("td",{class:"text-end"},"--",-1)),m[3]||(m[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),m[4]||(m[4]=e.createElementVNode("td",{class:"text-end"},"--",-1)),m[5]||(m[5]=e.createElementVNode("td",{class:"text-end"},"--",-1))])])])]),m[13]||(m[13]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),m[14]||(m[14]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",D1,[e.createElementVNode("table",S1,[e.createElementVNode("thead",A1,[e.createElementVNode("tr",null,[m[7]||(m[7]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),m[8]||(m[8]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",F1,"狀態")),m[9]||(m[9]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(g,d)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",U1,e.toDisplayString(d+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(a,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Title),1)]),_:2},1024)]),g.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:g.Template,style:{width:"140px"},type:"button"},[...m[10]||(m[10]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,M1)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",I1,[g.Uploaded?(e.openBlock(),e.createElementBlock("span",P1,"已上傳")):(e.openBlock(),e.createElementBlock("span",j1,"尚未上傳"))])),e.createElementVNode("td",null,[g.Multiple||!g.Uploaded?(e.openBlock(),e.createBlock(y,{key:0,accept:".pdf",onFile:n=>r(g,n)},null,8,["onFile"])):e.createCommentVNode("",!0),g.Uploaded?(e.openBlock(),e.createElementBlock("div",O1,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",L1,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(o)(n.Path)},e.toDisplayString(n.Name),9,q1),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:k=>n.Deleted=!0,type:"button"},[...m[11]||(m[11]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,R1))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",z1,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:m[0]||(m[0]=g=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:m[1]||(m[1]=g=>l()),type:"button"},[...m[15]||(m[15]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},Y1={class:"block"},Q1={class:"text-teal fw-bold py-3"},W1={class:"table-responsive"},H1={class:"table align-middle gray-table"},X1={class:"text-end"},K1={class:"text-end"},Z1={class:"text-end"},v1={class:"text-end"},eE={class:"mt-4"},tE={class:"table align-middle gray-table"},lE={class:"text-center"},oE={key:0,width:"180"},nE={class:"text-center"},rE=["href"],aE={key:0,class:"text-center"},dE={key:0},sE={key:1,class:"text-pink"},cE={key:1,class:"tag-group mt-2 gap-1"},iE={key:0,class:"tag tag-green-light"},mE=["download","href"],pE=["onClick"],VE={class:"block-bottom bg-light-teal"},fE=!0,NE={__name:"Payment2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(3e4),s=e.ref(0),f=e.ref({}),r=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),o=e.computed(()=>f.value.ApprovedAmount?Math.min(Math.round(p.value*100/f.value.ApprovedAmount*100)/100,100):0),l=e.computed(()=>s.value?Math.min(Math.round(p.value*100/s.value*100)/100,100):0),c=(y,u)=>{u.Type==="application/pdf"&&y.Files.push({Type:y.Type,Path:u.Path,Name:f.value.ProjectID+"_第二期_"+(y.Multiple?u.Name:`${y.Title}.pdf`)})},m=F.download,a=y=>{};return e.onMounted(()=>{F.multiple("findApplication",{ID:x.id}).subscribe(y=>{f.value=y.Project,j().init("multiple",f.value),s.value=Math.round(f.value.ApprovedAmount*.7),r.value.forEach(u=>{u.Uploaded=e.computed(()=>u.Files.filter(g=>!g.Deleted).length)})})}),e.provide("editable",fE),(y,u)=>{var k;const g=e.resolveComponent("input-integer"),d=e.resolveComponent("required-label"),n=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Y1,[u[9]||(u[9]=e.createElementVNode("h5",{class:"square-title"},"實際請款（於 9/30 前請款，須執行完成第一期款至少60%）（第二期預撥30%）",-1)),e.createElementVNode("p",Q1,"核定經費: "+e.toDisplayString((k=e.unref(f).ApprovedAmount)==null?void 0:k.toLocaleString())+"元",1),e.createElementVNode("div",W1,[e.createElementVNode("table",H1,[u[3]||(u[3]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",X1,e.toDisplayString(e.unref(f).ApprovedAmount-e.unref(s)),1),e.createElementVNode("td",K1,e.toDisplayString(e.unref(s)),1),e.createElementVNode("td",null,[e.createVNode(g,{modelValue:e.unref(p),"onUpdate:modelValue":u[0]||(u[0]=i=>e.isRef(p)?p.value=i:null)},null,8,["modelValue"])]),e.createElementVNode("td",Z1,e.toDisplayString(e.unref(o))+"%",1),e.createElementVNode("td",v1,e.toDisplayString(e.unref(l))+"%",1)])])])]),u[10]||(u[10]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),u[11]||(u[11]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",eE,[e.createElementVNode("table",tE,[e.createElementVNode("thead",lE,[e.createElementVNode("tr",null,[u[4]||(u[4]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),u[5]||(u[5]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",oE,"狀態")),u[6]||(u[6]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(i,N)=>(e.openBlock(),e.createElementBlock("tr",{key:i},[e.createElementVNode("td",nE,e.toDisplayString(N+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(d,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(i.Title),1)]),_:2},1024)]),i.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:i.Template,style:{width:"140px"},type:"button"},[...u[7]||(u[7]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,rE)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",aE,[i.Uploaded?(e.openBlock(),e.createElementBlock("span",dE,"已上傳")):(e.openBlock(),e.createElementBlock("span",sE,"尚未上傳"))])),e.createElementVNode("td",null,[i.Multiple||!i.Uploaded?(e.openBlock(),e.createBlock(n,{key:0,accept:".pdf",onFile:V=>c(i,V)},null,8,["onFile"])):e.createCommentVNode("",!0),i.Uploaded?(e.openBlock(),e.createElementBlock("div",cE,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.Files,V=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:V},[V.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",iE,[e.createElementVNode("a",{class:"tag-link my-1",download:V.Name,href:e.unref(m)(V.Path)},e.toDisplayString(V.Name),9,mE),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:E=>V.Deleted=!0,type:"button"},[...u[8]||(u[8]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,pE))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.createElementVNode("div",VE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:u[1]||(u[1]=i=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:u[2]||(u[2]=i=>a()),type:"button"},[...u[12]||(u[12]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},EE={class:"block"},bE={class:"text-teal fw-bold py-3"},gE={class:"text-teal fw-bold pb-3"},kE={class:"table-responsive"},yE={class:"table align-middle gray-table"},uE={class:"text-end"},xE={class:"text-end"},hE={class:"text-end"},$E={class:"mt-4"},BE={class:"table align-middle gray-table"},_E={class:"text-center"},CE={key:0,width:"180"},TE={class:"text-center"},wE=["href"],DE={key:0,class:"text-center"},SE={key:0},AE={key:1,class:"text-pink"},FE={key:1,class:"tag-group mt-2 gap-1"},UE={key:0,class:"tag tag-green-light"},ME=["download","href"],IE=["onClick"],PE={class:"text-center"},jE={colspan:"2"},OE={class:"block-bottom bg-light-teal"},LE=!0,qE={__name:"Payment3",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref(8e4),s=e.ref({}),f=e.ref([{Type:1,Title:"領據",Template:"../../Template/MUL/1-領據.docx",Files:[]},{Type:2,Title:"經費收支明細表",Template:"../../Template/MUL/2-經費收支明細表.docx",Files:[]},{Type:3,Title:"經費分攤表",Template:"../../Template/MUL/3-經費分攤表.docx",Files:[]},{Type:4,Title:"合作經費清單",Template:"../../Template/MUL/4-合作經費清單.docx",Files:[]}]),r=e.computed(()=>s.value.ApprovedAmount?Math.min(Math.round(p.value*100/s.value.ApprovedAmount*100)/100,100):0),o=(m,a)=>{a.Type==="application/pdf"&&m.Files.push({Type:m.Type,Path:a.Path,Name:s.value.ProjectID+"_結案核銷_"+(m.Multiple?a.Name:`${m.Title}.pdf`)})},l=F.download,c=m=>{};return e.onMounted(()=>{F.multiple("findApplication",{ID:x.id}).subscribe(m=>{s.value=m.Project,j().init("multiple",s.value),f.value.forEach(a=>{a.Uploaded=e.computed(()=>a.Files.filter(y=>!y.Deleted).length)})})}),e.provide("editable",LE),(m,a)=>{var n;const y=e.resolveComponent("input-integer"),u=e.resolveComponent("required-label"),g=e.resolveComponent("input-file"),d=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",EE,[a[11]||(a[11]=e.createElementVNode("h5",{class:"square-title"},"實際請款（請於成果報告通過後，辦理結案核銷）",-1)),e.createElementVNode("p",bE,"核定經費: "+e.toDisplayString((n=e.unref(s).ApprovedAmount)==null?void 0:n.toLocaleString())+"元",1),e.createElementVNode("p",gE,"賸餘款: "+e.toDisplayString((e.unref(s).ApprovedAmount-e.unref(p)).toLocaleString())+"元",1),e.createElementVNode("div",kE,[e.createElementVNode("table",yE,[a[4]||(a[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"本期請款金額"),e.createElementVNode("th",{class:"text-end"},"前期已撥付金額"),e.createElementVNode("th",null,"累積實支金額"),e.createElementVNode("th",{class:"text-end"},"累積經費執行率"),e.createElementVNode("th",{class:"text-end"},"支用比")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[a[3]||(a[3]=e.createElementVNode("td",{class:"text-end"},"--",-1)),e.createElementVNode("td",uE,e.toDisplayString(e.unref(s).ApprovedAmount),1),e.createElementVNode("td",null,[e.createVNode(y,{modelValue:e.unref(p),"onUpdate:modelValue":a[0]||(a[0]=k=>e.isRef(p)?p.value=k:null)},null,8,["modelValue"])]),e.createElementVNode("td",xE,e.toDisplayString(e.unref(r))+"%",1),e.createElementVNode("td",hE,e.toDisplayString(e.unref(r))+"%",1)])])])]),a[12]||(a[12]=e.createElementVNode("h5",{class:"square-title mt-4"},"檔案上傳",-1)),a[13]||(a[13]=e.createElementVNode("p",{class:"text-pink mt-3 lh-base"},"請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF）。",-1)),e.createElementVNode("div",$E,[e.createElementVNode("table",BE,[e.createElementVNode("thead",_E,[e.createElementVNode("tr",null,[a[5]||(a[5]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),a[6]||(a[6]=e.createElementVNode("th",null,"附件名稱",-1)),(e.openBlock(),e.createElementBlock("th",CE,"狀態")),a[7]||(a[7]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(k,i)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",TE,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Title),1)]),_:2},1024)]),k.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:k.Template,style:{width:"140px"},type:"button"},[...a[8]||(a[8]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,wE)):e.createCommentVNode("",!0)]),(e.openBlock(),e.createElementBlock("td",DE,[k.Uploaded?(e.openBlock(),e.createElementBlock("span",SE,"已上傳")):(e.openBlock(),e.createElementBlock("span",AE,"尚未上傳"))])),e.createElementVNode("td",null,[k.Multiple||!k.Uploaded?(e.openBlock(),e.createBlock(g,{key:0,accept:".pdf",onFile:N=>o(k,N)},null,8,["onFile"])):e.createCommentVNode("",!0),k.Uploaded?(e.openBlock(),e.createElementBlock("div",FE,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.Files,N=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:N},[N.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",UE,[e.createElementVNode("a",{class:"tag-link my-1",download:N.Name,href:e.unref(l)(N.Path)},e.toDisplayString(N.Name),9,ME),(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>N.Deleted=!0,type:"button"},[...a[9]||(a[9]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,IE))]))],64))),128))])):e.createCommentVNode("",!0)])]))),128)),e.createElementVNode("tr",null,[e.createElementVNode("td",PE,e.toDisplayString(e.unref(f).length+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...a[10]||(a[10]=[e.createTextVNode("其他資料（5分鐘精華影片）",-1)])]),_:1})])]),e.createElementVNode("td",jE,[e.createVNode(d)])])])])])]),e.createElementVNode("div",OE,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:a[1]||(a[1]=k=>c()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:a[2]||(a[2]=k=>c()),type:"button"},[...a[14]||(a[14]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])])])],64)}}},RE={__name:"ProgressBar",setup(B){const _=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(x,p)=>{const s=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(s,{steps:_,type:"multiple"})}}},zE={class:"block"},GE={class:"mt-4"},JE={class:"table align-middle gray-table side-table"},YE={key:0,class:"d-flex align-items-center gap-2"},QE={class:"input-group w-auto"},WE={class:"text-teal-dark"},HE={key:1,class:"invalid mt-0"},XE={class:"table-responsive mt-4"},KE={class:"table align-middle gray-table"},ZE={key:0},vE={class:"input-group"},eb={key:0,class:"invalid mt-0"},tb={key:0},lb={class:"d-flex gap-2"},ob=["onClick"],nb={class:"mt-4"},rb={class:"table align-middle gray-table"},ab={key:0},db=["value"],sb={key:0},cb={class:"d-flex gap-2"},ib=["onClick"],mb={class:"mt-4"},pb={class:"table align-middle gray-table side-table"},Vb={key:0,class:"block-bottom bg-light-teal"},fb={__name:"WorkSchedule",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=[{value:1,text:"50%"},{value:2,text:"100%"}],s=e.ref(),f=e.computed(()=>a.value.EndDate),r=e.computed(()=>z("multiple",m.value.Status,2)),o=e.ref({}),l=e.computed(()=>y.value.filter(E=>!E.Deleted)),c=e.computed(()=>u.value.filter(E=>!E.Deleted)),m=e.ref({}),a=e.ref({}),y=e.ref([]),u=e.ref([]),g=()=>F.multiple("createItem",{ID:x.id}).subscribe(E=>y.value.push(E)),d=()=>u.value.push({Type:0,ItemID:0}),n=_,k=()=>{rxjs.forkJoin([F.multiple("getWorkSchedule",{ID:x.id})]).subscribe(E=>{const t=E[0];m.value=t.Project,a.value=t.GrantType,y.value=t.Items,u.value=t.Schedules,y.value.length||g(),u.value.length||d(),j().init("multiple",m.value),s.value=m.value.changeApply,m.value.changeApply=void 0})},i=E=>E.Deleted=!0,N=E=>{var b,h;if(o.value={},E&&!V()){e.nextTick(()=>{var S;return(S=document.querySelector(".invalid"))==null?void 0:S.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:m.value,Items:y.value,Schedules:u.value,Before:(b=s.value)==null?void 0:b.Form2Before,After:(h=s.value)==null?void 0:h.Form2After,Submit:E?"true":"false"};F.multiple("saveWorkSchedule",t).subscribe(()=>{E?n("next"):k()})},V=()=>{let E={StartTime:"計畫期程",EndTime:"計畫期程"};return o.value=I(m.value,E),E={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},l.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`item-${b}-`))),E={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},c.value.forEach((t,b)=>Object.assign(o.value,I(t,E,`schedule-${b}-`))),s.value&&(E={Form2Before:"變更前說明",Form2After:"變更後說明"},Object.assign(o.value,I(s.value,E))),!Object.keys(o.value).length};return e.onMounted(k),e.provide("editable",r),(E,t)=>{const b=e.resolveComponent("required-label"),h=e.resolveComponent("input-tw-date"),S=e.resolveComponent("tw-date"),w=e.resolveComponent("input-text"),U=e.resolveComponent("input-month"),M=e.resolveComponent("input-textarea"),A=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",zE,[t[26]||(t[26]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",GE,[e.createElementVNode("table",JE,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[6]||(t[6]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(f)?(e.openBlock(),e.createElementBlock("div",YE,[e.createElementVNode("div",QE,[e.createVNode(h,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(m).StartTime,"onUpdate:modelValue":t[0]||(t[0]=C=>e.unref(m).StartTime=C)},null,8,["max-date","modelValue"]),t[7]||(t[7]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(h,{class:"w-auto","max-date":e.unref(f),modelValue:e.unref(m).EndTime,"onUpdate:modelValue":t[1]||(t[1]=C=>e.unref(m).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",WE,[t[8]||(t[8]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(S,{value:e.unref(f)},null,8,["value"]),t[9]||(t[9]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(o).StartTime||e.unref(o).EndTime?(e.openBlock(),e.createElementBlock("div",HE,e.toDisplayString(e.unref(o).StartTime||e.unref(o).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[27]||(t[27]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",XE,[e.createElementVNode("table",KE,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[12]||(t[12]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[13]||(t[13]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",ZE,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+T)),1),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(o)[`item-${T}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",vE,[e.createVNode(U,{"empty-value":0,modelValue:C.Begin,"onUpdate:modelValue":D=>C.Begin=D},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(U,{"empty-value":0,modelValue:C.End,"onUpdate:modelValue":D=>C.End=D},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]?(e.openBlock(),e.createElementBlock("div",eb,e.toDisplayString(e.unref(o)[`item-${T}-Begin`]||e.unref(o)[`item-${T}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`item-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`item-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",tb,[e.createElementVNode("div",lb,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(C),type:"button"},[...t[15]||(t[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ob)):e.createCommentVNode("",!0),T+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:g,type:"button"},[...t[16]||(t[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[28]||(t[28]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",nb,[e.createElementVNode("table",rb,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("對應工項",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(r)?(e.openBlock(),e.createElementBlock("th",ab,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(C,T)=>(e.openBlock(),e.createElementBlock("tr",{key:C},[e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(o)[`schedule-${T}-Type`],options:p,modelValue:C.Type,"onUpdate:modelValue":D=>C.Type=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(A,{"empty-value":0,error:e.unref(o)[`schedule-${T}-ItemID`],options:e.unref(l),modelValue:C.ItemID,"onUpdate:modelValue":D=>C.ItemID=D,modelModifiers:{trim:!0}},{default:e.withCtx(({index:D,option:P})=>[e.createElementVNode("option",{value:P.ID},e.toDisplayString(String.fromCharCode(65+D))+"."+e.toDisplayString(P.Title),9,db)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(o)[`schedule-${T}-Deadline`],modelValue:C.Deadline,"onUpdate:modelValue":D=>C.Deadline=D},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o)[`schedule-${T}-Content`],rows:"1",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",sb,[e.createElementVNode("div",cb,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:D=>i(C),type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ib)):e.createCommentVNode("",!0),T+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t[25]||(t[25]=e.createElementVNode("h5",{class:"square-title mt-5"},"變更說明",-1)),e.createElementVNode("div",mb,[e.createElementVNode("table",pb,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("變更前",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2Before,rows:"4",modelValue:e.unref(s).Form2Before,"onUpdate:modelValue":t[2]||(t[2]=C=>e.unref(s).Form2Before=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("變更後",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(M,{error:e.unref(o).Form2After,rows:"4",modelValue:e.unref(s).Form2After,"onUpdate:modelValue":t[3]||(t[3]=C=>e.unref(s).Form2After=C),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])],64)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Vb,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[4]||(t[4]=C=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[5]||(t[5]=C=>N(!0)),type:"button"},[...t[29]||(t[29]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Nb={class:"block bg-light-teal-100 rounded-4 py-4"},Eb={class:"fw-bold"},bb={class:"d-flex align-items-center gap-3 text-teal-dark mt-3"},gb={class:"block rounded-4 mt-4"},kb=["innerHTML"],yb={class:"mt-3 d-flex flex-column gap-2"},ub=["download","href"],xb={class:"mt-3"},hb=["data-caption","href"],$b=["alt","src"],Bb={class:"mt-3 d-flex flex-column gap-2"},_b=["href"],Cb={__name:"NewsDetail",props:{id:{type:[Number,String]}},setup(B){const _=B,x=e.ref(),p=e.ref([]),s=e.ref({}),f=e.ref([]),r=e.ref([]),o=F.download;return e.onMounted(()=>{F.system("getNews",{ID:_.id}).subscribe(l=>{s.value=l.News,p.value=l.Files,f.value=l.Images,r.value=l.Videos,e.nextTick(()=>{Fancybox.bind(x.value,"[data-fancybox]")})})}),(l,c)=>{const m=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Nb,[e.createElementVNode("h5",Eb,e.toDisplayString(e.unref(s).Title),1),e.createElementVNode("ul",bb,[e.createElementVNode("li",null,[c[0]||(c[0]=e.createTextVNode("公告日期：",-1)),e.createVNode(m,{value:e.unref(s).EnableTime},null,8,["value"])]),e.createElementVNode("li",null,"公告單位："+e.toDisplayString(e.unref(s).UserOrg),1)])]),e.createElementVNode("div",gb,[e.createElementVNode("div",{class:"mb-5",style:{"white-space":"pre-line"},innerHTML:e.unref(s).Content},null,8,kb),e.unref(p).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[c[2]||(c[2]=e.createElementVNode("h5",{class:"square-title"},"相關附件",-1)),e.createElementVNode("ul",yb,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),a=>(e.openBlock(),e.createElementBlock("li",{key:a},[e.createElementVNode("a",{class:"link-black",download:a.Name,href:e.unref(o)(a.Path)},[e.createTextVNode(e.toDisplayString(a.Name)+" ",1),c[1]||(c[1]=e.createElementVNode("i",{class:"fa-solid fa-file-arrow-down text-teal-dark ms-1"},null,-1))],8,ub)]))),128))])],64)):e.createCommentVNode("",!0),e.unref(f).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[c[4]||(c[4]=e.createElementVNode("h5",{class:"square-title mt-5"},"相關照片",-1)),e.createElementVNode("div",xb,[e.createElementVNode("div",{class:"image-preview mt-3",ref_key:"container",ref:x},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(a,y)=>(e.openBlock(),e.createElementBlock("div",{class:"image-preview__item",key:a},[e.createElementVNode("a",{"data-fancybox":"gallery","data-caption":`相片 ${y}`,href:e.unref(o)(a.Path)},[e.createElementVNode("img",{alt:`相片 ${y}`,src:e.unref(o)(a.Path)},null,8,$b),c[3]||(c[3]=e.createElementVNode("div",{class:"image-preview__item-overlay"},[e.createElementVNode("button",{"aria-label":"檢視圖片",class:"btn btn-view-image",tabindex:"-1",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"})])],-1))],8,hb)]))),128))],512)])],64)):e.createCommentVNode("",!0),e.unref(r).length?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[c[6]||(c[6]=e.createElementVNode("h5",{class:"square-title mt-5"},"相關影片",-1)),e.createElementVNode("ul",Bb,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),a=>(e.openBlock(),e.createElementBlock("li",{key:a},[e.createElementVNode("a",{class:"link-black",href:a.URL,target:"_blank"},[e.createTextVNode(e.toDisplayString(a.Title)+" ",1),c[5]||(c[5]=e.createStaticVNode('<svg class="ms-1" xmlns="http://www.w3.org/2000/svg" width="16" height="18" viewBox="0 0 19 24" fill="none"><g clip-path="url(#clip0_1051_6167)"><path d="M17.7333 0.5H12.6667C11.913 0.5 11.4 1.12067 11.4 1.76667C11.4 2.05167 11.4887 2.36833 11.7673 2.65967L13.4077 4.3L9.87367 7.834C9.60767 8.1 9.5 8.423 9.5 8.727C9.5 9.43633 10.0573 9.99367 10.7667 9.99367C11.096 9.99367 11.4127 9.87333 11.6597 9.62L15.1937 6.086L16.834 7.72633C17.1253 8.005 17.442 8.09367 17.727 8.09367C18.373 8.09367 18.9937 7.58067 18.9937 6.827V1.76667C18.9937 1.12067 18.4807 0.5 17.727 0.5H17.7333ZM15.2 7.88467L12.559 10.5257C12.084 11.0007 11.4443 11.2667 10.7667 11.2667C9.348 11.2667 8.23333 10.152 8.23333 8.73333C8.23333 8.05567 8.49933 7.42233 8.97433 6.941L11.6153 4.3L10.8743 3.559C10.716 3.39433 10.5957 3.217 10.488 3.03333H1.26667C0.563667 3.03333 0 3.597 0 4.3V18.2333C0 18.93 0.563667 19.5 1.26667 19.5H15.2C15.8967 19.5 16.4667 18.93 16.4667 18.2333V9.01833C16.2893 8.917 16.1183 8.79667 15.9663 8.651L15.2 7.88467Z" fill="#037F72"></path></g><defs><clipPath id="clip0_1051_6167"><rect width="19" height="19" fill="white" transform="translate(0 0.5)"></rect></clipPath></defs></svg>',1))],8,_b)]))),128))])],64)):e.createCommentVNode("",!0)])],64)}}},Tb={class:"block rounded-4 mt-4"},wb={class:"table-responsive",style:{"min-height":"400px"}},Db={class:"table teal-table","aria-label":"公告列表"},Sb={"data-th":"公告時間:"},Ab={"data-th":"公告標題:",class:"text-start"},Fb=["href"],Ub={"data-th":"發布單位:",class:"text-start"},Mb={__name:"NewsList",setup(B){const _=e.ref([]),x=e.ref(1),p=e.ref(10),s=e.computed(()=>_.value.slice((x.value-1)*p.value,x.value*p.value)),f=(r,o)=>{x.value=parseInt(r),p.value=parseInt(o)};return e.onMounted(()=>{F.system("getPublishedNewsList").subscribe(r=>_.value=r.List)}),(r,o)=>{const l=e.resolveComponent("tw-date"),c=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock("div",Tb,[o[1]||(o[1]=e.createElementVNode("div",{class:"title border-teal"},[e.createElementVNode("div",{class:"d-flex align-items-center gap-2"},[e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")])])],-1)),e.createElementVNode("div",wb,[e.createElementVNode("table",Db,[o[0]||(o[0]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告時間"),e.createElementVNode("th",{scope:"col",class:"text-start"},"標題"),e.createElementVNode("th",{scope:"col",style:{width:"300px"}},"發布單位")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),m=>(e.openBlock(),e.createElementBlock("tr",{key:m},[e.createElementVNode("td",Sb,[e.createVNode(l,{value:m.EnableTime},null,8,["value"])]),e.createElementVNode("td",Ab,[e.createElementVNode("a",{class:"link-black",href:`NewsDetail.aspx?ID=${m.ID}`},e.toDisplayString(m.Title),9,Fb)]),e.createElementVNode("td",Ub,e.toDisplayString(m.UserOrg)+" "+e.toDisplayString(m.UserName),1)]))),128))])])]),e.createVNode(c,{count:e.unref(_).length,onChange:f,page:e.unref(x),"page-size":e.unref(p)},null,8,["count","page","page-size"])])}}},Ib={key:0,class:"scroll-bottom-panel"},Pb={class:"d-flex flex-column gap-3 mb-3"},jb={class:"d-flex gap-2"},Ob={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Lb={class:"text-nowrap my-2 d-flex align-items-center"},qb={__name:"ProjectChangeReview",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const _=B,x=j(),p=[{value:1,text:"通過"},{value:2,text:"退回修改"}],s=e.ref({}),f=e.ref({ID:_.id,Result:1}),r=()=>{const l={};if(f.value.Result>1&&(l.Reason="原因"),s.value=I(f.value,l),Object.keys(s.value).length){o();return}F[_.type]("reviewApplicationChange",f.value).subscribe(c=>{c&&(window.location.href="../ReviewChecklist.aspx?type=5")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,l=>{l>1&&o()}),(l,c)=>{const m=e.resolveComponent("input-radio-group"),a=e.resolveComponent("input-textarea");return e.unref(x)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",Ib,[c[3]||(c[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Pb,[e.createElementVNode("li",jb,[c[2]||(c[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Ob,[e.createElementVNode("div",Lb,[e.createVNode(m,{options:p,modelValue:e.unref(f).Result,"onUpdate:modelValue":c[0]||(c[0]=y=>e.unref(f).Result=y)},null,8,["modelValue"])]),e.unref(f).Result>1?(e.openBlock(),e.createBlock(a,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":c[1]||(c[1]=y=>e.unref(f).Reason=y)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Rb={key:0,class:"scroll-bottom-panel"},zb={class:"d-flex flex-column gap-3 mb-3"},Gb={class:"d-flex gap-2"},Jb={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Yb={class:"text-nowrap my-2 d-flex align-items-center"},Qb={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(B){const _=B,x=j(),p=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],s=e.ref({}),f=e.ref({ID:_.id,Result:1}),r=()=>{const l={};if(f.value.Result>1&&(l.Reason="原因"),s.value=I(f.value,l),Object.keys(s.value).length){o();return}F[_.type]("reviewApplication",f.value).subscribe(c=>{c&&(window.location.href="../ReviewChecklist.aspx?type=4")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,l=>{l>1&&o()}),(l,c)=>{const m=e.resolveComponent("input-radio-group"),a=e.resolveComponent("input-textarea");return e.unref(x)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",Rb,[c[3]||(c[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",zb,[e.createElementVNode("li",Gb,[c[2]||(c[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Jb,[e.createElementVNode("div",Yb,[e.createVNode(m,{options:p,modelValue:e.unref(f).Result,"onUpdate:modelValue":c[0]||(c[0]=y=>e.unref(f).Result=y)},null,8,["modelValue"])]),e.unref(f).Result>1?(e.openBlock(),e.createBlock(a,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":c[1]||(c[1]=y=>e.unref(f).Reason=y)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Wb={class:"d-flex align-items-center gap-3"},Hb={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Xb={class:"modal-content"},Kb={class:"modal-header"},Zb={class:"fs-24 fw-bold text-green-light"},vb={class:"modal-body"},eg={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},tg=["disabled"],lg={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(B){const _=B,x=e.computed(()=>!f.value||f.value===o[_.type].organizer),p=e.ref(),s=e.computed(()=>o[_.type].organizerName),f=e.ref(0),r=e.computed(()=>{var u;return(u=m.value.find(g=>g.UnitID===c.value))==null?void 0:u.reviewers}),o=j(),l=e.computed(()=>s.value?"移轉案件":"認領案件"),c=e.ref(0),m=e.ref([]),a=()=>{F[_.type]("queryReviewUnits").subscribe(u=>{m.value=u,rxjs.forkJoin(m.value.map(g=>F[_.type]("queryReviewersByUnit",{ID:g.UnitID}))).subscribe(g=>{g.forEach((d,n)=>{m.value[n].reviewers=d,d.some(k=>k.UserID===f.value)&&(c.value=m.value[n].UnitID)}),bootstrap.Modal.getOrCreateInstance(p.value).show()})})},y=()=>{F[_.type]("saveOrganizer",{ID:_.id,Organizer:f.value}).subscribe(u=>{u&&window.location.reload()})};return e.watch(s,()=>f.value=o[_.type].organizer),e.watch(c,()=>{r.value.some(u=>u.UserID===f.value)||(f.value=0)}),(u,g)=>{const d=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wb,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(s)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:a,type:"button"},e.toDisplayString(e.unref(l)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:p,tabindex:"-1"},[e.createElementVNode("div",Hb,[e.createElementVNode("div",Xb,[e.createElementVNode("div",Kb,[e.createElementVNode("h4",Zb,e.toDisplayString(e.unref(l)),1),g[2]||(g[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",vb,[e.createElementVNode("div",null,[g[3]||(g[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(d,{"empty-value":0,options:e.unref(m),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(c),"onUpdate:modelValue":g[0]||(g[0]=n=>e.isRef(c)?c.value=n:null)},null,8,["options","modelValue"]),e.createVNode(d,{class:"mt-2","empty-value":0,options:e.unref(r),"text-name":"Name","value-name":"UserID",modelValue:e.unref(f),"onUpdate:modelValue":g[1]||(g[1]=n=>e.isRef(f)?f.value=n:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",eg,[g[4]||(g[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:y,disabled:e.unref(x),type:"button"},"確認",8,tg)])])])])],512)]))],64)}}},og={class:"step-line-wrapper"},ng={class:"step-line"},rg={key:0,class:"tag tag-white"},ag={key:1,class:"tag tag-white"},dg={key:0,class:"step-line"},sg={key:0,class:"tag tag-white"},cg={class:"step-line"},ig={key:0,class:"tag tag-white"},mg={key:0,class:"tag tag-white"},pg={__name:"ProjectProgress",props:{excludes:{default:[],type:Array},id:{type:[Number,String]},step:{required:!0,type:Number},type:{required:!0,type:String}},setup(B){const _=j(),x=B,p=s=>{location.href=`${s}.aspx?ID=${x.id}`};return(s,f)=>(e.openBlock(),e.createElementBlock("div",og,[e.createElementVNode("div",ng,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===1}]),onClick:f[0]||(f[0]=r=>p("Audit")),role:"button"},[f[4]||(f[4]=e.createElementVNode("div",{class:"step-line-item-title"},"核定計畫",-1)),B.step===1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[[1,4].includes(e.unref(_)[x.type].changeStatus)?(e.openBlock(),e.createElementBlock("div",rg,"編輯中")):e.unref(_)[x.type].changeStatus===2?(e.openBlock(),e.createElementBlock("div",ag,"審核中")):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)],2)]),B.excludes.includes(4)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",dg,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===4}]),onClick:f[1]||(f[1]=r=>p("Progress")),role:"button"},[f[5]||(f[5]=e.createElementVNode("div",{class:"step-line-item-title"},"每月進度",-1)),B.step===4?(e.openBlock(),e.createElementBlock("div",sg,"編輯中")):e.createCommentVNode("",!0)],2)])),e.createElementVNode("div",cg,[e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===5}]),onClick:f[2]||(f[2]=r=>p("Report")),role:"button"},[f[6]||(f[6]=e.createElementVNode("div",{class:"step-line-item-title"},"階段報告",-1)),B.step===5?(e.openBlock(),e.createElementBlock("div",ig,"編輯中")):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass(["step-line-item",{active:B.step===6}]),onClick:f[3]||(f[3]=r=>p("Payment")),role:"button"},[f[7]||(f[7]=e.createElementVNode("div",{class:"step-line-item-title"},"請款核銷",-1)),B.step===6?(e.openBlock(),e.createElementBlock("div",mg,"編輯中")):e.createCommentVNode("",!0)],2)])]))}},Vg={class:"block"},fg={class:"square-title"},Ng=["innerHTML"],Eg={class:"table-responsive mt-3"},bg={class:"table align-middle gray-table"},gg={class:"text-center"},kg=["href"],yg={key:0,class:"text-center"},ug={key:0},xg={key:1,class:"text-pink"},hg={key:1,class:"tag-group mt-2 gap-1"},$g={key:0,class:"tag tag-green-light"},Bg=["download","href"],_g=["onClick"],Cg={key:0,class:"block-bottom bg-light-teal"},Tg=["disabled"],wg={__name:"ProjectReport",props:{data:{required:!0,type:Object},id:{type:[Number,String]},type:{type:String}},emits:["next"],setup(B,{emit:_}){let x;const p=B,s=e.computed(()=>f.value.some(u=>!u.Optional&&!u.Files.filter(g=>!g.Deleted).length)),f=e.ref(p.data.docs.map(u=>({...u,Files:[]}))),r=e.ref(),o=e.ref({}),l=(u,g)=>{g.Type==="application/zip"&&u.Files.push({Type:u.Type,Path:g.Path,Name:`${p.id}_${u.Title}_${x}.zip`})},c=F.download,m=_,a=()=>{F[p.type]("getReport",{ID:p.id,Stage:p.data.id}).subscribe(u=>{var g;o.value=u.Report,f.value.forEach(d=>{d.Files=u.Attachments.filter(n=>n.Type===d.Type),d.Uploaded=e.computed(()=>d.Files.filter(n=>!n.Deleted).length)}),r.value=!o.value.Status||o.value.Status==="暫存",x=(g=o.value)!=null&&g.Reviewer?"修訂版":"初版",j().init(p.type,u.Project,o.value)})},y=u=>{const g={ID:p.id,Stage:p.data.id,Attachments:f.value.reduce((d,n)=>d.concat(n.Files),[]),Submit:u?"true":"false"};F[p.type]("saveReport",g).subscribe(()=>{u?m("next"):a()})};return e.onMounted(a),e.provide("editable",r),(u,g)=>{const d=e.resolveComponent("required-label"),n=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Vg,[e.createElementVNode("h5",fg,e.toDisplayString(B.data.subtitle),1),e.createElementVNode("p",{class:"text-pink mt-3 lh-base",innerHTML:B.data.description},null,8,Ng),e.createElementVNode("div",Eg,[e.createElementVNode("table",bg,[g[4]||(g[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"70",class:"text-center"},"附件編號"),e.createElementVNode("th",null,"附件名稱"),e.createElementVNode("th",{class:"text-center"},"狀態"),e.createElementVNode("th",null,"上傳附件")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(k,i)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",gg,e.toDisplayString(i+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[e.createVNode(d,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Title),1)]),_:2},1024)]),e.unref(r)&&k.Template?(e.openBlock(),e.createElementBlock("a",{key:0,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",href:k.Template,style:{width:"140px"},type:"button"},[...g[2]||(g[2]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])],8,kg)):e.createCommentVNode("",!0)]),e.unref(r)?(e.openBlock(),e.createElementBlock("td",yg,[k.Uploaded?(e.openBlock(),e.createElementBlock("span",ug,"已上傳")):(e.openBlock(),e.createElementBlock("span",xg,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(r)&&!k.Uploaded?(e.openBlock(),e.createBlock(n,{key:0,accept:".zip",onFile:N=>l(k,N)},null,8,["onFile"])):e.createCommentVNode("",!0),k.Uploaded?(e.openBlock(),e.createElementBlock("div",hg,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.Files,N=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:N},[N.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",$g,[e.createElementVNode("a",{class:"tag-link my-1",download:N.Name,href:e.unref(c)(N.Path)},e.toDisplayString(N.Name),9,Bg),e.unref(r)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:V=>N.Deleted=!0,type:"button"},[...g[3]||(g[3]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,_g)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",Cg,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:g[0]||(g[0]=k=>y()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:g[1]||(g[1]=k=>y(!0)),disabled:e.unref(s),type:"button"},[...g[5]||(g[5]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("提送",-1)])],8,Tg)])):e.createCommentVNode("",!0)],64)}}},Dg={key:0,class:"scroll-bottom-panel"},Sg={class:"d-flex flex-column gap-3 mb-3"},Ag={class:"d-flex gap-2"},Fg={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Ug={class:"text-nowrap my-2 d-flex align-items-center"},Mg={__name:"ProjectReportReview",props:{id:{type:[Number,String]},stage:{type:Number},type:{type:String}},setup(B){const _=B,x=j(),p=[{value:1,text:"通過"},{value:2,text:"退回修改"}],s=e.ref({}),f=e.ref({ID:_.id,Result:1}),r=()=>{const l={};if(f.value.Result>1&&(l.Reason="原因"),s.value=I(f.value,l),Object.keys(s.value).length){o();return}f.Stage=_.stage,F[_.type]("reviewReport",f.value).subscribe(c=>{c&&(window.location.href="../ReviewChecklist.aspx?type=6")})},o=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,l=>{l>1&&o()}),(l,c)=>{const m=e.resolveComponent("input-radio-group"),a=e.resolveComponent("input-textarea");return e.unref(x)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",Dg,[c[3]||(c[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Sg,[e.createElementVNode("li",Ag,[c[2]||(c[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Fg,[e.createElementVNode("div",Ug,[e.createVNode(m,{options:p,modelValue:e.unref(f).Result,"onUpdate:modelValue":c[0]||(c[0]=y=>e.unref(f).Result=y)},null,8,["modelValue"])]),e.unref(f).Result>1?(e.openBlock(),e.createBlock(a,{key:0,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":c[1]||(c[1]=y=>e.unref(f).Reason=y)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Ig={key:0,class:"scroll-bottom-panel"},Pg={class:"d-flex flex-column gap-3 mb-3"},jg={class:"d-flex gap-2"},Og={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Lg={class:"text-nowrap mb-2 d-flex align-items-center"},qg={key:0,class:"invalid mt-0"},Rg={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(B){const _=B,x=j(),p=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],s=e.ref({}),f=e.ref({ID:_.id,Result:1}),r=()=>{},o=()=>{},l=()=>{const m={};if(f.value.Result>1&&(m.Reason="原因"),f.value.Result===3&&(m.CorrectionDeadline="補正期限"),s.value=I(f.value,m),Object.keys(s.value).length){c();return}F[_.type]("reviewApplication",f.value).subscribe(a=>{a&&(window.location.href="../ReviewChecklist.aspx?type=1")})},c=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>f.value.Result,m=>{m>1&&c()}),(m,a)=>{const y=e.resolveComponent("input-radio-group"),u=e.resolveComponent("input-tw-date"),g=e.resolveComponent("input-textarea");return e.unref(x)[B.type].organizer?(e.openBlock(),e.createElementBlock("div",Ig,[a[9]||(a[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Pg,[e.createElementVNode("li",{class:"d-flex gap-2"},[a[3]||(a[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:r,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[a[6]||(a[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),a[7]||(a[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[a[4]||(a[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:o,href:"javascript:void(0)"},"1"),a[5]||(a[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",jg,[a[8]||(a[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",Og,[e.createElementVNode("div",Lg,[e.createVNode(y,{options:p,modelValue:e.unref(f).Result,"onUpdate:modelValue":a[0]||(a[0]=d=>e.unref(f).Result=d)},null,8,["modelValue"]),e.createVNode(u,{class:"form-control",drops:"up",modelValue:e.unref(f).CorrectionDeadline,"onUpdate:modelValue":a[1]||(a[1]=d=>e.unref(f).CorrectionDeadline=d)},null,8,["modelValue"])]),e.unref(s).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",qg,e.toDisplayString(e.unref(s).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(f).Result>1?(e.openBlock(),e.createBlock(g,{key:1,error:e.unref(s).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(f).Reason,"onUpdate:modelValue":a[2]||(a[2]=d=>e.unref(f).Reason=d)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:l,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},zg={class:"top-wrapper"},Gg={class:"top-block"},Jg={class:"d-flex align-items-center gap-3"},Yg={__name:"ProjectTitle",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const _=B,x=j();return(p,s)=>(e.openBlock(),e.createElementBlock("div",zg,[e.createElementVNode("div",Gg,[e.createElementVNode("div",Jg,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(x)[_.type].type)+"］"+e.toDisplayString(e.unref(x)[_.type].id)+"/"+e.toDisplayString(e.unref(x)[_.type].name),1)]),s[0]||(s[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},Qg={class:"block rounded-top-4 py-4 d-flex justify-content-between",style:{position:"sticky",top:"180px","z-index":"15"}},Wg={class:"d-flex gap-2"},Hg={key:0,class:"btn text-teal-dark",type:"button"},Xg={class:"d-flex gap-2"},Kg={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Zg={class:"modal-content"},vg={class:"modal-body"},ek={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},tk={class:"modal-content"},lk={class:"modal-body"},ok={class:"d-flex flex-column gap-4 mb-5"},nk={class:"d-flex align-items-center"},rk={class:"flex-grow-1"},ak={__name:"ProjectToolbar",props:{id:{type:[Number,String]},type:{type:String}},setup(B){const _=j(),x=B,p=e.ref({}),s=e.ref(),f=e.ref({}),r=e.ref(),o=e.ref({}),l=e.ref(),c=()=>{const g={Reason:"計畫變更原因"};f.value=I(p.value,g),!Object.keys(f.value).length&&F[x.type]("applyChange",p.value).subscribe(d=>{d&&location.reload()})},m=()=>{p.value={ID:x.id},bootstrap.Modal.getOrCreateInstance(s.value).show()},a=()=>{bootstrap.Modal.getOrCreateInstance(r.value).show()},y=()=>{o.value={ID:x.id},bootstrap.Modal.getOrCreateInstance(l.value).show()},u=()=>{const g={RejectReason:"計畫終止原因",RecoveryAmount:"已追回金額"};f.value=I(o.value,g),!Object.keys(f.value).length&&F[x.type]("terminate",o.value).subscribe(d=>{d&&(location.href="../ApplicationChecklist.aspx")})};return(g,d)=>{const n=e.resolveComponent("project-organizer"),k=e.resolveComponent("input-textarea"),i=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Qg,[e.createElementVNode("div",Wg,[e.unref(_)[x.type].changeStatus?(e.openBlock(),e.createElementBlock("button",Hg," 計畫變更申請中 ")):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark",onClick:m,type:"button"}," 計畫變更申請 ")),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:a,type:"button"},[...d[3]||(d[3]=[e.createElementVNode("i",{class:"fas fa-history"},null,-1),e.createTextVNode(" 計畫變更紀錄 ",-1)])]),d[4]||(d[4]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-download"}),e.createTextVNode(" 下載核定計畫書 ")],-1))]),e.createElementVNode("div",Xg,[e.createVNode(n,{id:B.id,type:B.type},null,8,["id","type"]),e.createElementVNode("button",{class:"btn btn-pink",onClick:y,type:"button"}," 計畫終止 ")])]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"applyModal",ref:s,tabindex:"-1"},[e.createElementVNode("div",Kg,[e.createElementVNode("div",Zg,[d[8]||(d[8]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更申請"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",vg,[d[6]||(d[6]=e.createElementVNode("p",{class:"text-pink lh-base py-3"},"提醒您：計畫變更審核通過後，每月進度資料將清空，必須重填！",-1)),d[7]||(d[7]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫變更原因",-1)),e.createVNode(k,{error:e.unref(f).Reason,modelValue:e.unref(p).Reason,"onUpdate:modelValue":d[0]||(d[0]=N=>e.unref(p).Reason=N),modelModifiers:{trim:!0}},null,8,["error","modelValue"]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[d[5]||(d[5]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:c},"確定變更")])])])])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"logModal",ref:r,tabindex:"-1"},[...d[9]||(d[9]=[e.createElementVNode("div",{class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"},[e.createElementVNode("div",{class:"modal-content"},[e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫變更紀錄"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])]),e.createElementVNode("div",{class:"modal-body"},[e.createElementVNode("div",{class:"table-responsive"},[e.createElementVNode("table",{class:"table align-middle gray-table lh-base"},[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"150"},"版次"),e.createElementVNode("th",{width:"150"},"變更時間"),e.createElementVNode("th",null,"變更者"),e.createElementVNode("th",null,"變更原因"),e.createElementVNode("th",null,"變更前"),e.createElementVNode("th",null,"變更後")])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,"核定版"),e.createElementVNode("td",null,"114/04/10"),e.createElementVNode("td",null,"劉申慶"),e.createElementVNode("td",null,"意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容"),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")]),e.createElementVNode("td",null,[e.createTextVNode("【期程／工作項目／查核】"),e.createElementVNode("br"),e.createTextVNode(" 1.OO資料，原為OOOOOOOO"),e.createElementVNode("br"),e.createTextVNode(" 2.OO資料，原為OOOOOOOO ")])])])])])])])],-1)])],512),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"terminateModal",ref:l,tabindex:"-1"},[e.createElementVNode("div",ek,[e.createElementVNode("div",tk,[d[14]||(d[14]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 text-green-light fw-bold"},"計畫終止"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",lk,[e.createElementVNode("div",ok,[e.createElementVNode("div",null,[d[10]||(d[10]=e.createElementVNode("div",{class:"text-gray pb-2"},"計畫終止原因：",-1)),e.createVNode(k,{error:e.unref(f).RejectReason,modelValue:e.unref(o).RejectReason,"onUpdate:modelValue":d[1]||(d[1]=N=>e.unref(o).RejectReason=N),modelModifiers:{trim:!0}},null,8,["error","modelValue"])]),d[12]||(d[12]=e.createElementVNode("div",{class:"d-flex align-items-center"},[e.createElementVNode("div",{class:"text-gray text-nowrap"},"已撥款："),e.createElementVNode("div",null,"700,000")],-1)),e.createElementVNode("div",nk,[d[11]||(d[11]=e.createElementVNode("div",{class:"text-gray text-nowrap"},"已追回：",-1)),e.createElementVNode("div",rk,[e.createVNode(i,{error:e.unref(f).RecoveryAmount,modelValue:e.unref(o).RecoveryAmount,"onUpdate:modelValue":d[2]||(d[2]=N=>e.unref(o).RecoveryAmount=N),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])]),e.createElementVNode("div",{class:"d-flex justify-content-center mt-4 gap-4"},[d[13]||(d[13]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:u},"送出")])])])])],512)]))],64)}}},dk={class:"search bg-gray mt-4"},sk={class:"search-form"},ck={class:"row g-3"},ik={class:"col-12 col-lg-4"},mk=["value"],pk={class:"col-12 col-lg-4"},Vk=["value"],fk={class:"row g-3"},Nk={class:"col-12 col-lg-6"},Ek={class:"col-12 col-lg-6"},bk={class:"total-list multiple-option"},gk={class:"all-total"},kk={class:"total-item-content"},yk={class:"count"},uk=["for"],xk={class:"total-item-title"},hk={class:"total-item-content"},$k={class:"count"},Bk=["id","onUpdate:modelValue"],_k={class:"block rounded-bottom-4"},Ck={class:"title border-teal"},Tk={class:"d-flex align-items-center gap-2"},wk={class:"text-teal"},Dk={class:"table-responsive",style:{"min-height":"400px"}},Sk={class:"table teal-table"},Ak={class:"total-row"},Fk={class:"text-end"},Uk={class:"text-end"},Mk={class:"text-end"},Ik={"data-th":"年度:"},Pk={"data-th":"類別:"},jk={"data-th":"計畫名稱:",style:{"text-align":"left"}},Ok=["href"],Lk={"data-th":"申請單位:",style:{"text-align":"left"}},qk={"data-th":"申請本會補助:",class:"text-end"},Rk={"data-th":"配合款:",class:"text-end"},zk={"data-th":"總經費:",class:"text-end"},Gk={"data-th":"狀態:",style:{"text-align":"center",width:"100px"}},Jk={class:"text-teal"},Yk={__name:"ApplyList",setup(B){const _=e.ref([{id:1,title:"申請中",checked:!0},{id:2,title:"審查中",checked:!0},{id:3,title:"已核定",checked:!0},{id:4,title:"未通過",checked:!0}]),x=e.ref([]),p=e.ref({}),s=e.ref([]),f=e.ref(1),r=e.ref(10),o=e.ref([]),l=e.computed(()=>m.value.filter(u=>_.value.find(g=>g.checked&&u.type===g.id))),c=e.computed(()=>l.value.slice((f.value-1)*r.value,f.value*r.value)),m=e.computed(()=>{let u=s.value;return p.value.category&&(u=u.filter(g=>g.Category===p.value.category)),p.value.unit&&(u=u.filter(g=>g.SupervisoryUnit===p.value.unit)),p.value.org&&(u=u.filter(g=>{var d;return(d=g.UserOrg)==null?void 0:d.includes(p.value.org)})),p.value.name&&(u=u.filter(g=>{var d;return g.ProjectID.includes(p.value.name)||((d=g.ProjectName)==null?void 0:d.includes(p.value.name))})),u}),a=(u,g)=>{f.value=parseInt(u),r.value=parseInt(g)},y=u=>{if(u.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${u.ProjectID}`;if(u.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${u.ProjectID}`;if(u.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${u.ProjectID}`;if(u.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${u.ProjectID}`;if(u.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${u.ProjectID}`};return e.onMounted(()=>{F.system("getApplyList").subscribe(u=>{s.value=u.List,s.value.forEach(g=>{[1,14].includes(g.Status)?g.type=1:[11,12,21,22,31,32,41,42,43,44].includes(g.Status)?g.type=2:[45,51,52,91].includes(g.Status)?g.type=3:g.type=4,x.value.includes(g.Category)||x.value.push(g.Category),o.value.includes(g.SupervisoryUnit)||o.value.push(g.SupervisoryUnit)})})}),(u,g)=>{const d=e.resolveComponent("input-text"),n=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",dk,[g[12]||(g[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",sk,[e.createElementVNode("div",ck,[g[8]||(g[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",ik,[g[5]||(g[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":g[0]||(g[0]=k=>e.unref(p).category=k)},[g[4]||(g[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(x),k=>(e.openBlock(),e.createElementBlock("option",{key:k,value:k},e.toDisplayString(k),9,mk))),128))],512),[[e.vModelSelect,e.unref(p).category]])]),e.createElementVNode("div",pk,[g[7]||(g[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":g[1]||(g[1]=k=>e.unref(p).unit=k)},[g[6]||(g[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),k=>(e.openBlock(),e.createElementBlock("option",{key:k,value:k},e.toDisplayString(k),9,Vk))),128))],512),[[e.vModelSelect,e.unref(p).unit]])])]),e.createElementVNode("div",fk,[e.createElementVNode("div",Nk,[g[9]||(g[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(d,{modelValue:e.unref(p).org,"onUpdate:modelValue":g[2]||(g[2]=k=>e.unref(p).org=k),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Ek,[g[10]||(g[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(d,{modelValue:e.unref(p).name,"onUpdate:modelValue":g[3]||(g[3]=k=>e.unref(p).name=k),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),g[11]||(g[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("ul",bk,[e.createElementVNode("li",gk,[g[14]||(g[14]=e.createElementVNode("div",{class:"total-item-title"},"總申請",-1)),e.createElementVNode("div",kk,[e.createElementVNode("span",yk,e.toDisplayString(e.unref(m).length),1),g[13]||(g[13]=e.createElementVNode("span",{class:"unit"},"件",-1))])]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),k=>(e.openBlock(),e.createElementBlock("li",{class:"total-item",key:k},[e.createElementVNode("label",{class:"checke-total",for:`apply-${k.id}`},[e.createElementVNode("div",null,[e.createElementVNode("div",xk,e.toDisplayString(k.title),1),e.createElementVNode("div",hk,[e.createElementVNode("span",$k,e.toDisplayString(e.unref(m).filter(i=>i.type===k.id).length),1),g[15]||(g[15]=e.createElementVNode("span",{class:"unit"},"件",-1))])]),g[16]||(g[16]=e.createElementVNode("img",{class:"check-icon",src:"../../assets/img/check-white.svg"},null,-1))],8,uk),e.withDirectives(e.createElementVNode("input",{class:"total-checkbox",id:`apply-${k.id}`,type:"checkbox","onUpdate:modelValue":i=>k.checked=i},null,8,Bk),[[e.vModelCheckbox,k.checked]])]))),128))]),e.createElementVNode("div",_k,[e.createElementVNode("div",Ck,[e.createElementVNode("div",Tk,[g[19]||(g[19]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[g[17]||(g[17]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",wk,e.toDisplayString(e.unref(l).length),1),g[18]||(g[18]=e.createTextVNode(" 筆資料",-1))])]),g[20]||(g[20]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",Dk,[e.createElementVNode("table",Sk,[e.createElementVNode("thead",null,[g[23]||(g[23]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"申請本會補助")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"總經費")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"狀態")])])],-1)),e.createElementVNode("tr",Ak,[g[21]||(g[21]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",Fk,e.toDisplayString(e.unref(l).reduce((k,i)=>k+i.ApplyAmount,0).toLocaleString()),1),e.createElementVNode("td",Uk,e.toDisplayString(e.unref(l).reduce((k,i)=>k+i.OtherAmount,0).toLocaleString()),1),e.createElementVNode("td",Mk,e.toDisplayString(e.unref(l).reduce((k,i)=>k+i.ApplyAmount+i.OtherAmount,0).toLocaleString()),1),g[22]||(g[22]=e.createElementVNode("td",null,null,-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),k=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",Ik,e.toDisplayString(k.Year),1),e.createElementVNode("td",Pk,e.toDisplayString(k.Category),1),e.createElementVNode("td",jk,[e.createElementVNode("a",{class:"link-black",href:y(k),target:"_blank"},e.toDisplayString(k.ProjectName||"[未設定]"),9,Ok)]),e.createElementVNode("td",Lk,e.toDisplayString(k.UserOrg),1),e.createElementVNode("td",qk,e.toDisplayString(k.ApplyAmount.toLocaleString()),1),e.createElementVNode("td",Rk,e.toDisplayString(k.OtherAmount.toLocaleString()),1),e.createElementVNode("td",zk,e.toDisplayString((k.ApplyAmount+k.OtherAmount).toLocaleString()),1),e.createElementVNode("td",Gk,[e.createElementVNode("span",Jk,e.toDisplayString(e.unref(_).find(i=>i.id===k.type).title),1)])]))),128))])])]),e.createVNode(n,{count:e.unref(l).length,onChange:a,page:e.unref(f),"page-size":e.unref(r)},null,8,["count","page","page-size"])])],64)}}},Qk={class:"search bg-gray mt-4"},Wk={class:"search-form"},Hk={class:"row g-3"},Xk={class:"col-12 col-lg-4"},Kk=["value"],Zk={class:"col-12 col-lg-4"},vk=["value"],ey={class:"row g-3"},ty={class:"col-12 col-lg-6"},ly={class:"col-12 col-lg-6"},oy={class:"block rounded-bottom-4"},ny={class:"title border-teal"},ry={class:"d-flex align-items-center gap-2"},ay={class:"text-teal"},dy={class:"table-responsive",style:{"min-height":"400px"}},sy={class:"table teal-table"},cy={class:"total-row"},iy={class:"text-end"},my={class:"text-end"},py={"data-th":"年度:"},Vy={"data-th":"類別:"},fy={"data-th":"計畫名稱:",style:{"text-align":"left"}},Ny=["href"],Ey={"data-th":"申請單位:",style:{"text-align":"left"}},by={"data-th":"本會補助金額:",class:"text-end"},gy={"data-th":"配合款:",class:"text-end"},ky={__name:"ApprovedList",setup(B){const _=e.ref([]),x=e.ref({}),p=e.ref([]),s=e.ref(1),f=e.ref(10),r=e.ref([]),o=e.computed(()=>l.value.slice((s.value-1)*f.value,s.value*f.value)),l=e.computed(()=>{let a=p.value;return x.value.category&&(a=a.filter(y=>y.Category===x.value.category)),x.value.unit&&(a=a.filter(y=>y.SupervisoryUnit===x.value.unit)),x.value.org&&(a=a.filter(y=>{var u;return(u=y.UserOrg)==null?void 0:u.includes(x.value.org)})),x.value.name&&(a=a.filter(y=>{var u;return y.ProjectID.includes(x.value.name)||((u=y.ProjectName)==null?void 0:u.includes(x.value.name))})),a}),c=(a,y)=>{s.value=parseInt(a),f.value=parseInt(y)},m=a=>{if(a.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${a.ProjectID}`;if(a.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${a.ProjectID}`;if(a.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${a.ProjectID}`;if(a.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${a.ProjectID}`;if(a.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${a.ProjectID}`};return e.onMounted(()=>{F.system("getApprovedList").subscribe(a=>{p.value=a.List,p.value.forEach(y=>{_.value.includes(y.Category)||_.value.push(y.Category),r.value.includes(y.SupervisoryUnit)||r.value.push(y.SupervisoryUnit)})})}),(a,y)=>{const u=e.resolveComponent("input-text"),g=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Qk,[y[12]||(y[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",Wk,[e.createElementVNode("div",Hk,[y[8]||(y[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",Xk,[y[5]||(y[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":y[0]||(y[0]=d=>e.unref(x).category=d)},[y[4]||(y[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),d=>(e.openBlock(),e.createElementBlock("option",{key:d,value:d},e.toDisplayString(d),9,Kk))),128))],512),[[e.vModelSelect,e.unref(x).category]])]),e.createElementVNode("div",Zk,[y[7]||(y[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":y[1]||(y[1]=d=>e.unref(x).unit=d)},[y[6]||(y[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),d=>(e.openBlock(),e.createElementBlock("option",{key:d,value:d},e.toDisplayString(d),9,vk))),128))],512),[[e.vModelSelect,e.unref(x).unit]])])]),e.createElementVNode("div",ey,[e.createElementVNode("div",ty,[y[9]||(y[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(u,{modelValue:e.unref(x).org,"onUpdate:modelValue":y[2]||(y[2]=d=>e.unref(x).org=d),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",ly,[y[10]||(y[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(u,{modelValue:e.unref(x).name,"onUpdate:modelValue":y[3]||(y[3]=d=>e.unref(x).name=d),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),y[11]||(y[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("div",oy,[e.createElementVNode("div",ny,[e.createElementVNode("div",ry,[y[15]||(y[15]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[y[13]||(y[13]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",ay,e.toDisplayString(e.unref(l).length),1),y[14]||(y[14]=e.createTextVNode(" 筆資料",-1))])]),y[16]||(y[16]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",dy,[e.createElementVNode("table",sy,[e.createElementVNode("thead",null,[y[18]||(y[18]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會補助金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])])],-1)),e.createElementVNode("tr",cy,[y[17]||(y[17]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",iy,e.toDisplayString(e.unref(l).reduce((d,n)=>d+n.ApprovedAmount,0).toLocaleString()),1),e.createElementVNode("td",my,e.toDisplayString(e.unref(l).reduce((d,n)=>d+n.OtherAmount,0).toLocaleString()),1)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),d=>(e.openBlock(),e.createElementBlock("tr",{key:d},[e.createElementVNode("td",py,e.toDisplayString(d.Year),1),e.createElementVNode("td",Vy,e.toDisplayString(d.Category),1),e.createElementVNode("td",fy,[e.createElementVNode("a",{class:"link-black",href:m(d),target:"_blank"},e.toDisplayString(d.ProjectName),9,Ny)]),e.createElementVNode("td",Ey,e.toDisplayString(d.UserOrg),1),e.createElementVNode("td",by,e.toDisplayString(d.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",gy,e.toDisplayString(d.OtherAmount.toLocaleString()),1)]))),128))])])]),e.createVNode(g,{count:e.unref(l).length,onChange:c,page:e.unref(s),"page-size":e.unref(f)},null,8,["count","page","page-size"])])],64)}}},yy={class:"search bg-gray mt-4"},uy={class:"search-form"},xy={class:"row g-3"},hy={class:"col-12 col-lg-4"},$y=["value"],By={class:"col-12 col-lg-4"},_y=["value"],Cy={class:"row g-3"},Ty={class:"col-12 col-lg-6"},wy={class:"col-12 col-lg-6"},Dy={class:"block rounded-bottom-4"},Sy={class:"title border-teal"},Ay={class:"d-flex align-items-center gap-2"},Fy={class:"text-teal"},Uy={class:"table-responsive",style:{"min-height":"400px"}},My={class:"table teal-table"},Iy={class:"total-row"},Py={class:"text-end"},jy={class:"text-end"},Oy={class:"text-end"},Ly={class:"text-end"},qy={class:"text-end"},Ry={"data-th":"年度:"},zy={"data-th":"類別:"},Gy={"data-th":"計畫名稱:",style:{"text-align":"left"}},Jy=["href"],Yy={"data-th":"申請單位:",style:{"text-align":"left"}},Qy={"data-th":"本會補助金額:",class:"text-end"},Wy={"data-th":"配合款:",class:"text-end"},Hy={"data-th":"實支金額:",class:"text-end"},Xy={"data-th":"累積經費執行率:",class:"text-end"},Ky={"data-th":"本會已撥金額:",class:"text-end"},Zy={__name:"InprogressList",setup(B){const _=e.ref([]),x=e.ref({}),p=e.ref([]),s=e.ref(1),f=e.ref(10),r=e.ref([]),o=e.computed(()=>m.value.reduce((g,d)=>g+d.ApprovedAmount,0)),l=e.computed(()=>m.value.slice((s.value-1)*f.value,s.value*f.value)),c=e.computed(()=>m.value.reduce((g,d)=>g+d.SpendAmount,0)),m=e.computed(()=>{let g=p.value;return x.value.category&&(g=g.filter(d=>d.Category===x.value.category)),x.value.unit&&(g=g.filter(d=>d.SupervisoryUnit===x.value.unit)),x.value.org&&(g=g.filter(d=>{var n;return(n=d.UserOrg)==null?void 0:n.includes(x.value.org)})),x.value.name&&(g=g.filter(d=>{var n;return d.ProjectID.includes(x.value.name)||((n=d.ProjectName)==null?void 0:n.includes(x.value.name))})),g}),a=(g,d)=>{s.value=parseInt(g),f.value=parseInt(d)},y=g=>{if(g.ProjectID.includes("CUL"))return`../CUL/Application.aspx?ID=${g.ProjectID}`;if(g.ProjectID.includes("EDC"))return`../EDC/Application.aspx?ID=${g.ProjectID}`;if(g.ProjectID.includes("MUL"))return`../MUL/Application.aspx?ID=${g.ProjectID}`;if(g.ProjectID.includes("LIT"))return`../LIT/Application.aspx?ID=${g.ProjectID}`;if(g.ProjectID.includes("ACC"))return`../ACC/Application.aspx?ID=${g.ProjectID}`},u=(g,d)=>d?Math.round(g*100/d*100)/100:0;return e.onMounted(()=>{F.system("getInprogressList").subscribe(g=>{p.value=g.List,p.value.forEach(d=>{_.value.includes(d.Category)||_.value.push(d.Category),r.value.includes(d.SupervisoryUnit)||r.value.push(d.SupervisoryUnit)})})}),(g,d)=>{const n=e.resolveComponent("input-text"),k=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yy,[d[12]||(d[12]=e.createElementVNode("h3",{class:"text-teal"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1)),e.createElementVNode("div",uy,[e.createElementVNode("div",xy,[d[8]||(d[8]=e.createElementVNode("div",{class:"col-12 col-lg-4"},[e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度"),e.createElementVNode("select",{class:"form-select"},[e.createElementVNode("option",null,"114年")])],-1)),e.createElementVNode("div",hy,[d[5]||(d[5]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"類別",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":d[0]||(d[0]=i=>e.unref(x).category=i)},[d[4]||(d[4]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(_),i=>(e.openBlock(),e.createElementBlock("option",{key:i,value:i},e.toDisplayString(i),9,$y))),128))],512),[[e.vModelSelect,e.unref(x).category]])]),e.createElementVNode("div",By,[d[7]||(d[7]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"主管單位",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":d[1]||(d[1]=i=>e.unref(x).unit=i)},[d[6]||(d[6]=e.createElementVNode("option",{value:void 0},"全部",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),i=>(e.openBlock(),e.createElementBlock("option",{key:i,value:i},e.toDisplayString(i),9,_y))),128))],512),[[e.vModelSelect,e.unref(x).unit]])])]),e.createElementVNode("div",Cy,[e.createElementVNode("div",Ty,[d[9]||(d[9]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"申請補助單位",-1)),e.createVNode(n,{modelValue:e.unref(x).org,"onUpdate:modelValue":d[2]||(d[2]=i=>e.unref(x).org=i),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",wy,[d[10]||(d[10]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"計畫編號, 計畫名稱",-1)),e.createVNode(n,{modelValue:e.unref(x).name,"onUpdate:modelValue":d[3]||(d[3]=i=>e.unref(x).name=i),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),d[11]||(d[11]=e.createElementVNode("button",{class:"btn btn-teal-dark d-table mx-auto",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-magnifying-glass"}),e.createTextVNode(" 查詢 ")],-1))])]),e.createElementVNode("div",Dy,[e.createElementVNode("div",Sy,[e.createElementVNode("div",Ay,[d[15]||(d[15]=e.createElementVNode("h4",{class:"text-teal"},[e.createElementVNode("img",{src:"../../assets/img/title-icon02-teal.svg",alt:"logo"}),e.createElementVNode("span",null,"列表")],-1)),e.createElementVNode("span",null,[d[13]||(d[13]=e.createTextVNode("共 ",-1)),e.createElementVNode("span",Fy,e.toDisplayString(e.unref(m).length),1),d[14]||(d[14]=e.createTextVNode(" 筆資料",-1))])]),d[16]||(d[16]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"},[e.createElementVNode("i",{class:"fas fa-download"}),e.createTextVNode("匯出")],-1))]),e.createElementVNode("div",Uy,[e.createElementVNode("table",My,[e.createElementVNode("thead",null,[d[18]||(d[18]=e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80"},"年度"),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"類別")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"計畫名稱")])]),e.createElementVNode("th",{width:"240"},[e.createElementVNode("div",{class:"hstack align-items-center"},[e.createElementVNode("span",null,"申請單位")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會補助金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"配合款")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"實支金額")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"累積經費執行率")])]),e.createElementVNode("th",null,[e.createElementVNode("div",{class:"hstack align-items-center justify-content-end"},[e.createElementVNode("span",null,"本會已撥金額")])])],-1)),e.createElementVNode("tr",Iy,[d[17]||(d[17]=e.createElementVNode("td",{colspan:"4",style:{"text-align":"end"}},"總計",-1)),e.createElementVNode("td",Py,e.toDisplayString(e.unref(o).toLocaleString()),1),e.createElementVNode("td",jy,e.toDisplayString(e.unref(m).reduce((i,N)=>i+N.OtherAmount,0).toLocaleString()),1),e.createElementVNode("td",Oy,e.toDisplayString(e.unref(c).toLocaleString()),1),e.createElementVNode("td",Ly,e.toDisplayString(u(e.unref(c),e.unref(o)).toLocaleString())+"%",1),e.createElementVNode("td",qy,e.toDisplayString(e.unref(m).reduce((i,N)=>i+N.PaymentAmount,0).toLocaleString()),1)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),i=>(e.openBlock(),e.createElementBlock("tr",{key:i},[e.createElementVNode("td",Ry,e.toDisplayString(i.Year),1),e.createElementVNode("td",zy,e.toDisplayString(i.Category),1),e.createElementVNode("td",Gy,[e.createElementVNode("a",{class:"link-black",href:y(i),target:"_blank"},e.toDisplayString(i.ProjectName),9,Jy)]),e.createElementVNode("td",Yy,e.toDisplayString(i.UserOrg),1),e.createElementVNode("td",Qy,e.toDisplayString(i.ApprovedAmount.toLocaleString()),1),e.createElementVNode("td",Wy,e.toDisplayString(i.OtherAmount.toLocaleString()),1),e.createElementVNode("td",Hy,e.toDisplayString(i.SpendAmount.toLocaleString()),1),e.createElementVNode("td",Xy,e.toDisplayString(u(i.SpendAmount,i.ApprovedAmount).toLocaleString())+"%",1),e.createElementVNode("td",Ky,e.toDisplayString(i.PaymentAmount.toLocaleString()),1)]))),128))])])]),e.createVNode(k,{count:e.unref(m).length,onChange:a,page:e.unref(s),"page-size":e.unref(f)},null,8,["count","page","page-size"])])],64)}}},vy={__name:"MixChart",props:{list:{required:!0,type:Array}},setup(B){let _;const x=H().typeList,p=B,s=e.ref(),f=o=>{am5.ready(()=>{_=am5.Root.new(s.value),_.setThemes([am5themes_Animated.new(_)]);const l=_.container.children.push(am5xy.XYChart.new(_,{panX:!0,panY:!0,wheelX:"panX",wheelY:"zoomX",pinchZoomX:!0,layout:_.verticalLayout})),c=am5xy.AxisRendererX.new(_,{minGridDistance:30});c.labels.template.setAll({rotation:-45,centerY:am5.p50,centerX:am5.p100,textAlign:"right"});var m=l.xAxes.push(am5xy.CategoryAxis.new(_,{categoryField:"category",renderer:c,tooltip:am5.Tooltip.new(_,{})}));m.data.setAll(o);var a=l.yAxes.push(am5xy.ValueAxis.new(_,{renderer:am5xy.AxisRendererY.new(_,{})})),y=l.yAxes.push(am5xy.ValueAxis.new(_,{renderer:am5xy.AxisRendererY.new(_,{opposite:!0}),min:0,max:1,numberFormat:"#.0%",extraMax:.1,strictMinMax:!0}));const u=(i,N,V)=>{var E=l.series.push(am5xy.ColumnSeries.new(_,{name:N,xAxis:m,yAxis:a,valueYField:i,categoryXField:"category",clustered:!0,tooltip:am5.Tooltip.new(_,{labelText:"{name}: {valueY}"})}));return E.data.setAll(o),E.columns.template.setAll({fillOpacity:1,strokeOpacity:0,fill:am5.color(V),cornerRadiusTL:0,cornerRadiusTR:0,width:am5.percent(70)}),E};u("核定經費","核定經費",4946924),u("實支金額","實支金額",9323693),u("已撥付","已撥付",3447003);const g=(i,N,V)=>{var E=l.series.push(am5xy.LineSeries.new(_,{name:N,xAxis:m,yAxis:y,valueYField:i,categoryXField:"category",stroke:am5.color(V),fill:am5.color(V),tooltip:am5.Tooltip.new(_,{labelText:"{name}: {valueY.formatNumber('#.0%')}"})}));return E.strokes.template.setAll({strokeWidth:3}),E.bullets.push(()=>am5.Bullet.new(_,{sprite:am5.Circle.new(_,{radius:5,fill:E.get("stroke")})})),E.data.setAll(o),E};g("經費執行率(%)","經費執行率(%)",15105570),g("支用比(%)","支用比(%)",2600544),l.children.push(am5.Legend.new(_,{centerX:am5.p50,x:am5.p50,layout:_.horizontalLayout,useDefaultMarker:!0,maxWidth:300})).labels.template.setAll({fontSize:12,paddingLeft:4,paddingRight:4,marginTop:4,marginBottom:4,marginLeft:4,marginRight:4});var n=l.children.push(am5.Legend.new(_,{centerX:am5.p0,x:am5.p0,layout:_.horizontalLayout,useDefaultMarker:!0,maxWidth:300}));n.data.setAll([l.series.getIndex(0),l.series.getIndex(1),l.series.getIndex(2)]);var k=l.children.push(am5.Legend.new(_,{centerX:am5.p100,x:am5.p100,layout:_.horizontalLayout,useDefaultMarker:!0,maxWidth:300}));k.data.setAll([l.series.getIndex(3),l.series.getIndex(4)]),l.set("cursor",am5xy.XYCursor.new(_,{}))})},r=(o,l,c=2)=>{if(l){const m=10**c;return Math.round(o*100/l*m)/m}return 0};return e.watch(()=>p.list,()=>{f(x.map(o=>{const l={category:o.title,核定經費:0,實支金額:0,已撥付:0,"經費執行率(%)":0,"支用比(%)":0},c=p.list.find(m=>m.Category===o.code);return c&&(l.核定經費=Math.floor(c.ApprovedAmount/1e3),l.實支金額=Math.floor(c.SpendAmount/1e3),l.已撥付=Math.floor(c.PaymentAmount/1e3),l["經費執行率(%)"]=r(l.實支金額,l.核定經費,1),l["支用比(%)"]=r(l.實支金額,l.已撥付,1)),l}))}),(o,l)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"container",ref:s},null,512))}},eu={__name:"PieChart",props:{active:{required:!0,type:String},color:{required:!0,type:Number},inactive:{required:!0,type:String},percent:{required:!0,type:Number}},setup(B){let _,x,p;const s=B,f=e.ref();return e.onMounted(()=>{am5.ready(()=>{x=am5.Root.new(f.value),x.setThemes([am5themes_Animated.new(x)]);const r=x.container.children.push(am5percent.PieChart.new(x,{innerRadius:95,width:158,x:am5.p50,y:am5.p50,centerX:am5.p50,centerY:am5.p50,layout:x.verticalLayout}));p=r.series.push(am5percent.PieSeries.new(x,{valueField:"size",categoryField:"sector"})),p.set("colors",am5.ColorSet.new(x,{colors:[am5.color(s.color),am5.color(16119285)]})),p.labels.template.set("visible",!1),p.ticks.template.set("visible",!1),p.data.setAll([{sector:s.active,size:s.percent},{sector:s.inactive,size:100-s.percent}]),p.appear(1e3,100),_=x.tooltipContainer.children.push(am5.Label.new(x,{x:am5.p50,y:am5.p50,centerX:am5.p50,centerY:am5.p50,fill:am5.color(s.color),fontSize:28,fontWeight:"bold"})),_.set("text",`${s.percent}%`);const o=()=>{var l=window.innerWidth>=768&&window.innerWidth<=1024,c=l?105:158,m=l?55:95,a=l?20:28;r.set("width",c),r.set("innerRadius",m),_.set("fontSize",a)};o(),window.addEventListener("resize",o)})}),e.watch(()=>s.percent,r=>{_.set("text",`${r}%`),p.data.setAll([{sector:s.active,size:r},{sector:s.inactive,size:100-r}])}),(r,o)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"container",ref:f},null,512))}},tu={key:0,class:"text-pink"},lu={__name:"RequiredLabel",setup(B){const _=e.inject("editable",!0);return(x,p)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(_)?(e.openBlock(),e.createElementBlock("span",tu,"* ")):e.createCommentVNode("",!0),e.renderSlot(x.$slots,"default")],64))}},ou={class:"block"},nu={class:"table align-middle gray-table side-table"},ru=["value"],au={class:"table align-middle gray-table"},du={width:"1%"},su={width:"1%"},cu={class:"d-flex gap-2"},iu=["onClick"],mu={class:"d-flex align-items-center flex-wrap"},pu={class:"d-flex align-items-center text-nowrap me-3"},Vu={class:"d-flex align-items-center text-nowrap"},fu={key:0,class:"invalid mt-0"},Nu={key:0,class:"table align-middle gray-table"},Eu={width:"1%"},bu={width:"1%"},gu={class:"d-flex gap-2"},ku=["onClick"],yu={key:0,class:"tag-group mt-2 gap-1"},uu={class:"tag tag-green-light"},xu=["download","href"],hu={key:1},$u={key:2,class:"invalid mt-0"},Bu={key:0},_u={class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},Cu={__name:"GrantForm1",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=H().typeList,s=e.ref(!1),f=e.ref({}),r=e.ref({}),o=e.ref(),l=e.computed(()=>y.value.filter(k=>!k.Deleted)),c=e.computed(()=>a.value.filter(k=>!k.Deleted)),m=e.ref({}),a=e.ref([]),y=e.ref([]),u=F.download,g=_,d=k=>{var N,V,E;if(r.value={},f.value.Path=(N=o.value)==null?void 0:N.Path,f.value.Filename=(V=o.value)==null?void 0:V.Name,k&&!n()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}m.value.ShortName=(E=p.find(t=>t.code===m.value.TypeCode))==null?void 0:E.title;const i={GrantType:m.value,Content:f.value,Procedures:y.value,Links:a.value};F.system("saveGrantTypeContent",i).subscribe(t=>{t&&g("next")})},n=()=>{let k={ServiceContent:"內容",ContactPerson:"聯絡電話及分機",ContactTel:"聯絡人",Filename:"相關檔案"};return s.value&&(k.StatusReason="下架原因"),r.value=I(f.value,k),x.id||(k={TypeCode:"補助類別",Year:"年度",FullName:"補助類別全稱"},Object.assign(r.value,I(m.value,k))),l.value.length&&(k={Content:"內容"},l.value.forEach((i,N)=>Object.assign(r.value,I(i,k,`procedure-${N}-`)))),c.value.length&&(k={URL:"網址"},c.value.forEach((i,N)=>Object.assign(r.value,I(i,k,`link-${N}-`)))),!Object.keys(r.value).length};return e.onMounted(()=>{x.id?F.system("getGrantTypeContent",{ID:x.id}).subscribe(k=>{m.value=k.GrantType,f.value=k.Content,y.value=k.Procedures,a.value=k.Links,f.value.Filename&&(o.value={Name:f.value.Filename,Path:f.value.Path}),y.value.length||y.value.push({}),H().init(m.value.TypeCode)}):y.value.push({})}),(k,i)=>{const N=e.resolveComponent("required-label"),V=e.resolveComponent("input-select"),E=e.resolveComponent("input-integer"),t=e.resolveComponent("input-text"),b=e.resolveComponent("input-textarea"),h=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock("div",ou,[e.createElementVNode("table",nu,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[16]||(i[16]=[e.createTextVNode("補助類別(代碼)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(V,{class:"w-auto",error:e.unref(r).TypeCode,options:e.unref(p),modelValue:e.unref(m).TypeCode,"onUpdate:modelValue":i[0]||(i[0]=S=>e.unref(m).TypeCode=S)},{default:e.withCtx(({option:S})=>[e.createElementVNode("option",{value:S.code},e.toDisplayString(S.title)+" ("+e.toDisplayString(S.code)+")",9,ru)]),_:1},8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[17]||(i[17]=[e.createTextVNode("年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(E,{class:"w-auto",error:e.unref(r).Year,modelValue:e.unref(m).Year,"onUpdate:modelValue":i[1]||(i[1]=S=>e.unref(m).Year=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[18]||(i[18]=[e.createTextVNode("補助類別全稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(r).FullName,modelValue:e.unref(m).FullName,"onUpdate:modelValue":i[2]||(i[2]=S=>e.unref(m).FullName=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[19]||(i[19]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r).ServiceContent,modelValue:e.unref(f).ServiceContent,"onUpdate:modelValue":i[3]||(i[3]=S=>e.unref(f).ServiceContent=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[i[20]||(i[20]=e.createElementVNode("th",null,"申辦資格",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(f).Criteria,"onUpdate:modelValue":i[4]||(i[4]=S=>e.unref(f).Criteria=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[21]||(i[21]=[e.createTextVNode("申辦流程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("table",au,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(S,w)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",du,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(r)[`procedure-${w}-Content`],modelValue:S.Content,"onUpdate:modelValue":U=>S.Content=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",su,[e.createElementVNode("div",cu,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:U=>S.Deleted=!0,type:"button"},[...i[22]||(i[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,iu)):e.createCommentVNode("",!0),w+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i[5]||(i[5]=U=>e.unref(y).push({})),type:"button"},[...i[23]||(i[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])]))),128))])])])]),e.createElementVNode("tr",null,[i[24]||(i[24]=e.createElementVNode("th",null,"應備物品",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(f).Documentary,"onUpdate:modelValue":i[6]||(i[6]=S=>e.unref(f).Documentary=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[25]||(i[25]=[e.createTextVNode("聯絡窗口",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",mu,[e.createElementVNode("div",pu,[i[26]||(i[26]=e.createElementVNode("label",{class:"me-2"},"聯絡電話及分機",-1)),e.createVNode(t,{modelValue:e.unref(f).ContactTel,"onUpdate:modelValue":i[7]||(i[7]=S=>e.unref(f).ContactTel=S),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Vu,[i[27]||(i[27]=e.createElementVNode("label",{class:"me-2"},"聯絡人",-1)),e.createVNode(t,{modelValue:e.unref(f).ContactPerson,"onUpdate:modelValue":i[8]||(i[8]=S=>e.unref(f).ContactPerson=S),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.unref(r).ContactTel||e.unref(r).ContactPerson?(e.openBlock(),e.createElementBlock("div",fu,e.toDisplayString(e.unref(r).ContactTel||e.unref(r).ContactPerson),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[i[30]||(i[30]=e.createElementVNode("th",null,[e.createTextVNode("線上申辦"),e.createElementVNode("br"),e.createTextVNode("參考資料")],-1)),e.createElementVNode("td",null,[e.unref(c).length?(e.openBlock(),e.createElementBlock("table",Nu,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(S,w)=>(e.openBlock(),e.createElementBlock("tr",{key:S},[e.createElementVNode("td",Eu,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(r)[`link-${w}-URL`],modelValue:S.URL,"onUpdate:modelValue":U=>S.URL=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",bu,[e.createElementVNode("div",gu,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0",onClick:U=>S.Deleted=!0,type:"button"},[...i[28]||(i[28]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ku)])])]))),128))])])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:i[9]||(i[9]=S=>e.unref(a).push({})),type:"button"},[...i[29]||(i[29]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增",-1)])])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...i[31]||(i[31]=[e.createTextVNode("相關檔案",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(顯示於首頁)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(o)?(e.openBlock(),e.createElementBlock("div",yu,[e.createElementVNode("span",uu,[e.createElementVNode("a",{class:"tag-link my-1",download:e.unref(o).Name,href:e.unref(u)(e.unref(o).Path)},e.toDisplayString(e.unref(o).Name),9,xu),e.createElementVNode("button",{class:"tag-btn",onClick:i[10]||(i[10]=S=>o.value=null),type:"button"},[...i[32]||(i[32]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])])])])):(e.openBlock(),e.createElementBlock("div",hu,[e.createVNode(h,{onFile:i[11]||(i[11]=S=>o.value=S)})])),e.unref(r).Filename?(e.openBlock(),e.createElementBlock("div",$u,e.toDisplayString(e.unref(r).Filename),1)):e.createCommentVNode("",!0)])]),e.unref(f).IsValid?(e.openBlock(),e.createElementBlock("tr",Bu,[i[34]||(i[34]=e.createElementVNode("th",null,"申請下架",-1)),e.createElementVNode("td",null,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"status-checkbox",type:"checkbox","onUpdate:modelValue":i[12]||(i[12]=S=>e.isRef(s)?s.value=S:null)},null,512),[[e.vModelCheckbox,e.unref(s)]]),i[33]||(i[33]=e.createElementVNode("label",{class:"form-check-label ms-1 mb-2",for:"status-checkbox"},"申請E政府下架（請輸入原因）",-1)),e.createVNode(b,{error:e.unref(r).StatusReason,modelValue:e.unref(f).StatusReason,"onUpdate:modelValue":i[13]||(i[13]=S=>e.unref(f).StatusReason=S),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",_u,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[14]||(i[14]=S=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[15]||(i[15]=S=>d(!0)),type:"button"},[...i[35]||(i[35]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確定發布",-1)])])])])}}},Tu={class:"block"},wu={class:"table align-middle gray-table side-table"},Du={class:"p-0"},Su={class:"row align-items-center mb-0"},Au={class:"col p-4"},Fu={class:"col p-4"},Uu={class:"col p-4"},Mu={class:"d-flex align-items-center flex-wrap gap-2"},Iu={class:"input-group",style:{width:"360px"}},Pu={class:"d-flex align-items-center flex-wrap gap-2"},ju={class:"input-group",style:{width:"360px"}},Ou={style:{width:"360px"}},Lu={class:"d-flex align-items-center mb-2"},qu={class:"d-flex align-items-center mb-2"},Ru={class:"d-flex align-items-center mb-2"},zu={class:"d-flex align-items-center mb-2"},Gu={class:"d-flex align-items-center gap-2"},Ju={class:"d-flex align-items-center flex-wrap gap-2"},Yu={class:"input-group",style:{width:"360px"}},Qu={class:"d-flex align-items-center flex-wrap gap-2"},Wu={class:"input-group",style:{width:"360px"}},Hu={__name:"GrantForm2",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref({}),s=e.ref(!1),f=_,r=()=>{const o={};s.value||(p.value.OverduePeriod=null),F.system("saveGrantType",{GrantType:Object.assign(p.value,o)}).subscribe(l=>{l&&f("next")})};return e.onMounted(()=>{F.system("getGrantType",{ID:x.id}).subscribe(o=>{p.value=o.GrantType,p.value.OverduePeriod&&(s.value=!0)})}),(o,l)=>{const c=e.resolveComponent("input-integer"),m=e.resolveComponent("input-textarea"),a=e.resolveComponent("input-tw-date"),y=e.resolveComponent("input-text");return e.openBlock(),e.createElementBlock("div",Tu,[e.createElementVNode("table",wu,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[18]||(l[18]=e.createElementVNode("th",null,"補助類別 全稱",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(p).FullName),1)]),e.createElementVNode("tr",null,[l[21]||(l[21]=e.createElementVNode("th",null,"補助類別 簡稱",-1)),e.createElementVNode("td",Du,[e.createElementVNode("div",Su,[e.createElementVNode("div",Au,e.toDisplayString(e.unref(p).ShortName),1),l[19]||(l[19]=e.createElementVNode("div",{class:"col p-4 text-nowrap",style:{"border-right":"8px solid #DDDDDD","background-color":"#F5F5F5"}},"代碼",-1)),e.createElementVNode("div",Fu,e.toDisplayString(e.unref(p).TypeCode),1),l[20]||(l[20]=e.createElementVNode("div",{class:"col p-4 text-nowrap",style:{"border-right":"8px solid #DDDDDD","background-color":"#F5F5F5"}},"年度",-1)),e.createElementVNode("div",Uu,e.toDisplayString(e.unref(p).Year),1)])])]),e.createElementVNode("tr",null,[l[22]||(l[22]=e.createElementVNode("th",null,"總預算經費(元)",-1)),e.createElementVNode("td",null,[e.createVNode(c,{class:"w-auto",modelValue:e.unref(p).BudgetFees,"onUpdate:modelValue":l[0]||(l[0]=u=>e.unref(p).BudgetFees=u),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[l[23]||(l[23]=e.createElementVNode("th",null,"身分標籤",-1)),e.createElementVNode("td",null,[e.createVNode(m,{rows:"5",modelValue:e.unref(p).TargetTags,"onUpdate:modelValue":l[1]||(l[1]=u=>e.unref(p).TargetTags=u),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[l[25]||(l[25]=e.createElementVNode("th",null,"申請期間",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",Mu,[e.createElementVNode("div",Iu,[e.createVNode(a,{modelValue:e.unref(p).ApplyStartDate,"onUpdate:modelValue":l[2]||(l[2]=u=>e.unref(p).ApplyStartDate=u)},null,8,["modelValue"]),l[24]||(l[24]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(a,{modelValue:e.unref(p).ApplyEndDate,"onUpdate:modelValue":l[3]||(l[3]=u=>e.unref(p).ApplyEndDate=u)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[26]||(l[26]=e.createElementVNode("th",null,"計畫期程迄日",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",Pu,[e.createElementVNode("div",ju,[e.createVNode(a,{modelValue:e.unref(p).PlanEndDate,"onUpdate:modelValue":l[4]||(l[4]=u=>e.unref(p).PlanEndDate=u)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[31]||(l[31]=e.createElementVNode("th",null,"申請階段審查",-1)),e.createElementVNode("td",null,[e.createElementVNode("div",Ou,[e.createElementVNode("div",Lu,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-1",type:"checkbox",style:{visibility:"hidden"},"onUpdate:modelValue":l[5]||(l[5]=u=>e.unref(p).Review1Enabled=u)},null,512),[[e.vModelCheckbox,e.unref(p).Review1Enabled]]),l[27]||(l[27]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-1"},"1.",-1)),e.createVNode(y,{class:"w-auto","aria-label":"資格審查",placeholder:"資格審查",modelValue:e.unref(p).Review1Title,"onUpdate:modelValue":l[6]||(l[6]=u=>e.unref(p).Review1Title=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",qu,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-2",type:"checkbox","onUpdate:modelValue":l[7]||(l[7]=u=>e.unref(p).Review2Enabled=u)},null,512),[[e.vModelCheckbox,e.unref(p).Review2Enabled]]),l[28]||(l[28]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-2"},"2.",-1)),e.createVNode(y,{class:"w-auto","aria-label":"初審",placeholder:"初審",modelValue:e.unref(p).Review2Title,"onUpdate:modelValue":l[8]||(l[8]=u=>e.unref(p).Review2Title=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",Ru,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-3",type:"checkbox","onUpdate:modelValue":l[9]||(l[9]=u=>e.unref(p).Review3Enabled=u)},null,512),[[e.vModelCheckbox,e.unref(p).Review3Enabled]]),l[29]||(l[29]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-3"},"3.",-1)),e.createVNode(y,{class:"w-auto","aria-label":"複審",placeholder:"複審",modelValue:e.unref(p).Review3Title,"onUpdate:modelValue":l[10]||(l[10]=u=>e.unref(p).Review3Title=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e.createElementVNode("div",zu,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"review-4",type:"checkbox",style:{visibility:"hidden"},"onUpdate:modelValue":l[11]||(l[11]=u=>e.unref(p).Review4Enabled=u)},null,512),[[e.vModelCheckbox,e.unref(p).Review4Enabled]]),l[30]||(l[30]=e.createElementVNode("label",{class:"form-check-label ms-2 me-2",for:"review-4"},"4.",-1)),e.createVNode(y,{class:"w-auto","aria-label":"決審核定",placeholder:"決審核定",modelValue:e.unref(p).Review4Title,"onUpdate:modelValue":l[12]||(l[12]=u=>e.unref(p).Review4Title=u),modelModifiers:{trim:!0}},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[34]||(l[34]=e.createElementVNode("th",null,"補正補件期限",-1)),e.createElementVNode("td",Gu,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"overdue-period",type:"checkbox","onUpdate:modelValue":l[13]||(l[13]=u=>e.isRef(s)?s.value=u:null)},null,512),[[e.vModelCheckbox,e.unref(s)]]),l[33]||(l[33]=e.createElementVNode("label",{class:"form-check-label",for:"overdue-period"},"有期限",-1)),e.unref(s)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(c,{class:"w-auto",modelValue:e.unref(p).OverduePeriod,"onUpdate:modelValue":l[14]||(l[14]=u=>e.unref(p).OverduePeriod=u),modelModifiers:{trim:!0}},null,8,["modelValue"]),l[32]||(l[32]=e.createTextVNode("天 ",-1))],64)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[l[35]||(l[35]=e.createElementVNode("th",null,[e.createTextVNode("期中報告"),e.createElementVNode("br"),e.createTextVNode("繳交期限")],-1)),e.createElementVNode("td",null,[e.createElementVNode("span",Ju,[e.createElementVNode("span",Yu,[e.createVNode(a,{modelValue:e.unref(p).MidtermDeadline,"onUpdate:modelValue":l[15]||(l[15]=u=>e.unref(p).MidtermDeadline=u)},null,8,["modelValue"])])])])]),e.createElementVNode("tr",null,[l[38]||(l[38]=e.createElementVNode("th",null,[e.createTextVNode("期末/成果報告"),e.createElementVNode("br"),e.createTextVNode("繳交期限")],-1)),e.createElementVNode("td",null,[e.createElementVNode("div",Qu,[e.createElementVNode("div",Wu,[e.createVNode(a,{disabled:e.unref(p).FinalOneMonth,modelValue:e.unref(p).FinalDeadline,"onUpdate:modelValue":l[16]||(l[16]=u=>e.unref(p).FinalDeadline=u)},null,8,["disabled","modelValue"])]),l[36]||(l[36]=e.createElementVNode("span",{class:"p-2"},"或",-1)),e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:"final-one-month",type:"checkbox","onUpdate:modelValue":l[17]||(l[17]=u=>e.unref(p).FinalOneMonth=u)},null,512),[[e.vModelCheckbox,e.unref(p).FinalOneMonth]]),l[37]||(l[37]=e.createElementVNode("label",{class:"form-check-label",for:"final-one-month"},"計畫結束一個月後",-1))])])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:r,type:"button"},"儲存")])])}}},Xu={class:"block"},Ku={class:"mt-4"},Zu={class:"table-responsive"},vu={class:"table align-middle gray-table"},ex={class:"d-flex align-items-center gap-2"},tx=["id","onUpdate:modelValue"],lx=["for"],ox={__name:"GrantForm3",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref([]),s=_,f=()=>{const r=p.value.map(o=>({...o,MatchingFund:o.checked?o.MatchingFund:null}));F.system("saveGrantTargetSettings",{List:r}).subscribe(o=>{o&&s("next")})};return e.onMounted(()=>{F.system("getGrantTargetSettings",{ID:x.id}).subscribe(r=>{p.value=r.List,p.value.forEach(o=>{typeof o.MatchingFund=="number"&&(o.checked=!0)})})}),(r,o)=>{const l=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock("div",Xu,[e.createElementVNode("div",Ku,[e.createElementVNode("div",Zu,[e.createElementVNode("table",vu,[o[1]||(o[1]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th"),e.createElementVNode("th",null,"適用申請單位類別"),e.createElementVNode("th",null,"補助經費上限(萬)"),e.createElementVNode("th",null,"配合款")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(c,m)=>(e.openBlock(),e.createElementBlock("tr",{key:c},[e.createElementVNode("td",null,e.toDisplayString(m+1),1),e.createElementVNode("td",null,e.toDisplayString(c.TargetName),1),e.createElementVNode("td",null,[e.createVNode(l,{modelValue:c.GrantLimit,"onUpdate:modelValue":a=>c.GrantLimit=a},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",ex,[e.withDirectives(e.createElementVNode("input",{class:"form-check-input",id:`checkbox-${m}`,type:"checkbox","onUpdate:modelValue":a=>c.checked=a},null,8,tx),[[e.vModelCheckbox,c.checked]]),e.createElementVNode("label",{class:"form-check-label ms-1",for:`checkbox-${m}`},"配合款分攤比例",8,lx),c.checked?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createVNode(l,{class:"w-auto",modelValue:c.MatchingFund,"onUpdate:modelValue":a=>c.MatchingFund=a},null,8,["modelValue","onUpdate:modelValue"]),o[0]||(o[0]=e.createTextVNode("(%) ",-1))],64)):e.createCommentVNode("",!0)])])]))),128))])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:f,type:"button"},"儲存")])])}}},nx={class:"block"},rx={class:"mt-4"},ax={class:"table-responsive"},dx={class:"table align-middle gray-table side-table"},sx={class:"input-group",style:{width:"400px"}},cx={class:"teal-dark-tabs"},ix={key:0,class:"table-responsive sub-table"},mx={class:"table align-middle gray-table"},px={class:"d-flex gap-2"},Vx=["onClick"],fx={key:1},Nx={class:"d-flex gap-2"},Ex={__name:"GrantForm4",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref({}),s=e.ref(),f=e.ref([]),r=e.ref({}),o=e.ref(1),l=e.ref(""),c=()=>{const u=/^(.*?)\s*<([^>]+)>$/;l.value.split(`
`).forEach(g=>{const d=g.trim().match(u);d&&r.value[s.value].push({CommitteeUser:d[1],Email:d[2]})}),o.value=1,l.value=""},m=_,a=()=>{if(!y()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}F.system("saveReviewCommitteeList",{ID:s.value,List:r.value[s.value]}).subscribe(u=>{u&&m("next")})},y=()=>{const u={CommitteeUser:"姓名",Email:{presence:{message:"^請輸入 Email"},email:{message:"格式錯誤"}}};return p.value={},r.value[s.value].filter(g=>!g.Deleted).forEach((g,d)=>Object.assign(p.value,I(g,u,`item-${d}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{F.system("getReviewGroups",{ID:x.id}).subscribe(u=>{f.value=u.List,s.value=f.value[0].Value})}),e.watch(s,u=>{r.value[u]||F.system("getReviewCommitteeList",{ID:u}).subscribe(g=>{r.value[u]=g.List})}),(u,g)=>{var N;const d=e.resolveComponent("required-label"),n=e.resolveComponent("input-select"),k=e.resolveComponent("input-text"),i=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock("div",nx,[e.createElementVNode("div",rx,[e.createElementVNode("div",ax,[e.createElementVNode("table",dx,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(d,null,{default:e.withCtx(()=>[...g[5]||(g[5]=[e.createTextVNode("審查組別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",sx,[e.createVNode(n,{options:e.unref(f),"text-name":"Text","value-name":"Value",modelValue:e.unref(s),"onUpdate:modelValue":g[0]||(g[0]=V=>e.isRef(s)?s.value=V:null)},null,8,["options","modelValue"])])])]),e.createElementVNode("tr",null,[g[11]||(g[11]=e.createElementVNode("th",null,"審查委員名單",-1)),e.createElementVNode("td",null,[e.createElementVNode("ul",cx,[e.createElementVNode("li",{class:e.normalizeClass({active:e.unref(o)===1})},[e.createElementVNode("a",{class:"tab-link",onClick:g[1]||(g[1]=V=>o.value=1),href:"javascript:void(0)"},"逐筆輸入")],2),e.createElementVNode("li",{class:e.normalizeClass({active:e.unref(o)===2})},[e.createElementVNode("a",{class:"tab-link",onClick:g[2]||(g[2]=V=>o.value=2),href:"javascript:void(0)"},"批次輸入")],2)]),e.unref(o)===1?(e.openBlock(),e.createElementBlock("div",ix,[e.createElementVNode("table",mx,[g[7]||(g[7]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"1%"}),e.createElementVNode("th",null,"姓名"),e.createElementVNode("th",null,"Email"),e.createElementVNode("th",{width:"1%"})])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((N=e.unref(r)[e.unref(s)])==null?void 0:N.filter(V=>!V.Deleted),(V,E)=>(e.openBlock(),e.createElementBlock("tr",{key:V},[e.createElementVNode("td",null,e.toDisplayString(E+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`item-${E}-CommitteeUser`],modelValue:V.CommitteeUser,"onUpdate:modelValue":t=>V.CommitteeUser=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`item-${E}-Email`],modelValue:V.Email,"onUpdate:modelValue":t=>V.Email=t,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",px,[e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:t=>V.Deleted=!0,type:"button"},[...g[6]||(g[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Vx)])])]))),128))])]),e.createElementVNode("button",{class:"btn btn-sm btn-teal",onClick:g[3]||(g[3]=V=>{var E;return(E=e.unref(r)[e.unref(s)])==null?void 0:E.push({})}),type:"button"},[...g[8]||(g[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增",-1)])])])):e.createCommentVNode("",!0),e.unref(o)===2?(e.openBlock(),e.createElementBlock("div",fx,[e.createElementVNode("div",Nx,[e.createVNode(i,{placeholder:`張曉明 <aming@gmail.com>
陳小華 <hwahchen@xxx.edu.tw>`,rows:"5",modelValue:e.unref(l),"onUpdate:modelValue":g[4]||(g[4]=V=>e.isRef(l)?l.value=V:null),modelModifiers:{trim:!0}},null,8,["modelValue"]),e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:c,type:"button"},[...g[9]||(g[9]=[e.createElementVNode("i",{class:"fa-solid fa-plus"},null,-1),e.createTextVNode("新增",-1)])])]),g[10]||(g[10]=e.createElementVNode("label",{class:"form-text"},"輸入格式範例「姓名 <xxx@email.com>」，多筆請斷行輸入",-1))])):e.createCommentVNode("",!0)])])])])])]),e.createElementVNode("div",{class:"d-flex gap-3 flex-wrap justify-content-center mt-4"},[e.createElementVNode("button",{class:"btn btn-outline-teal",onClick:a,type:"button"},"儲存")])])}}},bx={class:"search-form"},gx={class:"row g-3"},kx={class:"col-3"},yx=["value"],ux={class:"block rounded-4 mt-4"},xx={class:"table-responsive",style:{"min-height":"400px"}},hx={"aria-label":"公告列表",class:"table teal-table"},$x={"data-th":"年度:"},Bx={"data-th":"補助類別全稱:",class:"text-start"},_x={"data-th":"簡稱:",class:"text-start"},Cx={"data-th":"代碼:",class:"text-start"},Tx={"data-th":"申請期間:",class:"text-start"},wx={"data-th":"管理:",class:"text-center"},Dx={class:"d-inline-flex gap-2"},Sx=["href"],Ax={__name:"GrantList",setup(B){const _=e.ref([]),x=e.ref(),p=e.ref([]),s=e.computed(()=>_.value.filter(f=>f.Year===x.value));return e.onMounted(()=>{F.system("getGrantTypeList").subscribe(f=>{_.value=f.List,p.value=[],_.value.forEach(r=>{p.value.includes(r.Year)||p.value.push(r.Year)}),x.value=p.value.length?p.value[0]:null})}),(f,r)=>{const o=e.resolveComponent("tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",bx,[e.createElementVNode("div",gx,[e.createElementVNode("div",kx,[r[1]||(r[1]=e.createElementVNode("div",{class:"fs-16 text-gray mb-2"},"年度",-1)),e.withDirectives(e.createElementVNode("select",{class:"form-select","onUpdate:modelValue":r[0]||(r[0]=l=>e.isRef(x)?x.value=l:null)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),l=>(e.openBlock(),e.createElementBlock("option",{key:l,value:l},e.toDisplayString(l)+"年",9,yx))),128))],512),[[e.vModelSelect,e.unref(x)]])])])]),e.createElementVNode("div",ux,[r[5]||(r[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="GrantEdit.aspx"><i class="fa-solid fa-plus"></i> 新增類別 </a></div>',1)),e.createElementVNode("div",xx,[e.createElementVNode("table",hx,[r[4]||(r[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col"},"年度"),e.createElementVNode("th",{scope:"col",class:"text-start"},"補助類別全稱"),e.createElementVNode("th",{scope:"col",class:"text-start"},"簡稱"),e.createElementVNode("th",{scope:"col"},"代碼"),e.createElementVNode("th",{scope:"col"},"申請期間"),e.createElementVNode("th",{scope:"col"},"管理")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),l=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",$x,e.toDisplayString(l.Year),1),e.createElementVNode("td",Bx,e.toDisplayString(l.FullName),1),e.createElementVNode("td",_x,e.toDisplayString(l.ShortName),1),e.createElementVNode("td",Cx,e.toDisplayString(l.TypeCode),1),e.createElementVNode("td",Tx,[e.createVNode(o,{"default-value":"未設定",value:l.ApplyStartDate},null,8,["value"]),r[2]||(r[2]=e.createTextVNode(" ~ ",-1)),e.createVNode(o,{"default-value":"未設定",value:l.ApplyEndDate},null,8,["value"])]),e.createElementVNode("td",wx,[e.createElementVNode("div",Dx,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`GrantEdit.aspx?ID=${l.TypeID}`},[...r[3]||(r[3]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,Sx)])])]))),128))])])])])],64)}}},Fx={class:"block rounded-4 mt-4"},Ux={class:"table-responsive",style:{"min-height":"400px"}},Mx={class:"table teal-table","aria-label":"公告列表"},Ix={"data-th":"公告期間:"},Px={key:1},jx={"data-th":"公告標題:",class:"text-start"},Ox={"data-th":"發布者:",class:"text-start"},Lx={"data-th":"功能:",class:"text-center"},qx={class:"d-inline-flex gap-2"},Rx=["href"],zx=["onClick"],Gx={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg"},Jx={class:"modal-content"},Yx={class:"modal-body"},Qx={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},Wx={__name:"NewsList",setup(B){let _;const x=e.ref([]),p=e.ref(),s=e.ref(1),f=e.ref(10),r=e.computed(()=>x.value.slice((s.value-1)*f.value,s.value*f.value)),o=(c,m)=>{s.value=parseInt(c),f.value=parseInt(m)},l=(c,m)=>{m||(_=c,bootstrap.Modal.getOrCreateInstance(p.value).show()),F.system("deleteNews",{ID:c.ID}).subscribe(a=>{a&&(x.value=x.value.filter(y=>y!==c),bootstrap.Modal.getOrCreateInstance(p.value).hide())})};return e.onMounted(()=>{F.system("getNewsList").subscribe(c=>x.value=c.List)}),(c,m)=>{const a=e.resolveComponent("tw-date"),y=e.resolveComponent("list-pager");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Fx,[m[5]||(m[5]=e.createStaticVNode('<div class="title border-teal"><div class="d-flex align-items-center gap-2"><h4 class="text-teal"><img src="../../assets/img/title-icon02-teal.svg" alt="logo"><span>列表</span></h4></div><a class="btn btn-teal-dark" href="NewsEdit.aspx"><i class="fa-solid fa-plus"></i> 新增公告 </a></div>',1)),e.createElementVNode("div",Ux,[e.createElementVNode("table",Mx,[m[4]||(m[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{scope:"col",style:{width:"220px"}},"公告期間"),e.createElementVNode("th",{class:"text-start",scope:"col"},"公告標題"),e.createElementVNode("th",{class:"text-start",scope:"col",style:{width:"200px"}},"發布者"),e.createElementVNode("th",{scope:"col",style:{width:"180px"}},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),u=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Ix,[e.createVNode(a,{value:u.EnableTime},null,8,["value"]),m[1]||(m[1]=e.createTextVNode(" ~ ",-1)),u.DisableTime?(e.openBlock(),e.createBlock(a,{key:0,value:u.DisableTime},null,8,["value"])):(e.openBlock(),e.createElementBlock("span",Px,"未設定"))]),e.createElementVNode("td",jx,e.toDisplayString(u.Title),1),e.createElementVNode("td",Ox,e.toDisplayString(u.UserOrg)+" "+e.toDisplayString(u.UserName),1),e.createElementVNode("td",Lx,[e.createElementVNode("div",qx,[e.createElementVNode("a",{class:"btn btn-sm btn-teal-dark",href:`NewsEdit.aspx?id=${u.ID}`},[...m[2]||(m[2]=[e.createElementVNode("i",{class:"fa-solid fa-pen"},null,-1)])],8,Rx),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark",onClick:g=>l(u),type:"button"},[...m[3]||(m[3]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,zx)])])]))),128))])])]),e.createVNode(y,{count:e.unref(x).length,onChange:o,page:e.unref(s),"page-size":e.unref(f)},null,8,["count","page","page-size"])]),e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:p,tabindex:"-1"},[e.createElementVNode("div",Gx,[e.createElementVNode("div",Jx,[m[7]||(m[7]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("h4",{class:"fs-24 fw-bold text-green-light"},"確定刪除公告資料？"),e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",Yx,[e.createElementVNode("div",Qx,[m[6]||(m[6]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:m[0]||(m[0]=u=>l(e.unref(_),!0)),type:"button"},"確認刪除")])])])])],512)],64)}}},Hx={class:"block rounded-top-4 mt-4 d-flex flex-column gap-5"},Xx={class:"table-responsive mt-3 mb-0"},Kx={class:"table align-middle gray-table side-table"},Zx={class:"d-flex align-items-center gap-2"},vx={class:"input-group w-auto"},eh={key:0,class:"invalid mt-0"},th={class:"d-flex mb-2 gap-3"},lh={class:"tag-group mt-3"},oh={key:0,class:"tag tag-green-light"},nh=["download","href"],rh=["onClick"],ah={class:"d-flex mb-2 gap-3"},dh={class:"image-preview mt-3"},sh={key:0,class:"image-preview__item"},ch=["src"],ih={class:"image-preview__item-overlay"},mh=["onClick"],ph={class:"d-flex mb-2 gap-3"},Vh={key:0,class:"table-responsive mt-3"},fh={class:"table align-middle gray-table"},Nh={class:"text-center"},Eh={class:"d-flex gap-1"},bh=["onClick"],oe={AccessibilityApplication:et,AccessibilityAttachment:xt,AccessibilityBenefit:It,AccessibilityFunding:il,AccessibilityPayment1:Al,AccessibilityPayment2:to,AccessibilityProgressBar:lo,AccessibilityWorkSchedule:wo,ConfirmModal:Mo,CommonProgressBar:Ro,CultureApplication:Cn,CultureAttachment:Hn,CultureFunding:xr,CultureOther:jr,CulturePayment1:da,CulturePayment2:Da,CultureProgress:Ha,CultureProgressBar:Xa,CultureWorkSchedule:zd,EducationApplication:Ms,EducationAttachment:oc,EducationPayment:Cc,EducationProgressBar:Tc,ErrorModal:Uc,HomeDashboard:Pi,InputBoolean:ji,InputFile:Oi,InputInteger:Ri,InputMonth:zi,InputRadioGroup:Yi,InputSelect:Ki,InputText:lm,InputTextarea:dm,InputTwDate:im,ListPager:Bm,LiteracyApplication:rp,LiteracyAttachment:Cp,LiteracyBenefit:qp,LiteracyFunding:NV,LiteracyPayment1:IV,LiteracyPayment2:af,LiteracyProgressBar:df,LiteracyWorkSchedule:Uf,MultipleApplication:fN,MultipleAttachment:IN,MultipleBenefit:XN,MultipleFunding:$1,MultiplePayment1:J1,MultiplePayment2:NE,MultiplePayment3:qE,MultipleProgressBar:RE,MultipleWorkSchedule:fb,NewsDetail:Cb,NewsList:Mb,ProjectChangeReview:qb,ProjectCorrectionReview:Qb,ProjectOrganizer:lg,ProjectProgress:pg,ProjectReport:wg,ProjectReportReview:Mg,ProjectReview:Rg,ProjectTitle:Yg,ProjectToolbar:ak,ReportApplyList:Yk,ReportApprovedList:ky,ReportInprogressList:Zy,ReportMixChart:vy,ReportPieChart:eu,RequiredLabel:lu,SystemGrantForm1:Cu,SystemGrantForm2:Hu,SystemGrantForm3:ox,SystemGrantForm4:Ex,SystemGrantList:Ax,SystemNewsList:Wx,SystemNewsForm:{__name:"NewsForm",props:{id:{type:[Number,String]}},emits:["next"],setup(B,{emit:_}){const x=B,p=e.ref({}),s=e.ref([]),f=e.computed(()=>l.value.filter(g=>!g.Deleted)),r=e.ref({}),o=e.ref([]),l=e.ref([]),c=(g,d)=>g.push({Path:d.Path,Name:d.Name}),m=F.download,a=_,y=()=>{if(!u()){e.nextTick(()=>{var d;return(d=document.querySelector(".invalid"))==null?void 0:d.scrollIntoView({behavior:"smooth",block:"center"})});return}const g={News:r.value,Files:s.value,Images:o.value,Videos:l.value};F.system("saveNews",g).subscribe(d=>{d&&a("next")})},u=()=>{let g={Title:"公告標題",EnableTime:"公告期間",Content:"內容"};return p.value=I(r.value,g),g={Title:"影片名稱",URL:"影片網址"},f.value.forEach((d,n)=>Object.assign(p.value,I(d,g,`video-${n}-`))),!Object.keys(p.value).length};return e.onMounted(()=>{x.id?F.system("getNews",{ID:x.id}).subscribe(g=>{r.value=g.News,s.value=g.Files,o.value=g.Images,l.value=g.Videos}):F.system("getEmptyNews").subscribe(g=>r.value=g)}),(g,d)=>{const n=e.resolveComponent("required-label"),k=e.resolveComponent("input-text"),i=e.resolveComponent("input-tw-date"),N=e.resolveComponent("input-textarea"),V=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Hx,[e.createElementVNode("div",null,[d[12]||(d[12]=e.createElementVNode("h5",{class:"square-title"},"公告內容",-1)),e.createElementVNode("div",Xx,[e.createElementVNode("table",Kx,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[d[7]||(d[7]=e.createElementVNode("th",null,"發佈者",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).UserOrg)+"    "+e.toDisplayString(e.unref(r).UserName),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(n,null,{default:e.withCtx(()=>[...d[8]||(d[8]=[e.createTextVNode("公告標題",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p).Title,modelValue:e.unref(r).Title,"onUpdate:modelValue":d[0]||(d[0]=E=>e.unref(r).Title=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(n,null,{default:e.withCtx(()=>[...d[9]||(d[9]=[e.createTextVNode("公告期間",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Zx,[e.createElementVNode("div",vx,[e.createVNode(i,{class:"w-auto",modelValue:e.unref(r).EnableTime,"onUpdate:modelValue":d[1]||(d[1]=E=>e.unref(r).EnableTime=E)},null,8,["modelValue"]),d[10]||(d[10]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(i,{class:"w-auto",modelValue:e.unref(r).DisableTime,"onUpdate:modelValue":d[2]||(d[2]=E=>e.unref(r).DisableTime=E)},null,8,["modelValue"])])]),e.unref(p).EnableTime?(e.openBlock(),e.createElementBlock("div",eh,e.toDisplayString(e.unref(p).EnableTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(n,null,{default:e.withCtx(()=>[...d[11]||(d[11]=[e.createTextVNode("內容",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(p).Content,modelValue:e.unref(r).Content,"onUpdate:modelValue":d[3]||(d[3]=E=>e.unref(r).Content=E),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])]),e.createElementVNode("div",null,[e.createElementVNode("div",th,[d[13]||(d[13]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關附件")],-1)),e.createVNode(V,{accept:".pdf,.odt,.doc,.docx,.zip",onFile:d[4]||(d[4]=E=>c(e.unref(s),E))})]),d[15]||(d[15]=e.createElementVNode("span",{class:"text-pink"},"支援文件 pdf, odt, doc, docx (10MB以內)、ZIP 壓縮檔 (50MB以內)",-1)),e.createElementVNode("div",lh,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),E=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:E},[E.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",oh,[e.createElementVNode("a",{class:"tag-link my-1",download:E.Name,href:e.unref(m)(E.Path)},e.toDisplayString(E.Name),9,nh),e.createElementVNode("button",{class:"tag-btn",onClick:t=>E.Deleted=!0,type:"button"},[...d[14]||(d[14]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,rh)]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",ah,[d[16]||(d[16]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關圖片")],-1)),e.createVNode(V,{accept:".jpg,.png",onFile:d[5]||(d[5]=E=>c(e.unref(o),E))})]),d[18]||(d[18]=e.createElementVNode("span",{class:"text-pink"},"支援 JPG, PNG，檔案大小 10MB以內",-1)),e.createElementVNode("div",dh,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),E=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:E},[E.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",sh,[e.createElementVNode("img",{alt:"picture",src:e.unref(m)(E.Path)},null,8,ch),e.createElementVNode("div",ih,[e.createElementVNode("button",{"aria-label":"移除圖片",class:"btn btn-remove-image",onClick:t=>E.Deleted=!0,type:"button"},[...d[17]||(d[17]=[e.createElementVNode("i",{class:"fa-solid fa-xmark"},null,-1)])],8,mh)])]))],64))),128))])]),e.createElementVNode("div",null,[e.createElementVNode("div",ph,[d[20]||(d[20]=e.createElementVNode("h5",{class:"square-title"},[e.createElementVNode("span",null,"相關影片")],-1)),e.createElementVNode("button",{"aria-label":"新增影片",class:"btn btn-teal-dark",onClick:d[6]||(d[6]=E=>e.unref(l).push({})),type:"button"},[...d[19]||(d[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode(" 新增 ",-1)])])]),e.unref(f).length?(e.openBlock(),e.createElementBlock("div",Vh,[e.createElementVNode("table",fh,[d[22]||(d[22]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{width:"80",class:"text-center"},"項次"),e.createElementVNode("th",null,"影片名稱"),e.createElementVNode("th",null,"影片網址"),e.createElementVNode("th",{width:"120"},"功能")])],-1)),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),(E,t)=>(e.openBlock(),e.createElementBlock("tr",{key:E},[e.createElementVNode("td",Nh,e.toDisplayString(t+1),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`video-${t}-Title`],modelValue:E.Title,"onUpdate:modelValue":b=>E.Title=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(p)[`video-${t}-URL`],modelValue:E.URL,"onUpdate:modelValue":b=>E.URL=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Eh,[e.createElementVNode("button",{"aria-label":"刪除影片",class:"btn btn-sm btn-teal-dark",onClick:b=>E.Deleted=!0,type:"button"},[...d[21]||(d[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bh)])])]))),128))])])])):e.createCommentVNode("",!0)])]),e.createElementVNode("div",{class:"block-bottom bg-light-teal"},[e.createElementVNode("button",{class:"btn btn-teal",onClick:y,type:"button"},[...d[23]||(d[23]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("確認送出",-1)])])])],64)}}},Tooltip:{__name:"Tooltip",setup(B){const _=e.ref();let x;return e.onMounted(()=>{x=new bootstrap.Tooltip(_.value)}),e.onUnmounted(()=>{x&&x.dispose()}),(p,s)=>(e.openBlock(),e.createElementBlock("button",{class:"btn-tooltip",ref_key:"element",ref:_,style:{color:"#027f72"},type:"button"},[...s[0]||(s[0]=[e.createElementVNode("i",{class:"fa-solid fa-circle-info"},null,-1)])],512))}},TwDate:{__name:"TwDate",props:{defaultValue:{default:"",type:String},value:{default:null,type:String}},setup(B){const _=B,x=s=>{const f=s==null?void 0:s.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return f?`${parseInt(f[1],10)-1911}/${f[2]}/${f[3]}`:""},p=e.ref(x(_.value));return e.watch(()=>_.value,s=>p.value=x(s)),(s,f)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(p)||B.defaultValue),1))}}};return{api:F,install:B=>{for(const _ in oe)B.component(_,oe[_])},useGrantStore:H,useProgressStore:j}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
