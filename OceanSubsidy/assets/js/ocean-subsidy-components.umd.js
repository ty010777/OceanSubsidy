(function(e,z){typeof exports=="object"&&typeof module<"u"?module.exports=z(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],z):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=z(e.Vue,e.Pinia))})(this,(function(e,z){"use strict";let X=Date.now();const P=(y,g,E)=>{if(g===1||g===3)return!0;if(g===10)switch(y){case"culture":if([2,3,5].includes(E))return!0;break;case"multiple":if([2,3,4,5].includes(E))return!0;break;case"accessibility":if([2,3,4,5].includes(E))return!0;break}return!1},v=()=>`id--${X++}`,F=y=>parseInt(y)||0,W=z.defineStore("message",{state:()=>({error:null})}),{ajax:ee}=rxjs.ajax,{map:te}=rxjs;let Y="";const le=(y,g={})=>R("Service/OFS/Accessibility.ashx",{method:y,param:g}),oe=(y,g={})=>R("Service/OFS/Culture.ashx",{method:y,param:g}),ne=y=>`${Y}/Service/OFS/Download.ashx?path=${y}`,re=(y,g={})=>R("Service/OFS/Education.ashx",{method:y,param:g}),ae=(y,g={})=>R("Service/OFS/Literacy.ashx",{method:y,param:g}),de=(y,g={})=>R("Service/OFS/Multiple.ashx",{method:y,param:g}),se=({response:y,status:g})=>{if(g===200){if(y.success)return y.data;W().error=y.message}},R=(y,g={})=>{const E={};g.constructor!==FormData&&(E["Content-Type"]="application/json");const u={body:g,headers:E,method:"POST",url:`${Y}/${y}`};return ee(u).pipe(te(se))},S=Object.assign(R,{accessibility:le,culture:oe,download:ne,education:re,literacy:ae,multiple:de,upload:y=>{const g=new FormData;return g.append("file",y),R("Service/OFS/Upload.ashx",g)}});function ie(y){return y&&y.__esModule&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y}var J={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var ce=J.exports,H;function me(){return H||(H=1,(function(y,g){(function(E,u,V){var d=function(l,r,a){a=o.extend({},o.options,a);var s=o.runValidations(l,r,a);if(s.some(function(p){return o.isPromise(p.error)}))throw new Error("Use validate.async if you want support for promises");return d.processValidationResults(s,a)},o=d;o.extend=function(l){return[].slice.call(arguments,1).forEach(function(r){for(var a in r)l[a]=r[a]}),l},o.extend(d,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var l=o.format("%{major}.%{minor}.%{patch}",o.version);return o.isEmpty(o.version.metadata)||(l+="+"+o.version.metadata),l}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(l,r,a){var s=[],p,i,b,h,n,N,m;(o.isDomElement(l)||o.isJqueryElement(l))&&(l=o.collectFormValues(l));for(p in r){b=o.getDeepObjectValue(l,p),h=o.result(r[p],b,l,p,a,r);for(i in h){if(n=o.validators[i],!n)throw m=o.format("Unknown validator %{name}",{name:i}),new Error(m);N=h[i],N=o.result(N,b,l,p,a,r),N&&s.push({attribute:p,value:b,validator:i,globalOptions:a,attributes:l,options:N,error:n.call(n,b,N,p,l,a)})}}return s},processValidationResults:function(l,r){l=o.pruneEmptyErrors(l,r),l=o.expandMultipleErrors(l,r),l=o.convertErrorMessages(l,r);var a=r.format||"grouped";if(typeof o.formatters[a]=="function")l=o.formatters[a](l);else throw new Error(o.format("Unknown format %{format}",r));return o.isEmpty(l)?void 0:l},async:function(l,r,a){a=o.extend({},o.async.options,a);var s=a.wrapErrors||function(i){return i};a.cleanAttributes!==!1&&(l=o.cleanAttributes(l,r));var p=o.runValidations(l,r,a);return new o.Promise(function(i,b){o.waitForResults(p).then(function(){var h=o.processValidationResults(p,a);h?b(new s(h,a,l,r)):i(l)},function(h){b(h)})})},single:function(l,r,a){return a=o.extend({},o.single.options,a,{format:"flat",fullMessages:!1}),o({single:l},{single:r},a)},waitForResults:function(l){return l.reduce(function(r,a){return o.isPromise(a.error)?r.then(function(){return a.error.then(function(s){a.error=s||null})}):r},new o.Promise(function(r){r()}))},result:function(l){var r=[].slice.call(arguments,1);return typeof l=="function"&&(l=l.apply(null,r)),l},isNumber:function(l){return typeof l=="number"&&!isNaN(l)},isFunction:function(l){return typeof l=="function"},isInteger:function(l){return o.isNumber(l)&&l%1===0},isBoolean:function(l){return typeof l=="boolean"},isObject:function(l){return l===Object(l)},isDate:function(l){return l instanceof Date},isDefined:function(l){return l!=null},isPromise:function(l){return!!l&&o.isFunction(l.then)},isJqueryElement:function(l){return l&&o.isString(l.jquery)},isDomElement:function(l){return!l||!l.querySelectorAll||!l.querySelector?!1:o.isObject(document)&&l===document?!0:typeof HTMLElement=="object"?l instanceof HTMLElement:l&&typeof l=="object"&&l!==null&&l.nodeType===1&&typeof l.nodeName=="string"},isEmpty:function(l){var r;if(!o.isDefined(l))return!0;if(o.isFunction(l))return!1;if(o.isString(l))return o.EMPTY_STRING_REGEXP.test(l);if(o.isArray(l))return l.length===0;if(o.isDate(l))return!1;if(o.isObject(l)){for(r in l)return!1;return!0}return!1},format:o.extend(function(l,r){return o.isString(l)?l.replace(o.format.FORMAT_REGEXP,function(a,s,p){return s==="%"?"%{"+p+"}":String(r[p])}):l},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(l){return o.isNumber(l)?l*100%1===0?""+l:parseFloat(Math.round(l*100)/100).toFixed(2):o.isArray(l)?l.map(function(r){return o.prettify(r)}).join(", "):o.isObject(l)?o.isDefined(l.toString)?l.toString():JSON.stringify(l):(l=""+l,l.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(r,a,s){return""+a+" "+s.toLowerCase()}).toLowerCase())},stringifyValue:function(l,r){var a=r&&r.prettify||o.prettify;return a(l)},isString:function(l){return typeof l=="string"},isArray:function(l){return{}.toString.call(l)==="[object Array]"},isHash:function(l){return o.isObject(l)&&!o.isArray(l)&&!o.isFunction(l)},contains:function(l,r){return o.isDefined(l)?o.isArray(l)?l.indexOf(r)!==-1:r in l:!1},unique:function(l){return o.isArray(l)?l.filter(function(r,a,s){return s.indexOf(r)==a}):l},forEachKeyInKeypath:function(l,r,a){if(o.isString(r)){var s="",p,i=!1;for(p=0;p<r.length;++p)switch(r[p]){case".":i?(i=!1,s+="."):(l=a(l,s,!1),s="");break;case"\\":i?(i=!1,s+="\\"):i=!0;break;default:i=!1,s+=r[p];break}return a(l,s,!0)}},getDeepObjectValue:function(l,r){if(o.isObject(l))return o.forEachKeyInKeypath(l,r,function(a,s){if(o.isObject(a))return a[s]})},collectFormValues:function(l,r){var a={},s,p,i,b,h,n;if(o.isJqueryElement(l)&&(l=l[0]),!l)return a;for(r=r||{},b=l.querySelectorAll("input[name], textarea[name]"),s=0;s<b.length;++s)if(i=b.item(s),!o.isDefined(i.getAttribute("data-ignored"))){var N=i.name.replace(/\./g,"\\\\.");n=o.sanitizeFormValue(i.value,r),i.type==="number"?n=n?+n:null:i.type==="checkbox"?i.attributes.value?i.checked||(n=a[N]||null):n=i.checked:i.type==="radio"&&(i.checked||(n=a[N]||null)),a[N]=n}for(b=l.querySelectorAll("select[name]"),s=0;s<b.length;++s)if(i=b.item(s),!o.isDefined(i.getAttribute("data-ignored"))){if(i.multiple){n=[];for(p in i.options)h=i.options[p],h&&h.selected&&n.push(o.sanitizeFormValue(h.value,r))}else{var m=typeof i.options[i.selectedIndex]<"u"?i.options[i.selectedIndex].value:"";n=o.sanitizeFormValue(m,r)}a[i.name]=n}return a},sanitizeFormValue:function(l,r){return r.trim&&o.isString(l)&&(l=l.trim()),r.nullify!==!1&&l===""?null:l},capitalize:function(l){return o.isString(l)?l[0].toUpperCase()+l.slice(1):l},pruneEmptyErrors:function(l){return l.filter(function(r){return!o.isEmpty(r.error)})},expandMultipleErrors:function(l){var r=[];return l.forEach(function(a){o.isArray(a.error)?a.error.forEach(function(s){r.push(o.extend({},a,{error:s}))}):r.push(a)}),r},convertErrorMessages:function(l,r){r=r||{};var a=[],s=r.prettify||o.prettify;return l.forEach(function(p){var i=o.result(p.error,p.value,p.attribute,p.options,p.attributes,p.globalOptions);if(!o.isString(i)){a.push(p);return}i[0]==="^"?i=i.slice(1):r.fullMessages!==!1&&(i=o.capitalize(s(p.attribute))+" "+i),i=i.replace(/\\\^/g,"^"),i=o.format(i,{value:o.stringifyValue(p.value,r)}),a.push(o.extend({},p,{error:i}))}),a},groupErrorsByAttribute:function(l){var r={};return l.forEach(function(a){var s=r[a.attribute];s?s.push(a):r[a.attribute]=[a]}),r},flattenErrorsToArray:function(l){return l.map(function(r){return r.error}).filter(function(r,a,s){return s.indexOf(r)===a})},cleanAttributes:function(l,r){function a(i,b,h){return o.isObject(i[b])?i[b]:i[b]=h?!0:{}}function s(i){var b={},h;for(h in i)i[h]&&o.forEachKeyInKeypath(b,h,a);return b}function p(i,b){if(!o.isObject(i))return i;var h=o.extend({},i),n,N;for(N in i)n=b[N],o.isObject(n)?h[N]=p(h[N],n):n||delete h[N];return h}return!o.isObject(r)||!o.isObject(l)?{}:(r=s(r),p(l,r))},exposeModule:function(l,r,a,s,p){a?(s&&s.exports&&(a=s.exports=l),a.validate=l):(r.validate=l,l.isFunction(p)&&p.amd&&p([],function(){return l}))},warn:function(l){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+l)},error:function(l){typeof console<"u"&&console.error&&console.error("[validate.js] "+l)}}),d.validators={presence:function(l,r){if(r=o.extend({},this.options,r),r.allowEmpty!==!1?!o.isDefined(l):o.isEmpty(l))return r.message||this.message||"can't be blank"},length:function(l,r,a){if(o.isDefined(l)){r=o.extend({},this.options,r);var s=r.is,p=r.maximum,i=r.minimum,b=r.tokenizer||function(m){return m},h,n=[];l=b(l);var N=l.length;if(!o.isNumber(N))return r.message||this.notValid||"has an incorrect length";if(o.isNumber(s)&&N!==s&&(h=r.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",n.push(o.format(h,{count:s}))),o.isNumber(i)&&N<i&&(h=r.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",n.push(o.format(h,{count:i}))),o.isNumber(p)&&N>p&&(h=r.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",n.push(o.format(h,{count:p}))),n.length>0)return r.message||n}},numericality:function(l,r,a,s,p){if(o.isDefined(l)){r=o.extend({},this.options,r);var i=[],b,h,n={greaterThan:function(f,D){return f>D},greaterThanOrEqualTo:function(f,D){return f>=D},equalTo:function(f,D){return f===D},lessThan:function(f,D){return f<D},lessThanOrEqualTo:function(f,D){return f<=D},divisibleBy:function(f,D){return f%D===0}},N=r.prettify||p&&p.prettify||o.prettify;if(o.isString(l)&&r.strict){var m="^-?(0|[1-9]\\d*)";if(r.onlyInteger||(m+="(\\.\\d+)?"),m+="$",!new RegExp(m).test(l))return r.message||r.notValid||this.notValid||this.message||"must be a valid number"}if(r.noStrings!==!0&&o.isString(l)&&!o.isEmpty(l)&&(l=+l),!o.isNumber(l))return r.message||r.notValid||this.notValid||this.message||"is not a number";if(r.onlyInteger&&!o.isInteger(l))return r.message||r.notInteger||this.notInteger||this.message||"must be an integer";for(b in n)if(h=r[b],o.isNumber(h)&&!n[b](l,h)){var t="not"+o.capitalize(b),c=r[t]||this[t]||this.message||"must be %{type} %{count}";i.push(o.format(c,{count:h,type:N(b)}))}if(r.odd&&l%2!==1&&i.push(r.notOdd||this.notOdd||this.message||"must be odd"),r.even&&l%2!==0&&i.push(r.notEven||this.notEven||this.message||"must be even"),i.length)return r.message||i}},datetime:o.extend(function(l,r){if(!o.isFunction(this.parse)||!o.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(o.isDefined(l)){r=o.extend({},this.options,r);var a,s=[],p=r.earliest?this.parse(r.earliest,r):NaN,i=r.latest?this.parse(r.latest,r):NaN;if(l=this.parse(l,r),isNaN(l)||r.dateOnly&&l%864e5!==0)return a=r.notValid||r.message||this.notValid||"must be a valid date",o.format(a,{value:arguments[0]});if(!isNaN(p)&&l<p&&(a=r.tooEarly||r.message||this.tooEarly||"must be no earlier than %{date}",a=o.format(a,{value:this.format(l,r),date:this.format(p,r)}),s.push(a)),!isNaN(i)&&l>i&&(a=r.tooLate||r.message||this.tooLate||"must be no later than %{date}",a=o.format(a,{date:this.format(i,r),value:this.format(l,r)}),s.push(a)),s.length)return o.unique(s)}},{parse:null,format:null}),date:function(l,r){return r=o.extend({},r,{dateOnly:!0}),o.validators.datetime.call(o.validators.datetime,l,r)},format:function(l,r){(o.isString(r)||r instanceof RegExp)&&(r={pattern:r}),r=o.extend({},this.options,r);var a=r.message||this.message||"is invalid",s=r.pattern,p;if(o.isDefined(l)&&(!o.isString(l)||(o.isString(s)&&(s=new RegExp(r.pattern,r.flags)),p=s.exec(l),!p||p[0].length!=l.length)))return a},inclusion:function(l,r){if(o.isDefined(l)&&(o.isArray(r)&&(r={within:r}),r=o.extend({},this.options,r),!o.contains(r.within,l))){var a=r.message||this.message||"^%{value} is not included in the list";return o.format(a,{value:l})}},exclusion:function(l,r){if(o.isDefined(l)&&(o.isArray(r)&&(r={within:r}),r=o.extend({},this.options,r),!!o.contains(r.within,l))){var a=r.message||this.message||"^%{value} is restricted";return o.isString(r.within[l])&&(l=r.within[l]),o.format(a,{value:l})}},email:o.extend(function(l,r){r=o.extend({},this.options,r);var a=r.message||this.message||"is not a valid email";if(o.isDefined(l)&&(!o.isString(l)||!this.PATTERN.exec(l)))return a},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(l,r,a,s,p){if(o.isDefined(l)){o.isString(r)&&(r={attribute:r}),r=o.extend({},this.options,r);var i=r.message||this.message||"is not equal to %{attribute}";if(o.isEmpty(r.attribute)||!o.isString(r.attribute))throw new Error("The attribute must be a non empty string");var b=o.getDeepObjectValue(s,r.attribute),h=r.comparator||function(N,m){return N===m},n=r.prettify||p&&p.prettify||o.prettify;if(!h(l,b,r,a,s))return o.format(i,{attribute:n(r.attribute)})}},url:function(l,r){if(o.isDefined(l)){r=o.extend({},this.options,r);var a=r.message||this.message||"is not a valid url",s=r.schemes||this.schemes||["http","https"],p=r.allowLocal||this.allowLocal||!1,i=r.allowDataUrl||this.allowDataUrl||!1;if(!o.isString(l))return a;var b="^(?:(?:"+s.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",h="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(p?h+="?":b+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",b+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+h+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",i){var n="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",N="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",m="data:(?:"+n+")?(?:;base64)?,"+N;b="(?:"+b+")|(?:^"+m+"$)"}var t=new RegExp(b,"i");if(!t.exec(l))return a}},type:o.extend(function(l,r,a,s,p){if(o.isString(r)&&(r={type:r}),!!o.isDefined(l)){var i=o.extend({},this.options,r),b=i.type;if(!o.isDefined(b))throw new Error("No type was specified");var h;if(o.isFunction(b)?h=b:h=this.types[b],!o.isFunction(h))throw new Error("validate.validators.type.types."+b+" must be a function.");if(!h(l,i,a,s,p)){var n=r.message||this.messages[b]||this.message||i.message||(o.isFunction(b)?"must be of the correct type":"must be of type %{type}");return o.isFunction(n)&&(n=n(l,r,a,s,p)),o.format(n,{attribute:o.prettify(a),type:b})}}},{types:{object:function(l){return o.isObject(l)&&!o.isArray(l)},array:o.isArray,integer:o.isInteger,number:o.isNumber,string:o.isString,date:o.isDate,boolean:o.isBoolean},messages:{}})},d.formatters={detailed:function(l){return l},flat:o.flattenErrorsToArray,grouped:function(l){var r;l=o.groupErrorsByAttribute(l);for(r in l)l[r]=o.flattenErrorsToArray(l[r]);return l},constraint:function(l){var r;l=o.groupErrorsByAttribute(l);for(r in l)l[r]=l[r].map(function(a){return a.validator}).sort();return l}},d.exposeModule(d,this,E,u,V)}).call(ce,g,y,null)})(J,J.exports)),J.exports}var Ve=me();const Z=ie(Ve),U=(y,g,E="")=>{const u={};Object.keys(g).forEach(o=>{const l=g[o];Z.isString(l)?u[o]={presence:{allowEmpty:!1,message:`^請輸入${l}`}}:u[o]=l});const V={},d=Z(y,u);return d&&Object.keys(d).forEach(o=>V[`${E}${o}`]=d[o].join(",")),V},I=z.defineStore("progress",{actions:{init(y,g){var E;this[y]={id:g.ProjectID,type:(E=g.SubsidyPlanType)==null?void 0:E.split(" ")[0],name:g.ProjectName,step:g.FormStep,status:g.Status,organizer:g.Organizer,organizerName:g.OrganizerName}}},state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})}),pe={class:"block"},fe={class:"mt-4"},Ne={class:"table align-middle gray-table side-table"},ue={key:0},Ee={key:1,class:"text-light-gray"},be={class:"d-flex flex-column gap-2"},ke={key:0},ge={class:"mt-4"},ye={class:"table align-middle gray-table side-table"},he={class:"row g-3"},$e={class:"col-12 col-xl-2"},xe={class:"text-gray mb-2"},Be={class:"col-12 col-xl-3"},Ce={class:"text-gray mb-2"},_e={class:"col-12 col-xl-4"},Te={class:"row g-1"},we={class:"col-7"},De={class:"col-5"},Se={class:"col-12 col-xl-3"},Ue={class:"text-gray mb-2"},Ae={class:"col-12"},Oe={class:"text-gray mb-2"},Me={class:"mt-4"},Ie={class:"table align-middle gray-table side-table"},Fe={class:"mt-4"},je={class:"table align-middle gray-table side-table"},Pe={key:0,class:"table-responsive mt-3 mb-0"},qe={class:"table align-middle gray-table"},Le={key:0},Re={key:0},ze={class:"d-flex gap-2"},Je=["onClick"],Ge={key:0,class:"block-bottom bg-light-teal"},Qe={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.ref(),V=e.computed(()=>P("accessibility",l.value.Status,1)),d=e.ref({}),o=e.computed(()=>r.value.filter(h=>!h.Deleted)),l=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!o.value.length,set:h=>{h?s():r.value.forEach(n=>n.Deleted=!0)}}),s=()=>r.value.push({}),p=h=>h.Deleted=!0,i=h=>{if(d.value={},h&&!b()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Contacts:u.value,ReceivedSubsidies:r.value.filter(N=>N.ID||!N.Deleted),Submit:h?"true":"false"};S.accessibility("saveApplication",n).subscribe(N=>{h?window.location.href=`WorkSchedule.aspx?ID=${N.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${N.ID}`})},b=()=>{let h={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return l.value.OrgCategory==="2"&&(h.RegisteredNum="立案登記證字號"),d.value=U(l.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((n,N)=>Object.assign(d.value,U(n,h,`contact-${N}-`))),h={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},r.value.forEach((n,N)=>Object.assign(d.value,U(n,h,`received-${N}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(h=>{E.value=h[0],g.id?S.accessibility("getApplication",{ID:g.id}).subscribe(n=>{l.value=n.Project,u.value=n.Contacts,r.value=n.ReceivedSubsidies,l.value.OrgCategory=l.value.OrgCategory||null,I().init("accessibility",l.value)}):S.accessibility("getEmptyApplication").subscribe(n=>{l.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},n),u.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("accessibility",l.value)})})}),e.provide("editable",V),(h,n)=>{const N=e.resolveComponent("required-label"),m=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),c=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),D=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",pe,[n[37]||(n[37]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",fe,[e.createElementVNode("table",Ne,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[13]||(n[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[n[14]||(n[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",ue,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Ee,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[n[15]||(n[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[16]||(n[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).ProjectName,modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":n[0]||(n[0]=_=>e.unref(l).ProjectName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[17]||(n[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":n[1]||(n[1]=_=>e.unref(l).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[18]||(n[18]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",be,[e.createElementVNode("div",null,[e.createVNode(t,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).OrgCategory,"onUpdate:modelValue":n[2]||(n[2]=_=>e.unref(l).OrgCategory=_)},null,8,["error","options","modelValue"])]),e.unref(l).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",ke,[e.createVNode(m,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(l).RegisteredNum,"onUpdate:modelValue":n[3]||(n[3]=_=>e.unref(l).RegisteredNum=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[19]||(n[19]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(l).TaxID,"onUpdate:modelValue":n[4]||(n[4]=_=>e.unref(l).TaxID=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[20]||(n[20]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":n[5]||(n[5]=_=>e.unref(l).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),n[38]||(n[38]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ge,[e.createElementVNode("table",ye,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",he,[e.createElementVNode("div",$e,[e.createElementVNode("div",xe,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[21]||(n[21]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Be,[e.createElementVNode("div",Ce,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[22]||(n[22]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":x=>_.JobTitle=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",_e,[n[23]||(n[23]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Te,[e.createElementVNode("div",we,[e.createVNode(m,{modelValue:_.Phone,"onUpdate:modelValue":x=>_.Phone=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",De,[e.createVNode(m,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":x=>_.PhoneExt=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Se,[e.createElementVNode("div",Ue,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[24]||(n[24]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":x=>_.MobilePhone=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ae,[e.createElementVNode("div",Oe,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[25]||(n[25]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(d)[`contact-${T}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":x=>_.EMail=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),n[39]||(n[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Me,[e.createElementVNode("table",Ie,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[26]||(n[26]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[n[27]||(n[27]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(c,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(l).Target,"onUpdate:modelValue":n[6]||(n[6]=_=>e.unref(l).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[28]||(n[28]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":n[7]||(n[7]=_=>e.unref(l).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[29]||(n[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":n[8]||(n[8]=_=>e.unref(l).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[30]||(n[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Qualitative,"onUpdate:modelValue":n[9]||(n[9]=_=>e.unref(l).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Fe,[e.createElementVNode("table",je,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[36]||(n[36]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(a),"onUpdate:modelValue":n[10]||(n[10]=_=>e.isRef(a)?a.value=_:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Pe,[e.createElementVNode("table",qe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[31]||(n[31]=e.createElementVNode("th",null,"計畫名稱",-1)),n[32]||(n[32]=e.createElementVNode("th",null,"補助單位",-1)),n[33]||(n[33]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Le,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d)[`received-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(d)[`received-${T}-Unit`],modelValue:_.Unit,"onUpdate:modelValue":x=>_.Unit=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d)[`received-${T}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":x=>_.Amount=x},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Re,[e.createElementVNode("div",ze,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:x=>p(_),type:"button"},[...n[34]||(n[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Je)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...n[35]||(n[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Ge,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[11]||(n[11]=_=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[12]||(n[12]=_=>i(!0)),type:"button"},[...n[40]||(n[40]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},We={class:"block"},Ye={key:0,class:"text-pink lh-base mt-4"},He={class:"mt-4"},Ze={class:"table align-middle gray-table"},Ke={class:"text-center"},Xe={key:0,width:"180"},ve={class:"text-center"},et={key:0},tt=["innerHTML"],lt={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},ot={key:0,class:"text-center"},nt={key:0},rt={key:1,class:"text-pink"},at={key:1,class:"tag-group mt-2 gap-1"},dt={key:0,class:"tag tag-green-light"},st=["download","href"],it=["onClick"],ct={key:0,class:"block-bottom bg-light-teal"},mt=["disabled"],Vt={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),u=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("accessibility",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=S.download,r=a=>{const s={ID:g.id,Attachments:E.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};S.accessibility("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,E.value=E.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),E.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),I().init("accessibility",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",We,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",Ye,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",He,[e.createElementVNode("table",Ze,[e.createElementVNode("thead",Ke,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Xe,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",ve,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",et,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,tt)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",lt,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",ot,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",nt,"已上傳")):(e.openBlock(),e.createElementBlock("span",rt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:n=>o(b,n)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",at,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",dt,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(l)(n.Path)},e.toDisplayString(n.Name),9,st),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>n.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,it)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ct,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,mt)])):e.createCommentVNode("",!0)],64)}}},pt={class:"block"},ft={class:"mt-4"},Nt={class:"table-responsive mt-3 mb-0"},ut={class:"table align-middle gray-table"},Et={key:0,width:"1"},bt={key:0},kt={class:"d-flex gap-2"},gt=["onClick"],yt={class:"table-responsive mt-3 mb-0"},ht={class:"table align-middle gray-table"},$t={key:0,class:"block-bottom bg-light-teal"},xt={__name:"Benefit",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.computed(()=>P("accessibility",o.value.Status,4)),V=e.ref({}),d=e.computed(()=>E.value.filter(p=>!p.Deleted)),o=e.ref({}),l=()=>E.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:o.value,Benefits:E.value,Submit:p?"true":"false"};S.accessibility("saveBenefit",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((i,b)=>Object.assign(V.value,U(i,p,`item-${b}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getBenefit",{ID:g.id})]).subscribe(p=>{const i=p[0];o.value=i.Project,E.value=i.Benefits,E.value.length||l(),I().init("accessibility",o.value)})}),e.provide("editable",u),(p,i)=>{const b=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",pt,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",ft,[e.createElementVNode("div",Nt,[e.createElementVNode("table",ut,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[3]||(i[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),i[4]||(i[4]=e.createElementVNode("th",null,"目標值",-1)),i[5]||(i[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Et,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(n,N)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Title`],modelValue:n.Title,"onUpdate:modelValue":m=>n.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Target`],modelValue:n.Target,"onUpdate:modelValue":m=>n.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:n.Description,"onUpdate:modelValue":m=>n.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",bt,[e.createElementVNode("div",kt,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>r(n),type:"button"},[...i[6]||(i[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,gt)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...i[7]||(i[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",yt,[e.createElementVNode("table",ht,[i[8]||(i[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":i[0]||(i[0]=n=>e.unref(o).Benefit=n),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",$t,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[1]||(i[1]=n=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[2]||(i[2]=n=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Bt={class:"block"},Ct={class:"mt-4"},_t={class:"table-responsive mt-3 mb-0"},Tt={class:"table align-middle gray-table"},wt={class:"text-end"},Dt={class:"text-end"},St={class:"table-responsive"},Ut={class:"table align-middle gray-table"},At=["colspan"],Ot={key:0,width:"1"},Mt={class:"text-end"},It={key:0},Ft={class:"d-flex gap-2"},jt=["onClick"],Pt={class:"mt-4"},qt={class:"table-responsive mt-3 mb-0"},Lt={class:"table align-middle gray-table"},Rt={key:0,width:"1"},zt={class:"text-end"},Jt={key:0},Gt={class:"d-flex gap-2"},Qt=["onClick"],Wt={key:0,class:"block-bottom bg-light-teal"},Yt={class:"text-center"},Ht={class:"mb-5"},Zt={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,E=e.computed(()=>P("accessibility",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>r.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),o=e.ref({}),l=e.ref(),r=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),i=()=>r.value.push({}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,n=(m,t)=>{if(u.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>n(m,!0));return}const c={Project:o.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:m?"true":"false"};S.accessibility("saveFunding",c).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},r.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`other-${c}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`plan-${c}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getFunding",{ID:g.id})]).subscribe(m=>{const t=m[0];o.value=t.Project,r.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,r.value.length||i(),a.value.length||b(),I().init("accessibility",o.value)})}),e.provide("editable",E),e.watchEffect(()=>{o.value.OtherAmount=V.value.reduce((m,t)=>m+F(t.Amount),0),p.value=F(o.value.ApplyAmount)+F(o.value.SelfAmount)+F(o.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(F(m.Amount)/o.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=F(m.Amount)+F(m.OtherAmount))}),(m,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),D=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Bt,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Ct,[e.createElementVNode("div",_t,[e.createElementVNode("table",Tt,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(o).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(o).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",wt,e.toDisplayString((T=e.unref(o).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",Dt,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",St,[e.createElementVNode("table",Ut,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,At)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Ot,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":k=>x.Unit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Mt,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":k=>x.Content=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",It,[e.createElementVNode("div",Ft,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jt)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Pt,[e.createElementVNode("div",qt,[e.createElementVNode("table",Lt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Rt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":k=>x.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":k=>x.OtherAmount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",zt,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":k=>x.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Jt,[e.createElementVNode("div",Gt,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Qt)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Wt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>n(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",Yt,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Ht,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Kt={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"accessibility"})}}},Xt={class:"block"},vt={class:"mt-4"},el={class:"table align-middle gray-table side-table"},tl={key:0,class:"d-flex align-items-center gap-2"},ll={class:"input-group w-auto"},ol={class:"text-teal-dark"},nl={key:1,class:"invalid mt-0"},rl={class:"table-responsive mt-4"},al={class:"table align-middle gray-table"},dl={key:0},sl={class:"input-group"},il={key:0,class:"invalid mt-0"},cl={key:0},ml={class:"d-flex gap-2"},Vl=["onClick"],pl={class:"mt-4"},fl={class:"table align-middle gray-table"},Nl={key:0},ul={key:0},El={class:"d-flex gap-2"},bl=["onClick"],kl={key:0,class:"block-bottom bg-light-teal"},gl={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,E=[{value:1,text:"50%"},{value:2,text:"100%"}],u=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("accessibility",r.value.Status,2)),d=e.ref({}),o=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),r=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),i=()=>S.accessibility("createItem",{ID:g.id}).subscribe(m=>s.value.push(m)),b=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,n=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};S.accessibility("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(r.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`item-${c}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`schedule-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.accessibility("getWorkSchedule",{ID:g.id})]).subscribe(m=>{const t=m[0];r.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||i(),p.value.length||b(),I().init("accessibility",r.value)})}),e.provide("editable",V),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),D=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Xt,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",vt,[e.createElementVNode("table",el,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",tl,[e.createElementVNode("div",ll,[e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":t[0]||(t[0]=k=>e.unref(r).StartTime=k)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":t[1]||(t[1]=k=>e.unref(r).EndTime=k)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",ol,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(D,{value:e.unref(u)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",nl,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",rl,[e.createElementVNode("table",al,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",dl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:k.Title,"onUpdate:modelValue":C=>k.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",sl,[e.createVNode(T,{"empty-value":0,modelValue:k.Begin,"onUpdate:modelValue":C=>k.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:k.End,"onUpdate:modelValue":C=>k.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",il,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",cl,[e.createElementVNode("div",ml,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Vl)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",pl,[e.createElementVNode("table",fl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Nl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:E,modelValue:k.Type,"onUpdate:modelValue":C=>k.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:k.ItemID,"onUpdate:modelValue":C=>k.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(k.ItemID?String.fromCharCode(65+e.unref(o).findIndex(C=>C.ID===k.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",ul,[e.createElementVNode("div",El,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bl)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",kl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=k=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=k=>n(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},yl={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},hl={class:"modal-content"},$l={class:"modal-body"},xl={class:"d-flex justify-content-center mt-4 gap-4"},Bl={class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},Cl={__name:"ConfirmModal",props:{cancel:{default:"取消",type:String},confirm:{default:"確定",type:String}},setup(y,{expose:g}){let E;const u=e.ref(),V=y,d=()=>{E&&E()};return g({show:l=>{E=l,bootstrap.Modal.getOrCreateInstance(u.value).show()}}),(l,r)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:u,tabindex:"-1"},[e.createElementVNode("div",yl,[e.createElementVNode("div",hl,[r[0]||(r[0]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",$l,[e.renderSlot(l.$slots,"default"),e.createElementVNode("div",xl,[e.createElementVNode("button",Bl,e.toDisplayString(V.cancel),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:d,"data-bs-dismiss":"modal",type:"button"},e.toDisplayString(V.confirm),1)])])])])],512)]))}},_l={class:"application-step"},Tl=["onClick"],wl={class:"step-content"},Dl={class:"step-label"},Sl={key:0,class:"step-status edit"},Ul={key:1,class:"step-status"},Al={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(y,{emit:g}){const E=e.computed(()=>P(V.type,u[V.type].status,V.step)),u=I(),V=y,d=l=>{V.review?o("click",l.step):l.step<=u[V.type].step&&(location.href=`${l.url}.aspx?ID=${V.id}`)},o=g;return(l,r)=>(e.openBlock(),e.createElementBlock("div",_l,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.steps,a=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(E)&&(a.step<e.unref(u)[y.type].step||a.step===y.step)}]),onClick:s=>d(a),key:a,role:"button"},[e.createElementVNode("div",wl,[e.createElementVNode("div",Dl,e.toDisplayString(a.title),1),e.unref(E)&&a.step===y.step?(e.openBlock(),e.createElementBlock("div",Sl,"編輯中")):a.step<e.unref(u)[y.type].step?(e.openBlock(),e.createElementBlock("div",Ul,"已完成")):e.createCommentVNode("",!0)])],10,Tl))),128))]))}},Ol={class:"block"},Ml={class:"mt-4"},Il={class:"table align-middle gray-table side-table"},Fl={key:0},jl={key:1,class:"text-light-gray"},Pl={class:"d-flex gap-2"},ql={key:0,class:"invalid mt-0"},Ll={class:"d-flex flex-column gap-2"},Rl={key:0},zl={class:"mt-4"},Jl={class:"table align-middle gray-table side-table"},Gl={class:"row g-3"},Ql={class:"col-12 col-xl-2"},Wl={class:"text-gray mb-2"},Yl={class:"col-12 col-xl-3"},Hl={class:"text-gray mb-2"},Zl={class:"col-12 col-xl-4"},Kl={class:"row g-1"},Xl={class:"col-7"},vl={class:"col-5"},eo={class:"col-12 col-xl-3"},to={class:"text-gray mb-2"},lo={class:"col-12"},oo={class:"text-gray mb-2"},no={class:"mt-4"},ro={class:"table align-middle gray-table side-table"},ao={class:"mt-4"},so={class:"table align-middle gray-table side-table"},io={key:0,class:"table-responsive mt-3 mb-0"},co={class:"table align-middle gray-table"},mo={key:0},Vo={key:0},po={class:"d-flex gap-2"},fo=["onClick"],No={key:0,class:"block-bottom bg-light-teal"},uo={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.ref(),V=e.computed(()=>P("culture",a.value.Status,1)),d=e.ref({}),o=e.ref(null),l=e.ref([]),r=e.computed(()=>p.value.filter(t=>!t.Deleted)),a=e.ref({}),s=e.computed(()=>l.value.filter(t=>!t.ParentCode)),p=e.ref([]),i=e.computed(()=>l.value.filter(t=>t.ParentCode===o.value)),b=e.computed({get:()=>!!r.value.length,set:t=>{t?h():p.value.forEach(c=>c.Deleted=!0)}}),h=()=>p.value.push({}),n=t=>t.Deleted=!0,N=t=>{if(d.value={},t&&!m()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}const c={Project:a.value,Contacts:u.value,ReceivedSubsidies:p.value.filter(f=>f.ID||!f.Deleted),Submit:t?"true":"false"};S.culture("saveApplication",c).subscribe(f=>{t?window.location.href=`WorkSchedule.aspx?ID=${f.ID}`:a.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${f.ID}`})},m=()=>{let t={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value.OrgCategory==="3"&&(t.RegisteredNum="立案登記證字號"),d.value=U(a.value,t),t={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((c,f)=>Object.assign(d.value,U(c,t,`contact-${f}-`))),t={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},p.value.forEach((c,f)=>Object.assign(d.value,U(c,t,`received-${f}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getZgsCodes",{CodeGroup:"CULField"}),S.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(t=>{l.value=t[0],E.value=t[1],g.id?S.culture("getApplication",{ID:g.id}).subscribe(c=>{var f;a.value=c.Project,u.value=c.Contacts,p.value=c.ReceivedSubsidies,o.value=((f=l.value.find(D=>D.Code===a.value.Field))==null?void 0:f.ParentCode)||null,a.value.OrgCategory=a.value.OrgCategory||null,I().init("culture",a.value)}):S.culture("getEmptyApplication").subscribe(c=>{o.value=null,a.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},c),u.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("culture",a.value)})})}),e.provide("editable",V),e.watch(o,()=>{o.value?i.value.find(t=>a.value.Field===t.Code)||(a.value.Field=i.value[0].Code):a.value.Field=null}),(t,c)=>{const f=e.resolveComponent("required-label"),D=e.resolveComponent("input-text"),_=e.resolveComponent("input-select"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-boolean"),w=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ol,[c[40]||(c[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Ml,[e.createElementVNode("table",Il,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[c[15]||(c[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).Year),1)]),e.createElementVNode("tr",null,[c[16]||(c[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(a).ProjectID?(e.openBlock(),e.createElementBlock("span",Fl,e.toDisplayString(e.unref(a).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",jl,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[c[17]||(c[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[18]||(c[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d).ProjectName,modelValue:e.unref(a).ProjectName,"onUpdate:modelValue":c[0]||(c[0]=k=>e.unref(a).ProjectName=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[19]||(c[19]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Pl,[e.createVNode(_,{"empty-value":null,options:e.unref(s),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o),"onUpdate:modelValue":c[1]||(c[1]=k=>e.isRef(o)?o.value=k:null)},null,8,["options","modelValue"]),e.createVNode(_,{"empty-value":null,disabled:!e.unref(o),options:e.unref(i),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).Field,"onUpdate:modelValue":c[2]||(c[2]=k=>e.unref(a).Field=k)},null,8,["disabled","options","modelValue"])]),e.unref(d).Field?(e.openBlock(),e.createElementBlock("div",ql,e.toDisplayString(e.unref(d).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[20]||(c[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(a).OrgName,"onUpdate:modelValue":c[3]||(c[3]=k=>e.unref(a).OrgName=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[21]||(c[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ll,[e.createElementVNode("div",null,[e.createVNode(_,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).OrgCategory,"onUpdate:modelValue":c[4]||(c[4]=k=>e.unref(a).OrgCategory=k)},null,8,["error","options","modelValue"])]),e.unref(a).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",Rl,[e.createVNode(D,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(a).RegisteredNum,"onUpdate:modelValue":c[5]||(c[5]=k=>e.unref(a).RegisteredNum=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[22]||(c[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(a).TaxID,"onUpdate:modelValue":c[6]||(c[6]=k=>e.unref(a).TaxID=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[23]||(c[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(a).Address,"onUpdate:modelValue":c[7]||(c[7]=k=>e.unref(a).Address=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),c[41]||(c[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",zl,[e.createElementVNode("table",Jl,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(k.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Gl,[e.createElementVNode("div",Ql,[e.createElementVNode("div",Wl,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[24]||(c[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(D,{error:e.unref(d)[`contact-${B}-Name`],modelValue:k.Name,"onUpdate:modelValue":C=>k.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Yl,[e.createElementVNode("div",Hl,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[25]||(c[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(D,{error:e.unref(d)[`contact-${B}-JobTitle`],modelValue:k.JobTitle,"onUpdate:modelValue":C=>k.JobTitle=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Zl,[c[26]||(c[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Kl,[e.createElementVNode("div",Xl,[e.createVNode(D,{modelValue:k.Phone,"onUpdate:modelValue":C=>k.Phone=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",vl,[e.createVNode(D,{placeholder:"請輸入分機",size:"4",modelValue:k.PhoneExt,"onUpdate:modelValue":C=>k.PhoneExt=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",eo,[e.createElementVNode("div",to,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[27]||(c[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(D,{error:e.unref(d)[`contact-${B}-MobilePhone`],modelValue:k.MobilePhone,"onUpdate:modelValue":C=>k.MobilePhone=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",lo,[e.createElementVNode("div",oo,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[28]||(c[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(D,{error:e.unref(d)[`contact-${B}-EMail`],modelValue:k.EMail,"onUpdate:modelValue":C=>k.EMail=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),c[42]||(c[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",no,[e.createElementVNode("table",ro,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[29]||(c[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[c[30]||(c[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(T,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(a).Target,"onUpdate:modelValue":c[8]||(c[8]=k=>e.unref(a).Target=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[31]||(c[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(a).Summary,"onUpdate:modelValue":c[9]||(c[9]=k=>e.unref(a).Summary=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[32]||(c[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Quantified,"onUpdate:modelValue":c[10]||(c[10]=k=>e.unref(a).Quantified=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(f,null,{default:e.withCtx(()=>[...c[33]||(c[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Qualitative,"onUpdate:modelValue":c[11]||(c[11]=k=>e.unref(a).Qualitative=k),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",ao,[e.createElementVNode("table",so,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[c[39]||(c[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(x,{modelValue:e.unref(b),"onUpdate:modelValue":c[12]||(c[12]=k=>e.isRef(b)?b.value=k:null)},null,8,["modelValue"]),e.unref(b)?(e.openBlock(),e.createElementBlock("div",io,[e.createElementVNode("table",co,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[c[34]||(c[34]=e.createElementVNode("th",null,"計畫名稱",-1)),c[35]||(c[35]=e.createElementVNode("th",null,"補助單位",-1)),c[36]||(c[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",mo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d)[`received-${B}-Name`],modelValue:k.Name,"onUpdate:modelValue":C=>k.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(d)[`received-${B}-Unit`],modelValue:k.Unit,"onUpdate:modelValue":C=>k.Unit=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{error:e.unref(d)[`received-${B}-Amount`],modelValue:k.Amount,"onUpdate:modelValue":C=>k.Amount=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Vo,[e.createElementVNode("div",po,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>n(k),type:"button"},[...c[37]||(c[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,fo)):e.createCommentVNode("",!0),B+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...c[38]||(c[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",No,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:c[13]||(c[13]=k=>N()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:c[14]||(c[14]=k=>N(!0)),type:"button"},[...c[43]||(c[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Eo={class:"block"},bo={key:0,class:"text-pink lh-base mt-4"},ko={class:"mt-4"},go={class:"table align-middle gray-table"},yo={class:"text-center"},ho={key:0,width:"180"},$o={class:"text-center"},xo={key:0},Bo=["innerHTML"],Co={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},_o={key:0,class:"text-center"},To={key:0},wo={key:1,class:"text-pink"},Do={key:1,class:"tag-group mt-2 gap-1"},So={key:0,class:"tag tag-green-light"},Uo=["download","href"],Ao=["onClick"],Oo={key:0,class:"block-bottom bg-light-teal"},Mo=["disabled"],Io={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:!0,Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),u=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("culture",d.value.Status,5)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=S.download,r=a=>{const s={ID:g.id,Attachments:E.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};S.culture("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,E.value=E.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),d.value.Status>=10&&E.value.push({Type:6,Title:"著作權授權同意書",Template:!0,Files:[]}),E.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),I().init("culture",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Eo,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",bo,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ko,[e.createElementVNode("table",go,[e.createElementVNode("thead",yo,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ho,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",$o,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",xo,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Bo)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",Co,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",_o,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",To,"已上傳")):(e.openBlock(),e.createElementBlock("span",wo,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:n=>o(b,n)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",Do,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",So,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(l)(n.Path)},e.toDisplayString(n.Name),9,Uo),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>n.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Ao)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Oo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Mo)])):e.createCommentVNode("",!0)],64)}}},Fo={class:"block"},jo={class:"mt-4"},Po={class:"table-responsive mt-3 mb-0"},qo={class:"table align-middle gray-table"},Lo={class:"text-end"},Ro={class:"text-end"},zo={class:"table-responsive"},Jo={class:"table align-middle gray-table"},Go=["colspan"],Qo={key:0,width:"1"},Wo={key:0},Yo={class:"d-flex gap-2"},Ho=["onClick"],Zo={class:"mt-4"},Ko={class:"table-responsive mt-3 mb-0"},Xo={class:"table align-middle gray-table"},vo={key:0,width:"1"},en={class:"text-end"},tn={key:0},ln={class:"d-flex gap-2"},on=["onClick"],nn={key:0,class:"block-bottom bg-light-teal"},rn={class:"text-center"},an={class:"mb-5"},dn={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,E=e.computed(()=>P("culture",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>a.value.filter(c=>!c.Deleted)),d=e.computed(()=>s.value.filter(c=>!c.Deleted)),o=e.ref({}),l=e.ref([]),r=e.ref(),a=e.ref([]),s=e.ref([]),p=e.ref({}),i=e.ref(0),b=()=>a.value.push({}),h=()=>s.value.push({ItemID:0}),n=c=>c.Deleted=!0,N=c=>c.Deleted=!0,m=(c,f)=>{if(u.value={},c&&!t()){e.nextTick(()=>{var _;return(_=document.querySelector(".invalid"))==null?void 0:_.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!f&&o.value.ApplyAmount>p.value.GrantLimit*1e4){r.value.show(()=>m(c,!0));return}const D={Project:o.value,OtherSubsidies:a.value,BudgetPlans:s.value,Submit:c?"true":"false"};S.culture("saveFunding",D).subscribe(()=>{c?window.location.href=`Other.aspx?ID=${g.id}`:window.location.reload()})},t=()=>{let c={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,c),c={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},a.value.forEach((f,D)=>Object.assign(u.value,U(f,c,`other-${D}-`))),c={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},s.value.forEach((f,D)=>Object.assign(u.value,U(f,c,`plan-${D}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getFunding",{ID:g.id})]).subscribe(c=>{const f=c[0];o.value=f.Project,a.value=f.OtherSubsidies,s.value=f.BudgetPlans,l.value=f.Items,p.value=f.GrantTargetSetting,a.value.length||b(),s.value.length||h(),I().init("culture",o.value)})}),e.provide("editable",E),e.watchEffect(()=>{o.value.OtherAmount=a.value.reduce((c,f)=>c+(f.Deleted?0:F(f.Amount)),0),i.value=F(o.value.ApplyAmount)+F(o.value.SelfAmount)+F(o.value.OtherAmount),s.value.forEach(c=>c.sum=F(c.Amount)+F(c.OtherAmount))}),(c,f)=>{var k;const D=e.resolveComponent("input-integer"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-select"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Fo,[f[20]||(f[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",jo,[e.createElementVNode("div",Po,[e.createElementVNode("table",qo,[f[4]||(f[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":f[0]||(f[0]=B=>e.unref(o).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":f[1]||(f[1]=B=>e.unref(o).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",Lo,e.toDisplayString((k=e.unref(o).OtherAmount)==null?void 0:k.toLocaleString()),1),e.createElementVNode("td",Ro,e.toDisplayString(e.unref(i).toLocaleString()),1)])])])]),f[10]||(f[10]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",zo,[e.createElementVNode("table",Jo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Go)]),e.createElementVNode("tr",null,[f[5]||(f[5]=e.createElementVNode("th",{width:"1"},null,-1)),f[6]||(f[6]=e.createElementVNode("th",null,"單位名稱",-1)),f[7]||(f[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Qo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(u)[`other-${C}-Unit`],modelValue:B.Unit,"onUpdate:modelValue":A=>B.Unit=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`other-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Wo,[e.createElementVNode("div",Yo,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>n(B),type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ho)):e.createCommentVNode("",!0),C+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...f[9]||(f[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),f[21]||(f[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Zo,[e.createElementVNode("div",Ko,[e.createElementVNode("table",Xo,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[f[11]||(f[11]=e.createElementVNode("th",null,"重要工作項目",-1)),f[12]||(f[12]=e.createElementVNode("th",null,"預算項目",-1)),f[13]||(f[13]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),f[14]||(f[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),f[15]||(f[15]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),f[16]||(f[16]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",vo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(T,{"empty-value":0,error:e.unref(u)[`plan-${C}-ItemID`],options:e.unref(l),"text-name":"Title","value-name":"ID",modelValue:B.ItemID,"onUpdate:modelValue":A=>B.ItemID=A},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(u)[`plan-${C}-Title`],modelValue:B.Title,"onUpdate:modelValue":A=>B.Title=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`plan-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`plan-${C}-OtherAmount`],modelValue:B.OtherAmount,"onUpdate:modelValue":A=>B.OtherAmount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",en,e.toDisplayString(B.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(u)[`plan-${C}-Description`],rows:"1",modelValue:B.Description,"onUpdate:modelValue":A=>B.Description=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",tn,[e.createElementVNode("div",ln,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>N(B),type:"button"},[...f[17]||(f[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,on)):e.createCommentVNode("",!0),C+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...f[18]||(f[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),f[19]||(f[19]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",nn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=B=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=B=>m(!0)),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(w,{ref_key:"modal",ref:r},{default:e.withCtx(()=>[e.createElementVNode("div",rn,[f[23]||(f[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",an,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(p).GrantLimit)+"萬",1),f[24]||(f[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),f[25]||(f[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},sn={class:"block"},cn={key:0,class:"text-pink lh-base mt-3"},mn={class:"border"},Vn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},pn={class:"d-flex gap-2 align-items-center flex-grow-1"},fn={class:"text-nowrap"},Nn={class:"flex-grow-1"},un={class:"d-flex gap-2"},En=["onClick"],bn=["href"],kn=["id"],gn={class:"table align-middle gray-table side-table mb-0"},yn={key:0,class:"block-bottom bg-light-teal"},hn={__name:"Other",props:{id:{type:Number}},setup(y){const g=y,E=e.computed(()=>P("culture",V.value.Status,4)),u=e.ref({}),V=e.ref({}),d=e.ref([]),o=e.computed(()=>d.value.filter(p=>!p.Deleted)),l=()=>d.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(u.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={ID:g.id,Projects:d.value,Submit:p?"true":"false"};S.culture("saveRelatedProject",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{u.value={};const p={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return o.value.forEach((i,b)=>Object.assign(u.value,U(i,p,`project-${b}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getRelatedProject",{ID:g.id})]).subscribe(p=>{const i=p[0];V.value=i.Project,d.value=i.Projects,I().init("culture",V.value)})}),e.provide("editable",E),(p,i)=>{const b=e.resolveComponent("required-label"),h=e.resolveComponent("input-text"),n=e.resolveComponent("input-integer"),N=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",sn,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("p",cn," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(m,t)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:m},[e.createElementVNode("div",mn,[e.createElementVNode("div",Vn,[e.createElementVNode("div",pn,[e.createElementVNode("label",fn,[e.createVNode(b,null,{default:e.withCtx(()=>[...i[2]||(i[2]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",Nn,[e.createVNode(h,{error:e.unref(u)[`project-${t}-Title`],modelValue:m.Title,"onUpdate:modelValue":c=>m.Title=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",un,[e.unref(E)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(c=>r(m),["prevent"]),href:"#"},"刪除",8,En)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${t}`,role:"button"},"收合",8,bn)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${t}`},[e.createElementVNode("table",gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...i[3]||(i[3]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(n,{class:"text-start w-auto",error:e.unref(u)[`project-${t}-Year`],modelValue:m.Year,"onUpdate:modelValue":c=>m.Year=c},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...i[4]||(i[4]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(u)[`project-${t}-OrgName`],modelValue:m.OrgName,"onUpdate:modelValue":c=>m.OrgName=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...i[5]||(i[5]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(n,{class:"w-auto",error:e.unref(u)[`project-${t}-Amount`],modelValue:m.Amount,"onUpdate:modelValue":c=>m.Amount=c},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...i[6]||(i[6]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(u)[`project-${t}-Description`],rows:"4",modelValue:m.Description,"onUpdate:modelValue":c=>m.Description=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(b,null,{default:e.withCtx(()=>[...i[7]||(i[7]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(u)[`project-${t}-Benefit`],rows:"4",modelValue:m.Benefit,"onUpdate:modelValue":c=>m.Benefit=c,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,kn)])]))),128)),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:l,type:"button"},[...i[8]||(i[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",yn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[0]||(i[0]=m=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[1]||(i[1]=m=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},$n={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"culture"})}}},Q=(y,g)=>{const E=y.__vccOpts||y;for(const[u,V]of g)E[u]=V;return E},xn={class:"block"},Bn={class:"mt-4"},Cn={class:"table align-middle gray-table side-table"},_n={key:0,class:"d-flex align-items-center gap-2"},Tn={class:"input-group w-auto"},wn={class:"text-teal-dark"},Dn={key:1,class:"invalid mt-0"},Sn={class:"square-title mt-4"},Un={class:"mt-4"},An=["onClick"],On={class:"d-flex flex-column gap-2"},Mn={class:"mt-4 d-flex flex-column gap-2"},In={class:"d-flex flex-column gap-3 mt-4"},Fn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},jn={class:"d-flex gap-2 align-items-center flex-grow-1"},Pn={class:"text-nowrap"},qn={class:"flex-grow-1"},Ln={class:"d-flex gap-2"},Rn=["onClick"],zn=["href"],Jn=["id"],Gn={class:"table align-middle gray-table side-table mb-0"},Qn={class:"p-0"},Wn={class:"item-list"},Yn={class:"mt-2 align-self-start text-center"},Hn={class:"input-group"},Zn={key:0,class:"invalid mt-0"},Kn={key:0,class:"d-flex gap-2 mt-1 align-self-start"},Xn=["onClick"],vn=["onClick"],er={class:"row"},tr={class:"col"},lr=["value"],or={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},nr=["onClick"],rr=["onClick"],ar={class:"col"},dr=["value"],sr={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},ir=["onClick"],cr=["onClick"],mr=["onClick"],Vr={key:0,class:"block-bottom bg-light-teal"},pr=Q({__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,E=e.computed(()=>P("culture",o.value.Status,2)),u=e.computed(()=>r.value.EndDate),V=e.ref({}),d=e.computed(()=>l.value.filter(c=>!c.Deleted)),o=e.ref({}),l=e.ref([]),r=e.ref({}),a=()=>{const c={Items:[]};s(c),l.value.push(c)},s=c=>{const f={Steps:[],Schedules:[]};i(f),i(f),i(f),p(f,1),p(f,2),c.Items.push(f)},p=(c,f)=>c.Schedules.push({Type:f,Month:0,StepID:0}),i=c=>S.culture("createGoalStep",{ID:g.id,ItemID:c.ID}).subscribe(f=>c.Steps.push(f)),b=c=>c.Deleted=!0,h=c=>c.Deleted=!0,n=c=>c.Deleted=!0,N=c=>c.Deleted=!0,m=c=>{if(V.value={},c&&!t()){e.nextTick(()=>{var D;return(D=document.querySelector(".invalid"))==null?void 0:D.scrollIntoView({behavior:"smooth",block:"center"})});return}const f={Project:o.value,Goals:l.value,Submit:c?"true":"false"};S.culture("saveWorkSchedule",f).subscribe(()=>{c?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},t=()=>{const c={StartTime:"計畫期程",EndTime:"計畫期程"};V.value=U(o.value,c);const f={Title:"計畫目標",Content:"預期效益"},D={Title:"重要工作項目",Indicator:"績效指標"},_={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},T={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return l.value.filter(x=>!x.Deleted).forEach((x,w)=>{Object.assign(V.value,U(x,f,`goal-${w}-`)),x.Items.filter(k=>!k.Deleted).forEach((k,B)=>{Object.assign(V.value,U(k,D,`item-${w}-${B}-`)),k.Steps.filter(C=>!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,_,`step-${w}-${B}-${A}-`))),k.Schedules.filter(C=>C.Type===1&&!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,T,`schedule-${w}-${B}-1-${A}-`))),k.Schedules.filter(C=>C.Type===2&&!C.Deleted).forEach((C,A)=>Object.assign(V.value,U(C,T,`schedule-${w}-${B}-2-${A}-`)))})}),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.culture("getWorkSchedule",{ID:g.id})]).subscribe(c=>{const f=c[0];o.value=f.Project,l.value=f.Goals,r.value=f.GrantType,l.value.length||a(),I().init("culture",o.value)})}),e.provide("editable",E),(c,f)=>{const D=e.resolveComponent("required-label"),_=e.resolveComponent("input-tw-date"),T=e.resolveComponent("tw-date"),x=e.resolveComponent("input-text"),w=e.resolveComponent("input-textarea"),k=e.resolveComponent("input-month"),B=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xn,[f[25]||(f[25]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Bn,[e.createElementVNode("table",Cn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(D,null,{default:e.withCtx(()=>[...f[4]||(f[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",_n,[e.createElementVNode("div",Tn,[e.createVNode(_,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(o).StartTime,"onUpdate:modelValue":f[0]||(f[0]=C=>e.unref(o).StartTime=C)},null,8,["max-date","modelValue"]),f[5]||(f[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(_,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(o).EndTime,"onUpdate:modelValue":f[1]||(f[1]=C=>e.unref(o).EndTime=C)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",wn,[f[6]||(f[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(T,{value:e.unref(u)},null,8,["value"]),f[7]||(f[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(V).StartTime||e.unref(V).EndTime?(e.openBlock(),e.createElementBlock("div",Dn,e.toDisplayString(e.unref(V).StartTime||e.unref(V).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",Sn,[f[9]||(f[9]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:a,type:"button"},[...f[8]||(f[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",Un,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(C,A)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:C},[e.unref(E)&&e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:j=>b(C),type:"button"},"刪除",8,An)):e.createCommentVNode("",!0),e.createElementVNode("div",On,[f[10]||(f[10]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`goal-${A}-Title`],modelValue:C.Title,"onUpdate:modelValue":j=>C.Title=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Mn,[f[11]||(f[11]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(w,{error:e.unref(V)[`goal-${A}-Content`],rows:"4",modelValue:C.Content,"onUpdate:modelValue":j=>C.Content=j,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",In,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Items.filter(j=>!j.Deleted),(j,q)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:j},[e.createElementVNode("div",Fn,[e.createElementVNode("div",jn,[e.createElementVNode("label",Pn,[e.createVNode(D,null,{default:e.withCtx(()=>[...f[12]||(f[12]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",qn,[e.createVNode(x,{error:e.unref(V)[`item-${A}-${q}-Title`],modelValue:j.Title,"onUpdate:modelValue":O=>j.Title=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Ln,[e.unref(E)&&C.Items.filter(O=>!O.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(O=>h(j),["prevent"]),href:"#"},"刪除",8,Rn)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${q}`,role:"button"},"收合",8,zn)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${q}`},[e.createElementVNode("table",Gn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(D,null,{default:e.withCtx(()=>[...f[13]||(f[13]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",Qn,[e.createElementVNode("ul",Wn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Steps.filter(O=>!O.Deleted),(O,L)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(E)}]),key:O},[e.createElementVNode("div",Yn,e.toDisplayString(String.fromCharCode(65+L)),1),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`step-${A}-${q}-${L}-Title`],placeholder:"如:進行口訪紀錄",modelValue:O.Title,"onUpdate:modelValue":M=>O.Title=M,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",Hn,[e.createVNode(k,{"empty-value":0,modelValue:O.Begin,"onUpdate:modelValue":M=>O.Begin=M},null,8,["modelValue","onUpdate:modelValue"]),f[14]||(f[14]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(k,{"empty-value":0,modelValue:O.End,"onUpdate:modelValue":M=>O.End=M},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(V)[`step-${A}-${q}-${L}-Begin`]||e.unref(V)[`step-${A}-${q}-${L}-End`]?(e.openBlock(),e.createElementBlock("div",Zn,e.toDisplayString(e.unref(V)[`step-${A}-${q}-${L}-Begin`]||e.unref(V)[`step-${A}-${q}-${L}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Kn,[j.Steps.filter(M=>!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>N(O),type:"button"},[...f[15]||(f[15]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Xn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>i(j),type:"button"},[...f[16]||(f[16]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,vn)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(D,null,{default:e.withCtx(()=>[...f[17]||(f[17]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(V)[`item-${A}-${q}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:j.Indicator,"onUpdate:modelValue":O=>j.Indicator=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(D,null,{default:e.withCtx(()=>[...f[18]||(f[18]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",er,[e.createElementVNode("div",tr,[f[21]||(f[21]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Schedules.filter(O=>O.Type===1&&!O.Deleted),(O,L)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:O},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?3:4}`])},[e.createVNode(k,{error:e.unref(V)[`schedule-${A}-${q}-1-${L}-Month`],"empty-value":0,modelValue:O.Month,"onUpdate:modelValue":M=>O.Month=M},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(V)[`schedule-${A}-${q}-1-${L}-StepID`],options:j.Steps.filter(M=>!M.Deleted),modelValue:O.StepID,"onUpdate:modelValue":M=>O.StepID=M},{default:e.withCtx(({index:M,option:G})=>[e.createElementVNode("option",{value:G.ID},e.toDisplayString(String.fromCharCode(65+M))+"."+e.toDisplayString(G.Title),9,lr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",or,[j.Schedules.filter(M=>M.Type===1&&!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>n(O),type:"button"},[...f[19]||(f[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,nr)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>p(j,1),type:"button"},[...f[20]||(f[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,rr)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",ar,[f[24]||(f[24]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(j.Schedules.filter(O=>O.Type===2&&!O.Deleted),(O,L)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:O},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?3:4}`])},[e.createVNode(k,{error:e.unref(V)[`schedule-${A}-${q}-2-${L}-Month`],"empty-value":0,modelValue:O.Month,"onUpdate:modelValue":M=>O.Month=M},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?7:8}`])},[e.createVNode(B,{"empty-value":0,error:e.unref(V)[`schedule-${A}-${q}-2-${L}-StepID`],options:j.Steps.filter(M=>!M.Deleted),modelValue:O.StepID,"onUpdate:modelValue":M=>O.StepID=M},{default:e.withCtx(({index:M,option:G})=>[e.createElementVNode("option",{value:G.ID},e.toDisplayString(String.fromCharCode(65+M))+"."+e.toDisplayString(G.Title),9,dr)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",sr,[j.Schedules.filter(M=>M.Type===2&&!M.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:M=>n(O),type:"button"},[...f[22]||(f[22]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ir)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:M=>p(j,2),type:"button"},[...f[23]||(f[23]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,cr)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,Jn)]))),128))]),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:j=>s(C),type:"button"},"新增工作項目",8,mr)):e.createCommentVNode("",!0)]))),128))])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Vr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:f[2]||(f[2]=C=>m()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:f[3]||(f[3]=C=>m(!0)),type:"button"},[...f[26]||(f[26]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-30126158"]]),fr={class:"block"},Nr={class:"mt-4"},ur={class:"table align-middle gray-table side-table"},Er={key:0},br={key:1,class:"text-light-gray"},kr={class:"d-flex flex-column gap-2"},gr={key:0},yr={class:"mt-4"},hr={class:"table align-middle gray-table side-table"},$r={class:"row g-3"},xr={class:"col-12 col-xl-2"},Br={class:"text-gray mb-2"},Cr={class:"col-12 col-xl-3"},_r={class:"text-gray mb-2"},Tr={key:0,class:"col-12 col-xl-4"},wr={class:"row g-1"},Dr={class:"col-7"},Sr={class:"col-5"},Ur={key:1,class:"col-12 col-xl-3"},Ar={class:"text-gray mb-2"},Or={class:"mt-4"},Mr={class:"table align-middle gray-table side-table"},Ir={class:"d-flex align-items-center gap-2"},Fr={class:"input-group w-auto"},jr={key:0,class:"invalid mt-0"},Pr={class:"mt-4"},qr={class:"table-responsive mt-3 mb-0"},Lr={class:"table align-middle gray-table"},Rr={class:"text-end"},zr={class:"text-end"},Jr={class:"text-end"},Gr={class:"text-end"},Qr={class:"text-end"},Wr={class:"table align-middle gray-table side-table"},Yr={key:0,class:"table-responsive mt-3 mb-0"},Hr={class:"table align-middle gray-table"},Zr={key:0},Kr={key:0},Xr={class:"d-flex gap-2"},vr=["onClick"],ea={key:0,class:"block-bottom bg-light-teal"},ta={class:"text-center"},la={class:"mb-5"},oa={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.ref(),V=e.computed(()=>P("education",l.value.Status,1)),d=e.ref({}),o=e.computed(()=>a.value.filter(m=>!m.Deleted)),l=e.ref({}),r=e.ref(),a=e.ref([]),s=e.ref(),p=e.ref(0),i=e.computed({get:()=>!!o.value.length,set:m=>{m?b():a.value.forEach(t=>t.Deleted=!0)}}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,n=(m,t)=>{if(d.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&s.value&&l.value.ApplyAmount>s.value.GrantLimit*1e4){r.value.show(()=>n(m,!0));return}const c={Project:l.value,Contacts:u.value,ReceivedSubsidies:a.value.filter(f=>f.ID||!f.Deleted),Submit:m?"true":"false"};S.education("saveApplication",c).subscribe(f=>{m?window.location.href=`Attachment.aspx?ID=${f.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${f.ID}`})},N=()=>{let m={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return l.value.OrgCategory==="2"&&(m.RegisteredNum="立案登記證字號"),d.value=U(l.value,m),m={Name:"姓名",JobTitle:"職稱"},Object.assign(d.value,U(u.value[0],m,"contact-0-")),m.MobilePhone="手機號碼",Object.assign(d.value,U(u.value[1],m,"contact-1-")),m={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},a.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`received-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(m=>{E.value=m[0],g.id?S.education("getApplication",{ID:g.id}).subscribe(t=>{l.value=t.Project,u.value=t.Contacts,a.value=t.ReceivedSubsidies,l.value.OrgCategory=l.value.OrgCategory||null,I().init("education",l.value)}):S.education("getEmptyApplication").subscribe(t=>{l.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),u.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("education",l.value)})})}),e.provide("editable",V),e.watch(()=>l.value.OrgCategory,()=>{S.education("getGrantTargetSetting",{TargetTypeID:`EDC${l.value.OrgCategory}`}).subscribe(m=>{s.value=m})}),e.watchEffect(()=>{p.value=F(l.value.ApplyAmount)+F(l.value.SelfAmount)+F(l.value.OtherGovAmount)+F(l.value.OtherUnitAmount)}),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-text"),D=e.resolveComponent("input-select"),_=e.resolveComponent("input-tw-date"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-integer"),w=e.resolveComponent("input-boolean"),k=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fr,[t[47]||(t[47]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Nr,[e.createElementVNode("table",ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[18]||(t[18]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[t[19]||(t[19]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",Er,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",br,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).ProjectName,modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=B=>e.unref(l).ProjectName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",kr,[e.createElementVNode("div",null,[e.createVNode(D,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=B=>e.unref(l).OrgCategory=B)},null,8,["error","options","modelValue"])]),e.unref(l).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",gr,[e.createVNode(f,{error:e.unref(d).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(l).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=B=>e.unref(l).RegisteredNum=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":t[3]||(t[3]=B=>e.unref(l).OrgName=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(l).TaxID,"onUpdate:modelValue":t[4]||(t[4]=B=>e.unref(l).TaxID=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":t[5]||(t[5]=B=>e.unref(l).Address=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[48]||(t[48]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",yr,[e.createElementVNode("table",hr,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",$r,[e.createElementVNode("div",xr,[e.createElementVNode("div",Br,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-Name`],modelValue:B.Name,"onUpdate:modelValue":A=>B.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Cr,[e.createElementVNode("div",_r,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-JobTitle`],modelValue:B.JobTitle,"onUpdate:modelValue":A=>B.JobTitle=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),C?(e.openBlock(),e.createElementBlock("div",Tr,[t[28]||(t[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",wr,[e.createElementVNode("div",Dr,[e.createVNode(f,{modelValue:B.Phone,"onUpdate:modelValue":A=>B.Phone=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Sr,[e.createVNode(f,{placeholder:"請輸入分機",size:"4",modelValue:B.PhoneExt,"onUpdate:modelValue":A=>B.PhoneExt=A,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),C?(e.openBlock(),e.createElementBlock("div",Ur,[e.createElementVNode("div",Ar,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(f,{error:e.unref(d)[`contact-${C}-MobilePhone`],modelValue:B.MobilePhone,"onUpdate:modelValue":A=>B.MobilePhone=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[49]||(t[49]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Or,[e.createElementVNode("table",Mr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ir,[e.createElementVNode("div",Fr,[e.createVNode(_,{class:"w-auto",modelValue:e.unref(l).StartTime,"onUpdate:modelValue":t[6]||(t[6]=B=>e.unref(l).StartTime=B)},null,8,["modelValue"]),t[31]||(t[31]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(_,{class:"w-auto",modelValue:e.unref(l).EndTime,"onUpdate:modelValue":t[7]||(t[7]=B=>e.unref(l).EndTime=B)},null,8,["modelValue"])]),t[32]||(t[32]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",jr,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[33]||(t[33]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Target,modelValue:e.unref(l).Target,"onUpdate:modelValue":t[8]||(t[8]=B=>e.unref(l).Target=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[34]||(t[34]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":t[9]||(t[9]=B=>e.unref(l).Summary=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(d).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":t[10]||(t[10]=B=>e.unref(l).Quantified=B),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[50]||(t[50]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Pr,[t[41]||(t[41]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",qr,[e.createElementVNode("table",Lr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",Rr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",zr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",Jr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Gr,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[40]||(t[40]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).ApplyAmount,modelValue:e.unref(l).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=B=>e.unref(l).ApplyAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).SelfAmount,modelValue:e.unref(l).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=B=>e.unref(l).SelfAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).OtherGovAmount,modelValue:e.unref(l).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=B=>e.unref(l).OtherGovAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d).OtherUnitAmount,modelValue:e.unref(l).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=B=>e.unref(l).OtherUnitAmount=B)},null,8,["error","modelValue"])]),e.createElementVNode("td",Qr,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])])]),e.createElementVNode("table",Wr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[42]||(t[42]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(w,{modelValue:e.unref(i),"onUpdate:modelValue":t[15]||(t[15]=B=>e.isRef(i)?i.value=B:null)},null,8,["modelValue"]),e.unref(i)?(e.openBlock(),e.createElementBlock("div",Yr,[e.createElementVNode("table",Hr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[43]||(t[43]=e.createElementVNode("th",null,"計畫名稱",-1)),t[44]||(t[44]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Zr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(B,C)=>(e.openBlock(),e.createElementBlock("tr",{key:B},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`received-${C}-Name`],modelValue:B.Name,"onUpdate:modelValue":A=>B.Name=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`received-${C}-Amount`],modelValue:B.Amount,"onUpdate:modelValue":A=>B.Amount=A},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Kr,[e.createElementVNode("div",Xr,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>h(B),type:"button"},[...t[45]||(t[45]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,vr)):e.createCommentVNode("",!0),C+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[46]||(t[46]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ea,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[16]||(t[16]=B=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[17]||(t[17]=B=>n(!0)),type:"button"},[...t[51]||(t[51]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(k,{ref_key:"modal",ref:r},{default:e.withCtx(()=>{var B;return[e.createElementVNode("div",ta,[t[52]||(t[52]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",la,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString((B=e.unref(s))==null?void 0:B.GrantLimit)+"萬",1),t[53]||(t[53]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[54]||(t[54]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]}),_:1},512)],64)}}},na={class:"block"},ra={key:0,class:"text-pink lh-base mt-4"},aa={class:"mt-4"},da={class:"table align-middle gray-table"},sa={class:"text-center"},ia={key:0,width:"180"},ca={class:"text-center"},ma={key:0},Va=["innerHTML"],pa={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},fa={key:0,class:"text-center"},Na={key:0},ua={key:1,class:"text-pink"},Ea={key:1,class:"tag-group mt-2 gap-1"},ba={key:0,class:"tag tag-green-light"},ka=["download","href"],ga=["onClick"],ya={key:0,class:"block-bottom bg-light-teal"},ha=["disabled"],$a={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]}]),u=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("education",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=S.download,r=a=>{const s={ID:g.id,Attachments:E.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};S.education("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.education("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,E.value=E.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),E.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),I().init("education",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",na,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",ra,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",aa,[e.createElementVNode("table",da,[e.createElementVNode("thead",sa,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ia,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",ca,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",ma,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Va)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",pa,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",fa,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",Na,"已上傳")):(e.openBlock(),e.createElementBlock("span",ua,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:n=>o(b,n)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",Ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ba,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(l)(n.Path)},e.toDisplayString(n.Name),9,ka),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>n.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ga)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",ya,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ha)])):e.createCommentVNode("",!0)],64)}}},xa={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(E,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"education"})}}},Ba={class:"modal-dialog modal-dialog-centered modal-md"},Ca={class:"modal-content"},_a={class:"modal-body"},Ta={class:"d-flex flex-column align-items-center mb-5 gap-3"},wa={class:"fs-18"},Da={__name:"ErrorModal",setup(y){const g=W(),E=e.ref();return e.onMounted(()=>E.value.addEventListener("hidden.bs.modal",()=>g.error=null)),e.watch(()=>g.error,()=>{g.error&&bootstrap.Modal.getOrCreateInstance(E.value).show()}),(u,V)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",Ba,[e.createElementVNode("div",Ca,[V[2]||(V[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",_a,[e.createElementVNode("div",Ta,[V[0]||(V[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",wa,e.toDisplayString(e.unref(g).error),1)]),V[1]||(V[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},Sa={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const g=e.useModel(y,"modelValue"),E=[{value:!0,text:"是"},{value:!1,text:"否"}];return(u,V)=>{const d=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(d,{options:E,modelValue:g.value,"onUpdate:modelValue":V[0]||(V[0]=o=>g.value=o)},null,8,["modelValue"])}}},Ua=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(y,{emit:g}){const E=e.ref(),u=()=>{Array.from(E.value.files).forEach(d=>S.upload(d).subscribe(o=>V("file",o))),E.value.value=""},V=g;return(d,o)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:o[0]||(o[0]=l=>e.unref(E).click()),type:"button"},[...o[1]||(o[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:u,class:"d-none",ref_key:"input",ref:E,type:"file"},d.$attrs),null,16)],64))}}),Aa=["disabled","placeholder","type"],Oa={key:0,class:"invalid mt-0"},Ma=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),E=e.useModel(y,"modelValue");return e.watch(E,u=>{if(u){const V=(parseInt(u)||0).toString();u.toString()!==V&&(E.value=V)}}),(u,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(g),placeholder:e.unref(g)?y.placeholder:"",style:{"text-align":"right"},type:y.type},u.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=d=>E.value=d)}),null,16,Aa),[[e.vModelDynamic,E.value]]),y.error?(e.openBlock(),e.createElementBlock("div",Oa,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Ia={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(y){const g=e.useModel(y,"modelValue"),E=[];for(let u=1;u<=12;u++)E.push({value:u,text:`${u}月`});return(u,V)=>{const d=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(d,{options:E,modelValue:g.value,"onUpdate:modelValue":V[0]||(V[0]=o=>g.value=o)},null,8,["modelValue"])}}},Fa=["onChange","checked","disabled","id","value"],ja=["for"],Pa={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>v(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),E=e.useModel(y,"modelValue"),u=V=>{E.value=V};return(V,d)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,o=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:o},[e.createElementVNode("input",{onChange:l=>u(o[y.valueName]),checked:o[y.valueName]===E.value,class:"form-check-input",disabled:!e.unref(g),id:`${y.id}-${o[y.valueName]}`,type:"radio",value:o[y.valueName]},null,40,Fa),e.createElementVNode("label",{class:"form-check-label",for:`${y.id}-${o[y.valueName]}`},e.toDisplayString(o[y.textName]),9,ja)]))),128))}},qa=["disabled"],La=["value"],Ra=["value"],za={key:0,class:"invalid mt-0"},Ja=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),E=e.useModel(y,"modelValue");return(u,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:y.disabled||!e.unref(g)},u.$attrs,{"onUpdate:modelValue":V[0]||(V[0]=d=>E.value=d)}),[e.unref(g)&&!E.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:y.emptyValue},e.toDisplayString(y.placeholder),9,La)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.options,(d,o)=>e.renderSlot(u.$slots,"default",{key:d,index:o,option:d},()=>[e.createElementVNode("option",{value:d[y.valueName]},e.toDisplayString(d[y.textName]),9,Ra)])),128))],16,qa),[[e.vModelSelect,E.value]]),y.error?(e.openBlock(),e.createElementBlock("div",za,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),Ga={class:"input-group"},Qa={key:0,class:"input-group-text"},Wa=["disabled","placeholder","type"],Ya={key:0,class:"invalid mt-0"},Ha=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),E=e.useModel(y,"modelValue"),u=y;return u.maxLength&&e.watch(E,()=>{var V;((V=E.value)==null?void 0:V.length)>u.maxLength&&(E.value=E.value.substring(0,u.maxLength))}),(V,d)=>{const o=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ga,[y.prefix?(e.openBlock(),e.createElementBlock("span",Qa,[e.createVNode(o,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(y.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(g),placeholder:e.unref(g)?y.placeholder:"",type:y.type},V.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=l=>E.value=l)}),null,16,Wa),[[e.vModelDynamic,E.value]])]),y.error?(e.openBlock(),e.createElementBlock("div",Ya,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),Za=["disabled","placeholder"],Ka={key:0,class:"fs-14 text-gray mt-2"},Xa={class:"text-pink"},va={key:1,class:"invalid mt-0"},ed=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const g=e.inject("editable",!0),E=e.useModel(y,"modelValue"),u=y;return u.maxLength&&e.watch(E,()=>{var V;((V=E.value)==null?void 0:V.length)>u.maxLength&&(E.value=E.value.substring(0,u.maxLength))}),(V,d)=>{var o;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(g),placeholder:e.unref(g)?y.placeholder:""},V.$attrs,{"onUpdate:modelValue":d[0]||(d[0]=l=>E.value=l)}),null,16,Za),[[e.vModelText,E.value]]),e.unref(g)&&y.maxLength?(e.openBlock(),e.createElementBlock("div",Ka,[d[1]||(d[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Xa,e.toDisplayString(((o=E.value)==null?void 0:o.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(y.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),y.error?(e.openBlock(),e.createElementBlock("div",va,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64)}}}),td=["disabled"],ld={key:0,class:"invalid"},od=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},maxDate:{type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(y,{emit:g}){let E;const u=y,V=e.ref(),d=e.inject("editable",!0),o=e.ref(),l=g,r=a=>{!a&&u.modelValue&&(a=moment(new Date(u.modelValue))),a?(V.value=a.format(u.displayFormat),l("update:modelValue",a.format(u.format))):(V.value="",l("update:modelValue","")),E.setStartDate(V.value||void 0)};return e.onMounted(()=>{const a=$(o.value);a.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:u.drops,locale:{format:u.displayFormat},maxDate:u.maxDate?new Date(u.maxDate):u.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(s,p)=>r(p.startDate)),E=a.data("daterangepicker"),r()}),e.onUnmounted(()=>E.remove()),e.watch(()=>u.modelValue,()=>r()),(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(d),ref_key:"element",ref:o,type:"text"},a.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=p=>e.isRef(V)?V.value=p:null)}),null,16,td),[[e.vModelText,e.unref(V)]]),y.error?(e.openBlock(),e.createElementBlock("div",ld,e.toDisplayString(y.error),1)):e.createCommentVNode("",!0)],64))}}),nd={class:"block"},rd={class:"mt-4"},ad={class:"table align-middle gray-table side-table"},dd={key:0},sd={key:1,class:"text-light-gray"},id={class:"mt-4"},cd={class:"table align-middle gray-table side-table"},md={class:"row g-3"},Vd={class:"col-12 col-xl-2"},pd={class:"text-gray mb-2"},fd={class:"col-12 col-xl-3"},Nd={class:"text-gray mb-2"},ud={class:"col-12 col-xl-4"},Ed={class:"row g-1"},bd={class:"col-7"},kd={class:"col-5"},gd={class:"col-12 col-xl-3"},yd={class:"text-gray mb-2"},hd={class:"col-12"},$d={class:"text-gray mb-2"},xd={class:"mt-4"},Bd={class:"table align-middle gray-table side-table"},Cd={class:"mt-4"},_d={class:"table align-middle gray-table side-table"},Td={key:0,class:"table-responsive mt-3 mb-0"},wd={class:"table align-middle gray-table"},Dd={key:0},Sd={key:0},Ud={class:"d-flex gap-2"},Ad=["onClick"],Od={key:0,class:"block-bottom bg-light-teal"},Md={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,E=e.ref(),u=e.computed(()=>P("literacy",l.value.Status,1)),V=e.ref({}),d=e.ref([]),o=e.computed(()=>r.value.filter(h=>!h.Deleted)),l=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!o.value.length,set:h=>{h?s():r.value.forEach(n=>n.Deleted=!0)}}),s=()=>r.value.push({}),p=h=>h.Deleted=!0,i=h=>{if(V.value={},h&&!b()){e.nextTick(()=>{var N;return(N=document.querySelector(".invalid"))==null?void 0:N.scrollIntoView({behavior:"smooth",block:"center"})});return}const n={Project:l.value,Contacts:E.value,PreviousStudies:r.value.filter(N=>N.ID||!N.Deleted),Submit:h?"true":"false"};S.literacy("saveApplication",n).subscribe(N=>{h?window.location.href=`WorkSchedule.aspx?ID=${N.ID}`:l.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${N.ID}`})},b=()=>{let h={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return V.value=U(l.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((n,N)=>Object.assign(V.value,U(n,h,`contact-${N}-`))),h={Title:"研習/課程名稱",TheDate:"辦理日期"},r.value.forEach((n,N)=>Object.assign(V.value,U(n,h,`study-${N}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(h=>{d.value=h[0],g.id?S.literacy("getApplication",{ID:g.id}).subscribe(n=>{l.value=n.Project,E.value=n.Contacts,r.value=n.PreviousStudies,I().init("literacy",l.value)}):S.literacy("getEmptyApplication").subscribe(n=>{l.value=Object.assign({Field:null,FormStep:1,Status:1},n),E.value=[{Role:"申請人"}],I().init("literacy",l.value)})})}),e.provide("editable",u),e.watch(()=>[l.value.Field,l.value.OrgName],()=>{var h;if(u.value){const n=[];l.value.Field&&n.push((h=d.value.find(N=>N.Code===l.value.Field))==null?void 0:h.Descname),l.value.OrgName&&n.push(l.value.OrgName),l.value.ProjectName=n.join("-")}}),(h,n)=>{const N=e.resolveComponent("required-label"),m=e.resolveComponent("input-text"),t=e.resolveComponent("input-select"),c=e.resolveComponent("input-textarea"),f=e.resolveComponent("input-boolean"),D=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",nd,[n[35]||(n[35]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",rd,[e.createElementVNode("table",ad,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[12]||(n[12]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).Year),1)]),e.createElementVNode("tr",null,[n[13]||(n[13]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(l).ProjectID?(e.openBlock(),e.createElementBlock("span",dd,e.toDisplayString(e.unref(l).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",sd,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[n[14]||(n[14]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(l).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[15]||(n[15]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{disabled:"",modelValue:e.unref(l).ProjectName,"onUpdate:modelValue":n[0]||(n[0]=_=>e.unref(l).ProjectName=_),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[16]||(n[16]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{"empty-value":null,error:e.unref(V).Field,options:e.unref(d),"text-name":"Descname","value-name":"Code",modelValue:e.unref(l).Field,"onUpdate:modelValue":n[1]||(n[1]=_=>e.unref(l).Field=_)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[17]||(n[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(l).OrgName,"onUpdate:modelValue":n[2]||(n[2]=_=>e.unref(l).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[18]||(n[18]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).OrgLeader,modelValue:e.unref(l).OrgLeader,"onUpdate:modelValue":n[3]||(n[3]=_=>e.unref(l).OrgLeader=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[19]||(n[19]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V).Address,placeholder:"請輸入地址",modelValue:e.unref(l).Address,"onUpdate:modelValue":n[4]||(n[4]=_=>e.unref(l).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),n[36]||(n[36]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",id,[e.createElementVNode("table",cd,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",md,[e.createElementVNode("div",Vd,[e.createElementVNode("div",pd,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[20]||(n[20]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-Name`],modelValue:_.Name,"onUpdate:modelValue":x=>_.Name=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",fd,[e.createElementVNode("div",Nd,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[21]||(n[21]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":x=>_.JobTitle=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ud,[n[22]||(n[22]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Ed,[e.createElementVNode("div",bd,[e.createVNode(m,{modelValue:_.Phone,"onUpdate:modelValue":x=>_.Phone=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",kd,[e.createVNode(m,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":x=>_.PhoneExt=x,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",gd,[e.createElementVNode("div",yd,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[23]||(n[23]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":x=>_.MobilePhone=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hd,[e.createElementVNode("div",$d,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[24]||(n[24]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(m,{error:e.unref(V)[`contact-${T}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":x=>_.EMail=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),n[37]||(n[37]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",xd,[e.createElementVNode("table",Bd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[25]||(n[25]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[n[26]||(n[26]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(c,{error:e.unref(V).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(l).Target,"onUpdate:modelValue":n[5]||(n[5]=_=>e.unref(l).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[27]||(n[27]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(V).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(l).Summary,"onUpdate:modelValue":n[6]||(n[6]=_=>e.unref(l).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[28]||(n[28]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(V).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Quantified,"onUpdate:modelValue":n[7]||(n[7]=_=>e.unref(l).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(N,null,{default:e.withCtx(()=>[...n[29]||(n[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(V).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(l).Qualitative,"onUpdate:modelValue":n[8]||(n[8]=_=>e.unref(l).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Cd,[e.createElementVNode("table",_d,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[n[34]||(n[34]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(f,{modelValue:e.unref(a),"onUpdate:modelValue":n[9]||(n[9]=_=>e.isRef(a)?a.value=_:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Td,[e.createElementVNode("table",wd,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[n[30]||(n[30]=e.createElementVNode("th",null,"研習/課程名稱",-1)),n[31]||(n[31]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Dd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(_,T)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(m,{error:e.unref(V)[`study-${T}-Title`],modelValue:_.Title,"onUpdate:modelValue":x=>_.Title=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(V)[`study-${T}-TheDate`],modelValue:_.TheDate,"onUpdate:modelValue":x=>_.TheDate=x,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",Sd,[e.createElementVNode("div",Ud,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:x=>p(_),type:"button"},[...n[32]||(n[32]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ad)):e.createCommentVNode("",!0),T+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...n[33]||(n[33]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Od,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:n[10]||(n[10]=_=>i()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:n[11]||(n[11]=_=>i(!0)),type:"button"},[...n[38]||(n[38]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Id={class:"block"},Fd={key:0,class:"text-pink lh-base mt-4"},jd={class:"mt-4"},Pd={class:"table align-middle gray-table"},qd={class:"text-center"},Ld={key:0,width:"180"},Rd={class:"text-center"},zd={key:0},Jd=["innerHTML"],Gd={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Qd={key:0,class:"text-center"},Wd={key:0},Yd={key:1,class:"text-pink"},Hd={key:1,class:"tag-group mt-2 gap-1"},Zd={key:0,class:"tag tag-green-light"},Kd=["download","href"],Xd=["onClick"],vd={key:0,class:"block-bottom bg-light-teal"},es=["disabled"],ts={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"著作權授權同意書",Template:!0,Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),u=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("literacy",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=S.download,r=a=>{const s={ID:g.id,Attachments:E.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};S.literacy("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,E.value=E.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),E.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),I().init("literacy",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Id,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",Fd,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",jd,[e.createElementVNode("table",Pd,[e.createElementVNode("thead",qd,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ld,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Rd,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",zd,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Jd)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",Gd,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Qd,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",Wd,"已上傳")):(e.openBlock(),e.createElementBlock("span",Yd,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:n=>o(b,n)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",Hd,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Zd,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(l)(n.Path)},e.toDisplayString(n.Name),9,Kd),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>n.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Xd)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",vd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,es)])):e.createCommentVNode("",!0)],64)}}},ls={class:"block"},os={class:"mt-4"},ns={class:"table-responsive mt-3 mb-0"},rs={class:"table align-middle gray-table"},as={key:0,width:"1"},ds={key:0},ss={class:"d-flex gap-2"},is=["onClick"],cs={class:"table-responsive mt-3 mb-0"},ms={class:"table align-middle gray-table"},Vs={key:0,class:"block-bottom bg-light-teal"},ps={__name:"Benefit",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.computed(()=>P("literacy",o.value.Status,4)),V=e.ref({}),d=e.computed(()=>E.value.filter(p=>!p.Deleted)),o=e.ref({}),l=()=>E.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:o.value,Benefits:E.value,Submit:p?"true":"false"};S.literacy("saveBenefit",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((i,b)=>Object.assign(V.value,U(i,p,`item-${b}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getBenefit",{ID:g.id})]).subscribe(p=>{const i=p[0];o.value=i.Project,E.value=i.Benefits,E.value.length||l(),I().init("literacy",o.value)})}),e.provide("editable",u),(p,i)=>{const b=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ls,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",os,[e.createElementVNode("div",ns,[e.createElementVNode("table",rs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[3]||(i[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),i[4]||(i[4]=e.createElementVNode("th",null,"目標值",-1)),i[5]||(i[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",as,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(n,N)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Title`],modelValue:n.Title,"onUpdate:modelValue":m=>n.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Target`],modelValue:n.Target,"onUpdate:modelValue":m=>n.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:n.Description,"onUpdate:modelValue":m=>n.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",ds,[e.createElementVNode("div",ss,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>r(n),type:"button"},[...i[6]||(i[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,is)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...i[7]||(i[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",cs,[e.createElementVNode("table",ms,[i[8]||(i[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":i[0]||(i[0]=n=>e.unref(o).Benefit=n),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Vs,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[1]||(i[1]=n=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[2]||(i[2]=n=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},fs={class:"block"},Ns={class:"mt-4"},us={class:"table-responsive mt-3 mb-0"},Es={class:"table align-middle gray-table"},bs={class:"text-end"},ks={class:"text-end"},gs={class:"table-responsive"},ys={class:"table align-middle gray-table"},hs=["colspan"],$s={key:0,width:"1"},xs={class:"text-end"},Bs={key:0},Cs={class:"d-flex gap-2"},_s=["onClick"],Ts={class:"mt-4"},ws={class:"table-responsive mt-3 mb-0"},Ds={class:"table align-middle gray-table"},Ss={key:0,width:"1"},Us={class:"text-end"},As={key:0},Os={class:"d-flex gap-2"},Ms=["onClick"],Is={key:0,class:"block-bottom bg-light-teal"},Fs={class:"text-center"},js={class:"mb-5"},Ps={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,E=e.computed(()=>P("literacy",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>r.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),o=e.ref({}),l=e.ref(),r=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),i=()=>r.value.push({}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,n=(m,t)=>{if(u.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>n(m,!0));return}const c={Project:o.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:m?"true":"false"};S.literacy("saveFunding",c).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},r.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`other-${c}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`plan-${c}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getFunding",{ID:g.id})]).subscribe(m=>{const t=m[0];o.value=t.Project,r.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,r.value.length||i(),a.value.length||b(),I().init("literacy",o.value)})}),e.provide("editable",E),e.watchEffect(()=>{o.value.OtherAmount=V.value.reduce((m,t)=>m+F(t.Amount),0),p.value=F(o.value.ApplyAmount)+F(o.value.SelfAmount)+F(o.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(F(m.Amount)/o.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=F(m.Amount)+F(m.OtherAmount))}),(m,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),D=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",fs,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Ns,[e.createElementVNode("div",us,[e.createElementVNode("table",Es,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(o).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(o).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",bs,e.toDisplayString((T=e.unref(o).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",ks,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",gs,[e.createElementVNode("table",ys,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,hs)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",$s,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":k=>x.Unit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",xs,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":k=>x.Content=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Bs,[e.createElementVNode("div",Cs,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,_s)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("div",ws,[e.createElementVNode("table",Ds,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Ss,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":k=>x.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":k=>x.OtherAmount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Us,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":k=>x.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",As,[e.createElementVNode("div",Os,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ms)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Is,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>n(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",Fs,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",js,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},qs={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"literacy"})}}},Ls={class:"block"},Rs={class:"mt-4"},zs={class:"table align-middle gray-table side-table"},Js={key:0,class:"d-flex align-items-center gap-2"},Gs={class:"input-group w-auto"},Qs={class:"text-teal-dark"},Ws={key:1,class:"invalid mt-0"},Ys={class:"table-responsive mt-4"},Hs={class:"table align-middle gray-table"},Zs={key:0},Ks={class:"input-group"},Xs={key:0,class:"invalid mt-0"},vs={key:0},ei={class:"d-flex gap-2"},ti=["onClick"],li={class:"mt-4"},oi={class:"table align-middle gray-table"},ni={key:0},ri={key:0},ai={class:"d-flex gap-2"},di=["onClick"],si={key:0,class:"block-bottom bg-light-teal"},ii={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,E=[{value:1,text:"50%"},{value:2,text:"100%"}],u=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("literacy",r.value.Status,2)),d=e.ref({}),o=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),r=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),i=()=>S.literacy("createItem",{ID:g.id}).subscribe(m=>s.value.push(m)),b=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,n=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};S.literacy("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(r.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`item-${c}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`schedule-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.literacy("getWorkSchedule",{ID:g.id})]).subscribe(m=>{const t=m[0];r.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||i(),p.value.length||b(),I().init("literacy",r.value)})}),e.provide("editable",V),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),D=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ls,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Rs,[e.createElementVNode("table",zs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",Js,[e.createElementVNode("div",Gs,[e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":t[0]||(t[0]=k=>e.unref(r).StartTime=k)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":t[1]||(t[1]=k=>e.unref(r).EndTime=k)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Qs,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(D,{value:e.unref(u)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",Ws,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Ys,[e.createElementVNode("table",Hs,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Zs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:k.Title,"onUpdate:modelValue":C=>k.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Ks,[e.createVNode(T,{"empty-value":0,modelValue:k.Begin,"onUpdate:modelValue":C=>k.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:k.End,"onUpdate:modelValue":C=>k.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",Xs,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",vs,[e.createElementVNode("div",ei,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ti)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",li,[e.createElementVNode("table",oi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",ni,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:E,modelValue:k.Type,"onUpdate:modelValue":C=>k.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:k.ItemID,"onUpdate:modelValue":C=>k.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(k.ItemID?String.fromCharCode(65+e.unref(o).findIndex(C=>C.ID===k.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",ri,[e.createElementVNode("div",ai,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,di)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",si,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=k=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=k=>n(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ci={class:"block"},mi={class:"mt-4"},Vi={class:"table align-middle gray-table side-table"},pi={key:0},fi={key:1,class:"text-light-gray"},Ni={class:"mt-4"},ui={class:"table align-middle gray-table side-table"},Ei={class:"row g-3"},bi={class:"col-12 col-xl-2"},ki={class:"text-gray mb-2"},gi={class:"col-12 col-xl-3"},yi={class:"text-gray mb-2"},hi={class:"col-12 col-xl-4"},$i={class:"row g-1"},xi={class:"col-7"},Bi={class:"col-5"},Ci={class:"col-12 col-xl-3"},_i={class:"text-gray mb-2"},Ti={class:"col-12"},wi={class:"text-gray mb-2"},Di={class:"mt-4"},Si={class:"table align-middle gray-table side-table"},Ui={class:"mt-4"},Ai={class:"table align-middle gray-table side-table"},Oi={key:0,class:"table-responsive mt-3 mb-0"},Mi={class:"table align-middle gray-table"},Ii={key:0},Fi={key:0},ji={class:"d-flex gap-2"},Pi=["onClick"],qi={key:0,class:"block-bottom bg-light-teal"},Li={__name:"Application",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.ref(),V=e.computed(()=>P("multiple",r.value.Status,1)),d=e.ref({}),o=e.ref([]),l=e.computed(()=>a.value.filter(n=>!n.Deleted)),r=e.ref({}),a=e.ref([]),s=e.computed({get:()=>!!l.value.length,set:n=>{n?p():a.value.forEach(N=>N.Deleted=!0)}}),p=()=>a.value.push({}),i=n=>n.Deleted=!0,b=n=>{if(d.value={},n&&!h()){e.nextTick(()=>{var m;return(m=document.querySelector(".invalid"))==null?void 0:m.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:r.value,Contacts:u.value,ReceivedSubsidies:a.value.filter(m=>m.ID||!m.Deleted),Submit:n?"true":"false"};S.multiple("saveApplication",N).subscribe(m=>{n?window.location.href=`WorkSchedule.aspx?ID=${m.ID}`:r.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${m.ID}`})},h=()=>{let n={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return d.value=U(r.value,n),n={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},u.value.forEach((N,m)=>Object.assign(d.value,U(N,n,`contact-${m}-`))),n={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},a.value.forEach((N,m)=>Object.assign(d.value,U(N,n,`received-${m}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getZgsCodes",{CodeGroup:"MULField"}),S.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(n=>{o.value=n[0],E.value=n[1],g.id?S.multiple("getApplication",{ID:g.id}).subscribe(N=>{r.value=N.Project,u.value=N.Contacts,a.value=N.ReceivedSubsidies,r.value.OrgCategory=r.value.OrgCategory||null,I().init("multiple",r.value)}):S.multiple("getEmptyApplication").subscribe(N=>{r.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},N),u.value=[{Role:"負責人"},{Role:"聯絡人"}],I().init("multiple",r.value)})})}),e.provide("editable",V),(n,N)=>{const m=e.resolveComponent("required-label"),t=e.resolveComponent("input-text"),c=e.resolveComponent("input-select"),f=e.resolveComponent("input-textarea"),D=e.resolveComponent("input-boolean"),_=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ci,[N[38]||(N[38]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",mi,[e.createElementVNode("table",Vi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[13]||(N[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).Year),1)]),e.createElementVNode("tr",null,[N[14]||(N[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(r).ProjectID?(e.openBlock(),e.createElementBlock("span",pi,e.toDisplayString(e.unref(r).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",fi,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[N[15]||(N[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[16]||(N[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).ProjectName,modelValue:e.unref(r).ProjectName,"onUpdate:modelValue":N[0]||(N[0]=T=>e.unref(r).ProjectName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[17]||(N[17]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{"empty-value":null,error:e.unref(d).Field,options:e.unref(o),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).Field,"onUpdate:modelValue":N[1]||(N[1]=T=>e.unref(r).Field=T)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[18]||(N[18]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(r).OrgName,"onUpdate:modelValue":N[2]||(N[2]=T=>e.unref(r).OrgName=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[19]||(N[19]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(c,{"empty-value":null,error:e.unref(d).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).OrgCategory,"onUpdate:modelValue":N[3]||(N[3]=T=>e.unref(r).OrgCategory=T)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[20]||(N[20]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).TaxID,"max-length":8,modelValue:e.unref(r).TaxID,"onUpdate:modelValue":N[4]||(N[4]=T=>e.unref(r).TaxID=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[21]||(N[21]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d).Address,placeholder:"請輸入地址",modelValue:e.unref(r).Address,"onUpdate:modelValue":N[5]||(N[5]=T=>e.unref(r).Address=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),N[39]||(N[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Ni,[e.createElementVNode("table",ui,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),(T,x)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(T.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ei,[e.createElementVNode("div",bi,[e.createElementVNode("div",ki,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[22]||(N[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-Name`],modelValue:T.Name,"onUpdate:modelValue":w=>T.Name=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",gi,[e.createElementVNode("div",yi,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[23]||(N[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-JobTitle`],modelValue:T.JobTitle,"onUpdate:modelValue":w=>T.JobTitle=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",hi,[N[24]||(N[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",$i,[e.createElementVNode("div",xi,[e.createVNode(t,{modelValue:T.Phone,"onUpdate:modelValue":w=>T.Phone=w,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Bi,[e.createVNode(t,{placeholder:"請輸入分機",size:"4",modelValue:T.PhoneExt,"onUpdate:modelValue":w=>T.PhoneExt=w,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",Ci,[e.createElementVNode("div",_i,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[25]||(N[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-MobilePhone`],modelValue:T.MobilePhone,"onUpdate:modelValue":w=>T.MobilePhone=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ti,[e.createElementVNode("div",wi,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[26]||(N[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(t,{error:e.unref(d)[`contact-${x}-EMail`],modelValue:T.EMail,"onUpdate:modelValue":w=>T.EMail=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),N[40]||(N[40]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Di,[e.createElementVNode("table",Si,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[27]||(N[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[N[28]||(N[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(f,{error:e.unref(d).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(r).Target,"onUpdate:modelValue":N[6]||(N[6]=T=>e.unref(r).Target=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[29]||(N[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(r).Summary,"onUpdate:modelValue":N[7]||(N[7]=T=>e.unref(r).Summary=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[30]||(N[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Quantified,"onUpdate:modelValue":N[8]||(N[8]=T=>e.unref(r).Quantified=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(m,null,{default:e.withCtx(()=>[...N[31]||(N[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Qualitative,"onUpdate:modelValue":N[9]||(N[9]=T=>e.unref(r).Qualitative=T),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Ui,[e.createElementVNode("table",Ai,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[N[37]||(N[37]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(D,{modelValue:e.unref(s),"onUpdate:modelValue":N[10]||(N[10]=T=>e.isRef(s)?s.value=T:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Oi,[e.createElementVNode("table",Mi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[32]||(N[32]=e.createElementVNode("th",null,"計畫名稱",-1)),N[33]||(N[33]=e.createElementVNode("th",null,"補助單位",-1)),N[34]||(N[34]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ii,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(T,x)=>(e.openBlock(),e.createElementBlock("tr",{key:T},[e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d)[`received-${x}-Name`],modelValue:T.Name,"onUpdate:modelValue":w=>T.Name=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(d)[`received-${x}-Unit`],modelValue:T.Unit,"onUpdate:modelValue":w=>T.Unit=w,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`received-${x}-Amount`],modelValue:T.Amount,"onUpdate:modelValue":w=>T.Amount=w},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Fi,[e.createElementVNode("div",ji,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:w=>i(T),type:"button"},[...N[35]||(N[35]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Pi)):e.createCommentVNode("",!0),x+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:p,type:"button"},[...N[36]||(N[36]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",qi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[11]||(N[11]=T=>b()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[12]||(N[12]=T=>b(!0)),type:"button"},[...N[41]||(N[41]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Ri={class:"block"},zi={key:0,class:"text-pink lh-base mt-4"},Ji={class:"mt-4"},Gi={class:"table align-middle gray-table"},Qi={class:"text-center"},Wi={key:0,width:"180"},Yi={class:"text-center"},Hi={key:0},Zi=["innerHTML"],Ki={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Xi={key:0,class:"text-center"},vi={key:0},ec={key:1,class:"text-pink"},tc={key:1,class:"tag-group mt-2 gap-1"},lc={key:0,class:"tag tag-green-light"},oc=["download","href"],nc=["onClick"],rc={key:0,class:"block-bottom bg-light-teal"},ac=["disabled"],dc={__name:"Attachment",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),u=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),V=e.computed(()=>P("multiple",d.value.Status,2)),d=e.ref({}),o=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:d.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},l=S.download,r=a=>{const s={ID:g.id,Attachments:E.value.reduce((p,i)=>p.concat(i.Files),[]),Submit:a?"true":"false"};S.multiple("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getAttachment",{ID:g.id})]).subscribe(a=>{const s=a[0];d.value=s.Project,E.value=E.value.filter(p=>{var i;return!((i=p.Excludes)!=null&&i.includes(d.value.OrgCategory))}),d.value.Status>=10&&E.value.push({Type:6,Title:"著作權授權同意書",Template:!0,Files:[]}),E.value.forEach(p=>{p.Files=s.Attachments.filter(i=>i.Type===p.Type),p.Uploaded=e.computed(()=>p.Files.filter(i=>!i.Deleted).length)}),I().init("multiple",d.value)})}),e.provide("editable",V),(a,s)=>{const p=e.resolveComponent("required-label"),i=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ri,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("p",zi,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Ji,[e.createElementVNode("table",Gi,[e.createElementVNode("thead",Qi,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Wi,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(b,h)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",Yi,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[b.Optional?(e.openBlock(),e.createElementBlock("span",Hi,e.toDisplayString(b.Title),1)):(e.openBlock(),e.createBlock(p,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Title),1)]),_:2},1024))]),e.unref(V)&&b.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:b.Comment},null,8,Zi)):e.createCommentVNode("",!0),e.unref(V)&&b.Template?(e.openBlock(),e.createElementBlock("button",Ki,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Xi,[b.Uploaded?(e.openBlock(),e.createElementBlock("span",vi,"已上傳")):(e.openBlock(),e.createElementBlock("span",ec,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(V)&&(b.Multiple||!b.Uploaded)?(e.openBlock(),e.createBlock(i,{key:0,accept:".pdf",onFile:n=>o(b,n)},null,8,["onFile"])):e.createCommentVNode("",!0),b.Uploaded?(e.openBlock(),e.createElementBlock("div",tc,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.Files,n=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:n},[n.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",lc,[e.createElementVNode("a",{class:"tag-link my-1",download:n.Name,href:e.unref(l)(n.Path)},e.toDisplayString(n.Name),9,oc),e.unref(V)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:N=>n.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,nc)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",rc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=b=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=b=>r(!0)),disabled:e.unref(u),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ac)])):e.createCommentVNode("",!0)],64)}}},sc={class:"block"},ic={class:"mt-4"},cc={class:"table-responsive mt-3 mb-0"},mc={class:"table align-middle gray-table"},Vc={key:0,width:"1"},pc={key:0},fc={class:"d-flex gap-2"},Nc=["onClick"],uc={class:"table-responsive mt-3 mb-0"},Ec={class:"table align-middle gray-table"},bc={key:0,class:"block-bottom bg-light-teal"},kc={__name:"Benefit",props:{id:{type:Number}},setup(y){const g=y,E=e.ref([]),u=e.computed(()=>P("multiple",o.value.Status,4)),V=e.ref({}),d=e.computed(()=>E.value.filter(p=>!p.Deleted)),o=e.ref({}),l=()=>E.value.push({}),r=p=>p.Deleted=!0,a=p=>{if(V.value={},p&&!s()){e.nextTick(()=>{var b;return(b=document.querySelector(".invalid"))==null?void 0:b.scrollIntoView({behavior:"smooth",block:"center"})});return}const i={Project:o.value,Benefits:E.value,Submit:p?"true":"false"};S.multiple("saveBenefit",i).subscribe(()=>{p?window.location.href=`Attachment.aspx?ID=${g.id}`:window.location.reload()})},s=()=>{let p={Benefit:"不可量化成果"};return V.value=U(o.value,p),p={Title:"指標",Target:"目標值",Description:"說明"},d.value.forEach((i,b)=>Object.assign(V.value,U(i,p,`item-${b}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getBenefit",{ID:g.id})]).subscribe(p=>{const i=p[0];o.value=i.Project,E.value=i.Benefits,E.value.length||l(),I().init("multiple",o.value)})}),e.provide("editable",u),(p,i)=>{const b=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",sc,[i[9]||(i[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",ic,[e.createElementVNode("div",cc,[e.createElementVNode("table",mc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[i[3]||(i[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),i[4]||(i[4]=e.createElementVNode("th",null,"目標值",-1)),i[5]||(i[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(u)?(e.openBlock(),e.createElementBlock("th",Vc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(n,N)=>(e.openBlock(),e.createElementBlock("tr",{key:n},[e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Title`],modelValue:n.Title,"onUpdate:modelValue":m=>n.Title=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(b,{error:e.unref(V)[`item-${N}-Target`],modelValue:n.Target,"onUpdate:modelValue":m=>n.Target=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`item-${N}-Description`],rows:"1",modelValue:n.Description,"onUpdate:modelValue":m=>n.Description=m,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(u)?(e.openBlock(),e.createElementBlock("td",pc,[e.createElementVNode("div",fc,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:m=>r(n),type:"button"},[...i[6]||(i[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Nc)):e.createCommentVNode("",!0),N+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:l,type:"button"},[...i[7]||(i[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",uc,[e.createElementVNode("table",Ec,[i[8]||(i[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V).Benefit,rows:"4",modelValue:e.unref(o).Benefit,"onUpdate:modelValue":i[0]||(i[0]=n=>e.unref(o).Benefit=n),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",bc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:i[1]||(i[1]=n=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:i[2]||(i[2]=n=>a(!0)),type:"button"},[...i[10]||(i[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},gc={class:"block"},yc={class:"mt-4"},hc={class:"table-responsive mt-3 mb-0"},$c={class:"table align-middle gray-table"},xc={class:"text-end"},Bc={class:"text-end"},Cc={class:"table-responsive"},_c={class:"table align-middle gray-table"},Tc=["colspan"],wc={key:0,width:"1"},Dc={class:"text-end"},Sc={key:0},Uc={class:"d-flex gap-2"},Ac=["onClick"],Oc={class:"mt-4"},Mc={class:"table-responsive mt-3 mb-0"},Ic={class:"table align-middle gray-table"},Fc={key:0,width:"1"},jc={class:"text-end"},Pc={key:0},qc={class:"d-flex gap-2"},Lc=["onClick"],Rc={key:0,class:"block-bottom bg-light-teal"},zc={class:"text-center"},Jc={class:"mb-5"},Gc={__name:"Funding",props:{id:{type:Number}},setup(y){const g=y,E=e.computed(()=>P("multiple",o.value.Status,3)),u=e.ref({}),V=e.computed(()=>r.value.filter(m=>!m.Deleted)),d=e.computed(()=>a.value.filter(m=>!m.Deleted)),o=e.ref({}),l=e.ref(),r=e.ref([]),a=e.ref([]),s=e.ref({}),p=e.ref(0),i=()=>r.value.push({}),b=()=>a.value.push({}),h=m=>m.Deleted=!0,n=(m,t)=>{if(u.value={},m&&!N()){e.nextTick(()=>{var f;return(f=document.querySelector(".invalid"))==null?void 0:f.scrollIntoView({behavior:"smooth",block:"center"})});return}if(!t&&o.value.ApplyAmount>s.value.GrantLimit*1e4){l.value.show(()=>n(m,!0));return}const c={Project:o.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:m?"true":"false"};S.multiple("saveFunding",c).subscribe(()=>{m?window.location.href=`Benefit.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return u.value=U(o.value,m),m={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},r.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`other-${c}-`))),m={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((t,c)=>Object.assign(u.value,U(t,m,`plan-${c}-`))),!Object.keys(u.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getFunding",{ID:g.id})]).subscribe(m=>{const t=m[0];o.value=t.Project,r.value=t.OtherSubsidies,a.value=t.BudgetPlans,s.value=t.GrantTargetSetting,r.value.length||i(),a.value.length||b(),I().init("multiple",o.value)})}),e.provide("editable",E),e.watchEffect(()=>{o.value.OtherAmount=V.value.reduce((m,t)=>m+F(t.Amount),0),p.value=F(o.value.ApplyAmount)+F(o.value.SelfAmount)+F(o.value.OtherAmount),V.value.forEach(m=>m.percent=Math.round(F(m.Amount)/o.value.OtherAmount*1e4)/100),a.value.forEach(m=>m.sum=F(m.Amount)+F(m.OtherAmount))}),(m,t)=>{var T;const c=e.resolveComponent("input-integer"),f=e.resolveComponent("input-text"),D=e.resolveComponent("input-textarea"),_=e.resolveComponent("confirm-modal");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",gc,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",yc,[e.createElementVNode("div",hc,[e.createElementVNode("table",$c,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(o).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(o).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",xc,e.toDisplayString((T=e.unref(o).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",Bc,e.toDisplayString(e.unref(p).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",Cc,[e.createElementVNode("table",_c,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Tc)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",wc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(w+1),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`other-${w}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":k=>x.Unit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`other-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Dc,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`other-${w}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":k=>x.Content=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Sc,[e.createElementVNode("div",Uc,[e.unref(V).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ac)):e.createCommentVNode("",!0),w+1===e.unref(V).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Oc,[e.createElementVNode("div",Mc,[e.createElementVNode("table",Ic,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Fc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(x,w)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(u)[`plan-${w}-Title`],modelValue:x.Title,"onUpdate:modelValue":k=>x.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":k=>x.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(c,{error:e.unref(u)[`plan-${w}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":k=>x.OtherAmount=k},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",jc,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(D,{error:e.unref(u)[`plan-${w}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":k=>x.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Pc,[e.createElementVNode("div",qc,[e.unref(d).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:k=>h(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Lc)):e.createCommentVNode("",!0),w+1===e.unref(d).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Rc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>n(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0),e.createVNode(_,{ref_key:"modal",ref:l},{default:e.withCtx(()=>[e.createElementVNode("div",zc,[t[23]||(t[23]=e.createElementVNode("div",{class:"mb-3"},"［提醒您］",-1)),e.createElementVNode("div",Jc,"您申請的補助款經費總計，已超過補助原則上限："+e.toDisplayString(e.unref(s).GrantLimit)+"萬",1),t[24]||(t[24]=e.createElementVNode("div",{class:"mb-2"},"繼續申請請按【確定】",-1)),t[25]||(t[25]=e.createElementVNode("div",null,"返回調整請按【取消】",-1))])]),_:1},512)],64)}}},Qc={__name:"ProgressBar",setup(y){const g=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,u)=>{const V=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(V,{steps:g,type:"multiple"})}}},Wc={class:"block"},Yc={class:"mt-4"},Hc={class:"table align-middle gray-table side-table"},Zc={key:0,class:"d-flex align-items-center gap-2"},Kc={class:"input-group w-auto"},Xc={class:"text-teal-dark"},vc={key:1,class:"invalid mt-0"},em={class:"table-responsive mt-4"},tm={class:"table align-middle gray-table"},lm={key:0},om={class:"input-group"},nm={key:0,class:"invalid mt-0"},rm={key:0},am={class:"d-flex gap-2"},dm=["onClick"],sm={class:"mt-4"},im={class:"table align-middle gray-table"},cm={key:0},mm={key:0},Vm={class:"d-flex gap-2"},pm=["onClick"],fm={key:0,class:"block-bottom bg-light-teal"},Nm={__name:"WorkSchedule",props:{id:{type:Number}},setup(y){const g=y,E=[{value:1,text:"50%"},{value:2,text:"100%"}],u=e.computed(()=>a.value.EndDate),V=e.computed(()=>P("multiple",r.value.Status,2)),d=e.ref({}),o=e.computed(()=>s.value.filter(m=>!m.Deleted)),l=e.computed(()=>p.value.filter(m=>!m.Deleted)),r=e.ref({}),a=e.ref({}),s=e.ref([]),p=e.ref([]),i=()=>S.multiple("createItem",{ID:g.id}).subscribe(m=>s.value.push(m)),b=()=>p.value.push({Type:0,ItemID:0}),h=m=>m.Deleted=!0,n=m=>{if(d.value={},m&&!N()){e.nextTick(()=>{var c;return(c=document.querySelector(".invalid"))==null?void 0:c.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Items:s.value,Schedules:p.value,Submit:m?"true":"false"};S.multiple("saveWorkSchedule",t).subscribe(()=>{m?window.location.href=`Funding.aspx?ID=${g.id}`:window.location.reload()})},N=()=>{let m={StartTime:"計畫期程",EndTime:"計畫期程"};return d.value=U(r.value,m),m={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},o.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`item-${c}-`))),m={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},l.value.forEach((t,c)=>Object.assign(d.value,U(t,m,`schedule-${c}-`))),!Object.keys(d.value).length};return e.onMounted(()=>{rxjs.forkJoin([S.multiple("getWorkSchedule",{ID:g.id})]).subscribe(m=>{const t=m[0];r.value=t.Project,a.value=t.GrantType,s.value=t.Items,p.value=t.Schedules,s.value.length||i(),p.value.length||b(),I().init("multiple",r.value)})}),e.provide("editable",V),(m,t)=>{const c=e.resolveComponent("required-label"),f=e.resolveComponent("input-tw-date"),D=e.resolveComponent("tw-date"),_=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),w=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wc,[t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Yc,[e.createElementVNode("table",Hc,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.unref(u)?(e.openBlock(),e.createElementBlock("div",Zc,[e.createElementVNode("div",Kc,[e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(r).StartTime,"onUpdate:modelValue":t[0]||(t[0]=k=>e.unref(r).StartTime=k)},null,8,["max-date","modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(f,{class:"w-auto","max-date":e.unref(u),modelValue:e.unref(r).EndTime,"onUpdate:modelValue":t[1]||(t[1]=k=>e.unref(r).EndTime=k)},null,8,["max-date","modelValue"])]),e.createElementVNode("span",Xc,[t[6]||(t[6]=e.createTextVNode("(期程不可超過 ",-1)),e.createVNode(D,{value:e.unref(u)},null,8,["value"]),t[7]||(t[7]=e.createTextVNode(")",-1))])])):e.createCommentVNode("",!0),e.unref(d).StartTime||e.unref(d).EndTime?(e.openBlock(),e.createElementBlock("div",vc,e.toDisplayString(e.unref(d).StartTime||e.unref(d).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",em,[e.createElementVNode("table",tm,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[12]||(t[12]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[11]||(t[11]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",lm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+B)),1),e.createElementVNode("td",null,[e.createVNode(_,{error:e.unref(d)[`item-${B}-Title`],modelValue:k.Title,"onUpdate:modelValue":C=>k.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",om,[e.createVNode(T,{"empty-value":0,modelValue:k.Begin,"onUpdate:modelValue":C=>k.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:k.End,"onUpdate:modelValue":C=>k.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]?(e.openBlock(),e.createElementBlock("div",nm,e.toDisplayString(e.unref(d)[`item-${B}-Begin`]||e.unref(d)[`item-${B}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`item-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`item-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",rm,[e.createElementVNode("div",am,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,dm)):e.createCommentVNode("",!0),B+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:i,type:"button"},[...t[14]||(t[14]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[24]||(t[24]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",sm,[e.createElementVNode("table",im,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[19]||(t[19]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(c,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",cm,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),(k,B)=>(e.openBlock(),e.createElementBlock("tr",{key:k},[e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-Type`],options:E,modelValue:k.Type,"onUpdate:modelValue":C=>k.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(w,{"empty-value":0,error:e.unref(d)[`schedule-${B}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:k.ItemID,"onUpdate:modelValue":C=>k.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(k.ItemID?String.fromCharCode(65+e.unref(o).findIndex(C=>C.ID===k.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(f,{error:e.unref(d)[`schedule-${B}-Deadline`],modelValue:k.Deadline,"onUpdate:modelValue":C=>k.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(d)[`schedule-${B}-Content`],rows:"1",modelValue:k.Content,"onUpdate:modelValue":C=>k.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",mm,[e.createElementVNode("div",Vm,[e.unref(l).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>h(k),type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pm)):e.createCommentVNode("",!0),B+1===e.unref(l).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:b,type:"button"},[...t[21]||(t[21]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",fm,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=k=>n()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=k=>n(!0)),type:"button"},[...t[25]||(t[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},um={key:0,class:"scroll-bottom-panel"},Em={class:"d-flex flex-column gap-3 mb-3"},bm={class:"d-flex gap-2"},km={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},gm={class:"text-nowrap my-2 d-flex align-items-center"},ym={__name:"ProjectCorrectionReview",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,E=I(),u=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回修改"}],V=e.ref({}),d=e.ref({ID:g.id,Result:1}),o=()=>{const r={};if(d.value.Result>1&&(r.Reason="原因"),V.value=U(d.value,r),Object.keys(V.value).length){l();return}S[g.type]("reviewApplication",d.value).subscribe(a=>{})},l=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>d.value.Result,r=>{r>1&&l()}),(r,a)=>{const s=e.resolveComponent("input-radio-group"),p=e.resolveComponent("input-textarea");return e.unref(E)[y.type].organizer?(e.openBlock(),e.createElementBlock("div",um,[a[3]||(a[3]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Em,[e.createElementVNode("li",bm,[a[2]||(a[2]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",km,[e.createElementVNode("div",gm,[e.createVNode(s,{options:u,modelValue:e.unref(d).Result,"onUpdate:modelValue":a[0]||(a[0]=i=>e.unref(d).Result=i)},null,8,["modelValue"])]),e.unref(d).Result>1?(e.openBlock(),e.createBlock(p,{key:0,error:e.unref(V).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(d).Reason,"onUpdate:modelValue":a[1]||(a[1]=i=>e.unref(d).Reason=i)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:o,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},hm={class:"d-flex align-items-center gap-3"},$m={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},xm={class:"modal-content"},Bm={class:"modal-header"},Cm={class:"fs-24 fw-bold text-green-light"},_m={class:"modal-body"},Tm={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},wm=["disabled"],Dm={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,E=e.computed(()=>!d.value||d.value===l[g.type].organizer),u=e.ref(),V=e.computed(()=>l[g.type].organizerName),d=e.ref(0),o=e.computed(()=>{var b;return(b=s.value.find(h=>h.UnitID===a.value))==null?void 0:b.reviewers}),l=I(),r=e.computed(()=>V.value?"移轉案件":"認領案件"),a=e.ref(0),s=e.ref([]),p=()=>{S[g.type]("queryReviewUnits").subscribe(b=>{s.value=b,rxjs.forkJoin(s.value.map(h=>S[g.type]("queryReviewersByUnit",{ID:h.UnitID}))).subscribe(h=>{h.forEach((n,N)=>{s.value[N].reviewers=n,n.some(m=>m.UserID===d.value)&&(a.value=s.value[N].UnitID)}),bootstrap.Modal.getOrCreateInstance(u.value).show()})})},i=()=>{S[g.type]("saveOrganizer",{ID:g.id,Organizer:d.value}).subscribe(b=>{b&&window.location.reload()})};return e.watch(V,()=>d.value=l[g.type].organizer),e.watch(a,()=>{o.value.some(b=>b.UserID===d.value)||(d.value=0)}),(b,h)=>{const n=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hm,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(V)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:p,type:"button"},e.toDisplayString(e.unref(r)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:u,tabindex:"-1"},[e.createElementVNode("div",$m,[e.createElementVNode("div",xm,[e.createElementVNode("div",Bm,[e.createElementVNode("h4",Cm,e.toDisplayString(e.unref(r)),1),h[2]||(h[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",_m,[e.createElementVNode("div",null,[h[3]||(h[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(n,{"empty-value":0,options:e.unref(s),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(a),"onUpdate:modelValue":h[0]||(h[0]=N=>e.isRef(a)?a.value=N:null)},null,8,["options","modelValue"]),e.createVNode(n,{class:"mt-2","empty-value":0,options:e.unref(o),"text-name":"Name","value-name":"UserID",modelValue:e.unref(d),"onUpdate:modelValue":h[1]||(h[1]=N=>e.isRef(d)?d.value=N:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",Tm,[h[4]||(h[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:i,disabled:e.unref(E),type:"button"},"確認",8,wm)])])])])],512)]))],64)}}},Sm={},Um={class:"step-line-wrapper"};function Am(y,g){return e.openBlock(),e.createElementBlock("div",Um,[...g[0]||(g[0]=[e.createStaticVNode('<a href="#" class="step-line" style="gap:24px;"><div class="step-line-item active"><div class="step-line-item-title">核定計畫</div><div class="tag tag-white">審核中</div></div><div class="step-line-item"><div class="step-line-item-title">契約資料</div></div></a><a href="#" class="step-line"><div class="step-line-item"><div class="step-line-item-title">預定進度</div></div><div class="step-line-item"><div class="step-line-item-title">每月進度</div></div></a><a href="#" class="step-line"><div class="step-line-item"><div class="step-line-item-title">階段報告</div></div><div class="step-line-item"><div class="step-line-item-title">請款核銷</div></div></a>',3)])])}const Om=Q(Sm,[["render",Am]]),Mm={key:0,class:"scroll-bottom-panel"},Im={class:"d-flex flex-column gap-3 mb-3"},Fm={class:"d-flex gap-2"},jm={class:"d-flex flex-column gap-2 align-items-start flex-grow-1 checkPass"},Pm={class:"text-nowrap mb-2 d-flex align-items-center"},qm={key:0,class:"invalid mt-0"},Lm={__name:"ProjectReview",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,E=I(),u=[{value:1,text:"通過"},{value:2,text:"不通過"},{value:3,text:"退回補正補件"}],V=e.ref({}),d=e.ref({ID:g.id,Result:1}),o=()=>{},l=()=>{},r=()=>{const s={};if(d.value.Result>1&&(s.Reason="原因"),d.value.Result===3&&(s.CorrectionDeadline="補正期限"),V.value=U(d.value,s),Object.keys(V.value).length){a();return}S[g.type]("reviewApplication",d.value).subscribe(p=>{})},a=()=>setTimeout(()=>document.querySelector(".mis-content").scrollTop=1e6);return e.watch(()=>d.value.Result,s=>{s>1&&a()}),(s,p)=>{const i=e.resolveComponent("input-radio-group"),b=e.resolveComponent("input-tw-date"),h=e.resolveComponent("input-textarea");return e.unref(E)[y.type].organizer?(e.openBlock(),e.createElementBlock("div",Mm,[p[9]||(p[9]=e.createElementVNode("h5",{class:"text-pink fs-18 fw-bold mb-3"},"審查結果",-1)),e.createElementVNode("ul",Im,[e.createElementVNode("li",{class:"d-flex gap-2"},[p[3]||(p[3]=e.createElementVNode("span",{class:"text-gray"},"同單位申請計畫數 :",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:o,href:"javascript:void(0)"},"3")]),e.createElementVNode("li",{class:"d-flex gap-2"},[p[6]||(p[6]=e.createElementVNode("span",{class:"text-gray"},"風險評估 :",-1)),p[7]||(p[7]=e.createElementVNode("span",{class:"text-pink"},"中風險",-1)),e.createElementVNode("span",null,[p[4]||(p[4]=e.createTextVNode("( ",-1)),e.createElementVNode("a",{class:"link-teal fw-bold",onClick:l,href:"javascript:void(0)"},"1"),p[5]||(p[5]=e.createTextVNode(" 筆記錄 )",-1))])]),e.createElementVNode("li",Fm,[p[8]||(p[8]=e.createElementVNode("span",{class:"text-gray mt-2"},"審查結果：",-1)),e.createElementVNode("div",jm,[e.createElementVNode("div",Pm,[e.createVNode(i,{options:u,modelValue:e.unref(d).Result,"onUpdate:modelValue":p[0]||(p[0]=n=>e.unref(d).Result=n)},null,8,["modelValue"]),e.createVNode(b,{class:"form-control",drops:"up",modelValue:e.unref(d).CorrectionDeadline,"onUpdate:modelValue":p[1]||(p[1]=n=>e.unref(d).CorrectionDeadline=n)},null,8,["modelValue"])]),e.unref(V).CorrectionDeadline?(e.openBlock(),e.createElementBlock("div",qm,e.toDisplayString(e.unref(V).CorrectionDeadline),1)):e.createCommentVNode("",!0),e.unref(d).Result>1?(e.openBlock(),e.createBlock(h,{key:1,error:e.unref(V).Reason,placeholder:"請輸入原因",rows:"4",modelValue:e.unref(d).Reason,"onUpdate:modelValue":p[2]||(p[2]=n=>e.unref(d).Reason=n)},null,8,["error","modelValue"])):e.createCommentVNode("",!0)])])]),e.createElementVNode("button",{class:"btn btn-teal d-table mx-auto",onClick:r,type:"button"},"確定")])):e.createCommentVNode("",!0)}}},Rm={class:"top-wrapper"},zm={class:"top-block"},Jm={class:"d-flex align-items-center gap-3"},Gm={__name:"ProjectTitle",props:{id:{type:Number},type:{type:String}},setup(y){const g=y,E=I();return(u,V)=>(e.openBlock(),e.createElementBlock("div",Rm,[e.createElementVNode("div",zm,[e.createElementVNode("div",Jm,[e.createElementVNode("span",null,"［"+e.toDisplayString(e.unref(E)[g.type].type)+"］"+e.toDisplayString(e.unref(E)[g.type].id)+"/"+e.toDisplayString(e.unref(E)[g.type].name),1)]),V[0]||(V[0]=e.createElementVNode("button",{class:"btn btn-teal-dark",type:"button"}," 查核紀錄 ",-1))])]))}},Qm={};function Wm(y,g){return g[0]||(g[0]=e.createStaticVNode('<div class="block rounded-top-4 py-4 d-flex justify-content-between" style="position:sticky;top:180px;z-index:15;"><div class="d-flex gap-2"><button class="btn text-teal-dark" type="button"> 計畫變更申請中 </button><button class="btn btn-teal-dark" type="button" data-bs-toggle="modal" data-bs-target="#changePlanRecordModal"> 計畫變更申請 </button><button class="btn btn-teal-dark" type="button" data-bs-toggle="modal" data-bs-target="#changePlanRecordModal"><i class="fas fa-history"></i> 計畫變更紀錄 </button><a href="#" class="btn btn-teal-dark" target="_blank"><i class="fa-solid fa-download"></i> 下載核定計畫書 </a></div><div class="d-flex gap-2"><button class="btn btn-pink" type="button" data-bs-toggle="modal" data-bs-target="#planStopModal"> 計畫終止 </button></div></div><div class="modal fade" id="changePlanRecordModal" tabindex="-1" data-bs-backdrop="static" aria-labelledby="changePlanRecordModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl"><div class="modal-content"><div class="modal-header"><h4 class="fs-24 text-green-light fw-bold">計畫變更紀錄</h4><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-circle-xmark"></i></button></div><div class="modal-body"><div class="table-responsive"><table class="table align-middle gray-table lh-base"><thead><tr><th width="150">版次</th><th width="150">變更時間</th><th>變更者</th><th>變更原因</th><th>變更前</th><th>變更後</th></tr></thead><tbody><tr><td>核定版</td><td>114/04/10</td><td>劉申慶</td><td>意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容意見內容</td><td>【期程／工作項目／查核】<br> 1.OO資料，原為OOOOOOOO<br> 2.OO資料，原為OOOOOOOO </td><td>【期程／工作項目／查核】<br> 1.OO資料，原為OOOOOOOO<br> 2.OO資料，原為OOOOOOOO </td></tr></tbody></table></div></div></div></div></div>',2))}const Ym=Q(Qm,[["render",Wm]]),Hm={key:0,class:"text-pink"},K={AccessibilityApplication:Qe,AccessibilityAttachment:Vt,AccessibilityBenefit:xt,AccessibilityFunding:Zt,AccessibilityProgressBar:Kt,AccessibilityWorkSchedule:gl,ConfirmModal:Cl,CommonProgressBar:Al,CultureApplication:uo,CultureAttachment:Io,CultureFunding:dn,CultureOther:hn,CultureProgressBar:$n,CultureWorkSchedule:pr,EducationApplication:oa,EducationAttachment:$a,EducationProgressBar:xa,ErrorModal:Da,InputBoolean:Sa,InputFile:Ua,InputInteger:Ma,InputMonth:Ia,InputRadioGroup:Pa,InputSelect:Ja,InputText:Ha,InputTextarea:ed,InputTwDate:od,LiteracyApplication:Md,LiteracyAttachment:ts,LiteracyBenefit:ps,LiteracyFunding:Ps,LiteracyProgressBar:qs,LiteracyWorkSchedule:ii,MultipleApplication:Li,MultipleAttachment:dc,MultipleBenefit:kc,MultipleFunding:Gc,MultipleProgressBar:Qc,MultipleWorkSchedule:Nm,ProjectCorrectionReview:ym,ProjectOrganizer:Dm,ProjectProgress:Om,ProjectReview:Lm,ProjectTitle:Gm,ProjectToolbar:Ym,RequiredLabel:{__name:"RequiredLabel",setup(y){const g=e.inject("editable",!0);return(E,u)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(g)?(e.openBlock(),e.createElementBlock("span",Hm,"* ")):e.createCommentVNode("",!0),e.renderSlot(E.$slots,"default")],64))}},TwDate:{__name:"TwDate",props:{value:{default:null,type:String}},setup(y){const g=y,E=V=>{const d=V==null?void 0:V.match(/^(\d+)[\/-](\d+)[\/-](\d+)/);return d?`${parseInt(d[1],10)-1911}/${d[2]}/${d[3]}`:""},u=e.ref(E(g.value));return e.watch(()=>g.value,V=>u.value=E(V)),(V,d)=>(e.openBlock(),e.createElementBlock("span",null,e.toDisplayString(e.unref(u)),1))}}};return{install:y=>{for(const g in K)y.component(g,K[g])},useProgressStore:I}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
