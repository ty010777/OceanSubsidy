(function(e,z){typeof exports=="object"&&typeof module<"u"?module.exports=z(require("vue"),require("pinia")):typeof define=="function"&&define.amd?define(["vue","pinia"],z):(e=typeof globalThis<"u"?globalThis:e||self,e.OceanSubsidyComponents=z(e.Vue,e.Pinia))})(this,(function(e,z){"use strict";let Y=Date.now();const I=(B,y,E)=>y===1,H=()=>`id--${Y++}`,F=B=>parseInt(B)||0,R=z.defineStore("message",{state:()=>({error:null})}),{ajax:Z}=rxjs.ajax,{map:K}=rxjs;let J="";const X=(B,y={})=>P("Service/OFS/Accessibility.ashx",{method:B,param:y}),v=(B,y={})=>P("Service/OFS/Culture.ashx",{method:B,param:y}),ee=B=>`${J}/Service/OFS/Download.ashx?path=${B}`,te=(B,y={})=>P("Service/OFS/Education.ashx",{method:B,param:y}),le=(B,y={})=>P("Service/OFS/Literacy.ashx",{method:B,param:y}),oe=(B,y={})=>P("Service/OFS/Multiple.ashx",{method:B,param:y}),ne=({response:B,status:y})=>{if(y===200){if(B.success)return B.data;R().error=B.message}},P=(B,y={})=>{const E={};y.constructor!==FormData&&(E["Content-Type"]="application/json");const V={body:y,headers:E,method:"POST",url:`${J}/${B}`};return Z(V).pipe(K(ne))},w=Object.assign(P,{accessibility:X,culture:v,download:ee,education:te,literacy:le,multiple:oe,upload:B=>{const y=new FormData;return y.append("file",B),P("Service/OFS/Upload.ashx",y)}});function re(B){return B&&B.__esModule&&Object.prototype.hasOwnProperty.call(B,"default")?B.default:B}var q={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */var ae=q.exports,Q;function de(){return Q||(Q=1,(function(B,y){(function(E,V,c){var m=function(o,r,a){a=n.extend({},n.options,a);var s=n.runValidations(o,r,a);if(s.some(function(f){return n.isPromise(f.error)}))throw new Error("Use validate.async if you want support for promises");return m.processValidationResults(s,a)},n=m;n.extend=function(o){return[].slice.call(arguments,1).forEach(function(r){for(var a in r)o[a]=r[a]}),o},n.extend(m,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var o=n.format("%{major}.%{minor}.%{patch}",n.version);return n.isEmpty(n.version.metadata)||(o+="+"+n.version.metadata),o}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(o,r,a){var s=[],f,d,u,h,l,t,i;(n.isDomElement(o)||n.isJqueryElement(o))&&(o=n.collectFormValues(o));for(f in r){u=n.getDeepObjectValue(o,f),h=n.result(r[f],u,o,f,a,r);for(d in h){if(l=n.validators[d],!l)throw i=n.format("Unknown validator %{name}",{name:d}),new Error(i);t=h[d],t=n.result(t,u,o,f,a,r),t&&s.push({attribute:f,value:u,validator:d,globalOptions:a,attributes:o,options:t,error:l.call(l,u,t,f,o,a)})}}return s},processValidationResults:function(o,r){o=n.pruneEmptyErrors(o,r),o=n.expandMultipleErrors(o,r),o=n.convertErrorMessages(o,r);var a=r.format||"grouped";if(typeof n.formatters[a]=="function")o=n.formatters[a](o);else throw new Error(n.format("Unknown format %{format}",r));return n.isEmpty(o)?void 0:o},async:function(o,r,a){a=n.extend({},n.async.options,a);var s=a.wrapErrors||function(d){return d};a.cleanAttributes!==!1&&(o=n.cleanAttributes(o,r));var f=n.runValidations(o,r,a);return new n.Promise(function(d,u){n.waitForResults(f).then(function(){var h=n.processValidationResults(f,a);h?u(new s(h,a,o,r)):d(o)},function(h){u(h)})})},single:function(o,r,a){return a=n.extend({},n.single.options,a,{format:"flat",fullMessages:!1}),n({single:o},{single:r},a)},waitForResults:function(o){return o.reduce(function(r,a){return n.isPromise(a.error)?r.then(function(){return a.error.then(function(s){a.error=s||null})}):r},new n.Promise(function(r){r()}))},result:function(o){var r=[].slice.call(arguments,1);return typeof o=="function"&&(o=o.apply(null,r)),o},isNumber:function(o){return typeof o=="number"&&!isNaN(o)},isFunction:function(o){return typeof o=="function"},isInteger:function(o){return n.isNumber(o)&&o%1===0},isBoolean:function(o){return typeof o=="boolean"},isObject:function(o){return o===Object(o)},isDate:function(o){return o instanceof Date},isDefined:function(o){return o!=null},isPromise:function(o){return!!o&&n.isFunction(o.then)},isJqueryElement:function(o){return o&&n.isString(o.jquery)},isDomElement:function(o){return!o||!o.querySelectorAll||!o.querySelector?!1:n.isObject(document)&&o===document?!0:typeof HTMLElement=="object"?o instanceof HTMLElement:o&&typeof o=="object"&&o!==null&&o.nodeType===1&&typeof o.nodeName=="string"},isEmpty:function(o){var r;if(!n.isDefined(o))return!0;if(n.isFunction(o))return!1;if(n.isString(o))return n.EMPTY_STRING_REGEXP.test(o);if(n.isArray(o))return o.length===0;if(n.isDate(o))return!1;if(n.isObject(o)){for(r in o)return!1;return!0}return!1},format:n.extend(function(o,r){return n.isString(o)?o.replace(n.format.FORMAT_REGEXP,function(a,s,f){return s==="%"?"%{"+f+"}":String(r[f])}):o},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(o){return n.isNumber(o)?o*100%1===0?""+o:parseFloat(Math.round(o*100)/100).toFixed(2):n.isArray(o)?o.map(function(r){return n.prettify(r)}).join(", "):n.isObject(o)?n.isDefined(o.toString)?o.toString():JSON.stringify(o):(o=""+o,o.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(r,a,s){return""+a+" "+s.toLowerCase()}).toLowerCase())},stringifyValue:function(o,r){var a=r&&r.prettify||n.prettify;return a(o)},isString:function(o){return typeof o=="string"},isArray:function(o){return{}.toString.call(o)==="[object Array]"},isHash:function(o){return n.isObject(o)&&!n.isArray(o)&&!n.isFunction(o)},contains:function(o,r){return n.isDefined(o)?n.isArray(o)?o.indexOf(r)!==-1:r in o:!1},unique:function(o){return n.isArray(o)?o.filter(function(r,a,s){return s.indexOf(r)==a}):o},forEachKeyInKeypath:function(o,r,a){if(n.isString(r)){var s="",f,d=!1;for(f=0;f<r.length;++f)switch(r[f]){case".":d?(d=!1,s+="."):(o=a(o,s,!1),s="");break;case"\\":d?(d=!1,s+="\\"):d=!0;break;default:d=!1,s+=r[f];break}return a(o,s,!0)}},getDeepObjectValue:function(o,r){if(n.isObject(o))return n.forEachKeyInKeypath(o,r,function(a,s){if(n.isObject(a))return a[s]})},collectFormValues:function(o,r){var a={},s,f,d,u,h,l;if(n.isJqueryElement(o)&&(o=o[0]),!o)return a;for(r=r||{},u=o.querySelectorAll("input[name], textarea[name]"),s=0;s<u.length;++s)if(d=u.item(s),!n.isDefined(d.getAttribute("data-ignored"))){var t=d.name.replace(/\./g,"\\\\.");l=n.sanitizeFormValue(d.value,r),d.type==="number"?l=l?+l:null:d.type==="checkbox"?d.attributes.value?d.checked||(l=a[t]||null):l=d.checked:d.type==="radio"&&(d.checked||(l=a[t]||null)),a[t]=l}for(u=o.querySelectorAll("select[name]"),s=0;s<u.length;++s)if(d=u.item(s),!n.isDefined(d.getAttribute("data-ignored"))){if(d.multiple){l=[];for(f in d.options)h=d.options[f],h&&h.selected&&l.push(n.sanitizeFormValue(h.value,r))}else{var i=typeof d.options[d.selectedIndex]<"u"?d.options[d.selectedIndex].value:"";l=n.sanitizeFormValue(i,r)}a[d.name]=l}return a},sanitizeFormValue:function(o,r){return r.trim&&n.isString(o)&&(o=o.trim()),r.nullify!==!1&&o===""?null:o},capitalize:function(o){return n.isString(o)?o[0].toUpperCase()+o.slice(1):o},pruneEmptyErrors:function(o){return o.filter(function(r){return!n.isEmpty(r.error)})},expandMultipleErrors:function(o){var r=[];return o.forEach(function(a){n.isArray(a.error)?a.error.forEach(function(s){r.push(n.extend({},a,{error:s}))}):r.push(a)}),r},convertErrorMessages:function(o,r){r=r||{};var a=[],s=r.prettify||n.prettify;return o.forEach(function(f){var d=n.result(f.error,f.value,f.attribute,f.options,f.attributes,f.globalOptions);if(!n.isString(d)){a.push(f);return}d[0]==="^"?d=d.slice(1):r.fullMessages!==!1&&(d=n.capitalize(s(f.attribute))+" "+d),d=d.replace(/\\\^/g,"^"),d=n.format(d,{value:n.stringifyValue(f.value,r)}),a.push(n.extend({},f,{error:d}))}),a},groupErrorsByAttribute:function(o){var r={};return o.forEach(function(a){var s=r[a.attribute];s?s.push(a):r[a.attribute]=[a]}),r},flattenErrorsToArray:function(o){return o.map(function(r){return r.error}).filter(function(r,a,s){return s.indexOf(r)===a})},cleanAttributes:function(o,r){function a(d,u,h){return n.isObject(d[u])?d[u]:d[u]=h?!0:{}}function s(d){var u={},h;for(h in d)d[h]&&n.forEachKeyInKeypath(u,h,a);return u}function f(d,u){if(!n.isObject(d))return d;var h=n.extend({},d),l,t;for(t in d)l=u[t],n.isObject(l)?h[t]=f(h[t],l):l||delete h[t];return h}return!n.isObject(r)||!n.isObject(o)?{}:(r=s(r),f(o,r))},exposeModule:function(o,r,a,s,f){a?(s&&s.exports&&(a=s.exports=o),a.validate=o):(r.validate=o,o.isFunction(f)&&f.amd&&f([],function(){return o}))},warn:function(o){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+o)},error:function(o){typeof console<"u"&&console.error&&console.error("[validate.js] "+o)}}),m.validators={presence:function(o,r){if(r=n.extend({},this.options,r),r.allowEmpty!==!1?!n.isDefined(o):n.isEmpty(o))return r.message||this.message||"can't be blank"},length:function(o,r,a){if(n.isDefined(o)){r=n.extend({},this.options,r);var s=r.is,f=r.maximum,d=r.minimum,u=r.tokenizer||function(i){return i},h,l=[];o=u(o);var t=o.length;if(!n.isNumber(t))return r.message||this.notValid||"has an incorrect length";if(n.isNumber(s)&&t!==s&&(h=r.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",l.push(n.format(h,{count:s}))),n.isNumber(d)&&t<d&&(h=r.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",l.push(n.format(h,{count:d}))),n.isNumber(f)&&t>f&&(h=r.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",l.push(n.format(h,{count:f}))),l.length>0)return r.message||l}},numericality:function(o,r,a,s,f){if(n.isDefined(o)){r=n.extend({},this.options,r);var d=[],u,h,l={greaterThan:function(T,x){return T>x},greaterThanOrEqualTo:function(T,x){return T>=x},equalTo:function(T,x){return T===x},lessThan:function(T,x){return T<x},lessThanOrEqualTo:function(T,x){return T<=x},divisibleBy:function(T,x){return T%x===0}},t=r.prettify||f&&f.prettify||n.prettify;if(n.isString(o)&&r.strict){var i="^-?(0|[1-9]\\d*)";if(r.onlyInteger||(i+="(\\.\\d+)?"),i+="$",!new RegExp(i).test(o))return r.message||r.notValid||this.notValid||this.message||"must be a valid number"}if(r.noStrings!==!0&&n.isString(o)&&!n.isEmpty(o)&&(o=+o),!n.isNumber(o))return r.message||r.notValid||this.notValid||this.message||"is not a number";if(r.onlyInteger&&!n.isInteger(o))return r.message||r.notInteger||this.notInteger||this.message||"must be an integer";for(u in l)if(h=r[u],n.isNumber(h)&&!l[u](o,h)){var N="not"+n.capitalize(u),k=r[N]||this[N]||this.message||"must be %{type} %{count}";d.push(n.format(k,{count:h,type:t(u)}))}if(r.odd&&o%2!==1&&d.push(r.notOdd||this.notOdd||this.message||"must be odd"),r.even&&o%2!==0&&d.push(r.notEven||this.notEven||this.message||"must be even"),d.length)return r.message||d}},datetime:n.extend(function(o,r){if(!n.isFunction(this.parse)||!n.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(n.isDefined(o)){r=n.extend({},this.options,r);var a,s=[],f=r.earliest?this.parse(r.earliest,r):NaN,d=r.latest?this.parse(r.latest,r):NaN;if(o=this.parse(o,r),isNaN(o)||r.dateOnly&&o%864e5!==0)return a=r.notValid||r.message||this.notValid||"must be a valid date",n.format(a,{value:arguments[0]});if(!isNaN(f)&&o<f&&(a=r.tooEarly||r.message||this.tooEarly||"must be no earlier than %{date}",a=n.format(a,{value:this.format(o,r),date:this.format(f,r)}),s.push(a)),!isNaN(d)&&o>d&&(a=r.tooLate||r.message||this.tooLate||"must be no later than %{date}",a=n.format(a,{date:this.format(d,r),value:this.format(o,r)}),s.push(a)),s.length)return n.unique(s)}},{parse:null,format:null}),date:function(o,r){return r=n.extend({},r,{dateOnly:!0}),n.validators.datetime.call(n.validators.datetime,o,r)},format:function(o,r){(n.isString(r)||r instanceof RegExp)&&(r={pattern:r}),r=n.extend({},this.options,r);var a=r.message||this.message||"is invalid",s=r.pattern,f;if(n.isDefined(o)&&(!n.isString(o)||(n.isString(s)&&(s=new RegExp(r.pattern,r.flags)),f=s.exec(o),!f||f[0].length!=o.length)))return a},inclusion:function(o,r){if(n.isDefined(o)&&(n.isArray(r)&&(r={within:r}),r=n.extend({},this.options,r),!n.contains(r.within,o))){var a=r.message||this.message||"^%{value} is not included in the list";return n.format(a,{value:o})}},exclusion:function(o,r){if(n.isDefined(o)&&(n.isArray(r)&&(r={within:r}),r=n.extend({},this.options,r),!!n.contains(r.within,o))){var a=r.message||this.message||"^%{value} is restricted";return n.isString(r.within[o])&&(o=r.within[o]),n.format(a,{value:o})}},email:n.extend(function(o,r){r=n.extend({},this.options,r);var a=r.message||this.message||"is not a valid email";if(n.isDefined(o)&&(!n.isString(o)||!this.PATTERN.exec(o)))return a},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(o,r,a,s,f){if(n.isDefined(o)){n.isString(r)&&(r={attribute:r}),r=n.extend({},this.options,r);var d=r.message||this.message||"is not equal to %{attribute}";if(n.isEmpty(r.attribute)||!n.isString(r.attribute))throw new Error("The attribute must be a non empty string");var u=n.getDeepObjectValue(s,r.attribute),h=r.comparator||function(t,i){return t===i},l=r.prettify||f&&f.prettify||n.prettify;if(!h(o,u,r,a,s))return n.format(d,{attribute:l(r.attribute)})}},url:function(o,r){if(n.isDefined(o)){r=n.extend({},this.options,r);var a=r.message||this.message||"is not a valid url",s=r.schemes||this.schemes||["http","https"],f=r.allowLocal||this.allowLocal||!1,d=r.allowDataUrl||this.allowDataUrl||!1;if(!n.isString(o))return a;var u="^(?:(?:"+s.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",h="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(f?h+="?":u+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",u+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+h+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",d){var l="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",t="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",i="data:(?:"+l+")?(?:;base64)?,"+t;u="(?:"+u+")|(?:^"+i+"$)"}var N=new RegExp(u,"i");if(!N.exec(o))return a}},type:n.extend(function(o,r,a,s,f){if(n.isString(r)&&(r={type:r}),!!n.isDefined(o)){var d=n.extend({},this.options,r),u=d.type;if(!n.isDefined(u))throw new Error("No type was specified");var h;if(n.isFunction(u)?h=u:h=this.types[u],!n.isFunction(h))throw new Error("validate.validators.type.types."+u+" must be a function.");if(!h(o,d,a,s,f)){var l=r.message||this.messages[u]||this.message||d.message||(n.isFunction(u)?"must be of the correct type":"must be of type %{type}");return n.isFunction(l)&&(l=l(o,r,a,s,f)),n.format(l,{attribute:n.prettify(a),type:u})}}},{types:{object:function(o){return n.isObject(o)&&!n.isArray(o)},array:n.isArray,integer:n.isInteger,number:n.isNumber,string:n.isString,date:n.isDate,boolean:n.isBoolean},messages:{}})},m.formatters={detailed:function(o){return o},flat:n.flattenErrorsToArray,grouped:function(o){var r;o=n.groupErrorsByAttribute(o);for(r in o)o[r]=n.flattenErrorsToArray(o[r]);return o},constraint:function(o){var r;o=n.groupErrorsByAttribute(o);for(r in o)o[r]=o[r].map(function(a){return a.validator}).sort();return o}},m.exposeModule(m,this,E,V,c)}).call(ae,y,B,null)})(q,q.exports)),q.exports}var se=de();const W=re(se),S=(B,y,E="")=>{const V={};Object.keys(y).forEach(n=>{const o=y[n];W.isString(o)?V[n]={presence:{allowEmpty:!1,message:`^請輸入${o}`}}:V[n]=o});const c={},m=W(B,V);return m&&Object.keys(m).forEach(n=>c[`${E}${n}`]=m[n].join(",")),c},M=z.defineStore("progress",{state:()=>({accessibility:{},culture:{},education:{},literacy:{},multiple:{}})}),ie={class:"block"},ce={class:"mt-4"},me={class:"table align-middle gray-table side-table"},Ve={key:0},pe={key:1,class:"text-light-gray"},fe={class:"d-flex flex-column gap-2"},Ne={key:0},ue={class:"mt-4"},Ee={class:"table align-middle gray-table side-table"},be={class:"row g-3"},ke={class:"col-12 col-xl-2"},ge={class:"text-gray mb-2"},ye={class:"col-12 col-xl-3"},he={class:"text-gray mb-2"},$e={class:"col-12 col-xl-4"},Be={class:"row g-1"},xe={class:"col-7"},Ce={class:"col-5"},_e={class:"col-12 col-xl-3"},Te={class:"text-gray mb-2"},we={class:"col-12"},Se={class:"text-gray mb-2"},De={class:"mt-4"},Ue={class:"table align-middle gray-table side-table"},Ae={class:"mt-4"},Oe={class:"table align-middle gray-table side-table"},Me={key:0,class:"table-responsive mt-3 mb-0"},Fe={class:"table align-middle gray-table"},Ie={key:0},je={key:0},Pe={class:"d-flex gap-2"},ze=["onClick"],qe={key:0,class:"block-bottom bg-light-teal"},Le={__name:"Application",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.ref(),c=e.computed(()=>I("accessibility",o.value.Status)),m=e.ref({}),n=e.computed(()=>r.value.filter(h=>!h.Deleted)),o=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!n.value.length,set:h=>{h?s():r.value.forEach(l=>l.Deleted=!0)}}),s=()=>r.value.push({}),f=h=>h.Deleted=!0,d=h=>{if(m.value={},h&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const l={Project:o.value,Contacts:V.value,ReceivedSubsidies:r.value.filter(t=>t.ID||!t.Deleted),Submit:h?"true":"false"};w.accessibility("saveApplication",l).subscribe(t=>{h?window.location.href=`WorkSchedule.aspx?ID=${t.ID}`:o.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let h={ProjectName:"計畫名稱",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return o.value.OrgCategory==="2"&&(h.RegisteredNum="立案登記證字號"),m.value=S(o.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((l,t)=>Object.assign(m.value,S(l,h,`contact-${t}-`))),h={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},r.value.forEach((l,t)=>Object.assign(m.value,S(l,h,`received-${t}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.accessibility("getZgsCodes",{CodeGroup:"ACCOrgCategory"})]).subscribe(h=>{E.value=h[0],y.id?w.accessibility("getApplication",{ID:y.id}).subscribe(l=>{o.value=l.Project,V.value=l.Contacts,r.value=l.ReceivedSubsidies,o.value.OrgCategory=o.value.OrgCategory||null,M().accessibility={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}}):w.accessibility("getEmptyApplication").subscribe(l=>{o.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},l),V.value=[{Role:"負責人"},{Role:"聯絡人"}],M().accessibility={step:o.value.FormStep,status:o.value.Status}})})}),e.provide("editable",c),(h,l)=>{const t=e.resolveComponent("required-label"),i=e.resolveComponent("input-text"),N=e.resolveComponent("input-select"),k=e.resolveComponent("input-textarea"),T=e.resolveComponent("input-boolean"),x=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ie,[l[37]||(l[37]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",ce,[e.createElementVNode("table",me,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[13]||(l[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).Year),1)]),e.createElementVNode("tr",null,[l[14]||(l[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(o).ProjectID?(e.openBlock(),e.createElementBlock("span",Ve,e.toDisplayString(e.unref(o).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",pe,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[l[15]||(l[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[16]||(l[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(m).ProjectName,modelValue:e.unref(o).ProjectName,"onUpdate:modelValue":l[0]||(l[0]=g=>e.unref(o).ProjectName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[17]||(l[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(m).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(o).OrgName,"onUpdate:modelValue":l[1]||(l[1]=g=>e.unref(o).OrgName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[18]||(l[18]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",fe,[e.createElementVNode("div",null,[e.createVNode(N,{"empty-value":null,error:e.unref(m).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o).OrgCategory,"onUpdate:modelValue":l[2]||(l[2]=g=>e.unref(o).OrgCategory=g)},null,8,["error","options","modelValue"])]),e.unref(o).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",Ne,[e.createVNode(i,{error:e.unref(m).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(o).RegisteredNum,"onUpdate:modelValue":l[3]||(l[3]=g=>e.unref(o).RegisteredNum=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[19]||(l[19]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(m).TaxID,modelValue:e.unref(o).TaxID,"onUpdate:modelValue":l[4]||(l[4]=g=>e.unref(o).TaxID=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[20]||(l[20]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(m).Address,placeholder:"請輸入地址",modelValue:e.unref(o).Address,"onUpdate:modelValue":l[5]||(l[5]=g=>e.unref(o).Address=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),l[38]||(l[38]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ue,[e.createElementVNode("table",Ee,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(g,p)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",be,[e.createElementVNode("div",ke,[e.createElementVNode("div",ge,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[21]||(l[21]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(m)[`contact-${p}-Name`],modelValue:g.Name,"onUpdate:modelValue":b=>g.Name=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ye,[e.createElementVNode("div",he,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[22]||(l[22]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(m)[`contact-${p}-JobTitle`],modelValue:g.JobTitle,"onUpdate:modelValue":b=>g.JobTitle=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",$e,[l[23]||(l[23]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",Be,[e.createElementVNode("div",xe,[e.createVNode(i,{modelValue:g.Phone,"onUpdate:modelValue":b=>g.Phone=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ce,[e.createVNode(i,{placeholder:"請輸入分機",size:"4",modelValue:g.PhoneExt,"onUpdate:modelValue":b=>g.PhoneExt=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",_e,[e.createElementVNode("div",Te,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[24]||(l[24]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(m)[`contact-${p}-MobilePhone`],modelValue:g.MobilePhone,"onUpdate:modelValue":b=>g.MobilePhone=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",we,[e.createElementVNode("div",Se,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[25]||(l[25]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(m)[`contact-${p}-EMail`],modelValue:g.EMail,"onUpdate:modelValue":b=>g.EMail=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),l[39]||(l[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",De,[e.createElementVNode("table",Ue,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[26]||(l[26]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[l[27]||(l[27]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(k,{error:e.unref(m).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(o).Target,"onUpdate:modelValue":l[6]||(l[6]=g=>e.unref(o).Target=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[28]||(l[28]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(o).Summary,"onUpdate:modelValue":l[7]||(l[7]=g=>e.unref(o).Summary=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[29]||(l[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Quantified,"onUpdate:modelValue":l[8]||(l[8]=g=>e.unref(o).Quantified=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[30]||(l[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(m).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Qualitative,"onUpdate:modelValue":l[9]||(l[9]=g=>e.unref(o).Qualitative=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Ae,[e.createElementVNode("table",Oe,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[36]||(l[36]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(T,{modelValue:e.unref(a),"onUpdate:modelValue":l[10]||(l[10]=g=>e.isRef(a)?a.value=g:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",Me,[e.createElementVNode("table",Fe,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[l[31]||(l[31]=e.createElementVNode("th",null,"計畫名稱",-1)),l[32]||(l[32]=e.createElementVNode("th",null,"補助單位",-1)),l[33]||(l[33]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",Ie,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(g,p)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(m)[`received-${p}-Name`],modelValue:g.Name,"onUpdate:modelValue":b=>g.Name=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(m)[`received-${p}-Unit`],modelValue:g.Unit,"onUpdate:modelValue":b=>g.Unit=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m)[`received-${p}-Amount`],modelValue:g.Amount,"onUpdate:modelValue":b=>g.Amount=b},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",je,[e.createElementVNode("div",Pe,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:b=>f(g),type:"button"},[...l[34]||(l[34]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ze)):e.createCommentVNode("",!0),p+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...l[35]||(l[35]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",qe,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:l[11]||(l[11]=g=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:l[12]||(l[12]=g=>d(!0)),type:"button"},[...l[40]||(l[40]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Re={class:"block"},Je={key:0,class:"text-pink lh-base mt-4"},Qe={class:"mt-4"},We={class:"table align-middle gray-table"},Ge={class:"text-center"},Ye={key:0,width:"180"},He={class:"text-center"},Ze={key:0},Ke=["innerHTML"],Xe={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},ve={key:0,class:"text-center"},et={key:0},tt={key:1,class:"text-pink"},lt={key:1,class:"tag-group mt-2 gap-1"},ot={key:0,class:"tag tag-green-light"},nt=["download","href"],rt=["onClick"],at={key:0,class:"block-bottom bg-light-teal"},dt=["disabled"],st={__name:"Attachment",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"證明文件影本",Comment:"A.民間團體：申請單位登記、立案文件、現任負責人當選證明文件。<br>B.國(公)立學校免附證明文件。",Files:[],Multiple:!0,Optional:!0},{Type:6,Title:"其他佐證資料",Comment:"A.本計畫屬民間團體提案者(政府立案之社團法人、財團法人、組織或社區發展協會等)，需檢附3年內任1年曾受相關政府補助完成計畫之實績佐證資料，無則免附。<br>B.提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附。",Files:[],Multiple:!0,Optional:!0}]),V=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),c=e.computed(()=>I("accessibility",m.value.Status)),m=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:m.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=w.download,r=a=>{const s={ID:y.id,Attachments:E.value.reduce((f,d)=>f.concat(d.Files),[]),Submit:a?"true":"false"};w.accessibility("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([w.accessibility("getAttachment",{ID:y.id})]).subscribe(a=>{const s=a[0];m.value=s.Project,E.value=E.value.filter(f=>{var d;return!((d=f.Excludes)!=null&&d.includes(m.value.OrgCategory))}),E.value.forEach(f=>{f.Files=s.Attachments.filter(d=>d.Type===f.Type),f.Uploaded=e.computed(()=>f.Files.filter(d=>!d.Deleted).length)}),M().accessibility={step:m.value.FormStep,status:m.value.Status,organizer:m.value.Organizer,organizerName:m.value.OrganizerName}})}),e.provide("editable",c),(a,s)=>{const f=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Re,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("p",Je,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Qe,[e.createElementVNode("table",We,[e.createElementVNode("thead",Ge,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",Ye,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,h)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",He,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Ze,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(f,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(c)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Ke)):e.createCommentVNode("",!0),e.unref(c)&&u.Template?(e.openBlock(),e.createElementBlock("button",Xe,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",ve,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",et,"已上傳")):(e.openBlock(),e.createElementBlock("span",tt,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(c)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",lt,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ot,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,nt),e.unref(c)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,rt)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",at,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(V),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,dt)])):e.createCommentVNode("",!0)],64)}}},it={class:"block"},ct={class:"mt-4"},mt={class:"table-responsive mt-3 mb-0"},Vt={class:"table align-middle gray-table"},pt={key:0,width:"1"},ft={key:0},Nt={class:"d-flex gap-2"},ut=["onClick"],Et={class:"table-responsive mt-3 mb-0"},bt={class:"table align-middle gray-table"},kt={key:0,class:"block-bottom bg-light-teal"},gt={__name:"Benefit",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.computed(()=>I("accessibility",n.value.Status)),c=e.ref({}),m=e.computed(()=>E.value.filter(f=>!f.Deleted)),n=e.ref({}),o=()=>E.value.push({}),r=f=>f.Deleted=!0,a=f=>{if(c.value={},f&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Project:n.value,Benefits:E.value,Submit:f?"true":"false"};w.accessibility("saveBenefit",d).subscribe(()=>{f?window.location.href=`Attachment.aspx?ID=${y.id}`:window.location.reload()})},s=()=>{let f={Benefit:"不可量化成果"};return c.value=S(n.value,f),f={Title:"指標",Target:"目標值",Description:"說明"},m.value.forEach((d,u)=>Object.assign(c.value,S(d,f,`item-${u}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.accessibility("getBenefit",{ID:y.id})]).subscribe(f=>{const d=f[0];n.value=d.Project,E.value=d.Benefits,E.value.length||o(),M().accessibility={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",V),(f,d)=>{const u=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",it,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",ct,[e.createElementVNode("div",mt,[e.createElementVNode("table",Vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[d[3]||(d[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),d[4]||(d[4]=e.createElementVNode("th",null,"目標值",-1)),d[5]||(d[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",pt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(l,t)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(c)[`item-${t}-Title`],modelValue:l.Title,"onUpdate:modelValue":i=>l.Title=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(c)[`item-${t}-Target`],modelValue:l.Target,"onUpdate:modelValue":i=>l.Target=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(c)[`item-${t}-Description`],rows:"1",modelValue:l.Description,"onUpdate:modelValue":i=>l.Description=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",ft,[e.createElementVNode("div",Nt,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:i=>r(l),type:"button"},[...d[6]||(d[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ut)):e.createCommentVNode("",!0),t+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...d[7]||(d[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Et,[e.createElementVNode("table",bt,[d[8]||(d[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(c).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":d[0]||(d[0]=l=>e.unref(n).Benefit=l),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",kt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=l=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=l=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},yt={class:"block"},ht={class:"mt-4"},$t={class:"table-responsive mt-3 mb-0"},Bt={class:"table align-middle gray-table"},xt={class:"text-end"},Ct={class:"text-end"},_t={class:"table-responsive"},Tt={class:"table align-middle gray-table"},wt=["colspan"],St={key:0,width:"1"},Dt={class:"text-end"},Ut={key:0},At={class:"d-flex gap-2"},Ot=["onClick"],Mt={class:"mt-4"},Ft={class:"table-responsive mt-3 mb-0"},It={class:"table align-middle gray-table"},jt={key:0,width:"1"},Pt={class:"text-end"},zt={key:0},qt={class:"d-flex gap-2"},Lt=["onClick"],Rt={key:0,class:"block-bottom bg-light-teal"},Jt={__name:"Funding",props:{id:{type:Number}},setup(B){const y=B,E=e.computed(()=>I("accessibility",n.value.Status)),V=e.ref({}),c=e.computed(()=>o.value.filter(l=>!l.Deleted)),m=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref(0),s=()=>o.value.push({}),f=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(V.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,OtherSubsidies:o.value,BudgetPlans:r.value,Submit:l?"true":"false"};w.accessibility("saveFunding",t).subscribe(()=>{l?window.location.href=`Benefit.aspx?ID=${y.id}`:window.location.reload()})},h=()=>{let l={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=S(n.value,l),l={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},o.value.forEach((t,i)=>Object.assign(V.value,S(t,l,`other-${i}-`))),l={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,i)=>Object.assign(V.value,S(t,l,`plan-${i}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.accessibility("getFunding",{ID:y.id})]).subscribe(l=>{const t=l[0];n.value=t.Project,o.value=t.OtherSubsidies,r.value=t.BudgetPlans,o.value.length||s(),r.value.length||f(),M().accessibility={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=c.value.reduce((l,t)=>l+F(t.Amount),0),a.value=F(n.value.ApplyAmount)+F(n.value.SelfAmount)+F(n.value.OtherAmount),c.value.forEach(l=>l.percent=Math.round(F(l.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(l=>l.sum=F(l.Amount)+F(l.OtherAmount))}),(l,t)=>{var T;const i=e.resolveComponent("input-integer"),N=e.resolveComponent("input-text"),k=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yt,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",ht,[e.createElementVNode("div",$t,[e.createElementVNode("table",Bt,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(n).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(n).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",xt,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",Ct,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",_t,[e.createElementVNode("table",Tt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,wt)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",St,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(x,g)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(g+1),1),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(V)[`other-${g}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":p=>x.Unit=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`other-${g}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":p=>x.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Dt,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`other-${g}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":p=>x.Content=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Ut,[e.createElementVNode("div",At,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:p=>d(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ot)):e.createCommentVNode("",!0),g+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Mt,[e.createElementVNode("div",Ft,[e.createElementVNode("table",It,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",jt,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(x,g)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(V)[`plan-${g}-Title`],modelValue:x.Title,"onUpdate:modelValue":p=>x.Title=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`plan-${g}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":p=>x.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`plan-${g}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":p=>x.OtherAmount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Pt,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`plan-${g}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":p=>x.Description=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",zt,[e.createElementVNode("div",qt,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:p=>d(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Lt)):e.createCommentVNode("",!0),g+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Rt,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>u(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Qt={__name:"ProgressBar",setup(B){const y=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,V)=>{const c=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(c,{steps:y,type:"accessibility"})}}},Wt={class:"block"},Gt={class:"mt-4"},Yt={class:"table align-middle gray-table side-table"},Ht={class:"d-flex align-items-center gap-2"},Zt={class:"input-group w-auto"},Kt={key:0,class:"invalid mt-0"},Xt={class:"table-responsive mt-4"},vt={class:"table align-middle gray-table"},el={key:0},tl={class:"input-group"},ll={key:0,class:"invalid mt-0"},ol={key:0},nl={class:"d-flex gap-2"},rl=["onClick"],al={class:"mt-4"},dl={class:"table align-middle gray-table"},sl={key:0},il={key:0},cl={class:"d-flex gap-2"},ml=["onClick"],Vl={key:0,class:"block-bottom bg-light-teal"},pl={__name:"WorkSchedule",props:{id:{type:Number}},setup(B){const y=B,E=[{value:1,text:"50%"},{value:2,text:"100%"}],V=e.computed(()=>I("accessibility",o.value.Status)),c=e.ref({}),m=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.computed(()=>a.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref([]),s=()=>w.accessibility("createItem",{ID:y.id}).subscribe(l=>r.value.push(l)),f=()=>a.value.push({Type:0,ItemID:0}),d=l=>l.Deleted=!0,u=l=>{if(c.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Items:r.value,Schedules:a.value,Submit:l?"true":"false"};w.accessibility("saveWorkSchedule",t).subscribe(()=>{l?window.location.href=`Funding.aspx?ID=${y.id}`:window.location.reload()})},h=()=>{let l={StartTime:"計畫期程",EndTime:"計畫期程"};return c.value=S(o.value,l),l={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},m.value.forEach((t,i)=>Object.assign(c.value,S(t,l,`item-${i}-`))),l={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},n.value.forEach((t,i)=>Object.assign(c.value,S(t,l,`schedule-${i}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.accessibility("getWorkSchedule",{ID:y.id})]).subscribe(l=>{const t=l[0];o.value=t.Project,r.value=t.Items,a.value=t.Schedules,r.value.length||s(),a.value.length||f(),M().accessibility={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",V),(l,t)=>{const i=e.resolveComponent("required-label"),N=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Wt,[t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Gt,[e.createElementVNode("table",Yt,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Ht,[e.createElementVNode("div",Zt,[e.createVNode(N,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[0]||(t[0]=p=>e.unref(o).StartTime=p)},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(N,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[1]||(t[1]=p=>e.unref(o).EndTime=p)},null,8,["modelValue"])]),t[6]||(t[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(c).StartTime||e.unref(c).EndTime?(e.openBlock(),e.createElementBlock("div",Kt,e.toDisplayString(e.unref(c).StartTime||e.unref(c).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Xt,[e.createElementVNode("table",vt,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[11]||(t[11]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[7]||(t[7]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",el,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+b)),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(c)[`item-${b}-Title`],modelValue:p.Title,"onUpdate:modelValue":C=>p.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",tl,[e.createVNode(T,{"empty-value":0,modelValue:p.Begin,"onUpdate:modelValue":C=>p.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:p.End,"onUpdate:modelValue":C=>p.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(c)[`item-${b}-Begin`]||e.unref(c)[`item-${b}-End`]?(e.openBlock(),e.createElementBlock("div",ll,e.toDisplayString(e.unref(c)[`item-${b}-Begin`]||e.unref(c)[`item-${b}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(c)[`item-${b}-Deadline`],modelValue:p.Deadline,"onUpdate:modelValue":C=>p.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`item-${b}-Content`],rows:"1",modelValue:p.Content,"onUpdate:modelValue":C=>p.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",ol,[e.createElementVNode("div",nl,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,rl)):e.createCommentVNode("",!0),b+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",al,[e.createElementVNode("table",dl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[14]||(t[14]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[18]||(t[18]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",sl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(c)[`schedule-${b}-Type`],options:E,modelValue:p.Type,"onUpdate:modelValue":C=>p.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(c)[`schedule-${b}-ItemID`],options:e.unref(m),"text-name":"Title","value-name":"ID",modelValue:p.ItemID,"onUpdate:modelValue":C=>p.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(p.ItemID?String.fromCharCode(65+e.unref(m).findIndex(C=>C.ID===p.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(c)[`schedule-${b}-Deadline`],modelValue:p.Deadline,"onUpdate:modelValue":C=>p.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`schedule-${b}-Content`],rows:"1",modelValue:p.Content,"onUpdate:modelValue":C=>p.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",il,[e.createElementVNode("div",cl,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ml)):e.createCommentVNode("",!0),b+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Vl,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=p=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=p=>u(!0)),type:"button"},[...t[24]||(t[24]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},fl={class:"application-step"},Nl=["onClick"],ul={class:"step-content"},El={class:"step-label"},bl={key:0,class:"step-status edit"},kl={key:1,class:"step-status"},gl={__name:"CommonProgressBar",props:{id:{type:Number},review:{default:!1,type:Boolean},step:{required:!0,type:Number},steps:{required:!0,type:Array},type:{required:!0,type:Number}},emits:["click"],setup(B,{emit:y}){const E=e.computed(()=>I(c.type,V[c.type].status,c.step)),V=M(),c=B,m=o=>{c.review?n("click",o.step):o.step<=V[c.type].step&&(location.href=`${o.url}.aspx?ID=${c.id}`)},n=y;return(o,r)=>(e.openBlock(),e.createElementBlock("div",fl,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.steps,a=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["step-item",{active:e.unref(E)&&(a.step<e.unref(V)[B.type].step||a.step===B.step)}]),onClick:s=>m(a),key:a,role:"button"},[e.createElementVNode("div",ul,[e.createElementVNode("div",El,e.toDisplayString(a.title),1),e.unref(E)&&a.step===B.step?(e.openBlock(),e.createElementBlock("div",bl,"編輯中")):a.step<e.unref(V)[B.type].step?(e.openBlock(),e.createElementBlock("div",kl,"已完成")):e.createCommentVNode("",!0)])],10,Nl))),128))]))}},yl={class:"block"},hl={class:"mt-4"},$l={class:"table align-middle gray-table side-table"},Bl={key:0},xl={key:1,class:"text-light-gray"},Cl={class:"d-flex gap-2"},_l={key:0,class:"invalid mt-0"},Tl={class:"d-flex flex-column gap-2"},wl={key:0},Sl={class:"mt-4"},Dl={class:"table align-middle gray-table side-table"},Ul={class:"row g-3"},Al={class:"col-12 col-xl-2"},Ol={class:"text-gray mb-2"},Ml={class:"col-12 col-xl-3"},Fl={class:"text-gray mb-2"},Il={class:"col-12 col-xl-4"},jl={class:"row g-1"},Pl={class:"col-7"},zl={class:"col-5"},ql={class:"col-12 col-xl-3"},Ll={class:"text-gray mb-2"},Rl={class:"col-12"},Jl={class:"text-gray mb-2"},Ql={class:"mt-4"},Wl={class:"table align-middle gray-table side-table"},Gl={class:"mt-4"},Yl={class:"table align-middle gray-table side-table"},Hl={key:0,class:"table-responsive mt-3 mb-0"},Zl={class:"table align-middle gray-table"},Kl={key:0},Xl={key:0},vl={class:"d-flex gap-2"},eo=["onClick"],to={key:0,class:"block-bottom bg-light-teal"},lo={__name:"Application",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.ref(),c=e.computed(()=>I("culture",a.value.Status)),m=e.ref({}),n=e.ref(null),o=e.ref([]),r=e.computed(()=>f.value.filter(N=>!N.Deleted)),a=e.ref({}),s=e.computed(()=>o.value.filter(N=>!N.ParentCode)),f=e.ref([]),d=e.computed(()=>o.value.filter(N=>N.ParentCode===n.value)),u=e.computed({get:()=>!!r.value.length,set:N=>{N?h():f.value.forEach(k=>k.Deleted=!0)}}),h=()=>f.value.push({}),l=N=>N.Deleted=!0,t=N=>{if(m.value={},N&&!i()){e.nextTick(()=>{var T;return(T=document.querySelector(".invalid"))==null?void 0:T.scrollIntoView({behavior:"smooth",block:"center"})});return}const k={Project:a.value,Contacts:V.value,ReceivedSubsidies:f.value.filter(T=>T.ID||!T.Deleted),Submit:N?"true":"false"};w.culture("saveApplication",k).subscribe(T=>{N?window.location.href=`WorkSchedule.aspx?ID=${T.ID}`:a.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${T.ID}`})},i=()=>{let N={ProjectName:"計畫名稱",Field:"徵件類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return a.value.OrgCategory==="3"&&(N.RegisteredNum="立案登記證字號"),m.value=S(a.value,N),N={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((k,T)=>Object.assign(m.value,S(k,N,`contact-${T}-`))),N={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},f.value.forEach((k,T)=>Object.assign(m.value,S(k,N,`received-${T}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.culture("getZgsCodes",{CodeGroup:"CULField"}),w.culture("getZgsCodes",{CodeGroup:"CULOrgCategory"})]).subscribe(N=>{o.value=N[0],E.value=N[1],y.id?w.culture("getApplication",{ID:y.id}).subscribe(k=>{var T;a.value=k.Project,V.value=k.Contacts,f.value=k.ReceivedSubsidies,n.value=((T=o.value.find(x=>x.Code===a.value.Field))==null?void 0:T.ParentCode)||null,a.value.OrgCategory=a.value.OrgCategory||null,M().culture={step:a.value.FormStep,status:a.value.Status,organizer:a.value.Organizer,organizerName:a.value.OrganizerName}}):w.culture("getEmptyApplication").subscribe(k=>{n.value=null,a.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},k),V.value=[{Role:"負責人"},{Role:"聯絡人"}],M().culture={step:a.value.FormStep,status:a.value.Status}})})}),e.provide("editable",c),e.watch(n,()=>{n.value?d.value.find(N=>a.value.Field===N.Code)||(a.value.Field=d.value[0].Code):a.value.Field=null}),(N,k)=>{const T=e.resolveComponent("required-label"),x=e.resolveComponent("input-text"),g=e.resolveComponent("input-select"),p=e.resolveComponent("input-textarea"),b=e.resolveComponent("input-boolean"),C=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",yl,[k[40]||(k[40]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",hl,[e.createElementVNode("table",$l,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[k[15]||(k[15]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).Year),1)]),e.createElementVNode("tr",null,[k[16]||(k[16]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(a).ProjectID?(e.openBlock(),e.createElementBlock("span",Bl,e.toDisplayString(e.unref(a).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",xl,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[k[17]||(k[17]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(a).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[18]||(k[18]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).ProjectName,modelValue:e.unref(a).ProjectName,"onUpdate:modelValue":k[0]||(k[0]=_=>e.unref(a).ProjectName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[19]||(k[19]=[e.createTextVNode("徵件類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Cl,[e.createVNode(g,{"empty-value":null,options:e.unref(s),"text-name":"Descname","value-name":"Code",modelValue:e.unref(n),"onUpdate:modelValue":k[1]||(k[1]=_=>e.isRef(n)?n.value=_:null)},null,8,["options","modelValue"]),e.createVNode(g,{"empty-value":null,disabled:!e.unref(n),options:e.unref(d),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).Field,"onUpdate:modelValue":k[2]||(k[2]=_=>e.unref(a).Field=_)},null,8,["disabled","options","modelValue"])]),e.unref(m).Field?(e.openBlock(),e.createElementBlock("div",_l,e.toDisplayString(e.unref(m).Field),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[20]||(k[20]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(a).OrgName,"onUpdate:modelValue":k[3]||(k[3]=_=>e.unref(a).OrgName=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[21]||(k[21]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Tl,[e.createElementVNode("div",null,[e.createVNode(g,{"empty-value":null,error:e.unref(m).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(a).OrgCategory,"onUpdate:modelValue":k[4]||(k[4]=_=>e.unref(a).OrgCategory=_)},null,8,["error","options","modelValue"])]),e.unref(a).OrgCategory==="3"?(e.openBlock(),e.createElementBlock("div",wl,[e.createVNode(x,{error:e.unref(m).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(a).RegisteredNum,"onUpdate:modelValue":k[5]||(k[5]=_=>e.unref(a).RegisteredNum=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[22]||(k[22]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).TaxID,modelValue:e.unref(a).TaxID,"onUpdate:modelValue":k[6]||(k[6]=_=>e.unref(a).TaxID=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[23]||(k[23]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).Address,placeholder:"請輸入地址",modelValue:e.unref(a).Address,"onUpdate:modelValue":k[7]||(k[7]=_=>e.unref(a).Address=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),k[41]||(k[41]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Sl,[e.createElementVNode("table",Dl,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(_,D)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(_.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ul,[e.createElementVNode("div",Al,[e.createElementVNode("div",Ol,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[24]||(k[24]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(x,{error:e.unref(m)[`contact-${D}-Name`],modelValue:_.Name,"onUpdate:modelValue":O=>_.Name=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ml,[e.createElementVNode("div",Fl,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[25]||(k[25]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(x,{error:e.unref(m)[`contact-${D}-JobTitle`],modelValue:_.JobTitle,"onUpdate:modelValue":O=>_.JobTitle=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Il,[k[26]||(k[26]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",jl,[e.createElementVNode("div",Pl,[e.createVNode(x,{modelValue:_.Phone,"onUpdate:modelValue":O=>_.Phone=O,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",zl,[e.createVNode(x,{placeholder:"請輸入分機",size:"4",modelValue:_.PhoneExt,"onUpdate:modelValue":O=>_.PhoneExt=O,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",ql,[e.createElementVNode("div",Ll,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[27]||(k[27]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(x,{error:e.unref(m)[`contact-${D}-MobilePhone`],modelValue:_.MobilePhone,"onUpdate:modelValue":O=>_.MobilePhone=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Rl,[e.createElementVNode("div",Jl,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[28]||(k[28]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(x,{error:e.unref(m)[`contact-${D}-EMail`],modelValue:_.EMail,"onUpdate:modelValue":O=>_.EMail=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),k[42]||(k[42]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",Ql,[e.createElementVNode("table",Wl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[29]||(k[29]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[k[30]||(k[30]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(p,{error:e.unref(m).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(a).Target,"onUpdate:modelValue":k[8]||(k[8]=_=>e.unref(a).Target=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[31]||(k[31]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(m).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(a).Summary,"onUpdate:modelValue":k[9]||(k[9]=_=>e.unref(a).Summary=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[32]||(k[32]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(m).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Quantified,"onUpdate:modelValue":k[10]||(k[10]=_=>e.unref(a).Quantified=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(T,null,{default:e.withCtx(()=>[...k[33]||(k[33]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{error:e.unref(m).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(a).Qualitative,"onUpdate:modelValue":k[11]||(k[11]=_=>e.unref(a).Qualitative=_),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Gl,[e.createElementVNode("table",Yl,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[k[39]||(k[39]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(b,{modelValue:e.unref(u),"onUpdate:modelValue":k[12]||(k[12]=_=>e.isRef(u)?u.value=_:null)},null,8,["modelValue"]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",Hl,[e.createElementVNode("table",Zl,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[k[34]||(k[34]=e.createElementVNode("th",null,"計畫名稱",-1)),k[35]||(k[35]=e.createElementVNode("th",null,"補助單位",-1)),k[36]||(k[36]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",Kl,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(_,D)=>(e.openBlock(),e.createElementBlock("tr",{key:_},[e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m)[`received-${D}-Name`],modelValue:_.Name,"onUpdate:modelValue":O=>_.Name=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m)[`received-${D}-Unit`],modelValue:_.Unit,"onUpdate:modelValue":O=>_.Unit=O,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(C,{error:e.unref(m)[`received-${D}-Amount`],modelValue:_.Amount,"onUpdate:modelValue":O=>_.Amount=O},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",Xl,[e.createElementVNode("div",vl,[e.unref(r).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:O=>l(_),type:"button"},[...k[37]||(k[37]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,eo)):e.createCommentVNode("",!0),D+1===e.unref(r).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:h,type:"button"},[...k[38]||(k[38]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",to,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:k[13]||(k[13]=_=>t()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:k[14]||(k[14]=_=>t(!0)),type:"button"},[...k[43]||(k[43]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},oo={class:"block"},no={key:0,class:"text-pink lh-base mt-4"},ro={class:"mt-4"},ao={class:"table align-middle gray-table"},so={class:"text-center"},io={key:0,width:"180"},co={class:"text-center"},mo={key:0},Vo=["innerHTML"],po={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},fo={key:0,class:"text-center"},No={key:0},uo={key:1,class:"text-pink"},Eo={key:1,class:"tag-group mt-2 gap-1"},bo={key:0,class:"tag tag-green-light"},ko=["download","href"],go=["onClick"],yo={key:0,class:"block-bottom bg-light-teal"},ho=["disabled"],$o={__name:"Attachment",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"申請捐（補）助計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[],Excludes:["1"]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Comment:"(與本計畫相關之補充資料、如立案證明、配合提案計畫邀集相關合作單位召開討論之會議紀錄等；若有合作對象，請附合作對象同意書)",Template:!0,Files:[]},{Type:5,Title:"附錄",Files:[],Multiple:!0}]),V=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),c=e.computed(()=>I("culture",m.value.Status)),m=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:m.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=w.download,r=a=>{const s={ID:y.id,Attachments:E.value.reduce((f,d)=>f.concat(d.Files),[]),Submit:a?"true":"false"};w.culture("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([w.culture("getAttachment",{ID:y.id})]).subscribe(a=>{const s=a[0];m.value=s.Project,E.value=E.value.filter(f=>{var d;return!((d=f.Excludes)!=null&&d.includes(m.value.OrgCategory))}),E.value.forEach(f=>{f.Files=s.Attachments.filter(d=>d.Type===f.Type),f.Uploaded=e.computed(()=>f.Files.filter(d=>!d.Deleted).length)}),M().culture={step:m.value.FormStep,status:m.value.Status,organizer:m.value.Organizer,organizerName:m.value.OrganizerName}})}),e.provide("editable",c),(a,s)=>{const f=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",oo,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"上傳附件",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("p",no,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",ro,[e.createElementVNode("table",ao,[e.createElementVNode("thead",so,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",io,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,h)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",co,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",mo,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(f,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(c)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Vo)):e.createCommentVNode("",!0),e.unref(c)&&u.Template?(e.openBlock(),e.createElementBlock("button",po,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",fo,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",No,"已上傳")):(e.openBlock(),e.createElementBlock("span",uo,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(c)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Eo,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",bo,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,ko),e.unref(c)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,go)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",yo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(V),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ho)])):e.createCommentVNode("",!0)],64)}}},Bo={class:"block"},xo={class:"mt-4"},Co={class:"table-responsive mt-3 mb-0"},_o={class:"table align-middle gray-table"},To={class:"text-end"},wo={class:"text-end"},So={class:"table-responsive"},Do={class:"table align-middle gray-table"},Uo=["colspan"],Ao={key:0,width:"1"},Oo={key:0},Mo={class:"d-flex gap-2"},Fo=["onClick"],Io={class:"mt-4"},jo={class:"table-responsive mt-3 mb-0"},Po={class:"table align-middle gray-table"},zo={key:0,width:"1"},qo={class:"text-end"},Lo={key:0},Ro={class:"d-flex gap-2"},Jo=["onClick"],Qo={key:0,class:"block-bottom bg-light-teal"},Wo={__name:"Funding",props:{id:{type:Number}},setup(B){const y=B,E=e.computed(()=>I("culture",n.value.Status)),V=e.ref({}),c=e.computed(()=>r.value.filter(i=>!i.Deleted)),m=e.computed(()=>a.value.filter(i=>!i.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref([]),s=e.ref(0),f=()=>r.value.push({}),d=()=>a.value.push({ItemID:0}),u=i=>i.Deleted=!0,h=i=>i.Deleted=!0,l=i=>{if(V.value={},i&&!t()){e.nextTick(()=>{var k;return(k=document.querySelector(".invalid"))==null?void 0:k.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:n.value,OtherSubsidies:r.value,BudgetPlans:a.value,Submit:i?"true":"false"};w.culture("saveFunding",N).subscribe(()=>{i?window.location.href=`Other.aspx?ID=${y.id}`:window.location.reload()})},t=()=>{let i={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=S(n.value,i),i={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}}},r.value.forEach((N,k)=>Object.assign(V.value,S(N,i,`other-${k}-`))),i={ItemID:{numericality:{greaterThan:0,message:"^請選擇工作項目"}},Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},a.value.forEach((N,k)=>Object.assign(V.value,S(N,i,`plan-${k}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.culture("getFunding",{ID:y.id})]).subscribe(i=>{const N=i[0];n.value=N.Project,r.value=N.OtherSubsidies,a.value=N.BudgetPlans,o.value=N.Items,r.value.length||f(),a.value.length||d(),M().culture={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=r.value.reduce((i,N)=>i+(N.Deleted?0:F(N.Amount)),0),s.value=F(n.value.ApplyAmount)+F(n.value.SelfAmount)+F(n.value.OtherAmount),a.value.forEach(i=>i.sum=F(i.Amount)+F(i.OtherAmount))}),(i,N)=>{var p;const k=e.resolveComponent("input-integer"),T=e.resolveComponent("input-text"),x=e.resolveComponent("input-select"),g=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Bo,[N[20]||(N[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",xo,[e.createElementVNode("div",Co,[e.createElementVNode("table",_o,[N[4]||(N[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":N[0]||(N[0]=b=>e.unref(n).ApplyAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":N[1]||(N[1]=b=>e.unref(n).SelfAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",To,e.toDisplayString((p=e.unref(n).OtherAmount)==null?void 0:p.toLocaleString()),1),e.createElementVNode("td",wo,e.toDisplayString(e.unref(s).toLocaleString()),1)])])])]),N[10]||(N[10]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",So,[e.createElementVNode("table",Do,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?4:3,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,Uo)]),e.createElementVNode("tr",null,[N[5]||(N[5]=e.createElementVNode("th",{width:"1"},null,-1)),N[6]||(N[6]=e.createElementVNode("th",null,"單位名稱",-1)),N[7]||(N[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Ao,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,e.toDisplayString(C+1),1),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(V)[`other-${C}-Unit`],modelValue:b.Unit,"onUpdate:modelValue":_=>b.Unit=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`other-${C}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Oo,[e.createElementVNode("div",Mo,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>u(b),type:"button"},[...N[8]||(N[8]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Fo)):e.createCommentVNode("",!0),C+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...N[9]||(N[9]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),N[21]||(N[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",Io,[e.createElementVNode("div",jo,[e.createElementVNode("table",Po,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[N[11]||(N[11]=e.createElementVNode("th",null,"重要工作項目",-1)),N[12]||(N[12]=e.createElementVNode("th",null,"預算項目",-1)),N[13]||(N[13]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),N[14]||(N[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),N[15]||(N[15]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),N[16]||(N[16]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",zo,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(x,{"empty-value":0,error:e.unref(V)[`plan-${C}-ItemID`],options:e.unref(o),"text-name":"Title","value-name":"ID",modelValue:b.ItemID,"onUpdate:modelValue":_=>b.ItemID=_},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(V)[`plan-${C}-Title`],modelValue:b.Title,"onUpdate:modelValue":_=>b.Title=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`plan-${C}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`plan-${C}-OtherAmount`],modelValue:b.OtherAmount,"onUpdate:modelValue":_=>b.OtherAmount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",qo,e.toDisplayString(b.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(V)[`plan-${C}-Description`],rows:"1",modelValue:b.Description,"onUpdate:modelValue":_=>b.Description=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",Lo,[e.createElementVNode("div",Ro,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>h(b),type:"button"},[...N[17]||(N[17]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Jo)):e.createCommentVNode("",!0),C+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:d,type:"button"},[...N[18]||(N[18]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),N[19]||(N[19]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"【計算方式及說明－範例】口訪工作人員之交通費：2,980（高雄─臺北）×2人=5,960元。")],-1))])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Qo,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[2]||(N[2]=b=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[3]||(N[3]=b=>l(!0)),type:"button"},[...N[22]||(N[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Go={class:"block"},Yo={key:0,class:"text-pink lh-base mt-3"},Ho={class:"border"},Zo={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},Ko={class:"d-flex gap-2 align-items-center flex-grow-1"},Xo={class:"text-nowrap"},vo={class:"flex-grow-1"},en={class:"d-flex gap-2"},tn=["onClick"],ln=["href"],on=["id"],nn={class:"table align-middle gray-table side-table mb-0"},rn={key:0,class:"block-bottom bg-light-teal"},an={__name:"Other",props:{id:{type:Number}},setup(B){const y=B,E=e.computed(()=>I("culture",c.value.Status)),V=e.ref({}),c=e.ref({}),m=e.ref([]),n=e.computed(()=>m.value.filter(f=>!f.Deleted)),o=()=>m.value.push({}),r=f=>f.Deleted=!0,a=f=>{if(V.value={},f&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={ID:y.id,Projects:m.value,Submit:f?"true":"false"};w.culture("saveRelatedProject",d).subscribe(()=>{f?window.location.href=`Attachment.aspx?ID=${y.id}`:window.location.reload()})},s=()=>{V.value={};const f={Title:"相關計畫名稱",Year:"執行年度",OrgName:"執行單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入計畫經費"},numericality:{greaterThan:0,message:"^計畫經費不可為 0"}},Description:"內容摘述",Benefit:"執行效益"};return n.value.forEach((d,u)=>Object.assign(V.value,S(d,f,`project-${u}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.culture("getRelatedProject",{ID:y.id})]).subscribe(f=>{const d=f[0];c.value=d.Project,m.value=d.Projects,M().culture={step:c.value.FormStep,status:c.value.Status,organizer:c.value.Organizer,organizerName:c.value.OrganizerName}})}),e.provide("editable",E),(f,d)=>{const u=e.resolveComponent("required-label"),h=e.resolveComponent("input-text"),l=e.resolveComponent("input-integer"),t=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Go,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"}," 提案單位近三年執行相關計畫之成效及與本計畫之關聯性與差異性 ",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("p",Yo," 若無相關計畫可不填寫 ")):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(i,N)=>(e.openBlock(),e.createElementBlock("div",{class:"mt-3",key:i},[e.createElementVNode("div",Ho,[e.createElementVNode("div",Zo,[e.createElementVNode("div",Ko,[e.createElementVNode("label",Xo,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[2]||(d[2]=[e.createTextVNode("相關計畫名稱",-1)])]),_:1})]),e.createElementVNode("div",vo,[e.createVNode(h,{error:e.unref(V)[`project-${N}-Title`],modelValue:i.Title,"onUpdate:modelValue":k=>i.Title=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",en,[e.unref(E)?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(k=>r(i),["prevent"]),href:"#"},"刪除",8,tn)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${N}`,role:"button"},"收合",8,ln)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${N}`},[e.createElementVNode("table",nn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[3]||(d[3]=[e.createTextVNode("執行年度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(l,{class:"text-start w-auto",error:e.unref(V)[`project-${N}-Year`],modelValue:i.Year,"onUpdate:modelValue":k=>i.Year=k},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[4]||(d[4]=[e.createTextVNode("執行單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(V)[`project-${N}-OrgName`],modelValue:i.OrgName,"onUpdate:modelValue":k=>i.OrgName=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[5]||(d[5]=[e.createTextVNode("計畫經費(元)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(l,{class:"w-auto",error:e.unref(V)[`project-${N}-Amount`],modelValue:i.Amount,"onUpdate:modelValue":k=>i.Amount=k},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[6]||(d[6]=[e.createTextVNode("內容摘述",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(V)[`project-${N}-Description`],rows:"4",modelValue:i.Description,"onUpdate:modelValue":k=>i.Description=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(u,null,{default:e.withCtx(()=>[...d[7]||(d[7]=[e.createTextVNode("執行效益",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(t,{error:e.unref(V)[`project-${N}-Benefit`],rows:"4",modelValue:i.Benefit,"onUpdate:modelValue":k=>i.Benefit=k,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])])],8,on)])]))),128)),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal-dark mt-3",onClick:o,type:"button"},[...d[8]||(d[8]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",rn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[0]||(d[0]=i=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[1]||(d[1]=i=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},dn={__name:"ProgressBar",setup(B){const y=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"其他",url:"Other"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,V)=>{const c=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(c,{steps:y,type:"culture"})}}},sn=(B,y)=>{const E=B.__vccOpts||B;for(const[V,c]of y)E[V]=c;return E},cn={class:"block"},mn={class:"mt-4"},Vn={class:"table align-middle gray-table side-table"},pn={class:"d-flex align-items-center gap-2"},fn={class:"input-group w-auto"},Nn={key:0,class:"invalid mt-0"},un={class:"square-title mt-4"},En={class:"mt-4"},bn=["onClick"],kn={class:"d-flex flex-column gap-2"},gn={class:"mt-4 d-flex flex-column gap-2"},yn={class:"d-flex flex-column gap-3 mt-4"},hn={class:"bg-light-teal p-3 text-gray d-flex align-items-center gap-3"},$n={class:"d-flex gap-2 align-items-center flex-grow-1"},Bn={class:"text-nowrap"},xn={class:"flex-grow-1"},Cn={class:"d-flex gap-2"},_n=["onClick"],Tn=["href"],wn=["id"],Sn={class:"table align-middle gray-table side-table mb-0"},Dn={class:"p-0"},Un={class:"item-list"},An={class:"mt-2 align-self-start text-center"},On={class:"input-group"},Mn={key:0,class:"invalid mt-0"},Fn={key:0,class:"d-flex gap-2 mt-1 align-self-start"},In=["onClick"],jn=["onClick"],Pn={class:"row"},zn={class:"col"},qn=["value"],Ln={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Rn=["onClick"],Jn=["onClick"],Qn={class:"col"},Wn=["value"],Gn={key:0,class:"col-2 d-flex gap-2 mt-1 align-self-start"},Yn=["onClick"],Hn=["onClick"],Zn=["onClick"],Kn={key:0,class:"block-bottom bg-light-teal"},Xn=sn({__name:"WorkSchedule",props:{id:{type:Number}},setup(B){const y=B,E=e.computed(()=>I("culture",m.value.Status)),V=e.ref({}),c=e.computed(()=>n.value.filter(i=>!i.Deleted)),m=e.ref({}),n=e.ref([]),o=()=>{const i={Items:[]};r(i),n.value.push(i)},r=i=>{const N={Steps:[],Schedules:[]};s(N),s(N),s(N),a(N,1),a(N,2),i.Items.push(N)},a=(i,N)=>i.Schedules.push({Type:N,Month:0,StepID:0}),s=i=>i.Steps.push({Begin:0,End:0}),f=i=>i.Deleted=!0,d=i=>i.Deleted=!0,u=i=>i.Deleted=!0,h=i=>i.Deleted=!0,l=i=>{if(V.value={},i&&!t()){e.nextTick(()=>{var k;return(k=document.querySelector(".invalid"))==null?void 0:k.scrollIntoView({behavior:"smooth",block:"center"})});return}const N={Project:m.value,Goals:n.value,Submit:i?"true":"false"};w.culture("saveWorkSchedule",N).subscribe(()=>{i?window.location.href=`Funding.aspx?ID=${y.id}`:window.location.reload()})},t=()=>{const i={StartTime:"計畫期程",EndTime:"計畫期程"};V.value=S(m.value,i);const N={Title:"計畫目標",Content:"預期效益"},k={Title:"重要工作項目",Indicator:"績效指標"},T={Title:"實施步驟",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}}},x={Month:{numericality:{greaterThan:0,message:"^請選擇月份"}},StepID:{numericality:{greaterThan:0,message:"^請選擇實施步驟"}}};return n.value.filter(g=>!g.Deleted).forEach((g,p)=>{Object.assign(V.value,S(g,N,`goal-${p}-`)),g.Items.filter(b=>!b.Deleted).forEach((b,C)=>{Object.assign(V.value,S(b,k,`item-${p}-${C}-`)),b.Steps.filter(_=>!_.Deleted).forEach((_,D)=>Object.assign(V.value,S(_,T,`step-${p}-${C}-${D}-`))),b.Schedules.filter(_=>_.Type===1&&!_.Deleted).forEach((_,D)=>Object.assign(V.value,S(_,x,`schedule-${p}-${C}-1-${D}-`))),b.Schedules.filter(_=>_.Type===2&&!_.Deleted).forEach((_,D)=>Object.assign(V.value,S(_,x,`schedule-${p}-${C}-2-${D}-`)))})}),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.culture("getWorkSchedule",{ID:y.id})]).subscribe(i=>{const N=i[0];m.value=N.Project,n.value=N.Goals,n.value.length||o(),M().culture={step:m.value.FormStep,status:m.value.Status,organizer:m.value.Organizer,organizerName:m.value.OrganizerName}})}),e.provide("editable",E),(i,N)=>{const k=e.resolveComponent("required-label"),T=e.resolveComponent("input-tw-date"),x=e.resolveComponent("input-text"),g=e.resolveComponent("input-textarea"),p=e.resolveComponent("input-month"),b=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",cn,[N[24]||(N[24]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",mn,[e.createElementVNode("table",Vn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...N[4]||(N[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",pn,[e.createElementVNode("div",fn,[e.createVNode(T,{class:"w-auto",modelValue:e.unref(m).StartTime,"onUpdate:modelValue":N[0]||(N[0]=C=>e.unref(m).StartTime=C)},null,8,["modelValue"]),N[5]||(N[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(T,{class:"w-auto",modelValue:e.unref(m).EndTime,"onUpdate:modelValue":N[1]||(N[1]=C=>e.unref(m).EndTime=C)},null,8,["modelValue"])]),N[6]||(N[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(V).StartTime||e.unref(V).EndTime?(e.openBlock(),e.createElementBlock("div",Nn,e.toDisplayString(e.unref(V).StartTime||e.unref(V).EndTime),1)):e.createCommentVNode("",!0)])])])])]),e.createElementVNode("h5",un,[N[8]||(N[8]=e.createTextVNode(" 計畫目標與內容 ",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal-dark ms-3",onClick:o,type:"button"},[...N[7]||(N[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1),e.createTextVNode("新增計畫目標",-1)])])):e.createCommentVNode("",!0)]),e.createElementVNode("div",En,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(C,_)=>(e.openBlock(),e.createElementBlock("div",{class:"block-form mt-3",key:C},[e.unref(E)&&e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-teal del",onClick:D=>f(C),type:"button"},"刪除",8,bn)):e.createCommentVNode("",!0),e.createElementVNode("div",kn,[N[9]||(N[9]=e.createElementVNode("label",{class:"text-teal-dark"},"計畫目標",-1)),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`goal-${_}-Title`],modelValue:C.Title,"onUpdate:modelValue":D=>C.Title=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",gn,[N[10]||(N[10]=e.createElementVNode("label",{class:"text-teal-dark"},"預期效益（含量化或質化說明）",-1)),e.createElementVNode("div",null,[e.createVNode(g,{error:e.unref(V)[`goal-${_}-Content`],rows:"4",modelValue:C.Content,"onUpdate:modelValue":D=>C.Content=D,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",yn,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(C.Items.filter(D=>!D.Deleted),(D,O)=>(e.openBlock(),e.createElementBlock("div",{class:"border",key:D},[e.createElementVNode("div",hn,[e.createElementVNode("div",$n,[e.createElementVNode("label",Bn,[e.createVNode(k,null,{default:e.withCtx(()=>[...N[11]||(N[11]=[e.createTextVNode("重要工作項目",-1)])]),_:1})]),e.createElementVNode("div",xn,[e.createVNode(x,{error:e.unref(V)[`item-${_}-${O}-Title`],modelValue:D.Title,"onUpdate:modelValue":U=>D.Title=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("div",Cn,[e.unref(E)&&C.Items.filter(U=>!U.Deleted).length>1?(e.openBlock(),e.createElementBlock("a",{key:0,class:"link-teal",onClick:e.withModifiers(U=>d(D),["prevent"]),href:"#"},"刪除",8,_n)):e.createCommentVNode("",!0),e.createElementVNode("a",{"aria-expanded":"true",class:"link-teal","data-bs-toggle":"collapse",href:`#collapse-${O}`,role:"button"},"收合",8,Tn)])]),e.createElementVNode("div",{class:"collapse show",id:`collapse-${O}`},[e.createElementVNode("table",Sn,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...N[12]||(N[12]=[e.createTextVNode("實施步驟",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("及起迄月份",-1)])]),_:1})]),e.createElementVNode("td",Dn,[e.createElementVNode("ul",Un,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Steps.filter(U=>!U.Deleted),(U,j)=>(e.openBlock(),e.createElementBlock("li",{class:e.normalizeClass(["step-item section-wrapper",{disabled:!e.unref(E)}]),key:U},[e.createElementVNode("div",An,e.toDisplayString(String.fromCharCode(65+j)),1),e.createElementVNode("div",null,[e.createVNode(x,{error:e.unref(V)[`step-${_}-${O}-${j}-Title`],placeholder:"如:進行口訪紀錄",modelValue:U.Title,"onUpdate:modelValue":A=>U.Title=A,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",null,[e.createElementVNode("div",On,[e.createVNode(p,{"empty-value":0,modelValue:U.Begin,"onUpdate:modelValue":A=>U.Begin=A},null,8,["modelValue","onUpdate:modelValue"]),N[13]||(N[13]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(p,{"empty-value":0,modelValue:U.End,"onUpdate:modelValue":A=>U.End=A},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(V)[`step-${_}-${O}-${j}-Begin`]||e.unref(V)[`step-${_}-${O}-${j}-End`]?(e.openBlock(),e.createElementBlock("div",Mn,e.toDisplayString(e.unref(V)[`step-${_}-${O}-${j}-Begin`]||e.unref(V)[`step-${_}-${O}-${j}-End`]),1)):e.createCommentVNode("",!0)]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Fn,[D.Steps.filter(A=>!A.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>h(U),type:"button"},[...N[14]||(N[14]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,In)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:A=>s(D),type:"button"},[...N[15]||(N[15]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,jn)])):e.createCommentVNode("",!0)],2))),128))])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...N[16]||(N[16]=[e.createTextVNode("績效指標",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(V)[`item-${_}-${O}-Indicator`],placeholder:"如:完成口訪資料1篇",modelValue:D.Indicator,"onUpdate:modelValue":U=>D.Indicator=U,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(k,null,{default:e.withCtx(()=>[...N[17]||(N[17]=[e.createTextVNode("工作進度",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Pn,[e.createElementVNode("div",zn,[N[20]||(N[20]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 50% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Schedules.filter(U=>U.Type===1&&!U.Deleted),(U,j)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:U},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?3:4}`])},[e.createVNode(p,{error:e.unref(V)[`schedule-${_}-${O}-1-${j}-Month`],"empty-value":0,modelValue:U.Month,"onUpdate:modelValue":A=>U.Month=A},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?7:8}`])},[e.createVNode(b,{"empty-value":0,error:e.unref(V)[`schedule-${_}-${O}-1-${j}-StepID`],options:D.Steps.filter(A=>!A.Deleted),modelValue:U.StepID,"onUpdate:modelValue":A=>U.StepID=A},{default:e.withCtx(({index:A,option:L})=>[e.createElementVNode("option",{value:L.ID},e.toDisplayString(String.fromCharCode(65+A))+"."+e.toDisplayString(L.Title),9,qn)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Ln,[D.Schedules.filter(A=>A.Type===1&&!A.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>u(U),type:"button"},[...N[18]||(N[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Rn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:A=>a(D,1),type:"button"},[...N[19]||(N[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Jn)])):e.createCommentVNode("",!0)]))),128))]),e.createElementVNode("div",Qn,[N[23]||(N[23]=e.createElementVNode("div",{class:"fs-16 text-gray"},"工作進度達 100% 應檢核工作",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(D.Schedules.filter(U=>U.Type===2&&!U.Deleted),(U,j)=>(e.openBlock(),e.createElementBlock("div",{class:"row g-2 align-items-center mt-2 section-wrapper",key:U},[e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?3:4}`])},[e.createVNode(p,{error:e.unref(V)[`schedule-${_}-${O}-2-${j}-Month`],"empty-value":0,modelValue:U.Month,"onUpdate:modelValue":A=>U.Month=A},null,8,["error","modelValue","onUpdate:modelValue"])],2),e.createElementVNode("div",{class:e.normalizeClass(["mt-0",`col-${e.unref(E)?7:8}`])},[e.createVNode(b,{"empty-value":0,error:e.unref(V)[`schedule-${_}-${O}-2-${j}-StepID`],options:D.Steps.filter(A=>!A.Deleted),modelValue:U.StepID,"onUpdate:modelValue":A=>U.StepID=A},{default:e.withCtx(({index:A,option:L})=>[e.createElementVNode("option",{value:L.ID},e.toDisplayString(String.fromCharCode(65+A))+"."+e.toDisplayString(L.Title),9,Wn)]),_:2},1032,["error","options","modelValue","onUpdate:modelValue"])],2),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Gn,[D.Schedules.filter(A=>A.Type===2&&!A.Deleted).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:A=>u(U),type:"button"},[...N[21]||(N[21]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Yn)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn btn-sm btn-teal-dark m-0 add-btn",onClick:A=>a(D,2),type:"button"},[...N[22]||(N[22]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])],8,Hn)])):e.createCommentVNode("",!0)]))),128))])])])])])])],8,wn)]))),128))]),e.unref(E)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-teal mt-3",onClick:D=>r(C),type:"button"},"新增工作項目",8,Zn)):e.createCommentVNode("",!0)]))),128))])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",Kn,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:N[2]||(N[2]=C=>l()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:N[3]||(N[3]=C=>l(!0)),type:"button"},[...N[25]||(N[25]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},[["__scopeId","data-v-8e051969"]]),vn={class:"block"},er={class:"mt-4"},tr={class:"table align-middle gray-table side-table"},lr={key:0},or={key:1,class:"text-light-gray"},nr={class:"d-flex flex-column gap-2"},rr={key:0},ar={class:"mt-4"},dr={class:"table align-middle gray-table side-table"},sr={class:"row g-3"},ir={class:"col-12 col-xl-2"},cr={class:"text-gray mb-2"},mr={class:"col-12 col-xl-3"},Vr={class:"text-gray mb-2"},pr={key:0,class:"col-12 col-xl-4"},fr={class:"row g-1"},Nr={class:"col-7"},ur={class:"col-5"},Er={key:1,class:"col-12 col-xl-3"},br={class:"text-gray mb-2"},kr={class:"mt-4"},gr={class:"table align-middle gray-table side-table"},yr={class:"d-flex align-items-center gap-2"},hr={class:"input-group w-auto"},$r={key:0,class:"invalid mt-0"},Br={class:"mt-4"},xr={class:"table-responsive mt-3 mb-0"},Cr={class:"table align-middle gray-table"},_r={class:"text-end"},Tr={class:"text-end"},wr={class:"text-end"},Sr={class:"text-end"},Dr={class:"text-end"},Ur={class:"table align-middle gray-table side-table"},Ar={key:0,class:"table-responsive mt-3 mb-0"},Or={class:"table align-middle gray-table"},Mr={key:0},Fr={key:0},Ir={class:"d-flex gap-2"},jr=["onClick"],Pr={key:0,class:"block-bottom bg-light-teal"},zr={__name:"Application",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.ref(),c=e.computed(()=>I("education",o.value.Status)),m=e.ref({}),n=e.computed(()=>r.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref(0),s=e.computed({get:()=>!!n.value.length,set:l=>{l?f():r.value.forEach(t=>t.Deleted=!0)}}),f=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(m.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Contacts:V.value,ReceivedSubsidies:r.value.filter(i=>i.ID||!i.Deleted),Submit:l?"true":"false"};w.education("saveApplication",t).subscribe(i=>{l?window.location.href=`Attachment.aspx?ID=${i.ID}`:o.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${i.ID}`})},h=()=>{let l={ProjectName:"計畫名稱",OrgCategory:"申請單位類型",OrgName:"申請單位",TaxID:"統一編號",Address:"地址",StartTime:"計畫期程",EndTime:"計畫期程",Target:"參加對象及人數",Summary:"計畫內容摘要",Quantified:"預期效益",ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}},SelfAmount:"申請單位自籌款",OtherGovAmount:"其他政府機關補助經費",OtherUnitAmount:"其他單位補助經費"};return o.value.OrgCategory==="2"&&(l.RegisteredNum="立案登記證字號"),m.value=S(o.value,l),l={Name:"姓名",JobTitle:"職稱"},Object.assign(m.value,S(V.value[0],l,"contact-0-")),l.MobilePhone="手機號碼",Object.assign(m.value,S(V.value[1],l,"contact-1-")),l={Name:"計畫名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入海委會補助經費"},numericality:{greaterThan:0,message:"^海委會補助經費不可為 0"}}},r.value.forEach((t,i)=>Object.assign(m.value,S(t,l,`received-${i}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.education("getZgsCodes",{CodeGroup:"EDCOrgCategory"})]).subscribe(l=>{E.value=l[0],y.id?w.education("getApplication",{ID:y.id}).subscribe(t=>{o.value=t.Project,V.value=t.Contacts,r.value=t.ReceivedSubsidies,o.value.OrgCategory=o.value.OrgCategory||null,M().education={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}}):w.education("getEmptyApplication").subscribe(t=>{o.value=Object.assign({OrgCategory:null,FormStep:1,Status:1},t),V.value=[{Role:"負責人"},{Role:"聯絡人"}],M().education={step:o.value.FormStep,status:o.value.Status}})})}),e.provide("editable",c),(l,t)=>{const i=e.resolveComponent("required-label"),N=e.resolveComponent("input-text"),k=e.resolveComponent("input-select"),T=e.resolveComponent("input-tw-date"),x=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-integer"),p=e.resolveComponent("input-boolean");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",vn,[t[47]||(t[47]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",er,[e.createElementVNode("table",tr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[18]||(t[18]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).Year),1)]),e.createElementVNode("tr",null,[t[19]||(t[19]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(o).ProjectID?(e.openBlock(),e.createElementBlock("span",lr,e.toDisplayString(e.unref(o).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",or,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[20]||(t[20]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).ProjectName,modelValue:e.unref(o).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=b=>e.unref(o).ProjectName=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("申請單位類型",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",nr,[e.createElementVNode("div",null,[e.createVNode(k,{"empty-value":null,error:e.unref(m).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o).OrgCategory,"onUpdate:modelValue":t[1]||(t[1]=b=>e.unref(o).OrgCategory=b)},null,8,["error","options","modelValue"])]),e.unref(o).OrgCategory==="2"?(e.openBlock(),e.createElementBlock("div",rr,[e.createVNode(N,{error:e.unref(m).RegisteredNum,prefix:"立案登記證字號",modelValue:e.unref(o).RegisteredNum,"onUpdate:modelValue":t[2]||(t[2]=b=>e.unref(o).RegisteredNum=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])):e.createCommentVNode("",!0)])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(o).OrgName,"onUpdate:modelValue":t[3]||(t[3]=b=>e.unref(o).OrgName=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[24]||(t[24]=[e.createTextVNode("統一編號",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).TaxID,modelValue:e.unref(o).TaxID,"onUpdate:modelValue":t[4]||(t[4]=b=>e.unref(o).TaxID=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).Address,placeholder:"請輸入地址",modelValue:e.unref(o).Address,"onUpdate:modelValue":t[5]||(t[5]=b=>e.unref(o).Address=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[48]||(t[48]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",ar,[e.createElementVNode("table",dr,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(b.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",sr,[e.createElementVNode("div",ir,[e.createElementVNode("div",cr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${C}-Name`],modelValue:b.Name,"onUpdate:modelValue":_=>b.Name=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",mr,[e.createElementVNode("div",Vr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${C}-JobTitle`],modelValue:b.JobTitle,"onUpdate:modelValue":_=>b.JobTitle=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),C?(e.openBlock(),e.createElementBlock("div",pr,[t[28]||(t[28]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",fr,[e.createElementVNode("div",Nr,[e.createVNode(N,{modelValue:b.Phone,"onUpdate:modelValue":_=>b.Phone=_,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ur,[e.createVNode(N,{placeholder:"請輸入分機",size:"4",modelValue:b.PhoneExt,"onUpdate:modelValue":_=>b.PhoneExt=_,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])])):e.createCommentVNode("",!0),C?(e.openBlock(),e.createElementBlock("div",Er,[e.createElementVNode("div",br,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${C}-MobilePhone`],modelValue:b.MobilePhone,"onUpdate:modelValue":_=>b.MobilePhone=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])):e.createCommentVNode("",!0)])])]))),128))])])]),t[49]||(t[49]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",kr,[e.createElementVNode("table",gr,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",yr,[e.createElementVNode("div",hr,[e.createVNode(T,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[6]||(t[6]=b=>e.unref(o).StartTime=b)},null,8,["modelValue"]),t[31]||(t[31]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(T,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[7]||(t[7]=b=>e.unref(o).EndTime=b)},null,8,["modelValue"])]),t[32]||(t[32]=e.createElementVNode("span",{class:"text-teal-dark"},"(計畫執行期間不得跨年度)",-1))]),e.unref(m).StartTime||e.unref(m).EndTime?(e.openBlock(),e.createElementBlock("div",$r,e.toDisplayString(e.unref(m).StartTime||e.unref(m).EndTime),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[33]||(t[33]=[e.createTextVNode("參加對象及人數",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).Target,modelValue:e.unref(o).Target,"onUpdate:modelValue":t[8]||(t[8]=b=>e.unref(o).Target=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[34]||(t[34]=[e.createTextVNode("計畫內容摘要",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).Summary,"max-length":500,placeholder:"請輸入計畫內容摘要",rows:"4",modelValue:e.unref(o).Summary,"onUpdate:modelValue":t[9]||(t[9]=b=>e.unref(o).Summary=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[35]||(t[35]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(建議條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(m).Quantified,"max-length":500,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Quantified,"onUpdate:modelValue":t[10]||(t[10]=b=>e.unref(o).Quantified=b),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[50]||(t[50]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫經費",-1)),e.createElementVNode("div",Br,[t[41]||(t[41]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"其他單位及政府機關補助經費等欄，請詳實填寫；未接受補助者，請填寫0。經費單位為新臺幣(元)。")],-1)),e.createElementVNode("div",xr,[e.createElementVNode("table",Cr,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",_r,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[36]||(t[36]=[e.createTextVNode("申請海委會",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Tr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[37]||(t[37]=[e.createTextVNode("申請單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("自籌款",-1)])]),_:1})]),e.createElementVNode("th",wr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[38]||(t[38]=[e.createTextVNode("其他政府機關",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費",-1)])]),_:1})]),e.createElementVNode("th",Sr,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[39]||(t[39]=[e.createTextVNode("其他單位",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("補助經費（含總收費）",-1)])]),_:1})]),t[40]||(t[40]=e.createElementVNode("th",{class:"text-end"},"計畫總經費",-1))])]),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m).ApplyAmount,modelValue:e.unref(o).ApplyAmount,"onUpdate:modelValue":t[11]||(t[11]=b=>e.unref(o).ApplyAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m).SelfAmount,modelValue:e.unref(o).SelfAmount,"onUpdate:modelValue":t[12]||(t[12]=b=>e.unref(o).SelfAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m).OtherGovAmount,modelValue:e.unref(o).OtherGovAmount,"onUpdate:modelValue":t[13]||(t[13]=b=>e.unref(o).OtherGovAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m).OtherUnitAmount,modelValue:e.unref(o).OtherUnitAmount,"onUpdate:modelValue":t[14]||(t[14]=b=>e.unref(o).OtherUnitAmount=b)},null,8,["error","modelValue"])]),e.createElementVNode("td",Dr,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])])]),e.createElementVNode("table",Ur,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[42]||(t[42]=[e.createTextVNode("最近兩年曾獲",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("本會補助",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(p,{modelValue:e.unref(s),"onUpdate:modelValue":t[15]||(t[15]=b=>e.isRef(s)?s.value=b:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",Ar,[e.createElementVNode("table",Or,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[43]||(t[43]=e.createElementVNode("th",null,"計畫名稱",-1)),t[44]||(t[44]=e.createElementVNode("th",{class:"text-end"},"海委會補助經費",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",Mr,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(b,C)=>(e.openBlock(),e.createElementBlock("tr",{key:b},[e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m)[`received-${C}-Name`],modelValue:b.Name,"onUpdate:modelValue":_=>b.Name=_,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m)[`received-${C}-Amount`],modelValue:b.Amount,"onUpdate:modelValue":_=>b.Amount=_},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",Fr,[e.createElementVNode("div",Ir,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:_=>d(b),type:"button"},[...t[45]||(t[45]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jr)):e.createCommentVNode("",!0),C+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[46]||(t[46]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Pr,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[16]||(t[16]=b=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[17]||(t[17]=b=>u(!0)),type:"button"},[...t[51]||(t[51]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},qr={class:"block"},Lr={key:0,class:"text-pink lh-base mt-4"},Rr={class:"mt-4"},Jr={class:"table align-middle gray-table"},Qr={class:"text-center"},Wr={key:0,width:"180"},Gr={class:"text-center"},Yr={key:0},Hr=["innerHTML"],Zr={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Kr={key:0,class:"text-center"},Xr={key:0},vr={key:1,class:"text-pink"},ea={key:1,class:"tag-group mt-2 gap-1"},ta={key:0,class:"tag tag-green-light"},la=["download","href"],oa=["onClick"],na={key:0,class:"block-bottom bg-light-teal"},ra=["disabled"],aa={__name:"Attachment",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]}]),V=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),c=e.computed(()=>I("education",m.value.Status)),m=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:m.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=w.download,r=a=>{const s={ID:y.id,Attachments:E.value.reduce((f,d)=>f.concat(d.Files),[]),Submit:a?"true":"false"};w.education("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([w.education("getAttachment",{ID:y.id})]).subscribe(a=>{const s=a[0];m.value=s.Project,E.value=E.value.filter(f=>{var d;return!((d=f.Excludes)!=null&&d.includes(m.value.OrgCategory))}),E.value.forEach(f=>{f.Files=s.Attachments.filter(d=>d.Type===f.Type),f.Uploaded=e.computed(()=>f.Files.filter(d=>!d.Deleted).length)}),M().education={step:m.value.FormStep,status:m.value.Status,organizer:m.value.Organizer,organizerName:m.value.OrganizerName}})}),e.provide("editable",c),(a,s)=>{const f=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",qr,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("p",Lr,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 請以紙本公文發文郵寄本會憑辦，附件需含資料表或申請書(正本；須加蓋學校、單位關防及負責人核章)、計畫書、未違反公職人員利益衝突迴避法切結書及事前揭露表(正本；須加蓋學校、單位關防及負責人核章)，及相關佐證資料(如社團成立證明、社團運作證明、有效期間內之當選證書、登記證書等) ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Rr,[e.createElementVNode("table",Jr,[e.createElementVNode("thead",Qr,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",Wr,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,h)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Gr,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Yr,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(f,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(c)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Hr)):e.createCommentVNode("",!0),e.unref(c)&&u.Template?(e.openBlock(),e.createElementBlock("button",Zr,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",Kr,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",Xr,"已上傳")):(e.openBlock(),e.createElementBlock("span",vr,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(c)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",ea,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",ta,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,la),e.unref(c)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,oa)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",na,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(V),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,ra)])):e.createCommentVNode("",!0)],64)}}},da={__name:"ProgressBar",setup(B){const y=[{step:1,title:"申請表／計畫書",url:"Application"},{step:2,title:"上傳附件／提送申請",url:"Attachment"}];return(E,V)=>{const c=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(c,{steps:y,type:"education"})}}},sa={class:"modal-dialog modal-dialog-centered modal-md"},ia={class:"modal-content"},ca={class:"modal-body"},ma={class:"d-flex flex-column align-items-center mb-5 gap-3"},Va={class:"fs-18"},pa={__name:"ErrorModal",setup(B){const y=R(),E=e.ref();return e.onMounted(()=>E.value.addEventListener("hidden.bs.modal",()=>y.error=null)),e.watch(()=>y.error,()=>{y.error&&bootstrap.Modal.getOrCreateInstance(E.value).show()}),(V,c)=>(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:E,tabindex:"-1"},[e.createElementVNode("div",sa,[e.createElementVNode("div",ia,[c[2]||(c[2]=e.createElementVNode("div",{class:"modal-header"},[e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})])],-1)),e.createElementVNode("div",ca,[e.createElementVNode("div",ma,[c[0]||(c[0]=e.createElementVNode("h4",{class:"text-danger fw-bold"},"錯誤",-1)),e.createElementVNode("div",Va,e.toDisplayString(e.unref(y).error),1)]),c[1]||(c[1]=e.createElementVNode("div",{class:"d-flex gap-4 flex-wrap justify-content-center"},[e.createElementVNode("button",{class:"btn btn-danger","data-bs-dismiss":"modal",type:"button"}," 確認 ")],-1))])])])],512)]))}},fa={__name:"InputBoolean",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const y=e.useModel(B,"modelValue"),E=[{value:!0,text:"是"},{value:!1,text:"否"}];return(V,c)=>{const m=e.resolveComponent("input-radio-group");return e.openBlock(),e.createBlock(m,{options:E,modelValue:y.value,"onUpdate:modelValue":c[0]||(c[0]=n=>y.value=n)},null,8,["modelValue"])}}},Na=Object.assign({inheritAttrs:!1},{__name:"InputFile",emits:["file"],setup(B,{emit:y}){const E=e.ref(),V=()=>{Array.from(E.value.files).forEach(m=>w.upload(m).subscribe(n=>c("file",n))),E.value.value=""},c=y;return(m,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("button",{class:"btn btn-teal-dark",onClick:n[0]||(n[0]=o=>e.unref(E).click()),type:"button"},[...n[1]||(n[1]=[e.createElementVNode("i",{class:"fas fa-file-upload me-1"},null,-1),e.createTextVNode("上傳",-1)])]),e.createElementVNode("input",e.mergeProps({onChange:V,class:"d-none",ref_key:"input",ref:E,type:"file"},m.$attrs),null,16)],64))}}),ua=["disabled","placeholder","type"],Ea={key:0,class:"invalid mt-0"},ba=Object.assign({inheritAttrs:!1},{__name:"InputInteger",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const y=e.inject("editable",!0),E=e.useModel(B,"modelValue");return e.watch(E,V=>{if(V){const c=(parseInt(V)||0).toString();V.toString()!==c&&(E.value=c)}}),(V,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(y),placeholder:e.unref(y)?B.placeholder:"",style:{"text-align":"right"},type:B.type},V.$attrs,{"onUpdate:modelValue":c[0]||(c[0]=m=>E.value=m)}),null,16,ua),[[e.vModelDynamic,E.value]]),B.error?(e.openBlock(),e.createElementBlock("div",Ea,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),ka={__name:"InputMonth",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(B){const y=e.useModel(B,"modelValue"),E=[];for(let V=1;V<=12;V++)E.push({value:V,text:`${V}月`});return(V,c)=>{const m=e.resolveComponent("input-select");return e.openBlock(),e.createBlock(m,{options:E,modelValue:y.value,"onUpdate:modelValue":c[0]||(c[0]=n=>y.value=n)},null,8,["modelValue"])}}},ga=["onChange","checked","disabled","id","value"],ya=["for"],ha={__name:"InputRadioGroup",props:e.mergeModels({id:{default:()=>H(),type:String},options:{default:[],type:Array},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const y=e.inject("editable",!0),E=e.useModel(B,"modelValue"),V=c=>{E.value=c};return(c,m)=>(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,n=>(e.openBlock(),e.createElementBlock("div",{class:"form-check form-check-inline mb-0",key:n},[e.createElementVNode("input",{onChange:o=>V(n[B.valueName]),checked:n[B.valueName]===E.value,class:"form-check-input",disabled:!e.unref(y),id:`${B.id}-${n[B.valueName]}`,type:"radio",value:n[B.valueName]},null,40,ga),e.createElementVNode("label",{class:"form-check-label",for:`${B.id}-${n[B.valueName]}`},e.toDisplayString(n[B.textName]),9,ya)]))),128))}},$a=["disabled"],Ba=["value"],xa=["value"],Ca={key:0,class:"invalid mt-0"},_a=Object.assign({inheritAttrs:!1},{__name:"InputSelect",props:e.mergeModels({disabled:{default:!1,type:Boolean},emptyValue:{type:[Number,String]},error:{type:String},options:{default:[],type:Array},placeholder:{default:"請選擇",type:String},textName:{default:"text",type:String},valueName:{default:"value",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const y=e.inject("editable",!0),E=e.useModel(B,"modelValue");return(V,c)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("select",e.mergeProps({class:"form-select",disabled:B.disabled||!e.unref(y)},V.$attrs,{"onUpdate:modelValue":c[0]||(c[0]=m=>E.value=m)}),[e.unref(y)&&!E.value?(e.openBlock(),e.createElementBlock("option",{key:0,value:B.emptyValue},e.toDisplayString(B.placeholder),9,Ba)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(B.options,(m,n)=>e.renderSlot(V.$slots,"default",{key:m,index:n,option:m},()=>[e.createElementVNode("option",{value:m[B.valueName]},e.toDisplayString(m[B.textName]),9,xa)])),128))],16,$a),[[e.vModelSelect,E.value]]),B.error?(e.openBlock(),e.createElementBlock("div",Ca,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),Ta={class:"input-group"},wa={key:0,class:"input-group-text"},Sa=["disabled","placeholder","type"],Da={key:0,class:"invalid mt-0"},Ua=Object.assign({inheritAttrs:!1},{__name:"InputText",props:e.mergeModels({error:{type:String},placeholder:{default:"請輸入",type:String},prefix:{type:String},type:{default:"text",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const y=e.inject("editable",!0),E=e.useModel(B,"modelValue");return(V,c)=>{const m=e.resolveComponent("required-label");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Ta,[B.prefix?(e.openBlock(),e.createElementBlock("span",wa,[e.createVNode(m,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(B.prefix),1)]),_:1})])):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(y),placeholder:e.unref(y)?B.placeholder:"",type:B.type},V.$attrs,{"onUpdate:modelValue":c[0]||(c[0]=n=>E.value=n)}),null,16,Sa),[[e.vModelDynamic,E.value]])]),B.error?(e.openBlock(),e.createElementBlock("div",Da,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),Aa=["disabled","placeholder"],Oa={key:0,class:"fs-14 text-gray mt-2"},Ma={class:"text-pink"},Fa={key:1,class:"invalid mt-0"},Ia=Object.assign({inheritAttrs:!1},{__name:"InputTextarea",props:e.mergeModels({error:{type:String},maxLength:{type:Number},placeholder:{default:"請輸入",type:String}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(B){const y=e.inject("editable",!0),E=e.useModel(B,"modelValue"),V=B;return V.maxLength&&e.watch(E,()=>{var c;((c=E.value)==null?void 0:c.length)>V.maxLength&&(E.value=E.value.substring(0,V.maxLength))}),(c,m)=>{var n;return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("textarea",e.mergeProps({class:"form-control",disabled:!e.unref(y),placeholder:e.unref(y)?B.placeholder:""},c.$attrs,{"onUpdate:modelValue":m[0]||(m[0]=o=>E.value=o)}),null,16,Aa),[[e.vModelText,E.value]]),e.unref(y)&&B.maxLength?(e.openBlock(),e.createElementBlock("div",Oa,[m[1]||(m[1]=e.createTextVNode(" 已輸入 ",-1)),e.createElementVNode("span",Ma,e.toDisplayString(((n=E.value)==null?void 0:n.length)||0),1),e.createTextVNode(" 個字數(限"+e.toDisplayString(B.maxLength)+"字數) ",1)])):e.createCommentVNode("",!0),B.error?(e.openBlock(),e.createElementBlock("div",Fa,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64)}}}),ja=["disabled"],Pa={key:0,class:"invalid"},za=Object.assign({inheritAttrs:!1},{__name:"InputTwDate",props:{displayFormat:{default:"tYY/MM/DD",type:String},drops:{default:"down",type:String},error:{type:String},format:{default:"YYYY-MM-DD",type:String},modelValue:{default:"",type:String},noFuture:{default:!1,type:Boolean}},emits:["update:modelValue"],setup(B,{emit:y}){let E;const V=B,c=e.ref(),m=e.inject("editable",!0),n=e.ref(),o=y,r=a=>{!a&&V.modelValue&&(a=moment(new Date(V.modelValue))),a?(c.value=a.format(V.displayFormat),o("update:modelValue",a.format(V.format))):(c.value="",o("update:modelValue","")),E.setStartDate(c.value||void 0)};return e.onMounted(()=>{const a=$(n.value);a.daterangepicker({autoApply:!0,autoUpdateInput:!1,drops:V.drops,locale:{format:V.displayFormat},maxDate:V.noFuture?new Date:void 0,showDropdowns:!0,singleDatePicker:!0}).on("apply.daterangepicker",(s,f)=>r(f.startDate)),E=a.data("daterangepicker"),r()}),e.onUnmounted(()=>E.remove()),e.watch(()=>V.modelValue,()=>r()),(a,s)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.withDirectives(e.createElementVNode("input",e.mergeProps({class:"form-control",disabled:!e.unref(m),ref_key:"element",ref:n,type:"text"},a.$attrs,{"onUpdate:modelValue":s[0]||(s[0]=f=>e.isRef(c)?c.value=f:null)}),null,16,ja),[[e.vModelText,e.unref(c)]]),B.error?(e.openBlock(),e.createElementBlock("div",Pa,e.toDisplayString(B.error),1)):e.createCommentVNode("",!0)],64))}}),qa={class:"block"},La={class:"mt-4"},Ra={class:"table align-middle gray-table side-table"},Ja={key:0},Qa={key:1,class:"text-light-gray"},Wa={class:"mt-4"},Ga={class:"table align-middle gray-table side-table"},Ya={class:"row g-3"},Ha={class:"col-12 col-xl-2"},Za={class:"text-gray mb-2"},Ka={class:"col-12 col-xl-3"},Xa={class:"text-gray mb-2"},va={class:"col-12 col-xl-4"},ed={class:"row g-1"},td={class:"col-7"},ld={class:"col-5"},od={class:"col-12 col-xl-3"},nd={class:"text-gray mb-2"},rd={class:"col-12"},ad={class:"text-gray mb-2"},dd={class:"mt-4"},sd={class:"table align-middle gray-table side-table"},id={class:"mt-4"},cd={class:"table align-middle gray-table side-table"},md={key:0,class:"table-responsive mt-3 mb-0"},Vd={class:"table align-middle gray-table"},pd={key:0},fd={key:0},Nd={class:"d-flex gap-2"},ud=["onClick"],Ed={key:0,class:"block-bottom bg-light-teal"},bd={__name:"Application",props:{id:{type:Number}},setup(B){const y=B,E=e.ref(),V=e.computed(()=>I("literacy",o.value.Status)),c=e.ref({}),m=e.ref([]),n=e.computed(()=>r.value.filter(h=>!h.Deleted)),o=e.ref({}),r=e.ref([]),a=e.computed({get:()=>!!n.value.length,set:h=>{h?s():r.value.forEach(l=>l.Deleted=!0)}}),s=()=>r.value.push({}),f=h=>h.Deleted=!0,d=h=>{if(c.value={},h&&!u()){e.nextTick(()=>{var t;return(t=document.querySelector(".invalid"))==null?void 0:t.scrollIntoView({behavior:"smooth",block:"center"})});return}const l={Project:o.value,Contacts:E.value,PreviousStudies:r.value.filter(t=>t.ID||!t.Deleted),Submit:h?"true":"false"};w.literacy("saveApplication",l).subscribe(t=>{h?window.location.href=`WorkSchedule.aspx?ID=${t.ID}`:o.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${t.ID}`})},u=()=>{let h={Field:"計畫類別",OrgName:"申請單位",OrgLeader:"校長姓名",Address:"學校地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return c.value=S(o.value,h),h={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},E.value.forEach((l,t)=>Object.assign(c.value,S(l,h,`contact-${t}-`))),h={Title:"研習/課程名稱",TheDate:"辦理日期"},r.value.forEach((l,t)=>Object.assign(c.value,S(l,h,`study-${t}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.literacy("getZgsCodes",{CodeGroup:"LITField"})]).subscribe(h=>{m.value=h[0],y.id?w.literacy("getApplication",{ID:y.id}).subscribe(l=>{o.value=l.Project,E.value=l.Contacts,r.value=l.PreviousStudies,M().literacy={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}}):w.literacy("getEmptyApplication").subscribe(l=>{o.value=Object.assign({Field:null,FormStep:1,Status:1},l),E.value=[{Role:"申請人"}],M().literacy={step:o.value.FormStep,status:o.value.Status}})})}),e.provide("editable",V),e.watch(()=>[o.value.Field,o.value.OrgName],()=>{var h;if(V.value){const l=[];o.value.Field&&l.push((h=m.value.find(t=>t.Code===o.value.Field))==null?void 0:h.Descname),o.value.OrgName&&l.push(o.value.OrgName),o.value.ProjectName=l.join("-")}}),(h,l)=>{const t=e.resolveComponent("required-label"),i=e.resolveComponent("input-text"),N=e.resolveComponent("input-select"),k=e.resolveComponent("input-textarea"),T=e.resolveComponent("input-boolean"),x=e.resolveComponent("input-tw-date");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",qa,[l[35]||(l[35]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",La,[e.createElementVNode("table",Ra,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[12]||(l[12]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).Year),1)]),e.createElementVNode("tr",null,[l[13]||(l[13]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(o).ProjectID?(e.openBlock(),e.createElementBlock("span",Ja,e.toDisplayString(e.unref(o).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Qa,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[l[14]||(l[14]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(o).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[15]||(l[15]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{disabled:"",modelValue:e.unref(o).ProjectName,"onUpdate:modelValue":l[0]||(l[0]=g=>e.unref(o).ProjectName=g),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[16]||(l[16]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{"empty-value":null,error:e.unref(c).Field,options:e.unref(m),"text-name":"Descname","value-name":"Code",modelValue:e.unref(o).Field,"onUpdate:modelValue":l[1]||(l[1]=g=>e.unref(o).Field=g)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[17]||(l[17]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(c).OrgName,placeholder:"請輸入學校全銜",modelValue:e.unref(o).OrgName,"onUpdate:modelValue":l[2]||(l[2]=g=>e.unref(o).OrgName=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[18]||(l[18]=[e.createTextVNode("校長姓名",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(c).OrgLeader,modelValue:e.unref(o).OrgLeader,"onUpdate:modelValue":l[3]||(l[3]=g=>e.unref(o).OrgLeader=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[19]||(l[19]=[e.createTextVNode("學校地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(c).Address,placeholder:"請輸入地址",modelValue:e.unref(o).Address,"onUpdate:modelValue":l[4]||(l[4]=g=>e.unref(o).Address=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),l[36]||(l[36]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Wa,[e.createElementVNode("table",Ga,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(g,p)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(g.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ya,[e.createElementVNode("div",Ha,[e.createElementVNode("div",Za,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[20]||(l[20]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(c)[`contact-${p}-Name`],modelValue:g.Name,"onUpdate:modelValue":b=>g.Name=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",Ka,[e.createElementVNode("div",Xa,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[21]||(l[21]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(c)[`contact-${p}-JobTitle`],modelValue:g.JobTitle,"onUpdate:modelValue":b=>g.JobTitle=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",va,[l[22]||(l[22]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",ed,[e.createElementVNode("div",td,[e.createVNode(i,{modelValue:g.Phone,"onUpdate:modelValue":b=>g.Phone=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ld,[e.createVNode(i,{placeholder:"請輸入分機",size:"4",modelValue:g.PhoneExt,"onUpdate:modelValue":b=>g.PhoneExt=b,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",od,[e.createElementVNode("div",nd,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[23]||(l[23]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(c)[`contact-${p}-MobilePhone`],modelValue:g.MobilePhone,"onUpdate:modelValue":b=>g.MobilePhone=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",rd,[e.createElementVNode("div",ad,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[24]||(l[24]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(i,{error:e.unref(c)[`contact-${p}-EMail`],modelValue:g.EMail,"onUpdate:modelValue":b=>g.EMail=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),l[37]||(l[37]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",dd,[e.createElementVNode("table",sd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[25]||(l[25]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[l[26]||(l[26]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(k,{error:e.unref(c).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(o).Target,"onUpdate:modelValue":l[5]||(l[5]=g=>e.unref(o).Target=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[27]||(l[27]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(c).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(o).Summary,"onUpdate:modelValue":l[6]||(l[6]=g=>e.unref(o).Summary=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[28]||(l[28]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(c).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Quantified,"onUpdate:modelValue":l[7]||(l[7]=g=>e.unref(o).Quantified=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(t,null,{default:e.withCtx(()=>[...l[29]||(l[29]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(c).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(o).Qualitative,"onUpdate:modelValue":l[8]||(l[8]=g=>e.unref(o).Qualitative=g),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",id,[e.createElementVNode("table",cd,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[l[34]||(l[34]=e.createElementVNode("th",null,"最近三年參與本會辦理之相關研習或課程",-1)),e.createElementVNode("td",null,[e.createVNode(T,{modelValue:e.unref(a),"onUpdate:modelValue":l[9]||(l[9]=g=>e.isRef(a)?a.value=g:null)},null,8,["modelValue"]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",md,[e.createElementVNode("table",Vd,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[l[30]||(l[30]=e.createElementVNode("th",null,"研習/課程名稱",-1)),l[31]||(l[31]=e.createElementVNode("th",null,"辦理日期",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",pd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(g,p)=>(e.openBlock(),e.createElementBlock("tr",{key:g},[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(c)[`study-${p}-Title`],modelValue:g.Title,"onUpdate:modelValue":b=>g.Title=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`study-${p}-TheDate`],modelValue:g.TheDate,"onUpdate:modelValue":b=>g.TheDate=b,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",fd,[e.createElementVNode("div",Nd,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:b=>f(g),type:"button"},[...l[32]||(l[32]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ud)):e.createCommentVNode("",!0),p+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...l[33]||(l[33]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Ed,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:l[10]||(l[10]=g=>d()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:l[11]||(l[11]=g=>d(!0)),type:"button"},[...l[38]||(l[38]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},kd={class:"block"},gd={key:0,class:"text-pink lh-base mt-4"},yd={class:"mt-4"},hd={class:"table align-middle gray-table"},$d={class:"text-center"},Bd={key:0,width:"180"},xd={class:"text-center"},Cd={key:0},_d=["innerHTML"],Td={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},wd={key:0,class:"text-center"},Sd={key:0},Dd={key:1,class:"text-pink"},Ud={key:1,class:"tag-group mt-2 gap-1"},Ad={key:0,class:"tag tag-green-light"},Od=["download","href"],Md=["onClick"],Fd={key:0,class:"block-bottom bg-light-teal"},Id=["disabled"],jd={__name:"Attachment",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"著作權授權同意書",Template:!0,Files:[]},{Type:6,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),V=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),c=e.computed(()=>I("literacy",m.value.Status)),m=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:m.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=w.download,r=a=>{const s={ID:y.id,Attachments:E.value.reduce((f,d)=>f.concat(d.Files),[]),Submit:a?"true":"false"};w.literacy("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([w.literacy("getAttachment",{ID:y.id})]).subscribe(a=>{const s=a[0];m.value=s.Project,E.value=E.value.filter(f=>{var d;return!((d=f.Excludes)!=null&&d.includes(m.value.OrgCategory))}),E.value.forEach(f=>{f.Files=s.Attachments.filter(d=>d.Type===f.Type),f.Uploaded=e.computed(()=>f.Files.filter(d=>!d.Deleted).length)}),M().literacy={step:m.value.FormStep,status:m.value.Status,organizer:m.value.Organizer,organizerName:m.value.OrganizerName}})}),e.provide("editable",c),(a,s)=>{const f=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",kd,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("p",gd,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",yd,[e.createElementVNode("table",hd,[e.createElementVNode("thead",$d,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",Bd,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,h)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",xd,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",Cd,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(f,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(c)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,_d)):e.createCommentVNode("",!0),e.unref(c)&&u.Template?(e.openBlock(),e.createElementBlock("button",Td,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",wd,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",Sd,"已上傳")):(e.openBlock(),e.createElementBlock("span",Dd,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(c)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Ud,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Ad,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,Od),e.unref(c)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,Md)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Fd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(V),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,Id)])):e.createCommentVNode("",!0)],64)}}},Pd={class:"block"},zd={class:"mt-4"},qd={class:"table-responsive mt-3 mb-0"},Ld={class:"table align-middle gray-table"},Rd={key:0,width:"1"},Jd={key:0},Qd={class:"d-flex gap-2"},Wd=["onClick"],Gd={class:"table-responsive mt-3 mb-0"},Yd={class:"table align-middle gray-table"},Hd={key:0,class:"block-bottom bg-light-teal"},Zd={__name:"Benefit",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.computed(()=>I("literacy",n.value.Status)),c=e.ref({}),m=e.computed(()=>E.value.filter(f=>!f.Deleted)),n=e.ref({}),o=()=>E.value.push({}),r=f=>f.Deleted=!0,a=f=>{if(c.value={},f&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Project:n.value,Benefits:E.value,Submit:f?"true":"false"};w.literacy("saveBenefit",d).subscribe(()=>{f?window.location.href=`Attachment.aspx?ID=${y.id}`:window.location.reload()})},s=()=>{let f={Benefit:"不可量化成果"};return c.value=S(n.value,f),f={Title:"指標",Target:"目標值",Description:"說明"},m.value.forEach((d,u)=>Object.assign(c.value,S(d,f,`item-${u}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.literacy("getBenefit",{ID:y.id})]).subscribe(f=>{const d=f[0];n.value=d.Project,E.value=d.Benefits,E.value.length||o(),M().literacy={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",V),(f,d)=>{const u=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Pd,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",zd,[e.createElementVNode("div",qd,[e.createElementVNode("table",Ld,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[d[3]||(d[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),d[4]||(d[4]=e.createElementVNode("th",null,"目標值",-1)),d[5]||(d[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Rd,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(l,t)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(c)[`item-${t}-Title`],modelValue:l.Title,"onUpdate:modelValue":i=>l.Title=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(c)[`item-${t}-Target`],modelValue:l.Target,"onUpdate:modelValue":i=>l.Target=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(c)[`item-${t}-Description`],rows:"1",modelValue:l.Description,"onUpdate:modelValue":i=>l.Description=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Jd,[e.createElementVNode("div",Qd,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:i=>r(l),type:"button"},[...d[6]||(d[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Wd)):e.createCommentVNode("",!0),t+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...d[7]||(d[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Gd,[e.createElementVNode("table",Yd,[d[8]||(d[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(c).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":d[0]||(d[0]=l=>e.unref(n).Benefit=l),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Hd,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=l=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=l=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Kd={class:"block"},Xd={class:"mt-4"},vd={class:"table-responsive mt-3 mb-0"},es={class:"table align-middle gray-table"},ts={class:"text-end"},ls={class:"text-end"},os={class:"table-responsive"},ns={class:"table align-middle gray-table"},rs=["colspan"],as={key:0,width:"1"},ds={class:"text-end"},ss={key:0},is={class:"d-flex gap-2"},cs=["onClick"],ms={class:"mt-4"},Vs={class:"table-responsive mt-3 mb-0"},ps={class:"table align-middle gray-table"},fs={key:0,width:"1"},Ns={class:"text-end"},us={key:0},Es={class:"d-flex gap-2"},bs=["onClick"],ks={key:0,class:"block-bottom bg-light-teal"},gs={__name:"Funding",props:{id:{type:Number}},setup(B){const y=B,E=e.computed(()=>I("literacy",n.value.Status)),V=e.ref({}),c=e.computed(()=>o.value.filter(l=>!l.Deleted)),m=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref(0),s=()=>o.value.push({}),f=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(V.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,OtherSubsidies:o.value,BudgetPlans:r.value,Submit:l?"true":"false"};w.literacy("saveFunding",t).subscribe(()=>{l?window.location.href=`Benefit.aspx?ID=${y.id}`:window.location.reload()})},h=()=>{let l={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=S(n.value,l),l={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},o.value.forEach((t,i)=>Object.assign(V.value,S(t,l,`other-${i}-`))),l={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,i)=>Object.assign(V.value,S(t,l,`plan-${i}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.literacy("getFunding",{ID:y.id})]).subscribe(l=>{const t=l[0];n.value=t.Project,o.value=t.OtherSubsidies,r.value=t.BudgetPlans,o.value.length||s(),r.value.length||f(),M().literacy={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=c.value.reduce((l,t)=>l+F(t.Amount),0),a.value=F(n.value.ApplyAmount)+F(n.value.SelfAmount)+F(n.value.OtherAmount),c.value.forEach(l=>l.percent=Math.round(F(l.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(l=>l.sum=F(l.Amount)+F(l.OtherAmount))}),(l,t)=>{var T;const i=e.resolveComponent("input-integer"),N=e.resolveComponent("input-text"),k=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Kd,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",Xd,[e.createElementVNode("div",vd,[e.createElementVNode("table",es,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(n).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(n).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",ts,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",ls,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",os,[e.createElementVNode("table",ns,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,rs)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",as,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(x,g)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(g+1),1),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(V)[`other-${g}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":p=>x.Unit=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`other-${g}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":p=>x.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",ds,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`other-${g}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":p=>x.Content=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",ss,[e.createElementVNode("div",is,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:p=>d(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,cs)):e.createCommentVNode("",!0),g+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",ms,[e.createElementVNode("div",Vs,[e.createElementVNode("table",ps,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",fs,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(x,g)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(V)[`plan-${g}-Title`],modelValue:x.Title,"onUpdate:modelValue":p=>x.Title=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`plan-${g}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":p=>x.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`plan-${g}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":p=>x.OtherAmount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",Ns,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`plan-${g}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":p=>x.Description=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",us,[e.createElementVNode("div",Es,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:p=>d(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,bs)):e.createCommentVNode("",!0),g+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",ks,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>u(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ys={__name:"ProgressBar",setup(B){const y=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,V)=>{const c=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(c,{steps:y,type:"literacy"})}}},hs={class:"block"},$s={class:"mt-4"},Bs={class:"table align-middle gray-table side-table"},xs={class:"d-flex align-items-center gap-2"},Cs={class:"input-group w-auto"},_s={key:0,class:"invalid mt-0"},Ts={class:"table-responsive mt-4"},ws={class:"table align-middle gray-table"},Ss={key:0},Ds={class:"input-group"},Us={key:0,class:"invalid mt-0"},As={key:0},Os={class:"d-flex gap-2"},Ms=["onClick"],Fs={class:"mt-4"},Is={class:"table align-middle gray-table"},js={key:0},Ps={key:0},zs={class:"d-flex gap-2"},qs=["onClick"],Ls={key:0,class:"block-bottom bg-light-teal"},Rs={__name:"WorkSchedule",props:{id:{type:Number}},setup(B){const y=B,E=[{value:1,text:"50%"},{value:2,text:"100%"}],V=e.computed(()=>I("literacy",o.value.Status)),c=e.ref({}),m=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.computed(()=>a.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref([]),s=()=>w.literacy("createItem",{ID:y.id}).subscribe(l=>r.value.push(l)),f=()=>a.value.push({Type:0,ItemID:0}),d=l=>l.Deleted=!0,u=l=>{if(c.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Items:r.value,Schedules:a.value,Submit:l?"true":"false"};w.literacy("saveWorkSchedule",t).subscribe(()=>{l?window.location.href=`Funding.aspx?ID=${y.id}`:window.location.reload()})},h=()=>{let l={StartTime:"計畫期程",EndTime:"計畫期程"};return c.value=S(o.value,l),l={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},m.value.forEach((t,i)=>Object.assign(c.value,S(t,l,`item-${i}-`))),l={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},n.value.forEach((t,i)=>Object.assign(c.value,S(t,l,`schedule-${i}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.literacy("getWorkSchedule",{ID:y.id})]).subscribe(l=>{const t=l[0];o.value=t.Project,r.value=t.Items,a.value=t.Schedules,r.value.length||s(),a.value.length||f(),M().literacy={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",V),(l,t)=>{const i=e.resolveComponent("required-label"),N=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hs,[t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",$s,[e.createElementVNode("table",Bs,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",xs,[e.createElementVNode("div",Cs,[e.createVNode(N,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[0]||(t[0]=p=>e.unref(o).StartTime=p)},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(N,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[1]||(t[1]=p=>e.unref(o).EndTime=p)},null,8,["modelValue"])]),t[6]||(t[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(c).StartTime||e.unref(c).EndTime?(e.openBlock(),e.createElementBlock("div",_s,e.toDisplayString(e.unref(c).StartTime||e.unref(c).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Ts,[e.createElementVNode("table",ws,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[11]||(t[11]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[7]||(t[7]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ss,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+b)),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(c)[`item-${b}-Title`],modelValue:p.Title,"onUpdate:modelValue":C=>p.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Ds,[e.createVNode(T,{"empty-value":0,modelValue:p.Begin,"onUpdate:modelValue":C=>p.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:p.End,"onUpdate:modelValue":C=>p.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(c)[`item-${b}-Begin`]||e.unref(c)[`item-${b}-End`]?(e.openBlock(),e.createElementBlock("div",Us,e.toDisplayString(e.unref(c)[`item-${b}-Begin`]||e.unref(c)[`item-${b}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(c)[`item-${b}-Deadline`],modelValue:p.Deadline,"onUpdate:modelValue":C=>p.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`item-${b}-Content`],rows:"1",modelValue:p.Content,"onUpdate:modelValue":C=>p.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",As,[e.createElementVNode("div",Os,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Ms)):e.createCommentVNode("",!0),b+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Fs,[e.createElementVNode("table",Is,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[14]||(t[14]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[18]||(t[18]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",js,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(c)[`schedule-${b}-Type`],options:E,modelValue:p.Type,"onUpdate:modelValue":C=>p.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(c)[`schedule-${b}-ItemID`],options:e.unref(m),"text-name":"Title","value-name":"ID",modelValue:p.ItemID,"onUpdate:modelValue":C=>p.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(p.ItemID?String.fromCharCode(65+e.unref(m).findIndex(C=>C.ID===p.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(c)[`schedule-${b}-Deadline`],modelValue:p.Deadline,"onUpdate:modelValue":C=>p.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`schedule-${b}-Content`],rows:"1",modelValue:p.Content,"onUpdate:modelValue":C=>p.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Ps,[e.createElementVNode("div",zs,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,qs)):e.createCommentVNode("",!0),b+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Ls,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=p=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=p=>u(!0)),type:"button"},[...t[24]||(t[24]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Js={class:"block"},Qs={class:"mt-4"},Ws={class:"table align-middle gray-table side-table"},Gs={key:0},Ys={key:1,class:"text-light-gray"},Hs={class:"mt-4"},Zs={class:"table align-middle gray-table side-table"},Ks={class:"row g-3"},Xs={class:"col-12 col-xl-2"},vs={class:"text-gray mb-2"},ei={class:"col-12 col-xl-3"},ti={class:"text-gray mb-2"},li={class:"col-12 col-xl-4"},oi={class:"row g-1"},ni={class:"col-7"},ri={class:"col-5"},ai={class:"col-12 col-xl-3"},di={class:"text-gray mb-2"},si={class:"col-12"},ii={class:"text-gray mb-2"},ci={class:"mt-4"},mi={class:"table align-middle gray-table side-table"},Vi={class:"mt-4"},pi={class:"table align-middle gray-table side-table"},fi={key:0,class:"table-responsive mt-3 mb-0"},Ni={class:"table align-middle gray-table"},ui={key:0},Ei={key:0},bi={class:"d-flex gap-2"},ki=["onClick"],gi={key:0,class:"block-bottom bg-light-teal"},yi={__name:"Application",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.ref(),c=e.computed(()=>I("multiple",r.value.Status)),m=e.ref({}),n=e.ref([]),o=e.computed(()=>a.value.filter(l=>!l.Deleted)),r=e.ref({}),a=e.ref([]),s=e.computed({get:()=>!!o.value.length,set:l=>{l?f():a.value.forEach(t=>t.Deleted=!0)}}),f=()=>a.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(m.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:r.value,Contacts:V.value,ReceivedSubsidies:a.value.filter(i=>i.ID||!i.Deleted),Submit:l?"true":"false"};w.multiple("saveApplication",t).subscribe(i=>{l?window.location.href=`WorkSchedule.aspx?ID=${i.ID}`:r.value.ID?window.location.reload():window.location.href=`Application.aspx?ID=${i.ID}`})},h=()=>{let l={ProjectName:"計畫名稱",Field:"計畫類別",OrgName:"申請單位",OrgCategory:"申請單位類別",TaxID:"統一編號",Address:"立案聯絡地址",Target:"計畫目標",Summary:"計畫內容概要",Quantified:"預期效益(量化)",Qualitative:"預期效益(質化)"};return m.value=S(r.value,l),l={Name:"姓名",JobTitle:"職稱",MobilePhone:"手機號碼",EMail:"電子郵件"},V.value.forEach((t,i)=>Object.assign(m.value,S(t,l,`contact-${i}-`))),l={Name:"計畫名稱",Unit:"補助單位",Amount:{presence:{allowEmpty:!1,message:"^請輸入補助金額"},numericality:{greaterThan:0,message:"^補助金額不可為 0"}}},a.value.forEach((t,i)=>Object.assign(m.value,S(t,l,`received-${i}-`))),!Object.keys(m.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.multiple("getZgsCodes",{CodeGroup:"MULField"}),w.multiple("getZgsCodes",{CodeGroup:"MULOrgCategory"})]).subscribe(l=>{n.value=l[0],E.value=l[1],y.id?w.multiple("getApplication",{ID:y.id}).subscribe(t=>{r.value=t.Project,V.value=t.Contacts,a.value=t.ReceivedSubsidies,r.value.OrgCategory=r.value.OrgCategory||null,M().multiple={step:r.value.FormStep,status:r.value.Status,organizer:r.value.Organizer,organizerName:r.value.OrganizerName}}):w.multiple("getEmptyApplication").subscribe(t=>{r.value=Object.assign({Field:null,OrgCategory:null,FormStep:1,Status:1},t),V.value=[{Role:"負責人"},{Role:"聯絡人"}],M().multiple={step:r.value.FormStep,status:r.value.Status}})})}),e.provide("editable",c),(l,t)=>{const i=e.resolveComponent("required-label"),N=e.resolveComponent("input-text"),k=e.resolveComponent("input-select"),T=e.resolveComponent("input-textarea"),x=e.resolveComponent("input-boolean"),g=e.resolveComponent("input-integer");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Js,[t[38]||(t[38]=e.createElementVNode("h5",{class:"square-title"},"基本資料",-1)),e.createElementVNode("div",Qs,[e.createElementVNode("table",Ws,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"年度",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).Year),1)]),e.createElementVNode("tr",null,[t[14]||(t[14]=e.createElementVNode("th",null,"計畫編號",-1)),e.createElementVNode("td",null,[e.unref(r).ProjectID?(e.openBlock(),e.createElementBlock("span",Gs,e.toDisplayString(e.unref(r).ProjectID),1)):(e.openBlock(),e.createElementBlock("span",Ys,"儲存後由系統自動產生"))])]),e.createElementVNode("tr",null,[t[15]||(t[15]=e.createElementVNode("th",null,"補助計畫類別",-1)),e.createElementVNode("td",null,e.toDisplayString(e.unref(r).SubsidyPlanType),1)]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("計畫名稱",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).ProjectName,modelValue:e.unref(r).ProjectName,"onUpdate:modelValue":t[0]||(t[0]=p=>e.unref(r).ProjectName=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("計畫類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{"empty-value":null,error:e.unref(m).Field,options:e.unref(n),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).Field,"onUpdate:modelValue":t[1]||(t[1]=p=>e.unref(r).Field=p)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[18]||(t[18]=[e.createTextVNode("申請單位",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).OrgName,placeholder:"請輸入名稱",modelValue:e.unref(r).OrgName,"onUpdate:modelValue":t[2]||(t[2]=p=>e.unref(r).OrgName=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[19]||(t[19]=[e.createTextVNode("申請單位類別",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(k,{"empty-value":null,error:e.unref(m).OrgCategory,options:e.unref(E),"text-name":"Descname","value-name":"Code",modelValue:e.unref(r).OrgCategory,"onUpdate:modelValue":t[3]||(t[3]=p=>e.unref(r).OrgCategory=p)},null,8,["error","options","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[20]||(t[20]=[e.createTextVNode("統一編號",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(稅籍)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).TaxID,modelValue:e.unref(r).TaxID,"onUpdate:modelValue":t[4]||(t[4]=p=>e.unref(r).TaxID=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[21]||(t[21]=[e.createTextVNode("立案聯絡地址",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m).Address,placeholder:"請輸入地址",modelValue:e.unref(r).Address,"onUpdate:modelValue":t[5]||(t[5]=p=>e.unref(r).Address=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),t[39]||(t[39]=e.createElementVNode("h5",{class:"square-title mt-5"},"人員聯絡資訊",-1)),e.createElementVNode("div",Hs,[e.createElementVNode("table",Zs,[e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(V),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(p.Role),1)]),_:2},1024)]),e.createElementVNode("td",null,[e.createElementVNode("div",Ks,[e.createElementVNode("div",Xs,[e.createElementVNode("div",vs,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[22]||(t[22]=[e.createTextVNode("姓名",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${b}-Name`],modelValue:p.Name,"onUpdate:modelValue":C=>p.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ei,[e.createElementVNode("div",ti,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[23]||(t[23]=[e.createTextVNode("職稱",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${b}-JobTitle`],modelValue:p.JobTitle,"onUpdate:modelValue":C=>p.JobTitle=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",li,[t[24]||(t[24]=e.createElementVNode("div",{class:"text-gray mb-2"},"電話(分機)",-1)),e.createElementVNode("div",oi,[e.createElementVNode("div",ni,[e.createVNode(N,{modelValue:p.Phone,"onUpdate:modelValue":C=>p.Phone=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",ri,[e.createVNode(N,{placeholder:"請輸入分機",size:"4",modelValue:p.PhoneExt,"onUpdate:modelValue":C=>p.PhoneExt=C,modelModifiers:{trim:!0}},null,8,["modelValue","onUpdate:modelValue"])])])]),e.createElementVNode("div",ai,[e.createElementVNode("div",di,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[25]||(t[25]=[e.createTextVNode("手機號碼",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${b}-MobilePhone`],modelValue:p.MobilePhone,"onUpdate:modelValue":C=>p.MobilePhone=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("div",si,[e.createElementVNode("div",ii,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[26]||(t[26]=[e.createTextVNode("電子郵件",-1)])]),_:1})]),e.createVNode(N,{error:e.unref(m)[`contact-${b}-EMail`],modelValue:p.EMail,"onUpdate:modelValue":C=>p.EMail=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])])])])]))),128))])])]),t[40]||(t[40]=e.createElementVNode("h5",{class:"square-title mt-5"},"計畫內容",-1)),e.createElementVNode("div",ci,[e.createElementVNode("table",mi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[27]||(t[27]=[e.createTextVNode("計畫目標",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[t[28]||(t[28]=e.createElementVNode("div",{class:"fs-14 mb-2"},"對海洋文化發展、推廣或傳承之期待，包含落實海洋基本法、2020國家海洋政策白皮書與臺灣永續發展目標",-1)),e.createVNode(T,{error:e.unref(m).Target,"max-length":500,placeholder:"請輸入計畫目標",rows:"4",modelValue:e.unref(r).Target,"onUpdate:modelValue":t[6]||(t[6]=p=>e.unref(r).Target=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[29]||(t[29]=[e.createTextVNode("計畫內容概要",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(m).Summary,"max-length":500,placeholder:"請輸入計畫內容概要",rows:"4",modelValue:e.unref(r).Summary,"onUpdate:modelValue":t[7]||(t[7]=p=>e.unref(r).Summary=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[30]||(t[30]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(量化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(m).Quantified,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Quantified,"onUpdate:modelValue":t[8]||(t[8]=p=>e.unref(r).Quantified=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])]),e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[31]||(t[31]=[e.createTextVNode("預期效益",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode("(質化)(條列式)",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createVNode(T,{error:e.unref(m).Qualitative,"max-length":250,placeholder:"請輸入預期效益",rows:"4",modelValue:e.unref(r).Qualitative,"onUpdate:modelValue":t[9]||(t[9]=p=>e.unref(r).Qualitative=p),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])]),e.createElementVNode("div",Vi,[e.createElementVNode("table",pi,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[t[37]||(t[37]=e.createElementVNode("th",null,"最近三年曾獲本會及所屬補助／合作計畫及經費",-1)),e.createElementVNode("td",null,[e.createVNode(x,{modelValue:e.unref(s),"onUpdate:modelValue":t[10]||(t[10]=p=>e.isRef(s)?s.value=p:null)},null,8,["modelValue"]),e.unref(s)?(e.openBlock(),e.createElementBlock("div",fi,[e.createElementVNode("table",Ni,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[32]||(t[32]=e.createElementVNode("th",null,"計畫名稱",-1)),t[33]||(t[33]=e.createElementVNode("th",null,"補助單位",-1)),t[34]||(t[34]=e.createElementVNode("th",{class:"text-end"},"補助金額",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",ui,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m)[`received-${b}-Name`],modelValue:p.Name,"onUpdate:modelValue":C=>p.Name=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(m)[`received-${b}-Unit`],modelValue:p.Unit,"onUpdate:modelValue":C=>p.Unit=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{error:e.unref(m)[`received-${b}-Amount`],modelValue:p.Amount,"onUpdate:modelValue":C=>p.Amount=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",Ei,[e.createElementVNode("div",bi,[e.unref(o).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[35]||(t[35]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,ki)):e.createCommentVNode("",!0),b+1===e.unref(o).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[36]||(t[36]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])):e.createCommentVNode("",!0)])])])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",gi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[11]||(t[11]=p=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[12]||(t[12]=p=>u(!0)),type:"button"},[...t[41]||(t[41]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},hi={class:"block"},$i={key:0,class:"text-pink lh-base mt-4"},Bi={class:"mt-4"},xi={class:"table align-middle gray-table"},Ci={class:"text-center"},_i={key:0,width:"180"},Ti={class:"text-center"},wi={key:0},Si=["innerHTML"],Di={key:1,class:"btn btn-sm btn-teal-dark rounded-pill mt-2",type:"button"},Ui={key:0,class:"text-center"},Ai={key:0},Oi={key:1,class:"text-pink"},Mi={key:1,class:"tag-group mt-2 gap-1"},Fi={key:0,class:"tag tag-green-light"},Ii=["download","href"],ji=["onClick"],Pi={key:0,class:"block-bottom bg-light-teal"},zi=["disabled"],qi={__name:"Attachment",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([{Type:1,Title:"申請表",Template:!0,Files:[]},{Type:2,Title:"計畫書",Template:!0,Files:[]},{Type:3,Title:"執行承諾書",Template:!0,Files:[]},{Type:4,Title:"未違反公職人員利益衝突迴避法切結書及事前揭露表",Template:!0,Files:[]},{Type:5,Title:"其他佐證資料",Comment:"提案計畫倘有結合其他合作單位、團體或相關機關(構)，請提供合作意向書或相關參考文件尤佳，無則免附",Files:[],Multiple:!0,Optional:!0}]),V=e.computed(()=>E.value.some(a=>!a.Optional&&!a.Files.filter(s=>!s.Deleted).length)),c=e.computed(()=>I("multiple",m.value.Status)),m=e.ref({}),n=(a,s)=>{s.Type==="application/pdf"&&a.Files.push({Type:a.Type,Path:s.Path,Name:m.value.ProjectID+"_"+(a.Multiple?s.Name:`${a.Title}.pdf`)})},o=w.download,r=a=>{const s={ID:y.id,Attachments:E.value.reduce((f,d)=>f.concat(d.Files),[]),Submit:a?"true":"false"};w.multiple("saveAttachment",s).subscribe(()=>{a||window.location.reload()})};return e.onMounted(()=>{rxjs.forkJoin([w.multiple("getAttachment",{ID:y.id})]).subscribe(a=>{const s=a[0];m.value=s.Project,E.value=E.value.filter(f=>{var d;return!((d=f.Excludes)!=null&&d.includes(m.value.OrgCategory))}),E.value.forEach(f=>{f.Files=s.Attachments.filter(d=>d.Type===f.Type),f.Uploaded=e.computed(()=>f.Files.filter(d=>!d.Deleted).length)}),M().multiple={step:m.value.FormStep,status:m.value.Status,organizer:m.value.Organizer,organizerName:m.value.OrganizerName}})}),e.provide("editable",c),(a,s)=>{const f=e.resolveComponent("required-label"),d=e.resolveComponent("input-file");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",hi,[s[8]||(s[8]=e.createElementVNode("h5",{class:"square-title"},"請下載範本填寫用印並上傳",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("p",$i,[...s[2]||(s[2]=[e.createTextVNode(" 請下載附件範本，填寫資料及公文用印後上傳（僅支援PDF格式上傳，每個檔案10MB以內）",-1),e.createElementVNode("br",null,null,-1),e.createTextVNode(" 計畫書請自行留存送審版電子檔，待決審核定經費後請提交修正計畫書以供核定。 ",-1)])])):e.createCommentVNode("",!0),e.createElementVNode("div",Bi,[e.createElementVNode("table",xi,[e.createElementVNode("thead",Ci,[e.createElementVNode("tr",null,[s[3]||(s[3]=e.createElementVNode("th",{width:"60"},"附件編號",-1)),s[4]||(s[4]=e.createElementVNode("th",null,"附件名稱",-1)),e.unref(c)?(e.openBlock(),e.createElementBlock("th",_i,"狀態")):e.createCommentVNode("",!0),s[5]||(s[5]=e.createElementVNode("th",{width:"350"},"上傳附件",-1))])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E),(u,h)=>(e.openBlock(),e.createElementBlock("tr",{key:u},[e.createElementVNode("td",Ti,e.toDisplayString(h+1),1),e.createElementVNode("td",null,[e.createElementVNode("div",null,[u.Optional?(e.openBlock(),e.createElementBlock("span",wi,e.toDisplayString(u.Title),1)):(e.openBlock(),e.createBlock(f,{key:1},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(u.Title),1)]),_:2},1024))]),e.unref(c)&&u.Comment?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mt-3 small",innerHTML:u.Comment},null,8,Si)):e.createCommentVNode("",!0),e.unref(c)&&u.Template?(e.openBlock(),e.createElementBlock("button",Di,[...s[6]||(s[6]=[e.createElementVNode("i",{class:"fas fa-file-download me-1"},null,-1),e.createTextVNode("範本下載 ",-1)])])):e.createCommentVNode("",!0)]),e.unref(c)?(e.openBlock(),e.createElementBlock("td",Ui,[u.Uploaded?(e.openBlock(),e.createElementBlock("span",Ai,"已上傳")):(e.openBlock(),e.createElementBlock("span",Oi,"尚未上傳"))])):e.createCommentVNode("",!0),e.createElementVNode("td",null,[e.unref(c)&&(u.Multiple||!u.Uploaded)?(e.openBlock(),e.createBlock(d,{key:0,accept:".pdf",onFile:l=>n(u,l)},null,8,["onFile"])):e.createCommentVNode("",!0),u.Uploaded?(e.openBlock(),e.createElementBlock("div",Mi,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.Files,l=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:l},[l.Deleted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",Fi,[e.createElementVNode("a",{class:"tag-link my-1",download:l.Name,href:e.unref(o)(l.Path)},e.toDisplayString(l.Name),9,Ii),e.unref(c)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"tag-btn",onClick:t=>l.Deleted=!0,type:"button"},[...s[7]||(s[7]=[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"},null,-1)])],8,ji)):e.createCommentVNode("",!0)]))],64))),128))])):e.createCommentVNode("",!0)])]))),128))])])])]),e.unref(c)?(e.openBlock(),e.createElementBlock("div",Pi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:s[0]||(s[0]=u=>r()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:s[1]||(s[1]=u=>r(!0)),disabled:e.unref(V),type:"button"},[...s[9]||(s[9]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("全部完成，提送申請",-1)])],8,zi)])):e.createCommentVNode("",!0)],64)}}},Li={class:"block"},Ri={class:"mt-4"},Ji={class:"table-responsive mt-3 mb-0"},Qi={class:"table align-middle gray-table"},Wi={key:0,width:"1"},Gi={key:0},Yi={class:"d-flex gap-2"},Hi=["onClick"],Zi={class:"table-responsive mt-3 mb-0"},Ki={class:"table align-middle gray-table"},Xi={key:0,class:"block-bottom bg-light-teal"},vi={__name:"Benefit",props:{id:{type:Number}},setup(B){const y=B,E=e.ref([]),V=e.computed(()=>I("multiple",n.value.Status)),c=e.ref({}),m=e.computed(()=>E.value.filter(f=>!f.Deleted)),n=e.ref({}),o=()=>E.value.push({}),r=f=>f.Deleted=!0,a=f=>{if(c.value={},f&&!s()){e.nextTick(()=>{var u;return(u=document.querySelector(".invalid"))==null?void 0:u.scrollIntoView({behavior:"smooth",block:"center"})});return}const d={Project:n.value,Benefits:E.value,Submit:f?"true":"false"};w.multiple("saveBenefit",d).subscribe(()=>{f?window.location.href=`Attachment.aspx?ID=${y.id}`:window.location.reload()})},s=()=>{let f={Benefit:"不可量化成果"};return c.value=S(n.value,f),f={Title:"指標",Target:"目標值",Description:"說明"},m.value.forEach((d,u)=>Object.assign(c.value,S(d,f,`item-${u}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.multiple("getBenefit",{ID:y.id})]).subscribe(f=>{const d=f[0];n.value=d.Project,E.value=d.Benefits,E.value.length||o(),M().multiple={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",V),(f,d)=>{const u=e.resolveComponent("input-text"),h=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Li,[d[9]||(d[9]=e.createElementVNode("h5",{class:"square-title"},"成果目標與效益",-1)),e.createElementVNode("div",Ri,[e.createElementVNode("div",Ji,[e.createElementVNode("table",Qi,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[d[3]||(d[3]=e.createElementVNode("th",null,"可量化成果－指標",-1)),d[4]||(d[4]=e.createElementVNode("th",null,"目標值",-1)),d[5]||(d[5]=e.createElementVNode("th",null,"說明",-1)),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Wi,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(l,t)=>(e.openBlock(),e.createElementBlock("tr",{key:l},[e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(c)[`item-${t}-Title`],modelValue:l.Title,"onUpdate:modelValue":i=>l.Title=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(u,{error:e.unref(c)[`item-${t}-Target`],modelValue:l.Target,"onUpdate:modelValue":i=>l.Target=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(c)[`item-${t}-Description`],rows:"1",modelValue:l.Description,"onUpdate:modelValue":i=>l.Description=i,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Gi,[e.createElementVNode("div",Yi,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:i=>r(l),type:"button"},[...d[6]||(d[6]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Hi)):e.createCommentVNode("",!0),t+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:o,type:"button"},[...d[7]||(d[7]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),e.createElementVNode("div",Zi,[e.createElementVNode("table",Ki,[d[8]||(d[8]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,"不可量化成果")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(h,{error:e.unref(c).Benefit,rows:"4",modelValue:e.unref(n).Benefit,"onUpdate:modelValue":d[0]||(d[0]=l=>e.unref(n).Benefit=l),modelModifiers:{trim:!0}},null,8,["error","modelValue"])])])])])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Xi,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:d[1]||(d[1]=l=>a()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:d[2]||(d[2]=l=>a(!0)),type:"button"},[...d[10]||(d[10]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},ec={class:"block"},tc={class:"mt-4"},lc={class:"table-responsive mt-3 mb-0"},oc={class:"table align-middle gray-table"},nc={class:"text-end"},rc={class:"text-end"},ac={class:"table-responsive"},dc={class:"table align-middle gray-table"},sc=["colspan"],ic={key:0,width:"1"},cc={class:"text-end"},mc={key:0},Vc={class:"d-flex gap-2"},pc=["onClick"],fc={class:"mt-4"},Nc={class:"table-responsive mt-3 mb-0"},uc={class:"table align-middle gray-table"},Ec={key:0,width:"1"},bc={class:"text-end"},kc={key:0},gc={class:"d-flex gap-2"},yc=["onClick"],hc={key:0,class:"block-bottom bg-light-teal"},$c={__name:"Funding",props:{id:{type:Number}},setup(B){const y=B,E=e.computed(()=>I("multiple",n.value.Status)),V=e.ref({}),c=e.computed(()=>o.value.filter(l=>!l.Deleted)),m=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.ref({}),o=e.ref([]),r=e.ref([]),a=e.ref(0),s=()=>o.value.push({}),f=()=>r.value.push({}),d=l=>l.Deleted=!0,u=l=>{if(V.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:n.value,OtherSubsidies:o.value,BudgetPlans:r.value,Submit:l?"true":"false"};w.multiple("saveFunding",t).subscribe(()=>{l?window.location.href=`Benefit.aspx?ID=${y.id}`:window.location.reload()})},h=()=>{let l={ApplyAmount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},SelfAmount:"自籌款"};return V.value=S(n.value,l),l={Unit:"單位名稱",Amount:{presence:{allowEmpty:!1,message:"^請輸入申請金額"},numericality:{greaterThan:0,message:"^申請金額不可為 0"}},Content:"申請合作項目"},o.value.forEach((t,i)=>Object.assign(V.value,S(t,l,`other-${i}-`))),l={Title:"預算項目",Amount:"海委會經費",OtherAmount:"其他經費",Description:"計算方式及說明"},r.value.forEach((t,i)=>Object.assign(V.value,S(t,l,`plan-${i}-`))),!Object.keys(V.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.multiple("getFunding",{ID:y.id})]).subscribe(l=>{const t=l[0];n.value=t.Project,o.value=t.OtherSubsidies,r.value=t.BudgetPlans,o.value.length||s(),r.value.length||f(),M().multiple={step:n.value.FormStep,status:n.value.Status,organizer:n.value.Organizer,organizerName:n.value.OrganizerName}})}),e.provide("editable",E),e.watchEffect(()=>{n.value.OtherAmount=c.value.reduce((l,t)=>l+F(t.Amount),0),a.value=F(n.value.ApplyAmount)+F(n.value.SelfAmount)+F(n.value.OtherAmount),c.value.forEach(l=>l.percent=Math.round(F(l.Amount)/n.value.OtherAmount*1e4)/100),r.value.forEach(l=>l.sum=F(l.Amount)+F(l.OtherAmount))}),(l,t)=>{var T;const i=e.resolveComponent("input-integer"),N=e.resolveComponent("input-text"),k=e.resolveComponent("input-textarea");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",ec,[t[20]||(t[20]=e.createElementVNode("h5",{class:"square-title"},"申請經費",-1)),e.createElementVNode("div",tc,[e.createElementVNode("div",lc,[e.createElementVNode("table",oc,[t[4]||(t[4]=e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{class:"text-end"},"申請海委會補助／合作金額 (A)"),e.createElementVNode("th",{class:"text-end"},"申請單位自籌款 (B)"),e.createElementVNode("th",{class:"text-end"},"其他機關補助／合作總金額 (C)"),e.createElementVNode("th",{class:"text-end"},"計畫總經費 (A+B+C)")])],-1)),e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).ApplyAmount,modelValue:e.unref(n).ApplyAmount,"onUpdate:modelValue":t[0]||(t[0]=x=>e.unref(n).ApplyAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V).SelfAmount,modelValue:e.unref(n).SelfAmount,"onUpdate:modelValue":t[1]||(t[1]=x=>e.unref(n).SelfAmount=x)},null,8,["error","modelValue"])]),e.createElementVNode("td",nc,e.toDisplayString((T=e.unref(n).OtherAmount)==null?void 0:T.toLocaleString()),1),e.createElementVNode("td",rc,e.toDisplayString(e.unref(a).toLocaleString()),1)])])])]),t[12]||(t[12]=e.createElementVNode("ul",{class:"list-unstyled lh-base mb-3"},[e.createElementVNode("li",null,"補助申請單位為民間團體或學校者，配合款比例應為計畫總經費之 5％以上；"),e.createElementVNode("li",null,"合作申請單位之分攤比例應為計畫總經費之 20％以上。")],-1)),e.createElementVNode("div",ac,[e.createElementVNode("table",dc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",{colspan:e.unref(E)?6:5,style:{"border-bottom-width":"1px"}},"其他機關補助／合作金額 (C)",8,sc)]),e.createElementVNode("tr",null,[t[5]||(t[5]=e.createElementVNode("th",{width:"1"},null,-1)),t[6]||(t[6]=e.createElementVNode("th",null,"單位名稱",-1)),t[7]||(t[7]=e.createElementVNode("th",{class:"text-end"},"申請／分攤補助金額（含尚未核定者）",-1)),t[8]||(t[8]=e.createElementVNode("th",null,"比例",-1)),t[9]||(t[9]=e.createElementVNode("th",null,"申請合作項目",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",ic,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),(x,g)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,e.toDisplayString(g+1),1),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(V)[`other-${g}-Unit`],modelValue:x.Unit,"onUpdate:modelValue":p=>x.Unit=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`other-${g}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":p=>x.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",cc,e.toDisplayString(x.percent||0)+"% ",1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`other-${g}-Content`],rows:"1",modelValue:x.Content,"onUpdate:modelValue":p=>x.Content=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",mc,[e.createElementVNode("div",Vc,[e.unref(c).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:p=>d(x),type:"button"},[...t[10]||(t[10]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,pc)):e.createCommentVNode("",!0),g+1===e.unref(c).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[11]||(t[11]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"經費預算規劃",-1)),e.createElementVNode("div",fc,[e.createElementVNode("div",Nc,[e.createElementVNode("table",uc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[13]||(t[13]=e.createElementVNode("th",null,"預算項目",-1)),t[14]||(t[14]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("海洋委員會經費")],-1)),t[15]||(t[15]=e.createElementVNode("th",{class:"text-end"},[e.createTextVNode("預算金額"),e.createElementVNode("br"),e.createTextVNode("其他配合經費")],-1)),t[16]||(t[16]=e.createElementVNode("th",{class:"text-end"},"預算金額小計",-1)),t[17]||(t[17]=e.createElementVNode("th",null,"計算方式及說明",-1)),e.unref(E)?(e.openBlock(),e.createElementBlock("th",Ec,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(x,g)=>(e.openBlock(),e.createElementBlock("tr",{key:x},[e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(V)[`plan-${g}-Title`],modelValue:x.Title,"onUpdate:modelValue":p=>x.Title=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`plan-${g}-Amount`],modelValue:x.Amount,"onUpdate:modelValue":p=>x.Amount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(i,{error:e.unref(V)[`plan-${g}-OtherAmount`],modelValue:x.OtherAmount,"onUpdate:modelValue":p=>x.OtherAmount=p},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",bc,e.toDisplayString(x.sum.toLocaleString()),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(V)[`plan-${g}-Description`],rows:"1",modelValue:x.Description,"onUpdate:modelValue":p=>x.Description=p,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(E)?(e.openBlock(),e.createElementBlock("td",kc,[e.createElementVNode("div",gc,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:p=>d(x),type:"button"},[...t[18]||(t[18]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,yc)):e.createCommentVNode("",!0),g+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])])]),e.unref(E)?(e.openBlock(),e.createElementBlock("div",hc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=x=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=x=>u(!0)),type:"button"},[...t[22]||(t[22]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Bc={__name:"ProgressBar",setup(B){const y=[{step:1,title:"申請書／計畫書",url:"Application"},{step:2,title:"期程／工作項目／查核",url:"WorkSchedule"},{step:3,title:"經費",url:"Funding"},{step:4,title:"成果效益",url:"Benefit"},{step:5,title:"上傳附件／提送申請",url:"Attachment"}];return(E,V)=>{const c=e.resolveComponent("common-progress-bar");return e.openBlock(),e.createBlock(c,{steps:y,type:"multiple"})}}},xc={class:"block"},Cc={class:"mt-4"},_c={class:"table align-middle gray-table side-table"},Tc={class:"d-flex align-items-center gap-2"},wc={class:"input-group w-auto"},Sc={key:0,class:"invalid mt-0"},Dc={class:"table-responsive mt-4"},Uc={class:"table align-middle gray-table"},Ac={key:0},Oc={class:"input-group"},Mc={key:0,class:"invalid mt-0"},Fc={key:0},Ic={class:"d-flex gap-2"},jc=["onClick"],Pc={class:"mt-4"},zc={class:"table align-middle gray-table"},qc={key:0},Lc={key:0},Rc={class:"d-flex gap-2"},Jc=["onClick"],Qc={key:0,class:"block-bottom bg-light-teal"},Wc={__name:"WorkSchedule",props:{id:{type:Number}},setup(B){const y=B,E=[{value:1,text:"50%"},{value:2,text:"100%"}],V=e.computed(()=>I("multiple",o.value.Status)),c=e.ref({}),m=e.computed(()=>r.value.filter(l=>!l.Deleted)),n=e.computed(()=>a.value.filter(l=>!l.Deleted)),o=e.ref({}),r=e.ref([]),a=e.ref([]),s=()=>w.multiple("createItem",{ID:y.id}).subscribe(l=>r.value.push(l)),f=()=>a.value.push({Type:0,ItemID:0}),d=l=>l.Deleted=!0,u=l=>{if(c.value={},l&&!h()){e.nextTick(()=>{var i;return(i=document.querySelector(".invalid"))==null?void 0:i.scrollIntoView({behavior:"smooth",block:"center"})});return}const t={Project:o.value,Items:r.value,Schedules:a.value,Submit:l?"true":"false"};w.multiple("saveWorkSchedule",t).subscribe(()=>{l?window.location.href=`Funding.aspx?ID=${y.id}`:window.location.reload()})},h=()=>{let l={StartTime:"計畫期程",EndTime:"計畫期程"};return c.value=S(o.value,l),l={Title:"工作項目",Begin:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},End:{numericality:{greaterThan:0,message:"^請選擇起迄月份"}},Deadline:"預定完成日",Content:"詳細執行內容說明"},m.value.forEach((t,i)=>Object.assign(c.value,S(t,l,`item-${i}-`))),l={Type:{numericality:{greaterThan:0,message:"^請選擇完成百分比"}},ItemID:{numericality:{greaterThan:0,message:"^請選擇對應工項"}},Deadline:"預定完成日",Content:"查核內容概述"},n.value.forEach((t,i)=>Object.assign(c.value,S(t,l,`schedule-${i}-`))),!Object.keys(c.value).length};return e.onMounted(()=>{rxjs.forkJoin([w.multiple("getWorkSchedule",{ID:y.id})]).subscribe(l=>{const t=l[0];o.value=t.Project,r.value=t.Items,a.value=t.Schedules,r.value.length||s(),a.value.length||f(),M().multiple={step:o.value.FormStep,status:o.value.Status,organizer:o.value.Organizer,organizerName:o.value.OrganizerName}})}),e.provide("editable",V),(l,t)=>{const i=e.resolveComponent("required-label"),N=e.resolveComponent("input-tw-date"),k=e.resolveComponent("input-text"),T=e.resolveComponent("input-month"),x=e.resolveComponent("input-textarea"),g=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",xc,[t[21]||(t[21]=e.createElementVNode("h5",{class:"square-title"},"期程",-1)),e.createElementVNode("div",Cc,[e.createElementVNode("table",_c,[e.createElementVNode("tbody",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[4]||(t[4]=[e.createTextVNode("計畫期程",-1)])]),_:1})]),e.createElementVNode("td",null,[e.createElementVNode("div",Tc,[e.createElementVNode("div",wc,[e.createVNode(N,{class:"w-auto",modelValue:e.unref(o).StartTime,"onUpdate:modelValue":t[0]||(t[0]=p=>e.unref(o).StartTime=p)},null,8,["modelValue"]),t[5]||(t[5]=e.createElementVNode("span",{class:"input-group-text"},"至",-1)),e.createVNode(N,{class:"w-auto",modelValue:e.unref(o).EndTime,"onUpdate:modelValue":t[1]||(t[1]=p=>e.unref(o).EndTime=p)},null,8,["modelValue"])]),t[6]||(t[6]=e.createElementVNode("span",{class:"text-teal-dark"},"(期程不可超過 115/04/30)",-1))]),e.unref(c).StartTime||e.unref(c).EndTime?(e.openBlock(),e.createElementBlock("div",Sc,e.toDisplayString(e.unref(c).StartTime||e.unref(c).EndTime),1)):e.createCommentVNode("",!0)])])])])]),t[22]||(t[22]=e.createElementVNode("h5",{class:"square-title mt-4"},"工作項目及預定進度",-1)),e.createElementVNode("div",Dc,[e.createElementVNode("table",Uc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[t[11]||(t[11]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[7]||(t[7]=[e.createTextVNode("工作項目",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[8]||(t[8]=[e.createTextVNode("起訖月份",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[9]||(t[9]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[10]||(t[10]=[e.createTextVNode("詳細執行內容說明",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",Ac,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(m),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,e.toDisplayString(String.fromCharCode(65+b)),1),e.createElementVNode("td",null,[e.createVNode(k,{error:e.unref(c)[`item-${b}-Title`],modelValue:p.Title,"onUpdate:modelValue":C=>p.Title=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createElementVNode("div",Oc,[e.createVNode(T,{"empty-value":0,modelValue:p.Begin,"onUpdate:modelValue":C=>p.Begin=C},null,8,["modelValue","onUpdate:modelValue"]),e.createVNode(T,{"empty-value":0,modelValue:p.End,"onUpdate:modelValue":C=>p.End=C},null,8,["modelValue","onUpdate:modelValue"])]),e.unref(c)[`item-${b}-Begin`]||e.unref(c)[`item-${b}-End`]?(e.openBlock(),e.createElementBlock("div",Mc,e.toDisplayString(e.unref(c)[`item-${b}-Begin`]||e.unref(c)[`item-${b}-End`]),1)):e.createCommentVNode("",!0)]),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(c)[`item-${b}-Deadline`],modelValue:p.Deadline,"onUpdate:modelValue":C=>p.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`item-${b}-Content`],rows:"1",modelValue:p.Content,"onUpdate:modelValue":C=>p.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Fc,[e.createElementVNode("div",Ic,[e.unref(m).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[12]||(t[12]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,jc)):e.createCommentVNode("",!0),b+1===e.unref(m).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:s,type:"button"},[...t[13]||(t[13]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])]),t[23]||(t[23]=e.createElementVNode("h5",{class:"square-title mt-4"},"進度說明",-1)),e.createElementVNode("div",Pc,[e.createElementVNode("table",zc,[e.createElementVNode("thead",null,[e.createElementVNode("tr",null,[e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[14]||(t[14]=[e.createTextVNode("完成百分比",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[15]||(t[15]=[e.createTextVNode("對應工項",-1)])]),_:1})]),t[18]||(t[18]=e.createElementVNode("th",null,"編號",-1)),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[16]||(t[16]=[e.createTextVNode("預定完成日",-1)])]),_:1})]),e.createElementVNode("th",null,[e.createVNode(i,null,{default:e.withCtx(()=>[...t[17]||(t[17]=[e.createTextVNode("查核內容概述（請具體明確或量化）",-1)])]),_:1})]),e.unref(V)?(e.openBlock(),e.createElementBlock("th",qc,"功能")):e.createCommentVNode("",!0)])]),e.createElementVNode("tbody",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(n),(p,b)=>(e.openBlock(),e.createElementBlock("tr",{key:p},[e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(c)[`schedule-${b}-Type`],options:E,modelValue:p.Type,"onUpdate:modelValue":C=>p.Type=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(g,{"empty-value":0,error:e.unref(c)[`schedule-${b}-ItemID`],options:e.unref(m),"text-name":"Title","value-name":"ID",modelValue:p.ItemID,"onUpdate:modelValue":C=>p.ItemID=C,modelModifiers:{trim:!0}},null,8,["error","options","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,e.toDisplayString(p.ItemID?String.fromCharCode(65+e.unref(m).findIndex(C=>C.ID===p.ItemID)):""),1),e.createElementVNode("td",null,[e.createVNode(N,{error:e.unref(c)[`schedule-${b}-Deadline`],modelValue:p.Deadline,"onUpdate:modelValue":C=>p.Deadline=C},null,8,["error","modelValue","onUpdate:modelValue"])]),e.createElementVNode("td",null,[e.createVNode(x,{error:e.unref(c)[`schedule-${b}-Content`],rows:"1",modelValue:p.Content,"onUpdate:modelValue":C=>p.Content=C,modelModifiers:{trim:!0}},null,8,["error","modelValue","onUpdate:modelValue"])]),e.unref(V)?(e.openBlock(),e.createElementBlock("td",Lc,[e.createElementVNode("div",Rc,[e.unref(n).length>1?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn btn-sm btn-teal-dark m-0",onClick:C=>d(p),type:"button"},[...t[19]||(t[19]=[e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)])],8,Jc)):e.createCommentVNode("",!0),b+1===e.unref(n).length?(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-sm btn-teal-dark m-0",onClick:f,type:"button"},[...t[20]||(t[20]=[e.createElementVNode("i",{class:"fas fa-plus"},null,-1)])])):e.createCommentVNode("",!0)])])):e.createCommentVNode("",!0)]))),128))])])])]),e.unref(V)?(e.openBlock(),e.createElementBlock("div",Qc,[e.createElementVNode("button",{class:"btn btn-outline-teal me-3",onClick:t[2]||(t[2]=p=>u()),type:"button"},"暫存"),e.createElementVNode("button",{class:"btn btn-teal",onClick:t[3]||(t[3]=p=>u(!0)),type:"button"},[...t[24]||(t[24]=[e.createElementVNode("i",{class:"fas fa-check"},null,-1),e.createTextVNode("完成本頁，下一步",-1)])])])):e.createCommentVNode("",!0)],64)}}},Gc={class:"d-flex align-items-center gap-3"},Yc={class:"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-md"},Hc={class:"modal-content"},Zc={class:"modal-header"},Kc={class:"fs-24 fw-bold text-green-light"},Xc={class:"modal-body"},vc={class:"d-flex gap-4 flex-wrap justify-content-center mt-5"},em=["disabled"],tm={__name:"ProjectOrganizer",props:{id:{type:Number},type:{type:String}},setup(B){const y=B,E=e.computed(()=>!m.value||m.value===o[y.type].organizer),V=e.ref(),c=e.computed(()=>o[y.type].organizerName),m=e.ref(0),n=e.computed(()=>{var u;return(u=s.value.find(h=>h.UnitID===a.value))==null?void 0:u.reviewers}),o=M(),r=e.computed(()=>c.value?"移轉案件":"認領案件"),a=e.ref(0),s=e.ref([]),f=()=>{w[y.type]("queryReviewUnits").subscribe(u=>{s.value=u,rxjs.forkJoin(s.value.map(h=>w[y.type]("queryReviewersByUnit",{ID:h.UnitID}))).subscribe(h=>{h.forEach((l,t)=>{s.value[t].reviewers=l,l.some(i=>i.UserID===m.value)&&(a.value=s.value[t].UnitID)}),bootstrap.Modal.getOrCreateInstance(V.value).show()})})},d=()=>{w[y.type]("saveOrganizer",{ID:y.id,Organizer:m.value}).subscribe(u=>{u&&window.location.reload()})};return e.watch(c,()=>m.value=o[y.type].organizer),e.watch(a,()=>{n.value.some(u=>u.UserID===m.value)||(m.value=0)}),(u,h)=>{const l=e.resolveComponent("input-select");return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("div",Gc,[e.createElementVNode("span",null,"審核承辦人員："+e.toDisplayString(e.unref(c)||"尚無"),1),e.createElementVNode("button",{class:"btn btn-teal",onClick:f,type:"button"},e.toDisplayString(e.unref(r)),1)]),(e.openBlock(),e.createBlock(e.Teleport,{to:"body"},[e.createElementVNode("div",{"aria-hidden":"true",class:"modal fade","data-bs-backdrop":"static",ref_key:"modal",ref:V,tabindex:"-1"},[e.createElementVNode("div",Yc,[e.createElementVNode("div",Hc,[e.createElementVNode("div",Zc,[e.createElementVNode("h4",Kc,e.toDisplayString(e.unref(r)),1),h[2]||(h[2]=e.createElementVNode("button",{"aria-label":"Close",class:"btn-close","data-bs-dismiss":"modal",type:"button"},[e.createElementVNode("i",{class:"fa-solid fa-circle-xmark"})],-1))]),e.createElementVNode("div",Xc,[e.createElementVNode("div",null,[h[3]||(h[3]=e.createElementVNode("div",{class:"fs-16 text-gray mb-3"},"承辦人員",-1)),e.createVNode(l,{"empty-value":0,options:e.unref(s),"text-name":"UnitName","value-name":"UnitID",modelValue:e.unref(a),"onUpdate:modelValue":h[0]||(h[0]=t=>e.isRef(a)?a.value=t:null)},null,8,["options","modelValue"]),e.createVNode(l,{class:"mt-2","empty-value":0,options:e.unref(n),"text-name":"Name","value-name":"UserID",modelValue:e.unref(m),"onUpdate:modelValue":h[1]||(h[1]=t=>e.isRef(m)?m.value=t:null)},null,8,["options","modelValue"])]),e.createElementVNode("div",vc,[h[4]||(h[4]=e.createElementVNode("button",{class:"btn btn-gray","data-bs-dismiss":"modal",type:"button"},"取消",-1)),e.createElementVNode("button",{class:"btn btn-teal",onClick:d,disabled:e.unref(E),type:"button"},"確認",8,em)])])])])],512)]))],64)}}},lm={key:0,class:"text-pink"},G={AccessibilityApplication:Le,AccessibilityAttachment:st,AccessibilityBenefit:gt,AccessibilityFunding:Jt,AccessibilityProgressBar:Qt,AccessibilityWorkSchedule:pl,CommonProgressBar:gl,CultureApplication:lo,CultureAttachment:$o,CultureFunding:Wo,CultureOther:an,CultureProgressBar:dn,CultureWorkSchedule:Xn,EducationApplication:zr,EducationAttachment:aa,EducationProgressBar:da,ErrorModal:pa,InputBoolean:fa,InputFile:Na,InputInteger:ba,InputMonth:ka,InputRadioGroup:ha,InputSelect:_a,InputText:Ua,InputTextarea:Ia,InputTwDate:za,LiteracyApplication:bd,LiteracyAttachment:jd,LiteracyBenefit:Zd,LiteracyFunding:gs,LiteracyProgressBar:ys,LiteracyWorkSchedule:Rs,MultipleApplication:yi,MultipleAttachment:qi,MultipleBenefit:vi,MultipleFunding:$c,MultipleProgressBar:Bc,MultipleWorkSchedule:Wc,ProjectOrganizer:tm,RequiredLabel:{__name:"RequiredLabel",setup(B){const y=e.inject("editable",!0);return(E,V)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.unref(y)?(e.openBlock(),e.createElementBlock("span",lm,"* ")):e.createCommentVNode("",!0),e.renderSlot(E.$slots,"default")],64))}}};return{install:B=>{for(const y in G)B.component(y,G[y])},useProgressStore:M}}));
//# sourceMappingURL=ocean-subsidy-components.umd.js.map
